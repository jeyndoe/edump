<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Внедрение параметров консольного приложения в тело программы - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте, который день шаманю с отключием проверки входных параметров консольного приложения и пытаюсь &quot;переучить&quot; программу брать эти параметры не из консоли, а из своего тела, но учитывая мой малый опыт в этом">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Внедрение параметров консольного приложения в тело программы</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]n4yk[/b]','')">n4yk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=29109">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 12:17 &middot; Поправил: n4yk <br><script type="text/javascript">QU('n4yk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=n4yk" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте, который день шаманю с отключием проверки входных параметров консольного приложения и пытаюсь &quot;переучить&quot; программу брать эти параметры не из консоли, а из своего тела, но учитывая мой малый опыт в этом ничего толкового на ум не приходит. <br><br>Подопытный:  <noindex><a href="http://winbinder.org/files/archived/php4_minimal.zip" rel="nofollow" target="_blank">--&gt; php4.exe &lt;--</a></noindex> ( входные параметры получает функцией  MSVCRT.dll!__getmainargs) <br><br>Рыскал и в англоязычных форумах и в наших, но аналогичной задачи с решением нигде не нашел.<br> <br>Подтолкните в нужную сторону, спасибо. <br><br>UPD1: Уточнение - <I>&quot;как принудительно указать аргументы консольной программы в бинарнике и отучить ее вообще принимать аргументы, путем замены n&#039;ых байтов под отладчиком&quot;.</I><br><br>UPD2: Просьба камнями не закидывать, если вам сложно отвечать по существу, не тратьте свое и чужое время.<br><br>UPD3: Мне не нужна какая-либо защита, данный способ был выбран чтобы не создавать кучи мусора во временных папках, и не совать все подряд в SFX архивы. (Зачем использовать 2 программы - одну для запуска другой с аргументами, если можно было бы указать эти аргументы в теле самой программы?)<br><br>UPD4: Прошу прощения, если эта тема затронула кого-либо из присутствующих на этом форуме, и спасибо тем, кто все-таки попытался помочь новичку в его вопросе.<br><br><I>ARCHANGEL пишет:<br>Ну вот, ещё один товарищ делает говнозащиту своего поделия, ну так а мы тут причём? UPX, упаковывай всё им.<br><br>Да, тема в разделе &quot;для новичков&quot;, но форум в целом посвящён не разработке защит, а как раз обратному.<br><br>И мне интересно, каким же боком эта тема будет востребована? Да любой приличный шароварщик знает тысячу способов усложнения реверсинга, а не прячет файлы в теле интерпретатора, &quot;таская каштаны из костра чужими руками&quot;. Хотите писать защиту своего мегасофта - ваше право, но пишите её за пределами данного ресурса. И не надо тут про плевки в лицо - ничего личного.<br></I><br>Востребована тем, кому нужно запускать  консольные программы без передач им аргументов, Админам к примеру, для запуска утилит. Или всяким патчерам, которые используют консольный софт, и для распространения создают рядом bat файл для запуска или суют все в sfx архив. <br>Может мое мнение и ошибочно, но элегантнее было бы прописывать в некоторых случаях аргументы в теле самой программы (не засоряя при этом временные директории, не ковыряясь с проблемами смены текущей рабочей папки и прочим)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334679&amp;user=29109&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=1" class="addthx" data-post="334679"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 12:22 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
упакуй все в sfx-архив, который будет запускать вложенный файл с нужными параметрами<br><br>Варианты:<br>1)Добавить код который приклеивает параметры в строку запуска в PEB (там откуда читает GetCommandLine), и переставить OEP на себя.<br>2)Перехватить GetCommandLine(A/W) и на выходе приклеить к имеющимся параметрам свои.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334680&amp;user=3136&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=2" class="addthx" data-post="334680"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29109" title="03-12-2013 11:06, ранг:0.8" target="_blank">n4yk</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]n4yk[/b]','')">n4yk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=29109">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 12:38 &middot; Поправил: n4yk <br><script type="text/javascript">QU('n4yk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=n4yk" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>Veliant пишет:<br>упакуй все в sfx-архив, который будет запускать вложенный файл с нужными параметрами </I><br><br>Не вариант, нужно именно отключить проверку параметров и указать в теле фиксированные, т.к. параметры запуска приложения можно легко посмотреть через тот же Process Explorer.<br><br>т.е. к примеру запуск идет как &quot;php.exe file.php&quot; и чел спокойно может по имени файла найти его.<br><br><I>1)Добавить код который приклеивает параметры в строку запуска в PEB (там откуда читает GetCommandLine), и переставить OEP на себя. </I><br><br>Вот с этим и загвоздка, как это сделать? т.е. на какую  функцию заменить <b>__getmainargs</b>, чтобы вместо этого php.exe к примеру брал строку по определенному адресу из ресурсов. Или еще лучше еслибы он подставлял вместо параметров имя своего файла. т.е. после проделанной замены результат был бы аналогичным &quot;php.exe php.exe&quot;, а если изменится имя exe&#039;шки на &quot;blablabla.exe&quot; то соответсвенно менялось бы на &quot;blablabla.exe blablabla.exe&quot;.<br><br>т.е. я хочу внедрить скрипт php в тело самого интерпритатора, для защиты от &quot;умных&quot; пользователей, желающих подсмотреть исходник скрипта и чтобы не создавалось никаких даже временных файлов, и исходник можно было выдрать только отладчиком. Возможно это можно слелать с помощью какого-то пакера/joinera чтобы он распаковывал файлы не на диск а в память, и оттуда запускал, но думаю на большинство из них будут ругаться антивирусы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334681&amp;user=29109&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=3" class="addthx" data-post="334681"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]dant3[/b]','')">dant3</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 33.9 (посетитель), 22thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.53'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33622">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 14:20 &middot; Поправил: dant3 <br><script type="text/javascript">QU('dant3','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dant3" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
1)написать либу, которая будет сплайсить GetCommandLineA/W<br><noindex><a href="http://www.rsdn.ru/article/baseserv/apicallsintercepting.xml" rel="nofollow" target="_blank">http://www.rsdn.ru/article/baseserv/apicallsintercepting.xml</a></noindex><br>2)добавить либу в импорт php.exe<br><br>P.S.<br>мб проще писать на чем-то нормальном? что бы не надо было дропы прятать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334682&amp;user=33622&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=4" class="addthx" data-post="334682"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29109" title="03-12-2013 11:06, ранг:0.8" target="_blank">n4yk</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 14:30 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>n4yk пишет:<br>и кроме __getmainargs еще кучу функций вызывает из MSVCRT.dll </I><br>msvcrt.dll - это стандартная crt библиотека от ms&#036;. Что касается аргументов приложения, getmainargs() одна и используется. А она обращается в свою очередь к одной из GetCommandLine(A/W). <b>Veliant</b> правильно указал.<br><br><I>n4yk пишет:<br>т.е. к примеру запуск идет как &quot;php.exe file.php&quot; и чел спокойно может по имени файла найти его. </I><br>Может найти его и поставив бряк на CreateFileA/W!<br><br>Если в бинарник встраивать скрипт, то это можно сделать аналогично проекту node, который выполняет js-скрипты. В нём скрипты запуска и инициализации виртуальной машины v8 встроены. PHP так же опенсорсен, как и node. Разбираемся, переписываем нужные части кода, встраиваем скрипты и делаем из php.exe dll-ку (т.е. компилируем в dll). Также не забываем вставить логотип PHP согласно лицензии! Правда у меня такая задача заняла больше времени, чем правка бинарника.<br><br>Из предложенного Велиантом проще 2ой вариант.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334683&amp;user=24257&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=5" class="addthx" data-post="334683"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29109" title="03-12-2013 11:06, ранг:0.8" target="_blank">n4yk</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]n4yk[/b]','')">n4yk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=29109">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 15:05 &middot; Поправил: n4yk <br><script type="text/javascript">QU('n4yk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=n4yk" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>dant3 пишет:<br>P.S.<br>мб проще писать на чем-то нормальном? что бы не надо было дропы прятать.  </I><br>Давно об этом задумываюсь, но к сожалению в данном проекте необходима динамическая расширяемость кода в процессе работы программы и интерпретируемый язык PHP наиболее подходит здесь.<br>А защитить код банальными обфускаторами/кодироващиками и прочей фигней, которая обходится даже школьником не вариант, поэтому и решил встроить скрипт в исполняемый файл.<br><br><I>DenCoder пишет:<br>Разбираемся, переписываем нужные части кода, встраиваем скрипты и делаем из php.exe dll-ку (т.е. компилируем в dll).  </I><br>Согласен, данный метод наиболее правильный, но как Вы заметили на него уйдет много времени (Подготовка среды для компиляции, поиск нужных кусков кода и переделка их (с учетом недостатка знаний синтаксиса C и прочее), поэтому и решил что проще пару строк изменить и модифицировать готовый бинарник. <br><br>Для второго варианта я так понимаю нужно писать внешнюю Dll&#039;ку... опять же на C, с которым я мало знаком (на чистом ASM&#039;е писать dll тем более трудновыполнимо).<br><br>Исходя из всего этого,  я  так понимаю модификаций с бинарником будет не достаточно?... <br>Тогда видать остается более-меннее понятный вариант с изменением исходников и сборкой <strike>кучи г..</strike> php из официальных сорцов. Спасибо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334686&amp;user=29109&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=6" class="addthx" data-post="334686"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 15:16 &middot; Поправил: Dr0p <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
&gt; 1)Добавить код который приклеивает параметры в строку запуска в PEB (там откуда читает GetCommandLine), и переставить OEP на себя.<br><br>Не прокатит. Сабжевая инфа находится в PEB.ProcessParameters и оттуда извлекается при инициализации kernel. Далее GetCmdLine() вообще наверно не будет туда обращаться. Ну а инициализация кернел выполняется до инициализации прочей статики.<br><br>Процесс рестартуйте с нужными аргументами.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334687&amp;user=33727&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=7" class="addthx" data-post="334687"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]n4yk[/b]','')">n4yk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=29109">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 15:26 <br><script type="text/javascript">QU('n4yk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=n4yk" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Dr0p пишет:<br>Процесс рестартуйте с нужными аргументами.<br> </I><br>Как было выше сказано, запуск (перезапуск) процесса с аргументами крайне не желателен, по причине палевности этих аргументов через различные TaskManager&#039;ы. (кроме встроенного в Windows)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334689&amp;user=29109&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=8" class="addthx" data-post="334689"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 15:31 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>n4yk</b><br><br>Значит ставите в отладчике останов на GetCmdLine()/PEB.ProcessParameters, находите откуда происходит запрос и модифицируете код как надо. Не вижу проблемы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334690&amp;user=33727&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=9" class="addthx" data-post="334690"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]GroundHog[/b]','')">GroundHog</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.2 (новичок), 16thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.78'>Активность: 0.02<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26517">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 15:42 <br><script type="text/javascript">QU('GroundHog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GroundHog" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Если не можете сами накодить, то есть куча программ, которые упаковывают исполняемые файлы и данные в один контейнер, например MoleBox, по-моему Enigma тоже умеет. Или обратитесь в запросы.<br><br>Но на мой взгляд, это всё поможет лишь от честных людей.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334691&amp;user=26517&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=10" class="addthx" data-post="334691"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=33727" title="03-12-2013 11:44, ранг:47.8" target="_blank">Dr0p</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 15:46 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Да кто будет смотреть командную строку, берётся монитор в таком случае системный, например procmon, procexp и всё становится понятным, какой файл юзается. Бессмысленная затея имхо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334692&amp;user=33727&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=11" class="addthx" data-post="334692"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 15:55 <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Может проще к php прикрутить zend/ioncube и накрыть им скрипт? По крайней мере так сразу &quot;влоб&quot; скрипт не посмотришь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334693&amp;user=3136&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=12" class="addthx" data-post="334693"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]n4yk[/b]','')">n4yk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=29109">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 15:56 <br><script type="text/javascript">QU('n4yk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=n4yk" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>GroundHog пишет:<br>Если не можете сами накодить, то есть куча программ, которые упаковывают исполняемые файлы и данные в один контейнер, например MoleBox, по-моему Enigma тоже умеет. Или обратитесь в запросы.<br><br>Но на мой взгляд, это всё поможет лишь от честных людей.<br> </I><br>Об этом я тоже думал, но как я писал выше на данные протекторы частенько приходятся ложные срабатывания различных АВ. Если бы это был 1 или даже 2 антивируса, то ладно, не страшно. Но на эти протекторы с разной переодичностью лают как минимум 6 антивирусов.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334694&amp;user=29109&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=13" class="addthx" data-post="334694"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]n4yk[/b]','')">n4yk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=29109">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 16:03 <br><script type="text/javascript">QU('n4yk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=n4yk" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>Dr0p пишет:<br>Да кто будет смотреть командную строку, берётся монитор в таком случае системный, например procmon, procexp и всё становится понятным, какой файл юзается. Бессмысленная затея имхо.<br> </I><br>Так в этом и прикол, что сам скрипт будет сидеть внутри екзешника и никакие файлы не будут использоваться. т.е. php интерпритатор будет парсить самого себя и выполнять только кусок имменно его кода, а остальной код игнорировать. А если запускать с аргументами типо &quot;file.exe file.exe&quot;, то сразу будет понятно что прога вытаскивает данные из себя. Поэтому только и требуется скрыть аргументы.<br><I>Veliant пишет:<br>Может проще к php прикрутить zend/ioncube и накрыть им скрипт? По крайней мере так сразу &quot;влоб&quot; скрипт не посмотришь.  </I><br>zend легко снимается и легко опознается (дезендеры выпускают с каждым выходном новой версии) +приличный довесок в виде его библиотеки.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334695&amp;user=29109&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=14" class="addthx" data-post="334695"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 16:21 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Ну вот, ещё один товарищ делает <strike>говно</strike>защиту своего поделия, ну так а мы тут причём? UPX, упаковывай всё им.<br><br>Да, тема в разделе &quot;для новичков&quot;, но форум в целом посвящён не разработке защит, а как раз обратному.<br><br>И мне интересно,  каким же боком эта тема будет востребована? Да любой приличный шароварщик знает тысячу способов усложнения реверсинга, а не прячет файлы в теле интерпретатора, &quot;таская каштаны из костра чужими руками&quot;. Хотите писать защиту своего мегасофта - ваше право, но пишите её за пределами данного ресурса. И не надо тут про плевки в лицо - ничего личного.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334696&amp;user=6336&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=15" class="addthx" data-post="334696"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]n4yk[/b]','')">n4yk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=29109">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 16:42 &middot; Поправил: n4yk <br><script type="text/javascript">QU('n4yk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=n4yk" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Ну вот, ещё один товарищ делает говнозащиту своего поделия, ну так а мы тут причём? UPX, упаковывай всё им.  </I><br>Спасибо на &quot;добром&quot; слове. Ничего иного я и не ожидал, все что я хотел, чтобы мне подсказали /подтолкнули в нужном направлении на тему &quot;<b>как принудительно указать аргументы консольной программы в бинарнике и отучить ее вообще принимать аргументы, путем замены n&#039;ых байтов под отладчиком</b>&quot;. Какую-либо оценку данного действия я не просил и ни на что не претендую, хотя знал что будет &quot;еще один товарищ&quot;, который поскупится поделится временем/опытом и плюнет в лицо.<br><br><b>Не смотря на то, что данная тема находится в разделе &quot;для новичков&quot;.</b><br><br>Тема все еще актуальна, думаю найденный способ будет довольно универсальным для любой консольной программы и будет наверняка востребован некоторым количеством людей. Если вам сложно отвечать по существу, не тратьте свое и чужое время.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334699&amp;user=29109&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=16" class="addthx" data-post="334699"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 16:57 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22376.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Это форум не по защите софта, если что, так что ошиблись форумом.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334700&amp;user=1556&amp;forum_n=5&amp;topic=22376.html&amp;page=0&amp;anchor=17" class="addthx" data-post="334700"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Внедрение параметров консольного приложения в тело программы</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22376" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
