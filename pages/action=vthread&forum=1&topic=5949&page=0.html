<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>IDA PRO и самомодификация кода - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Очень интересует тема - обнаружение самомодифицирующегося кода (в дальнейшем просто СК). Все статьи на тему СК в основном связаны с обходом дизассемблеров и с методами такого обхода, но хочется решить обратную задачу. Толкового">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=20667'>Slinger</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> IDA PRO и самомодификация кода</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]northdemon[/b]','')">northdemon</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.93'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=5976">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 августа 2006 23:54 <br><script type="text/javascript">QU('northdemon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=northdemon" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=5949.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Очень интересует тема - обнаружение самомодифицирующегося кода (в дальнейшем просто СК). 
<br>Все статьи на тему СК в основном связаны с обходом дизассемблеров и с методами такого обхода, но хочется решить обратную задачу. 
<br>Толкового материала по обнаружению СК мне найти не удалось. 
<br>Знаком с IDA, думаю, он может решить поставленную задачу с помощью SDK&#039;ашного инструментария.
<br>Возможно, кто-нибудь уже сталкивался с подобной задачей и может &quot;наставить на путь истинный&quot;.
<br>С какого бока подходить к обнаружению СК, всё ли там завязано на копировании в стек/кучу? 
<br>
<br>Спасибо!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=88334&amp;user=5976&amp;forum_n=1&amp;topic=5949.html&amp;page=0&amp;anchor=1" class="addthx" data-post="88334"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Mordred[/b]','')">Mordred</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 39.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.76'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2766">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2006 06:20 <br><script type="text/javascript">QU('Mordred','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mordred" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=5949.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Для СК вовсе необязательно копирование в стек, тем более что в системах с DEP его просто так не исполнишь ;) Есть вариант просто править собственный код, юзая WriteProcessMemory, а еще проще - задать атрибуты секции с кодом так, чтобы можно было ее править, и трактовать код как данные, перезаписывая его..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=88358&amp;user=2766&amp;forum_n=1&amp;topic=5949.html&amp;page=0&amp;anchor=2" class="addthx" data-post="88358"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2006 09:42 <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=5949.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>northdemon пишет:
<br>думаю, он может решить поставленную задачу с помощью SDK&#039;ашного инструментария.  </I>
<br>Поставь бряк на чтение/запись в любом месте большой программы, и ты убедишься как долго будет работать IDA только из-за того, что проверяет изменился код или нет, а подобное решение через SDK, вероятно, замедлит процесс до беспредела. А вообще, если ты видишь в IDA в секции текста какую-ту абракадабру не похожую на инструкции (например, есть переходы типа jmp 00000007) и на данные (которых там в большинстве компиляторов быть не должно; если есть,  то где-то должно быть обращение к ним), то можешь на 50% быть уверен что это СК. Но это только мой опыт. Кроме того, в принципе абсолютно правильной тактики не существует <img src="img/smilies/s13.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=88375&amp;user=2449&amp;forum_n=1&amp;topic=5949.html&amp;page=0&amp;anchor=3" class="addthx" data-post="88375"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]MoonShiner[/b]','')">MoonShiner</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 186.8 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2006 14:27 <br><script type="text/javascript">QU('MoonShiner','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MoonShiner" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=5949.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>Mordred</b>, на кой хрен юзать WriteProcessMemory для своего кода?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=88445&amp;user=2&amp;forum_n=1&amp;topic=5949.html&amp;page=0&amp;anchor=4" class="addthx" data-post="88445"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Mordred[/b]','')">Mordred</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 39.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.76'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2766">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2006 17:48 <br><script type="text/javascript">QU('Mordred','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mordred" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=5949.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>MoonShiner пишет:
<br>Mordred, на кой хрен юзать WriteProcessMemory для своего кода? </I>
<br>А я разве рекомендовал это делать?<img src="img/smilies/s13.gif" alt=""> Просто говорю, что можно править его таким образом. Если секция кода не разрешена на запись, просто даешь разрешение через VirtualProtect и правишь - вполне допустимо. Другое дело, я хз, юзает ли это кто-то
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=88492&amp;user=2766&amp;forum_n=1&amp;topic=5949.html&amp;page=0&amp;anchor=5" class="addthx" data-post="88492"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]NullSession[/b]','')">NullSession</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 62.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3600">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2006 20:10 <br><script type="text/javascript">QU('NullSession','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NullSession" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=5949.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
я могу юзать и для своего кода. А также такие извраты, как например, WriteProcessMemory на адрес возврата из самой же WriteProcessMemory. Сбивает трассировку через int3. Правда, OllyDbg всё равно параметры показывает...
<br>самое сложное здесь в том, что код неотличим от данных, а хранить и то, и другое можно вперемешку, даже если назначение за каждым куском оставлять единственное.
<br>и это фатальная проблема.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=88503&amp;user=3600&amp;forum_n=1&amp;topic=5949.html&amp;page=0&amp;anchor=6" class="addthx" data-post="88503"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2006 20:52 <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=5949.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>northdemon пишет:
<br>С какого бока подходить к обнаружению СК </I>
<br>ИМХО, качественное решение получить не просто
<br>1. Определить атрибуты секций кода
<br>если есть write, то поиск всех команд, которые меняют память в области этой секции.
<br>2. Определить атрибуты секций данных
<br>если есть exec, то поиск всех переходов на выполнение области данных
<br>3. Определить все API, которые способны модифицировать память процесса и доступ на выполнение/запись
<br>если есть, то найти параметры, указывающие на код определённый выше.
<br>...потом стек и т.д.
<br>Осложняется картина тем, что статически анализировать команды вроде call EAX не всегда просто. Но можно.
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=88507&amp;user=410&amp;forum_n=1&amp;topic=5949.html&amp;page=0&amp;anchor=7" class="addthx" data-post="88507"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]northdemon[/b]','')">northdemon</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.93'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=5976">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2006 22:30 <br><script type="text/javascript">QU('northdemon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=northdemon" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=5949.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Спасибо всем за наставления. 
<br>Прояснилось, в каком направлении надо двигаться. И делов в этом направлении предстоит наворотить много <img src="img/smilies/s1.gif" alt=""> Сплошная эвристика и теория вероятностей <img src="img/smilies/s1.gif" alt="">
<br>
<br>Тему закрывать пока что не буду, возможно, ещё откликнутся люди, столкунувшиеся с обнаружением СК на практике.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=88519&amp;user=5976&amp;forum_n=1&amp;topic=5949.html&amp;page=0&amp;anchor=8" class="addthx" data-post="88519"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]NullSession[/b]','')">NullSession</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 62.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3600">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 августа 2006 20:15 <br><script type="text/javascript">QU('NullSession','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NullSession" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=5949.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
ну допустим возьмём 2. переходы на выполнение области данных могут быть разными:
<br>1. jmp/ret/call/iret и т.д.
<br>2. использование Api: CreateThread, CreateRemoteThread, WriteProcessMemory (последнее делается с затиранием адреса возврата, хотя можно и просто заменить следующий за этим код), QueueUserApc
<br>3. осложнённое использование API: два процесса с разделяемыми секциями, созданными при помощи ntdll!ZwCreateSection и использованием объектов LPC (аналог RPC, работающий тоже на разделяемых секциях). Данные пишутся в другой процесс через LPC-канал, тот при поступлении замораживает поток, и меняет eip на тот адрес, где находятся те же данные, но с адресом в другом процессе. Дело в том, что при создании разделяемой секции можно узнать адрес её в другом процессе! И создавать можно даже в системном, другое дело что ему эти данные читать не хочется. 
<br>4. seh-фреймы, тут главное заметить заполнение будущего eip
<br>
<br>некоторые программы производят какой-то анализ, например, OllyDbg. можно глянуть в него, хотя можно сделать и лучше. API-методы он ловить с полной смелостью не будет наверно. Итак, надо помнить:
<br>1. мы находимся в защищённом режиме
<br>2. мы имеем доступ к системным функциям, которые способны изменять ход выполнения программы
<br>3. мы располагаем многозадачностью и многопоточностью
<br>4. неплохо иметь качественный эмулятор
<br>__это нужно, чтобы поставить это на поток, обычно же настолько извращённым всё это дело не оказывается (мне не попадалось, но я бы попробовал это замутить).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=88674&amp;user=3600&amp;forum_n=1&amp;topic=5949.html&amp;page=0&amp;anchor=9" class="addthx" data-post="88674"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 августа 2006 14:53 <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=5949.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>NullSession пишет:
<br>мне не попадалось, но я бы попробовал это замутить </I>
<br>А не попадалось, потому что чем больше извратов, тем больше шансов для эвристики и стенки выловить такую подлянку.
<br>Про SEH ты верно вспомнил, это очень часто используется.
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=88775&amp;user=410&amp;forum_n=1&amp;topic=5949.html&amp;page=0&amp;anchor=10" class="addthx" data-post="88775"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]NullSession[/b]','')">NullSession</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 62.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3600">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 августа 2006 16:32 <br><script type="text/javascript">QU('NullSession','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NullSession" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=5949.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>Bitfry</b> что такое &quot;стенка&quot;? насчёт эвристики-то понятно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=88935&amp;user=3600&amp;forum_n=1&amp;topic=5949.html&amp;page=0&amp;anchor=11" class="addthx" data-post="88935"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ProTeuS[/b]','')">ProTeuS</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 172.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.96'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2281">Участник</a><br><font color=blue></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 августа 2006 17:51 <br><script type="text/javascript">QU('ProTeuS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ProTeuS" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=5949.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
имхо ре4ь о фаере
<br><br><font size="1"><i>-----<br>HOW MUCH BLOOD WOULD YOU SHED TO STAY ALIVE</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=89330&amp;user=2281&amp;forum_n=1&amp;topic=5949.html&amp;page=0&amp;anchor=12" class="addthx" data-post="89330"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 августа 2006 19:14 <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=5949.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>Bitfry пишет:
<br>что такое &quot;стенка&quot;? </I>
<br>Firewall&#039;ы не любят когда процессы &quot;влезают&quot; друг в друга.
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=89348&amp;user=410&amp;forum_n=1&amp;topic=5949.html&amp;page=0&amp;anchor=13" class="addthx" data-post="89348"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> IDA PRO и самомодификация кода</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#14" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="5949">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=5949" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
