<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Отладка загрузочного приложения (RollBack RX) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Интересует, отлаживал ли кто подобный софт, который грузится до системы? Какие инструменты нужно юзать, чтобы отловить момент загрузки внешнего приложения не из под винды? Сам софт: --&gt; Download&lt;-- Сломать битхаком">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a>, <a target='_blank' href='?action=userinfo&amp;user=55940'>exp50848</a> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Отладка загрузочного приложения (RollBack RX)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Kindly[/b]','')">Kindly</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1883.jpg" alt=""><br><span class=txtSm>Ранг: 275.9 (наставник), 340thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.22=0.22</span><br>Статус: <a href="action=userinfo&amp;user=1883">Участник</a><br><font color=blue>RBC</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 августа 2015 22:56 &middot; Поправил: Kindly <br><script type="text/javascript">QU('Kindly','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kindly" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Интересует, отлаживал ли кто подобный софт, который грузится до системы? <br>Какие инструменты нужно юзать, чтобы отловить момент загрузки внешнего приложения не из под винды?<br><br>Сам софт:<br><noindex><a href="http://www.horizondatasys.com/Files/Rollback_Rx_v103/Rollbackv103.zip?ProductId=1" rel="nofollow" target="_blank">--&gt; Download&lt;--</a></noindex><br><br>Сломать битхаком оказалось не большой проблемой, но единственным решением.<br>Пришлось патчить инсталлятор, чтобы он прописывал нужный байт 01 = registered при установке сабжа в загрузочную область диска. Из под винды софт пропатчить нельзя, визуально зарегистрировать можно, но проверка в предзагрузочном меню не будет проходить и будут на выхлопе нерабочие и неполные снимки.<br><br>Привязка активационного номера осуществляется по номеру диска через DeviceIoControl, также сабж имеет онлайн чек, при котором софт сбросит байт регистрации в загрузочной области диска. Чек нужно предварительно запатчить в делках x86-x64 ShdApi.dll, достаточно запатчить внутри файла имя сервака w.w.w...e.a.z.s.o.l.u.t.i.o.n...c.o.m. к слову, софт обходит лок в хосте и стучит другим методом.<br><br>Алгоритм проверки зашит в загрузчике проги, сама активация записывает введенный номер, и только в загрузчике его проверяет, выдавая сообщение о неверном номере перед загрузкой винды. Стало быть, чтобы софт закейгенить, нужно реверснуть алго именно там.<br> <br>Да, тут нет разбора других участков, но суть топика заключается в названии. Не нужно ломать софт, подсказать бы, чем и как можно это отладить. Может ли этот софт юзать дрова свои для этого или другие файлы из под винды, которая не грузилась?
<br><br><font size="1"><i>-----<br>Array[Login..Logout] of Life</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=357593&amp;user=1883&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=1" class="addthx" data-post="357593"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29533" title="03-08-2015 05:18, ранг:15.0" target="_blank">negoday</a></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 августа 2015 23:05 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
bochs+ida<br>vmware+windbg<br>итд
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=357594&amp;user=15381&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=2" class="addthx" data-post="357594"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=1883" title="01-08-2015 21:09, ранг:159.5" target="_blank">Kindly</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Kindly[/b]','')">Kindly</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1883.jpg" alt=""><br><span class=txtSm>Ранг: 275.9 (наставник), 340thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.22=0.22</span><br>Статус: <a href="action=userinfo&amp;user=1883">Участник</a><br><font color=blue>RBC</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2015 00:09 &middot; Поправил: Kindly <br><script type="text/javascript">QU('Kindly','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kindly" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Принцип понятен, только у меня вечная беда настраивать отладчики и плаги в IDA <img src="img/smilies/s4.gif" alt=""><br>Но суть теперь уловил, такой в MBR код:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">seg000<span class="hl_char">:</span><span class="hl_number">00000077</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;small&nbsp;<span class="hl_function"><b>word</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l1">seg000<span class="hl_char">:</span><span class="hl_number">0000007B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_number">0C4840012h</span></li><li class="hl_l0">seg000<span class="hl_char">:</span><span class="hl_number">00000080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">3Bh</span>&nbsp;<span class="hl_comment">; ';'</span></li><li class="hl_l1">seg000<span class="hl_char">:</span><span class="hl_number">00000082</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l0">seg000<span class="hl_char">:</span><span class="hl_number">00000083</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span><span class="hl_number">3</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">dh</span></li><li class="hl_l1">seg000<span class="hl_char">:</span><span class="hl_number">00000086</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span></li><li class="hl_l0">seg000<span class="hl_char">:</span><span class="hl_number">00000089</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">al</span></li><li class="hl_l1">seg000<span class="hl_char">:</span><span class="hl_number">0000008C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0Ch</span></li>        </ol>
    </div>
</div></div>
<br>где call    near ptr 0C4840012h - теоретически вход в сектор с процедурой проверки, либо кодом загрузчика.<br>может и не именно это, но насколько вкурил, то сам mbr имеет небольшой размер, но позволяет размещать указатели для выполнения кода из других областей диска.<br>поправьте, где не прав.
<br><br><font size="1"><i>-----<br>Array[Login..Logout] of Life</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=357595&amp;user=1883&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=3" class="addthx" data-post="357595"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2015 01:02 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<noindex><a href="https://www.youtube.com/watch?v=sT6N7Dr-G6s" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br>разбирать или трейсить бут надо, что бы сказать что это за процедура<br>но джампать по секторам оно не умеет это факт, могло списать какие то сектора в память по какому то адресу, и там уже прыгать
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=357596&amp;user=15381&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=4" class="addthx" data-post="357596"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2015 08:29 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Kindly пишет:<br>где call near ptr 0C4840012h - теоретически вход в сектор с процедурой проверки, либо кодом загрузчика.<br>может и не именно это, но насколько вкурил, то сам mbr имеет небольшой размер, но позволяет размещать указатели для выполнения кода из других областей диска.<br>поправьте, где не прав.  </I><br>в целом прав. МБР имеет достаточно четкую структуру, иначе его биос пошлет лесом. Вангую что этот калл.. это чтение загручкика с винта(1..хх) секторов. + перевод проги в 32ух разрядный режим(с этим кстати особенно аккуратно, ибо ида не понимает какие участки в какой разрядности) <br>рекомендую посмотреть исходники GRUB (линуксовый мультибутер) там и МБР и БУТ и первичный загрузчик оси<br><br><b>Добавлено спустя 4 минуты</b><br><I>reversecode пишет:<br>bochs+ida<br>vmware+windbg </I><br>qemu(gdb)+ida<br>пробовал бош, пробовал куему, оба вобщемто работают. бош можно и без иды. в обоих случаях наблюдал отслаивания иды от процесса.. т.е. она то по шагам ходит.. и дебажит, а вот позиционирование отлаживаемого когда сбивалось.. руками в консоли ставил IP на место.. частенько
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=357598&amp;user=17319&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=5" class="addthx" data-post="357598"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Kindly[/b]','')">Kindly</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1883.jpg" alt=""><br><span class=txtSm>Ранг: 275.9 (наставник), 340thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.22=0.22</span><br>Статус: <a href="action=userinfo&amp;user=1883">Участник</a><br><font color=blue>RBC</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2015 09:22 &middot; Поправил: Kindly <br><script type="text/javascript">QU('Kindly','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kindly" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>reversecode пишет:<br>разбирать или трейсить бут надо </I><br>нужно насколько понимаю дампить свой загрузчик и прикручивать его к бош для этого - опять темный лес <img src="img/smilies/s4.gif" alt=""><br><br>что если немного пованговать <img src="img/smilies/s2.gif" alt="">, вот два загрузчика, оригинальный и модифицированный софтом.<br>содержится некий код в модифицированном загрузчике. из него ли может грузиться консоль управления проги из другой области диска?<br><br><img src="img/attach.gif" alt=""> <a href="./files/484d_02.08.2015_EXELAB.rU.tgz">484d_02.08.2015_EXELAB.rU.tgz</a> - ldrs.zip<br><br><b>Добавлено спустя 8 минут</b><br>у проги есть такое файло при установке (если кто смотрел):<br><br>shdmgr.ef_<br>Shield.efi<br>shdloader.efi<br>shield.dat<br><br>судя по всему это интегрируемая предзагрузочная консоль. стало быть на эти файлы после инсталляции их в область диска идет управление из загрузчика mbr?<br><br>гм, а прога не юзает часом secured efi загрузчик? там не mbr, а gpt. спецы подскажите.
<br><br><font size="1"><i>-----<br>Array[Login..Logout] of Life</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=357599&amp;user=1883&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=6" class="addthx" data-post="357599"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2015 10:15 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<noindex><a href="http://wm-help.net/lib/b/book/259146216/50" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=357600&amp;user=17432&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=7" class="addthx" data-post="357600"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Kindly[/b]','')">Kindly</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1883.jpg" alt=""><br><span class=txtSm>Ранг: 275.9 (наставник), 340thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.22=0.22</span><br>Статус: <a href="action=userinfo&amp;user=1883">Участник</a><br><font color=blue>RBC</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2015 11:22 &middot; Поправил: Kindly <br><script type="text/javascript">QU('Kindly','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kindly" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Вобщем все понятно, загрузчик это dll<br>shdmgr.ef_<br>для каждой из разрядностей.<br><br>В нем нашел код алго, запатчил пока что в ольке ради убеждения - получил fully registered в итоге после инсталляции. Алго с виду примитивный, обычная математика начальных классов, md5 и сравнение с фиксированными символами, но вот добраться туда из под установленой проги, чтобы отреверсить со всеми значениями не представляю возможным. Загрузочная система EFI таки.
<br><br><font size="1"><i>-----<br>Array[Login..Logout] of Life</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=357601&amp;user=1883&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=8" class="addthx" data-post="357601"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2015 11:23 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
ну так распакуй efi на длл и найди нужный модуль<br>народ биосы патчит ..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=357603&amp;user=15381&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=9" class="addthx" data-post="357603"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Kindly[/b]','')">Kindly</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1883.jpg" alt=""><br><span class=txtSm>Ранг: 275.9 (наставник), 340thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.22=0.22</span><br>Статус: <a href="action=userinfo&amp;user=1883">Участник</a><br><font color=blue>RBC</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2015 11:49 &middot; Поправил: Kindly <br><script type="text/javascript">QU('Kindly','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kindly" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>reversecode пишет:<br>ну так распакуй efi на длл и найди нужный модуль </I><br>о какой распаковке речь?<br><br>чтобы активационный серийник отреверсить нужно зайти в алго на момент выполнения до загрузки винды.<br>ты бы подсказал как именно это сделать, получить управление. <img src="img/smilies/s11.gif" alt=""> патчить уже можно и в хвост и в гриву, но кейген красивше.<br><br>вот кабы в VMWare был встроенный отладчик загрузки с пошаговой трассировкой машинного кода - это был бы идеальный вариант <img src="img/smilies/s3.gif" alt="">
<br><br><font size="1"><i>-----<br>Array[Login..Logout] of Life</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=357606&amp;user=1883&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=10" class="addthx" data-post="357606"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2015 11:54 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
efi имеет свою структуру насколько я помню<br>там может быть упаковано много модулей в  ней, которые сами по себе являются обычными  dll<br>есть распаковщики этих модулей<br>в биосах efi есть момент поиска и запуска efi с диска, вот скорее всего это и происходит<br><br>как начать отлаживать всю систему начиная с биоса, я дал ссылку видео<br>или ручками разбирать всю efi которую они кладут на диск, большая она кстати ?<br><br><b>Добавлено спустя 4 минуты</b><br>http://blog.cr4.sh/2012/07/vmware-gdb-stub-ida.html<br><I>VMware + GDB stub + IDA<br>Многим известно, что в системе виртуализации VMware Worstation с самых незапамятных времен существует стандартный GDB интерфейс для удалённой отладки, однако, мало кто пользуется ним в повседневной работе в силу того, что отладку в &quot;голом&quot; GDB тяжело назвать удобной. Однако, в роли вполне вменяемого клиента для отладочного интерфейса GDB может выступать IDA Pro, в которой соответствующий функционал был добавлен ещё в 5-й ветке, но работать должным образом и без багов начал только в 6.0.</I>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=357608&amp;user=15381&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=11" class="addthx" data-post="357608"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Kindly[/b]','')">Kindly</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1883.jpg" alt=""><br><span class=txtSm>Ранг: 275.9 (наставник), 340thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.22=0.22</span><br>Статус: <a href="action=userinfo&amp;user=1883">Участник</a><br><font color=blue>RBC</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2015 16:31 &middot; Поправил: Kindly <br><script type="text/javascript">QU('Kindly','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kindly" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>reversecode</b>, ты давал линк на ютуб, где в иде уже загружена заготовка, которая загружает mbr текущей системы. как создать такую заготовку (бошевский конфиг) для иды?<br>У тебя для этой проги получилось что, или все это теория и общая практика с гугла?
<br><br><font size="1"><i>-----<br>Array[Login..Logout] of Life</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=357626&amp;user=1883&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=12" class="addthx" data-post="357626"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2015 16:46 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
для начала нужно определить там все же efi капсула ? или посто какой то файл который они переименовали в efi<br>если капсула, то нужен емулятор который умеет и имеет efi биос<br>и тут бош отпадает как мне кажется, нету под бош ефи биосов, я не видел во всяком случае<br>можно разве что поигратся, найдя гдя где то ефи биос и подсунув его в бош<br>либо искать другой емулятор который умеет ефи биос, по слухам это может быть qemu<br><br>вообщем там до проблемы конфигов далеко, да и сами конфиги есть в самом боше и в иде тоже есть заготовка<br><br><b>Добавлено спустя 1 минуту</b><br><I>Kindly пишет:<br>У тебя для этой проги получилось что, или все это теория и общая практика с гугла? </I><br>я эту прогу не смотрел, у меня своих таких хватает<br>но бош юзал по всяким разным нуждам<br>и с куему тоже когда то игрался<br><br>нету стандартных решений и волшебной кнопочки, везде нужно сидеть и разбиратся почти с нуля
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=357627&amp;user=15381&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=13" class="addthx" data-post="357627"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Kindly[/b]','')">Kindly</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1883.jpg" alt=""><br><span class=txtSm>Ранг: 275.9 (наставник), 340thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.22=0.22</span><br>Статус: <a href="action=userinfo&amp;user=1883">Участник</a><br><font color=blue>RBC</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2015 16:56 &middot; Поправил: Kindly <br><script type="text/javascript">QU('Kindly','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kindly" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>reversecode пишет:<br>для начала нужно определить там все же efi капсула ?  </I><br>анализаторы говорят что EFI Application. что-то ж его вызывает..<br><br>сам загрузчик у меня не uefi, по крайней мере на варе. Kqemu сумел воспроизвести загрузчик системы из под винды, сначала ролбэковский, потом чуть xp и повис, оно и понятно и дальше не надо. В ольке смотрел, стартует процесс эмуля с параметрами и толку с этого без дебага. <img src="img/smilies/s15.gif" alt=""><br>выходит что по сути, это точно также как и отладка бут-малвари, только в данном случае выполняется целое приложение.<br><br>покурив гугла, кажись это не из разряда UEFI Bios, а UEFI Shell, позволяющий запускать efi приложения.<br><br><I>reversecode пишет:<br>либо искать другой емулятор который умеет ефи биос, по слухам это может быть qemu </I><br>qemu может и нормальный эмуль, но под него fdbg только нашел под шелл, ну можно условно отлаживать, но не думаю, что реверс алгоритма активации в нем хорошая идея. <br>ну запустишь ты в эмуле само efi приложение и что с того, оно не будет читать данные с должной рабочей области, которой является реальный загрузчик.<br>тут системный нужно читать и разбирать как-то... может есть варианты загрузочных дебаггеров на флешку для отладки загрузчика? <img src="img/smilies/s11.gif" alt="">
<br><br><font size="1"><i>-----<br>Array[Login..Logout] of Life</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=357628&amp;user=1883&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=14" class="addthx" data-post="357628"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Psalmopoeus Pulcher[/b]','')">Psalmopoeus Pulcher</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.8 (посетитель), 23thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18297">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2015 20:55 &middot; Поправил: Psalmopoeus Pulcher <br><script type="text/javascript">QU('Psalmopoeus Pulcher','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Psalmopoeus Pulcher" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Файл x86\shdmgr.efi.<br>По смещению 0x1015F вижу функу проверки ключей, её можно дебажить в ольке. На стэке первый аргумент - указатель на &quot;ID продукта&quot;, второй - указатель на &quot;Код активации&quot;, третий - нуль. Чтобы взлетело, по смещению 0x0C280 указатель на (&quot;ID активации&quot; - 0x430), или проконтролировать edx:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00010172</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;dword_2C280</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00010178</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">430h</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001017E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00010180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_FE64</li>        </ol>
    </div>
</div></div>
<br><br>Если проверка не фейковая, то вполне себе юзабельно и можно попробовать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=357635&amp;user=18297&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=15" class="addthx" data-post="357635"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=18316" title="02-08-2015 18:17, ранг:187.2" target="_blank">SReg</a>, <a href="action=userinfo&user=29533" title="03-08-2015 05:18, ранг:15.0" target="_blank">negoday</a>, <a href="action=userinfo&user=1883" title="03-08-2015 13:53, ранг:162.5" target="_blank">Kindly</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Kindly[/b]','')">Kindly</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1883.jpg" alt=""><br><span class=txtSm>Ранг: 275.9 (наставник), 340thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.22=0.22</span><br>Статус: <a href="action=userinfo&amp;user=1883">Участник</a><br><font color=blue>RBC</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2015 21:20 <br><script type="text/javascript">QU('Kindly','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kindly" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>Psalmopoeus Pulcher</b>, да, есть последняя мысль разобрать в статике, забить адреса и значения ID продукта/ID активации и прочее подменить. проверка не фейковая, об этом писал в восьмом сообщении.
<br><br><font size="1"><i>-----<br>Array[Login..Logout] of Life</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=357636&amp;user=1883&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=16" class="addthx" data-post="357636"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Psalmopoeus Pulcher[/b]','')">Psalmopoeus Pulcher</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.8 (посетитель), 23thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18297">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2015 20:56 &middot; Поправил: Psalmopoeus Pulcher <br><script type="text/javascript">QU('Psalmopoeus Pulcher','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Psalmopoeus Pulcher" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Как еще, актуально?<br>Я у себя сделал ключ. Ввожу, просит перезагрузить, перезагружаю, до загрузки винды благодарит за регистрацию, загружается винда - опять демо. Wtf?<br><br><b>Kindly</b>, ты кроме этой функи патчил что-нибудь? Может я что то упустил из виду.<br><br><b>Upd.</b> &quot;ID продукта&quot; походу тоже нужно генерировать новый. Займусь завтра.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=357653&amp;user=18297&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=17" class="addthx" data-post="357653"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=1883" title="05-08-2015 08:26, ранг:163.5" target="_blank">Kindly</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Kindly[/b]','')">Kindly</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1883.jpg" alt=""><br><span class=txtSm>Ранг: 275.9 (наставник), 340thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.22=0.22</span><br>Статус: <a href="action=userinfo&amp;user=1883">Участник</a><br><font color=blue>RBC</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2015 21:27 &middot; Поправил: Kindly <br><script type="text/javascript">QU('Kindly','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kindly" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=23696.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>Psalmopoeus Pulcher</b>, я тоже продвигаюсь потихоньку, там не совсем начальные классы, но до проверки с серийником &quot;трансформером&quot; я дошел. Почитай где онлайн чек в первом посте. Только пока что не подсказывай, я уже где то рядом <img src="img/smilies/s3.gif" alt=""><br><br><b>Upd</b><br><I>Psalmopoeus Pulcher пишет:<br>&quot;ID продукта&quot; походу тоже нужно генерировать новый. </I><br>на раннем этапе его можно не генерить, он проходит Product ID проверку, а в дальнейшем можно. не думаю, что тот серийник влияет на регу, там вроде две основные проверки, одну я уже обошел, там мешаются цифры, типа:<br>1 рандом<br>2 рандом<br>3 рандом<br>4 рандом - идентификатор сдвига таблички<br>5 четырнадцатый<br>6 двадцать первый<br>и т.д.<br>по таблице.<br>генерится хвост для него (деление с остатком, и плюсовка остатков, данные для деления берутся из куска md5 хэша сложеных серийников и кастомной строки), потом нужно прописать последовательность, чтобы при размешаном серийнике проверяемые данные собрались в нужную кучу. далее вторая проверка примерно такая же но в обратном порядке, опять перетасовываются цифры уже другой последовательности и проверяются.<br><br><b>Upd2</b><br>алго разобрал<br><br><b>Upd3</b><br><I>Psalmopoeus Pulcher пишет:<br>&quot;ID продукта&quot; походу тоже нужно генерировать новый. </I><br>да, полностью закейгенил Activation Code и убедился, что демо номерок не катит.
<br><br><font size="1"><i>-----<br>Array[Login..Logout] of Life</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=357654&amp;user=1883&amp;forum_n=1&amp;topic=23696.html&amp;page=0&amp;anchor=18" class="addthx" data-post="357654"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29533" title="07-08-2015 10:03, ранг:15.0" target="_blank">negoday</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Отладка загрузочного приложения (RollBack RX)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#19" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="23696">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23696" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
