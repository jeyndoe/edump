<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Непонятная ошибка открытия драйвера FEnteDev (hardlock.sys) смахивает на защиту - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброго всем времени суток! Прошу опытных и не очень кодеров, реверсеров и крякеров помочь разобраться. Нонсенс какой-то и в интернете что-то ссылей поубавилось раз в 1000 или и не было вовсе. Толком ничего нет ни о FEnteDev, ни">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=42610'>r0lka</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a>, <a target='_blank' href='?action=userinfo&amp;user=55550'>testrev1337</a>, <a target='_blank' href='?action=userinfo&amp;user=19256'>johnniewalker</a>, <a target='_blank' href='?action=userinfo&amp;user=55914'>Kybyx</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Непонятная ошибка открытия драйвера FEnteDev (hardlock.sys) смахивает на защиту</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2010 01:06 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=16054.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброго всем времени суток! Прошу опытных и не очень кодеров, реверсеров и крякеров помочь разобраться. Нонсенс какой-то и в интернете что-то ссылей поубавилось раз в 1000 или и не было вовсе. Толком ничего нет ни о FEnteDev, ни о hardlock.sys.<br><br>Пытаюсь запустить игру от фирмы LLC STRIKE из-под своего загрузчика. Игра защищена HASP. Не выходит, хотя без него пашет нормально. Разобрался с логами, причина этому - не может открыть &quot;\.\FEnteDev&quot; в n-ый раз, получает INVALID_HANDLE_VALUE и выводит &quot;Error 1009: Cannot open HASP HL Drivers&quot;. Добавил для таких случаев GetLastError и прогнал еще раз. Вышло так:<br><br>Thread: 000000C4<br>Begin call CreateFileA(<br>lpFileName = &quot;\.\FEnteDev&quot;<br>dwDesiredAccess = C0000000<br>dwSharedMode = 00000003<br>lpSecurityAttributes = 00000000<br>dwCreationDisposition = 00000003<br>dwFlagsAndAttributes = 00000000<br>hTemplateFile = 00000000)<br>Return: [bshell32.dll].11C4C2F1<br><br>Thread: 000000C4<br>CreateFileA end<br>Result: FFFFFFFF<br>Error: 87(ERROR_INVALID_PARAMETER)<br><br>Точно такой же, аналогичный вызов CreateFile до этого проходит без ошибок. Разница в вызовах лишь в том, что в предыдущем адрес возврата в exe-модуль и потоки разные... ну и открытие в последнем случае из DllMain (или DllEntryPoint), MessageBox за ним там же. И в итоге LoadLibrary(&quot;bshell32.dll&quot;) возвращает 0, Last Error = 1114. Как такое может быть? - Моя тулза здесь ничего не подменяет, если б драйвер не был закрыт, код ошибки был бы другой... У кого какие идеи есть? Может, кто-то уже сталкивался с подобным?<br><br>P.S. Форумом не допускается двойной слеш ))) \
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255403&amp;user=24257&amp;forum_n=2&amp;topic=16054.html&amp;page=0&amp;anchor=1" class="addthx" data-post="255403"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]NikolayD[/b]','')">NikolayD</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 189.9 (ветеран), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.36'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24529">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2010 01:35 <br><script type="text/javascript">QU('NikolayD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NikolayD" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=16054.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
посмотри <br>www.woodmann.com/forum/archive/index.php/t-2210.html<br>bugs.etersoft.ru/show_bug.cgi?id=3066<br>ediusforum.grassvalley.com/forum/showthread.php?t=2106
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=255406&amp;user=24529&amp;forum_n=2&amp;topic=16054.html&amp;page=0&amp;anchor=2" class="addthx" data-post="255406"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2010 01:41 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=16054.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
1 и 3 мимо. 2 уже читал, тоже не то. Спасибо.<br><br>________________________________________<br>Даю описание алгоритма, что делается.<br><br>1) Перехватывается GetProcAddress;<br><br>2) Сравнивается имя ф-ции, если CreateFileA или CreateFileW, выделяется память под код перехватчика, компилится маленький кодик перехватчика в зависимости от условий, в map заносится пара адресов, оригинальный и перехватчика, возвращаемый адрес подменяется на Entry этого кода, дабы не установить хук дважды. Память выделяется VirtualAlloc, если ни в какой выделенной ранее странице нет достаточного места (свой менеджер памяти);<br><br>3) Программа, получающая адрес, получает новый адрес;<br><br>...<br><br>4) Вызов CreateFileA или CreateFileW попадает на код перехватчика, в котором до реального вызова вызывается преобработчик со всеми параметрами и с адресом возврата в вызвающую программу. В преобработчике вызывается:<br><br>- GetModuleHandleEx для определения хендла модуля, из которого совершен вызов ф-ции;<br><br>- GetModuleFileName для определения имени модуля, strrchr урезает его полный путь;<br><br>- sprintf форматирует строку для передачи серверу (msvcr90x.dll не используется);<br><br>- Подготавливается буфер для передачи текста и дается сигнал серверу ф-цией SetEvent. Для каждого потока программы предварительно создана пара именованных Event&#039;ов;<br><br>- Ожидается ответный сигнал от сервера после обработки сообщения;<br><br>- Сервер читает из переданного ему ранее (при создании потока) входного буфера в исследуемом процессе ф-цией ReadProcessMemory, затем в выходной буфер пишет ответ (WriteProcessMemory) и дает сигнал о продолжении работы потока;<br><br>5) управление возвращается в код перехватчика, который передает все параметры ф-ции;<br><br>6) После отработки ф-ции управление возвращается в перехватчик и вызывается постобработчик;<br><br>7) В постобработчике действия, как и в пре-, только без GetModuleHandleEx и GetModuleFileName, результат ф-ции возврашается вызывающей программе.<br><br>Есть здесь один момент, указывающий на возможную ошибку: в передаче параметров самой ф-ции. Но это исключается, т.к. параметры передаются, копируя их из стека и нигде не предусмотрены изменения в скомпиленном asm-коде. Кроме того, как выше писалось, с такими же параметрами функция вызывалась без ошибки. Ну что может быть? В чем дело?<br><br>________________________________________________________________<br><br>Нашел, как игра переключает видеорежим. Это ChangeDisplaySettingsEx с параметром CDS_FULLSCREEN. Также, как блокируется Alt-TAB. Это SetWindowsHookEx с типом хука WH_KEYBOARD_LL (0x0D). Так что, не дожидаясь ответа, попробую перехватить то, что нужно, подменить параметры, брякнкнуться на CreateFile и подцепиться Олей...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255407&amp;user=24257&amp;forum_n=2&amp;topic=16054.html&amp;page=0&amp;anchor=3" class="addthx" data-post="255407"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 апреля 2010 07:47 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=16054.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Не, докопался до NtCreateFile, дальше ВСЁ... <img src="img/smilies/s11.gif" alt=""><br><br>Вот такие аргументы передаются этой ф-ции<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">[</span><span class="hl_function">OUT</span><span class="hl_char">]</span>PHANDLE&nbsp;pFileHandle&nbsp;<span class="hl_char">=</span>&nbsp;0x12EA10<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x80000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x40000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x00100000&nbsp;&nbsp;&nbsp;&nbsp;0x00000080</span></li><li class="hl_l0"><span class="hl_char">[</span><span class="hl_function">IN</span><span class="hl_char">]</span>ACCESS_MASK&nbsp;DesiredAccess&nbsp;<span class="hl_char">=</span>&nbsp;GENERIC_READ&nbsp;<span class="hl_char">|</span>&nbsp;GENERIC_WRITE&nbsp;<span class="hl_char">|</span>&nbsp;SYNCHRONIZE&nbsp;<span class="hl_char">|</span>&nbsp;FILE_READ_ATTRIBUTES<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_char">[</span><span class="hl_function">IN</span><span class="hl_char">]</span>POBJECT_ATTRIBUTES&nbsp;pObjectAttributes&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0012E9B0</span><span class="hl_comment">;</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;ULONG&nbsp;Length&nbsp;<span class="hl_char">=</span>&nbsp;0x18<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;HANDLE&nbsp;RootDirectory&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;PUNICODE_STRING&nbsp;pObjectName&nbsp;<span class="hl_char">=</span>&nbsp;0x0012E9F0<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;USHORT&nbsp;Length&nbsp;<span class="hl_char">=</span>&nbsp;0x18<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;USHORT&nbsp;MaximumLength&nbsp;<span class="hl_char">=</span>&nbsp;0x1A<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;PWSTR&nbsp;Buffer&nbsp;<span class="hl_char">=</span>&nbsp;0x275E28<span class="hl_comment">;// &quot;\??\FEnteDev&quot;</span></li><li class="hl_l0">&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;ULONG&nbsp;Attributes&nbsp;<span class="hl_char">=</span>&nbsp;OBJ_CASE_INSENSITIVE<span class="hl_comment">;//0x0040</span></li><li class="hl_l0">&nbsp;&nbsp;PVOID&nbsp;pSecurityDesriptor&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>PSECURITY_QUALITY_OF_SERVICE</li><li class="hl_l0">&nbsp;&nbsp;PVOID&nbsp;pSecurityQualityOfService&nbsp;<span class="hl_char">=</span>&nbsp;0x0012E9D4<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;Length&nbsp;<span class="hl_char">=</span>&nbsp;0x0C<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;SECURITY_IMPERSONATION_LEVEL&nbsp;ImpersonationLevel&nbsp;<span class="hl_char">=</span>&nbsp;SecurityImpersonation<span class="hl_comment">;//2</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;SECURITY_CONTEXT_TRACKING_MODE&nbsp;ContextTrackingMode&nbsp;<span class="hl_char">=</span>&nbsp;SECURITY_STATIC_TRACKING<span class="hl_comment">;//FALSE</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;BOOLEAN&nbsp;EffectiveOnly&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>FALSE</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;}</li><li class="hl_l1">}</li><li class="hl_l0"><span class="hl_char">[</span><span class="hl_function">OUT</span><span class="hl_char">]</span>PIO_STATUS_BLOCK&nbsp;pIoStatusBlock&nbsp;<span class="hl_char">=</span>&nbsp;0x12E9E8<span class="hl_comment">;</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;NTSTATUS&nbsp;NtStatus<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;Information<span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>On&nbsp;return&nbsp;Information&nbsp;will&nbsp;one&nbsp;of</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>FILE_CREATED&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>FILE_OPENED&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>FILE_OVERWRITTEN&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>FILE_SUPERSEDED&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>FILE_EXISTS&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>FILE_DOES_NOT_EXIST&nbsp;</li><li class="hl_l0"><span class="hl_char">[</span><span class="hl_function">IN</span><span class="hl_char">]</span>PLARGE_INTEGER&nbsp;pAllocationSize&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_char">[</span><span class="hl_function">IN</span><span class="hl_char">]</span>ULONG&nbsp;FileAttributes&nbsp;<span class="hl_char">=</span>&nbsp;FILE_ATTRIBUTE_NORMAL<span class="hl_comment">;//0</span></li><li class="hl_l0"><span class="hl_char">[</span><span class="hl_function">IN</span><span class="hl_char">]</span>ULONG&nbsp;ShareAccess&nbsp;<span class="hl_char">=</span>&nbsp;FILE_SHARE_READ&nbsp;<span class="hl_char">|</span>&nbsp;FILE_SHARE_WRITE<span class="hl_comment">;//3</span></li><li class="hl_l1"><span class="hl_char">[</span><span class="hl_function">IN</span><span class="hl_char">]</span>ULONG&nbsp;CreateDisposition&nbsp;<span class="hl_char">=</span>&nbsp;FILE_OPEN<span class="hl_comment">;//1</span></li><li class="hl_l0"><span class="hl_char">[</span><span class="hl_function">IN</span><span class="hl_char">]</span>ULONG&nbsp;CreateOptions&nbsp;<span class="hl_char">=</span>&nbsp;FILE_SYNCHRONOUS_IO_NONALERT&nbsp;<span class="hl_char">|</span>&nbsp;FILE_NON_DIRECTORY_FILE<span class="hl_comment">;//0x60</span></li><li class="hl_l1"><span class="hl_char">[</span><span class="hl_function">IN</span><span class="hl_char">]</span>PVOID&nbsp;pEaBuffer&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_char">[</span><span class="hl_function">IN</span><span class="hl_char">]</span>ULONG&nbsp;EalEngth&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>Возвращает в NtStatus STATUS_INVALID_PARAMETER. В чем дело? Может защита обнаруживает проникновение и блокирует доступ к драйверу?<br><br>Нужен совет Clerk&#039;а!
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255470&amp;user=24257&amp;forum_n=2&amp;topic=16054.html&amp;page=0&amp;anchor=4" class="addthx" data-post="255470"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 апреля 2010 09:52 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=16054.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Залез идой в ntoskrnl, глянул на ф-цию KiSystemService. Открыл последный креш дамп, посмотел таблицы количества аргументов и функций. Оказывается, с установленным эмулятором HASP NtCreateFile перенаправляется в hardlock.sys через jmp dword ptr [833E84CAh] на адрес f58d32d8. hardlock.sys версии 3.40. Может кто-нибудь уже сталкивался с hardlock.sys? Очень нужна любая информация.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255473&amp;user=24257&amp;forum_n=2&amp;topic=16054.html&amp;page=0&amp;anchor=5" class="addthx" data-post="255473"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]BfoX[/b]','')">BfoX</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 397.0 (мудрец), 179thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.17<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=1865">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 апреля 2010 10:50 <br><script type="text/javascript">QU('BfoX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BfoX" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=16054.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>DenCoder</b> а с эмулятором никак? <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>...или ты работаешь хорошо, или ты работаешь много...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255481&amp;user=1865&amp;forum_n=2&amp;topic=16054.html&amp;page=0&amp;anchor=6" class="addthx" data-post="255481"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 апреля 2010 12:11 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=16054.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
А про что я пишу-то? <img src="img/smilies/s1.gif" alt="">.... Мда, столько написал... Эмулятор стоит, hardlock.sys - это как раз и есть его драйвер.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255493&amp;user=24257&amp;forum_n=2&amp;topic=16054.html&amp;page=0&amp;anchor=7" class="addthx" data-post="255493"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]BfoX[/b]','')">BfoX</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 397.0 (мудрец), 179thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.17<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=1865">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 апреля 2010 20:31 <br><script type="text/javascript">QU('BfoX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BfoX" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=16054.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
я хз про что вы тут пишете - возьмите мультикей или vusbbus и не парьтесь...
<br><br><font size="1"><i>-----<br>...или ты работаешь хорошо, или ты работаешь много...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255541&amp;user=1865&amp;forum_n=2&amp;topic=16054.html&amp;page=0&amp;anchor=8" class="addthx" data-post="255541"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Larry[/b]','')">Larry</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/1102.jpg" alt=""><br><span class=txtSm>Ранг: 114.4 (ветеран), 21thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.51'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=1102">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 апреля 2010 21:53 &middot; Поправил: Larry <br><script type="text/javascript">QU('Larry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Larry" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=16054.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>BfoX пишет:<br>я хз про что вы тут пишете ...</I><br>Вероятно, про муль от SafeKey.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=255545&amp;user=1102&amp;forum_n=2&amp;topic=16054.html&amp;page=0&amp;anchor=9" class="addthx" data-post="255545"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 апреля 2010 23:46 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=16054.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>BfoX пишет:<br>я хз про что вы тут пишете </b><br>Еще раз: без инжекта в прогу, защищенную хаспом, эмуль пашет нормально, с инжектом - на пятый раз драйвер не открывается. Подробное описание проблемы изложено<br><br><b>BfoX пишет:<br>возьмите мультикей или vusbbus и не парьтесь...</b><br>Возьмусь, но у меня ж пытливый ум, хочу знать точную причину - защита это или ошибка дрова эмулятора. Чтоб потом, когда столкнусь опять - знать, что к чему. <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255554&amp;user=24257&amp;forum_n=2&amp;topic=16054.html&amp;page=0&amp;anchor=10" class="addthx" data-post="255554"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 апреля 2010 06:42 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=16054.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Yahoo!!! Наконец понял, в чем дело: на подмену оригинального адреса ф-ции DeviceIoControl драйвер реагирует неадекватно. Передается где-то адрес ее в одном из блоков по 0x100 байт в шифрованном или нет виде, при этом драйвер похоже зацикливается - не стал дальше разбираться. То есть диагноз - ОШИБКА ДРАЙВЕРА. Заменил тип хука и проблем больше нет.<br><br>Всем спасибо! Тему пока не закрываю - может у кого-то будут вопросы...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255562&amp;user=24257&amp;forum_n=2&amp;topic=16054.html&amp;page=0&amp;anchor=11" class="addthx" data-post="255562"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]BfoX[/b]','')">BfoX</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 397.0 (мудрец), 179thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.17<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=1865">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 апреля 2010 08:59 <br><script type="text/javascript">QU('BfoX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BfoX" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=16054.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>Larry</b><br>это я как раз знаю, просто походу <b>DenCoder</b> не ищет легких путей...
<br><br><font size="1"><i>-----<br>...или ты работаешь хорошо, или ты работаешь много...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255566&amp;user=1865&amp;forum_n=2&amp;topic=16054.html&amp;page=0&amp;anchor=12" class="addthx" data-post="255566"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 апреля 2010 14:38 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=16054.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>BfoX</b>, а сколько бы времени заняло у меня перебрать все эмуляторы хаспа и подобрать нужный? Тем более у меня, поскольку я в них не разбираюсь. У меня оно как будто есть. И потом я преследую сразу две цели: сделать загрузчик для проекта и написать тулзу... <img src="img/smilies/s1.gif" alt=""> <br><br>Так что спорный вопрос, какой из путей более легкий... для меня во всяком случае.<br><br>Утилита для этого проекта уже дальше некуда, развиваться будет, когда закончу проект...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255589&amp;user=24257&amp;forum_n=2&amp;topic=16054.html&amp;page=0&amp;anchor=13" class="addthx" data-post="255589"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]BfoX[/b]','')">BfoX</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 397.0 (мудрец), 179thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.17<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=1865">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 апреля 2010 16:24 <br><script type="text/javascript">QU('BfoX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BfoX" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=16054.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>DenCoder</b>, я ничего не перебирал. использую сорец, который у меня есть... тем более если вам придется портировать свой проект на вынь 7 или висту это не будет хорошо...<br><br>хотя каждый сам себе указатель.
<br><br><font size="1"><i>-----<br>...или ты работаешь хорошо, или ты работаешь много...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255601&amp;user=1865&amp;forum_n=2&amp;topic=16054.html&amp;page=0&amp;anchor=14" class="addthx" data-post="255601"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 апреля 2010 18:33 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=16054.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Вот когда коснется сунь-и-высуни 7 - будет, млин, отдельная тема...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255608&amp;user=24257&amp;forum_n=2&amp;topic=16054.html&amp;page=0&amp;anchor=15" class="addthx" data-post="255608"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Непонятная ошибка открытия драйвера FEnteDev (hardlock.sys) смахивает на защиту</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#16" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="2">
<input type="hidden" name="topic" value="16054">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=16054" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
