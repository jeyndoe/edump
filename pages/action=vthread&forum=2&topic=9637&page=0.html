<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>USB Lyzer 1.0 (MFC) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Привет. В общем есть прога - залил сюда http://dump.ru/files/h/h23486100/ http://dump.ru/files/h/h23486100/ (1.1Мб) Анализатор USB трафика. Как заведено триал на 30 дней... Стал копатся, пакеров протов нету, Visual C++ с Debug">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55992'>padad42664</a>, <a target='_blank' href='?action=userinfo&amp;user=55991'>kris_sexy</a>, <a target='_blank' href='?action=userinfo&amp;user=42623'>site-pro</a>, <a target='_blank' href='?action=userinfo&amp;user=50833'>vasilevradislav</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> USB Lyzer 1.0 (MFC)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 13:48 &middot; Поправил: cppasm <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Привет.<br>В общем есть прога - залил сюда http://dump.ru/files/h/h23486100/ http://dump.ru/files/h/h23486100/  (1.1Мб)<br>Анализатор USB трафика. Как заведено триал на 30 дней...<br>Стал копатся, пакеров протов нету, Visual C++ с Debug info, по коду видно что юзали MFC.<br>В общем хочу ключген сделать, но проблема в том что не могу найти где оно введённый ключ читает <img src="img/smilies/s16.gif" alt=""><br>Для ввода ключа создаётся диалог при помощи CreateDialogIndirectParamW.<br>Процедура создания диалога находится тут: 42F700h<br>Процедура обработки сообщений диалога 468CA7h:<br><br>00468CA7   . 817C24 08 1001&gt;CMP DWORD PTR SS:[ESP+8],110             ;  RegCodeDlgProc<br>00468CAF   . 75 2B          JNZ SHORT USBlyzer.00468CDC<br>00468CB1   . FF7424 04      PUSH DWORD PTR SS:[ESP+4]<br>00468CB5   . E8 54C9FFFF    CALL USBlyzer.0046560E<br>00468CBA   . 50             PUSH EAX<br>00468CBB   . 68 38E54900    PUSH USBlyzer.0049E538<br>00468CC0   . E8 9EB3FFFF    CALL USBlyzer.00464063<br>00468CC5   . 59             POP ECX<br>00468CC6   . 85C0           TEST EAX,EAX<br>00468CC8   . 59             POP ECX<br>00468CC9   . 74 0C          JE SHORT USBlyzer.00468CD7<br>00468CCB   . 8B10           MOV EDX,DWORD PTR DS:[EAX]<br>00468CCD   . 8BC8           MOV ECX,EAX<br>00468CCF   . FF92 BC000000  CALL DWORD PTR DS:[EDX+BC]<br>00468CD5   . EB 07          JMP SHORT USBlyzer.00468CDE<br>00468CD7   &gt; 6A 01          PUSH 1<br>00468CD9   . 58             POP EAX<br>00468CDA   . EB 02          JMP SHORT USBlyzer.00468CDE<br>00468CDC   &gt; 33C0           XOR EAX,EAX<br>00468CDE   &gt; C2 1000        RETN 10<br>00468CE1   . B8 58E54900    MOV EAX,USBlyzer.0049E558<br>00468CE6   . C3             RETN<br><br>Как видно обрабатывает только WM_INITDIALOG.<br>WM_COMMAND, WM_KEYDOWN, WM_CHAR нету вообще...<br>После создания диалога тоже нигде не видно чтения введённой строки :/<br>Вот собственно вопрос - кто чего скажет, как оно рег код читает?<br>Может у кого опыта больше, IDA грит что это MFC.<br><br>Момент второй, прога валится тут:<br>0042F745  |. E8 B89A0300    CALL USBlyzer.00469202                   ;  SerialDlg<br>0042F74A  |. 83F8 01        CMP EAX,1<br>0042F74D  |. 75 79          JNZ SHORT USBlyzer.0042F7C8<br>0042F74F  |. 8B4424 64      MOV EAX,DWORD PTR SS:[ESP+64]<br>0042F753  |. 85C0           TEST EAX,EAX<br>0042F755  |. 74 43          JE SHORT USBlyzer.0042F79A      &lt;--------------- тут переход должен не выполниться<br><br>Если запатчить на нопы - всегда будет говорить что зарегались при вводе ключа, но ясно что это неправда.<br>Вот это тоже непонятно - потому как эта ячейка памяти инициализируется тут:<br><br>0042DBE0  /&#036; 8B4424 04      MOV EAX,DWORD PTR SS:[ESP+4]<br>0042DBE4  |. 56             PUSH ESI<br>0042DBE5  |. 50             PUSH EAX<br>0042DBE6  |. 8BF1           MOV ESI,ECX<br>0042DBE8  |. 68 82000000    PUSH 82<br>0042DBED  |. E8 5BB50300    CALL USBlyzer.0046914D ; CDialog::CDialog(int, CObject *)<br>0042DBF2  |. 33C0           XOR EAX,EAX<br>0042DBF4  |. C706 780D4800  MOV DWORD PTR DS:[ESI],USBlyzer.00480D78 ;  ASCII &quot;YcG&quot;<br>0042DBFA  |. 8946 5C        MOV DWORD PTR DS:[ESI+5C],EAX<br>0042DBFD  |. 8946 60        MOV DWORD PTR DS:[ESI+60],EAX &lt;------- вот она<br>0042DC00  |. 8BC6           MOV EAX,ESI<br>0042DC02  |. 5E             POP ESI<br>0042DC03  \. C2 0400        RETN 4<br><br>Т.е. в неё всегда пишется ноль, других обращений нету...<br>Может эту прогу вообще нормально зарегать нельзя, я уже не врубаюсь что-то...<br>Уже даже просто интересно, да и прога нужна...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151741&amp;user=6859&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=1" class="addthx" data-post="151741"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]kaiZer[/b]','')">kaiZer</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 161.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6835">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 13:58 <br><script type="text/javascript">QU('kaiZer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kaiZer" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
ставь бряки на GetDlgItemTextA или GetDlgItemTextW..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151743&amp;user=6835&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=2" class="addthx" data-post="151743"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]xlETO[/b]','')">xlETO</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3684">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 14:06 <br><script type="text/javascript">QU('xlETO','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xlETO" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
На Взоре 9 августа выложена SysNucleus USBTrace 2.0.28.<br>Посмотри, может устроит и заморачиваться не надо будет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151744&amp;user=3684&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=3" class="addthx" data-post="151744"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 14:15 &middot; Поправил: cppasm <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>kaiZer пишет:<br>ставь бряки на GetDlgItemTextA или GetDlgItemTextW.. </I><br>Сча бум пробовать...<br><I>xlETO пишет:<br>На Взоре 9 августа выложена SysNucleus USBTrace 2.0.28. <br>Посмотри, может устроит и заморачиваться не надо будет. </I><br>Дело интереса <img src="img/smilies/s1.gif" alt=""><br>USBTrace я вчера сам закейгенил, а точнее модифицировал свой кейген от версии 1.3<br>Возможности у них немного разные, в смысле они в разные места фильтры инсталят - USBTrace не всё ловит.<br><br>---- Добавлено: ----<br>На GetDlgItemInt, GetDlgItemTextA, GetDlgItemTextW не брякаеццо <img src="img/smilies/s9.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151746&amp;user=6859&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=4" class="addthx" data-post="151746"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 14:20 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
0042DCED   .  E8 4E000300   CALL USBlyzer.0045DD40                   ; \USBlyzer.0045DD40<br>0042DCF2   .  3BC3                 CMP EAX,EBX<br>0042DCF4   .  0F84 06020000 JE USBlyzer.0042DF00<br><br>Первый Call вроде проверяет... потом JE не должен сработать (EAX&lt;&gt;EBX)
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=151748&amp;user=6946&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=5" class="addthx" data-post="151748"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 14:25 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Isaev</b> оч похоже что оно <img src="img/smilies/s1.gif" alt=""><br>а как нашёл - типа удочку давай а не рыбу <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151749&amp;user=6859&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=6" class="addthx" data-post="151749"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]kaiZer[/b]','')">kaiZer</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 161.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6835">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 14:56 <br><script type="text/javascript">QU('kaiZer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kaiZer" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
вот собсно и интересный код:<br><br>0042F745  |. E8 B89A0300    CALL USBlyzer.00469202<br>0042F74A     83F8 01        CMP EAX,1<br>0042F74D  |. 75 79          JNZ SHORT USBlyzer.0042F7C8<br>0042F74F     8B4424 64      MOV EAX,DWORD PTR SS:[ESP+64] - в ЕАХ кладется 0, а надо 1<br>0042F753     85C0           TEST EAX,EAX<br>0042F755     74 43          JE SHORT USBlyzer.0042F79A - если ЕАХ=0, то непрально<br>0042F757  |. 8B4424 78      MOV EAX,DWORD PTR SS:[ESP+78]<br>0042F75B  |. BE 982E4B00    MOV ESI,USBlyzer.004B2E98                ;  UNICODE &quot;Thank you for registration! Please restart the application to complete the registration.&quot;<br>0042F760  |. 85C0           TEST EAX,EAX<br>0042F762  |. 75 05          JNZ SHORT USBlyzer.0042F769<br>0042F764  |. BE 602E4B00    MOV ESI,USBlyzer.004B2E60                ;  UNICODE &quot;Thank you for registration!&quot;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151757&amp;user=6835&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=7" class="addthx" data-post="151757"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 14:58 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Да, и тут у меня попутно вопрос.<br>Я полазил, посметрел - скорее всего место нашлось по GetWindowTextW<br>Вот как раз по этому поводу вопрос, давно спросить хотел <img src="img/smilies/s1.gif" alt=""><br>В общем если поставить бряк на GetWindowTextA/W - он будет срабатывать сразу при активации окна.<br>В смысле с окна Olly переключаемся на прогу - и сразу бряк срабатывает.<br>Так нифига отлаживать вообще не возможно.<br>Так вопрос:<br>1. какого фига оно срабатывает постоянно<br>2. мож я бряк неправильно как-то ставлю, или условный бряк ставить?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151758&amp;user=6859&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=8" class="addthx" data-post="151758"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]kaiZer[/b]','')">kaiZer</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 161.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6835">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 15:08 <br><script type="text/javascript">QU('kaiZer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kaiZer" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>cppasm</b><br>Ну дык это походу просто считывается текст в окне, а не считывается серийник..<br>А мот затем и серийник..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151759&amp;user=6835&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=9" class="addthx" data-post="151759"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 15:15 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>kaiZer пишет:<br>вот собсно и интересный код: </I><br>Дык собстна я этот код в первом посте и привёл.<br>Вот только в EAX там единица никак не получится, потому как где оно в ноль устанавливается я писал, а вот где не в ноль - так и не нашёл.<br><I>kaiZer пишет:<br>Ну дык это походу просто считывается текст в окне, а не считывается серийник.. <br>А мот затем и серийник.. </I><br>В данном случае потом и серийник тоже, только вот вопрос как его отлаживать если при переходе в окно проги сразу ловим бряк?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151762&amp;user=6859&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=10" class="addthx" data-post="151762"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]kaiZer[/b]','')">kaiZer</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 161.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6835">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 15:27 <br><script type="text/javascript">QU('kaiZer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kaiZer" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Ну значит этот бряк не катит..<br>А ЕАХ вообще можно подменить, но надо прально подменить..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151765&amp;user=6835&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=11" class="addthx" data-post="151765"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 15:46 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>kaiZer пишет:<br>Ну значит этот бряк не катит..  </I><br>Дык он во всех прогах таким макаром не катит - но как-то же люди юзают.<br>Вот и вопрос - как?<br><I>kaiZer пишет:<br>А ЕАХ вообще можно подменить, но надо прально подменить.. </I><br>Не покатит заменить - оно при старте в другом месте где-то проверяет ключ...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151772&amp;user=6859&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=12" class="addthx" data-post="151772"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]kaiZer[/b]','')">kaiZer</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 161.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6835">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 16:07 <br><script type="text/javascript">QU('kaiZer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kaiZer" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
чаще всего юзают GetDlgItemTextA, GetDlgItemTextW..<br>плюс анализ кода
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151777&amp;user=6835&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=13" class="addthx" data-post="151777"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 16:40 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>kaiZer пишет:<br>чаще всего юзают GetDlgItemTextA, GetDlgItemTextW..  </I><br>Но тут оно не катит...<br><br>Ладно, может <b>Isaev</b> расскажет как это место нашёл - подождём.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151786&amp;user=6859&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=14" class="addthx" data-post="151786"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 18:32 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Чтобы найти куда записывается строка, я ввожу обычно в окне что-нибудь zB: &quot;123666&quot;, потом ничего не нажимая в Olly в Memory map поиск по этой строке... и мы уже знаем где она будет после ввода...<br>Можно бряк на доступ к памяти ставить и ловить проверку...<br>    Если после появления окна (где код вводишь) нажать F12, потом держишь F8, пока не начнёшь крутиться в цикле... Это цикл обработки окном сообщений... Здесь могут проверяться вводимые данные, отфильтровываться ненужые символы или даже налету кей генериться (когда кнопка Reg активируется только при правильном Seriale).<br>    Это всего лишь мои предположения, до которых я дошёл &quot;методом научного тыка&quot;... Да исправят меня Guru! <img src="img/smilies/s15.gif" alt="">
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=151801&amp;user=6946&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=15" class="addthx" data-post="151801"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 23:22 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Ясно, как-то так я и делаю...<br>Просто бывает сразу отлавливаеш, а бывает попарится надо.<br>В общем спасибо.<br>Топ пока не закрывайте плз - может ещё вопросы будут по генерации <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151856&amp;user=6859&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=16" class="addthx" data-post="151856"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 августа 2007 16:56 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Как знал что вернусь :/<br>В общем расковырял я алго - немного даже интересно <img src="img/smilies/s1.gif" alt=""><br>Но счас всё упёрлось в крипто апи, а конкретно юзается:<br>CryptImportKey<br>CryptCreateHash<br>CryptHashData<br>CryptVerifySignature<br>CryptDestroyHash<br>Столкнулся впервые, по сему вопрос - нет ли у кого простенького примера как оно используется?<br>И второе, что за алгоритм шифрования - в CryptCreateHash передаётся AlgID=0x8003<br>В h от VS6 что-то такого не нахожу...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=152327&amp;user=6859&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=17" class="addthx" data-post="152327"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 августа 2007 17:03 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Private Declare Function CryptCreateHash Lib &quot;advapi32.dll&quot; _<br>              (ByVal hProv As Long, ByVal algid As Long, _<br>              ByVal hkey As Long, ByVal dwFlags As Long, _<br>              ByRef phHash As Long) As Long
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=152329&amp;user=6946&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=18" class="addthx" data-post="152329"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 августа 2007 17:11 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Эээ...<br>Это я на MSDN посмотрел.<br>Мне бы примерчик как оно работает...<br><br>Ну ID расшифровывается так:<br>ALG_CLASS=4 (ALG_CLASS_HASH)<br>ALG_TYPE =0 (ALG_TYPE_ANY)<br>ALG_SID  =3 (ALG_SID_RSA_ENTRUST)<br><br>Помогло мне не сильно...<br>Чё это за алгоритм и есть ли смысл связываться??<br>Меня пугает RSA в названии алго, потому что в ресурсах у проги ключ лежит длиной в 128 байт...<br>Правда как конкретно она его юзает я пока не разобрался.<br><br>Возможно ли обратить эти функции??<br>Т.е. ключ мой прога практически хавает, валится всё на CryptVerifySignature.<br>Можно ли создать ключ чтоб проходил проверку CryptVerifySignature, что для этого знать надо??
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=152332&amp;user=6859&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=19" class="addthx" data-post="152332"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]ViSoR[/b]','')">ViSoR</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 49.7 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.99'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 августа 2007 17:27 <br><script type="text/javascript">QU('ViSoR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ViSoR" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>cppasm</b>, первоисточник: msdn2.microsoft.com/en-us/library/aa380252.aspx
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=152333&amp;user=5618&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=20" class="addthx" data-post="152333"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 августа 2007 17:46 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Люди, ёлки ну не надо постить ссылки на MSDN!!!<br>Я тама был. Только что толку?<br>Ясно что при помощи CreateHashData добавляются данные в хэш и потом проверяется соответствие при помощи CryptVerifySignature.<br>Только вот вопрос как мне эти функции обратить...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=152336&amp;user=6859&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=21" class="addthx" data-post="152336"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Sh[AHT][/b]','')">Sh[AHT]</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 77.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=145">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 августа 2007 17:49 <br><script type="text/javascript">QU('Sh[AHT]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sh[AHT]" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>cppasm пишет:<br>вопрос как мне эти функции обратить... </I><br>Никак. Только подменив ключ на свой и сгенерив сигнатуру самому.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=152337&amp;user=145&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=22" class="addthx" data-post="152337"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 августа 2007 21:34 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Т.е. кроме патча вариантов нет?<br>Если да то обидно <img src="img/smilies/s9.gif" alt=""> А вообще авторы ботаны <img src="img/smilies/s1.gif" alt=""><br>Я просто кейген хотел сделать.<br>А так там 30 дней полнофункционально прога работает - патчить 3 строчки и все дела.<br>Ну при желании можно ещё в ресурсах косметику навести...<br><br>Что правда вариантов нету кроме патча ключа??? <img src="img/smilies/s9.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=152372&amp;user=6859&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=23" class="addthx" data-post="152372"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]2nd[/b]','')">2nd</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 39.4 (посетитель), 9thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.04'>Активность: 0.01=0.01</span><br>Статус: <a href="action=userinfo&amp;user=2094">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 августа 2007 23:02 &middot; Поправил: 2nd <br><script type="text/javascript">QU('2nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=2nd" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
&gt;Ну ID расшифровывается так: <br>&gt;ALG_CLASS=4 (ALG_CLASS_HASH) <br>&gt;ALG_TYPE =0 (ALG_TYPE_ANY) <br>&gt;ALG_SID =3 (ALG_SID_RSA_ENTRUST)<br><br>нет не так<br>  CALG_MD5              = (ALG_CLASS_HASH or ALG_TYPE_ANY or ALG_SID_MD5);   //0x8003
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=152400&amp;user=2094&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=24" class="addthx" data-post="152400"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 августа 2007 09:47 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>2nd пишет:<br>нет не так <br>CALG_MD5 = (ALG_CLASS_HASH or ALG_TYPE_ANY or ALG_SID_MD5); //0x8003 </I><br>Угу, не ту константу взял...<br>Хотя ALG_SID_RSA_ENTRUST тоже 3.<br>Ну MD5 это чуть получше.<br>Никто не в курсе - это классический MD5 или CryptoAPI какую-то модификацию использует??<br>Есть мысли SAM Inside заюзать для брута...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=152450&amp;user=6859&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=25" class="addthx" data-post="152450"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 августа 2007 13:21 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=9637.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
Ладно, ну его нафиг это крипто.<br>Пропатчил и все дела. <img src="img/smilies/s1.gif" alt=""><br>Всем спасибо за участие.<br>Думаю тему можно прикрыть.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=152472&amp;user=6859&amp;forum_n=2&amp;topic=9637.html&amp;page=0&amp;anchor=26" class="addthx" data-post="152472"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> USB Lyzer 1.0 (MFC)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=9637" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
