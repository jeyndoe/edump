<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>распаковка PEspin 1.304 - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="вот появилось свободное время между здачей экзаменов, решил ченить поиследовать... так вот... запаковыа маленькую асм. прогу эти чудом и понеслась... ничего не читал, делал всё сам... вот интересно, может кто поделится опытом?">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=132'>YDS</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=44014'>user99</a> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> распаковка PEspin 1.304</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 января 2006 22:07 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3807.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
вот появилось свободное время <img src="img/smilies/s6.gif" alt=""> между здачей экзаменов,
<br>решил ченить поиследовать... так вот... запаковыа маленькую асм. прогу
<br>эти чудом и понеслась...
<br>ничего не читал, делал всё сам... вот интересно, может кто поделится опытом?
<br>пока, всё что получилось, я могу дойти пешком до ОЕП 1мин <img src="img/smilies/s6.gif" alt="">
<br>нашёл несколько интересных процедур (форм импорта и т.д.)
<br>но чёт с импортом никак не получается =(
<br>
<br>а вобще вот:
<br><code>
<br>00404B77    D1E1                       SHL ECX,1
<br>00404B79    F7D1                       NOT ECX
<br>00404B7B    F2:                        PREFIX REPNE:                                             ; Superfluous prefix
<br>00404B7C    F7D2                       NOT EDX
<br>00404B7E    C1C1 77                    ROL ECX,77                                                ; Shift constant out of range 1..31
<br>00404B81    0FB7C8                     MOVZX ECX,AX
<br>00404B84    4A                         DEC EDX
<br>00404B85    BA 68EB57EF                MOV EDX,EF57EB68
<br>00404B8A    8BD0                       MOV EDX,EAX                                               ; 1.&lt;ModuleEntryPoint&gt;
<br>00404B8C    0FB3C2                     BTR EDX,EAX                                               ; 1.&lt;ModuleEntryPoint&gt;
<br>00404B8F    B9 04DAA1B5                MOV ECX,B5A1DA04
<br>00404B94    C7C1 9E14091A              MOV ECX,1A09149E
<br>00404B9A  - E9 61C4FFFF                JMP 1.00401000  &lt;--- прыжок на оеп !
<br></code>
<br>что запомнилось... это деление на 0, юзуются SEH =) и шифрование там вроде...
<br>много циклов распаковки... больше ничё интересного вроде...
<br>хочу импорт добить.... =)
<br>в аттаче прога, запакованная сабжем...
<br>всего 3 функции там... мессаге бох, ехит процесс и дебуггер презент <img src="img/smilies/s6.gif" alt="">
<br><img src="img/attach.gif" alt=""> <a href="./files/8773_1.EXE.zip">8773_1.EXE.zip</a>
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=51517&amp;user=72&amp;forum_n=1&amp;topic=3807.html&amp;page=0&amp;anchor=1" class="addthx" data-post="51517"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]arnix[/b]','')">arnix</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 210.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 января 2006 00:14 <br><script type="text/javascript">QU('arnix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=arnix" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3807.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<a href="http://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=2618" target="_new">http://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=2618</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=51525&amp;user=26&amp;forum_n=1&amp;topic=3807.html&amp;page=0&amp;anchor=2" class="addthx" data-post="51525"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 января 2006 00:48 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3807.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>arnix пишет:
<br><a href="http://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=2618" target="_blank">http://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=2618</a> </I>
<br>я конечно извеняюсь.. что не нешёл в поиске... но что то там про импорт не слова не было...
<br>хотя с моим ужасным англ.  я мог и не увидеть....
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=51527&amp;user=72&amp;forum_n=1&amp;topic=3807.html&amp;page=0&amp;anchor=3" class="addthx" data-post="51527"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]arnix[/b]','')">arnix</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 210.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 января 2006 01:46 &middot; Поправил: arnix <br><script type="text/javascript">QU('arnix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=arnix" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3807.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
ОК, я когда-то распаковывал, попробую вспомнить. Поставь брейк на  retn 14 функции VirtualProtectEx и запусти, когда поймаешь, потрейси до кода программы, потом дави Ctrl-F и ищи MOV EAX,0F96B302E
<br><code>
<br>00404806    9C              PUSHFD
<br>00404807    F71424          NOT DWORD PTR SS:[ESP]
<br>0040480A    832424 01       AND DWORD PTR SS:[ESP],1
<br>0040480E    50              PUSH EAX
<br>0040480F    52              PUSH EDX
<br>00404810    B8 2E306BF9     MOV EAX,F96B302E</code>
<br>
<br>поменяй это дело на...
<br><code>
<br>00404806    9C              PUSHFD
<br>00404807    9D              POPFD
<br>00404808    6A 01           PUSH 1
<br>0040480A    90              NOP
<br>0040480B    90              NOP
<br>0040480C    90              NOP
<br>0040480D    90              NOP
<br>0040480E    50              PUSH EAX
<br>0040480F    52              PUSH EDX
<br>00404810    B8 2E306BF9     MOV EAX,F96B302E</code>
<br>
<br>О причинах (почему так сделано и как это работает) разберись сам, ну или если хочешь обясню. Ну и собсно запусти программу, включи импрек, выбери прогу и делай правый клик -&gt; Advanced command -&gt; Get API Calls, потом, если есть кривые, то Show invalid, Cut thunks. Будут вопросы скажи.
<br>
<br><code>
<br>FThunk: 0000742A	NbFunc: 00000001
<br>1	0000742A	kernel32.dll	00B0	ExitProcess
<br>
<br>FThunk: 0000742F	NbFunc: 00000001
<br>1	0000742F	kernel32.dll	0224	IsDebuggerPresent
<br>
<br>FThunk: 00007435	NbFunc: 00000001
<br>1	00007435	user32.dll	01DD	MessageBoxA</code>
<br>
<br>P.S.
<br>Могут быть методы и другие, получше и надёжнее, не копал много...
<br>
<br>Добавка:
<br>Да, можно сделать и получше, нужно скрипт написать сначала, чтобы нормальным образом восстановить IAT.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=51530&amp;user=26&amp;forum_n=1&amp;topic=3807.html&amp;page=0&amp;anchor=4" class="addthx" data-post="51530"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]newborn[/b]','')">newborn</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 153.9 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2591">Участник</a><br><font color=blue>reborn</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 января 2006 10:33 <br><script type="text/javascript">QU('newborn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=newborn" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3807.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>arnix пишет:
<br>Да, можно сделать и получше, нужно скрипт написать сначала, чтобы нормальным образом восстановить IAT. </I>
<br>
<br>Да вроде есть такой
<br>&quot;PESpin v1.3 unpacker script for OllyScript plugin (by SHaG)&quot;
<br>там написано:
<br>&quot;Script will fix IAT redirection, code redirection and find stolen OEP code.&quot;
<br><br><font size="1"><i>-----<br>~ the Power Of Reversing team ~</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=51546&amp;user=2591&amp;forum_n=1&amp;topic=3807.html&amp;page=0&amp;anchor=5" class="addthx" data-post="51546"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Av0id[/b]','')">Av0id</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 516.1 (<b>!</b>), 39thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1378">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 января 2006 13:12 <br><script type="text/javascript">QU('Av0id','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Av0id" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3807.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
вроде на reversing.be есть тутор (3-и в одном) для распаковки всех версий сабжа
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=51566&amp;user=1378&amp;forum_n=1&amp;topic=3807.html&amp;page=0&amp;anchor=6" class="addthx" data-post="51566"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Klajnor[/b]','')">Klajnor</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.78'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2708">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 января 2006 13:40 <br><script type="text/javascript">QU('Klajnor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Klajnor" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3807.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Хм... У меня всё просто получилось. 
<br>Протрейсил до секции кода. 
<br>Встал на 401000. 
<br>Сдампил Olly, указав Base of Code = 1000; и без опции Rebuild Import.
<br>Далее как <b>arnix</b>
<br><I>arnix пишет:
<br>Ну и собсно запусти программу, включи импрек, выбери прогу и делай правый клик -&gt; Advanced command -&gt; Get API Calls, потом, если есть кривые, то Show invalid, Cut thunks. 
<br>
<br>
<br>FThunk: 0000742A NbFunc: 00000001 
<br>1 0000742A kernel32.dll 00B0 ExitProcess 
<br>
<br>FThunk: 0000742F NbFunc: 00000001 
<br>1 0000742F kernel32.dll 0224 IsDebuggerPresent 
<br>
<br>FThunk: 00007435 NbFunc: 00000001 
<br>1 00007435 user32.dll 01DD MessageBoxA </I>
<br>
<br>Потом снял галку Add new Section и Ввёл RVA = 1100, т.к. кода там всё равно нет.
<br>И получил рабочий дамп
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=51569&amp;user=2708&amp;forum_n=1&amp;topic=3807.html&amp;page=0&amp;anchor=7" class="addthx" data-post="51569"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 января 2006 13:50 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3807.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>newborn пишет:
<br>Да вроде есть такой 
<br>&quot;PESpin v1.3 unpacker script for OllyScript plugin (by SHaG)&quot; 
<br>там написано: 
<br>&quot;Script will fix IAT redirection, code redirection and find stolen OEP code.&quot; </I>
<br>я же сказал хочу сам.. ты этот скрипт вообще видел??? самому лучше в коде разобраться
<br>чем в скрипте <img src="img/smilies/s6.gif" alt="">
<br>
<br><I>Klajnor пишет:
<br>Хм... У меня всё просто получилось. 
<br>Протрейсил до секции кода. 
<br>Встал на 401000. 
<br>Сдампил Olly, указав Base of Code = 1000; и без опции Rebuild Import. 
<br>Далее как arnix  </I>
<br>проcто трейсил? <img src="img/smilies/s1.gif" alt=""> я весь пакер прошёл по коду... разбирался, что где и как....
<br>интересно...
<br>ок ща попробую.. о результатах скажу...
<br>да действительно... хм интересно... ща поставлю галочку 
<br>api redirection.... да вообще все опции защиты включу....
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=51572&amp;user=72&amp;forum_n=1&amp;topic=3807.html&amp;page=0&amp;anchor=8" class="addthx" data-post="51572"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Klajnor[/b]','')">Klajnor</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.78'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2708">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 января 2006 14:11 <br><script type="text/javascript">QU('Klajnor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Klajnor" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3807.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Я с ассемблером дружу не очень, поэтому долгие циклы распаковки мне не интересны
<br>
<br>Трейсил, игноря все исключения, но это долго( 1-2 минуты). 
<br>Потом, уже зная OEP,  доходил до него так: 
<br>F9. Возникает исключение:неправильная инструкция. 
<br>Потом F7. Прога переходит в ntdll. Затем ставлю бряк на 401000 и снова F9. Оказываюсь на OEP
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=51576&amp;user=2708&amp;forum_n=1&amp;topic=3807.html&amp;page=0&amp;anchor=9" class="addthx" data-post="51576"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 января 2006 14:18 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3807.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>Klajnor пишет:
<br>Потом F7. Прога переходит в ntdll. Затем ставлю бряк на 401000 и снова F9. Оказываюсь на OEP </I>
<br>гы <img src="img/smilies/s6.gif" alt=""> прикольно, я не много по другому <img src="img/smilies/s3.gif" alt=""> скачал статью.... блин оказывается на счёт импорта я рядом был.. всё правильно нашёл...  <img src="img/smilies/s5.gif" alt=""> тока чуть не допёр какой калл занопить.... а так всё кулл..
<br>тока я до оеп по другому добираюсь чем в статье... хотя и как в статье была у меня мысль...
<br>ща сижу со всеми опциями защиты разбираюсь... что то не все функции корректно востанавливаются...
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=51577&amp;user=72&amp;forum_n=1&amp;topic=3807.html&amp;page=0&amp;anchor=10" class="addthx" data-post="51577"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Klajnor[/b]','')">Klajnor</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.78'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2708">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 января 2006 14:33 <br><script type="text/javascript">QU('Klajnor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Klajnor" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3807.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
В этой проге я не заметил особой защиты. Калькулятор запротекченный по полной( только без защиты паролем) я так и не смог распаковать пока.
<br>А из твоей проги можно сделать ехе-шник в 963 байта, если сдампить только 2000h байт, а затем удалить из заголовка 2 последнии секции. Потом востановить импорт и в LordPe сделать над ехе-шником Rebild Pe<br><br><img src="img/attach.gif" alt=""> <a href="./files/f657_d3_.exe.zip">f657_d3_.exe.zip</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=51579&amp;user=2708&amp;forum_n=1&amp;topic=3807.html&amp;page=0&amp;anchor=11" class="addthx" data-post="51579"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 января 2006 14:39 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3807.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>Klajnor пишет:
<br>В этой проге я не заметил особой защиты. Калькулятор запротекченный по полной( только без защиты паролем) я так и не смог распаковать пока. 
<br>А из твоей проги можно сделать ехе-шник в 963 байта, если сдампить только 2000h байт, а затем удалить из заголовка 2 последнии секции. Потом востановить импорт и в LordPe сделать над ехе-шником Rebild Pe </I>
<br>интересно, что размер не упакованного файла 1 536 байт... прикольно =)
<br>ну да я тока исследовал... вот тоже ща маюсь... зря калькулятор... лучше что нить поменьше....
<br>хотя лан... ща займусь твоим файлом.... пока не распакую не успакоюсь +)
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=51581&amp;user=72&amp;forum_n=1&amp;topic=3807.html&amp;page=0&amp;anchor=12" class="addthx" data-post="51581"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Klajnor[/b]','')">Klajnor</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.78'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2708">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 января 2006 15:36 <br><script type="text/javascript">QU('Klajnor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Klajnor" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3807.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Там заголовок ехе-шника обрезается до самого минимума =)
<br>ЗЫ 
<br><I>Hellspawn пишет:
<br> ща займусь твоим файлом </I>
<br>В каким таким моим файлом? Я приаттачил результат
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=51584&amp;user=2708&amp;forum_n=1&amp;topic=3807.html&amp;page=0&amp;anchor=13" class="addthx" data-post="51584"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Rascal[/b]','')">Rascal</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/60.jpg" alt=""><br><span class=txtSm>Ранг: 260.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=60">Участник</a><br><font color=blue>John Smith</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 января 2006 13:23 <br><script type="text/javascript">QU('Rascal','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rascal" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3807.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Вы лучше сам прот попробуйте анпакнуть <img src="img/smilies/s1.gif" alt=""> У кого какие идеи обхода наномитов?
<br><br><font size="1"><i>-----<br>Недостаточно только получить знания:надо найти им приложение</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=51691&amp;user=60&amp;forum_n=1&amp;topic=3807.html&amp;page=0&amp;anchor=14" class="addthx" data-post="51691"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> распаковка PEspin 1.304</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#15" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="3807">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=3807" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
