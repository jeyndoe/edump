<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Создание сигнатуры для мутированного VMProtect&#039;ом кода - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте! Есть защищенный мутированный VMProtect&#039;ом код(без виртуализации), версия 3+, нужно сделать сигнатуру для этого кода, при этом каждый билд программы генерирует рандомный мусор и рандомные регистры кода, но">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Создание сигнатуры для мутированного VMProtect&#039;ом кода</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=26404&amp;page=2.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=26404&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=13&amp;topic=26404&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=26404&amp;page=2.html">3</a> . <b>4</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Vine[/b]','')">Vine</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 2.13'>Активность: 0.01=0.01</span><br>Статус: <a href="action=userinfo&amp;user=43938">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2020 18:25 <br><script type="text/javascript">QU('Vine','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vine" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте!<br>Есть защищенный мутированный VMProtect&#039;ом код(без виртуализации), версия 3+, нужно сделать сигнатуру для этого кода, при этом каждый билд программы генерирует рандомный мусор и рандомные регистры кода, но алгоритм остается тем же. Каждый билд программы сигнатура перестает быть рабочей, а нужно сделать ее универсальной, алгоритм кода не меняется.<br>Может быть, есть какие нибудь решения для моей проблемы?<br>Заранее спасибо!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=404538&amp;user=43938&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=1" class="addthx" data-post="404538"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2020 01:34 &middot; Поправил: cppasm <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#2');return false;">#2</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Логика у тебя кривая. Во первых если нужен ориг код, то и адреса или есчо что то нужно до мутации. </I><br>У кого логика кривая и так ясно.<br>Нафиг ему адрес в оригинальном образе если у него этого образа нет?<br><br>Ещё раз для тех кто на бронепоезде.<br>Есть некий автор, у него есть оригинальный бинарь.<br>У нас его нет.<br>Он его протектит без упаковки, без ВМ, просто морф (мутация части функций, включая интересную нам).<br>Получаем морф версия 1.<br>Он попал к нам в руки, мы его разобрали, нашли интересующую нас функцию и допустим пропатчили.<br>Автор взял свой бинарь (всё тот же) и снова запротектил, получили морф версия 2.<br>Он попадает к нам в руки.<br>Задача - быстро найти где пропатчить, без полного повторного разбора.<br>Т.е. найти адрес той же функции в этом бинаре, при том что код после морфа абсолютно разный, сохраняется только логика работы функции.<br>Нам нафиг не нужен адрес этой функции в оригинальном образе, потому что у нас его нет.<br>Так понятно?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=404765&amp;user=6859&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=2" class="addthx" data-post="404765"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]_MBK_[/b]','')">_MBK_</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 62.5 (постоянный), 34thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.61'>Активность: 0.28<span style='color:green'>&nearr;</span>0.96</span><br>Статус: <a href="action=userinfo&amp;user=41701">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2020 07:50 &middot; Поправил: _MBK_ <br><script type="text/javascript">QU('_MBK_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=_MBK_" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#3');return false;">#3</a> </span><div align=left><br>
Извиняюсь, что встреваю в столь пикантные весенние брачные игры, но разве задача имеет решение? Упомянутый выше RC4 и то можно реализовать бесконечным числом способов и понять, что это именно он без искусственного интеллекта невозможно. Ну разве что, взять некую уникальную константу и трассировать код до тех пор, пока в одном из регистров она не почвится, да и то, при желании, можно и это обойти.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=404766&amp;user=41701&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=3" class="addthx" data-post="404766"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2020 10:04 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#4');return false;">#4</a> </span><div align=left><br>
<b>difexacaw</b><br><i class=x>RVA 0x246647 - 0x100000 это вход в кодовую секцию после крипто мусора, на этой EP ориг код. До него исполнение вм мусора. </i><br><br>Результат близок к истине, это вторая &quot;чистая&quot; функция<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00546647</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr"><b>ebp</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">|</span>&nbsp;_scrt_initialize_crt</li><li class="hl_l1"><span class="hl_number">00546648</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span><span class="hl_registr"><b>esp</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">|</span></li><li class="hl_l0"><span class="hl_number">0054664A</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">|</span></li>        </ol>
    </div>
</div></div>
<br> после ОЕП, которая вызывается из вм, а первая &quot;чистая&quot; функция SEH Prolog<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00546C10</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_char">&lt;</span>hellooep<span class="hl_char">.</span>except_handler4<span class="hl_char">&gt;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">|</span>&nbsp;_SEH_prolog4</li><li class="hl_l1"><span class="hl_number">00546C15</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">|</span></li><li class="hl_l0"><span class="hl_number">00546C1C</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">10</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">|</span></li>        </ol>
    </div>
</div></div>
<br><br>В принципе этой точки RVA 0x146647 достаточно чтобы поставить на неё хард бряк, сделать полный дамп распакованной проги и начать его изучать.<br><b>ОЕП в данной программе найти невозможно потому что его нет</b>, при виртуализации/мутации кода на ОЕП вмпрот полностью затирает это место без каких-либо признаков.<br>Реальный ОЕП RVA 0x146599 - тут будет просто мусор вместо оригинального кода<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00546599</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_char">&lt;</span>hellooep<span class="hl_char">.</span>_security_init_cookie<span class="hl_char">&gt;</span>&nbsp;&nbsp;<span class="hl_char">|</span>&nbsp;wWinMainCRTStartup</li><li class="hl_l1"><span class="hl_number">0054659E</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_char">&lt;</span>hellooep<span class="hl_char">.</span>_scrt_common_main_seh<span class="hl_char">&gt;</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">|</span></li>        </ol>
    </div>
</div></div>
<br>Функция _security_init_cookie и _scrt_common_main_seh виртуализованы, вот начало оригинальной функции _scrt_common_main_seh<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0054641D</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">14</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">|</span>&nbsp;_scrt_common_main_seh</li><li class="hl_l1"><span class="hl_number">0054641F</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;hellooep<span class="hl_char">.</span><span class="hl_number">5C0020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">|</span></li><li class="hl_l0"><span class="hl_number">00546424</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_char">&lt;</span>hellooep<span class="hl_char">.</span>_SEH_prolog4<span class="hl_char">&gt;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">|</span></li><li class="hl_l1"><span class="hl_number">00546429</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">1</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">|</span></li><li class="hl_l0"><span class="hl_number">0054642B</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_char">&lt;</span>hellooep<span class="hl_char">.</span>_scrt_initialize_crt<span class="hl_char">&gt;</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">|</span></li><li class="hl_l1"><span class="hl_number">00546430</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr"><b>ecx</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">|</span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">:</span>wWinMainCRTStartup</li><li class="hl_l0"><span class="hl_number">00546431</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span><span class="hl_registr"><b>al</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">|</span></li>        </ol>
    </div>
</div></div>
<br>Визор выдал адрес функции _scrt_initialize_crt.<br><br>В начале всех остальных виртуализованных/мутированных функций, кроме ОЕП, вмпрот всегда оставляет jmp на вход в вм или в мутированный код, даже если он никогда не исполняется. Таким образом начало каждой защищенной функции можно распознать в оригинальном образе и восстановить в этом месте код после прота.<br>Можете убедиться в этом взглянув на адреса RVA 00147291 (_security_init_cookie) и 0014641D (_scrt_common_main_seh) - там будут jmp на вход в вм.<br><br><b>Добавлено спустя 24 минуты</b><br><b>_MBK_</b><br><i class=x>Извиняюсь, что встреваю в столь пикантные весенние брачные игры, но разве задача имеет решение?</i><br>Почти любая задача в программировании/реверсе может иметь приемлимое решение, если она правильно сформулирована. В данном случае, если юзеру требуется локализовать мутированную вмпротом функцию в разных версиях одного и того же приложения, то зная особенности вмпрота можно сказать что любая сигнатура в данном случае бесполезна.<br>Задача решается следующим образом:<br>- первый раз функция деобфусцируется до нужной степени и выявляется её алгоритм<br>- находится jmp на начало этой функции из оригинального кода (он всегда будет)<br>- далее 2 пути в зависимости от защиты:<br>1. jmp исполняемый - в этом случае на нем можно брякнуться и мы запоминаем все ссылки на него из других функций и само место этой функции относительно других. Стартуем, брякаемся - видим откуда.<br>2. jmp не исполняемый (данная мутированная функция вызывается из другой защищенной функции). В этом случае ориентируемся только на место этой функции относительно других.<br><br>Все, этой информации достаточно, чтобы довольно быстро определить адрес нужной функции в новом билде. Конечно при условии, что разработчик билда не перетасует все функции в исходниках, но такого на своей практике я не встречал.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=404767&amp;user=20406&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=4" class="addthx" data-post="404767"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2020 11:40 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#5');return false;">#5</a> </span><div align=left><br>
<I>Vamit пишет:<br>Этот код не может быть ОЕП, т.к. расположен в секции прота, это какой-то вход в вм. ОЕП всегда должен быть в секции кода программы, а не прота защищающего её. </I><br><I>Vamit пишет:<br>ОЕП в данной программе найти невозможно потому что его нет, при виртуализации/мутации кода на ОЕП вмпрот полностью затирает это место без каких-либо признаков. </I><br>Ты там определись есть ли он или его нет, то что я выше указал и есть начало OEP которое под вм
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=404769&amp;user=17432&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=5" class="addthx" data-post="404769"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ex_DMA[/b]','')">ex_DMA</a></b><br></div>
<img src="img/s0.gif" alt=""><br><span class=txtSm>Ранг: -9.5 (нарушитель), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 0.28'>Активность: 0.13=0.13</span><br>Статус: <a href="action=userinfo&amp;user=54063">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2020 11:49 <br><script type="text/javascript">QU('ex_DMA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ex_DMA" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#6');return false;">#6</a> </span><div align=left><br>
<I>Vamit пишет:<br>Визор выдал адрес функции _scrt_initialize_crt. </I><br><br><b>Vamit</b>, о каком визоре идет речь? Это подарок от Инди, PIN или свои визоры имеют уже два человека на этом форуме? <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=404770&amp;user=54063&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=6" class="addthx" data-post="404770"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2020 12:47 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#7');return false;">#7</a> </span><div align=left><br>
<b>ex_DMA</b><br>Чукча не читатель, чукча - писатель.<br><b>Vamit</b> комментировал пост <b>difexacaw</b> и его результаты, соответственно и визор имелся ввиду его, мега приватный.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=404774&amp;user=6859&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=7" class="addthx" data-post="404774"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2020 14:55 <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#8');return false;">#8</a> </span><div align=left><br>
<I>Vamit пишет:<br>Почти любая задача в программировании/реверсе может иметь приемлимое решение </I><br>Как насчет распознавания виртуализированных инструкций, когда их реализация разбита на множество примитивов и строки шаблона перемешаны / смешаны с реализацией других инструкций?
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=404780&amp;user=40448&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=8" class="addthx" data-post="404780"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2020 15:41 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#9');return false;">#9</a> </span><div align=left><br>
<I>Boostyq пишет:<br>и строки шаблона перемешаны / смешаны с реализацией других инструкций </I><br>+1<br>млять, и вроде же разный материал, а приёмы схожи.<br>упорядочить &quot;беспорядок&quot;, или вычленить полезную датафлоу, инфо мало. под асм исходник ни одни &quot;пузырьки&quot; не подходят..))<br>как нагадить вроде есть, но найти матрицу перестановок, кажется не реально.
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=404782&amp;user=3230&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=9" class="addthx" data-post="404782"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2020 16:54 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#10');return false;">#10</a> </span><div align=left><br>
<b>Boostyq</b><br><i class=x>Как насчет распознавания виртуализированных инструкций, когда их реализация разбита на множество примитивов и строки шаблона перемешаны / смешаны с реализацией других инструкций?</i><br>Данная задача у меня решена на 98%. А оставшиеся 2% проще руками поправить в девиртуализованном коде.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=404784&amp;user=20406&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=10" class="addthx" data-post="404784"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2020 18:53 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#11');return false;">#11</a> </span><div align=left><br>
<b>Vamit</b><br><br>&gt;  после ОЕП, которая вызывается из вм, а первая &quot;чистая&quot; функция SEH Prolog<br><br>Так она ведь первой и найдена была. Из за того что обёрнута мусором, то толку от этой функции никакого.<br><br>&gt; ОЕП в данной программе найти невозможно потому что его нет<br><br>В морф/вирт предполагается что EP нет, есть ближайшее место без морфа. Находится EP общим критерием <noindex><a href="https://wasm.in/threads/oep-protektory.33242/" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex> на основе особенности крипторов - они не покрывают весь код, что было сказано в самом начале топика, а поэтому начало AI и есть выборка из кода после EP.<br><br>Никто больше не решил.. чувак тот что утверждал что найдёт EP тоже пропал <img src="img/smilies/s4.gif" alt=""><br><br><b>cppasm</b><br><br>&gt; Задача - быстро найти где пропатчить, без полного повторного разбора.<br><br>Чья это задача ?<br>ТС нужно сигнатуру составить, а не патчить что либо. Примером должны быть два бинаря, в которых весь код полностью отморфлен. И найти общее между ними. А не два одинаковых бинаря не криптованных, в которых кому то нужно найти функцию и что то с ней сделать.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=404785&amp;user=40990&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=11" class="addthx" data-post="404785"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2020 21:00 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#12');return false;">#12</a> </span><div align=left><br>
Почитал топик. По существу, у меня пара вопросов:<br>1. С чего вы так к сигнатурам привязывайтсь?? Сигнатуры не всегда дают true positive  Взять тот-же антивирус Ка... (ну не важно! рекламы тут не будет): кроме сигнатур есть эвристика, модуль BSS, машинное обучение. Оно комбинируется и гибридизируется сейчас и активно идет по данному пути. К примеру, опуская технические детали, возьмем тот-же DENUVO. Мы знаем, что защита читает в определенные поля из <i class=x>KUSER_SHARED_DATA, PEB, IMAGE_DATA_DIRECTORY </i>и cpuid. Находим примитив в вмпроте <i class=x>READ_DS_DWORD</i>, хукаем и смотрим, обращается ли он к перечисленным полям. Одновременно ожидаем, что на выходе из VM мы попадем на cpuid. В сумме, если указанные условия выполняются, считаем, что <b>filename.exe</b> накрыт Denuvo.<br>2. В случае, если ТС хочет создать сигнатуру на два и более файла, накрытых одной версией денуво (вмп и тд. Плюс, к ещё к одному вопросу, озвученному ранее): как минимум, их можно тривиально сравнить. Одинаковые версии защиты могут содержать цепочку из таких же одинаковых байт, водяные знаки. Исходим из того, что. Exe файл вряд-ли виртуализирован на 100%, а значит, какие-то инструкции останутся открытыми (после распаковки). Развивая эту тему - асм инструкции SSE.., AVX вирт машины в подавляющем большинстве случаев исполнят &quot;вживую&quot;, т.е. условно будет &quot;начальная&quot; сигнатура, которую можно скомбинировать с методами из п.1
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=404786&amp;user=26651&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=12" class="addthx" data-post="404786"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40990" title="30-03-2020 18:12, ранг:331.0" target="_blank">difexacaw</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2020 21:11 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#13');return false;">#13</a> </span><div align=left><br>
<b>ELF_7719116</b><br><br>&gt;  какие-то инструкции останутся открытыми (<u>после распаковки</u>).<br><br>В данном случае после анпака часть кода криптована. А может быть что весь код криптован, после анпака будет всё тот же крипт. Нетронутыми остануться лишь данные. По той простой причине, что их невозможно криптовать в том же аппаратном моде рекурсия #6 <noindex><a href="https://exelab.ru/f/?action=vthread&amp;forum=13&amp;topic=26404&amp;page=0#6" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>&gt; кроме сигнатур есть эвристика<br><br>По простой причине - ограничение на число итераций вирты, это тайминг. А есчо есть вторая причина, крипт это не метаморфы и прочие виксы, где вообще статик кода/данных нет(тк входные данные для крипта бинарь с не известным покрытием, а викс моторы изначально не содержат статик).
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=404787&amp;user=40990&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=13" class="addthx" data-post="404787"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2020 22:36 &middot; Поправил: Bronco <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#14');return false;">#14</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>что filename.exe накрыт Denuvo. </I><br>пиздец выводы, с каких это пор дунька пакером стала?<img src="img/smilies/s6.gif" alt=""><br>ну читает дворды для завязки с примитивным шифрованием, так их все читают, да же чистые аппы.<br>--------------<br>сигнатура не панацея, но в большинстве случаев в динамике нет необходимости.
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=404789&amp;user=3230&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=14" class="addthx" data-post="404789"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2020 22:49 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#15');return false;">#15</a> </span><div align=left><br>
<I>difexacaw пишет:<br>В морф/вирт предполагается что EP нет, есть ближайшее место без морфа </I><br>Бредовое заявление.<br>Допустим вся программа от и до находится под виртуальной машиной, все вызываемые функции тоже под вм, поэтому не происходит выхода из нее вовсе.<br>В таком случае что у проги нет OEP? Вот тебе на, а если она вызывает например 1 winapi функцию, тогда что адрес этой функции и будет OEP?<br>Конечно нет, в случае виртуализации OEP выглядит иначе, это адрес начала первого примитива, которым реализуется первая инструкция OEP, но одного адреса мало, примитив может вызываться кучу раз с разным контекстом еще до OEP, поэтому логичным дополнением будет соответствующий указатель ленты вм.<br>И никакой автоматикой это невозможно решить, до тех пор пока явно не научить обрабатывать это, ни о какой универсальности не может быть и речи.<br>Еще повторюсь, если OEP для тебя это ближайшее чистенькое место, то нахрена нужен dbi, если это можно найти руками за 5 минут, да пиво в руках не подержишь, но и 4 часа околачиваться не надо насилуя свой пэка.<br>Ставишь сбор трассы и запускаешь прогу, потом листаешь с начала и находишь первое такое место, но опять же это ерунда, еще до OEP может вызываться незащищенный код.<br><br><I>ELF_7719116 пишет:<br>С хочет создать сигнатуру на два и более файла </I><br>Вы как и клерк прицепились к этому слову, сигнатура это формальность, потому что для обычного статического кода это так называется.<br>Естественно тс нужно локализовать определенную функцию, ему плевать на обнаружение файла, он и так знает что это нужная программа, в ней есть нужная мутированая функция, он и так знает что там вмпрот, а что ему неизвестно так это как ее находить в каждой новой сборке программы, после того как над ней постарался вмпрот.<br>Если у вас есть эвристический метод это хорошо, допустим функция единственная вызывает какую-нибудь winapi, и поставив хук на нее, можно вытащить  адрес возврата из стека и точно найти адрес принадлежащий этой функции.<br>А если (никаких если, точно) тсу нужно определенное место в функции, что ваша эвристика будет делать?<br>Приведение примера ав это вообще абсурд, у них другая задача, ав нужно найти хотя бы один признак нужного поведения где-бы он ни был, и чем надежнее, тем лучше, тсу же нужно точное место.
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=404790&amp;user=40448&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=15" class="addthx" data-post="404790"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2020 22:52 &middot; Поправил: ELF_7719116 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#16');return false;">#16</a> </span><div align=left><br>
Вообще это всё полная фигня!<br>На 98й винде explorer 5 и opera крашатся при просмотре <i class=x>exelab.ru</i>, вот это проблема!<br><img src="https://i111.fastpic.ru/big/2020/0330/dd/fcd6a1d95852673a1f64e9e423e97edd.png" border="0" align="" alt=""><br>Небось, читают, как все, dword&#039;ы из <i class=x>KUSER_SHARED_DATA</i>, да никак не прочитают. А <i class=x>opera.dll</i> Блаукович забыл упаковать с 2014 года.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=404791&amp;user=26651&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=16" class="addthx" data-post="404791"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=35473" title="31-03-2020 14:01, ранг:411.9" target="_blank">dosprog</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 марта 2020 13:08 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#17');return false;">#17</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>Небось, читают, как все, dword&#039;ы из KUSER_SHARED_DATA </I><br>угомонись ты с этими привязками, нет способа отлома, без наличия легальной копии.<br>исходные данные для декрипта аргумента в инструкции лежат в лицензии.<br>с ней можно пошарить сервак на 5 актив в день, но какой от этого интерес конечному пользователю?
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=404803&amp;user=3230&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=17" class="addthx" data-post="404803"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 марта 2020 13:53 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#18');return false;">#18</a> </span><div align=left><br>
<I>Bronco пишет:<br>нет способа отлома, без наличия легальной копии... </I><br>И к чему это? Способы отлома обсуждаются в теме <b>&quot;Crack SecuROM &amp; DENUVO&quot;</b>. Была озвучена точка зрения по детектированию вмп-подобных файлов с колокольни av engine.<br><br>ТС мог бы выложить два-три файла для примера, что внесло конкретику в обсуждение.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=404806&amp;user=26651&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=18" class="addthx" data-post="404806"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 марта 2020 14:09 &middot; Поправил: Bronco <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=26404&amp;page=3#19');return false;">#19</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>Была озвучена точка зрения по детектированию вмп-подобных файлов с колокольни av engine. </I><br>ну во первых, фейса дуни в паблике нет. разрабы солидные люди, у аверов к ним вопросов нет. нах им снифеть дуню, мне не ясно.<br>вот вторых, признаки вторичные, не уникальные, детект только в динамике, а без лицензии ....бла-бла-бла по кругу.<br>в третьих, нет ничего впм подобного в дуньке, кроме того что есть примитивная вирта. обфускация вм? так она то же разная
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=404809&amp;user=3230&amp;forum_n=13&amp;topic=26404&amp;page=3&amp;anchor=19" class="addthx" data-post="404809"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=26404&amp;page=2.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=26404&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=13&amp;topic=26404&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=26404&amp;page=2.html">3</a> . <b>4</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Создание сигнатуры для мутированного VMProtect&#039;ом кода</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#20" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="26404">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=26404" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
