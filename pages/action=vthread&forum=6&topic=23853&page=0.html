<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Поможет ли реверсинг? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Уважаемые старожилы, мудрецы, гуру и &quot;!!!!!!&quot; форума!  Прошу Вас поделиться своими комментариями - каким путём и почему Вы пошли бы, решая следующую задачу: • как включить в процесс импорта данных из бинарного файла">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40382'>jinoweb</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Поможет ли реверсинг?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]armaNd0[/b]','')">armaNd0</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.63'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=39876">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2015 03:58 &middot; Поправил: armaNd0 <br><script type="text/javascript">QU('armaNd0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=armaNd0" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Уважаемые старожилы, мудрецы, гуру и &quot;!!!!!!&quot; форума! <img src="img/smilies/s2.gif" alt=""><br><br>Прошу Вас поделиться своими комментариями - каким путём и почему Вы пошли бы, решая следующую задачу:<br> • как включить в процесс импорта данных из бинарного файла процедуру &quot;разбора&quot; этих данных, а точнее - их структурирование (восстановление признаков разделения полей и концов строк). режим <u>read-only</u>.<br><br>Мои комментарии:<br> • есть стандартные (win/x86x/64) реализации импорта (oledb/odbc), работающие со <u>структурированными</u> источниками, и есть юзеры, импортирующие этими механизмами (прямыми запросами) сотни тысяч записей из баз SQL-server в сводные таблицы Excel для дальнейшей аналитики и прочих нужд с завидной скоростью и периодичностью<br> • поставщик некоторых данных переводит часть данных в формат бинарного файла, в котором по несложному алгоритму закодирована таблица. <b>условный</b> пример - представим файл *.csv, из которого удалены символы структуры (\t\r), а в начало файла записаны числа - количество полей и длины каждого. Почти та же таблица, только одной строкой.<br> • требуется внедрить в процесс импорта данных из бинарного файла процедуру их разбора (восстановления удалённых символов структуры), не потеряв юзабилити. то есть чтобы скорость такого импорта была сопоставима с oledb/odbc и чтобы юзер не заметил особой разницы между тем, с каким форматом данных приходится работать.<br> • какие могут быть варианты решения:<br>    &#8594; промежуточный файл-конвертер: нежелательно, предполагается 2 действия (импорт + импорт)<br>    &#8594; прописать на VBA: насколько я знаю, самое медленное, кустарное решение<br>    &#8594; надстройка Excel: менее желательный вариант<br>    &#8594; пропатчить одну из dll (если не ошибаюсь, kernel32 или ole32) - добавив в ReadFile условие <b>если</b> &lt;формат бинарный&gt; <b>то</b> &lt;разбор бинарника&gt; <b>иначе</b> &lt;работа dll в обычном режиме&gt;<br><br>Я не силён в реверсинге, поэтому и прошу совета. Работаю c IDA Pro 6.0, Procmon, apimonitor x64, Visual Studio.<br><br>Буду признателен любым комментариям. Также рассматриваются любые <b>возмездные</b> предложения о помощи - от платных консультаций (Вы говорите что делать - я делаю, показываю итоги, Вы корректируете и направляете, и т.д.) до помощи в работе по программированию.  Или также буду благодарен, если Вы кого-то сможете порекомендовать.<br><br>Спасибо!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=360138&amp;user=39876&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=1" class="addthx" data-post="360138"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2015 04:13 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
че надо сделать так и не понял, что куда заче импортировать ?<br>начните сначала<br><br>winhex умеет разбирать любой бинарный формат на основе не сложного скрипт языка,<br>надо лишь описывать форматы разбора каждого отдельного разного бинарного формата файла
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=360139&amp;user=15381&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=2" class="addthx" data-post="360139"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39876" title="22-11-2015 01:36, ранг:1.0" target="_blank">armaNd0</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.52'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2015 04:22 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Надо ODBC драйвер писать.
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=360140&amp;user=31056&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=3" class="addthx" data-post="360140"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39876" title="22-11-2015 01:36, ранг:1.0" target="_blank">armaNd0</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]armaNd0[/b]','')">armaNd0</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.63'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=39876">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2015 04:24 &middot; Поправил: armaNd0 <br><script type="text/javascript">QU('armaNd0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=armaNd0" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
нууу, если сам <b>reversecode</b> подключился к теме, дело уже не кажется таким безнадёжным! <img src="img/smilies/s1.gif" alt=""><br><br>было (упрощенно): открывает юзер Excel--&gt;Данные--&gt;Из текста--&gt;Импорт текстового файла (*.csv)--&gt;Открыть.... Готово! На лист Excel импортирована таблица. Все записи - с нужных столбцах и строках.<br><br>по-новому: открывает юзер Excel--&gt;Данные--&gt;Из текста--&gt;Все файлы (*.*) [<i class=x>выбирает бинарный файл</i>]--&gt;Открыть.... Готово! На лист Excel импортирована таблица. Все записи - с нужных столбцах и строках. Но импорт был произведён из бинарного файла.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=360141&amp;user=39876&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=4" class="addthx" data-post="360141"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2015 04:27 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
winhex что ли изобретать хотите?<br>сходите почитайте что он уже умеет, может то что вам надо
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=360142&amp;user=15381&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=5" class="addthx" data-post="360142"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]armaNd0[/b]','')">armaNd0</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.63'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=39876">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2015 04:29 <br><script type="text/javascript">QU('armaNd0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=armaNd0" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>hors пишет:<br>Надо ODBC драйвер писать. </I><br>да, верное предложение, такое решение тоже имеет право быть, но на мой взгляд весь огромный функционал odbc окажется просто не используемым. ведь требуется только чтение, create/delete/update не будет... хотя если можно написать light-версию odbc, то супер, слышал, что исходники 2010-го года имеются кажется у народа <img src="img/smilies/s2.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=360143&amp;user=39876&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=6" class="addthx" data-post="360143"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.52'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2015 04:47 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Если необходимо только открывать файлы определенного типа в excel, то можно просто написать плагин, в Visual Studio кажется есть шаблоны.
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=360144&amp;user=31056&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=7" class="addthx" data-post="360144"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39876" title="23-11-2015 19:34, ранг:2.0" target="_blank">armaNd0</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2015 07:57 <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>hors пишет:<br>в Visual Studio кажется есть шаблоны. </I><br><br>Точно, есть такие, кажется начиная с VS 2008.<br> Сам использовал когда-то для подобных целей, правда давно это было.
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=360145&amp;user=4773&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=8" class="addthx" data-post="360145"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39876" title="24-11-2015 22:27, ранг:3.0" target="_blank">armaNd0</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]DrVB_5_6[/b]','')">DrVB_5_6</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 58.3 (постоянный), 50thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.46'>Активность: 0.04<span style='color:green'>&nearr;</span>0.08</span><br>Статус: <a href="action=userinfo&amp;user=19629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2015 10:28 &middot; Поправил: DrVB_5_6 <br><script type="text/javascript">QU('DrVB_5_6','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DrVB_5_6" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>armaNd0 пишет:<br>&#8594; прописать на VBA: насколько я знаю, самое медленное, кустарное решение </I>  <img src="img/smilies/s6.gif" alt=""><br>Ну да, для того, чтобы импортировать несколько килобайт данных, нужно изобрести такой велосипед, у которого будет привод 4х4, турбина от самолёта и ещё чуть-чуть прибамбасов!<br>Это самая примитивная задачка для VBA.<br>А чтобы заметить, что решение &quot;медленное&quot; Вам нужно подсунуть импорт близкий к Гб, только вот Excel его вряд ли прожуёт.<br>А десяток или пару десятков операторов на VBA сработают быстрее, чем Вы передвинете мышку на другое место, впрочем, можно и на asm нарисовать так, что часами будет работать даже на новых процессорах.<br>Вряд ли даже плагины нужны, хотя никто не запрещает. Можно при этом Haskell попробовать использовать - ещё интереснее будет!<br>А если ответить на вопрос, который звучит в названии темы, то реверсинг здесь нахрен не нужен.<br>Тема вообще к нему никакого отношения не имеет!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=360146&amp;user=19629&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=9" class="addthx" data-post="360146"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39876" title="22-11-2015 12:31, ранг:1.0" target="_blank">armaNd0</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2015 14:03 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
если нужен плагин для екзеля, то и реверсинг здесь не нужен, и тема не для этого форума, <br>можно смело закрывать и идти на фриланс искать исполнителя
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=360153&amp;user=15381&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=10" class="addthx" data-post="360153"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]armaNd0[/b]','')">armaNd0</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.63'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=39876">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2015 00:45 &middot; Поправил: armaNd0 <br><script type="text/javascript">QU('armaNd0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=armaNd0" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>hors</b>,<b> plutos</b>, <b>reversecode</b> - спасибо! прислушаюсь к Вашим советам, схожу к шаблонам add-ins<br><br>хотя я был более чем уверен, что перехватить в памяти переменную (в процессе kernel32.ReadFile) и заменить её на себя же преобразованную - самое доступное и правильное решение, чем создание *.xla<br><br>И мой вопрос как раз был именно в этом - оптимален ли реверсинг kernel32 как решение или нет?<br><br>неожиданно, что большинство отмечает колоссальную сложность такого решения<br><br><b>DrVB_5_6</b>, спасибо за отклик, добавлю немного ясности:<br><br>реальные условия задачи таковы - из бинарного файла размером более 1Гб в pivot table (excel) требуется импортировать порядка 100Мб данных для аналитиков + есть вероятность того, что будет востребована масштабируемость решения<br><br>поэтому я предположил, что vba проиграет по скорости решению с пропатченной dll<br><br>версия про плагины принята; обязательно ознакомлюсь с тем, что есть haskell и, с Вашего позволения, задам вопросы и по этому варианту
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=360164&amp;user=39876&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=11" class="addthx" data-post="360164"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2015 01:33 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>armaNd0 пишет:<br>поэтому я предположил, что vba проиграет по скорости решению с пропатченной dll<br> </I><br>Ок. Патчить будем функцию CreateFileMapping(..).<br>Самый нормальный вариант. Чем этот скушный бейсик.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=360165&amp;user=35473&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=12" class="addthx" data-post="360165"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2015 17:17 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>armaNd0 пишет:<br>оптимален ли реверсинг kernel32 как решение или нет? </I><br>Для перехвата реверсинг и не нужен<br><br><I>armaNd0 пишет:<br>неожиданно, что большинство отмечает колоссальную сложность такого решения </I><br>Для неподготовленного человека, без специфических навыков, это будет проблемно, потому следом можно было бы скорей всего ждать топика &quot;что я делаю не так с инжектом?&quot; <img src="img/smilies/s1.gif" alt=""><br>Да, Вам верно посоветовали. Этот не тот случай для инжектов/перехватов/подмен.<br><br><I>hors пишет:<br>Надо ODBC драйвер писать. </I><br><I>да, верное предложение, такое решение тоже имеет право быть, но на мой взгляд весь огромный функционал odbc окажется просто не используемым. ведь требуется только чтение, create/delete/update не будет... </I><br>Да ну а Вам-то что, что не будет востребован? Весь функционал в dll лежит. В %SystemRoot/System32/% много разных dll и exe, функционал которых никогда не востребуется. Достаточно просто использовать, что надо<br><br><I>hors пишет:<br>Если необходимо только открывать файлы определенного типа в excel, то можно просто написать плагин, в Visual Studio кажется есть шаблоны.  </I><br>Да, верно, в MSVS есть возможность создавать excel-приложения на C#, на vb#, чтобы сворганить свою обработку данных и распределить по листам, по ячейкам.<br><br>Но, ИМХО, мне для себя было бы проще подключить dll, с 3-4мя хуками, ибо уже набил руку тут. Просто на системах с включённым HIPS может не работать. И если это для кого-то, а не для себя, то всё зависит от уровня этого кого-то, а то и объяснять придётся, как правильно воспользоваться поделкой )
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=360167&amp;user=24257&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=13" class="addthx" data-post="360167"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39876" title="23-11-2015 19:33, ранг:2.0" target="_blank">armaNd0</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2015 17:54 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>DenCoder пишет:<br>то всё зависит от уровня этого кого-то, а то и объяснять придётся, как правильно воспользоваться поделкой )  </I><br>вот тут.. наверно самое важное. Надо использовать решение, которое ближе к телу.. Реализовывать его на том, в чем больше познаний. А идеал можно писать вечно.<br>З.Ы. ИМХО.. не выдержит екцел такого обьема данных.. ИМХО задача изначально не правильно поставлена. Конвертер можно делать на чем угодно и потом всовывать в ексцел.. перед тем как это все делать.. я б рекомендовал автору топика, сделать мусорный файл сходного обьема, для теста и попробовать подсунуть эксцелу.. ну не для этого он писался.. (споминаю студенческие годы, когда ВОРД документ с 30 страницами таблиц и формул умирал.)
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=360168&amp;user=17319&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=14" class="addthx" data-post="360168"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39876" title="23-11-2015 19:33, ранг:2.0" target="_blank">armaNd0</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2015 18:09 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>VodoleY пишет:<br>споминаю студенческие годы, когда ВОРД документ с 30 страницами таблиц и формул умирал. </I><br>Да да. В Excel было раньше(12 лет назад) ограничение - не больше 32768 строк. Как сейчас - не знаю, пока не могу посмотреть, но скорей всего так и осталось. Если элемент данных из 4х байт, объём файла данных 4 гб и по 2 элемента на строчку, то 16 листов понадобится.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=360169&amp;user=24257&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=15" class="addthx" data-post="360169"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31932" title="24-11-2015 13:43, ранг:3.2" target="_blank">TLN</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]armaNd0[/b]','')">armaNd0</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.63'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=39876">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 ноября 2015 00:59 &middot; Поправил: armaNd0 <br><script type="text/javascript">QU('armaNd0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=armaNd0" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>DenCoder пишет:<br>&quot;что я делаю не так с инжектом?&quot; </I><br>Вы правы, я практически уже написал это <img src="img/smilies/s3.gif" alt=""><br><br><I>DenCoder пишет:<br> Этот не тот случай для инжектов/перехватов/подмен </I><br>И тем не менее Вы пишете <I> Но, ИМХО, мне для себя было бы проще подключить dll, с 3-4мя хуками </I><br><br><I>DenCoder пишет:<br>Да ну а Вам-то что, что не будет востребован? </I><br>Если мы обсуждаем вариант написания odbc-драйвера, то заплатить попросят за весь функционал, в том числе за невостребованный. А если не писать драйвер с нуля и поправить существующий функционал - это уже другое дело)<br><br>p.s.<br><I>VodoleY пишет:<br>не выдержит екцел такого обьема данных.. </I><br><I>DenCoder пишет:<br>В Excel было раньше(12 лет назад) ограничение - не больше 32768 строк. Как сейчас - не знаю, пока не могу посмотреть, но скорей всего так и осталось.  </I><br>Всё кардинально изменилось. Новые xml-форматы файлов office (*.xlsx,*.docx и т.п.) существенно облегчили размеры файлов и скорость работы с ними и в них.<br><br>В Excel (до 2007) действительно было зашито ограничение на выделенную память под хранение адресов - 2^16 или 65&#039;536 строк. В новом Excel 2^20 или 1&#039;048&#039;576 строк.<br><br>Могу сказать, что сейчас прямым запросом с SQL-servera в Excel закачивается порядка 100 Мб данных примерно за 5 минут (~600.000 записей). Стабильно работает (тьфу-тьфу) более 5 лет (финансовая аналитика). Пользователи в восторге - ведь они получают не просто таблицу данных, а pivot table со всем его функционалом, шикарно реализованным в Excel.<br><br>А исходная проблема топика собственно и возникла в связи с тем, что нужно подключиться к новой БД, представляющей собой бинарный файл с <i class=x>раз</i>структурированными данными.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=360181&amp;user=39876&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=16" class="addthx" data-post="360181"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 ноября 2015 02:09 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>armaNd0 пишет:<br>И тем не менее Вы пишете  </I><br>Пишу, ведь у меня нет проблем с этим. А Вы ещё только рассматриваете это как возможный вариант. Не всё так просто! Я когда начинал внедрять код в другие процессы, у меня вообще-то ещё была Win98(это был 2005 год), под которой не работает функа CreateRemoteThread(). И приходилось писать код под XP, носить на дискете скомпиленую прогу до места назначения, пробовать там, возвращаться, исправлять ошибки... полдня так побегал, надоело... Второй раз был уже в 2008 на XP и удачный. Но привыкнуть к указателям, к указателям на указатели, к приведению типов DWORD к указателям на BYTE и обратно, написанию кода на асме, который должен работать базонезависимо в адресном пространстве другого процесса, и т.п., пользуясь только информацией о потенциальных возможностях, взятых из MSDN... доставляло немало геморроя... Сейчас интернет стал более доступен, масса примеров в сети, но для некоторых это мало меняет дело...<br><br><I>armaNd0 пишет:<br>Если мы обсуждаем вариант написания odbc-драйвера, то заплатить попросят за весь функционал, в том числе за невостребованный. </I><br>То есть Вы определяетесь с вариантом тз исполнителю. <img src="img/smilies/s1.gif" alt=""><br>Совсем не факт, что вариант через odbc будет стоить дороже инжекта с подменой данных.<br><br>1. Читаем бинарный файл<br>2. Обрабатываем как надо<br>3. Через odbc-драйвер вставляем в xls-файл. Не по одной записи, а заполняем ими буфер на 32 -64 мб и пачками инсертим, если екселевская бд позволяет так. Это повысило бы скорость по сравнению с построчной вставкой.<br><br>План Б. Если не поддерживается xls-провайдером многострочная вставка или вставка из потока ввода, лучше разобрать формат для непосредственной вставки в xls, чем писать костыль для экселя.<br><br>Ниже пример, который 6.5 лет назад писал для преобразования текстового файла в файл Excel. Часть где-то взял, переправил и откомментировал подробно для студента. Конечно, его нужно переправить в соответствии с пп.1-3<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Обработчик&nbsp;события&nbsp;нажатия&nbsp;на&nbsp;кнопку</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Получаем&nbsp;пути&nbsp;файлов&nbsp;и&nbsp;имя&nbsp;листа&nbsp;из&nbsp;полей&nbsp;ввода</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TxtFile<span class="hl_char">.</span>GetWindowTextA<span class="hl_char">(</span>sTxtFile<span class="hl_char">)</span><span class="hl_comment">;//Путь к текстовому файлу</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XlsFile<span class="hl_char">.</span>GetWindowTextA<span class="hl_char">(</span>sXlsFile<span class="hl_char">)</span><span class="hl_comment">;//Путь к файлу Excel</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SheetName<span class="hl_char">.</span>GetWindowTextA<span class="hl_char">(</span>sSheet<span class="hl_char">)</span><span class="hl_comment">;//Имя листа</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Объявление&nbsp;переменных<span class="hl_char">,</span>&nbsp;<span class="hl_char">*</span>&nbsp;означает&nbsp;переменная&nbsp;<span class="hl_char">-</span>&nbsp;указатель&nbsp;на&nbsp;тип</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CStringArray&nbsp;aRows<span class="hl_char">,</span>&nbsp;<span class="hl_char">*</span>aHeaders<span class="hl_char">,</span>&nbsp;<span class="hl_char">*</span>aFields<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CString&nbsp;sSql<span class="hl_char">,</span>&nbsp;stmp<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span style="word-break: break-all">Пробуем&nbsp;открыть&nbsp;указанный&nbsp;текстовый&nbsp;файл&nbsp;только&nbsp;для&nbsp;чтения&nbsp;и&nbsp;без&nbsp;разделения&nbsp;доступа</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;оператором&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;выделяем&nbsp;область&nbsp;памяти&nbsp;под&nbsp;переменную&nbsp;класса&nbsp;CFile</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CFile<span class="hl_char">*</span>&nbsp;File&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;CFile<span class="hl_char">(</span>sTxtFile<span class="hl_char">,</span>&nbsp;CFile<span class="hl_char">:</span><span class="hl_char">:</span>modeRead&nbsp;<span class="hl_char">|</span>&nbsp;CFile<span class="hl_char">:</span><span class="hl_char">:</span>shareDenyNone<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>File<span class="hl_char">)</span><span class="hl_char">/</span><span class="hl_char">/</span>Если&nbsp;файл&nbsp;удалось&nbsp;открыть</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CArchive<span class="hl_char">*</span>&nbsp;Archive&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;CArchive<span class="hl_char">(</span>File<span class="hl_char">,</span>&nbsp;CArchive<span class="hl_char">:</span><span class="hl_char">:</span>load<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Удаляем&nbsp;все&nbsp;строки<span class="hl_char">,</span>&nbsp;которые&nbsp;могли&nbsp;там&nbsp;оказаться</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aRows<span class="hl_char">.</span>RemoveAll<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">while</span><span class="hl_char">(</span>Archive<span class="hl_char">-</span><span class="hl_char">&gt;</span>ReadString<span class="hl_char">(</span>stmp<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;aRows<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>stmp<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Освобождаем&nbsp;области&nbsp;памяти</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete&nbsp;Archive<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete&nbsp;File<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span><span class="hl_char">/</span><span class="hl_char">/</span>Если&nbsp;файл&nbsp;не&nbsp;удалось&nbsp;открыть</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Формируем&nbsp;строку&nbsp;сообщения&nbsp;об&nbsp;ошибке</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>в&nbsp;строке&nbsp;формата&nbsp;<span class="hl_char">%</span>s&nbsp;указывает&nbsp;где&nbsp;вставить&nbsp;имя&nbsp;файла&nbsp;sTxtFile</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stmp<span class="hl_char">.</span><span class="hl_function">Format</span><span class="hl_char">(</span><span class="hl_quote">&quot;Убедитесь, что Файл %s существует&quot;</span><span class="hl_char">,</span>&nbsp;sTxtFile<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Вывод&nbsp;сообщения&nbsp;об&nbsp;ошибке&nbsp;на&nbsp;экран</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_function"><b>NULL</b></span>&nbsp;сообщает<span class="hl_char">,</span><span style="word-break: break-all">&nbsp;что&nbsp;нет&nbsp;родительского&nbsp;окна&nbsp;и&nbsp;тогда&nbsp;окно&nbsp;сообщения&nbsp;не&nbsp;блокирует&nbsp;никакое&nbsp;окно</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_number">3</span><span class="hl_char">-</span>й&nbsp;параметр&nbsp;<span class="hl_char">-</span>&nbsp;заголовок&nbsp;окна&nbsp;сообщения&nbsp;об&nbsp;ошибке</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>MB_OK&nbsp;<span class="hl_char">-</span>&nbsp;окно&nbsp;сообщения&nbsp;с&nbsp;кнопкой&nbsp;OK</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Оператор&nbsp;<span class="hl_char">:</span><span class="hl_char">:</span>&nbsp;означает<span class="hl_char">,</span>&nbsp;что&nbsp;вызываем&nbsp;глобальную&nbsp;ф<span class="hl_char">-</span>цию</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">:</span><span class="hl_char">:</span>MessageBox<span class="hl_char">(</span><span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;stmp<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;Ошибка чтения файла&quot;</span><span class="hl_char">,</span>&nbsp;MB_OK<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Читаем&nbsp;заголовки<span class="hl_char">,</span>&nbsp;заголовки&nbsp;<span class="hl_char">-</span>&nbsp;самая&nbsp;первая&nbsp;строка<span class="hl_char">,</span>&nbsp;в&nbsp;массиве&nbsp;CStringArray&nbsp;она&nbsp;с&nbsp;индексом&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aHeaders&nbsp;<span class="hl_char">=</span>&nbsp;ReadHeaders<span class="hl_char">(</span>aRows<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Создаем&nbsp;переменную&nbsp;класса&nbsp;CDatabase&nbsp;для&nbsp;сохранения&nbsp;данных&nbsp;в&nbsp;формате&nbsp;Excel</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDatabase<span class="hl_char">*</span>&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;CDatabase<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CString&nbsp;sDSN<span class="hl_char">,</span>&nbsp;sPath<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Определяем&nbsp;папку&nbsp;файла&nbsp;Excel</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;nSlashPos&nbsp;<span class="hl_char">=</span>&nbsp;sXlsFile<span class="hl_char">.</span>ReverseFind<span class="hl_char">(</span><span class="hl_quote">''</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>nSlashPos&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">)</span>nSlashPos&nbsp;<span class="hl_char">=</span>&nbsp;sXlsFile<span class="hl_char">.</span>ReverseFind<span class="hl_char">(</span><span class="hl_quote">'/'</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>nSlashPos&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">)</span>sPath&nbsp;<span class="hl_char">=</span>&nbsp;sXlsFile<span class="hl_char">.</span>Left<span class="hl_char">(</span>nSlashPos&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;sPath&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;\.&quot;</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Формируем&nbsp;строку&nbsp;подключения&nbsp;к&nbsp;базе&nbsp;данных</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>в&nbsp;строке&nbsp;формата&nbsp;<span class="hl_number">1</span><span class="hl_char">-</span>ый&nbsp;<span class="hl_char">%</span>s&nbsp;указывает&nbsp;где&nbsp;вставить&nbsp;имя&nbsp;Excel<span class="hl_char">-</span>файла&nbsp;sXlsFile<span class="hl_char">,</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">-</span>ой&nbsp;<span class="hl_char">-</span>&nbsp;папку&nbsp;файла</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sDSN<span class="hl_char">.</span><span class="hl_function">Format</span><span class="hl_char">(</span><span class="hl_quote">&quot;dsn=файлы excel;dbq=%s;defaultDir=%s;DriverId=790;&quot;</span><span class="hl_char">,</span>&nbsp;sXlsFile<span class="hl_char">,</span>&nbsp;sPath<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Объявляем&nbsp;переменную<span class="hl_char">,</span>&nbsp;посредством&nbsp;которой&nbsp;будет&nbsp;заполняться&nbsp;таблица&nbsp;в&nbsp;нашем&nbsp;диалоге</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CString&nbsp;sCSVData<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Пробуем&nbsp;подключиться&nbsp;через&nbsp;базу&nbsp;данных&nbsp;к&nbsp;файлу&nbsp;Excel</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span><span class="hl_function">db</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>OpenEx<span class="hl_char">(</span>sDSN<span class="hl_char">,</span>&nbsp;CDatabase<span class="hl_char">:</span><span class="hl_char">:</span>noOdbcDialog<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">/</span><span class="hl_char">/</span>Если&nbsp;получилось</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Пробуем&nbsp;удалить&nbsp;лист<span class="hl_char">,</span>&nbsp;возможно&nbsp;указанный&nbsp;файл&nbsp;существует&nbsp;и&nbsp;есть&nbsp;такой&nbsp;лист</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DeleteTable<span class="hl_char">(</span><span class="hl_function">db</span><span class="hl_char">,</span>&nbsp;sSheet<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Заново&nbsp;создаем&nbsp;лист</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>CreateTable<span class="hl_char">(</span><span class="hl_function">db</span><span class="hl_char">,</span>&nbsp;sSheet<span class="hl_char">,</span>&nbsp;<span class="hl_char">*</span>aHeaders<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">/</span><span class="hl_char">/</span>Если&nbsp;лист&nbsp;создан</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>Узнаем&nbsp;число&nbsp;строк&nbsp;и&nbsp;число&nbsp;столбцов&nbsp;<span class="hl_char">(</span>по&nbsp;числу&nbsp;заголовков<span class="hl_char">)</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>int</b></span>&nbsp;RowCount&nbsp;<span class="hl_char">=</span>&nbsp;aRows<span class="hl_char">.</span>GetCount<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;HeadersCount&nbsp;<span class="hl_char">=</span>&nbsp;aHeaders<span class="hl_char">-</span><span class="hl_char">&gt;</span>GetCount<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>Формируем&nbsp;первую&nbsp;строку&nbsp;для&nbsp;заполнения&nbsp;таблицы</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for</span><span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; i &lt; HeadersCount; i++)</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sCSVData&nbsp;</span><span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;aHeaders<span class="hl_char">-</span><span class="hl_char">&gt;</span>GetAt<span class="hl_char">(</span>i<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">if</span><span class="hl_char">(</span>HeadersCount&nbsp;<span class="hl_char">-</span>&nbsp;i&nbsp;<span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;sCSVData&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;,&quot;</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>Добавляем&nbsp;к&nbsp;строке&nbsp;символы&nbsp;конца&nbsp;строки</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sCSVData&nbsp;</span><span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;\r\n&quot;</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_number">0</span><span class="hl_char">-</span>ая&nbsp;строка&nbsp;<span class="hl_char">-</span>&nbsp;строка&nbsp;заголовков</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for</span><span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">; i &lt; RowCount; i++)</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><span class="hl_char">/</span><span class="hl_char">/</span>Получаем&nbsp;следующие&nbsp;строки<span class="hl_char">,</span><span style="word-break: break-all">&nbsp;добавляем&nbsp;их&nbsp;через&nbsp;БД&nbsp;в&nbsp;файл&nbsp;Excel&nbsp;и&nbsp;продолжаем&nbsp;формировать&nbsp;данные&nbsp;для&nbsp;таблицы</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>Получаем&nbsp;следующую&nbsp;строку</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aFields&nbsp;</span><span class="hl_char">=</span>&nbsp;ReadFields<span class="hl_char">(</span>aRows<span class="hl_char">,</span>&nbsp;i<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>добавляем&nbsp;строку&nbsp;<span class="hl_char">-</span>&nbsp;значения&nbsp;столбцов&nbsp;через&nbsp;БД&nbsp;в&nbsp;файл&nbsp;Excel&nbsp;</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddRow</span><span class="hl_char">(</span><span class="hl_function">db</span><span class="hl_char">,</span>&nbsp;sSheet<span class="hl_char">,</span>&nbsp;<span class="hl_char">*</span>aHeaders<span class="hl_char">,</span>&nbsp;<span class="hl_char">*</span>aFields<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>продолжаем&nbsp;формировать&nbsp;данные&nbsp;для&nbsp;таблицы</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>int</b></span>&nbsp;FieldsCount&nbsp;<span class="hl_char">=</span>&nbsp;aFields<span class="hl_char">-</span><span class="hl_char">&gt;</span>GetCount<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for</span><span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; i &lt; FieldsCount; i++)</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sCSVData&nbsp;</span><span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;aFields<span class="hl_char">-</span><span class="hl_char">&gt;</span>GetAt<span class="hl_char">(</span>i<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">if</span><span class="hl_char">(</span>FieldsCount&nbsp;<span class="hl_char">-</span>&nbsp;i&nbsp;<span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;sCSVData&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;,&quot;</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sCSVData&nbsp;</span><span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;\r\n&quot;</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>так&nbsp;как&nbsp;у&nbsp;нас&nbsp;массив&nbsp;занчений&nbsp;столбцов&nbsp;создается&nbsp;динамически<span class="hl_char">,</span>&nbsp;то&nbsp;удаляем<span class="hl_char">/</span>освобождаем&nbsp;область&nbsp;памяти</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete&nbsp;aFields</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>Заполняем&nbsp;нашу&nbsp;таблицу&nbsp;в&nbsp;диалоге</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spreadsheet</span><span class="hl_char">.</span>put_CSVData<span class="hl_char">(</span>sCSVData<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Закрываем&nbsp;базу&nbsp;данных</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">db</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>Close<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span><span class="hl_char">/</span><span class="hl_char">/</span>Не&nbsp;получилось&nbsp;открыть&nbsp;файл</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stmp<span class="hl_char">.</span><span class="hl_function">Format</span><span class="hl_char">(</span><span class="hl_quote">&quot;Не удалось создать/открыть файл %s.&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stmp&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;Убедитесь, что вы обладаете достаточными правами и что файл не используется другим приложением&quot;</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">:</span><span class="hl_char">:</span>MessageBox<span class="hl_char">(</span><span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;stmp<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;Ошибка БД&quot;</span><span class="hl_char">,</span>&nbsp;MB_OK<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Освобождаем&nbsp;область&nbsp;памяти&nbsp;из<span class="hl_char">-</span>под&nbsp;массива&nbsp;заголовков</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete&nbsp;aHeaders<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Освобождаем&nbsp;область&nbsp;памяти&nbsp;из<span class="hl_char">-</span>под&nbsp;БД</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete&nbsp;<span class="hl_function"><b>db</b></span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=360182&amp;user=24257&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=17" class="addthx" data-post="360182"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39876" title="25-11-2015 06:53, ранг:3.0" target="_blank">armaNd0</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 ноября 2015 14:59 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Так вот кто пишет на MFC. Наконец-то я увидел этих динозавров &quot;в живую&quot; <img src="img/smilies/s2.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=360183&amp;user=2449&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=18" class="addthx" data-post="360183"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=16624" title="25-11-2015 12:45, ранг:265.6" target="_blank">MasterSoft</a>, <a href="action=userinfo&user=24257" title="25-11-2015 13:19, ранг:241.6" target="_blank">DenCoder</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 ноября 2015 16:18 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<img src="img/smilies/s1.gif" alt=""><br><br>Комбинации \ \ в постах по-прежнему подвергаются преобразованиям<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Было&nbsp;<span class="hl_char">(</span>без&nbsp;лишних&nbsp;пробелов<span class="hl_char">)</span>&nbsp;<span class="hl_quote">&quot; \ \ &quot;</span><span class="hl_char">,</span></li><li class="hl_l1">стало&nbsp;<span class="hl_quote">&quot;&quot;</span><span class="hl_char">(</span>тут&nbsp;должно&nbsp;быть&nbsp;<span class="hl_number">2</span>&nbsp;слеша&nbsp;в&nbsp;кавычках<span class="hl_char">,</span>&nbsp;а&nbsp;их&nbsp;нет<span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br>Выглядит так, как будто в коде ошибка. Для изучающих Си очень мучительно будет искать
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=360185&amp;user=24257&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=19" class="addthx" data-post="360185"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]armaNd0[/b]','')">armaNd0</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.63'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=39876">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 ноября 2015 10:38 <br><script type="text/javascript">QU('armaNd0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=armaNd0" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23853.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
Резюме темы.<br><br>Я понял и авторов первых откликов, и <b>DenCoder</b>, <b>VodoleY</b> - решение кардинально зависит от параметров пользователей. &#039;Под себя&#039;, на 1 машину - оптимален инжект. Для 5-10 пользователей - создание Addin. Масштабируемое коммерческое решение - odbc-драйвер.<br><br><u>Спасибо ВСЕМ, кто нашёл время поделиться своими комментариями - благодаря Вам я нашёл ответ на свой вопрос.</u><br><br>Проект будет опубликован на фрилансе.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=360226&amp;user=39876&amp;forum_n=6&amp;topic=23853.html&amp;page=0&amp;anchor=20" class="addthx" data-post="360226"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Поможет ли реверсинг?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#21" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="23853">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23853" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
