<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Аналог recv - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Недавно начал ковырять одну очень интересную прогу, (не могу сказать какую), и суть в том, что внедряя свою библиотеку, мне прекрасно удаётся перехватить функцию send, и я знаю, что она отправляет серверу, но при перехвате">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a>, <a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a>, <a target='_blank' href='?action=userinfo&amp;user=50833'>vasilevradislav</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Аналог recv</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2008 21:02 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Недавно начал ковырять одну очень интересную прогу, (не могу сказать какую), и суть в том, что внедряя свою библиотеку, мне прекрасно удаётся перехватить функцию send, и я знаю, что она отправляет серверу, но при перехвате функции recv ничего не происходит, т.к. прога её не использует. Внимание, вопрос<img src="img/smilies/s1.gif" alt="">, как можно ещё принимать данные от удалённого сервера, и как их перехватить, буду рад любым советам, вплоть до написания драйвера, лишь бы знать, что писать, т.к. уже всё, вроде бы, перепробовал
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=200759&amp;user=6336&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=1" class="addthx" data-post="200759"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]arnix[/b]','')">arnix</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 210.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2008 21:06 <br><script type="text/javascript">QU('arnix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=arnix" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
если не recv то возможно просто read
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=200760&amp;user=26&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=2" class="addthx" data-post="200760"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2008 21:10 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>arnix</b><br>можно поподробнее, а то про эту функцию я ни хрена не знаю<img src="img/smilies/s4.gif" alt="">
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=200761&amp;user=6336&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=3" class="addthx" data-post="200761"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Av0id[/b]','')">Av0id</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 516.1 (<b>!</b>), 39thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1378">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2008 21:14 <br><script type="text/javascript">QU('Av0id','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Av0id" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
recv_from
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=200763&amp;user=1378&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=4" class="addthx" data-post="200763"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2008 21:17 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>Av0id</b><br>в смысле, та что recvfrom? Не, не она<img src="img/smilies/s4.gif" alt="">
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=200765&amp;user=6336&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=5" class="addthx" data-post="200765"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]arnix[/b]','')">arnix</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 210.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2008 21:29 <br><script type="text/javascript">QU('arnix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=arnix" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>пример<br>n = read(socket, pbuf, 32)<br><br>socket - понятно<br>pbuf - char* указатель на буффер<br>32 - сколько байт максимум читать (получить)<br><br>возвращает число полученных байт<br><br>кста, эта функция точно есть в unix-ax, может в винде нет не помню (или называется _read)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=200768&amp;user=26&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=6" class="addthx" data-post="200768"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2008 21:35 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>arnix</b><br><i class=x>Вырезка с MSDN:</i><br><b><br>_read<br>Reads data from a file.<br><br>int _read( int handle, void *buffer, unsigned int count );</b><br><br>Ты уверен, что в винде такое есть? В смысле, оно связано с сетью?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=200769&amp;user=6336&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=7" class="addthx" data-post="200769"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]arnix[/b]','')">arnix</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 210.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2008 21:38 &middot; Поправил: arnix <br><script type="text/javascript">QU('arnix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=arnix" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
так, извиняюсь read/write и вправду только в юниксах, просто я недавно писал сервер под линукс и использовал read/write вместа recv/send вот и подумал что в виндах тоже можно, а оказывается:<br><br>[url=http://www.cs.brown.edu/~scl/files/IPCWinNTUNIX.pdf<br>]http://www.cs.brown.edu/~scl/files/IPCWinNTUNIX.pdf<br>[/url]<br><br>&quot;Some Berkeley socket applications use the _read() and _write() calls since UNIX treats sockets as<br>files. Windows sockets support these functions, but some additional work on the part of the<br>programmer is required. The socket must be opened as non-overlapped and must be converted to a<br>file handle by calling _open_osfhandle(). This will return a file handle (i.e. an int) which can then<br>be used with _read() and _write().&quot;<br><br>тойсть _read() и _write() использовать можно на сокетах но сначала нужно &quot;конвертнуть сокет в файл&quot; с помощью  _open_osfhandle()
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=200770&amp;user=26&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=8" class="addthx" data-post="200770"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2008 21:46 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>arnix</b><br>я проверю, ну, а можно ли что-то более низкоуровневое? Как, например, тот же OutPost определяет, что возникла сетевая активность со стороны какого-то приложения?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=200774&amp;user=6336&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=9" class="addthx" data-post="200774"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2008 21:57 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Драйвер вешает аутпост, в эту тему без ОГРОМНОЙ надобности лучше не соваться. Для общего представления можешь почитать обход аутпоста на васме, там частично описано, что он хукает и как. Но вряд ли это тебе поможет.<br>Сам я не игрался с сетевыми апи, могу только посоветовать посмотреть на экспорт, какие по именам функи ещё ближе+потрассить сам recv, возможно, натолкнёт на мысль, к какой низкоуровневой функции сводятся вызовы получения.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=200780&amp;user=1556&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=10" class="addthx" data-post="200780"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2008 22:06 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>Archer</b><br>чтоб узнать, какие функции хукает Outpost, много ума не надо, надо посмотреть по KDT перехват в ядре, например, через Rootkit Unhooker, плюс ещё перехват с помощью удалённых хуков в третьем кольце, и обойти это можно гораздо проще, чем на васме написано, притом не древнюю 4 версию, а новую 6. Но проблема в том, что если я просто полезу в ядро, то лес станет ещё темнее, а партизаны толще<img src="img/smilies/s1.gif" alt="">, и ничего не проясниться, но всё равно спасибо, попробую потрассировать.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=200782&amp;user=6336&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=11" class="addthx" data-post="200782"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 августа 2008 22:52 <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
я не силен в сетевых апи, но может стоит попробовать отследить хендлы открываемых сокетов программой и смотреть кто их использует и как?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=200961&amp;user=131&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=12" class="addthx" data-post="200961"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2008 01:33 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>ARCHANGEL</b> посмотри у целевой проги табличку импорта (вызовы), просто тупо просматривая функцию за функцией и скорее всего увидишь то что интересует. Скорее всего даже будет рядом с send
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=200982&amp;user=3232&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=13" class="addthx" data-post="200982"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]theCollision[/b]','')">theCollision</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 271.5 (наставник), 12thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.24'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4439">Участник</a><br><font color=blue>Packer Reseacher</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2008 11:07 <br><script type="text/javascript">QU('theCollision','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=theCollision" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>А ReadFile смотрел ?<br>&gt;&gt;For asynchronous read operations, hFile can be any handle that is opened with the FILE_FLAG_OVERLAPPED flag by the CreateFile function, or a socket handle returned by the socket or accept function.
<br><br><font size="1"><i>-----<br>My love is very cool girl.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=201006&amp;user=4439&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=14" class="addthx" data-post="201006"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 сентября 2008 18:51 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>theCollision</b><br>Смотрел - не она!
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=201925&amp;user=6336&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=15" class="addthx" data-post="201925"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]sss[/b]','')">sss</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 37.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.83'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6443">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2008 10:38 &middot; Поправил: sss <br><script type="text/javascript">QU('sss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sss" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>ARCHANGEL</b> - WSARecv, WSARecvEx, WSARecvMsg, WSARecvFrom, TransmitFile???
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=202026&amp;user=6443&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=16" class="addthx" data-post="202026"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]flamer[/b]','')">flamer</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 25.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.26'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4338">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2008 10:58 &middot; Поправил: flamer <br><script type="text/javascript">QU('flamer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=flamer" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>как можно ещё принимать данные от удалённого сервера </I><br>Высокоуровневых методов до фига. Это не полный список:<br>winApi = Весь комплект из Winhttp.dll , wininet.dll ws ws2_32.dll<br>mswsock.dll winsock.dll wsock32.dll  ws2help.dll<br>.NET <br>Namespace: System.Net<br>Assembly: System (in system.dll)<br><br>А вообще, изначально <i class=x>посмотри на импорты.</i><br><br>Возможно, имеет смысл  узнать куда и по какому протоколу суется софтинка.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;drf<span class="hl_char">.</span>cpp&nbsp;<span class="hl_char">:</span>&nbsp;Defines&nbsp;the&nbsp;<span class="hl_function"><b>entry</b></span>&nbsp;point&nbsp;for&nbsp;the&nbsp;console&nbsp;application<span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span></li><li class="hl_l1"></li><li class="hl_l0">#include&nbsp;<span class="hl_quote">&quot;stdafx.h&quot;</span></li><li class="hl_l1">#pragma&nbsp;<span class="hl_function">comment</span><span class="hl_char">(</span>&nbsp;lib<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;ws2_32.lib&quot;</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0"></li><li class="hl_l1"></li><li class="hl_l0">#include&nbsp;<span class="hl_char">&lt;</span>conio<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l1">#include&nbsp;<span class="hl_char">&lt;</span>stdio<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l0">#include&nbsp;<span class="hl_char">&lt;</span>stdlib<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l1">#include&nbsp;<span class="hl_char">&lt;</span>winsock2<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l0"></li><li class="hl_l1">#define&nbsp;MAX_PACKET_SIZE&nbsp;&nbsp;&nbsp;&nbsp;0x10000</li><li class="hl_l0">#define&nbsp;SIO_RCVALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x98000001</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Буфер&nbsp;для&nbsp;приёма&nbsp;данных</li><li class="hl_l0"><span class="hl_function"><b>char</b></span>&nbsp;Buffer<span class="hl_char">[</span>MAX_PACKET_SIZE<span class="hl_char">]</span><span class="hl_comment">; // 64 Kb</span></li><li class="hl_l1"></li><li class="hl_l0"></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>Структура&nbsp;заголовка&nbsp;IP<span class="hl_char">-</span>пакета</li><li class="hl_l0"></li><li class="hl_l1">typedef&nbsp;struct&nbsp;IPHeader&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;UCHAR&nbsp;&nbsp;&nbsp;iph_verlen<span class="hl_comment">;   // версия и длина заголовка</span></li><li class="hl_l1">&nbsp;&nbsp;UCHAR&nbsp;&nbsp;&nbsp;iph_tos<span class="hl_comment">;      // тип сервиса</span></li><li class="hl_l0">&nbsp;&nbsp;USHORT&nbsp;&nbsp;iph_length<span class="hl_comment">;   // длина всего пакета</span></li><li class="hl_l1">&nbsp;&nbsp;USHORT&nbsp;&nbsp;iph_id<span class="hl_comment">;       // Идентификация</span></li><li class="hl_l0">&nbsp;&nbsp;USHORT&nbsp;&nbsp;iph_offset<span class="hl_comment">;   // флаги и смещения</span></li><li class="hl_l1">&nbsp;&nbsp;UCHAR&nbsp;&nbsp;&nbsp;iph_ttl<span class="hl_comment">;      // время жизни пакета</span></li><li class="hl_l0">&nbsp;&nbsp;UCHAR&nbsp;&nbsp;&nbsp;iph_protocol<span class="hl_comment">; // протокол</span></li><li class="hl_l1">&nbsp;&nbsp;USHORT&nbsp;&nbsp;iph_xsum<span class="hl_comment">;     // контрольная сумма</span></li><li class="hl_l0">&nbsp;&nbsp;ULONG&nbsp;&nbsp;&nbsp;iph_src<span class="hl_comment">;      // IP-адрес отправителя</span></li><li class="hl_l1">&nbsp;&nbsp;ULONG&nbsp;&nbsp;&nbsp;iph_dest<span class="hl_comment">;     // IP-адрес назначения</span></li><li class="hl_l0">}&nbsp;IPHeader<span class="hl_comment">;</span></li><li class="hl_l1"></li><li class="hl_l0"><span class="hl_function"><b>char</b></span>&nbsp;src<span class="hl_char">[</span><span class="hl_number">10</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>char</b></span>&nbsp;dest<span class="hl_char">[</span><span class="hl_number">10</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">[</span><span class="hl_number">15</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1"></li><li class="hl_l0">unsigned&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;lowbyte<span class="hl_comment">;</span></li><li class="hl_l1">unsigned&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;hibyte<span class="hl_comment">;</span></li><li class="hl_l0"></li><li class="hl_l1"><span class="hl_function"><b>int</b></span>&nbsp;_tmain<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;argc<span class="hl_char">,</span>&nbsp;_TCHAR<span class="hl_char">*</span>&nbsp;argv<span class="hl_char">[</span><span class="hl_char">]</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;WSADATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wsadata<span class="hl_comment">;   // Инициализация WinSock.</span></li><li class="hl_l0">&nbsp;&nbsp;SOCKET&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s<span class="hl_comment">;         // Cлущающий сокет.</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name<span class="hl_char">[</span><span class="hl_number">128</span><span class="hl_char">]</span><span class="hl_comment">; // Имя хоста (компьютера).</span></li><li class="hl_l0">&nbsp;&nbsp;HOSTENT<span class="hl_char">*</span>&nbsp;&nbsp;&nbsp;&nbsp;phe<span class="hl_comment">;       // Информация о хосте.</span></li><li class="hl_l1">&nbsp;&nbsp;SOCKADDR_IN&nbsp;sa<span class="hl_comment">;        // Адрес хоста</span></li><li class="hl_l0">&nbsp;&nbsp;IN_ADDR&nbsp;sa1<span class="hl_comment">;        //</span></li><li class="hl_l1">&nbsp;&nbsp;unsigned&nbsp;long&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;  // Флаг PROMISC Вкл/выкл.</span></li><li class="hl_l0"></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;инициализация</li><li class="hl_l0">&nbsp;&nbsp;WSAStartup<span class="hl_char">(</span>MAKEWORD<span class="hl_char">(</span><span class="hl_number">2</span><span class="hl_char">,</span><span class="hl_number">2</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>wsadata<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;s&nbsp;<span class="hl_char">=</span>&nbsp;socket<span class="hl_char">(</span>&nbsp;AF_INET<span class="hl_char">,</span>&nbsp;SOCK_RAW<span class="hl_char">,</span>&nbsp;IPPROTO_IP&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;gethostname<span class="hl_char">(</span>name<span class="hl_char">,</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>name<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;phe&nbsp;<span class="hl_char">=</span>&nbsp;gethostbyname<span class="hl_char">(</span>&nbsp;name&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ZeroMemory<span class="hl_char">(</span>&nbsp;<span class="hl_char">&amp;</span>sa<span class="hl_char">,</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>sa<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;sa<span class="hl_char">.</span>sin_family&nbsp;<span class="hl_char">=</span>&nbsp;AF_INET<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;sa<span class="hl_char">.</span>sin_addr<span class="hl_char">.</span>s_addr&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span>struct&nbsp;in_addr&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>phe<span class="hl_char">-</span><span class="hl_char">&gt;</span>h_addr_list<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>s_addr<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;bind<span class="hl_char">(</span>s<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span>SOCKADDR&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">&amp;</span>sa<span class="hl_char">,</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>SOCKADDR<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Включение&nbsp;promiscuous&nbsp;mode<span class="hl_char">.</span></li><li class="hl_l0">&nbsp;&nbsp;ioctlsocket<span class="hl_char">(</span>s<span class="hl_char">,</span>&nbsp;SIO_RCVALL<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>flag<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Бесконечный&nbsp;цикл&nbsp;приёма&nbsp;IP<span class="hl_char">-</span>пакетов<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function">while</span><span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span>_kbhit<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;count<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;<span class="hl_char">=</span>&nbsp;recv<span class="hl_char">(</span>&nbsp;s<span class="hl_char">,</span>&nbsp;Buffer<span class="hl_char">,</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>Buffer<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;обработка&nbsp;IP<span class="hl_char">-</span>пакета</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>&nbsp;count&nbsp;<span class="hl_char">&gt;</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>IPHeader<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPHeader<span class="hl_char">*</span>&nbsp;hdr&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>IPHeader&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>Buffer<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Начинаем&nbsp;разбор&nbsp;пакета<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Преобразуем&nbsp;в&nbsp;понятный&nbsp;вид&nbsp;адрес&nbsp;отправителя<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;From &quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sa1<span class="hl_char">.</span>s_addr&nbsp;<span class="hl_char">=</span>&nbsp;hdr<span class="hl_char">-</span><span class="hl_char">&gt;</span>iph_src<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span>inet_ntoa<span class="hl_char">(</span>sa1<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Преобразуем&nbsp;в&nbsp;понятный&nbsp;вид&nbsp;адрес&nbsp;получателя<span class="hl_char">.</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot; To &quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sa1<span class="hl_char">.</span>s_addr&nbsp;<span class="hl_char">=</span>&nbsp;hdr<span class="hl_char">-</span><span class="hl_char">&gt;</span>iph_dest<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span>inet_ntoa<span class="hl_char">(</span>sa1<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Вычисляем&nbsp;протокол<span class="hl_char">.</span>&nbsp;Полный&nbsp;список&nbsp;этих&nbsp;констант</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;содержится&nbsp;в&nbsp;файле&nbsp;winsock2<span class="hl_char">.</span>h</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot; Prot: &quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>hdr<span class="hl_char">-</span><span class="hl_char">&gt;</span>iph_protocol&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;IPPROTO_TCP<span class="hl_char">)</span>&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;TCP &quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>hdr<span class="hl_char">-</span><span class="hl_char">&gt;</span>iph_protocol&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;IPPROTO_UDP<span class="hl_char">)</span>&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;UDP &quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Вычисляем&nbsp;размер<span class="hl_char">.</span>&nbsp;Так&nbsp;как&nbsp;в&nbsp;сети&nbsp;принят&nbsp;прямой&nbsp;порядок</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;байтов<span class="hl_char">,</span>&nbsp;а&nbsp;не&nbsp;обратный<span class="hl_char">,</span>&nbsp;то&nbsp;прийдётся&nbsp;поменять&nbsp;байты&nbsp;местами<span class="hl_char">.</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lowbyte&nbsp;<span class="hl_char">=</span>&nbsp;hdr<span class="hl_char">-</span><span class="hl_char">&gt;</span>iph_length<span class="hl_char">&gt;</span><span class="hl_char">&gt;</span><span class="hl_number">8</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hibyte&nbsp;<span class="hl_char">=</span>&nbsp;hdr<span class="hl_char">-</span><span class="hl_char">&gt;</span>iph_length<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span><span class="hl_number">8</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hibyte&nbsp;<span class="hl_char">=</span>&nbsp;hibyte&nbsp;<span class="hl_char">+</span>&nbsp;lowbyte<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;Size: %d  TTL:%d\n&quot;</span><span class="hl_char">,</span>&nbsp;hibyte<span class="hl_char">,</span>hdr<span class="hl_char">-</span><span class="hl_char">&gt;</span>iph_ttl<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0"></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;}</li><li class="hl_l1"></li><li class="hl_l0">&nbsp;&nbsp;closesocket<span class="hl_char">(</span>&nbsp;s&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;WSACleanup<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;return&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0"></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202029&amp;user=4338&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=17" class="addthx" data-post="202029"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 сентября 2008 17:06 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12648.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>sss</b><br> Спасибо, нашёл, это была WSARecv, тему можно закрыть!
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202434&amp;user=6336&amp;forum_n=6&amp;topic=12648.html&amp;page=0&amp;anchor=18" class="addthx" data-post="202434"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Аналог recv</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=12648" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
