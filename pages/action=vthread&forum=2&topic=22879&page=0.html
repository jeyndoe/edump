<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>EnableMenuItem не срабатывает - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Имеется программа с ограничением функционала, которое проявляется в том, что при открытие меню некоторые пункты недоступны. Заинжектил в процесс свою dll, перехватываю EnableMenuItem, перебивая все пункты на MF_ENABLED, но в меню">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=50833'>vasilevradislav</a>, <a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a>, <a target='_blank' href='?action=userinfo&amp;user=42623'>site-pro</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> EnableMenuItem не срабатывает</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]GroundHog[/b]','')">GroundHog</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.2 (новичок), 16thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.78'>Активность: 0.02<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26517">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2014 10:10 &middot; Поправил: GroundHog <br><script type="text/javascript">QU('GroundHog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GroundHog" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22879.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Имеется программа с ограничением функционала, которое проявляется в том, что при открытие меню некоторые пункты недоступны. Заинжектил в процесс свою dll, перехватываю <b>EnableMenuItem</b>, перебивая все пункты на MF_ENABLED, но в меню это никак не отражается <img src="img/smilies/s9.gif" alt=""><br><br>Подумал было, что пункты меню OWNER_DRAW, пошёл дальше - перехватил оконную функцию появляющегося меню(точно узнал, что это нужное окно, меняя ему прозрачность) и случайно выяснил, что пункт становится доступным только, если НЕ вызывать дефолтную оконнную ф-ию, но при клике на пункт, он опять дизейблится. Получается, проверка в оконной функции? <br>Беда в том, что не могу определить её адрес, полученный через <b>GetWindowLong</b>:<br><br><i class=x>lpPrevWndFunc<br>[in] Pointer to the previous window procedure. If this value is obtained by calling the GetWindowLong function with the nIndex parameter set to GWL_WNDPROC or DWL_DLGPROC, it is actually either the address of a window or dialog box procedure, or a special internal value meaningful only to CallWindowProc</i><br><br>Видимо, это мой случай, т.к. <i class=x>pPrevWndFunc </i>принимает значение FFFFxxxx, что не может быть адресом.<br><br>Поэтому два вопроса:<br>1) Почему не принимаются изменения в меню после вызова EnableMenuItem?<br>2) Если проверка в оконной функции, то как найти её адрес?<br><br>P.S. Программа написана на mfc, импортирует mfc90u.dll, msvcp90.dll, msvcr90.dll. В самом exe нет даже прямых вызовов API для работы с меню.<br><br><b>Решил выложить таргет, т.к. что-то зашёл в тупик. Заранее признателен, если покажут, куда копать</b>:<br>http://rghost.net/56411166<br><br>После установки, создаете пустой проект или открываете одну из демок: <b>Файл-&gt;Экспорт/Печать</b> к примеру, задизейблены.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343266&amp;user=26517&amp;forum_n=2&amp;topic=22879.html&amp;page=0&amp;anchor=1" class="addthx" data-post="343266"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]unknownproject[/b]','')">unknownproject</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.1 (постоянный), 247thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.52'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=27422">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2014 10:16 &middot; Поправил: unknownproject <br><script type="text/javascript">QU('unknownproject','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unknownproject" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22879.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Это намного проще хекс редактором решить и проверить за одно,а реально ли вообще рабочие пункты меню.<br>Ищи caption в юникоде (знак <b>&amp;</b> укажет путь).<br>18 байтами ранее задаются свойста.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Например&nbsp;<span class="hl_number">01</span>&nbsp;<span class="hl_number">50</span><span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">01</span>&nbsp;<span class="hl_char">-</span>&nbsp;видимость<span class="hl_char">,</span>&nbsp;<span class="hl_number">50</span>&nbsp;<span class="hl_char">-</span>&nbsp;активность&nbsp;<span class="hl_char">(</span><span class="hl_number">58</span>&nbsp;сделает&nbsp;кнопку&nbsp;неактивной<span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br><img src="img/smilies/s2.gif" alt="">
<br><br><font size="1"><i>-----<br>TEST YOUR MIGHT</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=343267&amp;user=27422&amp;forum_n=2&amp;topic=22879.html&amp;page=0&amp;anchor=2" class="addthx" data-post="343267"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2014 10:26 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22879.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>GroundHog пишет:<br>Имеется программа с ограничением функционала </I><br>а линк на скачивание будет?<br><I>GroundHog пишет:<br>открытие меню некоторые пункты недоступны </I><br>Если ничем не упаковано -&gt; то в секции ресурсов меню есть?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343268&amp;user=26651&amp;forum_n=2&amp;topic=22879.html&amp;page=0&amp;anchor=3" class="addthx" data-post="343268"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]GroundHog[/b]','')">GroundHog</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.2 (новичок), 16thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.78'>Активность: 0.02<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26517">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2014 10:32 <br><script type="text/javascript">QU('GroundHog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GroundHog" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22879.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>а линк на скачивание будет?<br><br>Если ничем не упаковано -&gt; то в секции ресурсов меню есть?  </I><br>Программу не хочу светить по понятным соображениям, могу в PM скинуть. ResHacker показывает в ресурсах все пункты меню доступными.<br><br>Есть утилиты для включения в чужих программах кнопок, меню, etc. Так вот, в моем случае она тоже не срабатывает, хотя в блокноте все меня становятся доступны.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343269&amp;user=26517&amp;forum_n=2&amp;topic=22879.html&amp;page=0&amp;anchor=4" class="addthx" data-post="343269"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]kid[/b]','')">kid</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.2 (посетитель), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.46'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=27711">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2014 10:42 <br><script type="text/javascript">QU('kid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kid" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22879.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
ну раз не упаковано то :<br>1. ida<br>2. символы <br>3. CMenu::EnableMenuItem
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343270&amp;user=27711&amp;forum_n=2&amp;topic=22879.html&amp;page=0&amp;anchor=5" class="addthx" data-post="343270"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]GroundHog[/b]','')">GroundHog</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.2 (новичок), 16thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.78'>Активность: 0.02<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26517">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2014 11:31 <br><script type="text/javascript">QU('GroundHog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GroundHog" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22879.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>kid пишет:<br>2. символы  </I><br>Не смотря на наличие в %WINDIR%\symbols\dll\mfc90u.i386.pdb  IDA показывает вызовы только в виде:<br>jmp     ds:__imp_mfc90u_11735
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343274&amp;user=26517&amp;forum_n=2&amp;topic=22879.html&amp;page=0&amp;anchor=6" class="addthx" data-post="343274"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Hellrider[/b]','')">Hellrider</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.6 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.43'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36776">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2014 15:57 <br><script type="text/javascript">QU('Hellrider','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellrider" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22879.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Я видел программу (демо версию) где тоже они не были доступны. Так там мало того, был еще и код вырезан. Размер EXE отличался в 3 раза от покупной. Как бы не оказалось что пункт меню ты разблокируешь, а там ничего
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343285&amp;user=36776&amp;forum_n=2&amp;topic=22879.html&amp;page=0&amp;anchor=7" class="addthx" data-post="343285"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=23175" title="13-06-2014 23:04, ранг:25.3" target="_blank">ThugboyZ</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]hlmadip[/b]','')">hlmadip</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.01'>Активность: 0.06<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=21572">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2014 16:38 <br><script type="text/javascript">QU('hlmadip','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hlmadip" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22879.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>GroundHog</b> Скинь в ЛС
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343287&amp;user=21572&amp;forum_n=2&amp;topic=22879.html&amp;page=0&amp;anchor=8" class="addthx" data-post="343287"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]GroundHog[/b]','')">GroundHog</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.2 (новичок), 16thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.78'>Активность: 0.02<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26517">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2014 17:26 <br><script type="text/javascript">QU('GroundHog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GroundHog" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22879.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Выложил таргет, прошу подсказки.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343383&amp;user=26517&amp;forum_n=2&amp;topic=22879.html&amp;page=0&amp;anchor=9" class="addthx" data-post="343383"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2014 18:19 &middot; Поправил: Vovan666 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22879.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>GroundHog пишет:<br>После установки, создаете пустой проект или открываете одну из демок: Файл-&gt;Экспорт/Печать к примеру, задизейблены.  </I><br>печать походу енаблится тут 00449C30 (или тут 00417CD0), только непонятно откуда эта процедура вызывается,  а вообще нужно копать в сторону comcat.dll все проверки на зарегистрированность там.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343387&amp;user=5291&amp;forum_n=2&amp;topic=22879.html&amp;page=0&amp;anchor=10" class="addthx" data-post="343387"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2014 07:40 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22879.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
если я правильно понял, ему драйвер нужен <b>&#92;.\NVKEYNT</b> (из комката вызывается), который потом <b>ReadFile</b> и наверно еще <b>DeviceIoControl</b>. у меня, в каком-то потоке, на 2к3 необработанный эксепшн вываливается по записи в несуществующий адрес памяти и прога завершается
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343393&amp;user=26651&amp;forum_n=2&amp;topic=22879.html&amp;page=0&amp;anchor=11" class="addthx" data-post="343393"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]GroundHog[/b]','')">GroundHog</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.2 (новичок), 16thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.78'>Активность: 0.02<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26517">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2014 07:53 &middot; Поправил: GroundHog <br><script type="text/javascript">QU('GroundHog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GroundHog" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22879.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>Vovan666 пишет:<br>печать походу енаблится тут 00449C30 (или тут 00417CD0) </I><br>В эти адреса у меня вообще программа не попадает, не понятно, какие параметры передаваит, и там, судя по коду шлётся WM_COMMAND, который должен отсылаться уже при выборе пункта меню:<br><i class=x>The WM_COMMAND message is sent when the user selects a command item from a menu, when a control sends a notification message to its parent window, or when an accelerator keystroke is translated.</i><br>comcat.dll - это какой COM-объект что ли, пока не могу найти, за что там зацепиться.<br><br><br><I>ELF_7719116 пишет:<br>если я правильно понял, ему драйвер нужен \.\NVKEYNT (из комката вызывается) </I><br>В полнофункциональной версии используется ключ Guardant, которого у меня нет. На XP демка без драйвера нормально запускается. Вообще, все ограничения демки основаны на том, что при различных условиях лочатся пункты меню, а необходимый функционал в exe имеется, поэтому я и хотел пойти по пути наименьшего сопротивления.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343394&amp;user=26517&amp;forum_n=2&amp;topic=22879.html&amp;page=0&amp;anchor=12" class="addthx" data-post="343394"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2014 18:54 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22879.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
По каким-то неведомым причинам, у меня секция <i class=x>.comcat</i> (что в комкат.dll)без execute - из-за чего фолт выплевывается. там поток создается, который переодически(через sleep 13257 ms) опрашивает ключ.<br><br>возможно это только домыслы (с гуардантом не знаком), что из физического ключа извлекаются  цифровой ключик, которым нужно расшифровать оставшийся кусок функции в комкат.длл, которая наверно и разлочит все:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00C75180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EBP</span></li><li class="hl_l1"><span class="hl_number">00C75181</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8BEC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EBP</span><span class="hl_char">,</span><span class="hl_registr">ESP</span></li><li class="hl_l0"><span class="hl_number">00C75183</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">83EC</span>&nbsp;<span class="hl_number">08</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>SUB</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">8</span></li><li class="hl_l1"><span class="hl_number">00C75186</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B45</span>&nbsp;<span class="hl_number">08</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00C75189</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8945</span>&nbsp;FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00C7518C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_number">00C7518E</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B4D</span>&nbsp;FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00C75191</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B11</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ECX</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00C75193</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B4D</span>&nbsp;FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00C75196</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B42</span>&nbsp;<span class="hl_number">0C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDX</span><span class="hl_char">+</span><span class="hl_number">0C</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00C75199</span>&nbsp;&nbsp;&nbsp;&nbsp;FFD0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00C7519B</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0FB6C8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_registr">AL</span></li><li class="hl_l0"><span class="hl_number">00C7519E</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">85C9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_registr">ECX</span></li><li class="hl_l1"><span class="hl_number">00C751A0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">74</span>&nbsp;<span class="hl_number">3E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">00C751E0</span></li><li class="hl_l0"><span class="hl_number">00C751A2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B55</span>&nbsp;FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00C751A5</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B02</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDX</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00C751A7</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B4D</span>&nbsp;FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00C751AA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B50</span>&nbsp;<span class="hl_number">08</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00C751AD</span>&nbsp;&nbsp;&nbsp;&nbsp;FFD2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_registr">EDX</span></li><li class="hl_l1"><span class="hl_number">00C751AF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6299</span>&nbsp;<span class="hl_number">07E5AA0B</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>BOUND</b></span>&nbsp;<span class="hl_registr">EBX</span><span class="hl_char">,</span>QWORD&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ECX</span><span class="hl_char">+</span><span class="hl_number">0BAAE507</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;ОТСЮДА&nbsp;ПОШЕЛ&nbsp;ЗАШИФРОВАННЫЙ&nbsp;КОД&nbsp;<span class="hl_char">!</span></li><li class="hl_l0"><span class="hl_number">00C751B5</span>&nbsp;&nbsp;&nbsp;&nbsp;BB&nbsp;E7F8186A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EBX</span><span class="hl_char">,</span><span class="hl_number">6A18F8E7</span></li><li class="hl_l1"><span class="hl_number">00C751BA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">1F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr"><b>DS</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; Modification of segment register</span></li><li class="hl_l0"><span class="hl_number">00C751BB</span>&nbsp;&nbsp;^&nbsp;<span class="hl_number">7D</span>&nbsp;E2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JGE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">00C7519F</span></li><li class="hl_l1"><span class="hl_number">00C751BD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>INC</b></span>&nbsp;<span class="hl_registr">EBP</span></li><li class="hl_l0"><span class="hl_number">00C751BE</span>&nbsp;&nbsp;&nbsp;&nbsp;E1&nbsp;<span class="hl_number">2E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LOOPZ</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">00C751EE</span></li><li class="hl_l1"><span class="hl_number">00C751C0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">05</span>&nbsp;<span class="hl_number">9C766C45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">456C769C</span></li><li class="hl_l0"><span class="hl_number">00C751C5</span>&nbsp;&nbsp;&nbsp;&nbsp;A1&nbsp;<span class="hl_number">4EA3E226</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">26E2A34E</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00C751CA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">NOP</span></li><li class="hl_l0"><span class="hl_number">00C751CB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">5178DF1F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">1FDF7851</span></li><li class="hl_l1"><span class="hl_number">00C751D0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0C</span>&nbsp;EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>OR</b></span>&nbsp;<span class="hl_registr">AL</span><span class="hl_char">,</span>EC</li><li class="hl_l0"><span class="hl_number">00C751D2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INS&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">ES</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr"><b>DX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; I/O command</span></li><li class="hl_l1"><span class="hl_number">00C751D3</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">36</span><span class="hl_char">:</span><span class="hl_number">1F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr"><b>DS</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; Superfluous segment override prefix</span></li><li class="hl_l0"><span class="hl_number">00C751D5</span>&nbsp;&nbsp;&nbsp;&nbsp;D1D4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RCL</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">1</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; Suspicious use of stack pointer</span></li><li class="hl_l1"><span class="hl_number">00C751D7</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DB</b></span>&nbsp;<span class="hl_number">0F</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; Unknown command</span></li><li class="hl_l0"><span class="hl_number">00C751D8</span>&nbsp;&nbsp;&nbsp;&nbsp;B8&nbsp;<span class="hl_number">41C66DAB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span>AB6DC641</li><li class="hl_l1"><span class="hl_number">00C751DD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">00A0</span>&nbsp;B5A04CF6&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">+</span>F64CA0B5<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">AH</span></li><li class="hl_l0"><span class="hl_number">00C751E3</span>&nbsp;&nbsp;&nbsp;&nbsp;CA&nbsp;D452&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RETF</b></span>&nbsp;<span class="hl_number">52D4</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; Far jump or call</span></li><li class="hl_l1"><span class="hl_number">00C751E6</span>&nbsp;&nbsp;&nbsp;&nbsp;AB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STOS</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">ES</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00C751E7</span>&nbsp;&nbsp;^&nbsp;<span class="hl_number">78</span>&nbsp;<span class="hl_number">84</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JS</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">00C7516D</span></li><li class="hl_l1"><span class="hl_number">00C751E9</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">9D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">POPFD</span></li><li class="hl_l0"><span class="hl_number">00C751EA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">96</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XCHG</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_number">00C751EB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8CAD</span>&nbsp;<span class="hl_number">3E6CE909</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">+</span><span class="hl_number">9E96C3E</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">GS</span></li><li class="hl_l0"><span class="hl_number">00C751F1</span>&nbsp;&nbsp;&nbsp;&nbsp;F9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">STC</span></li><li class="hl_l1"><span class="hl_number">00C751F2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">76</span>&nbsp;<span class="hl_number">73</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JBE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">00C75267</span></li><li class="hl_l0"><span class="hl_number">00C751F4</span>&nbsp;&nbsp;&nbsp;&nbsp;DF7E&nbsp;<span class="hl_number">1A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>FISTP</b></span>&nbsp;QWORD&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESI</span><span class="hl_char">+</span><span class="hl_number">1A</span><span class="hl_char">]</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; FLOAT 0.0</span></li><li class="hl_l1"><span class="hl_number">00C751F7</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">5D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EBP</span></li><li class="hl_l0"><span class="hl_number">00C751F8</span>&nbsp;&nbsp;&nbsp;&nbsp;E4&nbsp;CA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;<span class="hl_registr">AL</span><span class="hl_char">,</span><span class="hl_number">0CA</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; I/O command</span></li><li class="hl_l1"><span class="hl_number">00C751FA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">87DC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XCHG</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">00C751FC</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00C751FD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">57</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l0"><span class="hl_number">00C751FE</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">5A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EDX</span></li><li class="hl_l1"><span class="hl_number">00C751FF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">SS</span></li><li class="hl_l0"><span class="hl_number">00C75200</span>&nbsp;&nbsp;&nbsp;&nbsp;A9&nbsp;<span class="hl_number">18101F17</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">171F1018</span></li><li class="hl_l1"><span class="hl_number">00C75205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EDX</span></li><li class="hl_l0"><span class="hl_number">00C75206</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">20548F</span>&nbsp;<span class="hl_number">3E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>AND</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ECX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">+</span><span class="hl_registr">EDI</span><span class="hl_char">+</span><span class="hl_number">3E</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">DL</span></li><li class="hl_l1"><span class="hl_number">00C7520A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">85D3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">EBX</span><span class="hl_char">,</span><span class="hl_registr">EDX</span></li><li class="hl_l0"><span class="hl_number">00C7520C</span>&nbsp;&nbsp;&nbsp;&nbsp;A2&nbsp;B7A73278&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">7832A7B7</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">AL</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0">&nbsp;</li>        </ol>
    </div>
</div></div>
<I>GroundHog пишет:<br>ResHacker показывает в ресурсах все пункты меню доступными. </I><br>вот это странно, когда и где программа тогда их дисейблит<br><br>(info) в реестре сидит: HKEY_CURRENT_USER\Software\Complex A5 <br>может это неважно, но еще по смещению <i class=x>+0xC120</i> процедура какой-то номер извлекает(если не давать переходить на CxxThrowException), вызывается из ексешника отсюда:
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0047D2AA</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">0047D2AB</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B0A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDX</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">0047D2AD</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;FFD1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_registr">ECX</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=343411&amp;user=26651&amp;forum_n=2&amp;topic=22879.html&amp;page=0&amp;anchor=13" class="addthx" data-post="343411"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]GroundHog[/b]','')">GroundHog</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.2 (новичок), 16thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.78'>Активность: 0.02<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26517">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2014 10:49 <br><script type="text/javascript">QU('GroundHog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GroundHog" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22879.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>ELF_7719116</b><br>Манипуляции с секцией .comcat я видел, доступа к ключу всё равно нет. Хотел зайти всё же со стороны дизейблинга пунктов меню. Кажется, в демке есть весь нужный функционал, но он блочится путем дизейблинга пунктов при определенных условиях, например:<br>- Если создать свой проект, то Файл-&gt;Сохранить(как) доступен)<br>- Если открыть демо-файл, то нет.<br><br>В момент открытия меню происходит вызов EnableMenuItem для каждого пункта с соответстсвующей маской. Я хукаю этот момент и перебиваю маску на enabled, но один фиг пункты не доступны. Не могу понять, как программа это делает. Единственная версия - оконная процедура, но не могу её найти(в первом сообщении писал почему) и тогда не ясно, через какое API пункты дизейблятся снова.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343427&amp;user=26517&amp;forum_n=2&amp;topic=22879.html&amp;page=0&amp;anchor=14" class="addthx" data-post="343427"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2014 21:11 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22879.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
apfnDispatch. Google.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343478&amp;user=33727&amp;forum_n=2&amp;topic=22879.html&amp;page=0&amp;anchor=15" class="addthx" data-post="343478"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> EnableMenuItem не срабатывает</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#16" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="2">
<input type="hidden" name="topic" value="22879">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22879" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
