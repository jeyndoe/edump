<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите определить виртуальную машину из MapEdit (с Geopainting.com) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Итак, есть программа MapEdit для работы с картами. http://geopainting.com/download/mapedit2-0-77-1.zip Я хочу разобраться, как она делает некоторые вещи, но нужные мне участки кода исполняются на виртуальной машине. Для примера">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите определить виртуальную машину из MapEdit (с Geopainting.com)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]pinky_p[/b]','')">pinky_p</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.8'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=35836">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2013 20:08 &middot; Поправил: pinky_p <br><script type="text/javascript">QU('pinky_p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pinky_p" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Итак, есть программа MapEdit  для работы с картами. <br>http://geopainting.com/download/mapedit2-0-77-1.zip<br><br>Я хочу разобраться, как она делает некоторые вещи, но нужные мне участки кода исполняются на виртуальной машине.<br><br>Для примера рассмотрим функцию <b>some_gui_func()</b>. Она вызывает функцию <b>VM_ENTER()</b>, и опкоды, идущие после вызова (начиная с адреса <b>some_gui_func_VM_ENTER</b>), исполняются на виртуальной машине. Оригинальные опкоды перезаписаны мусором, а исполняемые виртуализированные опкоды загружаются из ресурсов EXE (<b>LoadResource(GetModuleHandle(0), 1, 0x0A)</b>) функцией <b>VM_LoadOpcodes()</b>.<br><br><b>VM_ENTER()</b> сохраняет значения регистров и передает управление <b>VM_ENTER_GATE()</b>, которая вызывает <b>VM_RUN()</b>, которая и исполняет виртуализированные опкоды. Я почти полностью дизассемблировал <b>VM_RUN()</b>, это не сложно. Проблема в том, что <b>VM_RUN()</b> может вызывать дополнительные функции в зависимости от опкода и их довольно много. <br><br>Первые два виртуализированных опкода <b>some_gui_func()</b> в запакованном виде в ресурсах EXE выглядят так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">seg000<span class="hl_char">:</span><span class="hl_number">0000014C</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">80000402h</span></li><li class="hl_l1">seg000<span class="hl_char">:</span><span class="hl_number">00000150</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">0FFBF1913h</span></li><li class="hl_l0">seg000<span class="hl_char">:</span><span class="hl_number">00000154</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">80000402h</span></li><li class="hl_l1">seg000<span class="hl_char">:</span><span class="hl_number">00000158</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">0FFBF1917h</span></li>        </ol>
    </div>
</div></div>
<br><br>Они же в распакованном виде при исполнении:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">debug023<span class="hl_char">:</span><span class="hl_number">00977DF8</span>&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">80000402h</span></li><li class="hl_l1">debug023<span class="hl_char">:</span><span class="hl_number">00977DFC</span>&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">40E6EDh</span></li><li class="hl_l0">debug023<span class="hl_char">:</span><span class="hl_number">00977E00</span>&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">85DEF4h</span></li><li class="hl_l1">debug023<span class="hl_char">:</span><span class="hl_number">00977E04</span>&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">0FFFFFFFFh</span></li><li class="hl_l0">debug023<span class="hl_char">:</span><span class="hl_number">00977E08</span>&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">80000402h</span></li><li class="hl_l1">debug023<span class="hl_char">:</span><span class="hl_number">00977E0C</span>&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">40E6E9h</span></li><li class="hl_l0">debug023<span class="hl_char">:</span><span class="hl_number">00977E10</span>&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">85DEF4h</span></li><li class="hl_l1">debug023<span class="hl_char">:</span><span class="hl_number">00977E14</span>&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">0FFFFFFFFh</span></li>        </ol>
    </div>
</div></div>
<br><br>Адрес очередного опкода находится в регистре EDI при исполнении метки <b>next_opcode</b> внутри <b>VM_RUN()</b>.<br><br>Нужные адреса внутри <b>mapedit.exe</b>:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">0x00668574&nbsp;&nbsp;&nbsp;&nbsp;VM_ENTER</li><li class="hl_l1">0x006685C9&nbsp;&nbsp;&nbsp;&nbsp;VM_ENTER_GATE</li><li class="hl_l0">0x0066A6D7&nbsp;&nbsp;&nbsp;&nbsp;VM_RUN</li><li class="hl_l1">0x0066A768&nbsp;&nbsp;&nbsp;&nbsp;next_opcode</li><li class="hl_l0">0x006681F5&nbsp;&nbsp;&nbsp;&nbsp;VM_LoadOpcodes</li><li class="hl_l1">0x0040E404&nbsp;&nbsp;&nbsp;&nbsp;some_gui_func</li><li class="hl_l0">0x0040E6E3&nbsp;&nbsp;&nbsp;&nbsp;some_gui_func_VM_ENTER</li>        </ol>
    </div>
</div></div>
<br>Также приаттачен IDC-скрипт для добавления имен в базу.<br><br>Может быть кто-то знает, что это за виртуальная машина и имеет дизассемблер для нее? Очень надеюсь сэкономить себе кучу времени.<br><br><b>Дополнительное обсуждение защиты программы:</b><br><noindex><a href="https://ssl.exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22223" rel="nofollow" target="_blank">Как обойти проверку целостности кода в секции</a></noindex><br><br><img src="img/attach.gif" alt=""> <a href="./files/7c43_22.09.2013_EXELAB.rU.tgz">7c43_22.09.2013_EXELAB.rU.tgz</a> - names.idc
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331230&amp;user=35836&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=1" class="addthx" data-post="331230"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2013 21:16 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
вообще то как то так<br><br>.text:0066A488     _CALL_VM_sub_66A488<br>.text:0066A588     _LEAVE_VM_sub_66A588<br><br>и вообще они там не один если судить по рефам на<br>.data:007D77C8     _VM_crit_stru_7D77C8<br><br>.data:0078F86C     off_78F86C      dd offset sub_668647<br>похоже на сами обработчики опкодов вм<br><br>еще там подозрительный аллокатор new и delete<br>.text:0040327D     _new_sub_40327D<br>там на маленькие куски до 128 байт, по другому срабатывает<br>лень думать, но как быоно не на саму ВМ работало, да еще и может свою адрессацию,<br>а может все таки просто соптимизировано для опкодов, что бы ускорить скорость самой вм<br><br>дальше интерес пропал <img src="img/smilies/s5.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331239&amp;user=15381&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=2" class="addthx" data-post="331239"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]pinky_p[/b]','')">pinky_p</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.8'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=35836">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2013 21:38 <br><script type="text/javascript">QU('pinky_p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pinky_p" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>reversecode пишет:<br>.text:0066A488 _CALL_VM_sub_66A488<br>.text:0066A588 _LEAVE_VM_sub_66A588<br> </I><br><br>Эти функции - это на самом деле одна функция. Это один из обработчиков опкодов (а именно - CALL), которые вызывает VM_RUN. То есть, VM_RUN формирует указатель на операнд1, операнд2 и передает это в доп обработчик.<br><br><I>reversecode пишет:<br>data:0078F86C off_78F86C dd offset sub_668647<br>похоже на сами обработчики опкодов вм </I><br>Все верно, только это не сами обработчики, а аллокаторы объектов обработчиков.<br><br>Короче, эта VM исполняет те же x86 опкоды, записанные в другой форме. И я надеюсь, что кто-то ее знает и имеет дизассемблер.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331240&amp;user=35836&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=3" class="addthx" data-post="331240"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2013 21:44 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>pinky_p пишет:<br>Эти функции - это на самом деле одна функция. </I><br>это и так понятно) рад что вы тоже это видите<br><br><I>pinky_p пишет:<br>Все верно, только это не сами обработчики, а аллокаторы объектов обработчиков. </I><br>это сами обработчики<br>только опкоды написаны на с++, и для вас это аллокаторы<br>для меня это обработчики<br>потому что это таблица соответствий<br><br><I>pinky_p пишет:<br>И я надеюсь, что кто-то ее знает и имеет дизассемблер.  </I><br>глупая затея ждать что кто то даже если имеет то поделится)<br>реверсите сами каждый обработчик
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331241&amp;user=15381&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=4" class="addthx" data-post="331241"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 октября 2013 19:09 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Разбудили вы мой интерес к этой программе. ВМ действительно не сложная, обработчики КОПов даже без обфускации. Но все это сделано специально для этой программы! Автор постарался, даже FPU не поленился добавить. Хотя вот логику ту же можно было в NAND или NOR разложить.<br><br>Пока сложно догонять, что делают вот такие хендлеры:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00669B1B</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span>arg_4<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00669B1F</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">3</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00669B23</span>&nbsp;<span class="hl_function"><b>retn</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0Ch</span></li>        </ol>
    </div>
</div></div>
<br><br><b>Добавлено спустя 9 часов 43 минуты</b><br><b>pinky_p</b><br>На данный момент у меня такая таблица. Не совпадения/дополнения есть?<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB64</span>&nbsp;off_6EDB64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668647+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB64</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; 02A12BA0o</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB68</span>&nbsp;off_6EDB68&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_mov_i32&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668692+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB68</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; 02A12BB8o</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB6C</span>&nbsp;off_6EDB6C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_push&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6686B5+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB6C</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; 02A12BD0o</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB70</span>&nbsp;off_6EDB70&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_pop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66871C+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB70</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; 02A1FF78o</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB74</span>&nbsp;off_6EDB74&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_xchg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668774+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB78</span>&nbsp;off_6EDB78&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_movzx_eax_ax_al&nbsp;<span class="hl_comment">; DATA XREF: sub_6687D1+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB7C</span>&nbsp;off_6EDB7C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_cwd_cdq&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668826+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB80</span>&nbsp;off_6EDB80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_mov_i8_i16&nbsp;<span class="hl_comment">; DATA XREF: sub_668881+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB84</span>&nbsp;off_6EDB84&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_mov_i8_i16&nbsp;<span class="hl_comment">; DATA XREF: sub_6688BA+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB88</span>&nbsp;off_6EDB88&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;sub_6688E6&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6688D0+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB8C</span>&nbsp;off_6EDB8C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_add&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668903+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB90</span>&nbsp;off_6EDB90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_adc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6689A4+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB94</span>&nbsp;off_6EDB94&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_sub&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668A67+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB98</span>&nbsp;off_6EDB98&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_sbb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668B08+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB9C</span>&nbsp;off_6EDB9C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_inc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668BCE+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBA0</span>&nbsp;off_6EDBA0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_dec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668C2B+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBA4</span>&nbsp;off_6EDBA4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_mul&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668C89+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBA8</span>&nbsp;off_6EDBA8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_imul&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668D70+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBAC</span>&nbsp;off_6EDBAC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;sub_668E80&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668E6A+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBB0</span>&nbsp;off_6EDBB0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_div&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668F01+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBB4</span>&nbsp;off_6EDBB4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_idiv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668FD4+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBB8</span>&nbsp;off_6EDBB8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_shl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6690A3+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBBC</span>&nbsp;off_6EDBBC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_shr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669185+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBC0</span>&nbsp;off_6EDBC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_sar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66925C+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBC4</span>&nbsp;off_6EDBC4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_or&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6692CB+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBC8</span>&nbsp;off_6EDBC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_and&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669339+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBCC</span>&nbsp;off_6EDBCC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_xor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6693A7+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBD0</span>&nbsp;off_6EDBD0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_not&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669415+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBD4</span>&nbsp;off_6EDBD4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_neg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66945B+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBD8</span>&nbsp;off_6EDBD8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_cmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6694C7+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBDC</span>&nbsp;off_6EDBDC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_test&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669550+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBE0</span>&nbsp;off_6EDBE0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_call_x86_func&nbsp;<span class="hl_comment">; DATA XREF: sub_6695B9+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBE4</span>&nbsp;off_6EDBE4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_exit_vm&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6695E3+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBE8</span>&nbsp;off_6EDBE8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;sub_66963B&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669625+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBEC</span>&nbsp;off_6EDBEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;sub_669665&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66964F+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBF0</span>&nbsp;off_6EDBF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;sub_66968F&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669679+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBF4</span>&nbsp;off_6EDBF4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;sub_6696E1&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6696CB+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBF8</span>&nbsp;off_6EDBF8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;sub_669711&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6696FB+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBFC</span>&nbsp;off_6EDBFC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;sub_669740&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66972A+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC00</span>&nbsp;off_6EDC00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;sub_66977A&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669764+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC04</span>&nbsp;off_6EDC04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_leave&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66979E+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC08</span>&nbsp;off_6EDC08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_debug&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6697CA+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC0C</span>&nbsp;off_6EDC0C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;sub_6697FF&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6697E9+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC10</span>&nbsp;off_6EDC10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_setc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66983A+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC14</span>&nbsp;off_6EDC14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_setnc&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66985B+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC18</span>&nbsp;off_6EDC18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_cmc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66987C+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC1C</span>&nbsp;off_6EDC1C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_bt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6698A3+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC20</span>&nbsp;off_6EDC20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_bts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6698EC+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC24</span>&nbsp;off_6EDC24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_btr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669946+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC28</span>&nbsp;off_6EDC28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_btc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6699A4+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC2C</span>&nbsp;off_6EDC2C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_bsf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669A13+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC30</span>&nbsp;off_6EDC30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_bsr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669A7B+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC34</span>&nbsp;off_6EDC34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_cld&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669AE4+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC38</span>&nbsp;off_6EDC38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_std&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669B05+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC3C</span>&nbsp;off_6EDC3C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_stos_rep&nbsp;<span class="hl_comment">; DATA XREF: sub_669B26+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC40</span>&nbsp;off_6EDC40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_lods_rep&nbsp;<span class="hl_comment">; DATA XREF: sub_669BC1+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC44</span>&nbsp;off_6EDC44&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_movs_rep&nbsp;<span class="hl_comment">; DATA XREF: sub_669C5F+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC48</span>&nbsp;off_6EDC48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_scas_rep&nbsp;<span class="hl_comment">; DATA XREF: sub_669CE1+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC4C</span>&nbsp;off_6EDC4C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_cmps_rep&nbsp;<span class="hl_comment">; DATA XREF: sub_669DD8+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC50</span>&nbsp;off_6EDC50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fld_qword&nbsp;<span class="hl_comment">; DATA XREF: sub_669ECA+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC54</span>&nbsp;off_6EDC54&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fld_dword&nbsp;<span class="hl_comment">; DATA XREF: sub_669EF4+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC58</span>&nbsp;off_6EDC58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fstp_qword&nbsp;<span class="hl_comment">; DATA XREF: sub_669F1E+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC5C</span>&nbsp;off_6EDC5C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fstp_dword&nbsp;<span class="hl_comment">; DATA XREF: sub_669F46+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC60</span>&nbsp;off_6EDC60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fst_qword&nbsp;<span class="hl_comment">; DATA XREF: sub_669F6E+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC64</span>&nbsp;off_6EDC64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fst_dword&nbsp;<span class="hl_comment">; DATA XREF: sub_669F96+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC68</span>&nbsp;off_6EDC68&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fcomp_qword&nbsp;<span class="hl_comment">; DATA XREF: sub_669FBE+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC6C</span>&nbsp;off_6EDC6C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fcomp_dword&nbsp;<span class="hl_comment">; DATA XREF: sub_669FE6+Co</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=331759&amp;user=2449&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=5" class="addthx" data-post="331759"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=35836" title="03-10-2013 08:04, ранг:0.4" target="_blank">pinky_p</a>, <a href="action=userinfo&user=30846" title="04-10-2013 06:01, ранг:-0.1" target="_blank">RebelNeo</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]pinky_p[/b]','')">pinky_p</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.8'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=35836">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 12:04 <br><script type="text/javascript">QU('pinky_p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pinky_p" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>int</b><br>Блин, ну вы просто монстр <img src="img/smilies/s1.gif" alt=""> <br>У меня сейчас очень мало времени, поэтому я определил hand_call_x86_func и на том забил.<br>Еще добавлю, что sub_66A37E - это джамп, условный или безусловный (условие проверяется в VM_RUN), причем оно может прыгать за пределы VM (??).<br>sub_66AC5D вычисляет адрес виртуализированной инструкции, куда прыгать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331768&amp;user=35836&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=6" class="addthx" data-post="331768"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 14:12 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
ломать лень) разбирать удовольствие<br><noindex><a href="http://pastebin.com/iAMNLHDS" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex> дарю)<br>ну итд, все не стал постить
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331769&amp;user=15381&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=7" class="addthx" data-post="331769"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 15:23 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>pinky_p пишет:<br>Блин, ну вы просто монстр </I><br>Да ладно, после вмпрота и обсида это цветочки. Посмотрел куда сохраняются регистры, проследил куда они копируются. Дальше понятно - смотрим какие параметры попадают в обработчики. Создал три структуры под классы которые всем заправляют. Дальше декомпилятор сам показывает код обработчиков<br><br><I>int пишет:<br>Пока сложно догонять, что делают вот такие хендлеры: </I><br>Вот этот обработчик для примера оказался std. А вот как сейчас выглядит код в IDA:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00669B1B</span>&nbsp;<span class="hl_comment">; void __stdcall hand_std(int, vm_object_s *vm_object, int)</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00669B1B</span>&nbsp;hand_std&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: .rdata:off_6EDC38o</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00669B1B</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00669B1B</span>&nbsp;arg_0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">4</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00669B1B</span>&nbsp;vm_object&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">8</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00669B1B</span>&nbsp;arg_8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">0Ch</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00669B1B</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00669B1B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span>vm_object<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00669B1F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span>vm_object_s<span class="hl_char">.</span>flags<span class="hl_char">.</span>DF_flag<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00669B23</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>retn</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0Ch</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00669B23</span>&nbsp;hand_std&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">endp</span></li>        </ol>
    </div>
</div></div>
<br>А вот так в лучах:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;__stdcall&nbsp;hand_std<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;a1<span class="hl_char">,</span>&nbsp;vm_object_s&nbsp;<span class="hl_char">*</span>vm_object<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;a3<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;vm_object<span class="hl_char">-</span><span class="hl_char">&gt;</span>flags<span class="hl_char">.</span>DF_flag&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div>
<br>Тут даже думать не надо, о том, что это за обработчик. Сразу видно. Взяли объект класса vm_object, у него в начале переменные типа char с флагами (туда memcpy копирует их - легко проследить). По смещению понятно, что это флаг DF, IDA сама его предлагает в пункте контекстного меню &quot;Structure offset&quot;. Ну а дальше справочник по x86 командам - это std (хотя данная инструкция очень популярная, ее и так запомнить не сложно, а вот всякие бит тесты типа bsr, bsf, bts - это не упомнишь, я гуглил их описания).<br><br>Поэтому ничего монстерского тут нет. Я вот переходы еще пока не разобрал, VM_x_FLAG_cmp_sub_66A238 очень не хватало) Терпеть не могу флаги разбирать и условные переходы.<br><br><I>pinky_p пишет:<br>sub_66A37E - это джамп, условный или безусловный </I><br>На этом я стормозил, меня vm_exit (0x66A3D3) испугал в теле этой функции.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331771&amp;user=2449&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=8" class="addthx" data-post="331771"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]SaNX[/b]','')">SaNX</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 456.3 (мудрец), 340thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.03'>Активность: 0.28<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=2108">Участник</a><br><font color=blue>Android Reverser</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 15:34 <br><script type="text/javascript">QU('SaNX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SaNX" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Интег взялся за ВМ - Галичский волосы на жопе рвет <img src="img/smilies/s5.gif" alt="">
<br><br><font size="1"><i>-----<br>SaNX</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=331772&amp;user=2108&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=9" class="addthx" data-post="331772"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]RebelNeo[/b]','')">RebelNeo</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.61'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=30846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 16:23 &middot; Поправил: RebelNeo <br><script type="text/javascript">QU('RebelNeo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=RebelNeo" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Параллельный топик <noindex><a href="http://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=22223" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>закрыт по просьбам <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331775&amp;user=30846&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=10" class="addthx" data-post="331775"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 16:53 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>reversecode пишет:<br>VM_x_FLAGS_sub_66A212</I><br>Я назвал set_flags_ZSP. ZSP подчеркивает, что другие флаги метод не трогает. Почти все обработчики распознаны (не без вашей помощи <img src="img/smilies/s3.gif" alt=""> ):<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB64</span>&nbsp;off_6EDB64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668647+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB64</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; 02A12BA0o</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB68</span>&nbsp;off_6EDB68&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_mov_i32&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668692+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB68</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; 02A12BB8o</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB6C</span>&nbsp;off_6EDB6C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_push&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6686B5+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB6C</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; 02A12BD0o</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB70</span>&nbsp;off_6EDB70&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_pop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66871C+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB70</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; 02A1FF78o</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB74</span>&nbsp;off_6EDB74&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_xchg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668774+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB78</span>&nbsp;off_6EDB78&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_movzx_eax_ax_al&nbsp;<span class="hl_comment">; DATA XREF: sub_6687D1+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB7C</span>&nbsp;off_6EDB7C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_cwd_cdq&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668826+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB80</span>&nbsp;off_6EDB80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_mov_i8_i16&nbsp;<span class="hl_comment">; DATA XREF: sub_668881+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB84</span>&nbsp;off_6EDB84&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_mov_i8_i16&nbsp;<span class="hl_comment">; DATA XREF: sub_6688BA+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB88</span>&nbsp;off_6EDB88&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_mov_base_offset&nbsp;<span class="hl_comment">; DATA XREF: sub_6688D0+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB8C</span>&nbsp;off_6EDB8C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_add&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668903+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB90</span>&nbsp;off_6EDB90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_adc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6689A4+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB94</span>&nbsp;off_6EDB94&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_sub&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668A67+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB98</span>&nbsp;off_6EDB98&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_sbb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668B08+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDB9C</span>&nbsp;off_6EDB9C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_inc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668BCE+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBA0</span>&nbsp;off_6EDBA0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_dec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668C2B+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBA4</span>&nbsp;off_6EDBA4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_mul&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668C89+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBA8</span>&nbsp;off_6EDBA8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_imul&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668D70+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBAC</span>&nbsp;off_6EDBAC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_imul_x&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668E6A+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBB0</span>&nbsp;off_6EDBB0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_div&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668F01+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBB4</span>&nbsp;off_6EDBB4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_idiv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_668FD4+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBB8</span>&nbsp;off_6EDBB8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_shl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6690A3+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBBC</span>&nbsp;off_6EDBBC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_shr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669185+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBC0</span>&nbsp;off_6EDBC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_sar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66925C+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBC4</span>&nbsp;off_6EDBC4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_or&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6692CB+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBC8</span>&nbsp;off_6EDBC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_and&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669339+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBCC</span>&nbsp;off_6EDBCC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_xor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6693A7+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBD0</span>&nbsp;off_6EDBD0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_not&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669415+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBD4</span>&nbsp;off_6EDBD4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_neg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66945B+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBD8</span>&nbsp;off_6EDBD8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_cmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6694C7+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBDC</span>&nbsp;off_6EDBDC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_test&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669550+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBE0</span>&nbsp;off_6EDBE0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_call_x86_func&nbsp;<span class="hl_comment">; DATA XREF: sub_6695B9+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBE4</span>&nbsp;off_6EDBE4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_exit_vm&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6695E3+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBE8</span>&nbsp;off_6EDBE8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_jmp_1&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669625+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBEC</span>&nbsp;off_6EDBEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_jmp_2&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66964F+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBF0</span>&nbsp;off_6EDBF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_jcc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669679+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBF4</span>&nbsp;off_6EDBF4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_jecxz&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6696CB+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBF8</span>&nbsp;off_6EDBF8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_loop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6696FB+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDBFC</span>&nbsp;off_6EDBFC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;sub_669740&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66972A+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC00</span>&nbsp;off_6EDC00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;sub_66977A&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669764+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC04</span>&nbsp;off_6EDC04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_leave&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66979E+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC08</span>&nbsp;off_6EDC08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_debug&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6697CA+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC0C</span>&nbsp;off_6EDC0C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_setcc&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6697E9+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC10</span>&nbsp;off_6EDC10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_setc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66983A+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC14</span>&nbsp;off_6EDC14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_setnc&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66985B+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC18</span>&nbsp;off_6EDC18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_cmc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_66987C+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC1C</span>&nbsp;off_6EDC1C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_bt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6698A3+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC20</span>&nbsp;off_6EDC20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_bts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6698EC+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC24</span>&nbsp;off_6EDC24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_btr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669946+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC28</span>&nbsp;off_6EDC28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_btc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_6699A4+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC2C</span>&nbsp;off_6EDC2C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_bsf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669A13+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC30</span>&nbsp;off_6EDC30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_bsr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669A7B+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC34</span>&nbsp;off_6EDC34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_cld&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669AE4+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC38</span>&nbsp;off_6EDC38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_std&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: sub_669B05+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC3C</span>&nbsp;off_6EDC3C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_stos_rep&nbsp;<span class="hl_comment">; DATA XREF: sub_669B26+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC40</span>&nbsp;off_6EDC40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_lods_rep&nbsp;<span class="hl_comment">; DATA XREF: sub_669BC1+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC44</span>&nbsp;off_6EDC44&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_movs_rep&nbsp;<span class="hl_comment">; DATA XREF: sub_669C5F+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC48</span>&nbsp;off_6EDC48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_scas_rep&nbsp;<span class="hl_comment">; DATA XREF: sub_669CE1+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC4C</span>&nbsp;off_6EDC4C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_cmps_rep&nbsp;<span class="hl_comment">; DATA XREF: sub_669DD8+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC50</span>&nbsp;off_6EDC50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fld_qword&nbsp;<span class="hl_comment">; DATA XREF: sub_669ECA+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC54</span>&nbsp;off_6EDC54&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fld_dword&nbsp;<span class="hl_comment">; DATA XREF: sub_669EF4+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC58</span>&nbsp;off_6EDC58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fstp_qword&nbsp;<span class="hl_comment">; DATA XREF: sub_669F1E+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC5C</span>&nbsp;off_6EDC5C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fstp_dword&nbsp;<span class="hl_comment">; DATA XREF: sub_669F46+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC60</span>&nbsp;off_6EDC60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fst_qword&nbsp;<span class="hl_comment">; DATA XREF: sub_669F6E+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC64</span>&nbsp;off_6EDC64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fst_dword&nbsp;<span class="hl_comment">; DATA XREF: sub_669F96+Co</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC68</span>&nbsp;off_6EDC68&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fcomp_qword&nbsp;<span class="hl_comment">; DATA XREF: sub_669FBE+Co</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">006EDC6C</span>&nbsp;off_6EDC6C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hand_fcomp_dword&nbsp;<span class="hl_comment">; DATA XREF: sub_669FE6+Co</span></li>        </ol>
    </div>
</div></div>
<br>На кой черт две инструкции безусловного перехода hand_jmp_1 и hand_jmp_2 пока не пойму. Может по размеру перехода отличаются. Там просто пока классы/структуры используются, которые заполняются в тех местах, где я еще не делал анализ. Флаговые инструкции hand_jcc и hand_setcc тоже легко распознались, благодаря <b>reversecode</b> (спасибо за VM_x_FLAG_cmp_sub_66A238). Также все легко и понятно с hand_jecxz и hand_loop. Но вот что это за конструкции, мне пока непонятно, прошу помощь зала:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;__stdcall&nbsp;sub_669740<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;a1<span class="hl_char">,</span>&nbsp;vm_object_s&nbsp;<span class="hl_char">*</span>vm_object<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;<span class="hl_char">*</span>params<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span>vm_object<span class="hl_char">-</span><span class="hl_char">&gt;</span>vm_regs<span class="hl_char">.</span>v_ecx<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;vm_object<span class="hl_char">-</span><span class="hl_char">&gt;</span>flags<span class="hl_char">.</span>ZF_flag&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;vm_object<span class="hl_char">-</span><span class="hl_char">&gt;</span>vm_regs<span class="hl_char">.</span>v_ecx&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vm_jump_handler<span class="hl_char">(</span>vm_object<span class="hl_char">,</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>params&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;params<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;}</li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;__stdcall&nbsp;sub_66977A<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;a1<span class="hl_char">,</span>&nbsp;vm_object_s&nbsp;<span class="hl_char">*</span>vm_object<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;<span class="hl_char">*</span>params<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span>vm_object<span class="hl_char">-</span><span class="hl_char">&gt;</span>vm_regs<span class="hl_char">.</span>v_ecx<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span>vm_object<span class="hl_char">-</span><span class="hl_char">&gt;</span>flags<span class="hl_char">.</span>ZF_flag&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;vm_object<span class="hl_char">-</span><span class="hl_char">&gt;</span>vm_regs<span class="hl_char">.</span>v_ecx&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vm_jump_handler<span class="hl_char">(</span>vm_object<span class="hl_char">,</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>params&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;params<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;}</li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br>Т.е. что-то похожее на переходы/циклы. Только я не припомню, чтобы флаг нуля участвовал при определении необходимости сделать переход. <img src="img/smilies/s4.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331778&amp;user=2449&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=11" class="addthx" data-post="331778"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 17:01 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
loopz/loopnz
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331779&amp;user=1556&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=12" class="addthx" data-post="331779"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 17:03 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<noindex><a href="http://web.itu.edu.tr/kesgin/mul06/intel/instr/jxx.html" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331780&amp;user=15381&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=13" class="addthx" data-post="331780"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 17:05 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<i class=x>Только я не припомню, чтобы флаг нуля участвовал при определении необходимости сделать переход</i><br><br>Эмм, <b>jz/jnz</b>??<br>Это не test случайно?<br><br><b>Добавлено</b><br>А нет - не test.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=331781&amp;user=6336&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=14" class="addthx" data-post="331781"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 17:08 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>Archer</b><br>5 баллов) круто) Можно писать декомпилятор <img src="img/smilies/s8.gif" alt=""><br><br>P.S. Интересно, обфускация под ВМ имеется? <img src="img/smilies/s2.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331782&amp;user=2449&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=15" class="addthx" data-post="331782"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 17:09 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
только опкоды упакованы)) не забывай<br><br>имеется shuffle_random_sub... который явно не для просто так)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331783&amp;user=15381&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=16" class="addthx" data-post="331783"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 18:01 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>reversecode</b><br>Да пофиг на него, плагин к IDA, бряк на vm_entry и вперед - Edit -&gt; Plugins -&gt; KillMathaFuckinVM <img src="img/smilies/s8.gif" alt=""> В динамике проще все это.<br><br>А вообще еще два года назад у меня была идея создать универсальный декомпилятор для виртуальных машин. По моим оценкам он бы победил вмпротект, фимку, код виртуализер, криптер, обсидиум. И с этой ВМ он бы в два счета бы разобрался. Не удается победить пока StarForce (слишком не шаблонная реализация), Enigma - для этих ВМ нужен частный инструмент, заточенный специально под реализацию ВМ. Вопрос только в том, что для создания такого инструмента нужно очень много времени, которого обычно нет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331786&amp;user=2449&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=17" class="addthx" data-post="331786"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 18:03 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
отдай дальше детям) пусть ломают свою игрушку
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331787&amp;user=15381&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=18" class="addthx" data-post="331787"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 18:07 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Да я может попытаюсь хотя бы куски декомпилятора запилить. У меня два раза в год обострение - я осенью обычно что-то делаю и весной. Летом и зимой болт на все кладу. Надо же чем-то себя занять сейчас) Может что полезное выйдет. <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331788&amp;user=2449&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=19" class="addthx" data-post="331788"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 18:12 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>int пишет:<br>А вообще еще два года назад у меня была идея создать универсальный декомпилятор для виртуальных машин </I><br>на чем основывается гениальная идея?)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331789&amp;user=15381&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=20" class="addthx" data-post="331789"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 19:05 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Да все гениальное просто. Составляем шаблоны всех существующих инструкций x86. Ищем циклическую обработку КОПов - конвеер ленты ВМ. Алгоритм реализован у Вамита в свипере - работает для виртуализера и вмпрота. Далее поиск таблицы КОПов, если таковая имеется, обычно используют или таблицу или switch здоровый - оба варианта легко ловятся, ибо разветвление очень сильное. Следующий этап - деобфускация всех КОПов в таблице. Дальше поиск ленты, это сложный этап, его проще в динамике ловить, ибо каждый норовит ее сделать нелинейной, зашифрованной и т.д. Главное поймать КОПы и их параметры. Потом разворачивание ленты в граф. Замена виртуальных инструкций на их разложения в x86 коде (ест-но не тупым копированием, а лишь то, что осталось после деобфускации). Потом по шаблонам инструкций x86 все сводится к проблеме эквивалентности алгоритмов - просто блоками ловить реальные x86 инструкции и заменять 10 - 20 инструкций на одну x86. Как бы сильно не раскладывали инструкцию на ее атомарные операции, все равно каждая инструкция выполняется в одном потоке выполнения кода (&quot;поток&quot; здесь не в смысле thread, а в смысле control flow) - т.е. мы по-любому получим, что, к примеру, 10 инструкций изменяют стэк, при этом изменяют указатель стэка на 4 байта вниз, изменения регистров гасятся (т.е. init значение участка кода равняется результирующему значению), изменений данных кроме стэка нет, а дальше работает шаблон X86_PUSH=(R_ESP-4, [R_ESP] = DATA) и превращает эти 10 инструкций в PUSH R32 или PUSH I32 (в зависимости от типа DATA). Если разложения в атомарные операции нескольких инструкций между собой перемешаны, т.е. сначала для одной инструкции выполняется какая-то операция, потом для следующей другая, потом снова первая обрабатывается - все равно это разные потоки выполнения, они отделяются друг от друга анализатором и все равно сработает шаблон. Ну а дальше руками разгребать очищенные трассы кода и думать о том, как их вставлять обратно. Но это не тоже самое, что в оригинальной ВМ бегать по VM_RUN. Это уже обычный x86 код, который, возможно, не до конца оптимизирован.<br><br>Поясню почему нельзя натравливать шаблоны инструкций x86 сразу на обработчики. Дело в том, что не всегда это работает. Во-первых, в обработчики часто вставляют не нужный мусор, т.е. то, что к выполнению инструкции не имеет отношения. Это может быть анти-отладка, анти-дамп, что угодно. Но заготовка шаблона не сойдется ни с одной инструкцией. Автоматически зарубить анти-отладочные приемы невозможно. Это должно быть не на плечах декомпилятора. Во-вторых, бывают такие виды ВМ, что в них или не захотели (например, все ВМ в которых логика и арифметика реализована через базовые инструкции - сложение и любая функция Шеффера) или даже нельзя по архитектуре некоторые инструкции запихнуть в один шаблон. В них одна x86 инструкция раскладывается на несколько виртуальных инструкций. А вот когда ленту ВМ разворачиваем, тогда уже шаблоном можно подобрать &quot;оптимизацию&quot; десятка инструкций в одну x86, которая делает все тоже самое.<br><br>Проблема почти всех ВМ в том, что люди начитаются книжек или бывшие крекеры их садятся писать, которые пару тройку ВМ разобрали и пришла им в голову гениальная идея написать свою. В итоге получаем очередной штамп. У многих ВМ есть эти параметры:<br>1. <b>Наличие цикла исполнения кода</b>. А значит ВМ легко задетектить. Цикл, каждый проход которого выполняет новый код - это ВМ. Ну нельзя написать код с циклом, который так себя ведет. Если у кого-то из программистов получится именно это - он написал ВМ, сам того не осознавая.<br>2. <b>switch-таблица</b>. Здесь я имею в виду, что вызов обработчика в коде выглядит как mov reg, [base + index * mem_multiplier] (где для 32-бит множитель mem_multiplier понятное дело равен 4-ке) или сразу вызов call [base + index * mem_multiplier]. Даже если таблица под обфускацией, как в вмпроте, легко отслеживаем регистры, которые участвуют в индексации и составляем шаблон деобфускации. Потом определяем размер таблицы и КОПы у нас в руках. На каждый обработчик натравливаем деобфускатор.<br>3. <b>Наличие ленты исполняемого виртуального кода.</b> Ну, и как следствие указатель команд в локальной переменной или чаще в регистре. Ну, хранить виртуальные инструкции как-то же надо? Почти все реализации ВМ используют лобовое решение - тупо массив с КОПами и их параметрами. Бывает, что параметры лежат в отдельном массиве (типа экономия места на ленте). Спалить обращение к ленте с учетом конвейерной обработки данных на ней - не проблема.<br><br>Вот еще один штамп, в студенческие годы игрался, написано под DOS (т.е. 16-битная ВМ):<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">_start<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span><span class="hl_function">data</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">,</span><span class="hl_registr">ax</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">cx</span><span class="hl_char">,</span>count</li><li class="hl_l0"><span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">bp</span><span class="hl_char">,</span><span class="hl_registr">ds</span><span class="hl_char">:</span>codeVm</li><li class="hl_l1"><span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">bx</span><span class="hl_char">,</span><span class="hl_registr">bx</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;IP1<span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l1">_execute<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span>IP1</li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">dx</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">cx</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">cx</span><span class="hl_char">,</span><span class="hl_number">5</span></li><li class="hl_l0"><span class="hl_function"><b>mul</b></span>&nbsp;<span class="hl_registr">cx</span></li><li class="hl_l1"><span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">cx</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">si</span><span class="hl_char">,</span><span class="hl_registr">ax</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">bl</span><span class="hl_char">,</span><span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">bp</span><span class="hl_char">+</span><span class="hl_registr">si</span><span class="hl_char">]</span><span class="hl_comment">; OpCode</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">bp</span><span class="hl_char">+</span><span class="hl_registr">si</span><span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_comment">; Operand1</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">bp</span><span class="hl_char">+</span><span class="hl_registr">si</span><span class="hl_char">+</span><span class="hl_number">3</span><span class="hl_char">]</span><span class="hl_comment">; Operand2</span></li><li class="hl_l0"><span class="hl_function"><b>shl</b></span>&nbsp;<span class="hl_registr">bx</span><span class="hl_char">,</span><span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_registr">cs</span><span class="hl_char">:</span>table<span class="hl_char">[</span><span class="hl_registr">bx</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>inc</b></span>&nbsp;IP1<span class="hl_comment">; Следующая команда</span></li><li class="hl_l1"><span class="hl_function"><b>loop</b></span>&nbsp;_execute</li><li class="hl_l0">readkey</li><li class="hl_l1">finish</li>        </ol>
    </div>
</div></div>
<br><br>А теперь внимание. Я не ковырял лично StarForce, как-то в игры не играю, соответственно и материал не попадается для работы с игровыми протекторами. Ну так вот, по словам моих знакомых игро-ломателей, в StarForce нет ни одного пункта из выше перечисленных. Там просто нечего ломать) Там вся ВМ заведомо раскручена. Нет ни циклов, никаких таблиц, просто вермишель виртуализованного кода. И каждый обработчик сам определяет, какой обработчик ему выполнять следующим.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331790&amp;user=2449&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=21" class="addthx" data-post="331790"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2013 20:43 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
в чем универсальность я не уловил) все равно опкоды нужно разбирать<br>без них лента китайская азбука ))<br><br>хорошо что в даном случае опкоды банальные в реализации, потому что скорость нужна<br>а бывают реализации самой логики на с++ где огого какой код избыточный
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331796&amp;user=15381&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=22" class="addthx" data-post="331796"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=6336" title="03-10-2013 19:10, ранг:540.8" target="_blank">ARCHANGEL</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 октября 2013 08:42 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<b>Простой</b> лоадер тут сделать не получится. Нужен <b>не</b>простой. <br>Который можно было бы закрутить и посвыше... Патч? -<br>Согласен с ранее прозвучавшим в параллельной (закрытой) теме мнением, что все обсуждения здесь <br>прямиком пойдут в наработки защиты будущей версии рассматриваемого софта.<br>Что касается &quot;декомпилятора&quot;, то (думаю) много чести делать его индивидуально для отдельной версии отдельной софтины.<br>Это же не MSVBVM, которую в микрософт уже вряд-ли будут кардинально изменять...<br>А сама тема разбора VM что-ж, интересная. Но всё это <b>крайне</b> неуниверсально. Трата времени.<br><br>P.S.(к следующему посту) -- <b>Int</b>, не обращайте внимания, мысли вслух. Считайте, что спам.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331814&amp;user=35473&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=23" class="addthx" data-post="331814"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 октября 2013 15:35 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>reversecode</b><br>Где я написал, что опкоды надо разбирать? <img src="img/smilies/s2.gif" alt=""><br><br>Это делает автомат, которые вычленяет их код из цикла ВМ (это просто ветки графа), очищает и преобразует в шаблоны. У Вамита, например, именно так и происходит. Только он не использует шаблоны в чистом виде, он их сравнивает с теми, которые заведомо разобраны. Я не могу публиковать детали реализации его инструмента, мой труд внесенный в Sweeper минимален и авторские права, включая детали реализации, остаются по праву у Вамита. Я только составлял шаблоны под вмпрот. В создании анализаторов не участвовал.<br><br>Мой же метод не требует первоначального изучения ВМ. Только его реализовать надо. <img src="img/smilies/s3.gif" alt=""><br><br><I>reversecode пишет:<br>а бывают реализации самой логики на с++ где огого какой код избыточный  </I><br>Примеры в студию! <img src="img/smilies/s2.gif" alt=""><br><br><b>dosprog</b><br>А вас кто-то заставляет что-то делать по этой программе и этой ВМ? Смысл комментария не понятен. Что касается MSVBVM - уже достаточно создано декомпиляторов P-кода. И кардинально изменять ее (ВМ) тоже не будут, просто потому, что VB 6 был последний нативный продукт и его разработка прекращена.<br><br>P.S. И не пытайтесь доказать, что это невозможно или не универсально. VMSweeper же работает. Просто я хотел пойти дальше и избавиться вообще от шаблонов. Шаблоны плохо использовать хотя бы потому, что одно изменение реализации хотя бы одного обработчика ломает возможность использования инструмента. У нас на этом месте с Вамитом возник спор, но только его инструмент работает, а мой существует только на бумаге и в виде кусков кода, который надо переписывать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331822&amp;user=2449&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=24" class="addthx" data-post="331822"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 октября 2013 16:11 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>int пишет:<br>Это делает автомат, которые вычленяет их код из цикла ВМ (это просто ветки графа), очищает и преобразует в шаблоны. </I><br>это будет работать на очень узком кругу вм<br><br>мысленно рисую ситуацию ... вм... в ней один опкод это не опкод из x86, а вымышленый опкод который делает сразу md5 или md5(md5(x)) и реализация этого md5 на С++ с обьектами где ты ни в какой шаблон это не выкрутишь, потому что контекст привязан на ВМ, которая инициализируется гараздо раньше самого вхождения в ВМ цикл...<br><br><br>вот как твой метод будет работать в этой ситуации? <br>а то что то до меня туго доходит))<br><br>sweeper все реверсили видели, опокды там видны все понятно, лишний раз рассказывать не надо)<br><br>add<br>идея в том что бы опкоды разворачивать в их реализации и выплевывать в таком виде код? или как
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331824&amp;user=15381&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=25" class="addthx" data-post="331824"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 октября 2013 17:28 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>reversecode пишет:<br>идея в том что бы опкоды разворачивать в их реализации и выплевывать в таком виде код? или как  </I><br>Приблизительно, да. Только не в таком виде, а чистить. Самое интересное - это чистить. Это потребует чтобы каждая инструкция была разложена в атомарное представление. И когда одна инструкция представлена через другие - находить наиболее оптимальные замены. Код в таком случае, может и не соответствовать оригинальному, который был еще до виртуализации. Но он будет достаточно понятным для анализа. Это и есть ключевая идея и самая сложная часть.<br><br>Кстати, иногда ВМ не мешает, а наоборот открывает возможности. Я как-то ломал программу под вмпротом, мне нужен был бряк на данные. Легко! Ставим бряк на обработчик команды, которая читает данные (такой обработчик может быть не один - на все сразу ставится точка останова). И вуаля! Условный бряк в IDA дал мне то, что нужно! А как бы я решал эту же задачу (пусть для определенности ida 5.2 - в ней нет точек останова на память встроенных в отладчик)? Ставил бы точки останова на все подряд инструкции? Где искать нужные данные я тогда не знал. Возможности использовать железные бряки тоже не было. А вмпрот очень мило классифицировал все инструкции на их типы (заметьте - один бряк на стрелке Пирса дает отлов ВСЕЙ логики, если ее только какой-нибудь умник сдвигами и сложениями не реализовал, кстати не проверял такую возможность). Понятно, что много мусора будет ловить, но правильный фильтр решает все проблемы. <img src="img/smilies/s8.gif" alt=""><br><br><b>reversecode</b><br>Шаблонов с MD5 не будет просто по определению инструмента. А как будет работать инструмент со старфорс? Да тоже никак, ибо не подходит под решаемую задачу. А сделать крутую ВМ, которую не возьмет ни один девм тоже легко: применить всякие интересные штуки типа великой теоремы ферма и повесить мертвую ветку, выполнение которой будет противоречить этой теореме. Девм не знает содержимого сотен книг по кибернетике, непрерывной математики и криптографии. Можно запутать средства авто анализа так, что даже человек будет неделями вылавливать трюк за трюком вручную. Просто никто эти идеи в жизнь не воплатил. Деобфускация, вообще говоря, алгоритмически не разрешимая задача, равно как и обфускация. Можно легко написать код, который при виртуализации тем же вмпротом сломается и будет не работоспособен. И что теперь делать? Можно ничего не делать. А можно решать задачи под частные случаи и это довольно эффективно на практике.<br><br>Возвращаясь к основной теме, хочу сказать, что данная ВМ имеет одну неприятную особенность. Часть обработчиков перехватывается на уровне цикла ВМ и они исполняются прямо внутри цикла, без вызова обработчиков, хотя обработчики соответствующие есть. Т.е. тупо вынесли часть обработчиков в тело цикла. Я уже получил трассу выполнения одной виртуализованной функции, приятного в ней мало.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331832&amp;user=2449&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=26" class="addthx" data-post="331832"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 октября 2013 18:41 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22193.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b><font color="red">От модератора: надоело уже весь этот мат читать. забанен на неделю</font></b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331838&amp;user=33727&amp;forum_n=5&amp;topic=22193.html&amp;page=0&amp;anchor=27" class="addthx" data-post="331838"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите определить виртуальную машину из MapEdit (с Geopainting.com)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#28" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="22193">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22193" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
