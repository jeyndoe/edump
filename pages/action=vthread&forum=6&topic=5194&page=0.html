<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Использование функций чужой DLL - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Привет всем! Хочу написать распаковщик к одной игре. Пробовал выдирать куски нужного кода из игры - получалось очень даже неплохо... Почти раскопал всю защиту. Но столкнулся с тем, что там помимо кодирования используется какое-то">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=39467'>hgdagon</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Использование функций чужой DLL</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Tim[/b]','')">Tim</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 253.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.91'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=161">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2006 18:58 <br><script type="text/javascript">QU('Tim','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tim" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Привет всем!
<br>
<br>Хочу написать распаковщик к одной игре. Пробовал выдирать куски нужного кода из игры - получалось очень даже неплохо... Почти раскопал всю защиту. Но столкнулся с тем, что там помимо кодирования используется какое-то самопальное сжатие. Как вы понимаете, куча CALL&#039;ов и ничего не понятно.
<br>Было решено заюзать DLL, отвечающую за работу с форматом файлов. Там есть интересные функции - порядка 20.
<br>А теперь сам вопрос. Я пишу на C/C++. Как мне лучше сделать прототипы этих функций? Чтобы потом использовать их в своей программе?
<br>Очень интересно будет посмотреть на ваши решения.
<br>
<br>Thanx!
<br><br><font size="1"><i>-----<br>MicroSoft? Is it some kind of a toilet paper?</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=75682&amp;user=161&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=1" class="addthx" data-post="75682"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b][norwed][/b]','')">[norwed]</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 15.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.1'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5034">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2006 19:11 <br><script type="text/javascript">QU('[norwed]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[norwed]" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
В смысле тебе надо будет запускать функции этой DLL из своей проги?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=75684&amp;user=5034&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=2" class="addthx" data-post="75684"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Tim[/b]','')">Tim</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 253.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.91'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=161">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2006 19:14 <br><script type="text/javascript">QU('Tim','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tim" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>[norwed]</b>
<br>ja!
<br><br><font size="1"><i>-----<br>MicroSoft? Is it some kind of a toilet paper?</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=75685&amp;user=161&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=3" class="addthx" data-post="75685"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b][norwed][/b]','')">[norwed]</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 15.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.1'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5034">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2006 19:24 <br><script type="text/javascript">QU('[norwed]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[norwed]" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
USELIB(&quot;имя_библиотеки&quot;);
<br>А дальше используешь её функции с такими же именами как и в библиотеке.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=75688&amp;user=5034&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=4" class="addthx" data-post="75688"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Tim[/b]','')">Tim</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 253.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.91'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=161">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2006 20:25 &middot; Поправил: Tim <br><script type="text/javascript">QU('Tim','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tim" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Что-то не так... Бился, бился, но линкер говорил unresolved external... хотя я явно задавал прототип функции сам...
<br><br><font size="1"><i>-----<br>MicroSoft? Is it some kind of a toilet paper?</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=75700&amp;user=161&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=5" class="addthx" data-post="75700"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b][norwed][/b]','')">[norwed]</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 15.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.1'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5034">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2006 22:25 <br><script type="text/javascript">QU('[norwed]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[norwed]" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Ты в чём бился? В VS++ или BC++?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=75730&amp;user=5034&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=6" class="addthx" data-post="75730"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]=TS=[/b]','')">=TS=</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/3085.png" alt=""><br><span class=txtSm>Ранг: 251.8 (наставник), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.63'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3085">Участник</a><br><font color=blue>Seeker</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 00:17 &middot; Поправил: =TS= <br><script type="text/javascript">QU('=TS=','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto==TS=" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>Tim</b>
<br>вот так к примеру:
<br><code>
<br>...
<br>typedef ... /*function result type*/ ...	(WINAPI *tfSome)		(... /* function parameters*/...);
<br>...
<br>tfSome	fSome;
<br>HMODULE	hLib;
<br>...
<br>	hLib=LoadLibrary(szOurDll);
<br>	if (hLib)
<br>	{
<br>		fSome=(tfSome)GetProcAddress(hLib,&quot;Some&quot;);
<br>		if (fSome)
<br>		{
<br>			...
<br>			fSome (...); //Use fSome
<br>			...
<br>		}
<br>	}
<br></code>
<br>
<br>Это пример для конвенции WINAPI
<br>
<br><b>[norwed]</b>
<br>ИМХО, флуд не по теме...
<br><br><font size="1"><i>-----<br>DREAMS CALL US</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=75748&amp;user=3085&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=7" class="addthx" data-post="75748"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Alexus2006[/b]','')">Alexus2006</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 34.6 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.4'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3788">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 08:22 <br><script type="text/javascript">QU('Alexus2006','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alexus2006" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
сначала нужно сделать либу (.lib) с этой dll для этого в состав С++ Builder входит такая улитка implib.exe а потом прицепить её к проекту и вызывать функции как из свей dll только имена функций надо точно знать
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=75782&amp;user=3788&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=8" class="addthx" data-post="75782"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]realcoding[/b]','')">realcoding</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.1'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5040">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 08:56 <br><script type="text/javascript">QU('realcoding','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=realcoding" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Вообще мона использовать dll написанную на любом языке, если она использует WinAPI функции(что 99,999% так)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=75786&amp;user=5040&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=9" class="addthx" data-post="75786"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]BeeCrey[/b]','')">BeeCrey</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.53'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3367">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 09:50 <br><script type="text/javascript">QU('BeeCrey','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BeeCrey" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Для использования функций из длл нужно знать довольно много:
<br>порядок передачи параметров (справа налево или слева направо),
<br>метод передачи параметров (через регистры, через стек),
<br>способ передачи параметров (по значению или по ссылке).
<br>   О порядке передачи и методе передачи смотри соглашения о вызовах:
<br>_fastcall - параметры передаются <b>слева направо</b> в ECX,EDX и через стек справа налево,
<br>_stdcall - параметры передаются <b>справа налево</b> через стек,
<br>_cdecl - параметры передаются <b>справа налево</b> через стек.
<br>Упомянутое WINAPI объявлено как _stdcall.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=75797&amp;user=3367&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=10" class="addthx" data-post="75797"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]BeeCrey[/b]','')">BeeCrey</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.53'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3367">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 09:53 <br><script type="text/javascript">QU('BeeCrey','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BeeCrey" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Разница между _stdcall и _cdecl заключается в том, кто отвечает за восстановление стека после вызова функции. При использовании _cdecl за восстановление стека отвечает вызывающая программа.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=75800&amp;user=3367&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=11" class="addthx" data-post="75800"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 10:46 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>BeeCrey пишет:
<br>Для использования функций из длл нужно знать довольно много: 
<br>порядок передачи параметров (справа налево или слева направо),  </I>
<br> Все это можно понять просматривая дизасм функций. IDA вообще по-моему это на автомате делает.
<br><I>Tim пишет:
<br> Бился, бился, но линкер говорил unresolved external... хотя я явно задавал прототип функции сам... </I>
<br> Все наступают на эти грабли. В Visual Studio я использовал .def файл(если память не изменяет), в Борланде не делал. Ты должен указать линкеру, что вызов будет идти через таблицу импорта, а иначе он ищет в простых библиотеках.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=75816&amp;user=4072&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=12" class="addthx" data-post="75816"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]BeeCrey[/b]','')">BeeCrey</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.53'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3367">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 11:42 <br><script type="text/javascript">QU('BeeCrey','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BeeCrey" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>Tim &#208;&#191;&#208;&#184;&#209;&#136;&#208;µ&#209;&#130;:
<br>Бился, бился, но линкер говорил unresolved external... хотя я явно задавал прототип функции сам... </I>
<br>Как сказал <b>Alexus2006</b>, следовало сделать .lib файл с длл. Этот файл содержит символьные имена функций и переменных, экспортируемых из длл. Укажешь линкеру на этот файл и можешь вызывать функции согласно своим прототипам. Вызов будет идти через таблицу импорта.
<br>В данном случае .def файл и .lib файл имеют одно и тоже значение. Они содержат символы, экспортируемые из длл. Мне кажется, что использовать .lib файл лучше, т.к. его можно сделать автоматически (см. пост <b>Alexus2006</b>).
<br>Из поста <b>Tim</b> я понял, что из длл нужно 20 функций. Мне кажется довольно утомительным делать
<br>.def файл на 20 функций. Поэтому я предпочел бы использовать implib.exe.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=75826&amp;user=3367&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=13" class="addthx" data-post="75826"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]BeeCrey[/b]','')">BeeCrey</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.53'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3367">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 12:07 <br><script type="text/javascript">QU('BeeCrey','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BeeCrey" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
О DLL и работе с ними лучше всего почитать Джеффри Рихтера &quot;Windows для профессионалов: создание эффективных Win32-приложений с учетом специфики 64-разрядной версии Windows&quot; 4-е издание.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=75831&amp;user=3367&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=14" class="addthx" data-post="75831"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Tim[/b]','')">Tim</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 253.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.91'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=161">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 13:19 <br><script type="text/javascript">QU('Tim','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tim" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Вау! Всем спасибо!
<br>
<br>Я пишу в Borland C++. Делал либу, привязывал с помощью макроса USELIB. Но не получилось... Такое впечатление, что он их игнорирует. Буду пробовать MSVC.
<br>
<br>Еще раз thanx.
<br><br><font size="1"><i>-----<br>MicroSoft? Is it some kind of a toilet paper?</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=75847&amp;user=161&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=15" class="addthx" data-post="75847"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Cigan[/b]','')">Cigan</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.89'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=208">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 13:25 <br><script type="text/javascript">QU('Cigan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Cigan" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>Tim пишет:
<br>Я пишу в Borland C++. </I> Там есть утилита для переделки длл в либ так что переделал длл и начал использовать имена функции ссылаясь на эту либу если там манглед то тогда GetProcAddress
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=75850&amp;user=208&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=16" class="addthx" data-post="75850"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]=TS=[/b]','')">=TS=</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/3085.png" alt=""><br><span class=txtSm>Ранг: 251.8 (наставник), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.63'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3085">Участник</a><br><font color=blue>Seeker</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 13:45 &middot; Поправил: =TS= <br><script type="text/javascript">QU('=TS=','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto==TS=" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>tundra37 пишет:
<br> В Visual Studio я использовал .def файл </I>
<br>Он нужен только если ты пишешь СВОЮ dll, а для днного случая не нужен вообще
<br>
<br><I>Tim пишет:
<br>Я пишу в Borland C++. Делал либу, привязывал с помощью макроса USELIB. Но не получилось... Такое впечатление, что он их игнорирует. Буду пробовать MSVC. </I>
<br>
<br>Какая в каком компиляторе? Зачем юзать макросы? Я же написал РАБОЧИЙ пример.
<br>ЗЫ. Там FreeLibrary нужно делать еще после использования всех нужых функций...
<br>
<br><I>Cigan пишет:
<br> Там есть утилита для переделки длл в либ так что переделал длл и начал использовать имена функции ссылаясь на эту либу если там манглед то тогда GetProcAddress </I>
<br>
<br>С манглироваными именами не сталкивался при программировании,п оэтому подтверждать или отрицать не буду <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>DREAMS CALL US</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=75853&amp;user=3085&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=17" class="addthx" data-post="75853"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Cigan[/b]','')">Cigan</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.89'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=208">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 16:05 <br><script type="text/javascript">QU('Cigan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Cigan" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>=TS= пишет:
<br>Я же написал РАБОЧИЙ пример.  </I>
<br><I>=TS= пишет:
<br>С манглироваными именами не сталкивался при программировании,п оэтому подтверждать или отрицать не буду  </I>
<br>Вообщем ты и написал пример когда юзаетьтся манглед импорт, но если его нет то можно создать либу с протоипами фунций и юзать прортотипы без GetProcAddress
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=75879&amp;user=208&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=18" class="addthx" data-post="75879"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Tim[/b]','')">Tim</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 253.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.91'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=161">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 17:15 <br><script type="text/javascript">QU('Tim','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tim" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Это mangled?
<br>
<br>_SFS_GetCacheBlockSize@8
<br>_SFS_GetCacheSize@8
<br>_SFS_IsFile@8
<br>_SFS_Mount@12
<br>_SFS_MountAs@16
<br>_SFS_MountRes@12
<br>_SFS_Mounted@12
<br>_SFS_SetCacheBlockSize@8
<br>_SFS_SetCacheSize@8
<br>_SFS_UnMount@4
<br>_SFS_UnMountPath@4
<br>_SFS_close@4
<br>_SFS_errno@0
<br>_SFS_lseek@12
<br>_SFS_open@8
<br>_SFS_read@12
<br>_SFS_write@12
<br><br><font size="1"><i>-----<br>MicroSoft? Is it some kind of a toilet paper?</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=75890&amp;user=161&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=19" class="addthx" data-post="75890"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Cigan[/b]','')">Cigan</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.89'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=208">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 19:30 &middot; Поправил: Cigan <br><script type="text/javascript">QU('Cigan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Cigan" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
Нет.
<br>_SFS_write -&gt;Название функции
<br>@12 Количество параметров а имено  : DWORD, : DWORD, : DWORD
<br>
<br>Манглед выглядит так:
<br>?ha@@YAKPAUHWND__@@PBD1@Z@12
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=75932&amp;user=208&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=20" class="addthx" data-post="75932"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]=TS=[/b]','')">=TS=</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/3085.png" alt=""><br><span class=txtSm>Ранг: 251.8 (наставник), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.63'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3085">Участник</a><br><font color=blue>Seeker</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 19:35 <br><script type="text/javascript">QU('=TS=','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto==TS=" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>Cigan пишет:
<br>можно создать либу с протоипами фунций и юзать прортотипы без GetProcAddress </I>
<br>А по-моему динамическая линковка рулит...
<br><br><font size="1"><i>-----<br>DREAMS CALL US</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=75934&amp;user=3085&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=21" class="addthx" data-post="75934"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2006 20:46 <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Вот мой вариант (Delphi) для замены результатов работы функций:
<br>Пробовал для функций по STDCALL и cdecl
<br>
<br>
<br>PS вроде как все нормально получалось.
<br>
<br>Для получения списка экспортируемых функций использовал
<br>dll2spy.exe  из Kerberos
<br>
<br>
<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/504c_08.06.2006_CRACKLAB.rU.tgz">504c_08.06.2006_CRACKLAB.rU.tgz</a> - sanctuarylib.dpr
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=75947&amp;user=1705&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=22" class="addthx" data-post="75947"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]killerwolf[/b]','')">killerwolf</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.69'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=7570">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 ноября 2006 01:24 <br><script type="text/javascript">QU('killerwolf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=killerwolf" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5194.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<b>Tim</b>привет, пожалусто мне нужен читак для ил2 штурмовика, я те бабки заплочу токо помоги!!! мнебы хотяб самый простой с видом, чтобы кабину отключить можно было а зделать такой мультяшный вид с прицелом! и стрелокой
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=101906&amp;user=7570&amp;forum_n=6&amp;topic=5194.html&amp;page=0&amp;anchor=23" class="addthx" data-post="101906"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Использование функций чужой DLL</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#24" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="5194">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=5194" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
