<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Исследование RAR Password Recovery 5.0 - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем привет! Пытаюсь исследовать шароварную прогу RAR Password Recovery 5.0. Версия Trial. Скачал её по ссылке:http://www.recoverlostpassword.com/downloads/rar_password_recov ery_trial.exe PEiD сказал, что это Microsoft Visual">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Исследование RAR Password Recovery 5.0</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Forester[/b]','')">Forester</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.59'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=27157">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2010 13:20 <br><script type="text/javascript">QU('Forester','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Forester" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=17515.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Всем привет!<br>Пытаюсь исследовать шароварную прогу RAR Password Recovery 5.0. Версия Trial. Скачал её по ссылке:http://www.recoverlostpassword.com/downloads/rar_password_recov ery_trial.exe<br>PEiD сказал, что это Microsoft Visual C++ 8.0 *<br> Я загнал её в OllyDbg_1.10. Постановка бряков, чтобы отловить окно о неправильном коде ни к чему не привели, нашёл по all referenced text string строки: &quot;Thank you for registering RAR Password Recovery!&quot;, &quot;The Code you&#039;ve entered invalid!&quot;<br>попал в это место:<br>00401CD2   . E8 E9370000    CALL RarPassw.004054C0<br>00401CD7   . 85C0           TEST EAX,EAX<br>00401CD9   . 74 3E          JE SHORT RarPassw.00401D19     Здесь поставил бряк<br>00401CDB   . 6A 30          PUSH 30                                     ; /Arg3 = 00000030<br>00401CDD   . 68 00DA4A00    PUSH RarPassw.004ADA00    ; |Arg2 = 004ADA00<br>00401CE2   . 68 20DA4A00    PUSH RarPassw.004ADA20    ; |Arg1 = 004ADA20 UNICODE &quot;The Code you&#039;ve entered invalid!&quot;<br>……..<br>00401D19   &gt; 8D7C24 0C      LEA EDI,DWORD PTR SS:[ESP+C]<br>00401D1D   . E8 8E420000    CALL RarPassw.00405FB0    Здесь тоже бряк<br>00401D22   . 6A 40          PUSH 40                                  ; /Arg3 = 00000040<br>00401D24   . 68 00DA4A00    PUSH RarPassw.004ADA00  ; |Arg2 = 004ADA00<br>00401D29   . 68 68DA4A00    PUSH RarPassw.004ADA68  ; |Arg1 = 004ADA68 UNICODE &quot;Thank you for registering RAR Password Recovery!&quot;<br> 00401D2E   . 8BCE           MOV ECX,ESI                              ; |<br>00401D30   . E8 6FD80500    CALL RarPassw.0045F5A4                   ; \RarPassw.0045F5A4<br><br> Первый раз после ввода неправильного пароля меня выкинуло на JE SHORT RarPassw.00401D19, в окне регистров поменял флаг нуля, тормознулся на  00401D1D   . E8 8E420000    CALL RarPassw.00405FB0  и предвкушая, что сейчас выскочит окно:   &quot;Thank you for registering RAR Password Recovery!&quot;, нажал F9. выкинуло меня на обработчике исключений:<br><br>00340046   FFD0             CALL EAX                                 ; ntdll.RtlRaiseException<br>00340048   C2 0400          RETN 4  Здесь!<br>0034004B   0000             ADD BYTE PTR DS:[EAX],AL<br><br>Олька сказала Exception E 06D7363 - use Shift+F7/F8/F9 to pass exception to program.<br>После нажатия Shift+F9  прога завешилась окном винда: «Произошла ошибка, программа будет закрыта, приносим извинения...»<br>Внутри  00401CD2    CALL RarPassw.004054C0 для меня наступает тёмный лес. Никак не могу просечь алгоритм, т.к. используется длина ID процессора, какие-то цифровые ANSII строки, вероятно вычисляется контрольная сумма? Не могу найти действий с вводимым паролем, кроме вычисления его длины. Меня просто выкидывает из проги .<br>  Попасть на 00401CD9  JE SHORT RarPassw.00401D19 я не могу, т.к. в недрах 00401CD2    CALL RarPassw.004054C0 я попадаю на обработчик исключений. Пробовал удалять прогу, все записи о ней в реестре, переустанавливал, но всё также.<br> Подскажите, пожалуйста, на чём сконцентрировать усилия, в какую сторону двигаться далее, как уйти от проверок на отладку, похоже, что плугина HideDebagger 123. с его возможностями не хватает, пробовал вручную обнулять при нахождении в точке входа ,байты NTGlobalFlag и ProcessHeap, не помогает. Где-то защита меня цепляет?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=273541&amp;user=27157&amp;forum_n=5&amp;topic=17515.html&amp;page=0&amp;anchor=1" class="addthx" data-post="273541"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2010 14:00 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=17515.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
нужно чтоб CALL 004054C0 возвращал 0 т.е. по адресу 00405B48 написать xor eax,eax и ввести любой 16ти значный код.<br>з.ы. какая-то тупая прога, ресурсов жрет как слон, при том медленная как улитка.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=273543&amp;user=5291&amp;forum_n=5&amp;topic=17515.html&amp;page=0&amp;anchor=2" class="addthx" data-post="273543"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2010 14:04 &middot; Поправил: PE_Kill <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=17515.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>Forester</b> не всё можно отладить. Ты писал:<br><br><i class=x>00401CD2 . E8 E9370000 CALL RarPassw.004054C0<br>00401CD7 . 85C0 TEST EAX,EAX<br>00401CD9 . 74 3E JE SHORT RarPassw.00401D19 Здесь поставил бряк</i><br><br>Я скачал программу. Зашел в CALL RarPassw.004054C0 и пропатчил там начало функции так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004054C0</span>&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">$</span>&nbsp;&nbsp;<span class="hl_number">33C0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">004054C2</span>&nbsp;&nbsp;<span class="hl_char">\</span><span class="hl_char">.</span>&nbsp;&nbsp;C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">RETN</span></li>        </ol>
    </div>
</div></div>
<br>Всё, сохранил перезапустил, прога не зарегана. Нажал Register, ввел 112233, Ok. Прога выдала что зарегана и создала файл UNlock.dat. Перезапустил - всё зареганая программа.<br><br>PS. <b>Vovan666</b> опередил <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=273544&amp;user=3232&amp;forum_n=5&amp;topic=17515.html&amp;page=0&amp;anchor=3" class="addthx" data-post="273544"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Forester[/b]','')">Forester</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.59'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=27157">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2010 19:53 <br><script type="text/javascript">QU('Forester','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Forester" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=17515.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Однако, довольно простое решение. Честно говоря я предполагал, что потребуется найти алгоритм кодирования введённого пароля, разместить в конце секции брутфорсер и ждать когда он переберёт все варианты.<br>  Тем не менее прога зарегана, огромное спасибо за подсказку в решении  Vovan666 и PE_Kill. <br>  Думаю, вопрос исчерпан.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=273555&amp;user=27157&amp;forum_n=5&amp;topic=17515.html&amp;page=0&amp;anchor=4" class="addthx" data-post="273555"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2010 20:09 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=17515.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Раз исчерпан, тогда закрою.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=273556&amp;user=1556&amp;forum_n=5&amp;topic=17515.html&amp;page=0&amp;anchor=5" class="addthx" data-post="273556"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Исследование RAR Password Recovery 5.0</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=17515" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
