<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Программа после распаковки(crc?) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброе время суток. Программа была упакована ASProtect [2.4 build 11.20 Release]. Расспаковал используя скрип для OllyDBG by VolX, импорт востановил, программа запускаеться и работает как зарегистрированная. Но через какой-то">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Программа после распаковки(crc?)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]criogen[/b]','')">criogen</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26830">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2010 15:05 &middot; Поправил: criogen <br><script type="text/javascript">QU('criogen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=criogen" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброе время суток. Программа была упакована ASProtect [2.4 build 11.20 Release]. Расспаковал используя скрип для OllyDBG by VolX, импорт востановил, программа запускаеться и работает как зарегистрированная. Но через какой-то промежуток времени она выдает сообщение о том что она была взломана и закрывается. При отладке в Олли он пишет что он не может обработать ошибку и EIP улетает непонятно куда. Программа показывает что-то типа MessageBox но закрывается даже до нажатия на нем. Строчек с этим сообщение найти не удалось, вероятно они в зашифрованном виде храняться. Пробывал ставить брекпоинты на GetSystemDate,GetSystemTime  они не срабатывают. Помогите, пожалуйста, разобраться с этим, особенно каким способом вы до этого дошли если можно по подробней. Я даже не знаю чего начать чтобы это побороть. Еще один момент, программа написана на Делфи, используеться тяжеловесные компоненты от чего очень много в ней кода,  размер EXE &gt;25 мегабайт. При запросе регистрационных данных имя любое, код любые 16 символов( Например : 1234567890123456)<br>Распакованная версия: (6,5 МБ) ***залил упакованную RARом<br><noindex><a href="http://www.multiupload.com/4D9VETJ1E1" rel="nofollow" target="_blank">http://www.multiupload.com/4D9VETJ1E1</a></noindex><br>Упакованная версия: (6,5 МБ)<br><noindex><a href="http://www.multiupload.com/YWG3QKAI1X" rel="nofollow" target="_blank">http://www.multiupload.com/YWG3QKAI1X</a></noindex><br><br>Заранее благодарен за помощь. <br>P.S. если ли способ защиты Олли от этого antidebug метода ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=269348&amp;user=26830&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=1" class="addthx" data-post="269348"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2010 16:04 <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>criogen пишет:<br>Но через какой-то промежуток времени она выдает сообщение о том что она была взломана и закрывается. </I><br>А причём тут это<br><I>criogen пишет:<br>Пробывал ставить брекпоинты на GetSystemDate,GetSystemTime они не срабатывают. </I><br><br><br><I>criogen пишет:<br>P.S. если ли способ защиты Олли от этого antidebug метода ?  </I><br>Попробуй плагины Phant0m или StrongOD.
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=269358&amp;user=15500&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=2" class="addthx" data-post="269358"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]criogen[/b]','')">criogen</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26830">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2010 16:22 &middot; Поправил: criogen <br><script type="text/javascript">QU('criogen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=criogen" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>BoRoV пишет:<br>А причём тут это </I><br>Я думал если это сообщение срабатывает по таймеру, тот как-то этот же таймер берет информацию времени, через какое сработает вызов сообщения и выход или я не прав? И с чего следует начинать ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=269361&amp;user=26830&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=3" class="addthx" data-post="269361"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2010 16:24 <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
там скорее всего проверка по размеру на распакованость
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=269363&amp;user=15500&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=4" class="addthx" data-post="269363"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]criogen[/b]','')">criogen</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26830">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2010 16:43 <br><script type="text/javascript">QU('criogen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=criogen" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>BoRoV пишет:<br>там скорее всего проверка по размеру на распакованость </I><br>Скореей всего так и есть, но я думаю будет достаточно пропатчить сообщение и выход из программы.<br>P.S. спасибо, &quot;StrongOD&quot; помог.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=269366&amp;user=26830&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=5" class="addthx" data-post="269366"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2010 20:48 &middot; Поправил: ELF_7719116 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>criogen пишет:<br>Распакованная версия: (25 МБ) </I><br><img src="img/smilies/s11.gif" alt=""> даже если и в делфях, то это явный перебор!! Явно в программе висит длинный хвост от протектора.<br>Ставь точки останова на чтение кода в секции данных и по местам где патчил переходы на регистрацию.<br><br><I>работает как зарегистрированная</I> сама регистрация идет со стороны аспротекта или из самой программы ??
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=269398&amp;user=26651&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=6" class="addthx" data-post="269398"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2010 23:47 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>Явно в программе висит длинный хвост от протектора. </I><br>Да ладно. Никакого хвоста там нет. Просто куча ресурсов в exe, вы посмотрите сколько Word весит, там вообще нет протектора.<br><br><b>criogen</b><br>Распакованый exe надо было в rar пожать, нахрена 20 метров лишние качать?
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=269406&amp;user=3232&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=7" class="addthx" data-post="269406"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2010 00:39 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Очень интересная защита. Если ее писал автор этого софта, то снимаю шляпу. Хотя мне кажется это просто на заказ сделано. Там внутри лежит виртуальная длл antihack.dll программа ее сама размещает в памяти. Там длл выделяет память и копирует туда базонезависимый код. Код получает все нужные API функции напрямую читая их из системных библиотек. Причем использует он практически только ntdll Zw функции. Потом создает поток и там дергает ZwDelayExecution с продолжительным интервалом. Ну а дальше всё банально ZwCreateFile, ZwReadFile... MessageBoxA Если честно я даже не знаю как там патчить, наверное найти в базонезависимом коде нужную сигнатуру и поискать ее в файле.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=269408&amp;user=3232&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=8" class="addthx" data-post="269408"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]criogen[/b]','')">criogen</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26830">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 ноября 2010 18:52 &middot; Поправил: criogen <br><script type="text/javascript">QU('criogen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=criogen" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Ничего не получается <img src="img/smilies/s9.gif" alt=""> я её и так и сяк... Кстати файл с цифровой подписью, она её проверяет при загрузке? Очень нужна ваша помощь и советы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=269881&amp;user=26830&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=9" class="addthx" data-post="269881"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 ноября 2010 11:19 &middot; Поправил: ELF_7719116 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>вы посмотрите сколько Word весит, там вообще нет протектора </I><br>У меня winword.exe чуть больше 300 кбайт занимает. Сложно не согласиться, что протекторами там все таки нету <img src="img/smilies/s5.gif" alt=""><br><I>PE_Kill пишет:<br> всё банально ZwCreateFile, ZwReadFile </I><br>А что мешает положить оригинальный EXE в туже папку, внедрить X-Code injection - пропатчить ZwCreateFile, чтобы он указывал путь на оригинал и пусть защита его проверяет на здоровье (как с protect.dll) ? <br>1: Мне просто после SecuRom&#039;а 7 неинтересно чего-то более в отладчик загружать <img src="img/smilies/s1.gif" alt=""><br><I>Кстати файл с цифровой подписью, она её проверяет при загрузке? </I><br>Я думаю она поступает проще-проверяет контрольную сумму. Хотя...смотреть над, но GOTO 1:
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=269909&amp;user=26651&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=10" class="addthx" data-post="269909"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 ноября 2010 13:06 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>У меня winword.exe чуть больше 300 кбайт </I><br>Спутал. EXCEL.EXE - почти 18 мегабайт.<br><br><I>ELF_7719116 пишет:<br>А что мешает положить оригинальный EXE в туже папку, внедрить X-Code injection </I><br>Ничто не мешает, лично я так не делаю, т.к. это слишком уныло. Как сделает автор - ему решать.<br><br><I>ELF_7719116 пишет:<br>Хотя...смотреть над, но GOTO 1:  </I><br>Если ты прот то его там нет, всё банально.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=269912&amp;user=3232&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=11" class="addthx" data-post="269912"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]criogen[/b]','')">criogen</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26830">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 ноября 2010 19:25 &middot; Поправил: criogen <br><script type="text/javascript">QU('criogen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=criogen" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Я поковырял её  и вот какие вопросы возникли:<br>1. В програме для ZwCreateFile передаеться ссылка на него UNICODE &quot;<u>\Device\HarddiskVolume1\cah\Manager.exe</u>&quot;. Для этого вызываеться ZwQueryVirtualMemory. Как можно подменить строчку? есть ли какой-то готовый лоадер который может её перехватить и заменить на другую? <br><br>2. Выделяется VirtualAlloc 200h памяти 2 блока, в один из них идет чтение из файла.  Я прикрепил содержание то что в один заполняется. Такой последовательности байтов в распакованном вообще, а в запакованом есть, я думаю что это  всетаки цифровая подпись потому что чуть дальше идет VeriSign Time Stamping Services Signer .... и это все находиться в конце файла. Можно как-то подписать распакованый файл? <br><br><br><br><img src="img/attach.gif" alt=""> <a href="./files/cb24_12.11.2010_CRACKLAB.rU.tgz">cb24_12.11.2010_CRACKLAB.rU.tgz</a> - dump1.txt
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=269933&amp;user=26830&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=12" class="addthx" data-post="269933"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]criogen[/b]','')">criogen</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26830">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 ноября 2010 12:50 &middot; Поправил: criogen <br><script type="text/javascript">QU('criogen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=criogen" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>А что мешает положить оригинальный EXE в туже папку, внедрить X-Code injection - пропатчить ZwCreateFile, чтобы он указывал путь на оригинал и пусть защита его проверяет на здоровье (как с protect.dll) ? </I><br>А можно ссылку? Я не нашел информации об этом. Если будет с примером будет вообще отлично!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=270164&amp;user=26830&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=13" class="addthx" data-post="270164"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 ноября 2010 13:36 &middot; Поправил: ELF_7719116 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>PE_Kill</b> не будем вдаваться в тонкости! <img src="img/smilies/s1.gif" alt=""><br><br><b>criogen</b><br>По существу! Собственно &quot;как подменить строчку&quot;, т.е. заинжектить ZwCreateFile !<br>Рабочего варианта на ассемблере я не смог у себя найти, поэтому сшил на VС++ на скорую руку.<br>Идея вообщем-то проста: структура процедуры ZwCreateFile и остальных ей подобных обверток в ntdll имеет вид:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">7C82743F</span>&nbsp;&nbsp;&nbsp;&nbsp;B8&nbsp;<span class="hl_number">8D000000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">8D</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;ID вызываемой низкоуровневой функции</span></li><li class="hl_l1"><span class="hl_number">7C827444</span>&nbsp;&nbsp;&nbsp;&nbsp;BA&nbsp;<span class="hl_number">0003FE7F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_number">7FFE0300</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; указатель на ntdll.KiFastSystemCall</span></li><li class="hl_l0"><span class="hl_number">7C827449</span>&nbsp;&nbsp;&nbsp;&nbsp;FF12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDX</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; ntdll.KiFastSystemCall</span></li><li class="hl_l1"><span class="hl_number">7C82744B</span>&nbsp;&nbsp;&nbsp;&nbsp;C2&nbsp;<span class="hl_number">1800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RETN</b></span>&nbsp;<span class="hl_number">18</span></li>        </ol>
    </div>
</div></div>
<br>Есть несколько вариантов, но в данной ситуации лучшим будет пропатчить операнд по адресу 7C827444h, который укажет на наш лоадер, осуществим перестановку аргумента, а после из лоадера   прыгнем в KiFastSystemCall.<br>Учитвая, что наш &quot;лоадер&quot; будет ловить все вызовы ZwCreateFile, то логично поставить фильтр, который подменяет строку только в требуемом нами случае. Чтобы не париться со сравнением строк, пойдем в обход - сравним адрес возврата, если вызов не из системной библиотеки, &quot;лоадер&quot; приходит к несложному выводу, что это защтный механизм! Самое время послать его куда надо. <img src="img/smilies/s3.gif" alt=""><br>Сишный код будет выглядить следующем образом (заранее извиняюсь, если есть косяки, но в конечном случае вы обработаете его напильником для себя; требуется конечную строку перегнать в юникод; не забудьте что переменные НЕ должны размещаеться стеке!):<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCHAR&nbsp;CurrentDirectory<span class="hl_char">[</span><span class="hl_number">255</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCHAR&nbsp;Original_File_Name<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;\ORIGINAL_FILE.EXE&quot;</span><span class="hl_comment">; //собственно целевой оригинальный файл</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCHAR&nbsp;Prefix<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;\\??\&quot;</span><span class="hl_comment">; //префикс для Zw: \\??\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FARPROC&nbsp;KiFastSysRet_Address<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;Our_Sattelite_Operand<span class="hl_comment">; //адрес нашего &quot;лоадера&quot;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPDWORD&nbsp;Our_UNICOODE_Retail_String<span class="hl_comment">; //указатель на окончательную строку</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">HINSTANCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GMH&nbsp;<span class="hl_char">=</span>&nbsp;GetModuleHandle<span class="hl_char">(</span><span class="hl_quote">&quot;NTDLL&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;OldProt&nbsp;<span class="hl_char">=</span>&nbsp;0x60000020<span class="hl_comment">; // маска READ_EXECUTE для секции</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetCurrentDirectory<span class="hl_char">(</span><span class="hl_number">255</span><span class="hl_char">,</span>CurrentDirectory<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcat<span class="hl_char">(</span>CurrentDirectory<span class="hl_char">,</span>Original_File_Name<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcat&nbsp;<span class="hl_char">(</span>Prefix<span class="hl_char">,</span>CurrentDirectory<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;GMH<span class="hl_char">,</span>&nbsp;0x1000&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>НАЧАЛО&nbsp;СЕКЦИИ&nbsp;<span class="hl_char">.</span>text&nbsp;в&nbsp;NTDLL</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;VirtualProtect<span class="hl_char">(</span>GMH<span class="hl_char">,</span>0x27000<span class="hl_char">,</span>PAGE_EXECUTE_READWRITE<span class="hl_char">,</span><span class="hl_char">&amp;</span>OldProt<span class="hl_char">)</span><span class="hl_comment">; //Доступ на запись в секцию кода</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>SUB</b></span>&nbsp;GMH<span class="hl_char">,</span>&nbsp;0x1000&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>ОБРАТНО&nbsp;В&nbsp;HINSTANCE</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;GetProcAddress<span class="hl_char">(</span>GMH<span class="hl_char">,</span><span class="hl_quote">&quot;ZwCreateFile&quot;</span><span class="hl_char">)</span><span class="hl_comment">; </span></li><li class="hl_l0">&nbsp;&nbsp;__asm</li><li class="hl_l1">&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span>&nbsp;0x6&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>СМЕЩАЕМСЯ&nbsp;НА&nbsp;АДРЕС&nbsp;ОПЕРАНДА&nbsp;ДЛЯ&nbsp;KiFastSystemCall&nbsp;<span class="hl_char">(</span><span class="hl_number">5</span>&nbsp;байт&nbsp;первая&nbsp;инструкция&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span>&nbsp;байт<span class="hl_char">-</span>идентефикатор&nbsp;следующей<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>СЧИТЫВАЕМ&nbsp;DУКАЗАТЕЛЬ&nbsp;ОПЕРАНД</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>ПОЛУЧАЕМ&nbsp;НЕПОСРАДЕТСВЕННО&nbsp;АДРЕС&nbsp;KiFastSystemCall</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;KiFastSysRet_Address<span class="hl_char">,</span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">/</span><span class="hl_char">/</span>СОХРАНЯЕМ&nbsp;ЕГО&nbsp;У&nbsp;СЕБЯ</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span>&nbsp;Our_Sattelite&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>ПОЛУЧИМ&nbsp;СМЕЩЕНИЕ&nbsp;ДЛЯ&nbsp;НАШЕГО&nbsp;ЛОАДЕРА</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;Our_Sattelite_Operand<span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>EDI</b></span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>ПОРТИМ&nbsp;В&nbsp;РЕГИСТР</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span>&nbsp;Our_Sattelite_Operand&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>ПОЛУЧАЕМ&nbsp;СМЕЩЕНИЕ&nbsp;ДЛЯ&nbsp;УКАЗАТЕЛЯ<span class="hl_char">,</span>&nbsp;ЧТОБ&nbsp;ПРОИГРАТЬ&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;В&nbsp;NTDLL</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>EDI</b></span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>МЕНЯЕМ&nbsp;ОПЕРАНД</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span>&nbsp;Prefix&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>АДРЕС&nbsp;КОНЕЧНОЙ&nbsp;СФОРМИРОВАННОЙ&nbsp;СТРОКИ</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;Our_UNICOODE_Retail_String<span class="hl_char">,</span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;Exit_</li><li class="hl_l1">Our_Sattelite<span class="hl_char">:</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>ЕСЛИ&nbsp;Я&nbsp;ПРАВИЛЬНО&nbsp;ПОНЯЛ<span class="hl_char">,</span><span style="word-break: break-all">&nbsp;ТО&nbsp;ЗАЩИТНЫЙ&nbsp;МЕХАНИЗМ&nbsp;ОБИТАЕТ&nbsp;В&nbsp;АЛЛОЧНОЙ&nbsp;ПАМЯТИ&nbsp;И&nbsp;ВЫЗЫВАЕТ&nbsp;NativeAPI&nbsp;НАПРЯМУЮ</span><span class="hl_char">,</span><span style="word-break: break-all">&nbsp;ТОГДА&nbsp;В&nbsp;ФИЛЬТРЕ&nbsp;МОЖНО&nbsp;ЗАДАТЬ&nbsp;НИЖНЕЕ&nbsp;ЗНАЧЕНИЕ&nbsp;С&nbsp;КОТОРОГО&nbsp;ИДУТ&nbsp;СИСТЕМНЫЕ&nbsp;БИБЛИОТЕКИ</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;ВЫТАСКИВАЕМ&nbsp;АДРЕС&nbsp;ВОВЗРАТА</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span>&nbsp;0x7000000&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>ФИЛЬТРУЕМ&nbsp;ВЫЗОВЫ<span class="hl_char">,</span>&nbsp;НАЧАЛО&nbsp;АДРЕСНОГО&nbsp;ПРОСТРАНСТВА&nbsp;С&nbsp;СИСТЕМНЫМИ&nbsp;БИБЛИОТЕКАМИ</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JL</b></span>&nbsp;Less_CALL&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>ЕЕСЛИ&nbsp;АДРЕС&nbsp;ВОЗВРАТА&nbsp;ЛЕЖИТ&nbsp;НИЖЕ<span class="hl_char">,</span>&nbsp;ТО&nbsp;ВЕРОЯТНО&nbsp;ЭТО&nbsp;И&nbsp;ЕСТЬ&nbsp;НАШ&nbsp;КЛИЕНТ</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span>KiFastSysRet_Address<span class="hl_char">]</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>СТАНДАРТНОЕ&nbsp;ИСПОЛНЕНИЕ</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_registr"><b>EDI</b></span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>ПЕРЕХОД&nbsp;KiFastSystemRet</li><li class="hl_l1">Less_CALL<span class="hl_char">:</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span>0x8<span class="hl_char">]</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>ЕСЛИ&nbsp;МНЕ&nbsp;ПАМЯТЬ&nbsp;НЕ&nbsp;ИЗМЕНЯЕТ<span class="hl_char">,</span>&nbsp;ВТОРОЙ&nbsp;АРГУМЕНТ&nbsp;ZwCreateFile&nbsp;ЭТО&nbsp;LPDWORD&nbsp;НА&nbsp;ПУТЬ</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span>&nbsp;Our_UNICOODE_Retail_String</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span>0x8<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>EDI</b></span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>ПОДМЕНА&nbsp;ВТОРОГО&nbsp;АРГУМЕНТА</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span>KiFastSysRet_Address<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_registr"><b>EDI</b></span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>ПЕРЕХОД&nbsp;KiFastSystemRet</li><li class="hl_l0">Exit_<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=270167&amp;user=26651&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=14" class="addthx" data-post="270167"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2010 00:01 <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Парни, одумайтесь <img src="img/smilies/s2.gif" alt=""><br><br><noindex><a href="http://rghost.ru/3278944" rel="nofollow" target="_blank">http://rghost.ru/3278944</a></noindex>
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=270210&amp;user=2777&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=15" class="addthx" data-post="270210"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]criogen[/b]','')">criogen</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26830">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2010 14:51 &middot; Поправил: criogen <br><script type="text/javascript">QU('criogen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=criogen" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>daFix пишет:<br>Парни, одумайтесь </I><br>Ну так намного проще! У меня только несколько вопросов. <br><br>1. Как ты нашел это место, где пропатчил: <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">012313B7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_number">012313B9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0"><span class="hl_number">012313BA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;unk_12315B4</li><li class="hl_l1"><span class="hl_number">012313BF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">012313C2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l1"><span class="hl_number">012313C5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>off_12C780C</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_number">012313CA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">012313CD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">nop</span></li><li class="hl_l1"><span class="hl_number">012313CE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">nop</span></li><li class="hl_l0"><span class="hl_number">012313CF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>off_12CA80C</li><li class="hl_l1"><span class="hl_number">012313D4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li>        </ol>
    </div>
</div></div>
<br><br>2. После подключение к базе вылетает сообщение об ошибке и идет выход из программы.<br>Вот такое сообщение:<br>---------------------------<br>Microsoft Visual C++ Runtime Library<br>---------------------------<br>Runtime Error!<br>Program: C:\temp1\Managerfixed.exe<br>R6030<br>- CRT not initialized<br><br><br>Пробывал на двух компьютерах, она выскакивает. У меня вопрос, это только у меня такая ошибка может быть на обоих WinXP SP3? Причем на одном к компьютере когда подключаеться к одной базе нормально, к остальным эта ошибка вылазит.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=270242&amp;user=26830&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=16" class="addthx" data-post="270242"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2010 16:17 <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>criogen</b><br>Ошибка только на моём выскакивает?
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=270251&amp;user=2777&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=17" class="addthx" data-post="270251"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]criogen[/b]','')">criogen</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26830">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2010 16:33 &middot; Поправил: criogen <br><script type="text/javascript">QU('criogen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=criogen" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>daFix пишет:<br>criogen<br>Ошибка только на моём выскакивает? </I><br>Да. На распакованном и не патченом не вылазет. Если убрать эти патчи, тогда её тоже нет.<br> 1931736:	B0	55<br> 1931737:	01	8B<br> 1931738:	C3	EC<br> 1931790:	B0	FF<br> 1931791:	01	50<br> 1931792:	90	0C<br><br>Я посмотрел в Олли, эта функция вызывается 3 раза. <br>Ей в стек передаються :<br>12FF3C<br>12FD54 <br>12FB90
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=270253&amp;user=26830&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=18" class="addthx" data-post="270253"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2010 19:36 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>daFix</b><br>Одумались <img src="img/smilies/s1.gif" alt=""><br>Однако я думал, что существует проблема патчинга непосредственно кода защиты. Поэтому и предложил самое мощное решение.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=270261&amp;user=26651&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=19" class="addthx" data-post="270261"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2010 00:24 <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>criogen</b><br>Ну попробуй так. Если сработает, считай что повезло <img src="img/smilies/s5.gif" alt=""><br>rghost.ru/3291426
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=270280&amp;user=2777&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=20" class="addthx" data-post="270280"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]criogen[/b]','')">criogen</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26830">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2010 01:22 <br><script type="text/javascript">QU('criogen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=criogen" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>daFix пишет:<br>Ну попробуй так. Если сработает, считай что повезло </I><br>несработало <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=270285&amp;user=26830&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=21" class="addthx" data-post="270285"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2010 05:03 <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>criogen</b><br>Опиши на пальцах, как довести дело до ошибки? А то гадание на кофейной гущще - не айс
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=270292&amp;user=2777&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=22" class="addthx" data-post="270292"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]criogen[/b]','')">criogen</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26830">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2010 11:14 <br><script type="text/javascript">QU('criogen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=criogen" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>criogen пишет:<br>2. После подключение к базе вылетает сообщение об ошибке и идет выход из программы.Вот такое сообщение: </I><br>Просто подключиться к базе на MS Sql Server.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=270299&amp;user=26830&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=23" class="addthx" data-post="270299"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]criogen[/b]','')">criogen</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26830">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2010 11:34 &middot; Поправил: criogen <br><script type="text/javascript">QU('criogen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=criogen" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16954.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
Вот что в стеке:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0012EFFC</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">0239173A</span>&nbsp;&nbsp;RETURN&nbsp;to&nbsp;<span class="hl_number">0239173A</span>&nbsp;from&nbsp;<span class="hl_number">0239645F</span></li><li class="hl_l1"><span class="hl_number">0012F000</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">0000001E</span></li><li class="hl_l0"><span class="hl_number">0012F004</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">05222D40</span></li><li class="hl_l1"><span class="hl_number">0012F008</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00000001</span></li><li class="hl_l0"><span class="hl_number">0012F00C</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">02888F00</span></li><li class="hl_l1"><span class="hl_number">0012F010</span>&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_number">0012F030</span></li><li class="hl_l0"><span class="hl_number">0012F014</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">023B2370</span>&nbsp;&nbsp;RETURN&nbsp;to&nbsp;<span class="hl_number">023B2370</span>&nbsp;from&nbsp;<span class="hl_number">0239170B</span></li><li class="hl_l1"><span class="hl_number">0012F018</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">00000440</span></li><li class="hl_l0"><span class="hl_number">0012F01C</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">00404E6C</span>&nbsp;&nbsp;RETURN&nbsp;to&nbsp;MsManage<span class="hl_char">.</span><span class="hl_number">00404E6C</span>&nbsp;from&nbsp;MsManage<span class="hl_char">.</span><span class="hl_number">00404EC8</span></li><li class="hl_l1"><span class="hl_number">0012F020</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">00000001</span></li><li class="hl_l0"><span class="hl_number">0012F024</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">00405252</span>&nbsp;&nbsp;RETURN&nbsp;to&nbsp;MsManage<span class="hl_char">.</span><span class="hl_number">00405252</span></li><li class="hl_l1"><span class="hl_number">0012F028</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">05222D40</span></li><li class="hl_l0"><span class="hl_number">0012F02C</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">02888F00</span></li><li class="hl_l1"><span class="hl_number">0012F030</span>&nbsp;&nbsp;<span class="hl_char">]</span><span class="hl_number">0012F050</span></li><li class="hl_l0"><span class="hl_number">0012F034</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">007D0DA5</span>&nbsp;&nbsp;RETURN&nbsp;to&nbsp;MsManage<span class="hl_char">.</span><span class="hl_number">007D0DA5</span></li><li class="hl_l1"><span class="hl_number">0012F038</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">0012F058</span>&nbsp;&nbsp;Pointer&nbsp;to&nbsp;next&nbsp;SEH&nbsp;record</li><li class="hl_l0"><span class="hl_number">0012F03C</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">00405271</span>&nbsp;&nbsp;SE&nbsp;handler</li><li class="hl_l1"><span class="hl_number">0012F040</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">0012F050</span></li><li class="hl_l0"><span class="hl_number">0012F044</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">02888F00</span></li><li class="hl_l1"><span class="hl_number">0012F048</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">051FBB50</span></li><li class="hl_l0"><span class="hl_number">0012F04C</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">00000001</span></li><li class="hl_l1"><span class="hl_number">0012F050</span>&nbsp;&nbsp;<span class="hl_char">]</span><span class="hl_number">0012F074</span></li><li class="hl_l0"><span class="hl_number">0012F054</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">007FD213</span>&nbsp;&nbsp;RETURN&nbsp;to&nbsp;MsManage<span class="hl_char">.</span><span class="hl_number">007FD213</span>&nbsp;from&nbsp;MsManage<span class="hl_char">.</span><span class="hl_number">007D0D74</span></li><li class="hl_l1"><span class="hl_number">0012F058</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">0012F07C</span>&nbsp;&nbsp;Pointer&nbsp;to&nbsp;next&nbsp;SEH&nbsp;record</li><li class="hl_l0"><span class="hl_number">0012F05C</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">00405271</span>&nbsp;&nbsp;SE&nbsp;handler</li><li class="hl_l1"><span class="hl_number">0012F060</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">0012F074</span></li><li class="hl_l0"><span class="hl_number">0012F064</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">05222D40</span></li><li class="hl_l1"><span class="hl_number">0012F068</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">00426554</span>&nbsp;&nbsp;MsManage<span class="hl_char">.</span><span class="hl_number">00426554</span></li><li class="hl_l0"><span class="hl_number">0012F06C</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">05213170</span></li><li class="hl_l1"><span class="hl_number">0012F070</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_number">028C1680</span></li>        </ol>
    </div>
</div></div>
<br><br>А вот откуда оно вызывается:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0239171F</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B3D</span>&nbsp;<span class="hl_number">08E03B02</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">23BE008</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; ntdll.RtlAllocateHeap</span></li><li class="hl_l1"><span class="hl_number">02391725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">833D</span>&nbsp;<span class="hl_number">30A03C02</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">&gt;</span><span class="hl_function"><b>CMP</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">23CA030</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_number">0239172C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">75</span>&nbsp;<span class="hl_number">18</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JNZ</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">02391746</span></li><li class="hl_l1"><span class="hl_number">0239172E</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;D74E0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0239660A</span></li><li class="hl_l0"><span class="hl_number">02391733</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">1E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">1E</span></li><li class="hl_l1"><span class="hl_number">02391735</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">254D0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0239645F</span></li><li class="hl_l0"><span class="hl_number">0239173A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;FF000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0FF</span></li><li class="hl_l1"><span class="hl_number">0239173F</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">8C4A0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">023961D0</span></li><li class="hl_l0"><span class="hl_number">02391744</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">59</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ECX</span></li><li class="hl_l1"><span class="hl_number">02391745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">59</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ECX</span></li><li class="hl_l0"><span class="hl_number">02391746</span>&nbsp;&nbsp;&nbsp;&nbsp;A1&nbsp;<span class="hl_number">70A83C02</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">23CA870</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br>Если поменять jump то оно базу откроет, хоть и с двумя ошибка по чтению памяти. Если не править ту функцию то в [23CA030] находиться указатель на область памяти размером 4000h Access=RW.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=270300&amp;user=26830&amp;forum_n=5&amp;topic=16954.html&amp;page=0&amp;anchor=24" class="addthx" data-post="270300"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Программа после распаковки(crc?)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#25" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="16954">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=16954" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
