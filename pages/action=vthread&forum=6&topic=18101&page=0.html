<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Дизассемблер - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Добрый день. Я планирую написать небольшой дизассемблер + gui, с подключением плагинов через dll. Это велосипед, но всё таки хотелось бы иметь свой дизасм, который я смогу при желании править. Составляя диздок, наткнулся на">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=1288'>UniSoft</a>, <a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=7823'>ManHunter</a>, <a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Дизассемблер</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=18101&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=18101&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]vden[/b]','')">vden</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 112.9 (ветеран), 186thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.22'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=28841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 11:03 &middot; Поправил: vden <br><script type="text/javascript">QU('vden','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vden" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Добрый день.<br><br>Я планирую написать небольшой дизассемблер + gui, с подключением плагинов через dll. Это велосипед, но всё таки хотелось бы иметь свой дизасм, который я смогу при желании править.<br><br>Составляя диздок, наткнулся на спорные моменты, которые вы возможно поможете мне решить.<br><br><strike>1. основная проблема: как хранить исследуемую базу, учитывая что должны поддерживаться стат. браузинг и браузинг памяти (при отладке), с сохранением имён локаций и возможно др. метаданных.<br>у меня 2 варианта:<br>1а. на каждый байт свой дескриптор, (т.е. описывает код,данные,др) идеально для стат. браузера, но при браузинге памяти как-то cложно т.к. памяти может занять очень много<br>1б. на каждый регион памяти свой дескриптор, идеально для браузинга памяти,  для стат. бр. но при больших регионах. При маленьких регионах опять сложность: (попробуйте например в ida создать мегабайт однотипных оч. маленьких структур)<br><br>т.к. обычно не бывает оч.много мелких структур, я склоняюсь ко второму варианту, плюс он экономнее по объёмам памяти в общих случаях, но всё-таки хочется узнать мнение кодеров со скиллом возможно есть что-то проще и эффективнее?<br>думал над гибридным методом, но мне кажется это плохая идея.<br></strike><br>решено<br><br><strike>2. на чём писать? определённые наработки есть и на C и на Pascal, пытаюсь решить к чему-то одному это привести. <br>штука довольно узкопрофильная, тут думаю не так важно на чём. ядро планирую в виде dll (msvc или delphi/fpc), gui либо delphi/fpc, либо qt, кросплатформенность мне не нужна, поэтому тут пока остановился на delphi, т.к. gui контролы пишутся очень легко и быстро. если у кого есть опыт создания виджетов в qt, просветите насколько это проще/сложнее чем delphi.<br></strike><br>решено.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=282678&amp;user=28841&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=1" class="addthx" data-post="282678"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 12:23 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>vden пишет:<br>т.к. памяти может занять очень много </I><br>Сколько для Вас много? Начинающим кодером тоже этого боялся, старался всё экономить - да не стОит себя ограничивать! Мой дизасм, например, после распознавания всех ф-ций ноутпада и укладывания данных в структуры весит в памяти всего 8 мб с небольшим. Для каждой инструкции своя структура, структуры укладываются в блоки, блоки в блоки функций, функции в мапе.<br><br><I>vden пишет:<br>на каждый байт свой дескриптор </I><br>Если Вы не помечтать сюда пришли, а имеете реальный план, то должны знать, что лучший стиль - данные и код хранить в разных структурах. То, что в иде видно - это всего лишь видно. Что происходит внутри, когда Вы нажимаете на C, D, или U?...<br><br><I>vden пишет:<br>на чём писать? определённые наработки есть и на C и на Pascal, пытаюсь решить к чему-то одному это привести. </I><br>Есть наработки на C - оставьте Паскаль! Замучаетесь на Паскале то и дело преобразовывать из DWORD в DWORD* в MOD_RM_SIB*, обратно и так далее...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282680&amp;user=24257&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=2" class="addthx" data-post="282680"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 12:45 <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Это принципиально создавать свой движек дизасма, почему не заюзать существующие ?
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282681&amp;user=15500&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=3" class="addthx" data-post="282681"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]vden[/b]','')">vden</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 112.9 (ветеран), 186thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.22'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=28841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 13:01 &middot; Поправил: vden <br><script type="text/javascript">QU('vden','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vden" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Сколько для Вас много? </I><br>учитываем, что в базе храниться виртуальная память (т.е. секции так, как они будут замаппены [win или др.]-loader&#039;ом). до 500 мб я считаю нормально.<br>Например если по дескриптору на байт, то файл с общим вирт. размером 100 мб x 4 байта/дескриптор = уже 400 мб, а если ещё сделать дамп модулей из памяти и сохр. его в базе, будет немало<br><br>Регионом я называю участок памяти от VA0 до VA1 который содержит однородные данные.<br><br>Если описывать &quot;explored&quot;-регионы структурами, то Size = VirtSize + (StrucCount * SizeOf(Struc)), тут уже размер в основном зависит от размера структур и их количества + размер вирт. памяти. Структура грубо говоря декларирует начало,конец региона, что содержит: код/дата. Лейблы локаций в расчёт не берутся, их удобнее хранить в хешированном списке.<br>Если регионы будут &quot;длинными&quot;, то их будет не много, соотв. и размер небольшой. Но если много &quot;коротких&quot; регионов, размер будет увеличиваться значительно. <br>Вот в чём дилемма.<br><br><I>DenCoder пишет:<br>Если Вы не помечтать сюда пришли, а имеете реальный план, то должны знать, что лучший стиль - данные и код хранить в разных структурах. </I><br>В моём текущем плане с этим проблем не возникает пока) Весь декодинг &quot;сырой&quot; памяти будет происходить через &quot;datahandlers&quot;, т.е. по запросу юзера область помечается каким-то датахэндлером, грубо говоря назначается тип данных (или кода). А уже датахэндлер декодит байты, выдаёт текстовую и др. инфу.<br><br><I>DenCoder пишет:<br>Что происходит внутри, когда Вы нажимаете на C, D, или U? </I><br>хм, иду не реверсил))<br><br><I>BoRoV пишет:<br>Это принципиально создавать свой движек дизасма, почему не заюзать существующие ? </I><br>дело в том, что я хочу сделать немного больше чем просто дизасм, например отслеживание потока кода/данных, особенно в нестандартных exe, учитывание перекрывающихся переменных, вывод данных при помощи отдельных back-end&#039;ов, идей много. Возможно я упустил что-то уже такое opensource, буду рад ссылкам, не считая Olly
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=282683&amp;user=28841&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=4" class="addthx" data-post="282683"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 13:30 &middot; Поправил: BoRoV <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>vden</b> почему всё скомпилено без рантайма ? И почему не дизасмит ?
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282686&amp;user=15500&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=5" class="addthx" data-post="282686"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]vden[/b]','')">vden</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 112.9 (ветеран), 186thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.22'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=28841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 13:35 &middot; Поправил: vden <br><script type="text/javascript">QU('vden','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vden" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
без рантайма - просто такой выбор, +линкует моментально (это кстати в делфи плюс))<br><br>как такового дизасма сейчас нет, можно нажать D, выбрать code i386 (это дизасмит 1 инструкцию, никакого анализа сейчас нет, пока я не определюсь с оптимальным хранением данных)<br><br>UPD: сейчас это больше похоже на WinHex, но если сделать соответствующие datahandler&#039;ы и загрузчики, то можно отображать практически что угодно: ресурсы, диалоги...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=282687&amp;user=28841&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=6" class="addthx" data-post="282687"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Rustem[/b]','')">Rustem</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 74.1 (постоянный), 34thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.41'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1301">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 13:59 &middot; Поправил: Rustem <br><script type="text/javascript">QU('Rustem','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rustem" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>vden</b><br>если уж делать, сразу скрипт систему продумай, чтобы доступ был к структурам дизасма<br><br>и чтобы имена давать можно было функциям/переменным/структурам итп, комменты<br><br>ИМХО: Посмотри как в ида сделано, в общем. иначе писать кроме как для своег экспиренса смысла нет.<br>все равно все на иде сидят
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=282688&amp;user=1301&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=7" class="addthx" data-post="282688"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 14:28 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>vden пишет:<br>учитываем, что в базе храниться виртуальная память (т.е. секции так, как они будут замаппены [win или др.]-loader&#039;ом). до 500 мб</I><br><I>vden пишет:<br>файл с общим вирт. размером 100 мб </I><br>Где Вы видели такие? <img src="img/smilies/s1.gif" alt=""> Интересуют-то только секции кода и данных, инициализированных и неинициализированных. Зачем Вам по-крайней мере кучи, например? Если дизасм способен определить, где выделяется виртуальная память, где удаляется и сколько раз, то не значит, что надо обязательно всё то же самое проделывать. Хотя, воля Ваша...<br><br><I>BoRoV пишет:<br>Это принципиально создавать свой движек дизасма, почему не заюзать существующие ? </I><br>Писать на чьём-то движке - это:<br><i class=x>только тратить время на разбор ошибок, подгон кода под свой стиль, добавление своих полей в структуры и отладка всевозможных несогласовок!</i> Хотя, все в разной степени <strike>упёрты</strike> настойчивы, может и что-то выгорит. Только это исходник должен быть идеальный, а таких я не встречал... <br><br>И потом - на свои-то грабли приятнее наступать, чем на чужие <img src="img/smilies/s5.gif" alt=""><br><br><I>vden пишет:<br>никакого анализа сейчас нет, пока я не определюсь с оптимальным хранением данных</I><br>Определяйтесь. Всё на самом деле намного проще...<br><br>Дошло вроде. Вы хотите подгрузить все dll и их заодно проанализировать? <img src="img/smilies/s1.gif" alt=""> У меня сделано так, имеется потенциальная возможность анализа подгруженных dll, но зачем всё в оперативке держать? Когда надо - базу dll можно подгрузить. Со 100 мб всё-таки перегнули, столько не будет <img src="img/smilies/s1.gif" alt=""> Чаще всего размер всего образа с всеми образами подгруженных dll, <strike>даже если это 1C, </strike>(упс - она и правда жрёт до хрена <img src="img/smilies/s5.gif" alt=""> ) не превысит 40 МБ. Исключение может быть в случае 1С (порядка 127 МБ в папке + наверное, 50 мб системных)...<br><br><I>Rustem пишет:<br>если уж делать, сразу скрипт систему продумай, чтобы доступ был к структурам дизасма </I><br>Да. Доступ к структурам дизасма скорее достоинство. Скрипт - это легко прикрутить.<br><br><I>Rustem пишет:<br>и чтобы имена давать можно было функциям/переменным/структурам итп, комменты </I><br>Легко можно также прикрутить, добавив мапу соответствия. Главное - функционал, это основа основ, интерфейс - уже для удобства пользователя, которое нафиг не надо, если нет основы.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282690&amp;user=24257&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=8" class="addthx" data-post="282690"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]vden[/b]','')">vden</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 112.9 (ветеран), 186thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.22'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=28841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 15:20 &middot; Поправил: vden <br><script type="text/javascript">QU('vden','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vden" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>Rustem пишет:<br>если уж делать, сразу скрипт систему продумай </I><br>скрипты это хорошая идея<br><br><I>DenCoder пишет:<br>Где Вы видели такоие? </I><br>Согласен это редкость, но бывает. Ещё года 4 назад, игра &quot;черепашки ниндзя&quot; образ минимум 85 мб, после распаковки 5 мб, но вирт. память использовалась протектором, то ли для антидампа, сейчас не помню. Игры с solidshield если не ошибаюсь, тоже объёмные. А вообще размер взят как &quot;большой&quot;, т.е. на практике действительно будет меньше<br><br>Собственный дизасм-движок можно сделать, если например его структура/реализация будет выгодно отличаться.<br><br><I>DenCoder пишет:<br>Всё на самом деле намного проще... </I><br>не хочу спорить. попробуйте следующее, откройте в ida небольшой файл размером около 100 кб как бинарный и сделайте его массивом структур во весь размер файла<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#pragma&nbsp;pack<span class="hl_char">(</span><span class="hl_function">push</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l1">struct&nbsp;byte_t</li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;field_0<span class="hl_comment">;</span></li><li class="hl_l0">}<span class="hl_comment">;</span></li><li class="hl_l1">#pragma&nbsp;pack<span class="hl_char">(</span><span class="hl_function">pop</span><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br>это как демонстрация метода регионов. на практике если код прямо от компилятора, таких проблем нет, а если протектор разморфил вам код и раскидал его джампами или просто раскидал код, так что количество чанков в функции становится большим, скорость доступа к базе резко снижается, если использовать регионы. вот какбы эффективный метод с этим бороться я ищу. хотя может быть это только лишняя трата времени)<br><br>естественно не держать всю базу в памяти. маппинг.<br><br><br>Freeware Ida меня практически во всём устраивает, но есть неудобства, которые в своём дизасме я бы мог избежать. Например у структуры можно сделать базовое смещение (при чём переменное в различных участках кода), так чтобы если есть обращение [eax-4], было ясно что это длина строки. Т.е. смысл максимум автоматизации реверсинга, где это возможно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=282695&amp;user=28841&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=9" class="addthx" data-post="282695"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 15:29 &middot; Поправил: PE_Kill <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Замучаетесь на Паскале то и дело преобразовывать из DWORD в DWORD* в MOD_RM_SIB*, обратно и так далее...  </I><br>А в Си не надо что ли преобразовывать? Из всего, что видел только в php ниче не надо делать, там тебе еще и жопу вытрут.<br><br>ЗЫ А вообще вопрос ТС мне тоже интересен, правда больше в плане самомодификации кода. Дебажим файл, а он раскриптовывает код ниже, как быстро базу актуализировать и синхронизировать отображаемые данные.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282696&amp;user=3232&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=10" class="addthx" data-post="282696"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=21589" title="24-04-2011 12:03, ранг:93.7" target="_blank">_ruzmaz_</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]vden[/b]','')">vden</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 112.9 (ветеран), 186thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.22'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=28841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 15:41 &middot; Поправил: vden <br><script type="text/javascript">QU('vden','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vden" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>DenCoder  пишет:<br>DWORD в DWORD* в MOD_RM_SIB* </I><br>кстати в паскале можно сделать record с инлайн функциями, который выдаст op/mod/rm/s/i/b (аналог битовой структуры C, или же в fpc есть битовые структуры, наверно больше вопрос лени и кодингскилла)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=282697&amp;user=28841&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=11" class="addthx" data-post="282697"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 17:32 <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Дизасм корявый.<br><img src="http://rghost.ru/5310101/private/db6a0a1d4f75378aad2b1c817af43228/image.png" border="0" align="" alt=""><br><br>А должно так.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004019D5</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;A3&nbsp;<span class="hl_number">9C3B4000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_number">403B9C</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">EAX</span></li>        </ol>
    </div>
</div></div>
<br><br>ЗЫ. И скопировать нельзя.
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282700&amp;user=15500&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=12" class="addthx" data-post="282700"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 18:20 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>А в Си не надо что ли преобразовывать?  </I><br>В Си это проще )))<br><br><I>vden пишет:<br>откройте в ida небольшой файл размером около 100 кб как бинарный и сделайте его массивом структур во весь размер файла</I><br>ну зачем такой изврат - не пойму... Добавлять новые переменные надо по мере обращения к ним. В сложных случаях проводить бэк-трейс реверс анализ. Значение регистра или переменной в каком-то блоке зависит от другого значения или переменной - находим по референсам блок, изменяющий это значение, инструкцию. Если в инструкции регистр или переменная зависит также от еще значений, также ищем блок, инструкцию... и т.д. рекурсивно. По мере нахождения строим дерево, вершины которого будут решениями и укладываются в список. При нахождении инструкций вроде lea ecx, [edx + ecx * 4], определяем диапазон ecx и ставим тип &quot;таблица&quot; или &quot;массив&quot;. lea ecx, [edx + disp]  - имеем дело либо со структурой, где база - edx, либо указателем на массив или строку в одной из структур массива объектов структуры. И т.д.<br><br><I>vden пишет:<br>количество чанков в функции становится большим, скорость доступа к базе резко снижается </I><br>Каким образом, если есть блоки инструкций и структуры инструкций связаны между собой указателями? Не заметил что-то...<br><br><I>BoRoV пишет:<br>А должно так. </I><br>декодирование ModRMSib не реализовано, пока, видимо или не вызывается... сами скобки-то готовы )))<br>05 сложно декодировать? ))<br><br>помогу немного<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l1">SIB32</li><li class="hl_l0">без&nbsp;префикса&nbsp;<span class="hl_number">67</span></li><li class="hl_l1"><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l0">C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">|</span>&nbsp;C0&nbsp;&nbsp;&nbsp;&nbsp;r8<span class="hl_char">/</span>r32</li><li class="hl_l1"><span class="hl_number">04</span>&nbsp;&nbsp;<span class="hl_number">25</span>&nbsp;<span class="hl_char">|</span>&nbsp;C7&nbsp;<span class="hl_number">3F</span>&nbsp;<span class="hl_char">[</span><span class="hl_function">addr</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">04</span>&nbsp;n05&nbsp;<span class="hl_char">|</span>&nbsp;C7&nbsp;<span class="hl_number">07</span>&nbsp;<span class="hl_char">[</span>2^n&nbsp;<span class="hl_char">*</span>&nbsp;ri32&nbsp;<span class="hl_char">+</span>&nbsp;disp<span class="hl_char">(</span><span class="hl_function">addr</span><span class="hl_char">)</span><span class="hl_number">32</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">04</span>&nbsp;&nbsp;<span class="hl_number">20</span>&nbsp;<span class="hl_char">|</span>&nbsp;C7&nbsp;<span class="hl_number">38</span>&nbsp;<span class="hl_char">[</span>rb32<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">04</span>&nbsp;n00&nbsp;<span class="hl_char">|</span>&nbsp;C7&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_char">[</span>2^n&nbsp;<span class="hl_char">*</span>&nbsp;ri32&nbsp;<span class="hl_char">+</span>&nbsp;rb32<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">04</span>&nbsp;&nbsp;<span class="hl_number">20</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_number">07</span>&nbsp;<span class="hl_number">38</span>&nbsp;<span class="hl_char">[</span>rb32&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_function">none</span><span class="hl_char">/</span>disp8<span class="hl_char">/</span>disp<span class="hl_char">(</span><span class="hl_function">addr</span><span class="hl_char">)</span><span class="hl_number">32</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">04</span>&nbsp;n00&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_number">07</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_char">[</span>2^n&nbsp;<span class="hl_char">*</span>&nbsp;ri32&nbsp;<span class="hl_char">+</span>&nbsp;rb32&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_function">none</span><span class="hl_char">/</span>disp8<span class="hl_char">/</span>disp<span class="hl_char">(</span><span class="hl_function">addr</span><span class="hl_char">)</span><span class="hl_char">/</span><span class="hl_number">32</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">05</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">|</span>&nbsp;C7&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_function">addr</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span>r32&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_function">none</span><span class="hl_char">/</span>disp8<span class="hl_char">/</span>disp<span class="hl_char">(</span><span class="hl_function">addr</span><span class="hl_char">)</span><span class="hl_number">32</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li>        </ol>
    </div>
</div></div>
<br>алгоритм декодирования ModR/M_SIB сверху вниз<br>UPD. То есть слева значения этого поля, справа маска, по которой проверяем. Проверка начинается сверху вниз, шаг за шагом. Первое, что TRUE - и есть правильный вариант декодирования.<br><br><I>vden пишет:<br>смысл максимум автоматизации реверсинга, где это возможно </I><br>И я за это.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282704&amp;user=24257&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=13" class="addthx" data-post="282704"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 18:30 <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>DenCoder пишет:<br>декодирование ModRMSib не реализовано, пока, видимо или не вызывается... сами скобки-то готовы ))) </I><br>Не, это скорей всего неверно используется дизасм двиг. Как видно он быд настроен на х64 файлы.
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282706&amp;user=15500&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=14" class="addthx" data-post="282706"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]vden[/b]','')">vden</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 112.9 (ветеран), 186thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.22'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=28841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 18:33 &middot; Поправил: vden <br><script type="text/javascript">QU('vden','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vden" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>BoRoV пишет:<br>Дизасм корявый </I><br><br><I>DenCoder пишет:<br>помогу немного </I><br><br>Спасибо, ребята, за тестирование. Но это прототип. Скелет просто. Ещё нечего тестировать. Дизасм нормальный приделать, это не так сложно (там кстати справа синим верный дизасм), сейчас главная проблема, которую я хотел решить это ввод/вывод (в поисках идеи сюда и запостил). <br><br>А скобки левые, это после неудачных манипуляций с конверсией параметров BeaEngine, просто не стал уже трогать.<br><br><I>BoRoV пишет:<br>ЗЫ. И скопировать нельзя. </I><br>Контрол на который всё выводится - самописный, читает данные через API дизасма, копирования сейчас просто нет. Там если внимательно посмотреть можно ещё 100 багов найти.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=282707&amp;user=28841&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=15" class="addthx" data-post="282707"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 18:34 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>BoRoV пишет:<br>неверно используется дизасм двиг </I><br>Ах, так двиг не собственный? А я здесь распинаюсь... <img src="img/smilies/s7.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282708&amp;user=24257&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=16" class="addthx" data-post="282708"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]vden[/b]','')">vden</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 112.9 (ветеран), 186thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.22'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=28841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 18:41 &middot; Поправил: vden <br><script type="text/javascript">QU('vden','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vden" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Ах, так двиг не собственный? А я здесь распинаюсь...  </I><br>Двиг если и будет собственный (скорее всего будет нужен), то всё я думаю можно взять здесь http://ref.x86asm.net/<br>Я пока вижу смысл только в 2х двигах: intel x86/64 и ARM
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=282709&amp;user=28841&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=17" class="addthx" data-post="282709"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24257" title="24-04-2011 15:04, ранг:79.3" target="_blank">DenCoder</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 18:45 &middot; Поправил: BoRoV <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>vden пишет:<br>Я пока вижу смысл только в 2х двигах: intel x86/64 и ARM  </I><br>Да ты хоть один до ума доведи, тогда другие будет намного проще довешивать.<br><br>ЗЫ. Т.Г.Ш. на иконке понравился <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282710&amp;user=15500&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=18" class="addthx" data-post="282710"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 19:03 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>vden пишет:<br>Двиг если и будет собственный </I><br>Потом сложно будет dll, юзающую двиг подстраивать под свой. Такой эксперимент уже был... Дело Ваше!<br><br>За ссылку, кстати, спасибо! Может, пригодится...<br><br>UPD. Кстати, не запостил бы сюда и может, еще долго бы и не увидел, что алгоритм(таблицу) можно упростить <img src="img/smilies/s1.gif" alt=""><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l1">SIB32</li><li class="hl_l0">без&nbsp;префикса&nbsp;<span class="hl_number">67</span></li><li class="hl_l1"><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l0">C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">|</span>&nbsp;C0&nbsp;&nbsp;&nbsp;&nbsp;r8<span class="hl_char">/</span>r32</li><li class="hl_l1"><span class="hl_number">04</span>&nbsp;&nbsp;<span class="hl_number">25</span>&nbsp;<span class="hl_char">|</span>&nbsp;C7&nbsp;<span class="hl_number">3F</span>&nbsp;<span class="hl_char">[</span><span class="hl_function">addr</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">04</span>&nbsp;n05&nbsp;<span class="hl_char">|</span>&nbsp;C7&nbsp;<span class="hl_number">07</span>&nbsp;<span class="hl_char">[</span>2^n&nbsp;<span class="hl_char">*</span>&nbsp;ri32&nbsp;<span class="hl_char">+</span>&nbsp;disp<span class="hl_char">(</span><span class="hl_function">addr</span><span class="hl_char">)</span><span class="hl_number">32</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">04</span>&nbsp;&nbsp;<span class="hl_number">20</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_number">07</span>&nbsp;<span class="hl_number">38</span>&nbsp;<span class="hl_char">[</span>rb32&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_function">none</span><span class="hl_char">/</span>disp8<span class="hl_char">/</span>disp<span class="hl_char">(</span><span class="hl_function">addr</span><span class="hl_char">)</span><span class="hl_number">32</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">04</span>&nbsp;n00&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_number">07</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_char">[</span>2^n&nbsp;<span class="hl_char">*</span>&nbsp;ri32&nbsp;<span class="hl_char">+</span>&nbsp;rb32&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_function">none</span><span class="hl_char">/</span>disp8<span class="hl_char">/</span>disp<span class="hl_char">(</span><span class="hl_function">addr</span><span class="hl_char">)</span><span class="hl_char">/</span><span class="hl_number">32</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">05</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">|</span>&nbsp;C7&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_function">addr</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span>r32&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_function">none</span><span class="hl_char">/</span>disp8<span class="hl_char">/</span>disp<span class="hl_char">(</span><span class="hl_function">addr</span><span class="hl_char">)</span><span class="hl_number">32</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282711&amp;user=24257&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=19" class="addthx" data-post="282711"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2011 19:05 <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>vden пишет:<br>Возможно я упустил что-то уже такое opensource </I><br>Ну, неоднократно были попытки создать опенсорс аналог иды, всех я не знаю, но вот одна из них http://lida.sourceforge.net/
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282713&amp;user=15500&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=20" class="addthx" data-post="282713"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2011 06:41 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Только сейчас мысль дозрела добавить к дизасму блоки структур UNDEFINED_STRUCT, и карту для них для ускорения доступа. Только опять же на каждый байт излишне делать такие структуры! По мере распознавания функций(FUNC_MAP) и данных(VAR_MAP, STRING_MAP) блоки будут биться на части.<br><br>Также, считаю существенным недостатком многих дизасмов (судим по &quot;прототипам&quot; иды и олек) непредсказуемое поведение при встрече с &quot;двойниками&quot;. Не знаю, как их еще назвать, но я имею в виду такой код<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">01000000</span>&nbsp;EB&nbsp;<span class="hl_number">15</span>&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_number">01000017</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function">Entry</span><span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">01000016</span>&nbsp;EB&nbsp;E8&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_number">01000000</span></li><li class="hl_l0"><span class="hl_number">01000018</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">al</span></li><li class="hl_l1"><span class="hl_number">0100001A</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">al</span></li><li class="hl_l0"><span class="hl_number">0100001C</span>&nbsp;<span class="hl_number">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">eax</span></li>        </ol>
    </div>
</div></div>
<br><br>Что-то вроде этого можно встретить в некоторых закриптованных программах. На этом раньше ида ломалась и отказывалась дизасмить. Сейчас в таких случаях просто не показывает как надо <strike>и переносит в отдельные чанки, которые бывают и за пределами функции, в отдельном графе</strike>. (зачёркнутое немного из другой оперы, перепутал)<br>А код в принципе ничего больше, кроме как <br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;eip<span class="hl_comment">; 0100001C</span></li>        </ol>
    </div>
</div></div>
<br><br>Ладно, все знают, что нет такой инструкции <img src="img/smilies/s1.gif" alt=""> Пусть будет<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">E8&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_char">$</span><span class="hl_char">+</span><span class="hl_number">5</span></li><li class="hl_l1"><span class="hl_number">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">eax</span></li>        </ol>
    </div>
</div></div>
<br><br>Такой же тенденцией страдает и мой дизасм. Но я предлагаю добавить структуру ADJACENT_INSTRUCTION (смежная инструкция).<br><br>struct ADJACENT_INSTRUCTION<br>{<br>  BYTE Disp; //смещение относительно оригинала (в пределах длины инструкции-оригинала)<br>  INSTRUCTION* pCmd;<br>  ADJACENT_INSTRUCTION* pNext;//очень редко может быть еще одна смежная, но всё же<br>};<br><br>struct INSTRUCTION_LIST<br>{<br>  INSTRUCTION* pCmd;<br>  INSTRUCTION_LIST* pPrev;<br>  INSTRUCTION_LIST* pNext;<br>  ADJACENT_INSTRUCTION* pAdjacent;//В обычных условиях просто NULL<br>};<br><br>..................
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282749&amp;user=24257&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=21" class="addthx" data-post="282749"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Usulgurt[/b]','')">Usulgurt</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.28'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=28614">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2011 10:50 <br><script type="text/javascript">QU('Usulgurt','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Usulgurt" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Есть вообщем исходниках винды такая директория, возможно vden она тебе пригодится для разработки своих интерфейсов функций.<br><br>Windows_2000_source_code\private\windbg64\debugger\em\ia64dis.cpp<br><br>Кстати там написано, что дизасм юзает интеловский дизасм из библиотеки disem.dll. Может пригодится.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=282766&amp;user=28614&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=22" class="addthx" data-post="282766"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]vden[/b]','')">vden</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 112.9 (ветеран), 186thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.22'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=28841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2011 11:37 &middot; Поправил: vden <br><script type="text/javascript">QU('vden','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vden" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>DenCoder пишет:<br>излишне делать такие структуры </I> это меня и беспокоит<br><br><b>DenCoder</b> в твоём примере прыжок в середину инструкции и обычный дельта-трюк для получения eip. <br><br>если с
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_char">$</span><span class="hl_char">+</span><span class="hl_number">5</span><span class="hl_char">+</span>delta</li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_char">$</span><span class="hl_char">+</span><span class="hl_number">5</span><span class="hl_char">+</span>delta<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_function"><b>pop</b></span>&nbsp;reg</li>        </ol>
    </div>
</div></div>
<br>все отслеживается просто (практически идиома)<br>то с прыжком в середину инструкции, или в несуществующий код, сложнее, потому что дизасм сам не может &quot;понять&quot; что это бред а не код, можно попробовать сделать эвристику, т.е. например если в эта ветка заканчивается инвалидной инструкцией, то отменять всю ветку<br><br><b>Usulgurt</b>. Спасибо за участие. В исходниках винды действительно много интересного. Если говорить о дизасме, то сейчас по x32/x64 выбор есть Distorm, BeaEngine, Mediana, дизасм из Bochs, дизасм из VirtualBox. Голова кружиться, что брать и адаптировать или написать свой.<br><br>PS<br>В конце концов, если это называется &quot;базой данных&quot;, базы всегда требуют много памяти для норм. быстродействия. Так что тут я думаю определился, будет &quot;гибридное&quot; хранение (регионы и побайтовые дескрипторы, вообщем-то как и в ида. побайтовые дескрипторы или флаги всё таки нужны, чтобы метить свойства адреса, например имеет имя, комент)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=282770&amp;user=28841&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=23" class="addthx" data-post="282770"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]vden[/b]','')">vden</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 112.9 (ветеран), 186thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.22'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=28841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2011 12:21 <br><script type="text/javascript">QU('vden','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vden" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<i class=x><b>Кстати, ещё вопрос</b> как вы считаете макс. 65536 типов данных в одной базе будет достаточно или избыточно?</i><br><br>Anterior, Posterior lines реально нужны? Или достаточно коментов.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=282771&amp;user=28841&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=24" class="addthx" data-post="282771"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Usulgurt[/b]','')">Usulgurt</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.28'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=28614">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2011 13:08 <br><script type="text/javascript">QU('Usulgurt','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Usulgurt" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>vden пишет:<br>Спасибо за участие.  </I><br><br>Кстати есть ещё такой крутой дизасм как beye там тоже открытые исходники для х32 и х64.<br><br>Я офигел когда увидел, что он проходит тест на 4000 разношорстные инструкции. Вплоть до криптоинструкций и использования регистра tr0, о которых в мануале интела не написано что-то. Но под винду я так и не смог его быстро скомпилировать пришлось много и долго переделывать, хотя заявлено, что можно скомпилировать.<br><br>Если что выкладывай сюда xml описывающий данные для отображения в dizasme, народ чтонить добавит.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=282772&amp;user=28614&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=25" class="addthx" data-post="282772"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2011 16:00 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>vden пишет:<br>потому что дизасм сам не может &quot;понять&quot; что это бред а не код </I><br>В проведённых экспериментах, когда и нет явных прыжков, а используются непосредственные операнды размером 4 байта, выявлено, что для юзермода что пробовать дизасмить строку, что дизасмить данные - огромный процент около 90% что в числе 5 инструкций будет запрещенная для юзермода, и процент поменьше, около 10, что будет прыжок или кол за пределы кодовой секции или образа вообще. Для этого у меня предусмотрены пока 3 константы:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">ERROR_UNRECOGNIZED_COMMAND</li><li class="hl_l1">ERROR_UNSUPPORTED_COMMAND</li><li class="hl_l0">ERROR_INVALID_JMP</li>        </ol>
    </div>
</div></div>
<br><br>Но есть, конечно, очень малый процент вероятности, что будет прыжок в один из уже распознанных блоков... Выход - дописывать анализатор.<br><br><I>vden пишет:<br>Кстати, ещё вопрос как вы считаете макс. 65536 типов данных в одной базе будет достаточно или избыточно? </I><br>Не понимаю, о чём Вы. Вы знаете, что такое динамические структуры данных?<br><br><I>vden пишет:<br>Anterior, Posterior lines реально нужны? Или достаточно коментов. </I><br>Видели Ida 5.5 в режиме графа? Нужны они там?
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282788&amp;user=24257&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=26" class="addthx" data-post="282788"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2011 16:14 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>Usulgurt</b><br>Вот примеры инструкций для теста:<br><noindex><a href="https://sourceforge.net/projects/mediana/files/tests.bin/" rel="nofollow" target="_blank">mediana/files/tests.bin</a></noindex>
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282790&amp;user=1379&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=27" class="addthx" data-post="282790"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2011 16:17 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<I>Usulgurt пишет:<br>Вплоть до криптоинструкций </I><br>AES что ль? Написано всё.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282791&amp;user=24257&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=28" class="addthx" data-post="282791"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2011 16:19 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<I>DenCoder пишет:<br>В Си это проще ))) </I><br>Чем? Друдновыговариваемой директивой? Если руки не из жопы растут, то сложность 1 в 1, за исключением битовых полей.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282794&amp;user=3232&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=29" class="addthx" data-post="282794"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2011 16:37 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=18101&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>сложность 1 в 1 </I><br>Хорошо, возможно по дельфи я даже не троечник <img src="img/smilies/s1.gif" alt=""> Но как тогда будет на дельфи выглядеть аналог ниже?<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">IMAGE_DOS_HEADER<span class="hl_char">*</span>&nbsp;pdh<span class="hl_comment">;</span></li><li class="hl_l1">IMAGE_NT_HEADERS<span class="hl_char">*</span>&nbsp;pNt<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">pdh&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>IMAGE_DOS_HEADER<span class="hl_char">*</span><span class="hl_char">)</span>pImage<span class="hl_char">-</span><span class="hl_char">&gt;</span>hModule<span class="hl_comment">;</span></li><li class="hl_l0">pNt&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>IMAGE_NT_HEADERS<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>pImage<span class="hl_char">-</span><span class="hl_char">&gt;</span>hModule&nbsp;<span class="hl_char">+</span>&nbsp;pdh<span class="hl_char">-</span><span class="hl_char">&gt;</span>e_lfanew<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=282795&amp;user=24257&amp;forum_n=6&amp;topic=18101&amp;page=0&amp;anchor=30" class="addthx" data-post="282795"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=18101&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=18101&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Дизассемблер</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=18101" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
