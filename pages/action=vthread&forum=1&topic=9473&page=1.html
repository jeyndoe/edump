<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Статья SafeDisk 4.6 - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Вот распаковав этот протектор решил написать свою вторую статью. Прежде всего я хотел бы услышать мнения по ней, а также неточности, ошибки. Сам прот снимал с игры Цивилизация 4 Вот ссылка:">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Статья SafeDisk 4.6</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=1&amp;topic=9473&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=1&amp;topic=9473&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]VaZeR[/b]','')">VaZeR</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/6065.jpg" alt=""><br><span class=txtSm>Ранг: 88.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.91'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6065">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 июля 2007 11:54 <br><script type="text/javascript">QU('VaZeR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VaZeR" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Вот распаковав этот протектор решил написать свою вторую статью. Прежде всего я хотел бы услышать мнения по ней, а также неточности, ошибки. Сам прот снимал с игры Цивилизация 4<br>Вот ссылка: rapidshare.com/files/45119414/SD.rar.html
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=148518&amp;user=6065&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=1" class="addthx" data-post="148518"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 июля 2007 14:35 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
<b>VaZeR</b><br>Я тут ещё раз глянул насчёт антиотладки.<br>Там ведь не только эта константа фигурирует.Как я уже говорил,значение регистра dr7 -- этот механизм кстати,по-моему,используется самым первым и палит отладчик на сто процентов(ну,если только ntice.sys не был пропатчен).<br>Далее там существует ещё одна сигнатура: 58803194/58811284.<br>Так что придётся ещё патчить.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=148811&amp;user=1613&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=2" class="addthx" data-post="148811"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]VaZeR[/b]','')">VaZeR</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/6065.jpg" alt=""><br><span class=txtSm>Ранг: 88.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.91'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6065">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 июля 2007 15:23 <br><script type="text/javascript">QU('VaZeR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VaZeR" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
У меня помойму проверка dr7 осуществляется в самой первой проверке где сосредоточены ring 3. Там в конце и есть вызов драйвера. Насчёт твоих констант, я такие первый раз вижу. Но я проверу в драйвере их, есть ли они. Игра у меня нормально запускается. Нужно только обходить первую проверку, а так все ОК.<br>Я сейчас только нашёл Trigger table. Теперь попробую восстановить их.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=148820&amp;user=6065&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=3" class="addthx" data-post="148820"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]VaZeR[/b]','')">VaZeR</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/6065.jpg" alt=""><br><span class=txtSm>Ранг: 88.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.91'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6065">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 июля 2007 15:24 <br><script type="text/javascript">QU('VaZeR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VaZeR" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
Кстати игру я уже прошёл и вроде бы все нормально работает и без trigger table.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=148821&amp;user=6065&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=4" class="addthx" data-post="148821"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]VaZeR[/b]','')">VaZeR</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/6065.jpg" alt=""><br><span class=txtSm>Ранг: 88.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.91'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6065">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 июля 2007 19:10 <br><script type="text/javascript">QU('VaZeR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VaZeR" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
Да действительно в драйвере есть эти константы, но возможно они не всегда используются. <br><br>.text:00011888                 cmp     [ebp+var_8], 587C1194h<br>.text:0001188F                 jnz     short loc_11894<br>.text:00011894                 add     ebx, 84h<br>.text:000118A8                 test    eax, eax<br>.text:000118AA                 jnz     short loc_118B7<br>.text:000118AC                 mov     eax, [ebp+arg_8]<br>.text:000118AF                 mov     dword ptr [eax], 58811284h<br>.text:000118B5                 jmp     short loc_118C4<br>.text:000118B7                 mov     ecx, [ebp+arg_8]<br>.text:000118BA                 shl     eax, 0Fh<br>.text:000118BD                 or      eax, 58803194h<br>.text:000118C2                 mov     [ecx], eax<br>.text:000118C4                 mov     eax, [ebp+arg_C]<br><br>DillerInc ты можеш написать какая именно из констант означает, что отладчик обнаружен?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=148849&amp;user=6065&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=5" class="addthx" data-post="148849"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 июля 2007 23:18 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
<I>VaZeR пишет:<br>какая именно из констант означает, что отладчик обнаружен? </I><br>...та что 58811284 означает,что отладчик не обнаружен.<br><br>Я тут начал долбать наномиты.У меня возник вопрос насчёт определения адреса,куда записываются кэшируемые значения адресов наномитов.Так вот для нахождения этого адреса ты подсовываешь левые адреса в [esp+24h] или же адреса настоящих наномитов??Я как-то не могу так определить этот адрес,куда прописываются кешируемые адреса.Можешь как-то прокомментировать??<br><br>Кстати,структура,содержащая зашифрованную информацию про наномит,имеет размер восемь DWORD&#039;ов, т.е. 32 десятичных байта,а не 16 как ты написал в статье.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=148883&amp;user=1613&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=6" class="addthx" data-post="148883"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]VaZeR[/b]','')">VaZeR</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/6065.jpg" alt=""><br><span class=txtSm>Ранг: 88.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.91'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6065">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 июля 2007 04:43 <br><script type="text/javascript">QU('VaZeR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VaZeR" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
DillerInc Адреса можешь подавать любые, так как все они кэшируются. <br>Чтобы найти эту секцию можно идти от условного перехода, который отвечает за &quot;правильность наномита&quot;, но в любом случае откуда бы не начав копать код, все ниточки ведут к этой секции.<br>Также можно поискать твои адреса во всей области памяти. Там их не должно быть много. <br>После, тебе нужно отловить запись, которая идёт со смешение. Прокрути несколько адрессов, а потом посмотри где они у тебя записались. Тебе нужно такое место где с каждым адресом записывается 8 dword данных. Скорее всего это запись которая осуществляется последней. <br><br>Спасибо насчёт 16 и 32. Это я ошибся когда писал.<br><br>Восстановил я Trriger table, но вот не понял почему нужно именно так оформлять таблицу? Сама у меня только одна trriger table. Там если одна структура то все три указателя на неё будут одинаковыми. <br>Также посмотрел я ещё и версию драйвера. У меня она 4.0. Возможно он одинаковый для всех версий протектора. Посмотри какая версия у тебя.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=148894&amp;user=6065&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=7" class="addthx" data-post="148894"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]VaZeR[/b]','')">VaZeR</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/6065.jpg" alt=""><br><span class=txtSm>Ранг: 88.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.91'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6065">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 июля 2007 04:48 <br><script type="text/javascript">QU('VaZeR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VaZeR" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
Если константа 58811284 отвечает, что отладчик не обноружен, то в драйвере нужно занопить условный переход по адресу 118AA (в приведёном листинге). В какой именно игре она используется?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=148895&amp;user=6065&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=8" class="addthx" data-post="148895"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 июля 2007 09:45 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<I>VaZeR пишет:<br>Восстановил я Trriger table, но вот не понял почему нужно именно так оформлять таблицу? </I><br>...это спрашивай у каких-нибудь команд типа Reloaded,я,честно говоря,сам не знаю,почему именно так.<br><br>У меня версия драйвера 4.0.60.0.<br>Константа эта использовалась,если не ошибаюсь,в игре Call of Duty (SD 3.10.20).<br><br>В общем,каким-то образом я нашёл примерный регион,куда кешируются эти адреса.Потом нашёл все четыре условных перехода.<br>Если что,то я смотрю игру Call of Duty 2 -- там тоже SD 4.60, только похоже не Advanced.<br><br>И теперь у меня самый глупый наверно вопрос: когда необходимо передавать управление на пропатченый код??
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=148905&amp;user=1613&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=9" class="addthx" data-post="148905"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]VaZeR[/b]','')">VaZeR</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/6065.jpg" alt=""><br><span class=txtSm>Ранг: 88.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.91'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6065">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 июля 2007 10:32 <br><script type="text/javascript">QU('VaZeR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VaZeR" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
Ну если ты нашёл все места в программе, которые нужно пропатчить то перезагрузи программу. Опять пропатч всё как надо, а далее как управление перейдёт к тебе в OllyDbg так и запускай. Разницы особой нет. Так как тебе нужна просто восстановленая секция кода, которую ты можешь уже вставить в свой дамп. <br>Настёт trigger table не всё так просто как кажется. Там где находится код ответственный за обработку структурных данных тоже имеется ужё третий оператор CASE со 16 ветвлениями. По умолчанию я иду по 9 -тому. Но кода там очень много. Поэтому однозначно сказать, что там такое происходит довольно трудно. А если есть ветвления значит и таблицы могут быть не всегда одинаковыми. <br>Если с 64 таблицами мне было понятно как этот код действует. То с этими таблицами не как не могу понять как они работают. <br>Ещё вопрос ты когда востанавливаешь trigger table то у тебя тот код нормально работают не вылетают не какие ошибки? Ты просто ставишь eip на SDAPI и начинаешь трасировать и таким образом доходишь до места где берутся указатели на массив SafeDisk тот который в выделеной памяти?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=148911&amp;user=6065&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=10" class="addthx" data-post="148911"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 июля 2007 10:59 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
<I>VaZeR пишет:<br>Ты просто ставишь eip на SDAPI и начинаешь трасировать и таким образом доходишь до места где берутся указатели на массив SafeDisk тот который в выделеной памяти? </I><br>...что-то я уже и не помню(давно это было).По-моему,можно было брякнуться в каком-то месте после OEP,где обрабатывались эти таблицы, т.е. ситуация с таблицей тогда должна была быть верной,раз обращение к ней происходило в общем ходе выполнения программы.Естественно,что предварительно нужно было найти в секции кода место,где идёт обращение к таблице.Тогда в <u>шестнадцатом</u> обработчике можно было найти указатель на выделенную память.А если мы находим один указатель,то мы тут же находим и все остальные,если они есть.<br><br>Кстати,с этой олькой у меня постоянно падал отладчик протектора.В конце концов,я забил на неё и отладил всё это дело SoftICE.<br><br>Вроде удалось восстановить наномиты следующим образом:<br>Я сделал так,что поймал отладчик,когда он возвращается из функции WaitForDebugEvent, т.е. я отпустил защищённую программу с OEP.Потом начал потихоньку патчить.Дал выполнится функции ContinueDebugEvent,затем пропатчил её.И уже тогда стал выполнятся наш исправительный код,так сказать,в полном смысле.Вроде все наномиты восстановились,сколько я смог проверить.<br>Иначе я не знаю,<u>когда</u> можно более грамотно запускать наш код.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=148914&amp;user=1613&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=11" class="addthx" data-post="148914"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]VaZeR[/b]','')">VaZeR</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/6065.jpg" alt=""><br><span class=txtSm>Ранг: 88.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.91'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6065">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 июля 2007 12:19 <br><script type="text/javascript">QU('VaZeR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VaZeR" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
Функцию ContinueDebugEvent можно и не выполнять зачем она нужна. Как вышел с WaitForDebugEvent вписал патч и запустил. В смысле падает, завершает работу или какой - нибудь сбой при записи или ещё что то. Если завершает приложение то там в том коде, насколько я понял только один выход это после проверки функции ContinueDebugEvent там ещё посмотри. <br>Я сам делал так, чтобы снять в последствии дамп на OEP то я вместо цикла EBFE  вписал CCCC тем самым программа вообще не будет выполнять свой код. Потом когда попал остановился на выходе WaitForDebugEvent с адресом OEP затем вписываю патч и запускаю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=148922&amp;user=6065&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=12" class="addthx" data-post="148922"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 июля 2007 14:26 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<b>VaZeR</b><br>Распаковал я этот Call of Duty 2.Восстановил сначала импорт и прочие хитрости с помощью патча,размещённого в заголовке файла.Переход туда я сделал после того,как игра была зациклена на прыжке на OEP.Потом просто выполнил любой произвольный наномит,ну а дальше как я уже описывал выше.<br><br>В общем,метод восстановления наномитов довольно хороший,но всё-таки предназначен для ручной распаковки.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=148935&amp;user=1613&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=13" class="addthx" data-post="148935"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]VaZeR[/b]','')">VaZeR</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/6065.jpg" alt=""><br><span class=txtSm>Ранг: 88.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.91'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6065">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 июля 2007 16:07 <br><script type="text/javascript">QU('VaZeR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VaZeR" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
А я не как не могу понять, что к чему в этих trigger table. Скачал NoCD к своей игре. Там тоже они востановлены аналогичным образом. Откуда RELOADED взяли эти значения, наверное, не с неба же.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=148948&amp;user=6065&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=14" class="addthx" data-post="148948"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 июля 2007 01:09 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
<I>VaZeR пишет:<br>что к чему в этих trigger table </I><br>...попробуй смотреть код отладочных обработчиков.Там хоть почти нет метаморфа.<br>Я немного смотрел как-то -- что-то связано там с выделением какой-то памяти,типа RtlAllocateHeap,если я не ошибаюсь,на основе данных из таблицы.<br><I>VaZeR пишет:<br>Откуда RELOADED взяли эти значения </I><br>...на то они и Reloaded.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=149156&amp;user=1613&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=15" class="addthx" data-post="149156"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]VaZeR[/b]','')">VaZeR</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/6065.jpg" alt=""><br><span class=txtSm>Ранг: 88.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.91'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6065">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 июля 2007 04:50 <br><script type="text/javascript">QU('VaZeR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VaZeR" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
Благодаря этим таблицам инициализируется одно значение, которое записывается тоже в эту же таблицу, там где один dword нулей, Сама инициализация этого значения зависит только опять же от одного значения из таблицы. Больше не какие не используются. И это значение находится как раз в неизменом виде в выделеной области протектора. На моей игре я не могу не чего проверить, так как эти таблицы у меня почти не используются.  Надо будет NFS Most Wanted посмотреть. Там ты говоришь от них зависит многое.  <br>В отладочных обработчиках находится код инициализации значения. Больше я там не чего не нашёл.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=149172&amp;user=6065&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=16" class="addthx" data-post="149172"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]VaZeR[/b]','')">VaZeR</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/6065.jpg" alt=""><br><span class=txtSm>Ранг: 88.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.91'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6065">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2007 03:46 <br><script type="text/javascript">QU('VaZeR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VaZeR" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
Всем спасибо за хорошие отзывы к статье. Статью подправил и скоро должна будет появится в разделе &quot;Скачать&quot;. Всё тема закрыта.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=149400&amp;user=6065&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=17" class="addthx" data-post="149400"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2007 20:25 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9473&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
[offtop]<br>Почему в разделе &quot;Скачать&quot;??Выложи в раздел &quot;RAR-статьи&quot;.<br><I>VaZeR пишет:<br>Всё тема закрыта. </I><br>...у тебя там должна быть такая кнопочка внизу типа &quot;Закрыть тему&quot;.<br>[/offtop]
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=149662&amp;user=1613&amp;forum_n=1&amp;topic=9473&amp;page=1&amp;anchor=18" class="addthx" data-post="149662"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=1&amp;topic=9473&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=1&amp;topic=9473&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Статья SafeDisk 4.6</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=9473" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
