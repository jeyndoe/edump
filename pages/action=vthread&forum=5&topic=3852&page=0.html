<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Исследование combobox - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Имеется combobox со свойством cbs_simple (сверху как бы Edit, а под ним как бы ListBox), который при выборе строки из списка мышью, подставляет сверху выбранную строку, но со всеми буквами в верхнем регистре. Еще данный combobox">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Исследование combobox</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Ysp[/b]','')">Ysp</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3608">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 января 2006 07:38 <br><script type="text/javascript">QU('Ysp','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ysp" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3852.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Имеется combobox со свойством cbs_simple (сверху как бы Edit, а под ним как бы ListBox), который при выборе строки из списка мышью, подставляет сверху выбранную строку, но со всеми буквами в верхнем регистре.
<br>
<br>Еще данный combobox имеет ограничение на количество вводимых символов.
<br>
<br>Вопрос: как можно найти тот участок кода, который конвертирует буквы в верхний регистр и проверяет количество введенных символов.
<br>
<br>Немного о проделанной работе: брикпоинт на API CharUpperA не срабатывает, подстановка вместо него nop, тоже не дает эффекта. Свойство cbs_uppercase не активно. Если вместо cbs_simple выставить cbs_dropdownlist, то выбор происходит нормально, но такой вид combobox не нужен. Пытался найти какое-нибудь событие, чтобы попасть в нужный код, но ничего кроме keydown не придумал. По keydown я попадаю во всякие gdi32 и kernel&#039;ы и после выхода в тело программы оказываюсь в цикле с PeekMesage, по которому пошагово можно ходить целую вечность.
<br>
<br>Программа: Схематик - sch.exe из состава P-CAD2002. Исследуемый combobox расположен в диалоговом окне Place Part, вызываемом командой place part. Сам диалог находится в schrsc.dll.
<br>
<br>P.S. Просьба объяснять попроще, т.к. взломом занимаюсь не по призванию, а по нужде (необходимо сократить объем работ на своем рабочем месте), и в асме мало что смыслю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52112&amp;user=3608&amp;forum_n=5&amp;topic=3852.html&amp;page=0&amp;anchor=1" class="addthx" data-post="52112"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 января 2006 12:08 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3852.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
CBS_UPPERCASE можеть быть также установлен после инициализации контрола
<br>к тому же полезнее ставить также бряк на SendMessage... хотя не бряк - SendMessage может быть туча, лучше дизасмить прогу в IDA и там отследить обращение к этому контролу
<br>посмотри, не берётся ли где хэндл (GetDlgItem) этого контрола для дальнейшего использования в SendMessage
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52139&amp;user=1379&amp;forum_n=5&amp;topic=3852.html&amp;page=0&amp;anchor=2" class="addthx" data-post="52139"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Ysp[/b]','')">Ysp</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3608">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 января 2006 05:49 <br><script type="text/javascript">QU('Ysp','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ysp" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3852.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>Jupiter пишет:
<br>CBS_UPPERCASE можеть быть также установлен после инициализации контрола </I>
<br>Не думаю, т.к. выставлял cbs_lowercase, и он действовал как ему и полагается. Если бы cbs_uppercase выставлялся после инициализации, то я все равно бы видел строки в верхнем регистре.
<br><I>Jupiter пишет:
<br>лучше дизасмить прогу в IDA и там отследить обращение к этому контролу </I>
<br>На данном сайте дистрибутив IDA размером с мой месячный трафик. Нет ли варианта поменьше?
<br><I>Jupiter пишет:
<br>посмотри, не берётся ли где хэндл (GetDlgItem) этого контрола для дальнейшего использования в SendMessage </I>
<br>Могу я отловить &quot;дальнейшее использование в SendMessage&quot; с помощью OllyDBG?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52220&amp;user=3608&amp;forum_n=5&amp;topic=3852.html&amp;page=0&amp;anchor=3" class="addthx" data-post="52220"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]=TS=[/b]','')">=TS=</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/3085.png" alt=""><br><span class=txtSm>Ранг: 251.8 (наставник), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.63'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3085">Участник</a><br><font color=blue>Seeker</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 января 2006 08:01 <br><script type="text/javascript">QU('=TS=','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto==TS=" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3852.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>Ysp</b>
<br>В дистрибе с MS Visual Studio утилка Spy++ (Spyxx.exe для запуска)
<br>С ее помощью ты можешь отследить все сообщения, которые приходят нужному контролу... Или выбрать только те, которые хо увидеть...
<br><br><font size="1"><i>-----<br>DREAMS CALL US</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52225&amp;user=3085&amp;forum_n=5&amp;topic=3852.html&amp;page=0&amp;anchor=4" class="addthx" data-post="52225"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 января 2006 15:43 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3852.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Ysp пишет:
<br>Не думаю, т.к. выставлял cbs_lowercase, и он действовал как ему и полагается. </I>
<br>ясно. я просто предупредил.
<br>после установки тобой cbs_lowercase символы всё равно конвертятся?
<br>какова задача? чтобы прога не переводила данные в верхний регистр?
<br>к тому же ты не сказал, на каком языке написана сия прога, ведь зачастую в VC и Delphi используются внутренние библиотечные ф-ции, не вызывая системные типа CharUpper
<br>
<br>я прочитал, что это за прога, но найти её не могу, выложи где-нить необходимый файл, я попробую глянуть.
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52256&amp;user=1379&amp;forum_n=5&amp;topic=3852.html&amp;page=0&amp;anchor=5" class="addthx" data-post="52256"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Ysp[/b]','')">Ysp</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3608">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 января 2006 14:46 <br><script type="text/javascript">QU('Ysp','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ysp" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3852.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>после установки тобой cbs_lowercase символы всё равно конвертятся? </I>
<br>Нет, все переводятся в нижний регистр. Из чего сделал вывод, что uppercase при инициализации не выставляется.
<br><I>какова задача?  </I>
<br>Использовать буквы обоих регистров. Снять ограничение в 30 вводимых символов (или увеличить до 40).
<br><I>на каком языке написана сия прога </I>
<br>Microsoft Visual C++ 6.0
<br>
<br>Выложил на webfile.ru/782536 . Доступно до 7 февраля. Архив около 2,7МБайт, т.к. прога выдернута из целого пакета программ P-CAD.
<br>Размести распакованый каталог в корне диска C: (или поправь пути в ini), иначе не найдет свои файлы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52373&amp;user=3608&amp;forum_n=5&amp;topic=3852.html&amp;page=0&amp;anchor=6" class="addthx" data-post="52373"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 05:13 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3852.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
cкачал, установил в C:&#92;P-CAD, всё работает
<br>иду в меню Place-&gt;Part (можно и по клику на тулбаре)
<br>открывается диалоговое окно Place Part (в ресурсах номер 622), вижу ComboBox, заполненный значениями типа &quot;BCN16-4A 103 J7&quot;
<br>запускаю WinSpy++, смотрю на свойства данного Edit контрола (в составе комбобокса) - он имеет стиль ES_UPPERCASE, убираю этот стиль. в окне можно печатать любые буквы, но макс. 29 символов
<br>при закрытии окна и его повторном открытии снова устанавливается стиль ES_UPPERCASE
<br>
<br>итак, номер ComboBox (ID): 4009 | 0FA9h
<br>через GetComboBoxInfo беру hwndItem (хэндл Edit контрола), устанавливаю стиль без ES_UPPERCASE (WS_CHILD or WS_VISIBLE or ES_NOHIDESEL)
<br>но при повторном открытии окна стиль утсанавливается вновь
<br>как я заметил, если установлен ES_UPPERCASE, то элемент не вставится, если в нём есть символы в нижнем регистре
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52545&amp;user=1379&amp;forum_n=5&amp;topic=3852.html&amp;page=0&amp;anchor=7" class="addthx" data-post="52545"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 05:46 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3852.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>Ysp</b>
<br>сделал, чтобы ES_UPPERCASE не устанавливался
<br>длина строки - та же, видимо, всё дело в коротком буфере под строку
<br>
<br>напиши в ПМ твоё мыло - вышлю патч
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52546&amp;user=1379&amp;forum_n=5&amp;topic=3852.html&amp;page=0&amp;anchor=8" class="addthx" data-post="52546"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Ysp[/b]','')">Ysp</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3608">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2006 06:26 <br><script type="text/javascript">QU('Ysp','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ysp" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3852.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>Jupiter пишет:
<br>запускаю WinSpy++ ... устанавливаю стиль без ES_UPPERCASE... </I>
<br>Скачал WinSpy++, для моих целей подошла лучше чем Spy++ из MS Visual Studio. ES_UPPERCASE убирается, а вот как сделать <I>через GetComboBoxInfo беру hwndItem (хэндл Edit контрола) </I> не пойму.
<br>
<br>WinSpy++ v1.6 Copyright(c) 2002 by Catch22 Productions.Written by J Brown.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52686&amp;user=3608&amp;forum_n=5&amp;topic=3852.html&amp;page=0&amp;anchor=9" class="addthx" data-post="52686"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2006 17:02 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3852.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>Ysp пишет:
<br>WinSpy++ v1.6 </I>
<br>она самая. в отличие от MS Spy позволяет также изменять значения, а не только следить
<br>
<br><I>Ysp пишет:
<br>а вот как сделать через GetComboBoxInfo &lt;...&gt; не пойму.  </I>
<br>я для этого прогу писал масенькую ;)
<br><code>mov hTargetWnd,eax
<br>invoke  GetDlgItem,eax,IDC_TARGET_CTRL
<br>.If eax
<br>  lea edx, pCBi
<br>  mov [edx].COMBOBOXINFO.cbSize, size COMBOBOXINFO
<br>  invoke  GetComboBoxInfo,eax,edx
<br>  .If eax
<br>    lea edx, pCBi
<br>    mov eax, [edx].COMBOBOXINFO.hwndItem
<br>    mov hCtrl,eax
<br>    invoke  SetWindowLong,hCtrl,GWL_STYLE,NEW_STYLE
<br>    ...
<br></code>
<br>
<br>P.S. ЛС на форуме глючат ;(
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52755&amp;user=1379&amp;forum_n=5&amp;topic=3852.html&amp;page=0&amp;anchor=10" class="addthx" data-post="52755"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Ysp[/b]','')">Ysp</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3608">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 февраля 2006 15:14 <br><script type="text/javascript">QU('Ysp','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ysp" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3852.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>Jupiter пишет:
<br>напиши в ПМ твоё мыло - вышлю патч
<br>...
<br>P.S. ЛС на форуме глючат ;( </I>
<br>Если удалось прочесть личное сообщение, то высылай по указанному там адресу. Если нет, то на этот yesipov&lt;собака&gt;yandex.ru
<br>
<br>Можешь ограничиться указанием в форуме куска кода, который надо править.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52843&amp;user=3608&amp;forum_n=5&amp;topic=3852.html&amp;page=0&amp;anchor=11" class="addthx" data-post="52843"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Ysp[/b]','')">Ysp</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3608">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 февраля 2006 17:21 <br><script type="text/javascript">QU('Ysp','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ysp" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3852.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>Jupiter пишет:
<br>напиши в ПМ твоё мыло - вышлю патч </I>
<br>Уря-я-я! Уже не надо.
<br>0046b460 PUSH 1E поправил на PUSH 28, получил ограничение в 40 символов.
<br>005cae87 OR AL,8 заполнил nop&#039;ами, es_uppercase больше выставляется функцией SetWindowLong.
<br>
<br>Опиши, пожалуйста, свой путь выхода на нужный участок кода. Я по незнанию ходил пошагово F8, F7 и постоянно сверялся со справкой по API. Утомительно получилось.
<br>
<br>Спасибо, сдвинул меня с мертвой точки.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52849&amp;user=3608&amp;forum_n=5&amp;topic=3852.html&amp;page=0&amp;anchor=12" class="addthx" data-post="52849"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 февраля 2006 18:11 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3852.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>Ysp</b>
<br>молодец, нашёл то, что нужно <img src="img/smilies/s1.gif" alt="">
<br>итак, мой метод:
<br>
<br>Поскольку при установке в редакторе ресурсов стиля для ComboBox&#039;a, этот стиль сохранялся, значит прога перед установкой стиля запрашивает текущий стиль, т.е перед вызовом SetWindowLong идёт вызов GetWindowLong. Следовательно, нужно найти кусок кода, где вызывался бы GetWindowLong с параметром GWL_STYLE.
<br>Синтаксис ф-ции: LONG GetWindowLong(HWND hWnd,int nIndex);
<br>Первым параметром идёт хэндл контрола (окна), для которого устанавливается стиль.
<br>Но для того, чтобы передать в ф-цию хэндл контрола, нужно его (хэндл) сначала получить. Делается это ф-цией GetDlgItem.
<br>Синтаксис ф-ции: HWND GetDlgItem(HWND hDlg,int nIDDlgItem);
<br>Значит в коде проге где-то должен быть код, передающий в ф-цию GetDlgItem параметр nIDDlgItem, равный ID контрола.
<br>ID нашего ComboBox - 4009 (FA9h), это можно увидеть в редакторе ресурсов. Ищем в OllyDbg команду &#039;push 0FA9&#039;, либо её hex аналог 68 A90F0000.
<br>для справки: Ctrl-F - поиск команды, Ctrl-B - поиск данных
<br>
<br>находим:
<br>1-й раз здесь:
<br>0046B345  |.  68 A90F0000       push    0FA9
<br>0046B34A  |.  8BCE              mov     ecx, esi
<br>0046B34C  |.  E8 8FF91500       call    &lt;SCH.CBResetContent&gt;
<br>
<br>здесь идёт очистка ComboBox
<br>
<br>2-й раз
<br>0046B410   .  68 A90F0000       push    0FA9
<br>0046B415   .  8D8E A7020000     lea     ecx, dword ptr ds:[esi+2A7]
<br>0046B41B   .  E8 05C32F00       call    SCH.00767725
<br>
<br>уже близко!
<br>
<br>3-й раз:
<br>0046B460      6A 1E             push    1E
<br>0046B462      68 A90F0000       push    0FA9
<br>0046B467   .  8BCE              mov     ecx, esi
<br>0046B469   .  E8 42F81500       call    &lt;SCH.SetCBTextLimit&gt;
<br>0046B46E   .  6A 01             push    1
<br>0046B470   .  68 A90F0000       push    0FA9
<br>0046B475   .  8BCE              mov     ecx, esi
<br>0046B477   .  E8 94F91500       call    &lt;SCH.SetWndStyle&gt;
<br>
<br>нашли!
<br>
<br>P.S. форматирование нихрена не сохраняется, по мылу те отправлю нормальный вар-т
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=53242&amp;user=1379&amp;forum_n=5&amp;topic=3852.html&amp;page=0&amp;anchor=13" class="addthx" data-post="53242"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Ysp[/b]','')">Ysp</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3608">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2006 06:51 <br><script type="text/javascript">QU('Ysp','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ysp" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3852.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>Jupiter</b>
<br>Еще раз спасибо. Нужно учить API, хоть в Delphi и без него обходился.
<br><I>Jupiter пишет:
<br>...
<br>Ищем в OllyDbg команду &#039;push 0FA9&#039;...
<br>... </I>
<br>Да, после того как нашел в чем дело в остальных местах данного exe и остальных exe&#039;шниках примерно так и поступал.
<br>
<br>Теперь правда другая проблема всплыла. При создании (переименовании) компонента, p-cad все равно считывает по 30 символов, хоть и могу вписать 40. Вот, разбираюсь... GetDlgItemText, WriteFile... Но об этом,  в другое время и в другом топике. Эту тему, полагаю, можно закрыть.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=53326&amp;user=3608&amp;forum_n=5&amp;topic=3852.html&amp;page=0&amp;anchor=14" class="addthx" data-post="53326"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Исследование combobox</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=3852" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
