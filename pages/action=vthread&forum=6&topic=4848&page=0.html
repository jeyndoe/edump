<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как узнать CurrentDir другого процесса? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Народ, как узнать рабочий каталог другого процесса в системе? Ни в WinAPI, ни в Thelp этой ф-ции нет. Можно ли докопаться до этой инфы из r3 ?">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a>, <a target='_blank' href='?action=userinfo&amp;user=39467'>hgdagon</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как узнать CurrentDir другого процесса?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]kkcos[/b]','')">kkcos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 21.2 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.95'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2286">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 13:06 <br><script type="text/javascript">QU('kkcos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kkcos" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Народ, как узнать рабочий каталог другого процесса в системе?
<br>Ни в WinAPI, ни в Thelp этой ф-ции нет. 
<br>Можно ли докопаться до этой инфы из r3 ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68838&amp;user=2286&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=1" class="addthx" data-post="68838"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 13:36 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Йопт, не судьба поискать в гугле?? Скоро авторы топиков, ответ на вопрос которых находится в гугле в течении нескольких минут, будут баниться.
<br>
<br>1.
<br>Самый надежный способ узнать полное имя исполняемого файла (путь к экзешнику) - это получить идентификатор его процесса (GetCurrentProcessId) найти его среди запущенных процессов (Process32First, Process32Next)... Полное имя файла будет содержаться в структуре PROCESSENTRY32-&gt;szExeFile.
<br>Как экстримальный вариант можно из CWinApp-&gt;m_pszHelpFilePath... Я чесно говоря не пользовался и не знаю при каких условиях он переопределяется... Запустил диалог вроде пути правильные...
<br>(Ответ Straight) Хм... GetModuleFileName тоже работает , может я чего-то торможу... Надо проверить на подводные камни... Век живи век учись!
<br>
<br>2. Путь откуда была запущена программа можно узнать (как тут уже правильно подсказали) путем GetCurrentDirectory, однако это совсем не значит что там лежит исполняемый экзешник! Напимер можно запустить экзеху с ярлыка на рабочем столе, тогда курриент директори будет рабочий стол!
<br>
<br>Чтобы указать путь к файлу совсем не нужна знать полный путь, вы просто пишете ОткрытьФайл(&quot;МойФайл.тэкст&quot;), путь сложеться как Текущая дирректория + ИмяОткрываемогоФайла, т.к. Текущая дирректория в частном случае и есть дирректория где лежит экзешник. Если Вы уверены что будете запускать экзеху только путем двойного на нее нажатия то Вас вполне устроит этот вариант.
<br>Естественно понятно, что приятней читать ОткрытьФайл(&quot;файл.тэкст&quot;) чем ОткрытьФайл(&quot;С:&#92;Програм Файлз&#92;Моя мега крутая компания&#92;Моя мега крутая прога&#92;файл.тэкст&quot;). Чтобы этого издежать нам нужно бить уверенным что текущая дирректроия - это дирректория с экзехой, для этого из пункта 1 моей писанины добываем путь, полученную деррикторию ставим текущей SetCurrentDirectory.
<br>В некоторых своих программах я часто обращаюсь к файлам в дирректории с исполняемым, считаю данный способ оптимальным, т.к. улучшает читабельность. Однако если у Вас файл открывается всего один раз, то смысла проделывать все эти процедуры нет, лучше просто указать полный путь к файлу, дирректорию экзешника можно узнать из пункта 1.
<br>(ц)гугл
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68842&amp;user=24&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=2" class="addthx" data-post="68842"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]kkcos[/b]','')">kkcos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 21.2 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.95'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2286">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 13:50 <br><script type="text/javascript">QU('kkcos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kkcos" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Пользователь открывает WINCMD и переходит в дир. X
<br>Как узнать X, если моя программа запущенна не из
<br>WINCMD, и сам он запущен из папки Y!=X ???
<br>
<br>ЗЫ В Гугле выдается куча всякой фигни <img src="img/smilies/s13.gif" alt="">, либо по линуху, либо по ТХЕЛП,
<br>но пользы от этого никакой.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68844&amp;user=2286&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=3" class="addthx" data-post="68844"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 13:58 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>kkcos пишет:
<br>Пользователь открывает WINCMD и переходит в дир. X </I>
<br>
<br><I>kkcos пишет:
<br>Как узнать X, если моя программа запущенна не из 
<br>WINCMD, и сам он запущен из папки Y!=X ??? </I>
<br>Нифига не понял...При чем тут cmd, если оно тебе не нужно? =) К слову чтоли написал?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68850&amp;user=24&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=4" class="addthx" data-post="68850"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]kkcos[/b]','')">kkcos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 21.2 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.95'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2286">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 14:06 <br><script type="text/javascript">QU('kkcos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kkcos" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Мне нужно узнать текущий рабочий каталог процесса.
<br>Например, если открыт cmd, то отслеживать выполнение команды cd.
<br>Только не конкретно для cmd, а для любого процесса, вызывающего
<br>SetCurrentDirectory
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68855&amp;user=2286&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=5" class="addthx" data-post="68855"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 14:12 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>kkcos пишет:
<br>Только не конкретно для cmd, а для любого процесса, вызывающего 
<br>SetCurrentDirectory </I>
<br>Тогда хучь АПИ, инфы дохрена в гугле.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68860&amp;user=24&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=6" class="addthx" data-post="68860"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]kkcos[/b]','')">kkcos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 21.2 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.95'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2286">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 14:23 &middot; Поправил: kkcos <br><script type="text/javascript">QU('kkcos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kkcos" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
См. первый пост <img src="img/smilies/s1.gif" alt="">
<br>Гугл выдаёт фигню.
<br>Ф-ции WinAPI позволяют узнать текущий раб. каталог только текущего процесса.
<br>По крайней мере ф-ции, описанные в SDK к Win2k (из C++ Builder6)
<br>И ТХЕЛП позволяет максимум узнать путь к экзешнику программы.
<br>В Гугле мож и есть куча инфы, только эта инфа где-нить на 55 странице, и то не обязательно.
<br>
<br>Где то в системе храниться таблица етих currdir, ведь как-то работает GetCurrentDir
<br>А как узнать не свою или все записи - знает, похоже, один БГ
<br>Или просто SDK устарел <img src="img/smilies/s1.gif" alt="">
<br>
<br>Так что, кто знает, please help
<br>и не надо всяких &quot;go to google.com ...&quot; или &quot;смотри SDK&quot;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68867&amp;user=2286&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=7" class="addthx" data-post="68867"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 14:44 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>kkcos пишет:
<br>Ф-ции WinAPI позволяют узнать текущий раб. каталог только текущего процесса. </I>
<br>Бля. Читай второй пост.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68875&amp;user=24&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=8" class="addthx" data-post="68875"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Step[/b]','')">Step</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.6 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.78'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 14:45 <br><script type="text/javascript">QU('Step','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Step" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>kkcos</b>
<br>Тебе же <b>Ara</b> обьяснил: ставшишь хук на Апи в другом процессе и фильтруеш вхождения. Лишь таким способом ты сможешь реагировать на изменение текущей директории процесса. Не стоит забывать, что текущая директория одна, а потоков может быть много...
<br>Для начала поробуй это в дебагере, а уж потом и сам догадаешься какую строку поиска нужно ввести в гугл для предотвращения &quot;эффекта 55 страници&quot;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68876&amp;user=2702&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=9" class="addthx" data-post="68876"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]kkcos[/b]','')">kkcos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 21.2 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.95'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2286">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 14:50 <br><script type="text/javascript">QU('kkcos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kkcos" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>Step</b>
<br>   спасибо
<br>это будет вариант № 1
<br>правда он будет полезен только, если
<br>сам запускаешь другую прогу (или её
<br>запускает пользователь, но после запуска
<br>&quot;шпиона&quot; )
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68879&amp;user=2286&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=10" class="addthx" data-post="68879"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]killsniper[/b]','')">killsniper</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.4 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3210">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 17:20 <br><script type="text/javascript">QU('killsniper','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=killsniper" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
А что, так проблемно грузить шпион при загрузке машины?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68932&amp;user=3210&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=11" class="addthx" data-post="68932"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 17:22 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>kkcos</b>
<br>Похоже ты сам не знаешь, что хочешь. Сделай драйвер с глобальным перехватом API <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68934&amp;user=24&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=12" class="addthx" data-post="68934"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Asterix[/b]','')">Asterix</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 450.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.26<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=58">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 18:26 <br><script type="text/javascript">QU('Asterix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Asterix" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Как же мне надоели трояно и шпионо писатели, особенно такие которые с ассемблером
<br>и Win API только вчера познакомились..
<br>И вообще не понятно каким боком такая деятельность относится к кряку?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68943&amp;user=58&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=13" class="addthx" data-post="68943"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]kropalik[/b]','')">kropalik</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.5 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.01'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=2161">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 мая 2006 06:23 &middot; Поправил: kropalik <br><script type="text/javascript">QU('kropalik','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kropalik" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
в качестве варианта:
<br>OpenProcess(...); // выбираем процесс 
<br>VirtualAllocEx(...); /* выделим в нем децл памяти
<br>можно не выделять а использовать ненужный самой
<br>проге участок например выравнивание между
<br>секциями в какой нибудь dll */
<br>WriteProcessMemory(...); /* запишем туда кусок кода который 
<br>вызовет GetCurrentDirectory() и затем ExitThread() */
<br>CreateRemoteThread(...); // выполним этот код
<br>ReadProcessMemory(...); // прочитаем результат
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69108&amp;user=2161&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=14" class="addthx" data-post="69108"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 мая 2006 11:46 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>kropalik пишет:
<br>вызовет GetCurrentDirectory()  </I>
<br> Попытаюсь поянить, что спрашивают.  GetCurrentDirectory() берет инфу из каких-то системных таблиц. Товарища интересует доступ к этим таблицам, минуя длинную цепочку АПИ и всяческие хуки.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69170&amp;user=4072&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=15" class="addthx" data-post="69170"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]MoonShiner[/b]','')">MoonShiner</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 186.8 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 мая 2006 14:27 <br><script type="text/javascript">QU('MoonShiner','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MoonShiner" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>tundra37 пишет:
<br>GetCurrentDirectory() берет инфу из каких-то системных таблиц. Товарища интересует доступ к этим таблицам, минуя длинную цепочку АПИ и всяческие хуки. </I>
<br>Ради интереса поковырялся сейчас в недрах GetCurrentDirectoryA... Ну что я могу сказать - за 5 минут можно выдрать алго для своей винды, за час - сделать общий немного поковырявшись в мануалах. Вывод: делать вес ручками - полезно будет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69204&amp;user=2&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=16" class="addthx" data-post="69204"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 мая 2006 17:44 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
а вот еще вариант!
<br><b>kkcos</b>
<br>Ты хотя бы подробней написал, зачем оно тебе все это надо!
<br>А вообще тебе на wasm.ru там <b>Ms-Rem</b> тебе подробно объяснит в своих статьях как тебе найти то, что ты так долго искал, да и еще в исходниках покажет.(таким как <b>kkcos</b> всем туда!)
<br>Сам я такое не читаю, потому что знаю, а смотрел так быстрым взглядом, думал, может, что-то новое для себя найду.
<br>Ну а если лень как там выше &quot;Скоро авторы топиков, ответ на вопрос которых находится в гугле в течение нескольких минут, будут баниться!&quot; то тогда вот кусок кода, который выдернет директорию другого процесса хоть из <img src="img/smilies/s16.gif" alt="">
<br>
<br>GetWindowThreadProcessId,здесь хендл окна того процесса, что создал это окно<img src="img/smilies/s5.gif" alt="">,ADDR ProcessID
<br>invoke OpenProcess,410h,0,ProcessID
<br>push eax
<br>mov edi,[esp]
<br>invoke EnumProcessModules,edi,ADDR ProcessInstance,128,ADDR ProcessID
<br>invoke GetModuleFileNameEx,edi,ProcessInstance,ADDR Buffer,512
<br>invoke SetDlgItemText,hDlg,ID_DIRECTFILENAME,ADDR Buffer
<br>call CloseHandle
<br>
<br>Сам когда-то писал шпион, который показывал мне ID меню ну и всякую прочую чепуху, которая мне нужна была для исследования кода.
<br>
<br><b>Kill Demon666</b>
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=69259&amp;user=4551&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=17" class="addthx" data-post="69259"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]crazyalex[/b]','')">crazyalex</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 46.5 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.2'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4592">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 мая 2006 17:52 <br><script type="text/javascript">QU('crazyalex','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crazyalex" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>Asterix пишет:
<br>И вообще не понятно каким боком такая деятельность относится к кряку? </I>
<br>Действительно ведь раздел называется околокрэкинговое программирование, а тут хотят написать какой то шпион или троян
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69260&amp;user=4592&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=18" class="addthx" data-post="69260"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]kkcos[/b]','')">kkcos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 21.2 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.95'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2286">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 мая 2006 18:36 <br><script type="text/javascript">QU('kkcos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kkcos" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4848.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
не шпион и не троян, а вполне нормальная оболочка
<br>короче, пора скачивать символы к системным  библиотекам
<br>и идти на wasm.ru 
<br>короче, &quot;крэкеры&quot;, вопрос исчерпан
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69280&amp;user=2286&amp;forum_n=6&amp;topic=4848.html&amp;page=0&amp;anchor=19" class="addthx" data-post="69280"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как узнать CurrentDir другого процесса?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=4848" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
