<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>StarForce 5.7 MMOG - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Есть одна игра - Prime World, которая совсем недавно была защищена с помощью StarForce 5.7 MMOG Мне нужно научиться обходить защиту или, что ещё лучше, научиться её снимать. Снятие защиты мне необходимо для поиска багов в игре. У">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a>, <a target='_blank' href='?action=userinfo&amp;user=55940'>exp50848</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> StarForce 5.7 MMOG</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=1&amp;topic=20449&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=1&amp;topic=20449&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Once[/b]','')">Once</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.71'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=33148">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2012 20:14 &middot; Поправил: Once <br><script type="text/javascript">QU('Once','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Once" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Есть одна игра - <noindex><a href="http://ru.playpw.com" rel="nofollow" target="_blank"><u>Prime World</u></a></noindex>, которая совсем недавно была защищена с помощью <noindex><a href="http://www.star-force.ru/solutions/product/starforce-mmog/" rel="nofollow" target="_blank"><u>StarForce 5.7 MMOG</u></a></noindex><br>Мне нужно научиться обходить защиту или, что ещё лучше, научиться её снимать.<br>Снятие защиты мне необходимо для поиска багов в игре.<br>У меня есть старая, не накрытая Старом версия.<br>Раньше сам exe&#039;шник весил мало и подтягивал все функции из dll, сейчас всё в одном exe.<br>Сама игра весит 1.7 GB, но я собрал необходимые файлы в архив:<br>Новая версия (20MB) - <noindex><a href="http://multi-up.com/780073" rel="nofollow" target="_blank"><u>http://multi-up.com/780073</u></a></noindex><br>Старая версия (12MB) - <noindex><a href="http://multi-up.com/780089" rel="nofollow" target="_blank"><u>http://multi-up.com/780089</u></a></noindex><br><br><br>То что нашел сам:<br>Файл PW_Game.exe защищён StarForce 5.70.37.002 MMOG<br><strike>BM вроде нету.</strike><br>Защитный модуль имеет название sakijapi.dll. В старой версии он имеется, но, похоже, не используется. Упакован UPX, распаковывается легко если надо.<br>Если запустить PW_Game.exe - появится MessageBox, который говорит, что нужно запустить лаунчер. Это нормально, т.к. PW_Game.exe запускается с набором параментров о сессии, логине, разрешении, и т.д. <br>Скрыть Olly помогает плагин фантом.<br>OEP - <b>00A094DD</b><br>В старой версии EP - <b>00401443</b><br>Сдампив на этом OEP без восстановления импорта, можно запустить дамп, но возникает исключение - деление на 0 в модуле защиты по адресу <b>015FDF57</b>.<br>Не знаю, нужно ли там восстанавливать импорт?<br>По адресу <b>00A092AC</b> происходит вызов Старовской функции, в которой вызывается <b>_initterm_e</b> (в старой версии exe&#039;шника вызов этой функции виден по адресу <b>00401212</b>), которая и вызывает функцию, в которой происходит исключение.<br><br>Не знаю куда дальше двигаться..<br>Если занопить <b>_initterm_e</b> и следом за ним <b>_initterm</b>, то исключение будет в ntdll<br>Эти initterm&#039;ы, как я понимаю, вызывают конструкторы классов, используемых в приложении, а может и нет =)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313430&amp;user=33148&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=1" class="addthx" data-post="313430"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Flasher-11[/b]','')">Flasher-11</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.2 (новичок), 9thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.95'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32610">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2012 20:23 &middot; Поправил: Flasher-11 <br><script type="text/javascript">QU('Flasher-11','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flasher-11" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>Once</b>, думаю Вам нужно почитать, что она вообще представляет из себя SF MMOG <noindex><a href="http://www.star-force.ru/files/wp/StarForce_MMOG_white_paper_rus.pdf" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br><I>Once пишет:<br>Мне нужно научиться обходить защиту или, что ещё лучше, научиться её снимать. </I><br><br>Прям так сразу и SF ломать? <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313431&amp;user=32610&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=2" class="addthx" data-post="313431"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2012 20:38 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Скиньте еще PWLauncher что-ли.<br>Давно хотел 5 версию поковырять.<br><br>add..<br>фи! архитектура ВМ такая же как и в 4.7 версиях
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313434&amp;user=3136&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=3" class="addthx" data-post="313434"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Once[/b]','')">Once</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.71'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=33148">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2012 20:49 &middot; Поправил: Once <br><script type="text/javascript">QU('Once','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Once" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>Veliant пишет:<br>Скиньте еще PWLauncher что-ли. </I><br><br>Боюсь не всё так просто =)<br>Лаунчер запускает castle.exe (замок) из которого запускается бой (PW_Game.exe)<br>И они там друг с другом связаны, каждый exe&#039;шник запускается с особыми параметрами.<br><b>UPD</b> Попробуйте запустить PW_Game.exe с такими параметрами - <i class=x>parentWidth 1280 parentHeight 800 parentSessionLogin 217.174.109.140:35001/559376540634029/00000000000000000000000000000000 serverName http://ru.pwcastle.nivalnetwork.com:88/four uid 1111111111 serverKey 222222222 serverSecret 33333333333</i><br>Бой не начнется, но MessageBox&#039;а не будет<br><br><I>Once пишет:<br>фи! архитектура ВМ такая же как и в 4.7 версиях  </I><br>А можете объяснить, как вы так быстро поняли, что там есть ВМ, да ещё точную версию знаете? Мне это жутко интересно ))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313435&amp;user=33148&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=4" class="addthx" data-post="313435"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2012 21:05 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Once пишет:<br>А можете объяснить, как вы так быстро поняли, что там есть ВМ, да ещё точную версию знаете? Мне это жутко интересно ))  </I><br>То что она есть, не значит что она может вызываться из игры. Если так интересно поковырять ВМ - смотрите функцию PSM_0 из sakijapi. Она вызывается с самого EntryPoint игры. Там сначала идет инициализация контекста, потом как в старых версиях идет чтение лент пикода. Отличие разве что в переходе между обработчиками по jmp edx вместо jmp eax в предыдущих версиях. Это на первый взгляд.<br><br><I>Once пишет:<br>Бой не начнется, но MessageBox&#039;а не будет  </I><br>Подтвержаю. MessageBox&#039;а нет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313436&amp;user=3136&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=5" class="addthx" data-post="313436"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Once[/b]','')">Once</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.71'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=33148">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2012 21:19 &middot; Поправил: Once <br><script type="text/javascript">QU('Once','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Once" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Сейчас вынес каталог с PW_Game.exe на рабочий стол и запустил с указанными выше параметрами - процесс завершился.<br>В каталоге он не падает, играет приятная музыка, черный экран в окне игры с парой строчек об ошибке.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313438&amp;user=33148&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=6" class="addthx" data-post="313438"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2012 21:26 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Да, вот из-за таких топиков я сейчас подниму задницу и пойду писать статью про виртуальные машины. <b>Once</b>, не обижайтесь, не вы тут первый старфорс ломаете... Думаю, не вы последний. Уже аж рыдать хочется.<br><br><b>Продолжение</b><br><b>Veliant</b><br>Нет, статья про виртуальные машины в общем, на старфорс рано замахиваться. А про традицию - да, заканчивается она, в общем, тоже стандартно: &quot; <b>А потом мы с друзьями идём в баню...</b>&quot; Ну, т.е. в баню идут только те друзья, которые сами ничего не сделали, а только накидали ссылок на софт и ждут, что им тут всё отреверсят.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=313439&amp;user=6336&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=7" class="addthx" data-post="313439"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2012 21:29 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Да, вот из-за таких топиков я сейчас подниму задницу и пойду писать статью про виртуальные машины </I><br>Про декомпиляцию или ее дамп??<br>Кажется в последней теме от свиновода, там изложили все что только можно.<br>Но у нас кажется традиция раз в пол года поднимать тему про SF и оффтопить на десяток страниц<br><br>p.S.<br>В аттаче адреса обработчиков команд в VM и трейслог для них. На некоторых он обрывается до выхода из него по jmp reg (увы, автоматические средства не совершенны), но тип команды установить можно.<br><br>p.p.S<br>Пример обработчика команды с пояснением.<br>EDI указывает на контекст VM. В самом начале идет чтение лент пикода. Указатели на них находятся в первых четырех 64битных регистрах. Ленты между собой xor&#039;ятся и заносятся в буфер для дальнейшей обработки<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">точка&nbsp;входа<span class="hl_char">:</span></li><li class="hl_l1">0xfd4285&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x00<span class="hl_char">]</span></li><li class="hl_l0">0xfd4288&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">+</span>0x00<span class="hl_char">]</span></li><li class="hl_l1">0xfd428b&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x08<span class="hl_char">]</span></li><li class="hl_l0">0xfd428e&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">+</span>0x00<span class="hl_char">]</span></li><li class="hl_l1">0xfd4291&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x10<span class="hl_char">]</span></li><li class="hl_l0">0xfd4294&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">+</span>0x00<span class="hl_char">]</span></li><li class="hl_l1">0xfd4297&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x18<span class="hl_char">]</span></li><li class="hl_l0">0xfd429a&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">+</span>0x00<span class="hl_char">]</span></li><li class="hl_l1">0xfd429d&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>ecx</b></span>&nbsp;<span class="hl_comment">; мусор</span></li><li class="hl_l0">0xfd429f&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x20<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">0xfd42a2&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x00<span class="hl_char">]</span></li><li class="hl_l0">0xfd42a5&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">+</span>0x04<span class="hl_char">]</span></li><li class="hl_l1">0xfd42a8&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x08<span class="hl_char">]</span></li><li class="hl_l0">0xfd42ab&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">+</span>0x04<span class="hl_char">]</span></li><li class="hl_l1">0xfd42ae&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x10<span class="hl_char">]</span></li><li class="hl_l0">0xfd42b1&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">+</span>0x04<span class="hl_char">]</span></li><li class="hl_l1">0xfd42b4&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x18<span class="hl_char">]</span></li><li class="hl_l0">0xfd42b7&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">+</span>0x04<span class="hl_char">]</span></li><li class="hl_l1">0xfd42ba&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x24<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li>        </ol>
    </div>
</div></div>
<br>Далее идет смещение лент, на длину команды<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">0xfd42bd&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;0x00000008</li><li class="hl_l0">0xfd42c3&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x00<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">0xfd42c6&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x08<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">0xfd42c9&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x10<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">0xfd42cc&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x18<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li>        </ol>
    </div>
</div></div>
<br>Парсинг флагов. Некоторые из них влияют на флаги ВМ, некоторые на сам опкод.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">0xfd42cf&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x21<span class="hl_char">]</span></li><li class="hl_l1">0xfd42d2&nbsp;<span class="hl_function"><b>shr</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;0x04</li><li class="hl_l0">0xfd42d5&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;0x0000000F</li><li class="hl_l1">0xfd42db&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;0x00000001</li><li class="hl_l0">0xfd42e1&nbsp;<span class="hl_function"><b>shl</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">cl</span></li><li class="hl_l1">0xfd42e3&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;0x00007FFF</li><li class="hl_l0">0xfd42e9&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x38<span class="hl_char">]</span></li><li class="hl_l1">0xfd42ec&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x20<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">0xfd42ef&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x22<span class="hl_char">]</span></li><li class="hl_l1">0xfd42f2&nbsp;<span class="hl_function"><b>shr</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;0x03</li><li class="hl_l0">0xfd42f5&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;0x0000000F</li><li class="hl_l1">0xfd42fb&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;0x00000001</li><li class="hl_l0">0xfd4301&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;0x01003230</li><li class="hl_l1">0x1003230&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;0x08F5DF2D</li><li class="hl_l0">0x1003236&nbsp;<span class="hl_function"><b>je</b></span>&nbsp;0x014B14AC</li><li class="hl_l1">0x100323c&nbsp;<span class="hl_function"><b>shl</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">cl</span></li><li class="hl_l0">0x100323e&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;0x00007FFF</li><li class="hl_l1">0x1003244&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x38<span class="hl_char">]</span></li><li class="hl_l0">0x1003247&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;0x011FF5DA</li><li class="hl_l1">0x11ff5da&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x22<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">0x11ff5dd&nbsp;<span class="hl_function"><b>shr</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;0x02</li><li class="hl_l1">0x11ff5e0&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0">0x11ff5e2&nbsp;<span class="hl_function"><b>shr</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;0x02</li><li class="hl_l1">0x11ff5e5&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;0x010D28A4</li><li class="hl_l0">0x10d28a4&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x00000048<span class="hl_char">]</span></li><li class="hl_l1">0x10d28aa&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x22<span class="hl_char">]</span></li><li class="hl_l0">0x10d28ad&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1">0x10d28af&nbsp;<span class="hl_function"><b>sub</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0">0x10d28b1&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l1">0x10d28b3&nbsp;<span class="hl_function"><b>jg</b></span>&nbsp;0x0166F724</li><li class="hl_l0">0x10d28b9&nbsp;<span class="hl_function"><b>shr</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;0x07</li><li class="hl_l1">0x10d28bc&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;0x0000000F</li><li class="hl_l0">0x10d28c2&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x22<span class="hl_char">]</span></li><li class="hl_l1">0x10d28c5&nbsp;<span class="hl_function"><b>shr</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;0x02</li><li class="hl_l0">0x10d28c8&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;0x00000001</li><li class="hl_l1">0x10d28ce&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">0x10d28d0&nbsp;<span class="hl_function"><b>jne</b></span>&nbsp;0x010D28E6</li><li class="hl_l1">0x10d28d6&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;0xFFFFFFFE</li><li class="hl_l0">0x10d28dc&nbsp;<span class="hl_function"><b>rol</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">cl</span></li><li class="hl_l1">0x10d28de&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x38<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">0x10d28e1&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;0x017DB557</li>        </ol>
    </div>
</div></div>
<br>Начинается парсинг параметров команды. Здесь например читается индекс регистра общего назначения в контексте ВМ. Как не трудно догадаться их всего 32 по 64 бит<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">0x17db557&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x20<span class="hl_char">]</span></li><li class="hl_l1">0x17db55a&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;0x0000001F</li><li class="hl_l0">0x17db560&nbsp;<span class="hl_function"><b>shl</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;0x03</li><li class="hl_l1">0x17db563&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>edi</b></span>&nbsp;<span class="hl_comment">; в edi если не забыли - указатель на контекст</span></li>        </ol>
    </div>
</div></div>
<br>Здесь читается смещение. <br>Вообще есть разные способы доступа к памяти: [адрес], [IB+адрес], [IB+адрес&amp;3FFFFFFF], [CTX+адрес&amp;FFFF].<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">0x17db565&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x24<span class="hl_char">]</span></li><li class="hl_l1">0x17db568&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;0x3FFFFFFF</li>        </ol>
    </div>
</div></div>
<br>В большинстве команд имеются пара бит отвечающих за размер операндов (1,2,4 или 8 байт)<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">0x17db56e&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x22<span class="hl_char">]</span></li><li class="hl_l1">0x17db571&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;0x00000003</li><li class="hl_l0">0x17db577&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_registr">bl</span><span class="hl_char">,</span>&nbsp;0x00000000</li><li class="hl_l1">0x17db57a&nbsp;<span class="hl_function"><b>je</b></span>&nbsp;0x017DB59B</li>        </ol>
    </div>
</div></div>
<br>А теперь и само действие команды<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">0x17db59b&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;0x017DB5A0</li><li class="hl_l1">0x17db5a0&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0">0x17db5a1&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l1">0x17db5a3&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x000000B0<span class="hl_char">]</span></li><li class="hl_l0">0x17db5a9&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">bl</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ecx</span><span class="hl_char">-</span>0x0081B5A0<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_comment">;---</span></li><li class="hl_l0">0x17db5af&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>ebx</b></span>&nbsp;<span class="hl_comment">; в данном случае заносит в регистр значение из памяти</span></li><li class="hl_l1"><span class="hl_comment">;---</span></li><li class="hl_l0">0x17db5b1&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;0x0112167C</li>        </ol>
    </div>
</div></div>
<br>Завершается почти любой обработчик парсингом опкода следующей команды. Как видим команд максимум 128.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">0x112167c&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span>0x20<span class="hl_char">]</span></li><li class="hl_l1">0x112167f&nbsp;<span class="hl_function"><b>shr</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;0x05</li><li class="hl_l0">0x1121682&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;0x0000007F</li><li class="hl_l1">0x1121688&nbsp;<span class="hl_function"><b>shl</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;0x02</li><li class="hl_l0">0x112168b&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;0x01121690</li><li class="hl_l1">0x1121690&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">0x1121691&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">0x1121693&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;0x003E93D8</li><li class="hl_l0">0x1121699&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1">0x112169b&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;0xFFE9E970</li><li class="hl_l0">0x11216a1&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;0x011BD122</li><li class="hl_l1">0x11bd122&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">0x11bd124&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">]</span></li><li class="hl_l1">0x11bd126&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0">0x11bd128&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_registr"><b>edx</b></span>&nbsp;<span class="hl_comment">; переходим на обработку следующей команды</span></li>        </ol>
    </div>
</div></div>
<br><br><img src="img/attach.gif" alt=""> <a href="./files/59a7_24.10.2012_EXELAB.rU.tgz">59a7_24.10.2012_EXELAB.rU.tgz</a> - sakijapi_trace.txt
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313440&amp;user=3136&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=8" class="addthx" data-post="313440"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=17432" title="28-10-2012 12:49, ранг:335.7" target="_blank">ClockMan</a>, <a href="action=userinfo&user=33148" title="28-10-2012 13:09, ранг:2.0" target="_blank">Once</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Once[/b]','')">Once</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.71'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=33148">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2012 16:20 &middot; Поправил: Once <br><script type="text/javascript">QU('Once','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Once" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>Veliant</b>, спасибо большое за такие подробности!<br>А обязательно ли разбирать виртуальную машину?<br>Мне, по сути, нужно лишь сделать так, чтобы я свободно мог заниматься отладкой приложения. Обязательно ли при этом отвязывать защиту в виде dll?<br>Ещё вопрос: StarForce изменяет некоторые вызовы функций, вызывая их через переходники. Зачем он это делает, и обязательно ли убирать эти переходники?<br><br>З.Ы. Если не трудно, дайте ссылок по распаковке стара. Желательно чтобы там было побольше теории, а то те статьи, что я нашел, говорят лишь: - &quot;тыкните туда, затем сюда&quot;<br><br><b>UPD:</b> восстанавливать переходники нужно, потому что в оригинальном процессе и в сдампленном они иногда ведут в разные места. А вот почему так, понять пока не могу.<br>Вот, например, первый же вызов переходника по адресу <b>00A092AC</b> в оригинале ведет на API-функцию <b>_initterm_e</b>, а в дампе на <b>00A0982D</b>, в которой вызывается <b>_except_handler4_common</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313530&amp;user=33148&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=9" class="addthx" data-post="313530"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2012 16:58 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Стар вызывает другую функцию, если сработал антидамп или нарушена целостность вм. Если запатчить антидампы можно и не убивать переходники. Но импорт в любом случае лучше восстанавливать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313561&amp;user=4618&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=10" class="addthx" data-post="313561"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=33148" title="28-10-2012 13:08, ранг:2.0" target="_blank">Once</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Once[/b]','')">Once</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.71'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=33148">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2012 18:04 <br><script type="text/javascript">QU('Once','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Once" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Не получается перехоники восстановить...<br>Пытаюсь и вручную и скриптом в аттаче.<br>Буквально на третьем сверху какая-нить гадость. (terminate или crash или выводит не на ту функцию)<br>Почему так получается, если я даже не правлю ниодного байта? (в скрипте специально закомментчивал запись переходников)<br>Или стар как-то всё-таки отлавливает присутствие отладчика, несмотря на PhantOm&#039;а?<br><br><br><br><img src="img/attach.gif" alt=""> <a href="./files/a809_28.10.2012_EXELAB.rU.tgz">a809_28.10.2012_EXELAB.rU.tgz</a> - scrypt.txt
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313562&amp;user=33148&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=11" class="addthx" data-post="313562"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Pchelovod[/b]','')">Pchelovod</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=32468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2012 00:33 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('Pchelovod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pchelovod" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>Once</b><br>Старфорс 5.хх ломается элементарно,с помощью приклеивания к дампу основного exe секций из PROTECT.dll <br>А именно, sforce3 (самая здоровая,обычно 7-10 МБ) + диапазон памяти Private RWE (как правильно,от 10000000 и выше). Импорт даже не испорчен,это самая легкая версия Стара, ломается за 10 минут<br><br>Имейте ввиду,что снимать дамп нужно целиком всё сразу ,иначе у вас поплывет адрессация вызовов ВМ.<br>Т.е. к примеру, не будет работать дамп ,у которого разные блоки памяти сохранены на диск в разные разы запуска программы. Метод не ахти какой продвинутый,но по-крайней мере неоднократно проверен на работоспособность, причем на разных версиях старфорса
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313937&amp;user=32468&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=12" class="addthx" data-post="313937"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2012 07:26 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
И такой ехе будет работать только у тебя. Да и то, в старых версиях вм чекает pid. Но тогда это было сделано через апи, что легко патчиться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313942&amp;user=4618&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=13" class="addthx" data-post="313942"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Pchelovod[/b]','')">Pchelovod</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=32468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2012 21:06 &middot; Поправил: Pchelovod <br><script type="text/javascript">QU('Pchelovod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pchelovod" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Главное что будет работать. Сейчас у топикстартера как мне показалось,такая каша в голове,что он даже Basic версию не сможет правильно снять. Кому интересно,пишите,у меня есть мануалы в картинках как всё это сделать. Разумеется, такое УГ как Prime World я не исследовал и исследовать не собираюсь<br>Могу предложить мануал по снятию StarForce 5.50 Pro с игры Буратилло
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313961&amp;user=32468&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=14" class="addthx" data-post="313961"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Once[/b]','')">Once</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.71'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=33148">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2012 15:48 <br><script type="text/javascript">QU('Once','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Once" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>Pchelovod</b>, с версией 5.50 у меня получается справиться, в этой же, 5.70, что-то добавлено, что мешает мне сделать всё как в прошлых версиях.<br>Если не трудно, скиньте мануалы, мне будет интересно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313991&amp;user=33148&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=15" class="addthx" data-post="313991"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2012 16:06 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Та давайте уже мануалы в массы, а то я прямо-таки жутко заинтригован.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=313992&amp;user=6336&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=16" class="addthx" data-post="313992"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2012 16:23 <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Та давайте уже мануалы в массы, а то я прямо-таки жутко заинтригован.  </I><br>Сейчас тебя пчеловод научит как делать дампы размером в 100+ мб и которые работают только у тебя.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313993&amp;user=3136&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=17" class="addthx" data-post="313993"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2012 16:42 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>http://svinovod2012.livejournal.com/
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313994&amp;user=5291&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=18" class="addthx" data-post="313994"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2012 17:02 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Что-то там так много рассусоливал Свиновод, а можно всё уложить в пару предложений. Где-то (где - Свиновод не знает) внутри protect.dll идёт проверка диска, цель Свиновода - выкинуть этот код из окончательного дампа, что позволит отучить программу от диска. Поэтому он ищет ОЕР, восстанавливает импорт и к дампу прикручивает ВМ без разбора последней. ОЕР ищет GeTaOEP (как, Свиновод тоже не представляет), импорт восстанавливает импрек, дампит Pe Tools. ВМ определяется в лоб - если есть переходник, и это переходник не на эмулируемый импорт, то это ВМ. Дампится она вся, причём дампится набор, относящийся к текущему состоянию, а т.к. инициализация ВМ пропущена, то, при услоии, что это состояние не является допускающим, дамп на другой машине не заработает. Ресурсы, релоки - я не нашёл упоминания про эти страшные слова. В общем, этим действиям со старфорсом я могу научить своего пса.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=313995&amp;user=6336&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=19" class="addthx" data-post="313995"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]schokk_m4ks1k[/b]','')">schokk_m4ks1k</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 31.0 (посетитель), 70thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.43'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=31322">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2012 18:12 <br><script type="text/javascript">QU('schokk_m4ks1k','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=schokk_m4ks1k" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>В общем, этим действиям со старфорсом я могу научить своего пса. </I><br>или свинку домашнюю <img src="img/smilies/s5.gif" alt=""> <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313996&amp;user=31322&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=20" class="addthx" data-post="313996"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24946" title="07-11-2012 14:40, ранг:47.3" target="_blank">DimitarSerg</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2012 18:25 <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>В общем, этим действиям со старфорсом я могу научить своего пса.  </I><br>Посмотрел тут один nodvd от skidrow - не далеко ушли. Ехе с приклеенной ВМ + dll в которой сначала через GetProcAddress в нужные места прописываются адреса API, потом копируется в вм проинициализированные заранее данные. В итоге ехе на 40+ метров
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313997&amp;user=3136&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=21" class="addthx" data-post="313997"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24946" title="07-11-2012 14:41, ранг:47.3" target="_blank">DimitarSerg</a>, <a href="action=userinfo&user=31275" title="07-11-2012 15:12, ранг:13.6" target="_blank">TryAga1n</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2012 19:38 <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Давайте подождём авторитетного мнения пчеловода по этому поводу <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313998&amp;user=10534&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=22" class="addthx" data-post="313998"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]aspirin[/b]','')">aspirin</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/5336.gif" alt=""><br><span class=txtSm>Ранг: 111.0 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.05'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5336">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2012 19:56 <br><script type="text/javascript">QU('aspirin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=aspirin" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<b>tihiy_grom</b>, ну а чего язвить-то? <img src="img/smilies/s1.gif" alt="">. У меня где-то валялись тулзы (для избранных) по старке. Нет ни особо внятного описания, как их использовать, только пример, как выглядит код, и где надо что поправить. Больше ничего. Меня порадовали материалы <b>svinovod2012</b>, пусть даже и видно, что защиту разбирает не самый опытный боец.
<br><br><font size="1"><i>-----<br>Ламер - не профессия :))</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=313999&amp;user=5336&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=23" class="addthx" data-post="313999"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2012 20:01 <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>aspirin пишет:<br>tihiy_grom, ну а чего язвить-то? </I><br>Ну есть маленько, согласен ...<br><br>Мне просто очень понравился кусок в статьях, где было написано что тулза не правильно нашла OEP<br>И какбы не совсем понятно зачем браться за старфорс, если даже руками OEP не можешь найти и не представляешь как она должна выглядеть.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314000&amp;user=10534&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=24" class="addthx" data-post="314000"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Pchelovod[/b]','')">Pchelovod</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=32468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2012 22:01 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('Pchelovod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pchelovod" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
Мануал пришлось временно забросить,поскольку меня вызывали на допрос в прокуратуру. Разумеется,не из-за взлома игр,но пришлось временно залечь на дно. Возможно мой ЖЖ перечитывают в отделе К, поэтому я бы с радостью поделился своими наработками когда буду уверен что слежка закончилась <img src="img/smilies/s16.gif" alt=""><br><br>По поводу критики:<br>1. Размер дампа в конечном итоге будет не больше 10-15 МБ , так что поводов для паники нет. Даже если клеить всю выделенную память,какая только есть.<br>2. Привязка к CPUID нас не волнует,мы делаем файл для себя а не для сцены.Это 2 разные вещи.<br>3. Патч PROTECT.DLL будет разъяснен чуть позже,этому я посвящу отдельную главу.<br>4. Найти OEP можно и руками,поставив бряк на функцию GetStartupInfoA  либо GetModuleHandleA в зависимости от версии VisualC++ . У меня есть таблица всех возможных ОЕР в формате .docx ,кому надо могу выложить. <br>5. Разработка dll для декриптования SFFS - пока в разработке. Может быть появится через полгода или год.<br>6. Мануал по распаковке dll, восстановлению релоков - ну тоже через полгода может будет.Пока я этим не занимался,у меня всего 1 игра где надо распаковывать библиотека со старом.А в остальных случаях релоки нам не нужны.<br><br>Вот ещё рекомендую всем хорошую книгу по реверсингу:<br>http://forcoder.ru/cpp/windows-via-cc-programmirovanie-na-yazyke-visual-c-1099<br><br>Там содержится подробная информация,которая очень пригодится вам для распаковки StarForce и не только.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314007&amp;user=32468&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=25" class="addthx" data-post="314007"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2012 12:07 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
Данная техника годная, если нет желания ковырять ВМ, а хочется получить просто рабочую игрушку.<br><br>Чего нехватает:<br>1) Как когда-то посоветовал olenevod, нужно перед отладкой внедрить в процесс свою dll, которая будет выступать в качестве менеджера памяти. Это позволит более экономно выделять память для ВМ, что потом скажется на размере ехе<br><br>2) После склейки ехе с ВМ нужно сделать один из следующих вариантов:<br> a) Простой.Сделать свою dll, которая будет восстанавливать API и динамическую память для ВМ перед запуском.<br> б) Чуть сложней. Приклеить динамическую память в конец ехе, поправив указатели, а также сделать ребилд импорта с необходимыми функциями.<br><br>3) CPUID. Так же два варианта решения<br> a) Запатчить код в секции ВМ, который проверяет cpuid<br> б) Вместо cpuid (0FA2) везде воткнуть опкод ud2(0F0B), а потом ловить exception и подставлять нужные данные.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314035&amp;user=3136&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=26" class="addthx" data-post="314035"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Pchelovod[/b]','')">Pchelovod</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=32468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2012 13:55 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('Pchelovod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pchelovod" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
На версии 4.50 данный способ почему-то не работает. Дамп запускается,висит в памяти как процесс и грузить процессор на 100% ,но ничего не происходит. Какие-то дополнительные проверки видимо есть<br>Мне так сходу тяжело dll написать,потому что я VisualC++ начал изучать 2 месяца назад,специального образования программиста у меня нет,всё чему меня научили это Турбо Паскаль <img src="img/smilies/s6.gif" alt=""><br>Поэтому приходится и асм,и делфи,и си всё с нуля изучать. Постараюсь к Новому году выложить штук 6-7 мануалов с картинками,так что наберитесь терпения.<br><br><I>Veliant пишет:<br>Посмотрел тут один nodvd от skidrow - не далеко ушли. Ехе с приклеенной ВМ + dll в которой сначала через GetProcAddress в нужные места прописываются адреса API, потом копируется в вм проинициализированные заранее данные. В итоге ехе на 40+ метров  </I><br>А зачем разбирать и декомпилировать ВМ? Всё правильно они делают,есть простой способ - используй его.<br>Если RELOADED больше нечем заняться,как сидеть дешифровать 10 мегабайт обфусцированного кода (это наверно полмиллиона инструкций), то среднестатистическому реверсеру эта задача не под силу.<br><I>Once пишет:<br>с версией 5.50 у меня получается справиться, в этой же, 5.70, что-то добавлено, что мешает мне сделать всё как в прошлых версиях. </I><br>В каком смысле с 5.50 получается? Вы очевидно ломали Сталкера с basic версией, это единственная инструкция в картинках какая доступна в сети для общего обозрения. Там нет виртуальной машины
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314039&amp;user=32468&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=27" class="addthx" data-post="314039"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2012 22:29 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>Pchelovod</b><br>Даже теряюсь, с чего начать. Ладно, начнём как-нибудь.<br><br><i class=x>А зачем разбирать и декомпилировать ВМ?</i><br>Декомпиляция ВМ - основная работа, которая <b>должна</b> быть проделана, если вы хотите действительно отреверсить что-то в игре и написать чит или бота. Ведь вам нужно отреверсить протокол обмена инфой с сервером, узнать, как игра обращается с объектами игрового мира и научить бота выполнять некоторые действия за вас. А это невозможно, если вы не сможете исследовать игру в полной мере. Запустить её без диска при том, что алкоголь или Daemon Tools могут это сделать и без вас - умение не очень ценное само по себе.<br><br><i class=x>Если RELOADED больше нечем заняться,как сидеть дешифровать 10 мегабайт обфусцированного кода (это наверно полмиллиона инструкций), то среднестатистическому реверсеру эта задача не под силу.</i><br><br>Что ж вы так реверсинг-то обижаете. В том-то и сила, чтоб понять, как это делается - как изучать ВМ и строить декомпиляторы от версии к версии. Дерзайте.<br><br><i class=x>Мне так сходу тяжело dll написать,потому что я VisualC++ начал изучать 2 месяца назад</i><br>Так на турбо паскале пишите, не одна Microsoft Visual C++ умеет дллки собирать.<br><br>Особенно в блоге мне понравилась инфа про то, как надо прятать труп - самая полезная запись там.<br><br>Теперь в плане конструктива. Не совсем понял, что вы собираетесь патчить в protect.dll - по идее распакованная игра будет от неё полностью отвязана. Про то, что найти ОЕР можно и руками, это мы не сомневаемся, но поиск ОЕР должен успешно завершаться даже в случае, если нам изначально неизвестен компилятор, поэтому ваши методы не подойдут - нужно что-то более универсальное. Но ничего - лет через 5, может, и получится у вас анпак.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=314053&amp;user=6336&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=28" class="addthx" data-post="314053"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]CTPaHHuk[/b]','')">CTPaHHuk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.2 (гость), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.3'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=31711">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2012 23:44 <br><script type="text/javascript">QU('CTPaHHuk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=CTPaHHuk" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Особенно в блоге мне понравилась инфа про то, как надо прятать труп - самая полезная запись там. </I><br>первоё что бросилось в глаза при заходе на блог - это Как спрятать труп! повеселило хоть <img src="img/smilies/s5.gif" alt=""> <img src="img/smilies/s6.gif" alt=""> <img src="img/smilies/s5.gif" alt=""><br>я считаю если писать статьи о анпаке, нужно хотя бы самому уметь это делать <img src="img/smilies/s6.gif" alt=""> <br>панты конечно штука не очень плохая <img src="img/smilies/s3.gif" alt="">, но в реверсинге я считаю не умесна!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314055&amp;user=31711&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=29" class="addthx" data-post="314055"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Pchelovod[/b]','')">Pchelovod</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=32468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2012 02:33 <br><script type="text/javascript">QU('Pchelovod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pchelovod" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Не совсем понял, что вы собираетесь патчить в protect.dll - по идее распакованная игра будет от неё полностью отвязана </I><br>Насколько я помню,она в 90% случаев запакована UPX ,и чтобы загрузить жертву в отладчик с распакованной dll нужно пропатчить проверку контрольной суммы (Старфорс кричит что файл заражен вирусов и типа галактика в опасности)<br>Потом разумеется,можно её удалить.<br><I>ARCHANGEL пишет:<br>поиск ОЕР должен успешно завершаться даже в случае, если нам изначально неизвестен компилятор, поэтому ваши методы не подойдут - нужно что-то более универсальное </I><br>В чем проблема использовать GetTaOEP? Из всех способов что предлагает нам Рикардо Наварро у меня работал только бряк на первую API и то не всегда.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314064&amp;user=32468&amp;forum_n=1&amp;topic=20449&amp;page=0&amp;anchor=30" class="addthx" data-post="314064"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=1&amp;topic=20449&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=1&amp;topic=20449&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> StarForce 5.7 MMOG</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="20449">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=20449" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
