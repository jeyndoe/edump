<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Тулза для изменения строк в PE-файлах - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Приветствую. Мне потребовалось написать тулзу, которая будет изменять указанную пользователем строку в PE-файлах (.exe, .dll). Казалось бы, что может быть проще -- берём любой hex-редактор по вкусу, находим необходимую строку и">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Тулза для изменения строк в PE-файлах</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=24404&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=24404&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 12:48 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Приветствую.<br><br>Мне потребовалось написать тулзу, которая будет изменять указанную пользователем строку в PE-файлах (.exe, .dll).<br><br>Казалось бы, что может быть проще -- берём любой hex-редактор по вкусу, находим необходимую строку и лёгким движением руки видоизменяем её так, как требуется.<br>Проблема заключается в том, что строку необходимо *дополнять*, а для этого нам уже вполне может не хватить отведённого под неё изначально размера (разумеется, имеется ввиду место между окончанием нашей строки и началом следующих данных).<br><br>В качестве подопытного я взял утилиту nslookup.exe из официального дистрибутива Windows 8 (на всякий случай прикрепил её к данному сообщению).<br>Для примера я решил &quot;дополнить&quot; строку &quot;Non-existent domain&quot;, выводяющуюся при попытке resolve&#039;а несуществующего домена:<br><br>Default Server:  UnKnown<br>Address:  192.168.1.1<br><br>&gt; test<br>Server:  UnKnown<br>Address:  192.168.1.1<br><br>*** UnKnown can&#039;t find test: Non-existent domain<br><br>Открываем XVI32, ищем строку, находим её по &quot;физическому&quot; адресу 0x1A48 (это, вроде, raw address называется, поправьте меня, если я не прав). Здорово, значит, она действительно хранится в самом PE-файле, а не во внешних файлах ресурсов.<br><br>Вопроса два:<br>- Что делать дальше? Можно, наверное, найти все ссылки на эту строку и заменить их на другой адрес, по которому мы расположим &quot;увеличенную&quot; версию данной строки (заранее пробежавшись по PE-файлу и обнаружив незанятое место в виде NOP&#039;ов или 0x00). Вот только как искать эти ссылки?<br>- Почему указанная мной строка, если верить выхлопу PE Tools, хранится в секции .data? Она очень похожа на константную строку, почему же она тогда находится не в .rdata?<br><br>Может, есть готовое решение для подобной задачи, кстати?<br><br>Заранее благодарю.<br><br><img src="img/attach.gif" alt=""> <a href="./files/1c12_01.11.2016_EXELAB.rU.tgz">1c12_01.11.2016_EXELAB.rU.tgz</a> - nslookup.exe
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369087&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=1" class="addthx" data-post="369087"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]srm60171[/b]','')">srm60171</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.2 (новичок), 11thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.47'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=38652">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 12:52 <br><script type="text/javascript">QU('srm60171','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=srm60171" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
OgreGui
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369088&amp;user=38652&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=2" class="addthx" data-post="369088"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=37421" title="01-11-2016 10:14, ранг:8.5" target="_blank">b0r3d0m</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 13:09 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>srm60171 пишет:<br>OgreGui  </I><br>При попытке открыть всё тот же nslookup.exe:<br><br>&quot;Произошла критическая ошибка! Происходит выход. Обратитесь к разработчику программного обеспечения&quot;.<br><br><b>Добавлено спустя 4 минуты</b><br>Судя по всему, он не умеет работать с x64 приложениями. 32-битный .dll-файл открылся замечательно. Проверить само изменение строки, правда, пока не успел.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369089&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=3" class="addthx" data-post="369089"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]srm60171[/b]','')">srm60171</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.2 (новичок), 11thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.47'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=38652">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 13:56 <br><script type="text/javascript">QU('srm60171','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=srm60171" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
если падает, иногда помогает посбивать галки в настройках. <br><br>Пусть строка по raw address = 0x11223344<br>Ты преобразовал raw address в RVA (PE Tools это умеет) и результат равен 0xAABBCCDD<br>Пусть новая строка по raw address = 0x55667788<br>Также преобразовал в RVA и результат равен 0x9900EEFF<br>тогда тебе надо найти в программе все последовательности байт DD CC BB AA и заменить их на FF EE 00 99
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369091&amp;user=38652&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=4" class="addthx" data-post="369091"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]unknownproject[/b]','')">unknownproject</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.1 (постоянный), 247thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.52'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=27422">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 14:09 &middot; Поправил: unknownproject <br><script type="text/javascript">QU('unknownproject','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unknownproject" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>(это, вроде, raw address называется, поправьте меня, если я не прав </I><br>Нет.Это называется смещением или позицией от начала файла.Понятия адрес (как такового) для объекта, который не выгружается в оперативную память для выполнения, нет.Любой файл, открытый гекс-редактором - это просто двоичный файл.Форматным исполняемым файлом с адресацией он становится только при запуске под ОС и при условии, что является таковым.<br>Алгоритм замены будет примерно такой:<br>1.Получить размер строки-замены и размер оригинальной строки.<br>2.Отсчитать разницу между размером оригинальной строки и строкой-заменой.<br>3.Сместить все данные после этой строки на разницу.<br>4.Перезаписать строку.<br>5.Пересчитать размер файла и перестроить PE с правкой нужных полей.
<br><br><font size="1"><i>-----<br>TEST YOUR MIGHT</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=369092&amp;user=27422&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=5" class="addthx" data-post="369092"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=37421" title="01-11-2016 11:12, ранг:8.5" target="_blank">b0r3d0m</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 14:11 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Спасибо за пояснение. Попробовал проследовать вашей инструкции на примере всё того же nslookup.exe из первого сообщения.<br><br><I>srm60171 пишет:<br>Пусть строка по raw address = 0x11223344 </I><br>В моём случае строка &quot;Non-existent domain&quot; имеет raw address == 0x1A48.<br><br><I>srm60171 пишет:<br>Ты преобразовал raw address в RVA (PE Tools это умеет) и результат равен 0xAABBCCDD </I><br>Открыл File Location Calculator из состава PE Tools, ввёл 1A48 в &quot;File Offset&quot; и получил RVA == 0x00002648.<br><br>Однако попытка отыскать последовательность байт 48 26 не увенчалась успехом.<br><br>Я что-то не так понял?<br><br><b>Добавлено спустя 1 минуту</b><br><I>unknownproject пишет:<br>Нет.Это называется смещением или позицией от начала файла </I><br>Да, уже заметил по &quot;File Offset&quot; в PE Tools, спасибо.<br><br><b>Добавлено спустя 9 минут</b><br><I>unknownproject пишет:<br>Алгоритм замены будет примерно такой </I><br>А почему бы не пойти по тому пути, который предлагает <b>srm60171</b>? Т.е. заменить ссылки на изменяемую строку.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369093&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=6" class="addthx" data-post="369093"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 15:20 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>unknownproject</b><br>В корне не правильный алгоритм, ты так весь exe пересоберёшь в итоге.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369094&amp;user=16624&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=7" class="addthx" data-post="369094"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 15:33 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>MasterSoft пишет:<br>В корне не правильный алгоритм, ты так весь exe пересоберёшь в итоге </I><br>Почему весь exe? Насколько я понял, потребуется изменить лишь те байты, которые представляли предыдущий адрес изменённой строки.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369095&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=8" class="addthx" data-post="369095"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]LinXP[/b]','')">LinXP</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 89.1 (постоянный), 134thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.17'>Активность: 0.06<span style='color:green'>&nearr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=4748">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 15:48 <br><script type="text/javascript">QU('LinXP','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=LinXP" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>b0r3d0m</b><br><noindex><a href="http://4pda.ru/forum/showtopic=518750" rel="nofollow" target="_blank">Radialix</a></noindex> + ida<br>и там же<br>&quot;Как локализовать строки в коде&quot;<br>&quot;Как увеличить длину жестко-закодированной строки&quot;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369096&amp;user=4748&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=9" class="addthx" data-post="369096"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 16:27 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>Почему весь exe? Насколько я понял, потребуется изменить лишь те байты, которые представляли предыдущий адрес изменённой строки.<br> </I><br>Так и есть.<br>Вдобавок, в программах на паскале перед собственно  строкой идёт её длина (DWORD).<br>Ссылки могут быть как на этот DWORD, так и на саму строку. Это надо тоже учитывать.<br><br>Срециализированной тулзы для этой цели нет, да и быть не может.<br>Сегодня вот тут пытались агрессивно рекламировать такую себе &quot;bin ninja&quot;,<br>вот пускай разобравшиеся расскажут, как в ней сделать такое.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369097&amp;user=35473&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=10" class="addthx" data-post="369097"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=37421" title="01-11-2016 13:47, ранг:8.7" target="_blank">b0r3d0m</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 16:41 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>dosprog пишет:<br>Так и есть </I><br>Так вы тоже согласны с тем, что поменять адрес строки проще, чем изменять PE header?<br><br>Кстати, судя по тому, что я вижу, ссылки на строку представляют собой не RVA, а VA, как говорил <b>srm60171</b> вот в <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=-1#4" rel="nofollow" target="_blank">этом</a></noindex> сообщении. Кто прав?<br><br><I>dosprog пишет:<br>Вдобавок, в программах на паскале перед собственно строкой идёт её длина (DWORD) </I><br>Интересуют только незащищённые программы на C++, компилируемые MSVC.<br><br><b>Добавлено спустя 6 минут</b><br><I>LinXP пишет:<br>Radialix + ida </I><br>Спасибо за совет, гляну. Жаль, command line интерфейса нет, так бы написал свою небольшую обёртку для конкретно нашего использования.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369098&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=11" class="addthx" data-post="369098"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]LinXP[/b]','')">LinXP</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 89.1 (постоянный), 134thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.17'>Активность: 0.06<span style='color:green'>&nearr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=4748">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 17:03 &middot; Поправил: LinXP <br><script type="text/javascript">QU('LinXP','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=LinXP" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>Интересуют только незащищённые программы на C++, компилируемые MSVC </I><br><strike>тогда ida не понадобится, попробуй, изменил строку &quot;Non-existent domain&quot;</strike><br><br><br><img src="img/attach.gif" alt=""> <a href="./files/74c8_01.11.2016_EXELAB.rU.tgz">74c8_01.11.2016_EXELAB.rU.tgz</a> - nslookup_test.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369099&amp;user=4748&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=12" class="addthx" data-post="369099"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 17:08 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>LinXP пишет:<br>тогда ida не понадобится, попробуй, изменил строку &quot;Non-existent domain&quot; </I><br>А что именно вы сделали? Оригинальная строка, судя по XVI32, осталась прежней. Вы поместили видоизменённую строку в другое место и поменяли ссылки на неё в секции .text?<br><br>fc /b слишком большой дифф показывает, из него не совсем понятны изменения.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369100&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=13" class="addthx" data-post="369100"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]LinXP[/b]','')">LinXP</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 89.1 (постоянный), 134thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.17'>Активность: 0.06<span style='color:green'>&nearr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=4748">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 17:31 <br><script type="text/javascript">QU('LinXP','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=LinXP" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>b0r3d0m</b> ой, похоже Radialix ничего не изменил и нет текста который я добавил. значит нужно подключать через ida
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369101&amp;user=4748&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=14" class="addthx" data-post="369101"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 17:34 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>LinXP пишет:<br>b0r3d0m ой, похоже Radialix ничего не изменил и нет текста который я добавил. значит нужно подключать через ida  </I><br>Что значит &quot;нужно подключать через ida&quot;? Почему именно IDA?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369102&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=15" class="addthx" data-post="369102"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]LinXP[/b]','')">LinXP</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 89.1 (постоянный), 134thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.17'>Активность: 0.06<span style='color:green'>&nearr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=4748">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 17:46 <br><script type="text/javascript">QU('LinXP','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=LinXP" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>b0r3d0m</b> если в кратце, в иду Radialix подключает свой плагин (только для ida 5.5), для получения дополнительной информации и на базе этих данных уже &quot;собирает&quot; изменённый файл.. вообщем видосики глянь<br>жаль что автора уже нет и прожка больше не развивается
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369105&amp;user=4748&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=16" class="addthx" data-post="369105"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 17:49 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>Почему весь exe? Насколько я понял, потребуется изменить лишь те байты, которые представляли предыдущий адрес изменённой строки.  </I><br>почти весь, если придерживаться вот этого алго:<br><I>unknownproject пишет:<br>1.Получить размер строки-замены и размер оригинальной строки.<br>2.Отсчитать разницу между размером оригинальной строки и строкой-заменой.<br>3.Сместить все данные после этой строки на разницу.<br>4.Перезаписать строку.<br>5.Пересчитать размер файла и перестроить PE с правкой нужных полей.  </I><br>судя по этому, человек предлагает перезаписывать старую строку новой, предварительно увеличив размер файла на разницу строк. Если я всё правильно понял, то остальные данные съедут вперёд (ну либо назад), из-за этого загадим ссылки на другие строки, а если строка будет находиться в секции кода, тогда съедет и он, в таком случае фикс релоков только самое малое, что нужно будет сделать.<br><br><I>dosprog пишет:<br>Сегодня вот тут пытались агрессивно рекламировать такую себе &quot;bin ninja&quot;,<br>вот пускай разобравшиеся расскажут, как в ней сделать такое. </I><br>размер очень влияет на функционал проги. впредь никогда не буду качать софт весом больше метра. ты меня вдохновил, учитель, пишу из дос.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369106&amp;user=16624&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=17" class="addthx" data-post="369106"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 17:55 &middot; Поправил: b0r3d0m <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>MasterSoft пишет:<br>почти весь, если придерживаться вот этого алго </I><br>Упомянутый вами алгоритм действительно потребует перестроить почти весь исполняемый файл. Я же говорил про алгоритм, указанный <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=-1#4" rel="nofollow" target="_blank">тут</a></noindex>. На текущий момент лично мне он кажется наиболее оптимальным. А вы что думаете?<br><br>И да, остались непонятыми два момента:<br>- В секции .text ссылки на данные из секций .data / .rdata хранятся в виде RVA или VA? Всё в том же <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=-1#4" rel="nofollow" target="_blank">алгоритме</a></noindex> <b>srm60171</b> говорил про RVA, но на практике получается, что необходимо изменять всё же VA.<br>- Куда лучше всего помещать свои собственные &quot;увеличенные&quot; строки? В какую именно секцию? Имеет ли это вообще какое-то значение?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369108&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=18" class="addthx" data-post="369108"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 18:06 &middot; Поправил: MasterSoft <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>- Куда лучше всего помещать свои собственные &quot;увеличенные&quot; строки? В какую именно секцию? Имеет ли это вообще какое-то значение?  </I><br>убедиться, что в конце файла нет оверлея. создать новую секцию, поставить ей нужные права. пихать в неё новые строки, потом всё так как говорил <b>srm60171</b><br><br><I>b0r3d0m пишет:<br>- В секции .text ссылки на данные из секций .data / .rdata хранятся в виде RVA или VA? Всё в том же алгоритме srm60171 говорил про RVA, но на практике получается, что необходимо изменять всё же VA. </I><br>тот же OgreGui кажется умеет искать и VA и RVA ссылки. Если заглянуть в хэлп:<br><i class=x>Что такое RVA и VA?<br>Это способ указания адреса для некоторого блока данных, процедуры, текстовых данных, таблицы и т.д. Обычно используются для этого виртуальные адреса (VA). В системных областях программы используются относительные виртуальные адреса (RVA) - они указывают на ресурсы, таблицы импорта, экспорта и т.д. </i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369109&amp;user=16624&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=19" class="addthx" data-post="369109"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 18:11 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>MasterSoft пишет:<br>убедиться, что в конце файла нет оверлея. создать новую секцию, поставить ей нужные права </I><br>А почему именно так? Что плохого в помещении обновлённой строки в одну из существующих секций?<br><br><I>MasterSoft пишет:<br>тот же OgreGui кажется умеет искать и VA и RVA ссылки </I><br>Блин, т.е. в бинарнике могут встретиться и VA, и RVA ссылки на одну и ту же строку? Если да, то зачем так делают?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369110&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=20" class="addthx" data-post="369110"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 18:29 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>А почему именно так? Что плохого в помещении обновлённой строки в одну из существующих секций?<br> </I><br>Да ничего плохого нету.<br>Если найти пространство.<br>А его может и не быть.<br>Тогда придётся добавлять секцию, как тут писали выше.<br><br>Адреса в виде RVA обычно не встречаются. Компилятор для данных в программе генерирует смещения VA.<br><br><br><I>MasterSoft пишет:<br>размер очень влияет на функционал проги. впредь никогда не буду качать софт весом больше метра. ты меня вдохновил, учитель, пишу из дос.<br> </I><br>) Слушай, не начинай, а?<br>Размер не влияет на функционал, но размер при сходном функционале часто является показателем, как сопутствующий фактор.<br><br>А что до ниньзи - так пускай бы энтузиасты и рассказали, как в ней проделать требуемый поиск и замены строк.<br>Это было бы вполне уместно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369111&amp;user=35473&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=21" class="addthx" data-post="369111"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 18:30 &middot; Поправил: MasterSoft <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>А почему именно так? Что плохого в помещении обновлённой строки в одну из существующих секций? </I><br>не обязательно свободное место в конце секции для выравнивания и не обязательно в секции с данными только данные для чтения. нули могут быть под какой-то буфер и в итоге строку твою кто-то перезапишет. К тому же, что делать, когда свободное место кончиться, а переводить ещё много - всё-равно придётся лепить новую секцию. VA ищи.<br><br><I>dosprog пишет:<br>Слушай, не начинай, а? </I><br>сорян, не удержался, я не со зла.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369112&amp;user=16624&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=22" class="addthx" data-post="369112"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 18:39 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>dosprog пишет:<br>Если найти пространство </I><br>Да, разумеется, с учётом достаточного кол-ва свободного места.<br><br><I>MasterSoft пишет:<br>не обязательно свободное место в конце секции для выравнивания </I><br>Это да, согласен.<br><br><I>MasterSoft пишет:<br>нули могут быть под какой-то буфер и в итоге строку твою кто-то перезапишет </I><br>Это верно, но разве кто-то в реальных проектах пишет в секцию с данными? Компилятор такое без лишних ухищрений может сгенерить? Звучит просто скорее как исключение из правила, нежели правило, причём только в тех случаях, если разработчик явно сам того захотел.<br><br><I>MasterSoft пишет:<br>К тому же, что делать, когда свободное место кончиться, а переводить ещё много - всё-равно придётся лепить новую секцию </I><br>Мне всего одну строку видоизменить надо в каждом PE-файле, так что не думаю, что это будет проблемой. В крайнем случае выведу ошибку и предложу написать мне, чтобы разрешить этот вопрос.<br><br><I>MasterSoft пишет:<br>VA ищи </I><br>RVA на данные из .data / .rdata не встречаются или просто настолько редки, что на них можно забить?<br><br>=====================<br><br>Кстати, File Location Calculator из PE Tools не умеет работать с 64-битными адресами? Выглядит так, по крайней мере.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369114&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=23" class="addthx" data-post="369114"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 19:10 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>Кстати, File Location Calculator из PE Tools не умеет работать с 64-битными адресами? Выглядит так, по крайней мере.  </I><br>возьми <noindex><a href="http://www.ntcore.com/exsuite.php" rel="nofollow" target="_blank"><b>это</b></a></noindex><br><br><b>Добавлено спустя 0 минут</b><br><I>b0r3d0m пишет:<br>RVA на данные из .data / .rdata не встречаются или просто настолько редки, что на них можно забить? </I><br><I>dosprog пишет:<br>Адреса в виде RVA обычно не встречаются. Компилятор для данных в программе генерирует смещения VA. </I><br><br><b>Добавлено спустя 6 минут</b><br><I>b0r3d0m пишет:<br>Это верно, но разве кто-то в реальных проектах пишет в секцию с данными? Компилятор такое без лишних ухищрений может сгенерить? Звучит просто скорее как исключение из правила, нежели правило, причём только в тех случаях, если разработчик явно сам того захотел. </I><br>я бы не стал доверять кодерам, да и компиляторам тоже бы не стал.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369115&amp;user=16624&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=24" class="addthx" data-post="369115"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=37421" title="02-11-2016 16:59, ранг:9.3" target="_blank">b0r3d0m</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 20:31 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
Давайте проанализим.<br><br>Есть регион памяти(без разницы содержимое) и нам необходимо этот регион расширить. Есно он будет перекрываться с другим, за пределами исходного размера. Изменить данные за пределами исходного размера нельзя. Поэтому решение должно быть основано не на содержании, а на выборке данных. Тоесть нужно изменить ссылку на данные.<br><br>Найти ссылку на целевой блок памяти и изменить её.<br>   A. Изменить ссылку в модуле, прежде как то найти её. Это статический анализ, который разворачивается далее в виде очень сложной задачи(если нет прямой ссылки в виде фиксапа). Необходим полный анализ модуля или его рекомпиляция в общем случае, что сделать автоматикой невозможно(без ошибок).<br>   B. Отследить выборку данных по ссылке, это динамика. Возможны разные решения, это софтверный останов(эмуляция), хардверный останов в разных вариантах.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=369117&amp;user=40990&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=25" class="addthx" data-post="369117"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]elch[/b]','')">elch</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 19.4 (новичок), 11thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.81'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30254">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 23:21 <br><script type="text/javascript">QU('elch','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=elch" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>Кстати, File Location Calculator из PE Tools не умеет работать с 64-битными адресами? Выглядит так, по крайней мере.  </I><br>В <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=20736&amp;page=13.html" rel="nofollow" target="_blank">новом DiE</a></noindex> есть калькулятор x64.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369118&amp;user=30254&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=26" class="addthx" data-post="369118"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 23:30 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<I>MasterSoft пишет:<br>возьми это </I><br>Спасибо, не знал, что там Address Converter есть!<br><br><I>difexacaw пишет:<br>A. Изменить ссылку в модуле, прежде как то найти её. Это статический анализ, который разворачивается далее в виде очень сложной задачи </I><br>А что сложного? Я думал, что достаточно вычислить VA / RVA и найти обращение к соответствующему адресу в секции .text. Из подводных камней разве что тот факт, что в .text может происходить обращение не напрямую к этому адресу, а к вычисленному при помощи адресной арифметики. Вы это и имели ввиду или я что-то ещё упустил?<br><br>=========================================<br><br>А такой вопрос... Как оказалось, строка &quot;Non-existent domain&quot; из nslookup.exe находится в секции .text:<br><br><img src="http://i.imgur.com/c1Ta4Xi.png" border="0" align="" alt=""><br><br><img src="http://i.imgur.com/Qs19rMm.png" border="0" align="" alt=""><br><br><img src="http://i.imgur.com/5qB5DcD.png" border="0" align="" alt=""><br><br>Спрашивается, как так-то? Что она делает в секции, которая, в общем-то, предназначена для исполняемого кода?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369119&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=27" class="addthx" data-post="369119"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 04:27 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>b0r3d0m</b><br><br>Сказал ведь, если нет релока.<br><br>&gt; Спрашивается, как так-то? Что она делает в секции, которая, в общем-то, предназначена для исполняемого кода? <br><br>Секция RE, тоесть выборка данных из неё возможна, поэтому там располагается не только код, но и константы. Хотя это не хорошо.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=369122&amp;user=40990&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=28" class="addthx" data-post="369122"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 05:16 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>Спрашивается, как так-то? </I><br><br>Да вот так.<br>Если строка константа, то её компилятор может поместить и в секцию кода.<br>Особенно этим любил заниматься Delphi, как и TurboPascal в своё время.<br><br>Найденную ссылку на строку можете изменять - релок отработает прозрачно, даже если он там и есть.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369127&amp;user=35473&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=29" class="addthx" data-post="369127"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]neshta[/b]','')">neshta</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.79'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41390">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 05:39 <br><script type="text/javascript">QU('neshta','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neshta" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<I>dosprog пишет: вот пускай разобравшиеся расскажут, как в ней сделать такое. </I><br><br>как полыхает, идите на работу к Маску, ему как раз пригодится ракетный двигатель. <img src="img/smilies/s6.gif" alt=""><br>в хуюве даже секцию нельзя добавить, мощь.<br><br><I>difexacaw пишет: Возможны разные решения </I><br><br>В данном случае решения нет, автоматика невозможна, взять толстое приложение, например chrome или firefox, после подобных манипуляций придет пушной зверек, ибо помимо того, что гадят в секцию кода, так еще и арифметика со всякими там указателями, пройтись по всем ветвлениям затруднительно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369131&amp;user=41390&amp;forum_n=5&amp;topic=24404&amp;page=0&amp;anchor=30" class="addthx" data-post="369131"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=24404&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=24404&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Тулза для изменения строк в PE-файлах</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="24404">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24404" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
