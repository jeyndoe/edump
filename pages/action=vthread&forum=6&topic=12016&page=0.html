<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите скопировать файл WinAPI + ASM - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Имеется программа, авторан. лежит на сервере, по нажатии кнопки запускает презентацию. запускается с рабочей станции. доступ к папке с презентацией закрыт. участок кода, вызывающий ShellExecuteEx я нашёл, длина порядка 60-80">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a>, <a target='_blank' href='?action=userinfo&amp;user=50833'>vasilevradislav</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите скопировать файл WinAPI + ASM</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=12016&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=12016&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Neuss[/b]','')">Neuss</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.19'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11347">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2008 06:50 <br><script type="text/javascript">QU('Neuss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Neuss" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Имеется программа, авторан. лежит на сервере, по нажатии кнопки запускает презентацию. запускается с рабочей станции. доступ к папке с презентацией закрыт. участок кода, вызывающий ShellExecuteEx я нашёл, длина порядка 60-80 байт(там же обработчик ошибок). так вот мысль: после запуска авторана заменить в памяти этот участок на код, копирующий этот файл на рабочую станцию, затем нажать баттон и получить файл на руки. как дальше будет вести себя прога - неважно, всё равно закрывать. <br>Потому большая просьба: приведите пример рабочего кода, используя api, для копирования файла на asm. Если не трудно, с каментами. Заранее благодарен.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191161&amp;user=11347&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=1" class="addthx" data-post="191161"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2008 07:28 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Разбирай файл используя IDA pro или отладчик. Рабочий .asm файл получить почти невозможно - для этого надо ооочень долго мучить прогу в IDA. Выясни как прога достаёт презентацию и напиши свой эквивалент. На крайняк попробуй воткнуть свою .dll в процесс и из неё делай patch или перехват.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191164&amp;user=1737&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=2" class="addthx" data-post="191164"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]TrueLies[/b]','')">TrueLies</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3694.jpg" alt=""><br><span class=txtSm>Ранг: 192.7 (ветеран), 154thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3694">Участник</a><br><font color=blue>The ONE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2008 07:52 <br><script type="text/javascript">QU('TrueLies','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TrueLies" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>Neuss</b><br>Копирование файла на асме ...<br>Описание<br>function CopyFile(lpExistingFileName, lpNewFileName: PChar; bFailIfExists: BOOL): BOOL;<br><br>Копирует файл.<br><br>    Параметры:<br>lpExistingFileName: Строка к имени файлу источника.<br><br>lpNewFileName: Строка имени нового файла.<br><br>bFailIfExists:параметр определяет поведение функции в том случае если файл lpNewFileName уже существует. Если параметр True  и файл существует, то функция терпит неудачу. В противном случае функция перезапишет файл.<br><br>     Возвращаемые значения<br>Если успешно то не ноль.<br>Если функция терпит неудачу - ноль. Чтобы получить расширенную информацию об ошибке, вызовите функцию GetLastError. <br><br>Выглядит так - <b>invoke CopyFile,addr lpExistingFileName,addr  lpNewFileName,FALSE</b>
<br><br><font size="1"><i>-----<br>Сотрудник DHARMA</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=191165&amp;user=3694&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=3" class="addthx" data-post="191165"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Neuss[/b]','')">Neuss</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.19'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11347">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2008 12:38 <br><script type="text/javascript">QU('Neuss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Neuss" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
TrueLies,<br>спасибо! теперь накидаю мелкую прогу на асме, копирующую файл, затем скомпилю, и полученный код, именно копирующий файл вставлю в прогу.<br>Наверное я не совсем точно пояснил вопрос, я ищу собственно код asm (push,  call), так сказать скомпиленный. Но, имея функцию, думаю вечером разберусь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191181&amp;user=11347&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=4" class="addthx" data-post="191181"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]TrueLies[/b]','')">TrueLies</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3694.jpg" alt=""><br><span class=txtSm>Ранг: 192.7 (ветеран), 154thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3694">Участник</a><br><font color=blue>The ONE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2008 12:55 &middot; Поправил: TrueLies <br><script type="text/javascript">QU('TrueLies','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TrueLies" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>Neuss</b><br>PUSH 0                                             ; FALSE<br>PUSH 00400001                        ; NewFileName = &quot;&quot;<br>PUSH 00400002                        ; ExistingFileName = &quot;&quot;<br>CALL CopyFileA                                 ; вызываем CopyFileA<br><br>Соответственно по адресу 00400001 - имя нового файла, по адресу 00400002 - имя копируемого ...<br>Это только пример ...
<br><br><font size="1"><i>-----<br>Сотрудник DHARMA</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=191184&amp;user=3694&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=5" class="addthx" data-post="191184"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Neuss[/b]','')">Neuss</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.19'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11347">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2008 13:39 <br><script type="text/javascript">QU('Neuss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Neuss" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>TrueLies</b>,<br>Спасибо! Спешу домой пробовать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191193&amp;user=11347&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=6" class="addthx" data-post="191193"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2008 14:36 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>Neuss</b><br><I>Neuss пишет:<br>скомпилю, и полученный код, именно копирующий файл вставлю в прогу.</I><br>есть вариант лучше:<br>напиши длл, скомпилируй её, инжекть её в процесс.<br>так будет проще
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=191198&amp;user=1379&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=7" class="addthx" data-post="191198"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2008 15:18 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I><b>Neuss</b> пишет:<br>Спешу домой пробовать. </I><br><br>Обязательно отпиши что из этого получится.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191202&amp;user=702&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=8" class="addthx" data-post="191202"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Neuss[/b]','')">Neuss</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.19'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11347">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2008 22:47 &middot; Поправил: Neuss <br><script type="text/javascript">QU('Neuss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Neuss" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>Jupiter</b>,<br>Дело в том, что сам exe файл лежит на сервере - изменить его там нет возможности, его только можно запустить на рабочей станции. Единственный выход - пропатчить запущенную программу в памяти раб станции. И следов меньше.<br><br>Так вот что вышло:<br>В Olly останавливаю прогу после нажатия кнопки (Кстати прога на Дельфи 6-7) и переписываю участок кода (что в будущем будет делаться мелкой прогой). Текст (пути к файлам) заранее заменил. Но! Конечный файл могу задать абсолютным путём, а исходный - только относительным (т.к. его точное положение на сервере неизвестно). Тут вся и проблема. Если прога попадает в подпапку - то она уже не понимает относительного адреса (&quot;\Data\msg.asm&quot;). Для проб написал вот такое:<br><br><code>.386<br>      .model flat, stdcall<br>      option casemap :none   ; case sensitive<br><br>      include \masm32\include\windows.inc<br>      include \masm32\include\user32.inc<br>      include \masm32\include\kernel32.inc<br><br>      includelib \masm32\lib\user32.lib<br>      includelib \masm32\lib\kernel32.lib<br><br>    .data<br>	MsgBoxCaption db &quot;Message&quot;,0<br>	MsgBoxText    db &quot;Complete&quot;,0<br>                SrcFile  db &quot;\msg.asm&quot;,0<br>                DestFile  db &quot;\msg1.asm&quot;,0<br><br>    .code<br><br>start:<br>                invoke CopyFile,addr SrcFile, addr DestFile, FALSE <br>	invoke MessageBox, NULL, addr MsgBoxText, addr MsgBoxCaption, MB_OK<br>	invoke ExitProcess, NULL<br>end start</code><br><br>Окошко вылетает только для того чтобы увидеть прогу. CopyFile ошибок не возвращает, в EAX 0. В корне диска копирует. Оба файла кидаю в папку - результата нет. Как исправить ситуацию?<br><br>Вот ещё грабли... В HView 6.12 переписываю код на свой. Всё нормально в дизассемблере выглядит, но в Olly вижу следующее:<br><code>004DFFA3   .  58                POP EAX<br>004DFFA4   .  5B                    POP EBX<br>004DFFA5   .  6A 00               PUSH 0<br>004DFFA7   .  68 A8014E00   PUSH AutoRun.004E01A8                          ;  ASCII &quot;C:\file.pps&quot;<br>004DFFAC   .  53                   PUSH EBX<br>004DFFAD      E8                   DB E8<br>004DFFAE   .  D27432 00      SAL BYTE PTR DS:[EDX+ESI],CL<br>004DFFB2   .  C3                   RETN<br></code><br><br>Вместо:<br><br><code>004DFFA3   .  58                     POP EAX<br>004DFFA4   .  5B                    POP EBX<br>004DFFA5   .  6A 00                PUSH 0<br>004DFFA7   .  68 A8014E00    PUSH AutoRun.004E01A8                          ;  ASCII &quot;C:\file.pps&quot;<br>004DFFAC   .  53                     PUSH EBX<br>004DFFAD      E8 D268F2FF   CALL &lt;JMP.&amp;kernel32.CopyFileA&gt;<br>004DFFB2   .  C3                    RETN<br></code><br><br>Т.е. call не определяется Olly, вместо него данные. Повторюсь, в дизассембелере всё как во втором примере. Неясно почему:<br><br>HView пишет E8D2743200 (call 00406884)<br>Olly пишет E8 D268F2FF (call 00406884)<br><br>При замене кода в Olly всё отработало &quot;на ура&quot;. Получив из программы абсолютный путь к исходному файлу, функция полностью скопировала файл на новое место. Правда в EAX было &quot;1&quot;... После прога выдала ошибку (что и понятно). После нажатия Ок продолжила работу. Но это уже не важно.<br><br>P.S. первые два pop&#039;а достают из стека абсолютный адрес исходного файла. Нашёл место где сама прога его получает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191266&amp;user=11347&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=9" class="addthx" data-post="191266"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Sh[AHT][/b]','')">Sh[AHT]</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 77.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=145">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июня 2008 00:39 &middot; Поправил: Sh[AHT] <br><script type="text/javascript">QU('Sh[AHT]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sh[AHT]" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>Neuss пишет:<br>то она уже не понимает относительного адреса (&quot;\Data\msg.asm&quot; </I><br>Это не относительный путь, а абсолютный - первый слеш указывает на корень текущего диска. Поэтому в корне диска работает, а в подпапке нет. Попробуй просто &quot;Data\msg.asm&quot;. Ну или так &quot;.\data\msg.asm&quot;.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191276&amp;user=145&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=10" class="addthx" data-post="191276"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июня 2008 00:45 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>Neuss пишет:<br>Дело в том, что сам exe файл лежит на сервере - изменить его там нет возможности, его только можно запустить на рабочей станции. </I><br><br>и как это мешает инжекту длл в память процесса?
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=191277&amp;user=1379&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=11" class="addthx" data-post="191277"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Neuss[/b]','')">Neuss</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.19'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11347">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июня 2008 05:43 <br><script type="text/javascript">QU('Neuss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Neuss" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>Jupiter</b>,<br>&quot;В память&quot; я пропустил, извиняюсь, теперь идея ясна. Просто я не совсем представляю как это сделать. Опыта маловато. Для меня проще переписать участок памяти - тут я в курсе дела.<br><br><b>Sh[AHT]</b>,<br>Спасибо! Снова жду вечера, буду продолжать.<br><br>Вопрос про Olly и HView остался..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191287&amp;user=11347&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=12" class="addthx" data-post="191287"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июня 2008 06:52 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>Neuss</b> это от того, что ты не знаешь PE формат. Когда ты скомпилил код на асме, линкер собрал файл и получилось следующее:<br><br>Он сделал тебе таблицу импорта, в этой таблице хранятся указатели на имена функций. При загрузке указатели заменяются на абсолютные адреса функций, т.к. в каждой системе адрес одной и той же функции разный.<br><br>Где то в коде он вставил примерно такой код:<br>jmp dword ptr [xxxxxxxx], где xxxxxxxx адрес ячейки таблицы, где хранится адрес апи функции CopyFileA.<br><br>А код <br>004DFFA3 . 58 POP EAX <br>004DFFA4 . 5B POP EBX <br>004DFFA5 . 6A 00 PUSH 0 <br>004DFFA7 . 68 A8014E00 PUSH AutoRun.004E01A8 ; ASCII &quot;C:\file.pps&quot; <br>004DFFAC . 53 PUSH EBX <br>004DFFAD E8 D268F2FF CALL &lt;JMP.&amp;kernel32.CopyFileA&gt; <br>004DFFB2 . C3 RETN<br><br>CALL &lt;JMP.&amp;kernel32.CopyFileA&gt;  как раз и вызывает этот jmp dword ptr [xxxxxxxx].<br><br>Подведем итог. Для того чтобы CALL &lt;JMP.&amp;kernel32.CopyFileA&gt; сработал нужно в программе найти jmp dword ptr [addr_of_copyfilea] и сделать так, чтобы CALL &lt;JMP.&amp;kernel32.CopyFileA&gt; указывал на него.<br><br>Но! jmp dword ptr [addr_of_copyfilea] может и не быть, если программа не пользуется этой апи, тогда есть 2 варианта.<br><br>1) Вычислить адрес апи самому через GetModuleHandleA(&#039;kernel32&#039;)/GetProcAddress. Это с одной стороны не сложно, т.к. в программе, скомпиленой на Delphi ты 100% найдешь jmp dword ptr [addr_of_GetModuleHandleA] и jmp dword ptr [addr_of_GetProcAddress], но с другой стороны это достаточно сложно для новичка, т.к. нужны хотябы поверхностные знания вирусмакерства в области базонезависимого кода.<br><br>2) Если Использовать код на одной системе, то можно вписать известный адрес CopyFileA, типа так (чтобы не париться со смещениями):<br>push<br>push<br>push<br>call MyCopy<br>***<br>MyCopy:<br>push 77665544<br>retn<br><br>В любом случае импорт не такая простая штука.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=191289&amp;user=3232&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=13" class="addthx" data-post="191289"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Neuss[/b]','')">Neuss</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.19'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11347">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июня 2008 07:14 <br><script type="text/javascript">QU('Neuss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Neuss" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>PE_Kill</b>,<br>я брал W32Dasm, в нём открыл список имортированных функций, нашёл kernel32.CopyFileA и перешёл к строке где стоит jmp на функцию. И этот адрес писал в call.<br>До этого &quot;родная&quot; ShelllExecuteA&quot; ссылалась на похожий адрес, но уже своего jmp.<br>Получается что адрес api функции можно вычислить и использовать нужную функцию, даже если в норме она программой не используется?<br><br>На всякий случай, что лучше с вашей точки зрения: добавить длл или код править? по-любому должна же быть внешняя программа, добавляющая длл в прогу или пишущая свой код... и сложно ли длл добавить?<br><br>p.s. читаю msdn в поисках функции копирования директории. Только найти немогу. Выходит копировать надо через FindFirstFile и FindNextFile?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191292&amp;user=11347&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=14" class="addthx" data-post="191292"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июня 2008 18:07 &middot; Поправил: ToBad <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>Neuss</b> я вот всё равно не пойму принципа. Вы правите программу которая имеет доступ к папке с нужными файлами, а пользователю доступ туда закрыт ? Таким образом любая вызываемая из тела программы функция для работы с файлами имеет доступ, а Вы нет ? Если дело в правах, то что мешает вызвать из программы через shellexecute фар, тотал или cmd.exe ? Административные права будут унаследованы... Или я чего то не понял ?<br><br><I><b>Neuss</b> пишет:<br>Неясно почему:<br><br>HView пишет E8D2743200 (call 00406884)<br>Olly пишет E8 D268F2FF (call 00406884)  </I><br><br>У меня была похожая проблема только с dll. Я пытался вставить код в область указанную в релоках...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191345&amp;user=702&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=15" class="addthx" data-post="191345"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Neuss[/b]','')">Neuss</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.19'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11347">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июня 2008 23:37 &middot; Поправил: Neuss <br><script type="text/javascript">QU('Neuss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Neuss" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>ToBad</b><br>Выходит всё равно откуда будет запущен фар, главное кем будет запущен?<br><br>А по поводу &quot;неправильного&quot; call нашёл решение - надо было смещение указывать, а не адрес. <br><br>Глупый <b>вопрос</b>: как создать переменную с hex данными? Нашёл такой пример, но masm32 ругается<br>Bytes      DD     50 00 00<br>пробовал так: выглядит отлично, но стоит добавить A8h и подобные, начинающиеся с буквы - ругается...<br>Bytes db 58h, 5Bh, 6Ah, 00h, 68h,<br><br>Нигде найти информацию не смог, потому прошу помощи.<br><br>p.s. Если не трудно, напишите, где можно прочитать о работе с массивами в masm32. Как создать и как обеспечить доступ к нему.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191386&amp;user=11347&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=16" class="addthx" data-post="191386"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июня 2008 01:32 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I><b>Neuss</b> пишет:<br>Выходит всё равно откуда будет запущен фар, главное кем будет запущен?  </I><br><br>Если я правильно понял - то да.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191391&amp;user=702&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=17" class="addthx" data-post="191391"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Zorn[/b]','')">Zorn</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 53.9 (постоянный), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.25'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4376">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июня 2008 04:16 <br><script type="text/javascript">QU('Zorn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Zorn" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>Neuss пишет:<br>Глупый вопрос: как создать переменную с hex данными? Нашёл такой пример, но masm32 ругается<br>Bytes DD 50 00 00<br>пробовал так: выглядит отлично, но стоит добавить A8h и подобные, начинающиеся с буквы - ругается...<br>Bytes db 58h, 5Bh, 6Ah, 00h, 68h,<br> </I><br>Попробуй 0 добавить перед буквой
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191401&amp;user=4376&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=18" class="addthx" data-post="191401"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Neuss[/b]','')">Neuss</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.19'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11347">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июня 2008 06:36 <br><script type="text/javascript">QU('Neuss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Neuss" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>ToBad</b><br>Спасибо за идею, напишу 2 патча. Один просто выкачает файл, другой запускаь ФАР будет, попробую, отпишусь когда проверю на сервере.<br><br><b>Zorn</b><br>Спасибо! Помогло.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191408&amp;user=11347&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=19" class="addthx" data-post="191408"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июня 2008 07:57 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>Neuss пишет:<br>Получается что адрес api функции можно вычислить и использовать нужную функцию, даже если в норме она программой не используется? </I><br>Да, конечно. А как по твоему вирусы в телах программах живут? Они вообще понятия не имют какие функции программа использует.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=191413&amp;user=3232&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=20" class="addthx" data-post="191413"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]TrueLies[/b]','')">TrueLies</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3694.jpg" alt=""><br><span class=txtSm>Ранг: 192.7 (ветеран), 154thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3694">Участник</a><br><font color=blue>The ONE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июня 2008 09:54 &middot; Поправил: TrueLies <br><script type="text/javascript">QU('TrueLies','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TrueLies" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>Neuss пишет:<br>Получается что адрес api функции можно вычислить и использовать нужную функцию, даже если в норме она программой не используется? </I><br>--&gt; Вот &lt;-- http://www.zshare.net/download/131944779c5bd073/  пример экзешника (+ исходник) вообще без импорта, все апи он вычисляет сам ... пример из пакета masm.
<br><br><font size="1"><i>-----<br>Сотрудник DHARMA</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=191426&amp;user=3694&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=21" class="addthx" data-post="191426"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Neuss[/b]','')">Neuss</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.19'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11347">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2008 22:30 <br><script type="text/javascript">QU('Neuss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Neuss" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Дело продолжается... Патчер меняющий код для выкачивания конкретного файла уже есть и работает, проверен в условиях домашней сети двух компов.<br><br>В процессе переписывания кода для запуска TotalCommander встретил новую проблему: необходимо записать данные в память (переменную). Оказалось что любое место в проге не пожходит для этих целей... <br><br>004DFFAA   .  A3 F0FF4000   MOV DWORD PTR DS:[40FFF0],EAX            ;  AutoRun.00400000<br><br>Выдаёт ошибку записи в память. Если не трудно, объясните в двух словах от чего это? и где в норме выделяется память для переменных(как найти её у конкретной программы)?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191605&amp;user=11347&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=22" class="addthx" data-post="191605"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2008 00:06 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
MOV DWORD PTR DS:[40FFF0],EAX<br><br>Возможно, по адресу находится область памяти в которую нет прав на запись (секция кода например), чтобы записать нужно сначала заюзать api функцию VirtualProtect<br><br>push  x                             ;pOldProtect, куда сохраним старые права доступа<br>push  4                             ;NewProtect, это новые, 4 значит на чтение/запись<br>push  y                             ;Size размер памяти<br>push 40FFF0                     ; Address начало памяти<br>Call VirtualProtect
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=191609&amp;user=2981&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=23" class="addthx" data-post="191609"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2008 02:15 <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
Я что то не догоняю или тут какая то магия... Есть возможность запустить бинарник с удаленого компа, но нет возможности скопировать его оттуда? Что за ахинея? Чтобы файл запустился на локальной машине он должен будет скачаться на локальную машину так или иначе. Хрен с ним поверю что нельзя скопировать стандартными срествами винды, но что мешает сдампить файл? Или опять волшебство мелкософта? <br><br>Файлы не стартуют от имени владельца файла. Они стартую от имени пользователя который запускает файл. Запущеный процесс может пораждать процессы и они унаследуют права этого пользователя, но никоем образом права повыситься не могут. Так что если прога читает файлы значит права у пользователя на чтение есть 100% !!! Другое дело что на листинг/обзор папки прав может небыть и тогда только нужно знать имена файлов чтобы скопировать/прочесть их.<br><br>Я понимаю что метод с инжектами и правкой кода на лету это метод интересный, но помоему это тоже самое что вырезать гланды через толстую кишку.
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=191612&amp;user=2365&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=24" class="addthx" data-post="191612"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Neuss[/b]','')">Neuss</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.19'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11347">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2008 07:51 <br><script type="text/javascript">QU('Neuss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Neuss" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>[HEX],</b><br>Возможность взять бинарник есть и он взят. Во нужен не он. Пример: На сервере есть папка Program - доступ только чтение, в ней подпапка Data - чтение запрещено.<br>Есть прога авторан - по нажатии кнопки запускает искомую прогу из папки Data, сама находится в Program.<br>Очевидно же, если прога может запустить оттуда файл, значит может и скопировать. Просто зайти через проводник и подобные в Data нельзя, от того и нужен патч.<br><br><b>[Flint]</b>,<br>Спасибо!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191618&amp;user=11347&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=25" class="addthx" data-post="191618"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2008 13:34 &middot; Поправил: [HEX] <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<b>Neuss</b><br>В папку Data не можешь зайти и скопировать её не можешь? Но прога читает оттуда файлы? Значит на папке стоит запрет на просмотр содержимого, но читать файлы ты можешь! Тебе только нужно знать имена файлов в этой папке (наверное в проге авторане прописаны все имена файлов).<br><br> <img src="http://img257.imageshack.us/img257/2602/folderbh0.th.jpg" border="0" align="" alt=""> http://img257.imageshack.us/my.php?image=folderbh0.jpg <br><br>Чтобы не заморачиваться со всякой отладкой и просмотром байтиков думаю будет достаточно посмотреть открытые или открываемые файлы во время запуска проги. Например с помощью Process Monitor от Sysinternals. Получишь полный путь до файла в папке Data. Ну а потом в том же фаре можно скопировать будет ручками.
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=191636&amp;user=2365&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=26" class="addthx" data-post="191636"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 июня 2008 02:58 &middot; Поправил: Jupiter <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
чтобы скопировать файл, не заходя в каталог, создай bat/cmd файл для копирования файла:<br><br><br><code>@echo off<br>Set SourcePath=путь до папки дата, в которой лежит файл<br>Set DestPath=локальный путь<br>Set SourceFile=файл в папке дата (см. пост [HEX] про то, как получить имя файла)<br>Set DestFile=имя файла для сохранения локально, можешь выставить в %SourceFile%<br><br>@echo Copy file %SourceFile% from %SourcePath% to %DestPath%...<br>copy /B %SourcePath%%SourceFile% %DestPath%%DestFile%</code>
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=191692&amp;user=1379&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=27" class="addthx" data-post="191692"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Neuss[/b]','')">Neuss</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.19'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11347">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 июня 2008 06:46 &middot; Поправил: Neuss <br><script type="text/javascript">QU('Neuss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Neuss" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
Спасибо за множество оригинальных идей!<br>Дело вот в чём: мне известно что за файл и где он лежит. Уже есть патч на asm&#039;е заставляющий авторан копировать требуемый файл в локальную папку.<br>Однако рядом с папкой есть ещё много чего интересного.. Есть ли возможность того что прога (авторан) запущенная с сервера сможет найти все файлы (getfirstfile getnextfile) и по-очереди скопировать их? думаю для пробы надо написать.<br>Так же уже есть возможность запуска TotalCommander, как советовали. Может быть права на доступ передадутся от авторана. В ShellExecuteA hWnd окна, запустившего, передаётся.<br><br>Вопрос:<br>команда<br><br>mov eax, dword ptr[ebx+0C]<br><br>в еах помещает  данные из памяти по адресу в ebx длиной в OCh?<br><br>возможна ли запись:<br><br>mov eax, dword ptr[004DFFA8+0C]<br><br>При изменении &quot;OCh&quot; будет меняться длина загружаемой строки? И какова альтернатива при написании asm файла? <br>mov Variable1, eax - тут полностью перенесётся, а как урезать строку?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191694&amp;user=11347&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=28" class="addthx" data-post="191694"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 июня 2008 08:17 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<I>Neuss пишет:<br>команда mov eax, dword ptr[ebx+0C]<br>в еах помещает данные из памяти по адресу в ebx длиной в OCh?  </I><br><br>нет, в eax помещается 4 байта расположенные по адресу [ebx +0c], см. чему равен ebx, к примеру ebx = 00401000, тогда команда mov eax, dword ptr[ebx+0C], положит в eax данные (4 байта) которые расположены по адресу 0040100С.<br><br><br><I>Neuss пишет:<br>возможна ли запись:<br>mov eax, dword ptr[004DFFA8+0C] </I><br><br>конечно возможна <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=191697&amp;user=2981&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=29" class="addthx" data-post="191697"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Neuss[/b]','')">Neuss</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.19'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11347">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 июня 2008 10:24 <br><script type="text/javascript">QU('Neuss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Neuss" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12016&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
Тогда так:<br>по адресу 00403000 лежит строка &quot;C:\Program files\Program&quot; - всего 18h байт - переменная Path<br>требуется её укоротить до длины 10h - &quot;C:\Program files&quot; - т.е. либо указать ассемблеру что длина переменной сократилась, либо заново считать в переменную только 10h символов, начиная с того же адреса.<br><br>Как это будет выглядеть в asm файле?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191711&amp;user=11347&amp;forum_n=6&amp;topic=12016&amp;page=0&amp;anchor=30" class="addthx" data-post="191711"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=12016&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=12016&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите скопировать файл WinAPI + ASM</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="12016">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=12016" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
