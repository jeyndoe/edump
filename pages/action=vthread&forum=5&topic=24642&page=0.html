<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Проблема с двухслойной защитой. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Привет! Не получается разобраться с двойной защитой, в которой упаковщик MPress 2.17 + PeStubOEP 1.6. Прежде чем обратиться на форум попытался сам решить задачу: скачал PeStub и MPress и упражнялся с файлами, снимая защиту. По">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=6859'>cppasm</a>, <a target='_blank' href='?action=userinfo&amp;user=55996'>dutyfree</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Проблема с двухслойной защитой.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]CharlyChaplin[/b]','')">CharlyChaplin</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26839">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2017 12:14 &middot; Поправил: CharlyChaplin <br><script type="text/javascript">QU('CharlyChaplin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=CharlyChaplin" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24642.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Привет!<br>Не получается разобраться с двойной защитой, в которой упаковщик MPress 2.17 + PeStubOEP 1.6.<br>Прежде чем обратиться на форум попытался сам решить задачу: скачал PeStub и MPress и упражнялся с файлами, снимая защиту. По отдельности у меня получается, но здесь - нет. Читал разные Tutorials по восстановлению краденных байт, по распаковке, а также руководство(Распаковка PeStubOEP - двухслойная защита https://exelab.ru/rar/htm.php?n=085) с exelab.ru. Хотя и говорят там всё легко, но я не смог сам разобраться, сколько бы не бился. Прошу вашей помощи.<br><br>1. (Рис. 1) Проанализировал файл. Как видим имена секций затёрты.<br>2. (Рис. 2) Запускаем в отладчике и оказываемся в модуле ntdll. Жмём F9 и оказываемся на 5E7000. Из моего небольшого опыта я сразу понимаю, что здесь поработал PeStub. Но возник вопрос, что за адрес кладётся в стек - 5E425D? Не адрес ли это упаковщика? Также вопрос, с чего начинается программа, я в том плане, что изначально идёт не работа Stub, а как-будто начинает работу упаковщик, а потом уже идёт Stub. Может быть программа сначала была обработана Stubом, а потом упакована MPress?<br>3. (Рис. 3) Для интереса смотрю на адрес 5E425D и вижу PUSHAD, но что вызывается после него я так и не понял. Хотя вроде как после сохранения регистров переходят на упаковщик, если не ошибаюсь. Также я поставил бряк на GetModuleHandleA, как было в одном из руководств по распаковке MPress. Жмём F9 до тех пор, пока не остановимся на бряке.<br>4. (Рис 4.) После остановки мы оказываемся на GetModuleHandleA. Идём в конец и ставим бряк на выход из функции. Опять жмём F9, чтобы опять остановиться на этой функции. То есть первое срабатывание мы пропустили.<br>5. (Рис. 5) Пришли сюда второй раз. Выходим из функции и оказываемся на 44E870. Мотаем в конец, пока не увидим POPAD с последующим переходом на точку входа программы. POPAD для меня служит дополнительным подтверждением, что потом идёт именно OEP, т.к. упаковщик должен вернуть все регистры на свои места и передать управление программе.<br><br>Вроде всё нормально, но потом возникла проблема.<br><br>6. (Рис. 6) При помощи OllyDump дампим программу, находясь на OEP.<br>7. (Рис. 7) В ImpREC я хотел прикрутить импорт, но увидел вот это.<br><br>Вот здесь я остановился и просто не знаю что делать дальше. Импорта нет, прикручивать нечего. <img src="img/smilies/s4.gif" alt=""><br>Кто знает, помогите плиз.<br><br><img src="img/attach.gif" alt=""> <a href="./files/67bd_18.03.2017_EXELAB.rU.tgz">67bd_18.03.2017_EXELAB.rU.tgz</a> - Pic.7z<br>Извиняюсь, забыл выложить исследуемый файл: http://dropmefiles.com/IGeYS
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=373596&amp;user=26839&amp;forum_n=5&amp;topic=24642.html&amp;page=0&amp;anchor=1" class="addthx" data-post="373596"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Jaa[/b]','')">Jaa</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 134.1 (ветеран), 246thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.52'>Активность: 0.22<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=33657">Участник</a><br><font color=blue>realist</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2017 12:58 &middot; Поправил: Jaa <br><script type="text/javascript">QU('Jaa','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jaa" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24642.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Сам файл с &quot;двухслойной защитой&quot; где? Или вы предлагаете колдовать по скриншотам которые вы сделали?<br><br><b>Добавлено спустя -44 минут</b><br><I>CharlyChaplin пишет:<br>7. (Рис. 7) В ImpREC я хотел прикрутить импорт, но увидел вот это. </I><br>Если импрек автоматом не нашел то или ему надо указать его вручную или восстановить сначало импорт после протектора, а потом указывать. Дельный совет, почитайте вначале хотя бы основы &quot;Введение в крекинг с нуля, с помощью ollydbg&quot;. Миллион видео по распаковке несложных протекторов.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=373597&amp;user=33657&amp;forum_n=5&amp;topic=24642.html&amp;page=0&amp;anchor=2" class="addthx" data-post="373597"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]DimitarSerg[/b]','')">DimitarSerg</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/24946.png" alt=""><br><span class=txtSm>Ранг: 253.5 (наставник), 684thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.26'>Активность: 0.26<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=24946">Участник</a><br><font color=blue>radical</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2017 13:16 <br><script type="text/javascript">QU('DimitarSerg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DimitarSerg" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24642.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Для восстановления импорта попробуй Scylla заюзать.
<br><br><font size="1"><i>-----<br>ds</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373598&amp;user=24946&amp;forum_n=5&amp;topic=24642.html&amp;page=0&amp;anchor=3" class="addthx" data-post="373598"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2017 13:20 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24642.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>CharlyChaplin</b><br>Отвечаю на твой вопрос (рис. 3):<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">005E425E</span><span class="hl_char">:</span>&nbsp;E8&nbsp;<span class="hl_number">00000000</span>&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_number">005E4263</span>&nbsp;&nbsp;<span class="hl_comment">; call @F</span></li><li class="hl_l1"><span class="hl_number">005E4263</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; get ret address from stack</span></li>        </ol>
    </div>
</div></div>
<br><br>E8 00000000 - это call на адрес следующей команды.<br>Что происходит в момент вызова? В стек пушится адрес возврата. После чего происходит переход на новый адрес. В данном случае новый адрес - это следующая за этим call команда. Для информации: переход на адрес может быть не только через jmp, но и через push address / ret. Тогда при ret будет переход на address.<br>Таким образом, следующая команда <b>pop eax</b>, забирает из стека адрес возврата, который туда лёг в результате предыдущего вызова call.<br>Этот трюк используется для получения текущего адреса в базонезависимом коде.<br><br>Что происходит дальше:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">005E4264</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">05</span>&nbsp;<span class="hl_number">5A0B0000</span>&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0B5Ah</span>&nbsp;<span class="hl_comment">; + data offset</span></li><li class="hl_l1"><span class="hl_number">005E4269</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">8B30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span>&nbsp;&nbsp;<span class="hl_comment">; load data</span></li><li class="hl_l0"><span class="hl_number">005E426B</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">03F0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span><span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; fix data ptr</span></li>        </ol>
    </div>
</div></div>
<br><br>1. Получение смещения данных (текущий адрес + 0B5Ah = 005E425E + 0B5Ah = 5E4DB8h)<br>2. Загрузка данных<br>3. Исправление указателя
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373599&amp;user=1379&amp;forum_n=5&amp;topic=24642.html&amp;page=0&amp;anchor=4" class="addthx" data-post="373599"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=26839" title="18-03-2017 18:28, ранг:0.7" target="_blank">CharlyChaplin</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]CharlyChaplin[/b]','')">CharlyChaplin</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26839">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2017 22:26 <br><script type="text/javascript">QU('CharlyChaplin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=CharlyChaplin" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24642.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Извиняюсь, забыл выложить исследуемый файл: http://dropmefiles.com/IGeYS
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=373608&amp;user=26839&amp;forum_n=5&amp;topic=24642.html&amp;page=0&amp;anchor=5" class="addthx" data-post="373608"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 марта 2017 04:46 <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24642.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
инфа для распаковки<br><img src="https://s12.postimg.org/3u7i5u7el/Clipboard02.png" border="0" align="" alt=""><br><br>кстати внутри встроили западло типа дополнительной заshitы<br><br>1. 0044DE1A    cmp eax, 1C6713  ; проверка на размер файла<br>2. 0044DE25    call 0044D4BC       ; в процедуре читаются байты из файла, если не совпадут - вырубает комп через ExitWindowsEx
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=373624&amp;user=26242&amp;forum_n=5&amp;topic=24642.html&amp;page=0&amp;anchor=6" class="addthx" data-post="373624"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=26839" title="19-03-2017 05:08, ранг:0.7" target="_blank">CharlyChaplin</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]CharlyChaplin[/b]','')">CharlyChaplin</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26839">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 марта 2017 09:23 &middot; Поправил: CharlyChaplin <br><script type="text/javascript">QU('CharlyChaplin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=CharlyChaplin" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24642.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
AkaBOSS, спасибо огромное!<br>А нужно ли здесь восстанавливать байты после PeStub? Видимо я не с того места начинаю дампить.<br>Почему-то после дампа и восстановления импорта загрузка в отладчике всё равно начинается с ntdll. То есть распаковка не произошла.<br>Также, почему результаты в ImpREC и CHimpREC разные (на рисунке), хотя стою на OEP?<br><br><img src="img/attach.gif" alt=""> <a href="./files/63fa_19.03.2017_EXELAB.rU.tgz">63fa_19.03.2017_EXELAB.rU.tgz</a> - 1.png
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=373626&amp;user=26839&amp;forum_n=5&amp;topic=24642.html&amp;page=0&amp;anchor=7" class="addthx" data-post="373626"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 марта 2017 10:13 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24642.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>CharlyChaplin пишет:<br>А нужно ли здесь восстанавливать байты после PeStub? </I><br>о каких байтах речь? дамп стоя на оеп + прикрутить импорт, и всё работает<br><br><I>CharlyChaplin пишет:<br>загрузка в отладчике всё равно начинается с ntdll </I><br>по секрету - она и без отладчика оттуда начинается<br>в отладчике есть настройка, на какой точке останавливать приложение при запуске - системный старт, TLS, ModuleEntryPoint или WinMain (если определился)<br><br><I>CharlyChaplin пишет:<br>Также, почему результаты в ImpREC и CHimpREC разные (на рисунке), хотя стою на OEP? </I><br>а почему рва и размер IAT в импрек не ввёл?<br>автопоиск не всегда работает корректно, ручками надо учиться определять<br><br><noindex><a href="http://rgho.st/private/6wGp6fNPx/82ddabe97c83f3b1ca12fced16fdecda" rel="nofollow" target="_blank"><u>ВОТ</u></a></noindex> распак крч, изучай
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=373627&amp;user=26242&amp;forum_n=5&amp;topic=24642.html&amp;page=0&amp;anchor=8" class="addthx" data-post="373627"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=26839" title="22-03-2017 00:19, ранг:0.9" target="_blank">CharlyChaplin</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Проблема с двухслойной защитой.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24642" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
