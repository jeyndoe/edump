<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите в понимании. Ассемблерный код. функция. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Так как писал я на асме давно, то не помню как всё работает. Да и под windows я такого не писал, чтобы запомнить. У меня есть несколько вопросов относительно одной функции в крэкми. Она не относится ко взлому, но понимание как">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите в понимании. Ассемблерный код. функция.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]xverizex[/b]','')">xverizex</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 2.97'>Активность: 0.02<span style='color:green'>&nearr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=42839">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2019 00:37 <br><script type="text/javascript">QU('xverizex','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xverizex" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25982.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Так как писал я на асме давно, то не помню как всё работает. Да и под windows я такого не писал, чтобы запомнить. У меня есть несколько вопросов относительно одной функции в крэкми. Она не относится ко взлому, но понимание как устроена функция мне многое даст. Уж люблю хорошо вникнуть, чтобы было понятно очень хорошо. Я каждый вопрос пронумерую, чтобы было удобней отвечать на вопрос, поставив нужный номер вопроса.<br>1. В ida мне показывает начало функции.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">sub_402358&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;<span class="hl_function">near</span></li><li class="hl_l1">PerformanceCount<span class="hl_char">=</span>&nbsp;LARGE_INTEGER&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">-</span><span class="hl_number">14h</span></li><li class="hl_l0">SystemTimeAsFileTime<span class="hl_char">=</span>&nbsp;_FILETIME&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">-</span><span class="hl_number">0Ch</span></li><li class="hl_l1">var_4<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">-</span><span class="hl_number">4</span></li>        </ol>
    </div>
</div></div>
<br>Я посчитал, 14 - С = 8, то есть 8 байт. Но что 8 байт, perfomanceCount? Или как? Как то непривычно расчитывается. Под структуру SystemTimeAsFileTime тогда получается выделено c - 4 = 8, тоже 8 байт. Блин такое впечатление, будто я неправильно понимаю. Не может быть структура с двумя переменными по 4 байта. Значит я неправильно считаю. Так ли это?<br>2. Далее в коде вначале фукнции стоит такой код.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0"><span class="hl_function"><b>sub</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">14h</span></li>        </ol>
    </div>
</div></div>
<br>Это как раз выделяется для этих переменных память в стеке. Значит это стековые переменные. А как тогда глобальные выглядят в ida? Ну насчёт стековых это вроде точно, но так ли это?<br>3. Есть такой код<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>GetSystemTimeAsFileTime</li>        </ol>
    </div>
</div></div>
<br>Почему указывается ds? Как я уже знаю что в программе пишется список импорта. Значит они в данных записываются. Ведь их откуда же программы берут, чтобы показать какие функции экспортированы. Когда я заглянул в эту функцию, то увидел много других функций. Это что, все функции библиотеки экспортируются? Или только нужные? Хотя в отладчике когда я смотрел какую то программу, то там показывались функции, только те, которые использует программа. Значит это такая куча функций в крэкми, которые только запутывают код. Ну нафига делать вызовы ядра ( системные функции ), если хочется защитить от взлома программу.<br>4.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function">leave</span></li><li class="hl_l1"><span class="hl_function">retn</span></li>        </ol>
    </div>
</div></div>
<br>Я помню что если были входящие параметры для функции, то функция leave или retn, очищает стек. Допустим что стек не очищался, но для стековых переменных ebp был push, который остался в стеке, он куда девается?<br>5. Ну и последнее.<br>Тот крэкми, который я изучаю, содержит тупо мусор, если это были стековые переменные. Потому что не понятно зачем вызывать функции получения времени, функции получения id процесса и id потока, и в итоге вызвать функцию QueryPerformanceCounter, результат которой и будет использоваться вне функции. Видимо это для прикола так сделано, ибо непонятно зачем узнавать параметры, если они никак не обрабатываются.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=397025&amp;user=42839&amp;forum_n=5&amp;topic=25982.html&amp;page=0&amp;anchor=1" class="addthx" data-post="397025"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2019 01:04 &middot; Поправил: plutos <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25982.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>xverizex пишет:<br>для стековых переменных ebp был push, который остался в стеке, он куда девается? </I><br><br><b>Enter </b>creates a stack frame: <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_comment">; enter</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li>        </ol>
    </div>
</div></div>
<br><br>and <b>leave </b>destroys a stack frame:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_comment">; leave</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0"><span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">ebp</span></li>        </ol>
    </div>
</div></div>
<br><br><b>Ret</b>: Return from procedure. <br>Ret terminates execution a procedure and transfers the flow of control to the calling program. <br>Ret has an optional word operands: N.<br>This indicates the number of bytes that you want to be deleted on the stack <br>after the return address has been taken out of the stack.<br><br><I>xverizex пишет:<br> Это что, все функции библиотеки экспортируются? Или только нужные? </I><br><br>из dll, dynamically linked может быть использована любая функция, которую она экспортирует, но понятное дело, используются только те функции, которые нужны.
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=397026&amp;user=4773&amp;forum_n=5&amp;topic=25982.html&amp;page=0&amp;anchor=2" class="addthx" data-post="397026"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=2585" title="03-08-2019 02:20, ранг:1113.8" target="_blank">Gideon Vi</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]xverizex[/b]','')">xverizex</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 2.97'>Активность: 0.02<span style='color:green'>&nearr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=42839">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2019 01:14 <br><script type="text/javascript">QU('xverizex','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xverizex" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25982.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>plutos</b> о спасибо. И точно, leave восстанавливает кадр стека. Прочитал дополнительно в инете.<br><br><b>Добавлено спустя 3 часа 42 минуты</b><br>Кстати с локальными функциями и глобальными можно сделать самому программу и посмотреть результат. Надо попробывать и посмотреть что в ida получиться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=397027&amp;user=42839&amp;forum_n=5&amp;topic=25982.html&amp;page=0&amp;anchor=3" class="addthx" data-post="397027"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2019 05:36 <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25982.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>xverizex пишет:<br>можно сделать самому программу  </I><br><br>как сделаешь, не забудь выложить!
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=397028&amp;user=4773&amp;forum_n=5&amp;topic=25982.html&amp;page=0&amp;anchor=4" class="addthx" data-post="397028"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]xverizex[/b]','')">xverizex</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 2.97'>Активность: 0.02<span style='color:green'>&nearr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=42839">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2019 07:22 &middot; Поправил: xverizex <br><script type="text/javascript">QU('xverizex','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xverizex" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25982.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>plutos</b> хорошо. Я же хочу только одну функцию написать, чтобы посмотреть структуру. Но написана будет для линукс. Позже посмотрю как на windows дела обстоят.<br><br><b>Добавлено спустя 18 минут</b><br>Пока что не понел всех локальных переменных. Вот снимок<br><noindex><a href="http://s1.uploadpics.ru./images/byekqzdX1r.png" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br>Блин написано что ptr а ptr это указатель, который занимает 8 бит вроде или 8 байт, скорее всего 8 байт, ничего себе какой длинный размер, это из-за того наверное, чтобы можно было получить адрес в размере 8 байт.<br><br><b>Добавлено спустя 22 минуты</b><br>А значит в ассемблере все переменные становяться указателями на память. Понятно. Блин, автор форума не может что за столько времени сделать так, чтобы изображение нормально смотрелось в браузере, а не занимало больше экрана.<br><br><b>Добавлено спустя 24 минуты</b><br>Ещё почему то из сегмента cs:body присваивается 7, хотя сегмент cs как сегмент кода наверное имеется ввиду что в x86_64 один сегмент. Поэтому из cs. Так то почему из сегмента кода видна переменная, которая должна быть в сегменте данных? Наверное это из-за 64 разрядности. И сегмент здесь один. вот так.<br><br><b><font color="red">От модератора: Не юзай тег img на больших картинках</font></b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=397029&amp;user=42839&amp;forum_n=5&amp;topic=25982.html&amp;page=0&amp;anchor=5" class="addthx" data-post="397029"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Cigan[/b]','')">Cigan</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.89'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=208">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2019 12:16 <br><script type="text/javascript">QU('Cigan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Cigan" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25982.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>xverizex</b><br>Возьми ты уже книги и почитай, что бы вопросов было меньше. А то по каждому чиху тему создавать не комильфо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=397037&amp;user=208&amp;forum_n=5&amp;topic=25982.html&amp;page=0&amp;anchor=6" class="addthx" data-post="397037"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2019 15:27 <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25982.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
С такими вопросами надо не крякмисы предлагать и защиты от битхаков, а менструальные календари на басике писать. google:LARGE_INTEGER первая же ссылка срывает покровы: &quot;Represents a 64-bit signed integer value.&quot;. Глобальные переменные адресуются всеми существующими способами кроме как по базе esp/ebp. Дефолтный сегмент ds ида указывает просто для порядка: нет префикса, переключающего на другой сегмент, но ида считает долгом сегмент таки показать. Пофигу какое значение esp на момент эпилога leave+retn, смотреть псевдокод инструкции leave. Если результат какой-то апи нигде не используется, значит либо компилер, либо программу делали яркие и талантливые личности.
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=397038&amp;user=8075&amp;forum_n=5&amp;topic=25982.html&amp;page=0&amp;anchor=7" class="addthx" data-post="397038"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=33766" title="03-08-2019 12:53, ранг:44.1" target="_blank">BlackCode</a>, <a href="action=userinfo&user=37000" title="03-08-2019 16:21, ранг:5.8" target="_blank">Orlyonok</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 465thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2019 15:51 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25982.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<noindex><a href="https://stackoverflow.com/questions/19945479/what-is-security-cookie-in-c" rel="nofollow" target="_blank">--&gt; __security_cookie &lt;--</a></noindex>
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=397039&amp;user=17432&amp;forum_n=5&amp;topic=25982.html&amp;page=0&amp;anchor=8" class="addthx" data-post="397039"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]BlackCode[/b]','')">BlackCode</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33766.png" alt=""><br><span class=txtSm>Ранг: 71.5 (постоянный), 95thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.48'>Активность: 0.1<span style='color:green'>&nearr;</span>0.38</span><br>Статус: <a href="action=userinfo&amp;user=33766">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2019 15:53 &middot; Поправил: BlackCode <br><script type="text/javascript">QU('BlackCode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BlackCode" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25982.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>f13nd пишет:<br>С такими вопросами надо не крякмисы предлагать и защиты от битхаков, а менструальные календари на басике писать. </I><br>Скатился от смеха под стол <img src="img/smilies/s5.gif" alt=""><br>Не в бровь, а в глаз! <img src="img/smilies/s5.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=397041&amp;user=33766&amp;forum_n=5&amp;topic=25982.html&amp;page=0&amp;anchor=9" class="addthx" data-post="397041"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2019 16:56 &middot; Поправил: Clerk <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25982.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>f13nd</b><br><br>&gt;  календари на басике писать.<br><br>Выхлоп vb это виртуальная машина, так что это было бы норм крэкми, если бы небыло декомпилера или использованы какие то спец методы, которые его поломают. Ида кстате такое не может, да ?<br><br><b>Добавлено спустя 3 минуты</b><br><b>xverizex</b><br><br>&gt;  Так то почему из сегмента кода видна переменная, которая должна быть в сегменте данных?<br><br>Плоская модель памяти. Базы/значения сегментов одинаковы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=397043&amp;user=17964&amp;forum_n=5&amp;topic=25982.html&amp;page=0&amp;anchor=10" class="addthx" data-post="397043"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2019 21:55 &middot; Поправил: plutos <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25982.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>f13nd пишет:<br>С такими вопросами надо не крякмисы предлагать и защиты от битхаков </I><br><br>нарочитая бессмысленность вопросов и предложений наводит на мысль о том, что все это довольно тупой троллинг, а мы по доброте душевной ведемся, как всегда. <img src="img/smilies/s14.gif" alt=""><br> Да и почерк автора знакомый.<br><br><I>xverizex пишет:<br>ничего себе какой длинный размер, это из-за того наверное, чтобы можно было получить адрес в размере 8 байт. </I><br><br>а вообще-то ничего, даже забавно. Может чел скоро за учебник по computer science возмется. Издаст и деньги получит. <br>Всякое бывает.
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=397047&amp;user=4773&amp;forum_n=5&amp;topic=25982.html&amp;page=0&amp;anchor=11" class="addthx" data-post="397047"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите в понимании. Ассемблерный код. функция.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#12" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="25982">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=25982" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
