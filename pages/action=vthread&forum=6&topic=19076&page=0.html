<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>[Sources] ASProtect Virtual Machine for marker &quot;UserPolyBuffer&quot; - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="..:: ASProtect Virtual Machine for marker &quot;UserPolyBuffer&quot; ::.. * Что это? * Это исходный код виртуальной машины, при компиляции дающий бинарник полностью бинарно- и форматно- совместимый с одной из виртуальных машин">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=1288'>UniSoft</a>, <a target='_blank' href='?action=userinfo&amp;user=55953'>laslo</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> [Sources] ASProtect Virtual Machine for marker &quot;UserPolyBuffer&quot;</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2011 22:44 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
..:: ASProtect Virtual Machine for marker &quot;UserPolyBuffer&quot; ::..<br><br>* Что это? *<br>Это исходный код виртуальной машины, при компиляции дающий бинарник<br>полностью бинарно- и форматно- совместимый с одной из виртуальных<br>машин защиты исполняемых файлов ASProtect. Это значит, что переход<br>в виртуальную машину ASProtect можно заменить на переход в получившуюся<br>виртуальную машину и код интерпретируется правильно. Кроме того, любой<br>примитив оригинальной виртуальной машины можно заменить примитивом<br>получившейся и в этом случае тоже ошибки не будет. В исходном коде<br>практически полностью восстановлен стиль программирования автора,<br>большинство ошибок и недоработок. Самые абсурдные места я пометил<br>комментарием &quot;WTF?&quot;.  Полученный бинарник тестировался на версии 2.58.<br><br>* Цель *<br>Очень многие не понимают сути виртуальной машины. Кому то просто<br>интересен принцип работы. Кто то хочет посмотреть код виртуальной<br>машины коммерческой защиты исполняемых файлов. В данном случае код<br>будет интересен в первую очередь разработчикам программ, которые<br>доверяют защиту, своего программного обеспечения протектору ASProtect.<br>Т.е. цель - исключительно исследовательская, это не декомпилятор<br>защиты, это именно исходный интерпретатор.<br><br>* История *<br>Данная виртуальная машина была впервые применена для сокрытия кода<br>QuickVM. QuickVM - виртуальная машина, интерпретирующая всего 4<br>типа инструкций: call, jmp, jcc, cmp+jcc. Но на тот момент устройство<br>QuickVM уже было полностью изучено и всё, чего добились разработчики<br>ASProtect - это резкое снижение быстродействия всей защиты. Поэтому в<br>следующем же билде эту виртуальную машину сняли с кода QuickVM. Но,<br>т.к. виртуальная машина уже была реализована, то ее стали применять<br>для маркеров UserPolyBuffer, установленных в коде приложения. Видимо<br>для того, чтобы не придумывать новые маркеры, а может просто для<br>тестирования. Но, спустя небольшой промежуток времени с маркеров<br>UserPolyBuffer ее убрали и для защиты пользовательского кода не<br>используют больше вообще. В виртуальной DLL ASProtect, что извлекается<br>во время запуска защищенной программы в память, тоже используются<br>маркеры UserPolyBuffer. Вот для них теперь и используется эта<br>виртуальная машина, т.е. она теперь защищает функции самого ASProtect.<br><br>* Благодарности *<br>- ntldr<br>За публикацию, пусть и для узкого круга людей, своего эмулятора. Его<br>исходный код очень помог в понимании базовой логики процесса эмуляции<br>процессорных команд и в частности понимания эмуляции некоторых, довольно<br>сложных логически.<br><br>- Ms-Rem<br>За публикацию исходных кодов дизассемблера CadT. Его реализация очень <br>похожа на реализацию функций декодирования инструкций в виртуальной <br>машине ASProtect. Что дало понимание назначения битовых масок при разборе<br>полей ModRM и SIB, и логики самих функций декодирования.<br><br>- Archer<br>За помощь в разборе исходных кодов C и C++, это единственный человек, <br>который всегда отвечает на мои дебильные вопросы, касаемо данного языка <br>программирования и которого я почему то всегда хочу забанить, когда мне<br>грустно <img src="img/smilies/s1.gif" alt=""><br><br>- ASPack Software<br>За неиссякаемый источник головоломок, не дающий засохнуть уставшему мозгу.<br><br>Скачать <noindex><a href="http://peco.at.ua/load/identifikatory/asprotect/sources_asprotect_virtual_machine_for_marker_quot_userpolybuffer_quot/3-1-0-4" rel="nofollow" target="_blank">--&gt; ASProtect Virtual Machine for marker &quot;UserPolyBuffer&quot; - Sources &lt;--</a></noindex>
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=292092&amp;user=3232&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=1" class="addthx" data-post="292092"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=23568" title="22-09-2011 18:17, ранг:12.0" target="_blank">yagello</a>, <a href="action=userinfo&user=2108" title="22-09-2011 18:31, ранг:178.9" target="_blank">SaNX</a>, <a href="action=userinfo&user=132" title="22-09-2011 18:43, ранг:195.0" target="_blank">YDS</a>, <a href="action=userinfo&user=2777" title="22-09-2011 18:45, ранг:356.0" target="_blank">daFix</a>, <a href="action=userinfo&user=22828" title="22-09-2011 18:56, ранг:30.4" target="_blank">Dart Sergius</a>, <a href="action=userinfo&user=6336" title="22-09-2011 19:03, ранг:350.7" target="_blank">ARCHANGEL</a>, <a href="action=userinfo&user=25124" title="22-09-2011 19:36, ранг:0.6" target="_blank">Fedonin</a>, <a href="action=userinfo&user=21485" title="22-09-2011 19:38, ранг:15.0" target="_blank">[Nomad]</a>, <a href="action=userinfo&user=18316" title="22-09-2011 19:39, ранг:69.5" target="_blank">SReg</a>, <a href="action=userinfo&user=2585" title="23-09-2011 01:36, ранг:789.9" target="_blank">Gideon Vi</a>, <a href="action=userinfo&user=10382" title="23-09-2011 05:24, ранг:89.1" target="_blank">yanus0</a>, <a href="action=userinfo&user=6801" title="23-09-2011 05:27, ранг:382.8" target="_blank">OKOB</a>, <a href="action=userinfo&user=17319" title="23-09-2011 06:03, ранг:114.5" target="_blank">VodoleY</a>, <a href="action=userinfo&user=6946" title="23-09-2011 06:52, ранг:582.1" target="_blank">Isaev</a>, <a href="action=userinfo&user=26065" title="23-09-2011 08:10, ранг:32.4" target="_blank">Airenikus</a>, <a href="action=userinfo&user=4618" title="23-09-2011 09:42, ранг:133.9" target="_blank">Nightshade</a>, <a href="action=userinfo&user=21426" title="23-09-2011 11:40, ранг:4.0" target="_blank">Dart Raiden</a>, <a href="action=userinfo&user=18198" title="23-09-2011 16:41, ранг:113.2" target="_blank">Valemox</a>, <a href="action=userinfo&user=16120" title="23-09-2011 21:32, ранг:3.3" target="_blank">m0bscene</a>, <a href="action=userinfo&user=1989" title="24-09-2011 04:41, ранг:302.3" target="_blank">OnLyOnE</a>, <a href="action=userinfo&user=5173" title="24-09-2011 05:12, ранг:279.4" target="_blank">vnekrilov</a>, <a href="action=userinfo&user=24946" title="24-09-2011 07:47, ранг:9.6" target="_blank">DimitarSerg</a>, <a href="action=userinfo&user=5252" title="24-09-2011 08:20, ранг:105.3" target="_blank">VAD87</a>, <a href="action=userinfo&user=17432" title="24-09-2011 09:15, ранг:250.6" target="_blank">ClockMan</a>, <a href="action=userinfo&user=8545" title="24-09-2011 10:28, ранг:25.8" target="_blank">obfuskator</a>, <a href="action=userinfo&user=1449" title="24-09-2011 11:07, ранг:498.1" target="_blank">Smon</a>, <a href="action=userinfo&user=4109" title="25-09-2011 14:19, ранг:3.2" target="_blank">MarcElBichon</a>, <a href="action=userinfo&user=10650" title="25-09-2011 18:58, ранг:146.8" target="_blank">kioresk</a>, <a href="action=userinfo&user=10168" title="26-09-2011 18:25, ранг:422.4" target="_blank">Hexxx</a>, <a href="action=userinfo&user=1263" title="29-09-2011 05:47, ранг:420.3" target="_blank">ValdiS</a>, <a href="action=userinfo&user=21589" title="29-09-2011 08:40, ранг:102.9" target="_blank">_ruzmaz_</a>, <a href="action=userinfo&user=2591" title="01-10-2011 19:45, ранг:153.9" target="_blank">newborn</a>, <a href="action=userinfo&user=7018" title="03-10-2011 13:45, ранг:2.3" target="_blank">xmss</a></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Mavlyudov[/b]','')">Mavlyudov</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3355.jpg" alt=""><br><span class=txtSm>Ранг: 156.2 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.53'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3355">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 сентября 2011 23:21 <br><script type="text/javascript">QU('Mavlyudov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mavlyudov" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Ты всё еще на ASProtect специализируешься?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=292161&amp;user=3355&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=2" class="addthx" data-post="292161"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]DrGolova[/b]','')">DrGolova</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/301.jpg" alt=""><br><span class=txtSm>Ранг: 199.6 (ветеран), 12thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.84'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=301">Участник</a><br><font color=blue>www.uinc.ru</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 сентября 2011 05:30 <br><script type="text/javascript">QU('DrGolova','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DrGolova" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
&gt; За неиссякаемый источник головоломок, не дающий засохнуть уставшему мозгу.<br><br>Чё тут &quot;головомать&quot; - оно не менялось последние 5 лет (но работает стабильно - большой плюс).<br>В 1/2.63+ пропала даже полиморфная крипта лоадера. Толи сломали чего, толи борятся с говно-ав.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=292175&amp;user=301&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=3" class="addthx" data-post="292175"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 сентября 2011 12:22 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>Mavlyudov</b> да я всем помаленьку. Этот сурс я начинал писать еще год назад, потом заморозил. Сейчас вот из принципа дописал. Так же процентов на 30 написан деморфер кода ExeCryptor&#039;а но дописывать уже не буду наверное, гавнопрот умер.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=292187&amp;user=3232&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=4" class="addthx" data-post="292187"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]SaNX[/b]','')">SaNX</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 456.3 (мудрец), 340thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.03'>Активность: 0.28<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=2108">Участник</a><br><font color=blue>Android Reverser</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 сентября 2011 12:36 <br><script type="text/javascript">QU('SaNX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SaNX" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>PE_Kill</b><br>полно софта под ним и по сей день. было бы лучше, если б ты дописал <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>SaNX</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=292189&amp;user=2108&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=5" class="addthx" data-post="292189"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 сентября 2011 13:06 &middot; Поправил: bowrouco <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
&gt; это именно исходный интерпретатор.<br>На спекки был мощный эмулятор и интерпретатор васика <noindex><a href="ftp://ftp.worldofspectrum.org/pub/sinclair/books/CompleteSpectrumROMDisassemblyThe.pdf" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br>Это была первая ось, которую я изучал и с которой работал <img src="img/smilies/s8.gif" alt=""><br>Там для вычисления тригонометрии использовались ряды маклорена и прочая матчасть, в конце концов сводилось к виртуальным инструкциям..<br>А аспаки на дельфях, флаи и прочие поделки както не серьёзно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=292193&amp;user=29629&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=6" class="addthx" data-post="292193"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 сентября 2011 13:50 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Не серьезно - это древний эмулятор васика, давно забытый богом. А интерпретатор, а тем более декомпилятор, того, что используется сейчас и с чем имеешь дело почти каждый день - очень даже серьезно.<br><br><I>SaNX пишет:<br>было бы лучше, если б ты дописал </I><br>Там нужно интерактив писать, что то типа иды для гавнопрота, это в мои планы не входило, поэтому притормозил, ибо под интерактив нужно полностью ядро переписывать.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=292195&amp;user=3232&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=7" class="addthx" data-post="292195"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 сентября 2011 16:26 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>PE_Kill</b><br>забей, лучше <b>kioresk</b> свой допишет. Когда-нибудь <img src="img/smilies/s5.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=292212&amp;user=2449&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=8" class="addthx" data-post="292212"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 сентября 2011 16:57 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>kioresk</b> не писал деморфер, он написал девиртуализатор. Кстати он обрабатывает только ~80% виртуализованных инструкций, как раз потому, что работает без деморфера. Соотношение сложности написания девиртуализатора к деморферу примерно 1 к 100, вот и думай.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=292214&amp;user=3232&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=9" class="addthx" data-post="292214"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 сентября 2011 16:28 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
всё лишнее потёр, дальше общаемся по теме <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=292269&amp;user=72&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=10" class="addthx" data-post="292269"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]kioresk[/b]','')">kioresk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/10650.gif" alt=""><br><span class=txtSm>Ранг: 154.2 (ветеран), 66thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10650">Участник</a><br><font color=blue>REVENGE Crew</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 сентября 2011 23:34 &middot; Поправил: kioresk <br><script type="text/javascript">QU('kioresk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kioresk" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>PE_Kill</b>,<br><br><I>kioresk не писал деморфер, он написал девиртуализатор.</I><br><br>Не-не-не, деморфер для криптора просто долгое время лежал недоделанным.<br>Я довел его до работающей версии недавно, но пока еще есть что улучшать. Например, сейчас нет встроенного ассемблера (автоматом восстанавливающего код), а формируется текстовая портянка для Multimate Assembler, которую надо ручками в Олле вставить и сдампить файл. Ну и еще много чего надо доделать.<br><br><I>Кстати он обрабатывает только ~80% виртуализованных инструкций, как раз потому, что работает без деморфера.</I><br><br>Не пойму о чем речь, какие виртуализованные инструкции девм не обрабатывает?<br><br><I>Соотношение сложности написания девиртуализатора к деморферу примерно 1 к 100, вот и думай.</I><br><br>1 к 10 скорее, у криптора же не очень сложная реализация (обфускацию можно спокойно паттернами сворачивать).<br><br><br><b>P.S.</b><br>Я девм (восстановление релоков) поэтому все никак не доделаю, как время появлялось — допиливал деморф.<br><br><b>P.P.S.</b>,<br>Присоединяюсь к <b>PE_Kill</b>&#039;у и также благодарю <b>ntldr</b> за его эмулятор. А еще респект <b>mika0x65</b> за Mediana.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=292295&amp;user=10650&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=11" class="addthx" data-post="292295"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=5173" title="25-09-2011 19:54, ранг:279.7" target="_blank">vnekrilov</a>, <a href="action=userinfo&user=10534" title="25-09-2011 20:48, ранг:276.4" target="_blank">tihiy_grom</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]vnekrilov[/b]','')">vnekrilov</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 329.6 (мудрец), 192thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.08'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=5173">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2011 00:39 <br><script type="text/javascript">QU('vnekrilov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vnekrilov" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>Кстати он обрабатывает только ~80% виртуализованных инструкций,  </I><br><br>Насколько я понимаю, виртуализированные инструкции хорошо обрабатывает скрипт &quot;EXECryptor 2.4.x DeVM (VolX).osc&quot;. Я применял его на одной программе, и он очень неплохо работает. VolX довольно хорошо разобрал виртуальную машину ExeCryptor, и приложил к своему скрипту фактически декомпилятор эмулированных инструкций, выполняемых в VM. Кроме того, этот скрипт очищает мусорный код, и делает его намного более читаемым. Хотя очень напрягает мусорный код с целой кучей прыжков и пустого кода, что затрудняет восстановление нормально-читаемого кода.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=292298&amp;user=5173&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=12" class="addthx" data-post="292298"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2011 12:55 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>kioresk пишет:<br>портянка для Multimate Assembler, </I><br>Возьми ассемблер от OllyDbg я везде его использую, после медианы нормально ассемблирует мнемонику.<br><br><I>kioresk пишет:<br>Не пойму о чем речь, какие виртуализованные инструкции девм не обрабатывает? </I><br>Ну я проверял на больших файлов, не обрабатывал те, call которых ведет в пролог VM очень сильно разбавленных jcc, граф эдак на 50 ветвлений. <br><br><I>kioresk пишет:<br> криптора же не очень сложная реализация </I><br>У меня сложность обработки в автоматическом режиме вызвало ветвление блоков кода, которые можно свернуть только отдеморфив обе ветки и сравнив оба блока ветвления, т.к. в этих блоках тоже есть ветвления а в подблоках еще и т.д. И второе это на автомате определять процедуры, которые вызываются линейно:<br><br>Вместо<br>@L1: some code<br>call TestProc<br>@L2: some code<br><br>Морфится<br>@L1: some code<br>push offset @L2<br>тело TestProc<br>ret<br><br>@L2: some code<br><br>Как опознать, что первый push это RetAddr я так и не придумал.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=292315&amp;user=3232&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=13" class="addthx" data-post="292315"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2011 23:14 &middot; Поправил: Hexxx <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>Как опознать, что первый push это RetAddr</I><br>Только анализом указателя стека как в иде.
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=292329&amp;user=10168&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=14" class="addthx" data-post="292329"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2011 23:41 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
А в таком случае (реальный пример)?:<br><br>Оригинальный код:<br>------------------------------------------------<br>mov ecx, offset VTable ; VTable = 0<br>call SomeProc<br>@L:<br>next code<br>------------------------------------------------<br>@SomeProc:<br>push offset Param1<br>push offset Param2<br>call [ecx+4]<br>retn<br>------------------------------------------------<br><br><br>После морфа:<br>------------------------------------------------<br>mov ecx, offset VTable ; VTable = 0<br>push offset @L<br>@SomeProc:<br>push offset Param1<br>push offset Param2<br>call [ecx+4]<br>retn<br>@L:<br>next code<br>------------------------------------------------<br><br>Собственно когда я встретил это, я и притормозил разработку.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=292330&amp;user=3232&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=15" class="addthx" data-post="292330"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]kioresk[/b]','')">kioresk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/10650.gif" alt=""><br><span class=txtSm>Ранг: 154.2 (ветеран), 66thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10650">Участник</a><br><font color=blue>REVENGE Crew</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2011 23:57 &middot; Поправил: kioresk <br><script type="text/javascript">QU('kioresk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kioresk" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>PE_Kill</b>,<br><br><I>Возьми ассемблер от OllyDbg я везде его использую, после медианы нормально ассемблирует мнемонику.</I><br><br>Спасибо, гляну.<br><br><I>Ну я проверял на больших файлов, не обрабатывал те, call которых ведет в пролог VM очень сильно разбавленных jcc, граф эдак на 50 ветвлений.</I><br><br>А, понял о чем ты. Так поиск точек входа в ВМ примитивный, поэтому может и не определять входы.<br>Если у тебе «проблемный» файл остался — скинь мне, посмотрю.<br><br><I>У меня сложность обработки в автоматическом режиме вызвало ветвление блоков кода, которые можно свернуть только отдеморфив обе ветки и сравнив оба блока ветвления, т.к. в этих блоках тоже есть ветвления а в подблоках еще и т.д.</I><br><br>Да, эта часть у меня тоже не до конца сделана (деморф и сравнение веток не используется).<br>Сейчас удаляются JCC, которые идут внутри обфуцирующих конструкций (когда ветвление всегда будет идти только по одному маршруту) и часть JCC, дублирующих граф (код). Дублирующие JCC легко определить когда она виртуализована (т.к. она имеет свой опкод в ВМ — 0x83).<br><br><I>И второе это на автомате определять процедуры, которые вызываются линейно:<br>...<br>Как опознать, что первый push это RetAddr я так и не придумал. </I><br><br>Можно определять по обфуцирующей конструкции, т.к. вызов процедуры обычно идет так:<br><br>push reg32_1<br>mov reg32_1, imm32_1 &lt;-- обфуцировано<br>xchg [esp], reg32_1 &lt;-- пушим адрес выхода из процедуры<br><br>push reg32_2<br>mov reg32_2, imm32_2 &lt;-- обфуцировано<br>xchg [esp], reg32_2 &lt;-- пушим адрес начала процедуры<br><br>ret &lt;-- вызываем процедуру<br><br>Но я на всякий случай запрашиваю у пользователя, похож ли код на вызов процедуры. <img src="img/smilies/s2.gif" alt=""><br><br><img src="http://savepic.su/28756.png" border="0" align="" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=292334&amp;user=10650&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=16" class="addthx" data-post="292334"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2011 00:59 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Ага, ага, вот и интерактив о котором я говорил! Есть еще проблема, когда Eip уходит в секцию кода, там тоже надо анализировать продолжать ли деморфить или мы вышли из полиморфа. В общем офтоп пошел в этом топике, топик то о другом <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=292336&amp;user=3232&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=17" class="addthx" data-post="292336"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2011 03:04 <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Да какой оффтоп <img src="img/smilies/s1.gif" alt=""> продолжайте дальше.<br>все будут рады наконец-то дописанному деморфу
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=292343&amp;user=10534&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=18" class="addthx" data-post="292343"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=21426" title="26-09-2011 23:56, ранг:4.2" target="_blank">Dart Raiden</a>, <a href="action=userinfo&user=5173" title="27-09-2011 04:29, ранг:280.7" target="_blank">vnekrilov</a>, <a href="action=userinfo&user=18316" title="27-09-2011 07:08, ранг:69.6" target="_blank">SReg</a>, <a href="action=userinfo&user=2777" title="27-09-2011 10:35, ранг:361.0" target="_blank">daFix</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]yagello[/b]','')">yagello</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.1 (постоянный), 30thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.56'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=23568">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2011 08:50 <br><script type="text/javascript">QU('yagello','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=yagello" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Почему бы не скооперироваться с Vamit&#039;ом, он тоже деморфер/декомпилятор VM ваяет?..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=292349&amp;user=23568&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=19" class="addthx" data-post="292349"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2011 13:26 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
Вамит тормознул разработку своего декомпиля. Я думаю, не стоит пытаться заставлять человека переписывать тонны чужого кода в свой полузаброшенный проект
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=292360&amp;user=4618&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=20" class="addthx" data-post="292360"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]microxa[/b]','')">microxa</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 27.8 (посетитель), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.79'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30317">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2011 13:52 <br><script type="text/javascript">QU('microxa','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=microxa" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>PE_Kill</b> Здраствуйте! а реально ли этот движок прикрутить к EP на протекнутый бинарь?  не совсем понятно с чем и как употреблять вызов VmPrologue ;)  а то интересно всетаки <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=292472&amp;user=30317&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=21" class="addthx" data-post="292472"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2011 14:48 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19076.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Ну смотри как я делал. Берешь файл с API ASProtect и делаешь простенький проект, который берет из ASProtect HardwareID. Т.е. используешь GetHardwareID. Перед вызовом этой апи делаешь загрузку скомпилированной VM. И после этого втыкаешь int 3. Протектишь файл, загружаешь в OllyDbg, жмешь F9 и останавливаешься на int 3. Всё дальше трассируешь код, уходя в GetHardwareID и там то ли на первом то ли на втором call увидишь навешанную VM, даешь ей положить параметры в стек, заходишь в call жмешь Ctrl+G, вбиваешь VmPrologue и Enter. Ставишь туда Eip и можешь трассировать. Лучше скомпилить VM с map файлом, тогда оля будет показывать названия всех функций.<br><br>Проект что то типа того:<br>LoadLibrary(&#039;PBVM.dll&#039;);<br>asm int 3 end;<br>sHwid := GetHardwareID();
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=292474&amp;user=3232&amp;forum_n=6&amp;topic=19076.html&amp;page=0&amp;anchor=22" class="addthx" data-post="292474"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> [Sources] ASProtect Virtual Machine for marker &quot;UserPolyBuffer&quot;</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#23" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="19076">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19076" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
