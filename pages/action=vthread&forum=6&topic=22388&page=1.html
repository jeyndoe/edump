<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Перехват прерываний и исключений - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Руководствуясь Хоглундом и Батлером на тему перехват прерываний и исключений , написать и запустить драйвер получается но перехват не выходит, пытался перехватить как 0x04 OF так и 0x13 ошибки доступа к памяти, запускал на VB xp">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40382'>jinoweb</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a>, <a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Перехват прерываний и исключений</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]MickeyBlueEyes[/b]','')">MickeyBlueEyes</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 51.6 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.7'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36083">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 декабря 2013 15:35 <br><script type="text/javascript">QU('MickeyBlueEyes','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MickeyBlueEyes" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Руководствуясь Хоглундом и Батлером на тему перехват прерываний и исключений , написать и запустить драйвер получается но перехват не выходит, пытался перехватить как 0x04 OF так и 0x13 ошибки доступа к памяти, запускал на VB xp 32 с одним процессором, но увы, не опытность даёт знать, вот код на Си который вышел:<br><br>init.c:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#include&nbsp;<span class="hl_char">&lt;</span>ntddk<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l1">#include&nbsp;<span class="hl_quote">&quot;IDT.c&quot;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">#define&nbsp;MAKELONG<span class="hl_char">(</span>&nbsp;a&nbsp;<span class="hl_char">,</span>&nbsp;b&nbsp;<span class="hl_char">)</span><span class="hl_char">(</span>&nbsp;<span class="hl_char">(</span>&nbsp;LONG&nbsp;<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">(</span>&nbsp;USHORT&nbsp;<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span>&nbsp;a&nbsp;<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">(</span>&nbsp;ULONG&nbsp;<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">(</span>&nbsp;USHORT&nbsp;<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span>&nbsp;b&nbsp;<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_number">16</span>&nbsp;<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">#define&nbsp;NT_SYSTEM_SERVICE_INT&nbsp;0x13</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">ULONG&nbsp;RealSystemPtr<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;MyInt<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">pushad</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">pushfd</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">fs</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr"><b>bx</b></span>&nbsp;<span class="hl_char">,</span>&nbsp;0x30</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr"><b>fs</b></span>&nbsp;<span class="hl_char">,</span>&nbsp;<span class="hl_registr">bx</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ds</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">es</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DbgPrint<span class="hl_char">(</span><span class="hl_quote">&quot;Is MyInt&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">es</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">ds</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">fs</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">popfd</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">popad</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;RealSystemPtr<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;Hook<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDTINFO&nbsp;idt_info<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDTENTRY&nbsp;<span class="hl_char">*</span>&nbsp;idt_entries<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDTENTRY&nbsp;<span class="hl_char">*</span>&nbsp;int2_entry<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm&nbsp;<span class="hl_function"><b>sidt</b></span>&nbsp;idt_info</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idt_entries&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>&nbsp;IDTENTRY&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_char">)</span>&nbsp;MAKELONG<span class="hl_char">(</span>&nbsp;idt_info<span class="hl_char">.</span>LowIDTbase&nbsp;<span class="hl_char">,</span>&nbsp;idt_info<span class="hl_char">.</span>HiIDTbase&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RealSystemPtr&nbsp;<span class="hl_char">=</span>&nbsp;MAKELONG<span class="hl_char">(</span>&nbsp;idt_entries<span class="hl_char">[</span>&nbsp;NT_SYSTEM_SERVICE_INT&nbsp;<span class="hl_char">]</span><span class="hl_char">.</span>LowOffset&nbsp;<span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idt_entries</span><span class="hl_char">[</span>&nbsp;NT_SYSTEM_SERVICE_INT&nbsp;<span class="hl_char">]</span><span class="hl_char">.</span>HiOffset&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int2_entry&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">&amp;</span>idt_entries<span class="hl_char">[</span>&nbsp;NT_SYSTEM_SERVICE_INT&nbsp;<span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">cli</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">,</span>&nbsp;MyInt</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr"><b>ebx</b></span>&nbsp;<span class="hl_char">,</span>&nbsp;int2_entry</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_char">[</span>&nbsp;<span class="hl_registr"><b>ebx</b></span>&nbsp;<span class="hl_char">]</span>&nbsp;<span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>ax</b></span>&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>shr</b></span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">,</span>&nbsp;<span class="hl_number">16</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_char">[</span>&nbsp;<span class="hl_registr"><b>ebx</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">6</span>&nbsp;<span class="hl_char">]</span>&nbsp;<span class="hl_char">,</span>&nbsp;<span class="hl_registr">ax</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">sti</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">}&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;DriverUnload<span class="hl_char">(</span>&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;PDRIVER_OBJECT&nbsp;DriverObject&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">NTSTATUS&nbsp;DriverEntry<span class="hl_char">(</span>&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;PDRIVER_OBJECT&nbsp;DriverObject&nbsp;<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;PUNICODE_STRING&nbsp;RegPath&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DriverObject&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;DriverUnload&nbsp;<span class="hl_char">=</span>&nbsp;DriverUnload<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hook<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;STATUS_SUCCESS<span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;DriverUnload<span class="hl_char">(</span>&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;PDRIVER_OBJECT&nbsp;DriverObject&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DbgPrint<span class="hl_char">(</span><span class="hl_quote">&quot;Bye!\n&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br><br>IDT.c<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">typedef&nbsp;struct</li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USHORT&nbsp;IDTLimit<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USHORT&nbsp;LowIDTbase<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USHORT&nbsp;HiIDTbase<span class="hl_comment">;</span></li><li class="hl_l1">}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDTINFO&nbsp;<span class="hl_comment">; </span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">#pragma&nbsp;pack<span class="hl_char">(</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">typedef&nbsp;struct</li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USHORT&nbsp;LowOffset<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USHORT&nbsp;selector<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UCHAR&nbsp;&nbsp;&nbsp;unused_lo<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;unused_hi&nbsp;<span class="hl_char">:</span>&nbsp;<span class="hl_number">5</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;DPL&nbsp;<span class="hl_char">:</span>&nbsp;<span class="hl_number">2</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;P&nbsp;<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USHORT&nbsp;HiOffset<span class="hl_comment">;</span></li><li class="hl_l1">}&nbsp;IDTENTRY&nbsp;<span class="hl_comment">;</span></li><li class="hl_l0">#pragma&nbsp;pack<span class="hl_char">(</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_char">)</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334944&amp;user=36083&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=1" class="addthx" data-post="334944"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 декабря 2013 12:09 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
<b>Veliant</b><br><br>Первая инструкция только фолт сгенерит. Маловероятно что там будет какой то активно юзаемый код, на практике на быстродействии это не сказывается.<br><br>&gt; функции для работы с памятью/файлами<br><br>Например сайд - все сервисы в системе генерят фолт, но визуально это не заметно даже на моей бородатой машине <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335052&amp;user=33727&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=2" class="addthx" data-post="335052"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2013 04:01 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<b>MickeyBlueEyes</b><br><br>Ну что, получилось ?<br><br>Как решили реализовать ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335060&amp;user=33727&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=3" class="addthx" data-post="335060"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]MickeyBlueEyes[/b]','')">MickeyBlueEyes</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 51.6 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.7'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36083">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 декабря 2013 15:12 &middot; Поправил: MickeyBlueEyes <br><script type="text/javascript">QU('MickeyBlueEyes','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MickeyBlueEyes" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
<b>Dr0p</b><br><i class=x><br>Ну что, получилось ?<br><br>Как решили реализовать ? </i><br><br>В половине исходников сразу вышло разобраться, а в остальной не, много незнакомых терминов. Читаю, как реализую сразу отпишу что да как.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335164&amp;user=36083&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=4" class="addthx" data-post="335164"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]MickeyBlueEyes[/b]','')">MickeyBlueEyes</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 51.6 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.7'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36083">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 декабря 2013 01:11 <br><script type="text/javascript">QU('MickeyBlueEyes','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MickeyBlueEyes" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
Вообщем <br><br>Я перехватываю KiDispatchException и в перехватчике мне надо воспользоватся NtOpenProcess() для процесса где произошло исключение, ну и потом поставить на страницу нужные мне права и return, но я не могу по странной как по мне причине вызвать  NtOpenProcess(). PsGetCurrentProcess() - возвращает процесс где произошло исключения, всё норм. <br>Вообщем сразу как происходит исключение, я в перехватчике делаю так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">__asm&nbsp;<span class="hl_function">cli</span></li><li class="hl_l1">UnHook<span class="hl_char">(</span><span class="hl_quote">&quot;KiDispatchException&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">__asm&nbsp;<span class="hl_function">sti</span></li>        </ol>
    </div>
</div></div>
<br><br>Потом мне нужно открыть этот процесс.<br>Вызываю так:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">OBJECT_ATTRIBUTES&nbsp;oa&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;<span class="hl_function"><b>sizeof</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;oa&nbsp;<span class="hl_char">)</span>&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l1">CLIENT_ID&nbsp;cid&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;PsGetCurrentProcessId<span class="hl_char">(</span>&nbsp;<span class="hl_char">)</span>&nbsp;<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span>&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l0">HANDLE&nbsp;hTarget&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">NtOpenProcess<span class="hl_char">(</span>&nbsp;<span class="hl_char">&amp;</span>hTarget&nbsp;<span class="hl_char">,</span>&nbsp;0x08&nbsp;<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>oa&nbsp;<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>cid&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>NtOpenProcess - возвращает не STATUS_SUCCESS.<br><br>И тут главное, если убрать это:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">__asm&nbsp;<span class="hl_function">cli</span></li><li class="hl_l1">UnHook<span class="hl_char">(</span><span class="hl_quote">&quot;KiDispatchException&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">__asm&nbsp;<span class="hl_function">sti</span></li>        </ol>
    </div>
</div></div>
<br>И переполнение стека будет как я понял и вылетает система.<br><br>!analyze -v<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">STACK_TEXT<span class="hl_char">:</span>&nbsp;&nbsp;</li><li class="hl_l1">f2645050&nbsp;f2689a5c&nbsp;f264507c&nbsp;<span class="hl_number">00000008</span>&nbsp;f2645080&nbsp;nt<span class="hl_char">!</span>_SEH_prolog<span class="hl_char">+</span>0x1a</li><li class="hl_l0">WARNING<span class="hl_char">:</span>&nbsp;Stack&nbsp;unwind&nbsp;information&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;available<span class="hl_char">.</span>&nbsp;Following&nbsp;frames&nbsp;may&nbsp;be&nbsp;wrong<span class="hl_char">.</span></li><li class="hl_l1">f26450a8&nbsp;<span class="hl_number">8053e081</span>&nbsp;f26450c4&nbsp;<span class="hl_number">00000000</span>&nbsp;f2645118&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f2645110&nbsp;<span class="hl_number">8053e032</span>&nbsp;f264526c&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f2645118&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;f26452b4&nbsp;<span class="hl_number">00000000</span>&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f264526c&nbsp;f2689a5c&nbsp;f2645298&nbsp;<span class="hl_number">00000008</span>&nbsp;f264529c&nbsp;nt<span class="hl_char">!</span>NtOpenProcess<span class="hl_char">+</span>0x40</li><li class="hl_l1">f26452c4&nbsp;<span class="hl_number">8053e081</span>&nbsp;f26452e0&nbsp;<span class="hl_number">00000000</span>&nbsp;f2645334&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f264532c&nbsp;<span class="hl_number">8053e032</span>&nbsp;f2645488&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f2645334&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;f26454d0&nbsp;<span class="hl_number">00000000</span>&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f2645488&nbsp;f2689a5c&nbsp;f26454b4&nbsp;<span class="hl_number">00000008</span>&nbsp;f26454b8&nbsp;nt<span class="hl_char">!</span>NtOpenProcess<span class="hl_char">+</span>0x40</li><li class="hl_l1">f26454e0&nbsp;<span class="hl_number">8053e081</span>&nbsp;f26454fc&nbsp;<span class="hl_number">00000000</span>&nbsp;f2645550&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f2645548&nbsp;<span class="hl_number">8053e032</span>&nbsp;f26456a4&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f2645550&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;f26456ec&nbsp;<span class="hl_number">00000000</span>&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f26456a4&nbsp;f2689a5c&nbsp;f26456d0&nbsp;<span class="hl_number">00000008</span>&nbsp;f26456d4&nbsp;nt<span class="hl_char">!</span>NtOpenProcess<span class="hl_char">+</span>0x40</li><li class="hl_l1">f26456fc&nbsp;<span class="hl_number">8053e081</span>&nbsp;f2645718&nbsp;<span class="hl_number">00000000</span>&nbsp;f264576c&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f2645764&nbsp;<span class="hl_number">8053e032</span>&nbsp;f26458c0&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f264576c&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;f2645908&nbsp;<span class="hl_number">00000000</span>&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f26458c0&nbsp;f2689a5c&nbsp;f26458ec&nbsp;<span class="hl_number">00000008</span>&nbsp;f26458f0&nbsp;nt<span class="hl_char">!</span>NtOpenProcess<span class="hl_char">+</span>0x40</li><li class="hl_l1">f2645918&nbsp;<span class="hl_number">8053e081</span>&nbsp;f2645934&nbsp;<span class="hl_number">00000000</span>&nbsp;f2645988&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f2645980&nbsp;<span class="hl_number">8053e032</span>&nbsp;f2645adc&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f2645988&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;f2645b24&nbsp;<span class="hl_number">00000000</span>&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f2645adc&nbsp;f2689a5c&nbsp;f2645b08&nbsp;<span class="hl_number">00000008</span>&nbsp;f2645b0c&nbsp;nt<span class="hl_char">!</span>NtOpenProcess<span class="hl_char">+</span>0x40</li><li class="hl_l1">f2645b34&nbsp;<span class="hl_number">8053e081</span>&nbsp;f2645b50&nbsp;<span class="hl_number">00000000</span>&nbsp;f2645ba4&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f2645b9c&nbsp;<span class="hl_number">8053e032</span>&nbsp;f2645cf8&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f2645ba4&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;f2645d40&nbsp;<span class="hl_number">00000000</span>&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f2645cf8&nbsp;f2689a5c&nbsp;f2645d24&nbsp;<span class="hl_number">00000008</span>&nbsp;f2645d28&nbsp;nt<span class="hl_char">!</span>NtOpenProcess<span class="hl_char">+</span>0x40</li><li class="hl_l1">f2645d50&nbsp;<span class="hl_number">8053e081</span>&nbsp;f2645d6c&nbsp;<span class="hl_number">00000000</span>&nbsp;f2645dc0&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f2645db8&nbsp;<span class="hl_number">8053e032</span>&nbsp;f2645f14&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f2645dc0&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;f2645f5c&nbsp;<span class="hl_number">00000000</span>&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f2645f14&nbsp;f2689a5c&nbsp;f2645f40&nbsp;<span class="hl_number">00000008</span>&nbsp;f2645f44&nbsp;nt<span class="hl_char">!</span>NtOpenProcess<span class="hl_char">+</span>0x40</li><li class="hl_l1">f2645f6c&nbsp;<span class="hl_number">8053e081</span>&nbsp;f2645f88&nbsp;<span class="hl_number">00000000</span>&nbsp;f2645fdc&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f2645fd4&nbsp;<span class="hl_number">8053e032</span>&nbsp;f2646130&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f2645fdc&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;f2646178&nbsp;<span class="hl_number">00000000</span>&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f2646130&nbsp;f2689a5c&nbsp;f264615c&nbsp;<span class="hl_number">00000008</span>&nbsp;f2646160&nbsp;nt<span class="hl_char">!</span>NtOpenProcess<span class="hl_char">+</span>0x40</li><li class="hl_l1">f2646188&nbsp;<span class="hl_number">8053e081</span>&nbsp;f26461a4&nbsp;<span class="hl_number">00000000</span>&nbsp;f26461f8&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f26461f0&nbsp;<span class="hl_number">8053e032</span>&nbsp;f264634c&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f26461f8&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;f2646394&nbsp;<span class="hl_number">00000000</span>&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f264634c&nbsp;f2689a5c&nbsp;f2646378&nbsp;<span class="hl_number">00000008</span>&nbsp;f264637c&nbsp;nt<span class="hl_char">!</span>NtOpenProcess<span class="hl_char">+</span>0x40</li><li class="hl_l1">f26463a4&nbsp;<span class="hl_number">8053e081</span>&nbsp;f26463c0&nbsp;<span class="hl_number">00000000</span>&nbsp;f2646414&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f264640c&nbsp;<span class="hl_number">8053e032</span>&nbsp;f2646568&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f2646414&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;f26465b0&nbsp;<span class="hl_number">00000000</span>&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f2646568&nbsp;f2689a5c&nbsp;f2646594&nbsp;<span class="hl_number">00000008</span>&nbsp;f2646598&nbsp;nt<span class="hl_char">!</span>NtOpenProcess<span class="hl_char">+</span>0x40</li><li class="hl_l1">f26465c0&nbsp;<span class="hl_number">8053e081</span>&nbsp;f26465dc&nbsp;<span class="hl_number">00000000</span>&nbsp;f2646630&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f2646628&nbsp;<span class="hl_number">8053e032</span>&nbsp;f2646784&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f2646630&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;f26467cc&nbsp;<span class="hl_number">00000000</span>&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f2646784&nbsp;f2689a5c&nbsp;f26467b0&nbsp;<span class="hl_number">00000008</span>&nbsp;f26467b4&nbsp;nt<span class="hl_char">!</span>NtOpenProcess<span class="hl_char">+</span>0x40</li><li class="hl_l1">f26467dc&nbsp;<span class="hl_number">8053e081</span>&nbsp;f26467f8&nbsp;<span class="hl_number">00000000</span>&nbsp;f264684c&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f2646844&nbsp;<span class="hl_number">8053e032</span>&nbsp;f26469a0&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f264684c&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;f26469e8&nbsp;<span class="hl_number">00000000</span>&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f26469a0&nbsp;f2689a5c&nbsp;f26469cc&nbsp;<span class="hl_number">00000008</span>&nbsp;f26469d0&nbsp;nt<span class="hl_char">!</span>NtOpenProcess<span class="hl_char">+</span>0x40</li><li class="hl_l1">f26469f8&nbsp;<span class="hl_number">8053e081</span>&nbsp;f2646a14&nbsp;<span class="hl_number">00000000</span>&nbsp;f2646a68&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f2646a60&nbsp;<span class="hl_number">8053e032</span>&nbsp;f2646bbc&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f2646a68&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;f2646c04&nbsp;<span class="hl_number">00000000</span>&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f2646bbc&nbsp;f2689a5c&nbsp;f2646be8&nbsp;<span class="hl_number">00000008</span>&nbsp;f2646bec&nbsp;nt<span class="hl_char">!</span>NtOpenProcess<span class="hl_char">+</span>0x40</li><li class="hl_l1">f2646c14&nbsp;<span class="hl_number">8053e081</span>&nbsp;f2646c30&nbsp;<span class="hl_number">00000000</span>&nbsp;f2646c84&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f2646c7c&nbsp;<span class="hl_number">8053e032</span>&nbsp;f2646dd8&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f2646c98&nbsp;<span class="hl_number">805002c3</span>&nbsp;f2646cf8&nbsp;f2646d78&nbsp;<span class="hl_number">81f58020</span>&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f2646dd8&nbsp;f2689a5c&nbsp;f2646e04&nbsp;<span class="hl_number">00000008</span>&nbsp;f2646e08&nbsp;nt<span class="hl_char">!</span>KiContinue<span class="hl_char">+</span>0x99</li><li class="hl_l1">f2646e30&nbsp;<span class="hl_number">8053e081</span>&nbsp;f2646e4c&nbsp;<span class="hl_number">00000000</span>&nbsp;f2646ea0&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f2646e98&nbsp;<span class="hl_number">8053e032</span>&nbsp;f2646ff4&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f2646ee4&nbsp;<span class="hl_number">80535788</span>&nbsp;f2646fe4&nbsp;<span class="hl_number">00000030</span>&nbsp;f2646fd0&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f2646ff4&nbsp;f2689a5c&nbsp;f2647020&nbsp;<span class="hl_number">00000008</span>&nbsp;f2647024&nbsp;nt<span class="hl_char">!</span>_global_unwind2<span class="hl_char">+</span>0x18</li><li class="hl_l1">f264704c&nbsp;<span class="hl_number">8053e081</span>&nbsp;f2647068&nbsp;<span class="hl_number">00000000</span>&nbsp;f26470bc&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f26470b4&nbsp;<span class="hl_number">8053e032</span>&nbsp;f2647210&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f2647100&nbsp;<span class="hl_number">80535788</span>&nbsp;f2647200&nbsp;<span class="hl_number">80530030</span>&nbsp;f26471ec&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f2647210&nbsp;f2689a5c&nbsp;f264723c&nbsp;<span class="hl_number">00000008</span>&nbsp;f2647240&nbsp;nt<span class="hl_char">!</span>_global_unwind2<span class="hl_char">+</span>0x18</li><li class="hl_l1">f2647268&nbsp;<span class="hl_number">8053e081</span>&nbsp;f2647284&nbsp;<span class="hl_number">00000000</span>&nbsp;f26472d8&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f26472d0&nbsp;<span class="hl_number">8053e032</span>&nbsp;f264742c&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f2647364&nbsp;<span class="hl_number">805e6038</span>&nbsp;<span class="hl_number">00100020</span>&nbsp;e16c3d48&nbsp;e16c3d48&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f264742c&nbsp;f2689a5c&nbsp;f2647458&nbsp;<span class="hl_number">00000008</span>&nbsp;f264745c&nbsp;nt<span class="hl_char">!</span>SepAccessCheck<span class="hl_char">+</span>0x1bc</li><li class="hl_l1">f2647484&nbsp;<span class="hl_number">8053e081</span>&nbsp;f26474a0&nbsp;<span class="hl_number">00000000</span>&nbsp;f26474f4&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f26474ec&nbsp;<span class="hl_number">8053e032</span>&nbsp;f2647648&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li><li class="hl_l1">f2647504&nbsp;f842a4b1&nbsp;e1369008&nbsp;<span class="hl_number">00100020</span>&nbsp;f2647860&nbsp;nt<span class="hl_char">!</span>KiExceptionExit<span class="hl_char">+</span>0x18a</li><li class="hl_l0">f2647648&nbsp;f2689a5c&nbsp;f2647674&nbsp;<span class="hl_number">00000008</span>&nbsp;f2647678&nbsp;Ntfs<span class="hl_char">!</span>NtfsOpenAttributeInExistingFile<span class="hl_char">+</span>0x528</li><li class="hl_l1">f26476a0&nbsp;<span class="hl_number">8053e081</span>&nbsp;f26476bc&nbsp;<span class="hl_number">00000000</span>&nbsp;f2647710&nbsp;initDriver<span class="hl_char">+</span>0xa5c</li><li class="hl_l0">f2647708&nbsp;<span class="hl_number">8053e032</span>&nbsp;f2647864&nbsp;<span class="hl_number">805c12d6</span>&nbsp;badb0d00&nbsp;nt<span class="hl_char">!</span>CommonDispatchException<span class="hl_char">+</span>0x4d</li>        </ol>
    </div>
</div></div>
<br><br>Таким образом я понял что исключения происходит ещё и в NtOpenProcess , NtOpenProcess + 0x40 , дальше пока не стал смотреть, вырубает ) Много догадок, но хз ) Буду реально очень признателен если кто поможет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335722&amp;user=36083&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=5" class="addthx" data-post="335722"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 декабря 2013 09:24 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
А кто обещал, что других исключений не будет? Хочется ядру, оно и кидает. Не говоря о том, что PageFault может происходить в куче мест. И может всё же освоить уже отладку ядра, всяко пригодится?<br>З.Ы. И 1 этого топика, пожалуй, хватит.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335730&amp;user=1556&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=6" class="addthx" data-post="335730"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]MickeyBlueEyes[/b]','')">MickeyBlueEyes</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 51.6 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.7'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36083">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 декабря 2013 19:05 <br><script type="text/javascript">QU('MickeyBlueEyes','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MickeyBlueEyes" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
Да, необходимо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335750&amp;user=36083&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=7" class="addthx" data-post="335750"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]MickeyBlueEyes[/b]','')">MickeyBlueEyes</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 51.6 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.7'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36083">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 января 2014 18:38 &middot; Поправил: MickeyBlueEyes <br><script type="text/javascript">QU('MickeyBlueEyes','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MickeyBlueEyes" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
Джжж вышло, поток то пользовательский Nt* непоюзаешь, нужно же либо Zw* , либо свой переходник писать и через прерывания вызывать уже ядерный Nt*.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335809&amp;user=36083&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=8" class="addthx" data-post="335809"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p2[/b]','')">Dr0p2</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.52'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=36546">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 января 2014 17:57 <br><script type="text/javascript">QU('Dr0p2','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p2" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<b>MickeyBlueEyes</b><br><br>Вы друг мой походу безнадёжны, всё что было сказано видать впустую.<br><br>&gt; Джжж вышло, поток то пользовательский Nt* непоюзаешь, нужно же либо Zw* , либо свой переходник писать и через прерывания вызывать уже ядерный Nt*.<br><br>&gt; <b>Да и нельзя вне её юзать системный функционал.</b><br><br>&gt; UnHook(&quot;KiDispatchException&quot;)<br><br>Зачем каждый раз снимать патч, это нестабильность, темболее после снятия фолты пойдут вне вашего хэндлера. Вдобавок мне кажется что патч то у вас не атомарный, это значит что высока вероятность синева.<br><br>Далее в ядре обычно манипулируют не описателями обьектов, а указателями. Это в юзермоде описатели приводятся к указателям. Снижает быстродействие, особенно в таких тяжёлых по времени кодах. PsLookupProcessByPID etc вам нужно.<br><br>Ну а в целом полное извращенье <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335834&amp;user=36546&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=9" class="addthx" data-post="335834"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]MickeyBlueEyes[/b]','')">MickeyBlueEyes</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 51.6 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.7'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36083">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 января 2014 21:47 <br><script type="text/javascript">QU('MickeyBlueEyes','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MickeyBlueEyes" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
Пока шишек не набью не пойму походу )
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335844&amp;user=36083&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=10" class="addthx" data-post="335844"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 января 2014 00:22 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
Мы как-то с Волком спорили на тему безопасных хуков через сплайсинг. Основная проблема которая возникает при работе со сплайсами против хотпатчей то, что в нашем коде делается полезная работа, т.к. мы вынуждены были воровать байты с тела функции, которую мы сплайсили. Хук должен сниматься минимальной модификацией байт. Я придумывал механизм кардонов, чтобы процессы, которые уже налетели на код нашего хука, смогли безопасно выйти из хука, когда мы его уже снимем (т.е. сложность на самом деле в том, что кто-то уже мог вызвать функцию в тот момент, когда мы решили снять хук). Но это всего лишь теория, на практике я этого не делал, хотя знаю, что сделать можно. В реальной жизни нет никакой необходимости выгружать драйвер, предназначенный для задач реверс-инженерии, равно как и убирать последствия каких-то отдельных задач драйвера, таких как сплайсинг.<br><br>Если у вас что-то не работает, если НЕ снимать хук с KiDispatchException, ищите проблему в реализации хука. Хук должен начинаться с проверок, что основная функция хука выполняется только в нужный момент (например, в случае использования KiDispatchException для отладки приложений, что вы фильтруете исключения отлаживаемого приложения, а не всех подряд).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335855&amp;user=2449&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=11" class="addthx" data-post="335855"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=8830" title="04-01-2014 20:35, ранг:186.0" target="_blank">ajax</a>, <a href="action=userinfo&user=36083" title="04-01-2014 22:43, ранг:16.2" target="_blank">MickeyBlueEyes</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p2[/b]','')">Dr0p2</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.52'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=36546">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 января 2014 17:39 &middot; Поправил: Dr0p2 <br><script type="text/javascript">QU('Dr0p2','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p2" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
<b>int</b><br><br>Нет нужды что то там городить - маршрутизация позволяет это порешить. Вариантов много, можно например найти инструкцию достаточного размера, либо раскрыть косвенные ссылки если есть. Для этого нужен только LDE. Проблема не в этом. Сам по себе патч - порча целостности кода, это не должно использоваться. Лишь только в целях отладки. Обычно есть другие методы, но они гораздо более сложнны, посему и не юзаются.<br><br>Выгрузка кода это довольно сложная задача, без полной остановки система она не решается(если патч не атомарный).<br><br>В данном случае патчить приватную KiDispatchException(не говоря вообще про N/A страницы, как их тс юзает - это полный ппц) извращенье. Есть годная KDR, причём полноценный код со всеми нюансами и реализациями в сайд моторе. Бери дамп и юзай(микод же).<br><br><b>MickeyBlueEyes</b><br><br>Zw стабы формируют т-фрейм, после чего вызывают Nt-апи. Вне фрейма их нельзя дёргать(в общем случае, нужно хотя бы превмод задать соответствующий). Дальше наверно будет вопрос про вызов сисколов из ядра(на такое все натыкаются, идём на аверлаб) <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335869&amp;user=36546&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=12" class="addthx" data-post="335869"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Rockphorr[/b]','')">Rockphorr</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 62.8 (постоянный), 11thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.71'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22848">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 января 2014 00:00 &middot; Поправил: Rockphorr <br><script type="text/javascript">QU('Rockphorr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rockphorr" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
Dr0p  я вот читаю ваши куски матчасти -- системненько так, читать приятно (определения и т.д.)-- вот бы полную версию получить матчасти в вашем изложении (в приватик можно ссыль кинуть)<br><br><I>reversecode пишет:<br>на васме матами этой части полно не ну без шуток же<br>ну и последние сурсы с елито форума там же тоже выкладывали, полагаю они тоже основаны на тех же мата нах  </I><br><br>не, мне ту теорию где матов нету а есть ясные определения<br>словарь появился еще на руткитсах по моей просьбе но это очень малая толика --- походу обломс -- вопрос исчерпан  -- будем сушить воду из книг
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335883&amp;user=22848&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=13" class="addthx" data-post="335883"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 января 2014 01:39 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
на васме матами этой части полно <img src="img/smilies/s5.gif" alt=""> не ну без шуток же<br>ну и последние сурсы с елито форума там же тоже выкладывали, полагаю они тоже основаны на тех же мата нах<br><br><I>Rockphorr пишет:<br>не, мне ту теорию где матов нету а есть ясные определения  </I><br>клерко словарь ? он на клерко форуме есть
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335889&amp;user=15381&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=14" class="addthx" data-post="335889"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 января 2014 16:22 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
<b>Rockphorr</b><br><br>Не знаю о какой матчасте вы говорите. Что не скажу, вы наверно рассматриваете как некую цитату из несуществующих доков <img src="img/smilies/s1.gif" alt=""><br><br>&gt; матами этой части полно<br><br>У меня корешь есть, так если с ним что то техническое перетирать когда он пьян, то говорит &quot;не ругайся, тише&quot; <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335899&amp;user=33727&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=15" class="addthx" data-post="335899"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=30891" title="06-01-2014 15:52, ранг:2.0" target="_blank">corps</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Rockphorr[/b]','')">Rockphorr</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 62.8 (постоянный), 11thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.71'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22848">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 января 2014 23:13 <br><script type="text/javascript">QU('Rockphorr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rockphorr" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
<b>Dr0p</b> я имею ввиду что когда вы описываете какуюто технику это довольно занятно -- так вот хотелось бы все писаные вами статьи почитать особенно начиная с древнейших
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335949&amp;user=22848&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=16" class="addthx" data-post="335949"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 января 2014 16:47 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
<b>Rockphorr</b><br><br>Я не писал статьи, за всё время пару штук. Была попытка, но я забил, так как моё же восприятие устаревает(deprecated) для меня <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=336151&amp;user=33727&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=17" class="addthx" data-post="336151"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]MickeyBlueEyes[/b]','')">MickeyBlueEyes</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 51.6 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.7'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36083">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 января 2014 23:39 &middot; Поправил: MickeyBlueEyes <br><script type="text/javascript">QU('MickeyBlueEyes','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MickeyBlueEyes" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
Тута пытаюсь int 1 перехватывать, прямо из IDT, делаю такой трюк<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">UINT&nbsp;MyAddr&nbsp;<span class="hl_char">=</span>&nbsp;0x00<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">__declspec<span class="hl_char">(</span>&nbsp;naked&nbsp;<span class="hl_char">)</span>&nbsp;MyDebug<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;__asm&nbsp;<span class="hl_function">pushad</span></li><li class="hl_l1">&nbsp;&nbsp;PsGetCurrentProcess<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">; //БСОД </span></li><li class="hl_l0">&nbsp;&nbsp;__asm&nbsp;<span class="hl_function">popad</span></li><li class="hl_l1">&nbsp;&nbsp;__asm&nbsp;<span class="hl_function">iretd</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">__declspec<span class="hl_char">(</span>&nbsp;naked&nbsp;<span class="hl_char">)</span>&nbsp;TrapDebug<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;__asm&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;__asm&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>&nbsp;<span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span>&nbsp;<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;__asm&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">,</span>&nbsp;MyAddr</li><li class="hl_l1">&nbsp;&nbsp;__asm&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;&nbsp;__asm&nbsp;<span class="hl_function"><b>je</b></span>&nbsp;YES</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;YES<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;__asm&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ss</span></li><li class="hl_l0">&nbsp;&nbsp;__asm&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l1">&nbsp;&nbsp;__asm&nbsp;<span class="hl_function">pushfd</span></li><li class="hl_l0">&nbsp;&nbsp;__asm&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">cs</span></li><li class="hl_l1">&nbsp;&nbsp;__asm&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;MyDebug</li><li class="hl_l0">&nbsp;&nbsp;__asm&nbsp;<span class="hl_function">iretd</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div>
<br><br>Дык почему нельзя то )<br>!analyze -v  <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">KERNEL_MODE_EXCEPTION_NOT_HANDLED</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">CLI_FAULT_INSTR<span class="hl_char">:</span></li><li class="hl_l1">nt<span class="hl_char">!</span>KiServiceExit2<span class="hl_char">+</span><span class="hl_number">0</span></li><li class="hl_l0">fa&nbsp;<span class="hl_function">cli</span></li>        </ol>
    </div>
</div></div>
<br><br>Сорь если очередная тупая ошибка ) Ну некоторые API прокатывают, а в случае из PsGetCurrentProcess() или PsGetCurrentProcessId() синь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=336167&amp;user=36083&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=18" class="addthx" data-post="336167"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2014 09:50 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
Да ты утомил уже. Не хочешь ман почитать всё же? Или хотя бы тупо в гугле поискать готовые примеры, коих овер 9000. Там лажа на лаже сидит. Не просто 1-2 ошибки, там вообще всё неправильно. Что отсутствие подготовки сегментных регистров. Что подготовка параметров для iret.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=336174&amp;user=1556&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=19" class="addthx" data-post="336174"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]MickeyBlueEyes[/b]','')">MickeyBlueEyes</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 51.6 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.7'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36083">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2014 16:18 <br><script type="text/javascript">QU('MickeyBlueEyes','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MickeyBlueEyes" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
Ман?о На эту тему сколько не рыл ничего путнего не нашёл, а что с сегментами ище может быть не так то? А для iretd там всё вроде как сформировано, всё 5 аргументов для продолжения работы приложения сидит там.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=336198&amp;user=36083&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=20" class="addthx" data-post="336198"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2014 17:00 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
Сколько ни рыл-значит, нисколько не рыл. Ну давай поищу и потыкаю сам-http://deroko.phearless.org/doer_src.zip<br>Примеров кода с перехватом прерываний полно, хоть 3 местами сразу есть можно. И там эти сегментные регистры заполняются нормально, чем у тебя и не пахнет. И как только PsGetCurrentProcess полезет по fs, у тебя всё накрывается.<br>И открой уже ман интела/амд и почитай про iret, сколько там вообще параметров, когда и какие.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=336201&amp;user=1556&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=21" class="addthx" data-post="336201"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=36083" title="13-01-2014 13:31, ранг:18.2" target="_blank">MickeyBlueEyes</a>, <a href="action=userinfo&user=33727" title="13-01-2014 17:51, ранг:74.2" target="_blank">Dr0p</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]MickeyBlueEyes[/b]','')">MickeyBlueEyes</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 51.6 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.7'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36083">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2014 17:31 <br><script type="text/javascript">QU('MickeyBlueEyes','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MickeyBlueEyes" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
ух спс, постараюсь в следующий раз сам находить такие ответы )
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=336203&amp;user=36083&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=22" class="addthx" data-post="336203"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=36714" title="28-01-2014 14:11, ранг:0.0" target="_blank">Yoyo</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2014 17:59 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
Дероковский код это сказочный пи***ц, приводить его в пример не особо круто. Хотя автор темы тоже совершает ошибку, делая код не читаемым. Поясню.<br><br><b>MickeyBlueEyes</b><br>Вы делаете ассемблерные вставки. Зачем они вам в коде? Писать асм-вставками не кошерно. Есть два приема чтобы этого НЕ делать. Первый прием заключается в том, чтобы делать кросс-проекты, состоящие из ASM и C исходников. Потом все это собирается в объектные файлы и уже далее компонуется. Второй прием использовать специальные функции компиляторов, не входящие по объективным причинам ни в какие стандарты (т.к. платформ-зависимые), позволяющие не создавать помойку из кода, а использовать недоступные без ассемблера инструкции через intinsic-функции или по-другому &quot;интринсики&quot;. Ну т.е. делать вы конечно можете как угодно и что угодно. Но если вас прикалывает писать на каждой строке __asm - тут уж ничего не поделать. Это все равно что смешивать всю еду на тарелке мясорубкой, заливать сверху чаем и только потом употреблять в пищу.<br><br>К сожалению действительно стоящей документации и примеров нет. (Тут конечно сейчас набежит толпа народа для холивара, но я буду защищаться <img src="img/smilies/s3.gif" alt=""> ). Можно (и нужно) читать маны AMD/Intel. Но это очень абстрактные документы. В них есть много недостатков. Первый который напрашивается, так это то, что при изучении любой предметной области иногда возникают вопросы &quot;а почему&quot;? Ну так вот ответов во всяком случае у Intel на вопросы &quot;почему?&quot; нет. Частично эти ответы есть здесь: <noindex><a href="http://lurkmore.to/X86" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>. Например, именно там я нашел ответ на вопрос, почему сегментный дескриптор выглядит, как будто его укуренные архитекторы изобретали. Оказалось, что это архитектурный памятник отделения травматологии и ортопедии.<br><br>Что там дальше по документации. Приближаясь к kermel-mode программированию в контексте винды еще есть Руссинович, Рихтер, Мэт Питтрек, Шрайбер и многие другие. Но чтение этих книжек это как хождение по минному полю, о примерах <noindex><a href="http://exelab.ru/art/?action=view&amp;id=205" rel="nofollow" target="_blank">здесь</a></noindex>. А проблема кроется в монопольной политике компании M&#036;. Разработка драйверов превращена в геморрой в связи с отсутствием документации. Это сейчас на MSDN начали появляться функции, которые уже давно всеми используются. В своем стремлении все закрыть и все спрятать, M&#036; ограничила возможности разработчиков драйверов не дав нормальной документации. В итоге почти вся документация, что сейчас накопилась - это труды реверс-инженерии. Набор статей, полных фраз &quot;я думаю что так&quot; (а то и без этих фраз - просто как есть даются неверные, не совсем верные или неполные утверждения). К счастью, есть утекшие сырки Win NT (жутко устарело и не стоит тратить на них время, если только в целях общего развития), Win 2000. А еще по студенческой программе M&#036; таки сама открыла часть ядра ОС. Я был на лекции двух сотрудников Microsoft, которые говорили об этой проблеме так &quot;мы будучи студентами изучали ОС под призмой UNIX, тяжело было переучиваться, уже работая в компании, поэтому для универсализации университетских программ WRK очень поможет&quot;. Не важно, что там у них произошло с идеологией и почему они так сделали. Но WRK есть и его надо изучать, если вы лезете в ядро.<br><br>По поводу сегментных регистров, согласен с <b>Archer</b>&#039;ом. Это вам надо маны по процессорам почитать (том 3, если конкретнее), а также перенести эти знания &quot;на призму Windows&quot;, т.е. понять куда указывают сегментные регистры в режиме ядра и какими они должны быть.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=336204&amp;user=2449&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=23" class="addthx" data-post="336204"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=36083" title="13-01-2014 14:07, ранг:18.2" target="_blank">MickeyBlueEyes</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]MickeyBlueEyes[/b]','')">MickeyBlueEyes</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 51.6 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.7'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36083">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2014 18:15 <br><script type="text/javascript">QU('MickeyBlueEyes','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MickeyBlueEyes" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#24');return false;">#24</a> </span><div align=left><br>
Как грамотно изложили. По поводу асма полностью с вами согласен, уже отложена книга в ящик, а точнее пару глав с неё по написанию модулей на АСМе и дальнейшей компоновкой. Просто сейчас приоритетней kernel mode, вот и пишу пока как получается ) До манов интелов ещё не добирался ) Сейчас читаю известный четырёх томник &quot;Микропроцессор i486. Архитектура и программирование&quot;, нравится, очень хорошо расписано, аналогов походу нету, книга хоть и 93 года, но актуальна как по мне. Руссиновича с первого раза не потянул, бегал со стороны в сторону, щас вроде как уже норм, осилить смогу. <br>Люкмор с селекторами убил ) У меня у самого сложилось чтото вроде этого после прочтения главы по сегментам из &quot;Микропроцессор i486. Архитектура и программирование&quot;.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=336205&amp;user=36083&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=24" class="addthx" data-post="336205"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2014 18:20 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#25');return false;">#25</a> </span><div align=left><br>
<I>Dr0p пишет:<br>Нет, это не тот вектор. Вам нужен #PF(14-й дескриптор). </I><br><I>MickeyBlueEyes пишет:<br>Да 0x14 , то уже путаться начал.  </I><br>Только я обратил внимание на ошибку? 0x14=20 = #VE Virtualization Exception. А вот #PF это 0x0E = 14.<br><br>Опять-таки, ман интела, том 3. Глава 6.3, там есть таблица &quot;Table 6-1. Protected-Mode Exceptions and Interrupts&quot;. В ней перечислены все аппаратно генерируемые исключения и прерывания.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=336206&amp;user=2449&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=25" class="addthx" data-post="336206"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]MickeyBlueEyes[/b]','')">MickeyBlueEyes</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 51.6 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.7'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36083">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2014 18:32 &middot; Поправил: MickeyBlueEyes <br><script type="text/javascript">QU('MickeyBlueEyes','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MickeyBlueEyes" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#26');return false;">#26</a> </span><div align=left><br>
Да эта ошибка была замечена почти сразу <img src="img/smilies/s5.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=336207&amp;user=36083&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=26" class="addthx" data-post="336207"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2014 19:49 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#27');return false;">#27</a> </span><div align=left><br>
<b>int</b>,<br>Например, можно так:<br><b>- - - - - - - - - - - - - - - -&gt;8<br>__asm <br>{<br>pushfd<br>mov ecx,eax<br>..................<br>..............<br>popfd<br>}<br>- - - - - - - - - - - - - - - -&gt;8</b><br>- и не придётся заморачиваться с раздельной компиляцией C/ASM. <br>Всё равно переносимость тут и не нужна. <br><br><b>MickeyBlueEyes</b>,<br>))) если имеете в виду четырёхтомнк Григорьева - да, книга хорошая (можно сказать, единственная в своём роде),<br>но безобразная вёрстка таблиц, опечатки, и в первом томе все 6 примеров кода (в конце) никуда не годятся. Побиты при вёрстке и безграмотном наборе. Работают только после изменения ~30% кода, так что не обольщайтесь.<br>И - да, напрягает, что всюду в той книге номера прерываний в десятичной системе. <br>Зато - хорошее, передранное из интеловских мануалов, описание системы команд.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=336209&amp;user=35473&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=27" class="addthx" data-post="336209"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2014 20:11 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#28');return false;">#28</a> </span><div align=left><br>
И каким это образом избавит от необходимости раздельно компилировать с\асм, если это не покатит под х64 по природе кода? И +в х64 асм-вставки в студии запрещены. Разговор шёл про нормальный портабельный код, а не клеркокостыли, работающие на единственной платформе, а то и единственном билде ОС.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=336211&amp;user=1556&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=28" class="addthx" data-post="336211"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2014 20:14 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#29');return false;">#29</a> </span><div align=left><br>
<b>dosprog</b><br>Это довольно убогий стиль. Речь шла не про переносимость. Проблем с раздельной компиляцией нет - для этого надо просто настроить проект.<br><br><b>Archer</b><br>+1, я пытался вспомнить почему в Visual Studio нельзя использовать __asm, действительно, причина кроется именно в x64 версии. И вот тогда будет действительно сложно заниматься переносом каши из кода на сях и на ассемблере, не говоря уже о необходимости поддерживать нововведения x64. Такой код просто выбрасывается на помойку и все.<br><br>У Зубкова кстати тоже тексты битые в электронной книге. Но что-то мне подсказывает, что в оригинале тоже были проблемы (в смысле в бумажной версии).<br><br><b>Archer</b><br>Инди делает технологии. И по крайней мере не занимается смешиванием двух видов кода, а делает его на православном ассемблере. По поводу переносимости кода между ОС вопроса нет. В линуксе до сих пор даже близко нет аналога SoftICE. Быть может потому, что он никому на фиг не сдался? Весь код открыт, отладить все можно в gdb. Тем более смешно наблюдать, как некоторые товарищи жалуются, что у них в маке проблемы с инструментами. В маке даже защитить от крекеров проги сложно, там достаточно IDA для любого взлома. Что касается переносимости кода между билдами ОС, это не проверенная информация, а в основном лозунги тех, у кого что-то не получилось запустить. Объективных баг-репортов не было. А критиковать каждый может. QU например, тоже As Is поставляется, но не лишен багов.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=336212&amp;user=2449&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=29" class="addthx" data-post="336212"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=35473" title="13-01-2014 16:29, ранг:39.2" target="_blank">dosprog</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2014 20:25 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#30');return false;">#30</a> </span><div align=left><br>
<b>int</b>,<br><img src="img/smilies/s6.gif" alt=""> Зубков... Там практически <b>ни один пример</b> без правки не работает. (В бумаге всё так же, как и в эл.версии).<br>Особенно меня развеселил примерчик с &quot;нереальным 86&quot; режимом. <br>Там не опечатки, а то-ли дралось откуда-попадя, то-ли специально так сделано (не верится,хотя...).<br>&quot;Нереальный 86&quot; мне обошёлся в неделю времени с этим самым Григорьевым в зубах. Какой там интернет...<br><br><b>Archer</b>,да.<br>P.S. и присоединяюсь к сказанному <b>int</b>&#039;ом в предыдущем посте.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=336213&amp;user=35473&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=30" class="addthx" data-post="336213"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2014 20:30 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22388&amp;page=1#31');return false;">#31</a> </span><div align=left><br>
<b>dosprog</b><br>Про Зубкова я вспомнил, т.к. сам по нему учился. А потом, блин, переучивался, когда понял что этой книгой можно обтираться. Если ты что-то пишешь, найти рецензента адекватного, чтобы сказал хотя бы, стоит ли публиковать <u>ошибки с текстом</u>.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=336215&amp;user=2449&amp;forum_n=6&amp;topic=22388&amp;page=1&amp;anchor=31" class="addthx" data-post="336215"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=6&amp;topic=22388&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Перехват прерываний и исключений</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="22388">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22388" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
