<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Изменение протокола обмена по последовательному порту RS-232 в программе - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Привет всем! Помогите в следующей проблеме. Есть программа для взешивания авто, работает с измерительными весами. Программа работает с измерительным блоком КВА-15, нужно ее переделать на работу с ИБ КВА-25. Протокол обмена для">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=5602'>ut2004</a>, <a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Изменение протокола обмена по последовательному порту RS-232 в программе</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]disasm[/b]','')">disasm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.08'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=5186">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 августа 2006 02:17 &middot; Поправил: disasm <br><script type="text/javascript">QU('disasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=disasm" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5845.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Привет всем!
<br>Помогите в следующей проблеме.
<br>
<br>Есть программа для взешивания авто, работает с измерительными весами. Программа работает с измерительным блоком КВА-15, нужно ее переделать
<br>на работу с ИБ КВА-25. Протокол обмена для КВА-15 не удалось достать.
<br>Программа ничем не запакована, написана на Borland C++, никаких защит нет.
<br>Сама программа (1065 Kb) http://www.disasm.nm.ru/Scale.rar 
<br>
<br>Для работы программы требуется BDE. 
<br>Минимальный набор BDE необходимый для работы программы (751 Kb) http://www.disasm.nm.ru/BDE.rar 
<br>
<br>Путь установленной программы &quot;C:&#92;Program Files&#92;Scale&#92;&quot;
<br>Из архива Scale.rar файл IDAPI32.CFG нужно скопировать в &quot;C:&#92;Program Files&#92;Common Files&#92;Borland Shared&#92;BDE&#92;&quot; и запустить файл реестра reg.reg (делает записи в BDE)
<br>Логин &quot;АДМИНИСТРАТОР&quot;, Пароль &quot;Админ&quot;
<br>
<br><b>Протокол обмена между измерительным блоком(ИБ) КВА-25 и компьютером.</b>
<br>Обмен ведётся по последовательному порту RS-232 на скорости 19200, 8 бит данных, без чётности, 1 стоп-бит.
<br>Обмен данными может быть инициирован как компьютером, так и ИБ. В первом случае компьютер посылает байт запрос и получает требуемую информацию. Во втором - ИБ передаёт информацию о прошедшей оси.
<br>Режимы работы ИБ.
<br>Имеются два режима работы системы: динамический - основной и статический дополнительный.
<br>При работе в основном режиме ИБ ведёт непрерывный контроль за состоянием грузоприёмной платформы и автоматически передаёт информацию о прошедших по ней осях без запроса со стороны компьютера в следующем формате:
<br>Длинна посылки - 7 байт. Первый байт = 00h, второй, третий - время проезда
<br>оси по платформе в обратных отсчётах миллисекунд (т.е. отсчёт ведётся от максимума по убывающей FFFEh=lMC, FFFDh=2MC,...), четвёртый, пятый - слово определяющее вес оси в условных единицах, шестой,седьмой - время прошедшее от съезда предыдущей оси до наезда данной в миллисекундах.
<br>При работе ИБ в статическом режиме, он не проводит ни каких измерений самостоятельно и ждёт команды со стороны компьютера.
<br>Система команд.
<br>Команда всегда подаётся компьютером. Длинна команды - 1 байт. В ответ на команду ИБ возвращает 3 байта данных.
<br>Измерительный блок &quot;понимает&quot; следующие команды:
<br>1 - Перейти в режим статического измерения и вернуть текущий вес платформы.
<br>2 - Перейти в режим динамического измерения и вернуть текущий вес платформы.
<br>3 - Вернуть версию ПО измерительного блока.
<br>В ответ возвращается следующая информация:
<br>команда ответ
<br>1      первый байт = 30h, второй, третий байты - слово определяющее текущий вес платформы в условных единицах
<br>2      первый байт = 40h, второй, третий байты - слово определяющее текущий вес платформы в условных единицах
<br>3      первый байт = 20h, второй, третий байты - слово определяющее версию ПО измерительного блока.
<br>
<br>
<br>С помощью IDA v4.9 выцепил в программе следующий кусок кода, который задает параметры работы COM-порта
<br>
<br>.text:0040D16F loc_40D16F:                             ; CODE XREF: sub_40D128+Ej
<br>.text:0040D16F                 lea     ecx, [ebp+DCB]
<br>.text:0040D172                 push    ecx             ; lpDCB
<br>.text:0040D173                 mov     eax, [ebx+18h]
<br>.text:0040D176                 push    eax             ; hFile
<br>.text:0040D177                 call    GetCommState
<br>.text:0040D17C                 mov     edx, [ebp+arg_4]                    
<br>.text:0040D17F                 mov     [ebp+DCB.BaudRate], edx
<br>.text:0040D182                 lea     edx, [ebp+DCB]
<br>.text:0040D185                 mov     [ebp+DCB.ByteSize], 8
<br>.text:0040D189                 mov     cl, [ebp+arg_8]
<br>.text:0040D18C                 mov     [ebp+DCB.Parity], cl
<br>.text:0040D18F                 mov     al, [ebp+arg_C]
<br>.text:0040D192                 mov     [ebp+DCB.StopBits], al
<br>.text:0040D195                 and     byte ptr [ebp+DCB.fDummy2+1], 0CFh
<br>.text:0040D199                 push    edx             ; lpDCB
<br>.text:0040D19A                 mov     ecx, [ebx+18h]
<br>.text:0040D19D                 push    ecx             ; hFile
<br>.text:0040D19E                 call    SetCommState
<br>.text:0040D1A3                 xor     eax, eax
<br>.text:0040D1A5
<br>.text:0040D1A5 loc_40D1A5:                             ; CODE XREF: sub_40D128+1Bj
<br>.text:0040D1A5                 pop     ebx
<br>.text:0040D1A6                 mov     esp, ebp
<br>.text:0040D1A8                 pop     ebp
<br>.text:0040D1A9                 retn
<br>.text:0040D1A9 sub_40D128      endp
<br>
<br>что получил при отладке:
<br>DCB.BaudRate=4B0h
<br>DCB.ByteSize=8
<br>DCB.Parity=0
<br>DCB.StopBits=1
<br>Т.е обмен ведётся по последовательному порту на скорости 1200, 8 бит данных, без чётности, 1 стоп-бит.
<br>Программа возращается по адресу 402794
<br>
<br>Кто знает, что за поле DCB.fDummy2? За что оно отвечает?
<br>И можно ли в IDA поставить точку останова на память [ebp+arg_4], или подскажите как отследить? Хотелось бы найти откуда задается скорость.
<br>
<br>Последующая работа с COM-портами идет как с файлами, путем использования функций ReadFile(40B1CC) и WriteFile(40D1AC).
<br>
<br>.text:0040D1AC ; --------------- S U B R O U T I N E ---------------------------------------
<br>.text:0040D1AC
<br>.text:0040D1AC ; Attributes: bp-based frame
<br>.text:0040D1AC
<br>.text:0040D1AC ; int __cdecl sub_40D1AC(int,int Buffer)
<br>.text:0040D1AC sub_40D1AC      proc near               ; CODE XREF: sub_40D224+Dp
<br>.text:0040D1AC                                         ; sub_40D224+18p ...
<br>.text:0040D1AC
<br>.text:0040D1AC NumberOfBytesWritten= dword ptr -4
<br>.text:0040D1AC arg_0           = dword ptr  8
<br>.text:0040D1AC Buffer          = dword ptr  0Ch
<br>.text:0040D1AC
<br>.text:0040D1AC                 push    ebp
<br>.text:0040D1AD                 mov     ebp, esp
<br>.text:0040D1AF                 push    ecx
<br>.text:0040D1B0                 mov     eax, [ebp+arg_0]
<br>.text:0040D1B3                 lea     edx, [ebp+NumberOfBytesWritten]
<br>.text:0040D1B6                 push    0               ; lpOverlapped
<br>.text:0040D1B8                 push    edx             ; lpNumberOfBytesWritten
<br>.text:0040D1B9                 lea     ecx, [ebp+Buffer]
<br>.text:0040D1BC                 push    1               ; nNumberOfBytesToWrite
<br>.text:0040D1BE                 push    ecx             ; lpBuffer
<br>.text:0040D1BF                 mov     eax, [eax+18h]
<br>.text:0040D1C2                 push    eax             ; hFile
<br>.text:0040D1C3                 call    WriteFile
<br>.text:0040D1C8                 pop     ecx
<br>.text:0040D1C9                 pop     ebp
<br>.text:0040D1CA                 retn
<br>.text:0040D1CA sub_40D1AC      endp
<br>.text:0040D1CA
<br>.text:0040D1CA ; ---------------------------------------------------------------------- -----
<br>.text:0040D1CB                 align 4
<br>
<br>
<br>
<br>
<br>.text:0040D1CC sub_40D1CC      proc near               ; CODE XREF: sub_40D224+80p
<br>.text:0040D1CC                                         ; sub_40D2FC+22p ...
<br>.text:0040D1CC
<br>.text:0040D1CC var_5           = byte ptr -5
<br>.text:0040D1CC NumberOfBytesRead= dword ptr -4
<br>.text:0040D1CC arg_0           = dword ptr  8
<br>.text:0040D1CC
<br>.text:0040D1CC                 push    ebp
<br>.text:0040D1CD                 mov     ebp, esp
<br>.text:0040D1CF                 add     esp, 0FFFFFFF8h
<br>.text:0040D1D2                 push    ebx
<br>.text:0040D1D3                 mov     ebx, [ebp+arg_0]
<br>.text:0040D1D6                 push    0
<br>.text:0040D1D8                 push    0
<br>.text:0040D1DA                 push    0
<br>.text:0040D1DC                 push    0Fh
<br>.text:0040D1DE                 push    0
<br>.text:0040D1E0                 push    ebx
<br>.text:0040D1E1                 call    sub_40D05C
<br>.text:0040D1E6                 add     esp, 18h
<br>.text:0040D1E9                 lea     eax, [ebp+NumberOfBytesRead]
<br>.text:0040D1EC                 lea     edx, [ebp-5]
<br>.text:0040D1EF                 push    0               ; lpOverlapped
<br>.text:0040D1F1                 push    eax             ; lpNumberOfBytesRead
<br>.text:0040D1F2                 push    1               ; nNumberOfBytesToRead
<br>.text:0040D1F4                 push    edx             ; lpBuffer
<br>.text:0040D1F5                 mov     ecx, [ebx+18h]
<br>.text:0040D1F8                 push    ecx             ; hFile
<br>.text:0040D1F9                 call    ReadFile
<br>.text:0040D1FE                 push    0
<br>.text:0040D200                 push    0
<br>.text:0040D202                 push    0
<br>.text:0040D204                 push    0
<br>.text:0040D206                 push    0FFFFFFFFh
<br>.text:0040D208                 push    ebx
<br>.text:0040D209                 call    sub_40D05C
<br>.text:0040D20E                 add     esp, 18h
<br>.text:0040D211                 cmp     [ebp+NumberOfBytesRead], 0
<br>.text:0040D215                 jnz     short loc_40D21C
<br>.text:0040D217                 or      eax, 0FFFFFFFFh
<br>.text:0040D21A                 jmp     short loc_40D21F
<br>.text:0040D21C ; ---------------------------------------------------------------------- -----
<br>.text:0040D21C
<br>.text:0040D21C loc_40D21C:                             ; CODE XREF: sub_40D1CC+49j
<br>.text:0040D21C                 mov     al, [ebp+var_5]
<br>.text:0040D21F
<br>.text:0040D21F loc_40D21F:                             ; CODE XREF: sub_40D1CC+4Ej
<br>.text:0040D21F                 pop     ebx
<br>.text:0040D220                 pop     ecx
<br>.text:0040D221                 pop     ecx
<br>.text:0040D222                 pop     ebp
<br>.text:0040D223                 retn
<br>.text:0040D223 sub_40D1CC      endp
<br>.text:0040D223
<br>.text:0040D224
<br>
<br>
<br>При чтении есть параметр NumberOfBytesRead, который определяет как я понял, сколько байт следует принять(считать).
<br>Как пройти начальную инициализацию COM-портов, чтобы добраться до функций чтения-записи под отладкой?
<br>Уберать все проверки? Или возращать положительные результаты этих проверок?
<br>Или можно написать заглушку для COM-портов, эмулировав передачу данных программе?
<br>
<br>
<br><b>p.s.</b> Программы ломал еще в 2000 году, отучил пару программ от диска, пару зарегестрировал на себя. Потом стало не до взлома, все время ушло на учебу. Сейчас приходиться вспоминать старое, надеюсь обойдусь без SoftICE. Опыта работы с COM-портами нет, так что помогайте кто чем может.
<br>Буду презнателен за
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=86399&amp;user=5186&amp;forum_n=5&amp;topic=5845.html&amp;page=0&amp;anchor=1" class="addthx" data-post="86399"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 августа 2006 22:14 <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5845.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>disasm</b>
<br>Доступ к порту должен начинаться примерно так:
<br>hcom=CreateFile(&quot;COM1&quot;, GENERIC_READ | GENERIC_WRITE, ......
<br>далее задается режим работы порта... <I>disasm пишет:
<br>Как пройти начальную инициализацию COM-портов, чтобы добраться до функций чтения-записи под отладкой? </I> не совсем понял вопроса... ты вообще как отлаживаешь? Бери OllyDbg и ставь точку останова на функции WriteFile, ReadFile, аналогично на доступ к памяти [ebp+arg_4].
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=86552&amp;user=2060&amp;forum_n=5&amp;topic=5845.html&amp;page=0&amp;anchor=2" class="addthx" data-post="86552"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]disasm[/b]','')">disasm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.08'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=5186">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2006 15:56 <br><script type="text/javascript">QU('disasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=disasm" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5845.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>Error_Log</b>
<br>Программа вначале проверяет готовность устройста ИБ КВА-15, инициализирует его и только после этого принимает данные.
<br>Проблема в том, что сейчас я не могу работать вместе с весами, соответственно остается изучать код программы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=86662&amp;user=5186&amp;forum_n=5&amp;topic=5845.html&amp;page=0&amp;anchor=3" class="addthx" data-post="86662"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]f0ma[/b]','')">f0ma</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.66'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3003">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 05:27 <br><script type="text/javascript">QU('f0ma','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f0ma" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5845.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>disasm пишет:
<br>Как пройти начальную инициализацию COM-портов, чтобы добраться до функций чтения-записи под отладкой? </I>
<br>а просто пропатчить данные по адресам ebp+DCB.BaudRate, ebp+DCB.ByteSize итд нужными значениями?
<br><I>disasm пишет:
<br>Кто знает, что за поле DCB.fDummy2? За что оно отвечает? </I>
<br>По докам от M&#036;  это поле зарезервировано. Неплохой ман по COM - upload.caxapa.ru/components/test/%D0%E0%E1%EE%F2%E0%20%F1%20COM%20%EF%EE%F0%F2%E0%EC%E8%20%D2%E8%F2%EE%E2.doc
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=86798&amp;user=3003&amp;forum_n=5&amp;topic=5845.html&amp;page=0&amp;anchor=4" class="addthx" data-post="86798"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Изменение протокола обмена по последовательному порту RS-232 в программе</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#5" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="5845">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=5845" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
