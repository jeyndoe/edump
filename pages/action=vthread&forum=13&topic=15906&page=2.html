<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Декомпилятор ВМ - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Вашему вниманию предлагаются наработки по декомпиляции ВМ. Проект на сегодняшний день для меня завершен, но жаль если результат &quot;ляжет на полку&quot;, может кому-нибудь и пригодится. Предлагаю сначала ознакомиться с обзором,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Декомпилятор ВМ</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=1.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=1.html">2</a> . <b>3</b> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=7.html">8</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=22.html">23</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=23.html">24</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=3.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 12:33 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#1');return false;">#1</a> </span><div align=left><br>
Вашему вниманию предлагаются наработки по декомпиляции ВМ.<br>Проект на сегодняшний день для меня завершен, но жаль если результат &quot;ляжет на полку&quot;, может кому-нибудь и пригодится. Предлагаю сначала ознакомиться с обзором, и если будет интерес то могу выложить и сам плагин, или здесь или в личку заинтересованным лицам, каким образом, пока ещё не решил...<br>Но если кто-либо ожидает увидеть &quot;автоматическое чудо&quot;, то сразу скажу - его нет. Для того чтобы получить результат нужна ручная предварительная работа:<br>- с исследуемой программы должна быть снята упаковка<br>- точки входа в ВМ находятся вручную<br>- возможно неоднократное &quot;жамкание&quot; клавиш в OllyDbg, а возможно и модификация кода, чтобы попасть в нужное место, в зависимости от защищенной функции<br>- необходимо вручную прицепить к программе требуемый секцию<br>- запись результатов в файл это тоже ручная работа, но уже более приятная<br><br>Не всё гладко обстоит с определением реализаций ВМ, на сегодняшний день примерно каждая третья реализация автоматом не определяется, приходится под неё модернизировать плагин, т.к. не могу сразу предусмотреть все случаи &quot;издевательств&quot; ВМ с кодом примитивов. Лучше дела с восстановлением &quot;исходного&quot; кода защищенных функций - 70% нормально восстанавливается, хотя во многом это зависит от самой структуры функции. Таким образом, если будет заинтересованность и помощь в нахождении подобных ситуаций, то проект может быть доведен до релизной стадии.<br><br>ЗЫ: Речь идет об <i class=x>Ореановских</i> машинах. Нигде специально не упоминал.<br><br><img src="img/attach.gif" alt=""> <a href="./files/9c41_03.03.2010_CRACKLAB.rU.tgz">9c41_03.03.2010_CRACKLAB.rU.tgz</a> - VMSweeperLst.rar
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253056&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=1" class="addthx" data-post="253056"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2010 15:42 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#2');return false;">#2</a> </span><div align=left><br>
Заканчиваю написание деобфускатора апишных вызовов применительно к <a href="http://www.exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=1#15" target="_blank">этому</a>.<br>на входе имеем, вернее при создании этого кода уже &quot;удалены&quot; вызовы call, jmp и jcc<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A39CD8<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">0FF3B31FBh</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A39CDD<span class="hl_char">:</span>&nbsp;<span class="hl_function">pushad</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">2</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A39CDE<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">20h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">3</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A39CE2<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">*</span><span class="hl_number">8</span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">0B4710A2Eh</span><span class="hl_char">]</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">4</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A39CE9<span class="hl_char">:</span>&nbsp;<span class="hl_function">pushad</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">5</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A39CEA<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span>0x01A22BA2<span class="hl_char">]</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">6</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A39CEF<span class="hl_char">:</span>&nbsp;<span class="hl_function">pushfd</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">7</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A39CF0<span class="hl_char">:</span>&nbsp;<span class="hl_function">pushfd</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">8</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A39CF1<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">0D3CE15F6h</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">9</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A39CF6<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">01A39CFBh</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">10</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2FA0C<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">50h</span><span class="hl_char">]</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">11</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2FA10<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">01A2FA15h</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">12</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A1ED7B<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">0B03C1EBEh</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">13</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A1ED80<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">01A1ED85h</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">14</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2F026<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">95703AEEh</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">15</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2F02B<span class="hl_char">:</span>&nbsp;<span class="hl_function">pushad</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">16</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2F02C<span class="hl_char">:</span>&nbsp;<span class="hl_function">pushfd</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">17</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2F02D<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">28h</span><span class="hl_char">]</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">18</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2F031<span class="hl_char">:</span>&nbsp;<span class="hl_function">stc</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">19</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2F032<span class="hl_char">:</span>&nbsp;<span class="hl_function">stc</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">20</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2F033<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0AFBF00BFh</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">21</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2F038<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0E2B0h</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">22</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2F03E<span class="hl_char">:</span>&nbsp;<span class="hl_function">clc</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">23</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2F03F<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>rol</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">6</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">24</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2F042<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">si</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">25</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2F047<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0CFh</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">26</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2F04C<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">01A2F051h</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">27</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D4F<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>dec</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">28</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D50<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;<span class="hl_registr">dx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">bx</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">29</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D53<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">30</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D55<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;<span class="hl_number">43B0153Ah</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">31</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D5B<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">al</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">32</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D5F<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">5F508C6Bh</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">33</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D64<span class="hl_char">:</span>&nbsp;<span class="hl_function">pushfd</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">34</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D65<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>ror</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">4</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">35</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D68<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">36</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D6C<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;<span class="hl_number">7Fh</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">bl</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">37</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D6F<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">]</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">38</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D72<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>bt</b></span>&nbsp;<span class="hl_registr">di</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">3</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">39</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D77<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">40</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D79<span class="hl_char">:</span>&nbsp;<span class="hl_function">stc</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">41</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D7A<span class="hl_char">:</span>&nbsp;<span class="hl_function">pushfd</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">42</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D7B<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>sub</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">88B8FB44h</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">43</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D80<span class="hl_char">:</span>&nbsp;<span class="hl_function">cld</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">44</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A28D81<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;<span class="hl_registr">ch</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ch</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">45</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A362BC<span class="hl_char">:</span>&nbsp;<span class="hl_function">stc</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">46</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A362BD<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">47</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A362BF<span class="hl_char">:</span>&nbsp;<span class="hl_function">pushfd</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">48</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2A8C3<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">40h</span><span class="hl_char">]</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">49</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2A8C7<span class="hl_char">:</span>&nbsp;<span class="hl_function">popfd</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">50</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2A8C8<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0A44006F0h</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">51</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2A8CF<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">bp</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">52</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2A8D3<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">sp</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">53</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2A8D7<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">54</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2A8DB<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">44h</span><span class="hl_char">]</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">55</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2A8DF<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>retn</b></span>&nbsp;<span class="hl_number">48h</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">56</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2FA15<span class="hl_char">:</span>&nbsp;<span class="hl_function">pushad</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">57</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2FA16<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">58</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2FA17<span class="hl_char">:</span>&nbsp;<span class="hl_function">pushad</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">59</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2FA18<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">60</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2FA1A<span class="hl_char">:</span>&nbsp;<span class="hl_function">cwde</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">61</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2FA1B<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">44h</span><span class="hl_char">]</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">62</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2FA1F<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">10h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">99h</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">63</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2FA24<span class="hl_char">:</span>&nbsp;<span class="hl_function">pushfd</span></li><li class="hl_l0">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">64</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2FA25<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">]</span></li><li class="hl_l1">Instr<span class="hl_char">:</span>&nbsp;<span class="hl_number">65</span>&nbsp;parsing&nbsp;<span class="hl_char">-</span>&nbsp;0x01A2FA28<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">50h</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br>на выходе получил<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">01A39CD8</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr"><b>edi</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;0x7C802446&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;kernel32<span class="hl_char">.</span>Sleep</li>        </ol>
    </div>
</div></div>
<br>что делать дальше вроде бы понятно, но есть вопросы (задаю в скобках)<br>- найти съеденную IAT (можно ли это автоматизировать? или отдать юзеру, пусть сам ищет и вводит границы в предлагаемую форму?)<br>- найти в IAT секцию для kernel32 (каким образом, если она будет вообще пустой?)<br>- записать на свододное место секции адрес функции Sleep, адрес записи перенести в команду<br>mov edi, [addr]<br>- записать восстановленную команду на своё родное место<br>- запись изменений в файл (большой вопрос - на данном этапе ВМ с распаковки файла ещё не снята, импорт не восстановлен, стаб то же, следовательно записать в файл ничего не можем, как поступить в этом случае?)
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254232&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=2" class="addthx" data-post="254232"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2010 18:01 &middot; Поправил: DillerInc <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#3');return false;">#3</a> </span><div align=left><br>
<I>Vamit пишет:<br>следовательно записать в файл ничего не можем, как поступить в этом случае? </I><br>...выделяешь память размером с секцию кода, копируешь туда саму секцию и все изменения вносишь в эту память,высчитывая смещение: instr VA - code section VA == offset | temp mem VA + offset == instr in temp mem VA<br>Я считаю, что подобный подход необходим всегда, ибо протектор может запросто проверять определённые метки во время выполнения своих процедур расчёта импорта, краденных инструкций и т.п.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254252&amp;user=1613&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=3" class="addthx" data-post="254252"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2010 20:11 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#4');return false;">#4</a> </span><div align=left><br>
<I>Vamit пишет:<br>найти съеденную IAT (можно ли это автоматизировать? или отдать юзеру, пусть сам ищет и вводит границы в предлагаемую форму?) </I><br>Обычно сначала заполняется табличка, отловить GPA прота не сложно да и проще сначала заполнить табличку по загружаемым библам чем раскидывать кашу при трейсе , а затем правит вызовы в сответствии с табличкой.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=254269&amp;user=293&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=4" class="addthx" data-post="254269"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 марта 2010 14:15 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#5');return false;">#5</a> </span><div align=left><br>
Подскажите, как в Ольке проверить на валидность начало какой-либо инструкции? Например, нашли jmp в нужную область, он может быть или реальным или липовым... (имеется ввиду не руками, конечно, а из SDK)
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254326&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=5" class="addthx" data-post="254326"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 марта 2010 11:25 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#6');return false;">#6</a> </span><div align=left><br>
<I>Vamit пишет:<br>как в Ольке проверить на валидность начало какой-либо инструкции? </I><br>т.к. ответа нет, отвечу сам<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">ulong&nbsp;sz<span class="hl_comment">;</span></li><li class="hl_l1">uchar<span class="hl_char">*</span>&nbsp;pDec&nbsp;<span class="hl_char">=</span>&nbsp;Finddecode<span class="hl_char">(</span>ip<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>sz<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function">if</span><span class="hl_char">(</span>pDec&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_char">*</span>pDec&nbsp;<span class="hl_char">&amp;</span>&nbsp;DEC_TYPEMASK<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;DEC_NEXTCODE<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;инструкция&nbsp;липовая</li><li class="hl_l0"><span class="hl_function">else</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;инструкция&nbsp;годная</li>        </ol>
    </div>
</div></div>
<br>вот только не знаю, насколько это решение полное...
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254415&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=6" class="addthx" data-post="254415"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2010 19:42 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#7');return false;">#7</a> </span><div align=left><br>
<I>Vamit пишет:<br>т.к. ответа нет, отвечу сам</I><br>да это нормально, обычно так и бывает, ковыряешь то, на что у многиих много чего нет<br>//в основном времени и...моска..
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254568&amp;user=3230&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=7" class="addthx" data-post="254568"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2010 08:41 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#8');return false;">#8</a> </span><div align=left><br>
Обновил VMSweeper, добавлено:<br>- анализ всех точек входа в ВМ с отображением статуса<br>- восстановление съеденного импорта, в том числе и структуры IAT<br><br>Эти две функции по идее могут работать с любыми типами ВМ, подопытный &quot;кролик&quot; <noindex><a href="http://rapidshare.com/files/357851780/VWTester.rar.html" rel="nofollow" target="_blank">здесь</a></noindex>, но чем больше типов ВМ будет протестировано и сообщены результаты, то...  тем лучше <img src="img/smilies/s1.gif" alt=""><br><br><img src="img/attach.gif" alt=""> <a href="./files/d8be_23.03.2010_CRACKLAB.rU.tgz">d8be_23.03.2010_CRACKLAB.rU.tgz</a> - VMSweeper1_2beta.rar
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254612&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=8" class="addthx" data-post="254612"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2010 13:14 <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#9');return false;">#9</a> </span><div align=left><br>
Восстановление импорта тестировалось только на ВМпроте? <br>Вроде похожий импорт был EXEcryptor<br>Найду прогу с такой опцией, дам ссыль
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254618&amp;user=2777&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=9" class="addthx" data-post="254618"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]kioresk[/b]','')">kioresk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/10650.gif" alt=""><br><span class=txtSm>Ранг: 154.2 (ветеран), 66thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10650">Участник</a><br><font color=blue>REVENGE Crew</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2010 13:26 <br><script type="text/javascript">QU('kioresk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kioresk" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#10');return false;">#10</a> </span><div align=left><br>
<b>Vamit</b>,<br><br>лучше убери шаманство с добавлением к файлу секции .vm, ибо все протекторы с нормальной ВМ всегда проверяют контрольную сумму файла, а добавлять секцию, править CRC, потом восстанавливать код, потом снова править CRC не айс.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=254620&amp;user=10650&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=10" class="addthx" data-post="254620"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2010 16:02 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#11');return false;">#11</a> </span><div align=left><br>
<I>daFix пишет:<br>Восстановление импорта тестировалось только на ВМпроте?  </I><br>Да, на том что было в наличии...<br><br><I>kioresk пишет:<br>лучше убери шаманство с добавлением к файлу секции .vm, ибо все протекторы с нормальной ВМ всегда проверяют контрольную сумму файла </I><br>лучше, чем что...? ладно, это лирика.<br>во-первых секция цепляется уже к распакованному файлу, который запускается и работает, так что CRC здесь не причем, на дампе она не проверяется.<br>во-вторых, она нужна для декомпиляции тела ВМ в промежуточный код, что можешь предложить взамен? Пока нужно где-то 64Кб, но возможно и больше в зависимости от длины кодированного участка функции, причем код в ней должен быть рабочим с вызовом из тела восстанавливаемой функции.<br><br>После восстановления фунции(й) эта секция больше не нужна.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254629&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=11" class="addthx" data-post="254629"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]kioresk[/b]','')">kioresk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/10650.gif" alt=""><br><span class=txtSm>Ранг: 154.2 (ветеран), 66thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10650">Участник</a><br><font color=blue>REVENGE Crew</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2010 16:47 <br><script type="text/javascript">QU('kioresk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kioresk" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#12');return false;">#12</a> </span><div align=left><br>
<I>во-первых секция цепляется уже к распакованному файлу, который запускается и работает, так что CRC здесь не причем, на дампе она не проверяется.</I><br><br>Если файл не надо будет предварительно распаковывать, то это облегчит жизнь реверсера (минус одна операция).<br><br><I>во-вторых, она нужна для декомпиляции тела ВМ в промежуточный код, что можешь предложить взамен? Пока нужно где-то 64Кб, но возможно и больше в зависимости от длины кодированного участка функции, причем код в ней должен быть рабочим с вызовом из тела восстанавливаемой функции.</I><br><br>Могу предложить VirtualAllocEx. <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=254631&amp;user=10650&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=12" class="addthx" data-post="254631"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2010 17:03 <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#13');return false;">#13</a> </span><div align=left><br>
<b>kioresk</b><br>+10, именно так декомпиляторы и делаются.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=254634&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=13" class="addthx" data-post="254634"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2010 17:07 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#14');return false;">#14</a> </span><div align=left><br>
<I>kioresk пишет:<br>то это облегчит жизнь реверсера (минус одна операция). </I><br>Если реверсер не сможет распаковать файл, то это уже не реверсер - ему и дальше делать нечего... <img src="img/smilies/s1.gif" alt=""><br>А вы хотите, чтобы декомпилятор ещё и файл полностью распаковал..., нет, таких задач я не ставил.<br><br><I>kioresk пишет:<br>Могу предложить VirtualAllocEx </I><br>Проверено, не работает, для работы эту память должна видеть Олька, а не только плагин, а Олька к сожалению видит только то, что пристегнуто к файлу.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254636&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=14" class="addthx" data-post="254636"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2010 17:09 <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#15');return false;">#15</a> </span><div align=left><br>
<I>Vamit пишет:<br>А вы хотите, чтобы декомпилятор ещё и файл полностью распаковал..., нет, таких задач я не ставил. </I><br>Декомпилятор это средство для декомпиляции. Не надо требовать распакованности файла, равно как и требовать от него распаковку.<br><br><I>Vamit пишет:<br>Проверено, не работает, для работы эту память должна видеть Олька, а не только плагин, а Олька к сожалению видит только то, что пристегнуто к файлу. </I><br>В контексте программы не пробовали сделать VirtualAllocEx?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=254637&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=15" class="addthx" data-post="254637"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2010 17:24 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#16');return false;">#16</a> </span><div align=left><br>
<I>progopis пишет:<br>В контексте программы не пробовали сделать VirtualAllocEx? </I><br>Да всё пробовал, вся беда в том, что плагин может вносить изменения только после того как файл загружен в Ольку, но, после того как он уже загружен (EIP на точке входа), к нему ничего Олькой не добавить. Память должна видеться не программой, а именно Олькой, как контекст программы.<br>Был ещё один вариант: сделать пустую dll загрузить в систему, а затем из Ольки выполнять на неё переход, не получилось, т.к. чтобы её увидела Олька она должна быть в импорте.<br>А что пихать Dll в импорт, что добавлять секцию к файлу - равнозначно, но второе проще, поэтому выбрал этот вариант.<br>Пока эта секция не мешает, но уже сейчас подхожу к ситуации, когда она нужна, а её ещё нет: восстановление съеденного стаба.<br>Для анализа входов в ВМ и восстановления импорта она не нужна, но чтобы завершить распаковку файла нужно встать на OEP или близко к ней и запустить декодирование стаба (пока работать без секции не будет), и только затем можно сохранить дамп и получить рабочий файл.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254639&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=16" class="addthx" data-post="254639"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2010 17:40 <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#17');return false;">#17</a> </span><div align=left><br>
<I>Vamit пишет:<br>к нему ничего Олькой не добавить</I><br>И как же тогда OllyDbgScript работает? Надо взять контекст программы, изменить ESP, в стэк засунуть параметры VirtualAllocEx, EIP переставить на VirtualAllocEx, не забыв в качестве адреса возврата бряк воткнуть, в выделенную память можно запихнуть любой управляющий код (а можно и сразу ВМ), после чего весь мусор убирается, если он был, а EIP возвращается на точку входа.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=254640&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=17" class="addthx" data-post="254640"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]kioresk[/b]','')">kioresk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/10650.gif" alt=""><br><span class=txtSm>Ранг: 154.2 (ветеран), 66thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10650">Участник</a><br><font color=blue>REVENGE Crew</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2010 17:50 &middot; Поправил: kioresk <br><script type="text/javascript">QU('kioresk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kioresk" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#18');return false;">#18</a> </span><div align=left><br>
<I>Если реверсер не сможет распаковать файл, то это уже не реверсер - ему и дальше делать нечего...<br>А вы хотите, чтобы декомпилятор ещё и файл полностью распаковал..., нет, таких задач я не ставил.</I><br><br>Вопрос не о знаниях реверсера (читай крутости), а об упрощении задачи и как следствие — экономии времени.<br><br><I>Да всё пробовал, вся беда в том, что плагин может вносить изменения только после того как файл загружен в Ольку, но, после того как он уже загружен (EIP на точке входа), к нему ничего Олькой не добавить. Память должна видеться не программой, а именно Олькой, как контекст программы.</I><br><br>Можно попробовать так:<br><br>1. забэкапить кусок кода на текущем EIP (c помощью Readmemory из SDK)<br>2. вставить туда шеллкод (c помощью Writememory из SDK), в котором будет вызываться VirtualAllocEx, а результат будет помещаться по оффсету EIP+xyz<br>3. далее шагам по шелкоду (или ставим бряк в конце и запускаем до бряка)<br>3. затем считываем результат из EIP+xyz, если там не ошибка — работаем с ним<br>4. восстанавливаем затертый кусок кода и значение EIP<br><br><b>Добавлено</b><br><br><b>progopis</b> опередил, да еще и с более простым решением. <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=254641&amp;user=10650&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=18" class="addthx" data-post="254641"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2010 20:30 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#19');return false;">#19</a> </span><div align=left><br>
Разобрался с VirtualAllocEx, оказалось, как всегда, всё гораздо проще - необходимо было в плагине после вызова VirtualAllocEx выполнить WriteProcessMemory и всё заработало...
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254646&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=19" class="addthx" data-post="254646"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 марта 2010 09:26 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#20');return false;">#20</a> </span><div align=left><br>
Проведя небольшой анализ VMProtect (до точки вызова обработчиков примитивов) выявил следующие отличия в его ВМ по сравнению с Ореановскими ВМ:<br>1.	Инициализация ВМ (конечная точка – вход в цикл интерпретатора ВМ)<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span style="word-break: break-all">Описание&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VMProtect&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CodeVirtualizer</span></li><li class="hl_l1"><span style="word-break: break-all">Код&nbsp;инициализации&nbsp;ВМ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;обфусцирован&nbsp;&nbsp;&nbsp;явный</span></li><li class="hl_l0">Адрес&nbsp;таблицы&nbsp;пикода&nbsp;<span class="hl_char">(</span>дно&nbsp;стека<span class="hl_char">)</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;закодирован&nbsp;&nbsp;&nbsp;&nbsp;доступен</span></li><li class="hl_l1"><span style="word-break: break-all">Порядок&nbsp;сохранения&nbsp;нативных&nbsp;регистров&nbsp;в&nbsp;стеке&nbsp;&nbsp;&nbsp;произвольный&nbsp;&nbsp;&nbsp;фиксированный</span></li><li class="hl_l0"><span style="word-break: break-all">Расположение&nbsp;регистров&nbsp;ВМ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;в&nbsp;стеке&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;в&nbsp;области&nbsp;кода</span></li><li class="hl_l1"><span style="word-break: break-all">Указатель&nbsp;на&nbsp;регистры&nbsp;ВМ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr"><b>EDI</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l0">Ключ&nbsp;кодирования&nbsp;инициализирован&nbsp;адресом&nbsp;пикода&nbsp;<span class="hl_registr"><b>EBX</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">EBX</span></li><li class="hl_l1"><span style="word-break: break-all">Указатель&nbsp;на&nbsp;стек&nbsp;программы&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr"><b>EBP</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ESP</span></li>        </ol>
    </div>
</div></div>
<br>2.	Интерпретатор ВМ (конечная точка – вызов обработчика примитива)<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span style="word-break: break-all">Описание&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VMProtect&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CodeVirtualizer</span></li><li class="hl_l1"><span style="word-break: break-all">Порядок&nbsp;просмотра&nbsp;пикода&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;прямой</span><span class="hl_char">/</span>обратный&nbsp;прямой</li><li class="hl_l0"><span style="word-break: break-all">Таблица&nbsp;обработчиков&nbsp;примитивов&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;в&nbsp;коде&nbsp;</span><span class="hl_char">(</span>256DW<span class="hl_char">)</span>&nbsp;&nbsp;в&nbsp;коде&nbsp;<span class="hl_char">(</span><span class="hl_char">&lt;</span>256DW<span class="hl_char">)</span></li><li class="hl_l1"><span style="word-break: break-all">Адрес&nbsp;обработчика&nbsp;примитива&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;закодирован&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;доступен</span></li>        </ol>
    </div>
</div></div>
<br>Выводы:<br>1. Реализовать в декомпиляторе один обработчик разных типов ВМ проблематично, но это и к лучшему. Проще под каждый тип ВМ сделать собственный обработчик на едином алгоритме, чем делать «солянку» в одном обработчике, по крайней мере, добавление обработчика нового типа ВМ не нарушит работу уже существующих.<br>2. Понятен общий принцип определения типа ВМ декомпилятором (сейчас он представляет из себя набор «жестких»условий, но на самом деле это не так):<br>	- найти точку входа в цикл интерпретатора ВМ при статическом анализе точки входа в ВМ из тела функции.<br>	-  выявить анализатором моменты указанные в таблице 1<br>	-  дойти статическим анализом до точки вызова обработчика примитива<br>	- выявить анализатором моменты указанные в таблице 2<br>	- подтвердить моменты таблицы 1<br>	- определить алгоритм хеширования кода примитива<br>	- определить алгоритм хеширования адреса обработчика примитива<br><br>А далее, после определения типа ВМ, идем по уже пройденной дорожке:<br>- идентифицируем обработчики примитивов ВМ<br>- «заменяем» интерпретатор ВМ с обработчиками примитивов промежуточным кодом и т.д., что уже было описано и  реализовано ранее…
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254672&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=20" class="addthx" data-post="254672"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 марта 2010 13:25 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#21');return false;">#21</a> </span><div align=left><br>
Вернусь к старому вопросу с <b>VirtualAllocEx</b>, не получается так как надо с динамической памятью:<br>память выделяется, Олька её видит, но в процессе декомпиляции выполняются рестарты программы и даже исключения в ней, затем принудительный рестарт - во всех этих случаях выделенный сегмент автоматом удаляется, если же создавать новый, то его адрес получается в большинстве случаев разный, следовательно код ассемблированный под определенный ip уже в этом сегменте не работает.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254677&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=21" class="addthx" data-post="254677"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2010 11:29 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#22');return false;">#22</a> </span><div align=left><br>
Работа с Bin файлом не подходит ? Можно делать predump , можно вносить куски кода временные переменные, или хучить вылетание ольги , и запоминать что было последнее ... при перезапуске файл всегда один
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254731&amp;user=3520&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=22" class="addthx" data-post="254731"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2010 12:30 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#23');return false;">#23</a> </span><div align=left><br>
<I>mak пишет:<br>Работа с Bin файлом не подходит? </I><br>Не понял, причем здесь bin файл, мне нужно не просто хранилище кода, на это добро и памяти хватает, а реально рабочий код, который добавляется к проге и который можно реально дебажить в Ольке в одном контексте с программой и который &quot;не разрушается&quot; при перезагрузке проги в Ольке. Фактически он, конечно, разрушается, но копия лежит у меня в памяти, а так как под него в проге отведен статический сегмент, то при перезагрузке проги он просто копируется из памяти в этот сегмент.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254735&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=23" class="addthx" data-post="254735"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]kioresk[/b]','')">kioresk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/10650.gif" alt=""><br><span class=txtSm>Ранг: 154.2 (ветеран), 66thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10650">Участник</a><br><font color=blue>REVENGE Crew</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2010 13:12 <br><script type="text/javascript">QU('kioresk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kioresk" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#24');return false;">#24</a> </span><div align=left><br>
<b>Vamit</b><br><br>сложно подсказать что-то конкретное не зная деталей, если бы приаттачил пример кода, размещаемого в этой памяти, и описал немного какая идет привязка между этой промежуточной областью и кодом жертвы, то было бы проще.<br><br>А так, думаю, ты и сам понимаешь, что только базовонезависимый код поможет в этом случае.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=254740&amp;user=10650&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=24" class="addthx" data-post="254740"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2010 13:16 <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#25');return false;">#25</a> </span><div align=left><br>
<I>mak пишет:<br>хучить вылетание ольги , и запоминать что было последнее </I><br>не задумывался почему в линуксе до сих пор нет корректного работающего hibernate (спящий режим)? Нет? Ну удачи. На хороших ВМ такой метод свалится на простейшей антиотладке.<br><br><I>mak пишет:<br>можно вносить куски кода временные переменные </I><br>это на каком языке написано?<br><br><I>Vamit пишет:<br>который можно реально дебажить в Ольке в одном контексте с программой </I><br>а зачем его дебажить? можно вообще не вязаться к ольке, а делать тулзу которая будет читать всё что нужно из памяти программы через ReadProcessMemory. Если уж очень сильно надо всё делать в ольке, надо разбираться почему происходят вылеты. Это явно либо некорректная работа декомпилятора, либо непрозрачность режима отладки (нарушение условий выполнения программы). Писать софт на костылях не имеет смысла. Хватает уже.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=254741&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=25" class="addthx" data-post="254741"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2010 14:17 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#26');return false;">#26</a> </span><div align=left><br>
<I>kioresk пишет:<br>сложно подсказать что-то конкретное не зная деталей </I><br><b>Всем</b> все детали выложены в обзоре и самом инструменте, и чтобы предметно разговаривать необходимо хотя-бы попробовать его работу - много вопросов и не нужных советов отпадут, а повторять то, что уже сказано, я не хочу. <br><I>только базовонезависимый код поможет в этом случае. </I><br>Промежуточный код не может быть базонезависимым, пример его есть в обзоре.<br><I>progopis пишет:<br>а зачем его дебажить? </I><br>Юзеру, если этот код правильный, то конечно, незачем. Вспомним это<br><I>Vamit пишет:<br>Не всё гладко обстоит с определением реализаций ВМ, на сегодняшний день примерно каждая третья реализация автоматом не определяется, приходится под неё модернизировать плагин, т.к. не могу сразу предусмотреть все случаи &quot;издевательств&quot; ВМ с кодом примитивов. </I>, т.ч. дебажить нужно мне и может быть тому кто хочет полностью восстановить съеденное тело функции, но декомпилятор пока в некоторых случаях это сделать не может. Промежуточный же код 100% получается рабочим.<br><I>progopis пишет:<br>можно вообще не вязаться к ольке, а делать тулзу которая будет читать всё что нужно из памяти программы </I><br>Можно, но нужен ассемблер + дизассемблер + дебаггер, которые сам я писать не собираюсь, в обзоре обоснован выбор инструмента.<br><I>progopis пишет:<br>Если уж очень сильно надо всё делать в ольке, надо разбираться почему происходят вылеты. </I><br>Да тут и так всё понятно, если прочитать обзор и хелп. Если с произвольного места программы переместить ip на New origin here и давануть F9, то вы должны предсказать что будет... Или другой пример, программа идет через семафор (условный переход) а мы принудительно переходим его в другое направление, которое может быть обработкой исключения...<br><I>progopis пишет:<br>Писать софт на костылях не имеет смысла. Хватает уже. </I><br>А костылей здесь нет, то что сидит в плагине независимо от кода программы, поэтому с ней можно делать всё что захочется, а плагин будет просто за этим наблюдать и собирать нужную инфу, главное саму Ольку не перегружать.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254747&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=26" class="addthx" data-post="254747"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2010 14:34 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#27');return false;">#27</a> </span><div align=left><br>
<I>Vamit пишет:<br>нужен ассемблер + дизассемблер + дебаггер, которые сам я писать не собираюсь </I><br>Разве это проблема? Ассемблер может быть, но вот дизасм движки хорошие уже написаны, прекрасно подходящие для задач RE. Наиболее хорошие примеры UDIS и Mediana. Есть ещё metasm, но не сильно изучал его на юзабельность (там есть ассемблирование вроде).  С отладчиками сложнее, но если не сильно волнует проблема отсутствия UI, то движков существует огромное мн-во, в том числе наш (который пока ещё не отлажен до конца, но тем не менее написан и работает). Я не просто языком здесь трещу, у нас есть рабочий декомпиль который работает по этому принципу. Отладчика там нет, только декомпиляция и деобфускация.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=254751&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=27" class="addthx" data-post="254751"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2010 14:49 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#28');return false;">#28</a> </span><div align=left><br>
<I>progopis пишет:<br>Разве это проблема? </I><br>Нет, это не проблема, но если есть наиболее легкий путь, то почему его не использовать? В Ольке есть всё, что мне необходимо и даже больше, чем надо...<br><br><I>progopis пишет:<br>в том числе наш (который пока ещё не отлажен до конца, но тем не менее написан и работает). </I><br>А можно где-нибудь с вашим ознакомиться?
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=254752&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=28" class="addthx" data-post="254752"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2010 15:19 <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#29');return false;">#29</a> </span><div align=left><br>
<I>Vamit пишет:<br>А можно где-нибудь с вашим ознакомиться? </I><br>Отписал в ЛС.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=254759&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=29" class="addthx" data-post="254759"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2010 12:35 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#30');return false;">#30</a> </span><div align=left><br>
В продолжение к <a href="http://www.exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#22" target="_blank">посту</a> (Таблица 1) привожу реальные слепки регистров и стека полученные декомпилятором на точке входа в цикл ВМ (сама точка так же распознается декомпилятором самостоятельно), для двух типов ВМ:<br>1. VMProtect<br>regs<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_registr">eax</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_registr">ecx</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_registr">edx</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_registr">ebx</span><span class="hl_char">:</span>&nbsp;0x01A373F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>hash&nbsp;key</li><li class="hl_l0"><span class="hl_registr">esp</span><span class="hl_char">:</span>&nbsp;0x0012FEE8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>bottom&nbsp;VM&nbsp;stack</li><li class="hl_l1"><span class="hl_registr">ebp</span><span class="hl_char">:</span>&nbsp;0x0012FFA8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_function"><b>addr</b></span>&nbsp;context&nbsp;app</li><li class="hl_l0"><span class="hl_registr">esi</span><span class="hl_char">:</span>&nbsp;<span class="hl_char">[</span>0x0012FFA8<span class="hl_char">]</span>&nbsp;<span class="hl_char">+</span>&nbsp;0x01A373F8&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>picode&nbsp;table</li><li class="hl_l1"><span class="hl_registr">edi</span><span class="hl_char">:</span>&nbsp;0x0012FEE8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_function"><b>addr</b></span>&nbsp;VM&nbsp;regs</li><li class="hl_l0">efl<span class="hl_char">:</span>&nbsp;efl</li>        </ol>
    </div>
</div></div>
<br>stack<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0012FEE8</span><span class="hl_char">:</span>&nbsp;empty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>VM&nbsp;regs</li><li class="hl_l1"><span class="hl_number">0012FEEC</span><span class="hl_char">:</span>&nbsp;empty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_number">0012FEF0</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FEF4</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FEF8</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FEFC</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FF00</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FF04</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FF08</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FF0C</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FF10</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FF14</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FF18</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FF1C</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FF20</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FF24</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FF28</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FF2C</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FF30</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FF34</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FF38</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FF3C</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FF40</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FF44</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FF48</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FF4C</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FF50</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FF54</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FF58</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FF5C</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FF60</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FF64</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FF68</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FF6C</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l0"><span class="hl_number">0012FF70</span><span class="hl_char">:</span>&nbsp;empty</li><li class="hl_l1"><span class="hl_number">0012FF74</span><span class="hl_char">:</span>&nbsp;empty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l0"><span class="hl_number">0012FF78</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_number">0012FF7C</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_number">0012FF80</span><span class="hl_char">:</span>&nbsp;0x0012FF84</li><li class="hl_l1"><span class="hl_number">0012FF84</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_number">0012FF88</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l1"><span class="hl_number">0012FF8C</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_number">0012FF90</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_number">0012FF94</span><span class="hl_char">:</span>&nbsp;0xCECE39D0</li><li class="hl_l0"><span class="hl_number">0012FF98</span><span class="hl_char">:</span>&nbsp;0x01A16CAB</li><li class="hl_l1"><span class="hl_number">0012FF9C</span><span class="hl_char">:</span>&nbsp;0x0BFBDBC8</li><li class="hl_l0"><span class="hl_number">0012FFA0</span><span class="hl_char">:</span>&nbsp;0x01A163D6</li><li class="hl_l1"><span class="hl_number">0012FFA4</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_number">0012FFA8</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_number">0012FFAC</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr"><b>edx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>context&nbsp;app&nbsp;regs</li><li class="hl_l0"><span class="hl_number">0012FFB0</span><span class="hl_char">:</span>&nbsp;efl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_number">0012FFB4</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_number">0012FFB8</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_number">0012FFBC</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">0012FFC0</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1"><span class="hl_number">0012FFC4</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_number">0012FFC8</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1"><span class="hl_number">0012FFCC</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr"><b>ebp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l0"><span class="hl_number">0012FFD0</span><span class="hl_char">:</span>&nbsp;0x01A17249</li><li class="hl_l1"><span class="hl_number">0012FFD4</span><span class="hl_char">:</span>&nbsp;0x4087E194&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>coded&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;picode</li><li class="hl_l0"><span class="hl_number">0012FFD8</span><span class="hl_char">:</span>&nbsp;var0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>top&nbsp;context&nbsp;app&nbsp;stack</li><li class="hl_l1"><span class="hl_number">0012FFDC</span><span class="hl_char">:</span>&nbsp;var1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_number">0012FFE0</span><span class="hl_char">:</span>&nbsp;var2</li>        </ol>
    </div>
</div></div>
<br><br>2. Ореановские ВМ<br>regs<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_registr">eax</span><span class="hl_char">:</span>&nbsp;<span class="hl_char">[</span><span class="hl_number">14B342E</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_registr">ecx</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_registr">edx</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l1"><span class="hl_registr">ebx</span><span class="hl_char">:</span>&nbsp;0x014D1D37&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>hash&nbsp;key</li><li class="hl_l0"><span class="hl_registr">esp</span><span class="hl_char">:</span>&nbsp;0x0012FFB0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>bottom&nbsp;VM&nbsp;stack</li><li class="hl_l1"><span class="hl_registr">ebp</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0"><span class="hl_registr">esi</span><span class="hl_char">:</span>&nbsp;0x014D1D37&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>picode&nbsp;table</li><li class="hl_l1"><span class="hl_registr">edi</span><span class="hl_char">:</span>&nbsp;0x014B33FE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_function"><b>addr</b></span>&nbsp;VM&nbsp;regs</li><li class="hl_l0">efl<span class="hl_char">:</span>&nbsp;efl</li>        </ol>
    </div>
</div></div>
<br>stack<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0012FFB0</span><span class="hl_char">:</span>&nbsp;efl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>context&nbsp;app&nbsp;regs</li><li class="hl_l1"><span class="hl_number">0012FFB4</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr"><b>edi</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_number">0012FFB8</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_number">0012FFBC</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0"><span class="hl_number">0012FFC0</span><span class="hl_char">:</span>&nbsp;0x0012FFC4</li><li class="hl_l1"><span class="hl_number">0012FFC4</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">0012FFC8</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l1"><span class="hl_number">0012FFCC</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_number">0012FFD0</span><span class="hl_char">:</span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l1"><span class="hl_number">0012FFD4</span><span class="hl_char">:</span>&nbsp;0x014D1D37&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_function"><b>addr</b></span>&nbsp;picode</li><li class="hl_l0"><span class="hl_number">0012FFD8</span><span class="hl_char">:</span>&nbsp;var0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>top&nbsp;context&nbsp;app&nbsp;stack</li><li class="hl_l1"><span class="hl_number">0012FFDC</span><span class="hl_char">:</span>&nbsp;var1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_number">0012FFE0</span><span class="hl_char">:</span>&nbsp;var2</li>        </ol>
    </div>
</div></div>
<br>отсюда видно, что распознать тип ВМ автоматически достаточно просто...
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255430&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=30" class="addthx" data-post="255430"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 апреля 2010 20:17 <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=2#31');return false;">#31</a> </span><div align=left><br>
Почитал доку<br>.<br><i class=x>Весь пикод хэширован определенным образом, ключом хэширования является адрес размещения пикода в памяти.</i><br>Неверно<br><i class=x>с созданием сигнатурного шаблона каждого примитива</i><br>Неверно<br><i class=x><b>Необходимость</b> предпоследней операции будет обоснована ниже.</i><br>Неверно<br><i class=x>то в нем ищется первый условный переход за пределы этого блока</i><br>Обрадую вас, в вмпротект нет условных переходов, вообще. Что будете делать? Рассказать об алгоритмической сложности задачи перебора всех возможных состояний?<br><br>Вывод: с мат. частью проблемы. Хорошие идеи есть и их очень много, но не уверен, что идеи авторские.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=255738&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=2&amp;anchor=31" class="addthx" data-post="255738"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=1.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=1.html">2</a> . <b>3</b> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=7.html">8</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=22.html">23</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=23.html">24</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=3.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Декомпилятор ВМ</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="15906">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15906" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
