<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Распаковка AsProtect на примерах - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте! Очень прошу, помогите найти или выдайте пжалста из запасов прогу Advanced Archive Password Recovery v.3.00 кто может, очень хочется научиться распаковке, а проги нормальной нет. Далее повтор моего вчерашнего">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=42623'>site-pro</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка AsProtect на примерах</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=3.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=3.html">4</a> . <b>5</b> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=7.html">8</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=11.html">12</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=12.html">13</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=5.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2007 12:10 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте! Очень прошу, помогите найти или выдайте пжалста из запасов прогу Advanced Archive Password Recovery v.3.00 кто может, очень хочется научиться распаковке, а проги нормальной нет. Далее повтор моего вчерашнего письма(лежит в чужой теме, найти можно в поиске введите: Распаковка ASProtecta - моё сообщение самое свежее)<br>----------------------------------------------------------------------  ------------------------------------------------------------------<br>Здравствуйте. Понимаю, что лезу немного не туда, но обсуждения статьи &quot;Распаковка нового ASProtect на примере Advanced Archive Password Recovery v.3.00&quot; автора SergSh на форуме и в поисковике вроде бы не видно(может статья просто древняя), а тут вроде бы тоже у ASR-ра 2-я версия. Суть проблемы:<br><br>1 Сам по вашим статьям научился распаковывать ASProtect 1.22-1.23 ,1.23 RC4, 1.24(проги типа Electra, Куриная месть.Первая разборка, скринсейвер и т.д. с затиранием репой краденого начала проги и без).<br><br>2 Нужно двигаться дальше и тут с удивлением обнаруживаю, что статей по распаковке версий 1.3-2.0 нет вааще(может я в шары долблюсь, незнаю). Плиз, если можно, то ссылку на подобную статью, а то руководство как починить велосипед есть(1.21-1.22), как починить мопед-есть(1.23 RC4), как починить боинг747 и космический челнок-есть(2.0x-2.12xx и выше). А вот как отремонтировать просто машину нет.<br><br>3 Из всех имеющихся статей более всего понятно было у SergSh в &quot;Распаковка нового ASProtect на примере Advanced Archive Password Recovery v.3.00&quot;, но тут такой казус. Проискав в инете подопытную прогу версии 3.0 нашел две ссылки, скачал, инсталятор обещал версия 3.0 (как в статье),- в итоге версия 3.01, чем забиты все ссылки на эту прогу в инете и PEID говорит не ASProtect 1.2-1.3 registered(2.0x по словам SergSh),а ASProtect 2.1x SKE. Ну ладно:<br><br>а)34раз Shift+F9 ставим бряк на ближайший переход внизу, ещё раз Shift+F9, снимаем бряк,ставим на Alt+M на секцию кода(401000), но не снова Shift+F9, как в статье, а trace into(а то EOP будет на две команды ниже и затруться два Push-а). Останавливаемся на EOP 42A910. Ctrl+A и всё видится чинно и благородно.<br><br>б)Читаем статейку дальше и пробуем запустить его скрипт(в папку его,в Script , в Олю, в виде txt предварительно). И оля повисает пробовал подождать 1,5 часа думал это скрипт так долго на более свежей версии ASp-ра трудится(хрен то там:s14. Запущено как положено без бряков и с OEP после trace into и я в plugin-&gt;IsDebuggerPresent -&gt;Hide, с полным игнором исключений.<br><br>в) Руками по его совету IAT пока не пробовал, всё так пока трудно для понимания и непривычно и завтра на работу а уже 2ночи. Граждане, слезно молю дайте ссылку на настоящий Advanced Archive Password Recovery v.3.00, а то шатл починить не могу пока, дайте хоть чертежи к боингу. А если почти серьезно, то научиться распаковывать ASPr до второй версии включительно руками хочется так, что аж эти руки зудят.<br><br>P.S. Не пинайте сильно за дурацкие просьбы самого маленького. Это первый выход в свет. Начал реверсить 18.12.06 с нуля. Реверсил даже в новогоднюю ночь. Для меня это очень важно(научиться распаковывать)!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=115630&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=1" class="addthx" data-post="115630"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2007 07:47 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#2');return false;">#2</a> </span><div align=left><br>
<b>Hellspawn</b> фенкс конечно, но я в этом режиме и смотрю(<b>Address with ASCII dump</b>) и только для редактирования дампа перехожу в HEX/ASCII(8bytes). Так что с определением начала у меня всё о&#039;кей.<br>Я в другом попутался,  позже сообразил,- я определил начало IAT в дампе как 006E1220 соответственно если за базу брать 00200000, то 00200000+000E1220=002E1220 ,а SergSh взял на один DWORD раньше уж не знаю из каких соображений(может туда нулей хотел понаставить 1 DWORD типа должна IAT либо с одного, либо с двух нулевых DWORD начинаться или ещё чего незнаю). Ну а я неопытный дурень не вижу что всего 4 байта отличие.<br>006E121C  D15B1781  Ѓ[С<br>006E1220  7C91188A  Љ‘|  ntdll.RtlDeleteCriticalSection<br><br><br>Но вот к тебе или другим старичкам вопрос: <b>а вообще как OllyDump эту базу выбирает(00200000) когда дамп снимает, почему например не 00330000 или не 01000000</b> там тоже вроде свободное место(если как я думаю из за того, что свободное место нужно в момент снятия).<br>Поясните пожалста физический смысл этой величины 00200000.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123030&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=2" class="addthx" data-post="123030"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2007 00:40 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#3');return false;">#3</a> </span><div align=left><br>
Млин, огромное сорри перед всеми за давнешний мой просчёт! Если кто следил за топиком с самого начала, то помнит, что у меня не шёл скрипт для восстановления IAT от SergSh, так вот причина вот в чём.<br>Я тогда ещё зеленее чем счас был и смотреть то скрипт смотрел, данные подставлять то свои об начале там и конце там и т. п. подставлял а вот догадаться проверить кол-во байт от начала функи VirtualAlloc до её  RETN не догадался и принял вбитое там 17 за данность, а вчера в похожем скрипте от этой проги, которая сейчас догадался проверил и вбил реальное 19. А вечером вчера думаю как это так волшебным образом скрипт похожий пошёл иотработал на ура. А сейчас глянул на старый, а там 17 и мне всё стало ясно. Сейчас проверю, но уже уверен. Сорри, сорри <img src="img/smilies/s15.gif" alt=""> <img src="img/smilies/s15.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123113&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=3" class="addthx" data-post="123113"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2007 12:23 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#4');return false;">#4</a> </span><div align=left><br>
Барахтался весь вечер и столько, что сейчас не опишу. По порядку.<br> <br> 1 Ну открыть в лорд-пе вчерашний дамп и впарить туда нью секшен с теми характиристиками как у Сержа не составило труда, аналогично не забыл переправить OEP под будущую новую секцию(003B628F).<br><br> 2 Прошёлся под руководством  Сержа с VOEP по процедуру(виртуальной машины) и  по необходимое место где выясняется переходник, который вместо этой процедуры будет. Соответствующий txt см. в аттаче поста<br><br> 3 Создал сам txt скрипт и поменял исходя из своих данных его переменные. Соответствующий txt см. в аттаче поста.<br><br> 4 Перегрузил в Оле исходный файл и вчерашним скриптом(с моими данными см аттач на стр4 топика) вышел к VOEP не забыл снять бряк на ней(так как писано скрипт запускать без бряков). Каспер отключен<br><br> 5 Самое интересное- попробовал запустить скрипт. 9раз полюбовался на ошибку <b>&quot;Unable to read memory of debugged process. Breakpoint at 00000000 is deleted&quot;</b> <img src="img/smilies/s10.gif" alt="">. Затем вообще на  &quot;передайте макрософт сведения об этой ошибке(см. в аттаче скрин где эта ошибка на фоне лога)После чего оля рунинг уже час причём не хило рунинг в диспетчере видно пашут два процесса процентов по 48-50 каждый оля и иконлове. Причем окно оли не виснет, всё доступно. Чо за хрень в аттаче мой вариант скрипта где начальные данные правильны(исследование их приведено в аттаче я уже писал) Единственное число которое я косвенно догадываюсь , но не уверен полностью 007B6000. И то я думаю так будущая секция которую в лорд-пе создали начинается по адресу 003B6000 ну видимо и плюс сюда нормальная база большинства файлов 00400000 и всё нормалёк.<br>С той частью про которую писано, что и без неё работать будет я ещё не разбирался, может я ошибаюсь, но вроде там ничего с моей стороны задавать не надо. <br><br><b>SergSh</b> и другие старики может на вскидку видно в чём ошибка или кто аттач не поленится и посмотрит.<br><b>Bronco</b> прога то поинтересней предыдущей(с VM) может загрузишь тоже и дашь какие нить советы! <br><br><img src="img/attach.gif" alt=""> <a href="./files/2536_19.02.2007_CRACKLAB.rU.tgz">2536_19.02.2007_CRACKLAB.rU.tgz</a> - начинаем мусолить VM.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123243&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=4" class="addthx" data-post="123243"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2007 02:58 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#5');return false;">#5</a> </span><div align=left><br>
Секцию то ты нарисовал, а физически с помощью НЕХ-редактора ты её создал?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123300&amp;user=2420&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=5" class="addthx" data-post="123300"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2007 06:33 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#6');return false;">#6</a> </span><div align=left><br>
<b>SergSh</b> на <b>Секцию то ты нарисовал, а физически с помощью НЕХ-редактора ты её создал?</b><br> для меня как для трудного обьясни что ты имел ввиду и как это делается(это тоже как то в лорд пе надо делать??? или иначе) Пока не понимаю так как в других статьях не попадалось мне этого действия - <b>&quot;физически спомощью HEX-редактора создать секцию.&quot;</b> <img src="img/smilies/s4.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123342&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=6" class="addthx" data-post="123342"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2007 08:49 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#7');return false;">#7</a> </span><div align=left><br>
На пальцах это выглядит так:<br>1. Прикрутил лордом секцию.<br>2. Открыл дамп в НЕХ редакторе.<br>3. Перешёл на конец файла.<br>4. Вставил блок нолей до конца твоей новой секции.<br>5. Сохранил всё.<br>Продолжаешь работу с дампом. А вообще почитай статьи с сайта, там это дело в картинках показано.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123374&amp;user=2420&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=7" class="addthx" data-post="123374"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]gegter[/b]','')">gegter</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 214.1 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.6'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8261">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2007 09:00 <br><script type="text/javascript">QU('gegter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=gegter" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#8');return false;">#8</a> </span><div align=left><br>
<b>SergSh</b> а не проще ли создать WinHex файло из 0000 нужного размера и прикрутить готовое Lordом...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123377&amp;user=8261&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=8" class="addthx" data-post="123377"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2007 09:12 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#9');return false;">#9</a> </span><div align=left><br>
Тоже вариант. Я думаю таких вариантов десятка полтора наберётся. Пусть он уж сам определяется как ему удобно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123379&amp;user=2420&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=9" class="addthx" data-post="123379"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2007 09:49 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#10');return false;">#10</a> </span><div align=left><br>
<b>SergSh</b>,<b>gegter</b> фенкс мужики как раз вовремя написали. Мне как раз нужно сейчас куда то девать то, что восстановилось после работы скрипта по восстановлению JMP и Call в секции 010C0000, того, что вчера не получался.<br>Млинн и опять я опростоволосился вчера. Представляете вся причина неработы была в том, что забыл отключить монитор касперыча. НЕТ этож нада бряк на VOEP не забыл снять после работы скрипта, по прохождению туда, учёл все адреса в самом скрипте по восстановлению, всё переправил как нада, ну всё и такую мелочь зеванул <img src="img/smilies/s10.gif" alt=""><br>Счас со свежей головой сел всё снова проверил не успел даже мяу сказать как <b>Восстановление call и  JMP завершено успешно.</b><br>Проверил ручками, точно адреса переходов скрипт восстановил верно!(ну я не много 3 штуки проверил всего их вчера было 39 я аттачил в папке во вчерашнем посту вызовы всех процедур в секции 010С0000)<br><br><b>gegter</b><br><b>SergSh</b> Очень важный для меня вопрос общего плана: нет у вас ссылок на какие нить туторы типа учимся писать скрипты или там проходим язык скриптов, или синтаксис языка скриптов и т.д. и т.п.<br>Я так то вижу что это типа асма(я его немного знаю и книжек пара тройка дома, но многие команды, ликсемы или как там их звать явно не из асма,- по крайней мере их нет в моих асм книгах) Я так понимаю, что писать скрипт можно только понимая все команды, а не понимая половину и половине догадываясь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123390&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=10" class="addthx" data-post="123390"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2007 09:53 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#11');return false;">#11</a> </span><div align=left><br>
к скриптам идёт ODbgScript.txt к ODBGScript или readme.txt к OllyScript
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=123391&amp;user=72&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=11" class="addthx" data-post="123391"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2007 10:15 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#12');return false;">#12</a> </span><div align=left><br>
<b>Hellspawn</b> фенкс нашёл и тот и тот редми причём к ODBGScript более внятный редми и не свален так в кучу. Хотя конечно хотелось бы чего нить нарыть на русском с примерами, но и это хорошо. Рано или поздно я и из этой кучи малы надёргаю то что может быть полезно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123396&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=12" class="addthx" data-post="123396"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2007 11:49 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#13');return false;">#13</a> </span><div align=left><br>
Млинннн! В винхексе по адресу 003B6000 висят какие то апи функи и нулей туда ставить пока в этом варианте себе дороже(это гдето до адреса 003B6300).<br>А причина стала ясна как божий день в лорде видно при добавлении секции NewSec 12кило заполненной нулями(создана в винхексе), что секция перед присоединяемой - .mackt не 00004000 как у Сержа, а 00005000. Короче секция лезет одна на другую<img src="img/smilies/s13.gif" alt=""><br>Это вот то самое что вызвало у меня недоумение когда я в импректе увидел большую длину IAT чем у Сержа см. аттач &quot;по вопросу.rar&quot;<br>От млиинннннннн<img src="img/smilies/s10.gif" alt=""> <img src="img/smilies/s10.gif" alt=""> <img src="img/smilies/s10.gif" alt=""> <img src="img/smilies/s10.gif" alt=""> <img src="img/smilies/s10.gif" alt="">!!!!!!! Завтра по новой попробую импорт восстановить, а то всё сместить и в скриптах, и в вычисленных адресах, как я понимаю не прабл, но вдруг ещё позже какой нить косяк ещё вылезет связанный с этим.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123423&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=13" class="addthx" data-post="123423"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 февраля 2007 11:34 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#14');return false;">#14</a> </span><div align=left><br>
Вот мляддьь, <img src="img/smilies/s10.gif" alt=""> никак не удаётся привести импотр к размерам <b>SergSh</b> ну и соответственно секцию с импортом к 4000(у него она в импректе на выходе 39DA у меня в районе 4400-44A5,- млять <img src="img/smilies/s10.gif" alt="">поэтому на выходе и 5000 становится(видимо он автоматически резервирует до полной тысячи шестнадцатеричной).<br>Причем млядина чем цивильней секцию вдампе делаешь тем меньше функций определяет в импректе(на несколько штук) уже попробовал отдельно и как писано Сержем 1.22 обработать и 1.23 плагами один хер размера секции 39DA не добиться.<br>Придётся все последующее менять на штуку больше и надеяться, что это никаким боком дальше не вылезет!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123545&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=14" class="addthx" data-post="123545"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2007 13:12 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#15');return false;">#15</a> </span><div align=left><br>
<b>Всем </b> в офтоп меня не нускают нужно 20 пунктов. Я знаю что счас меня вздрючат модераторы. Но не могу не поздравить всех с днём Российской армии и военно морского флота! С праздником! Все кто служил поймут меня.<br>P.S. после профсоюзного вечера пробовал ещё раз править импорт ни хера всё также под таким газомь(0,5 на рыло) править IAT не по приколу).<br>Всем сорри такой день, как отрезвею всё отработаю сполнаю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123809&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=15" class="addthx" data-post="123809"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2007 02:41 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#16');return false;">#16</a> </span><div align=left><br>
Всем привет! Продолжим. Наконец я воткнулся так, что и незнаю как правильно. В идеале было бы хорошо чтобы <b>SergSh</b> прочитал это сообщение, так как у него есть готовый файл этой версии и он может посмотреть как должно быть. Ну если кто-то из стариков присоединился к этой распаковке и даст совет буду только рад. По порядку.<br><br> 1. При своих попытках привести размер импорта к размеру <b>SergSh</b> были созданы 3 базовых файла<br>  <br> а) В точности как делал b]SergSh[/b] с скриптом до VOEP и скриптом восстановления IAT. Но не восстанавливал нули между слипшимися функами с разных библ, далее в импректе как делал он.<br><br> б) С  скриптом до VOEP и скриптом восстановления IAT, а затем полностью и очень тчательно поправил IAT после скрипта(нули между функами из разных библ, по два даблворда нулей в начале и в конце IAT, убрал 2 функции якобы из системных библ но к которым из тела проги нет ни одного вызова). В импректе как у него + прогон через все плаги по Аспру.<br><br> в) Промежуточный вариант с  скриптом до VOEP и скриптом восстановления IAT. Правил ручками только слипание разных библ. В импректе как он.<br><br>Дальнейшую работу попытался провести для чистоты с файлом <b>а)</b>. В скрипте по восст. каллов и джеемпе виртуальной машины помимо того что вы видели из аттача исправил также начало создаваемой секции с 007B6000 на 007B7000(причину я уже объяснял из за большего чем у сержа импорта 4420 вместо  39FC,-не помню точно где тотак, у меня секция импорта тянется до 003B7000  и налазит на новую если пытаться всунуть в лорд-пе по адресу как у сержа).<br>Дальше по писанному создал в хеквьюве секцию 12 кило(3000б) с нулями, зарезирвировал  в лорд-пе нью секшен на адрес 003B7000, переправил точку входа 003B728F. Впарил секцию с нулями на резервированное место. После работы скрипта по восст калл и джеемпе сделал дамп региона и через вьювер впарил его на место нулей в дамп нашей проги.<br><br><b>Внимание! Для таких, как я не забудте в хексвьювере сменить режим реад онли, а то будете довольно долго думать почему это вьвер не хочет код вставить из сдампленного региона в прогу и какого ещё хера ему надо.</b> <img src="img/smilies/s5.gif" alt=""><br><br> А вот теперь самое интересное. Грузим в олю наш дамп и падаем, но не на 00403ВВ0 как писал <b>SergSh</b> , а судя по стеку <br>00405C7A  |.  53                    PUSH EBX<br>00405C7B  |.  E8 BCB6FFFF           CALL damp_ico.0040133C<br>00405C80  |.  8945 F4               MOV [LOCAL.3],EAX     =================<b>вот здесь мы упёрлись</b><br>00405C83  |.  837D F4 00            CMP [LOCAL.3],0<br><br>Смотрим что было в оригинале<br>00405C7A    53                      PUSH EBX<br>00405C7B    E8 BCB6FFFF             CALL icolover.0040133C<br>00405C80    8945 F4                 MOV DWORD PTR SS:[EBP-C],EAX ===<b>вот так это выглядит в исходном если</b> <br>00405C83    837D F4 00              CMP DWORD PTR SS:[EBP-C],0                           <b>дойти до VOEP</b><br><br>Пробуем вбить что надо ни хрена идём по 0040133C и видим там<br>00401334   &#036;- FF25 30287B00         JMP DWORD PTR DS:[&lt;&amp;kernel32.GetModuleHandleA&gt;]  ;  kernel32.GetModuleHandleA<br>0040133A      8BC0                  MOV EAX,EAX<br>0040133C   &#036;- FF25 74126E00         JMP DWORD PTR DS:[6E1274]  -<b>---------ВОТ ЭТО МЕСТО!</b><br>00401342      8BC0                  MOV EAX,EAX<br>00401344   &#036;- FF25 38287B00         JMP DWORD PTR DS:[&lt;&amp;kernel32.GetStartupInfoA&gt;]     ;  kernel32.GetStartupInfoA<br>0040134A      8BC0                  MOV EAX,EAX<br><br>Пробуем из исходного в ручную добыть адрес(с бряками на VirtualAlloc и на секции кода, с нью оригинал хеа) нихрена вылетает . по &#036;+40 и  &#036;+2c нет адреса. Грузим базовый файл по варианту <b>б)</b>(см. выше) И видим там идилическую картину<br><br>00401334   &#036;- FF25 48287B00         JMP DWORD PTR DS:[&lt;&amp;kernel32.GetModuleHandleA&gt;]        ;  kernel32.GetModuleHandleA<br>0040133A      8BC0                  MOV EAX,EAX<br>0040133C   &#036;- FF25 4C207B00         JMP DWORD PTR DS:[&lt;&amp;kernel32.GetProcAddress&gt;] <b>-----ВОТ-</b>;  kernel32.GetProcAddress<br>00401342      8BC0                  MOV EAX,EAX<br>00401344   &#036;- FF25 50287B00         JMP DWORD PTR DS:[&lt;&amp;kernel32.GetStartupInfoA&gt;]         ;  kernel32.GetStartupInfoA<br><br>Заходим снова в наш экспериментальный дамп с восстановленными виртуальными калл и джеемпе и бьём в ручную по 0040133C<b>------------------&gt;  JMP DWORD PTR DS:[7B204C]</b> И что бы вы думали мы наконец по F9 падаем в обещанном <b>SergSh</b> 00403ВВ0 и видим, что всё там так, но <img src="img/smilies/s6.gif" alt=""> <img src="img/smilies/s6.gif" alt=""> <img src="img/smilies/s6.gif" alt=""> (это уже нервное) проходим по 0040133C и видим(я сократил листинг Оли для удобочитаемости)<br>00401334   &#036;- FF25 30287B00         JMP DWORD PTR DS:[&lt;&amp;kernel32.GetModuleHandleA&gt;]         ;  <br>0040133A      8BC0                  MOV EAX,EAX<br>0040133C   &#036;- FF25 4C207B00         JMP DWORD PTR DS:[&lt;&amp;kernel32.GetLastError&gt;]  <b>-----??????????  </b> ;    <br>00401342      8BC0                  MOV EAX,EAX<br>00401344   &#036;- FF25 38287B00         JMP DWORD PTR DS:[&lt;&amp;kernel32.GetStartupInfoA&gt;]          ;  <br>0040134A      8BC0                  MOV EAX,EAX<br><b>ПРИ ЧЁМ ЗДЕСЬ ntdll.RtlGetLastWin32Error КОГДА [7B204C] - &amp;kernel32.GetProcAddress и как такое может быть чтоб по одному адресу определялось 2 функции</b> Затевать целое исследование по этому поводу неохота поэтому<b>SergSh</b> скажи что там у тебя по этому адресу. Ну может<b>Hellspawn</b> или кто другой знает в чём дело?<br><br>Зы касперыч во всех случаях отключен был и ничего подозрительного(скрипты работают).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124021&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=16" class="addthx" data-post="124021"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2007 02:51 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#17');return false;">#17</a> </span><div align=left><br>
Причём, заметьте все три базовых файла делались в одних условиях в один вечер. Без касперыча.<br><b>Что за шутки???????????????????????????????????????????</b> <img src="img/smilies/s15.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124022&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=17" class="addthx" data-post="124022"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2007 05:07 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#18');return false;">#18</a> </span><div align=left><br>
Не скорее всего kernel32.GetProcAddress. Потому как сейчас прицепил секцию к базовому файлу по варианту <b>б)</b> (см. выше) мало того, что сразу всё падает там где показывал маэстро(SergSh)  так ещё и строки, что выше самого вызова процедуры смотрятся куда как более органично(т.е. готовят параметры для передаче функции):<br>00405C75  |.  68 E45D4000     PUSH damp2_ic.00405DE4     ; /ProcNameOrOrdinal = &quot;GetLongPathNameA&quot;<br>00405C7A  |.  53                      PUSH EBX                                ; |hModule<br>00405C7B  |.  E8 BCB6FFFF      CALL &lt;JMP.&amp;kernel32.GetProcAddress&gt;      ; GetProcAddress<br>00405C80  |.  8945 F4             MOV [LOCAL.3],EAX<br>00405C83  |.  837D F4 00        CMP [LOCAL.3],0<br>00405C87  |.  74 2C                 JE SHORT damp2_ic.00405CB5<br><br>Если сейчас ещё и Серж подтвердит, то напрашивается вывод: <b>Крайне желательно, если не сказать обязательно, нужно после работы скрипта поправить всю IAT ручками от всяческих слипаний, не доверяя это импректу, после чего потерпеть и подождать работу всех плагинов импректа по восстановлению аспротектовых фокусов с функциями.</b> Видимо всё таки один из плагинов каким то неведомым мне способом определил таки GetProcAddress, так как в IAT ни до ни после скрипта нет намека на её адрес. А ручным методом вроде не определяется.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124039&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=18" class="addthx" data-post="124039"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 февраля 2007 12:58 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#19');return false;">#19</a> </span><div align=left><br>
Млинн! SergSh cбрось пожалуйста  хоть в виде txt-шки что у тебя получилось после расшифровки скриптом в 2х криптованных секций начиная с адреса 007B1000 по 007B2000 Плииз, да просто плииизище!!!!!!!!!!!!!!!!!<br>Я мягко говоря уже зае..ся в попытке отладить Call EAX. <img src="img/smilies/s14.gif" alt=""> <img src="img/smilies/s15.gif" alt=""> <img src="img/smilies/s14.gif" alt=""> <img src="img/smilies/s15.gif" alt=""> <img src="img/smilies/s14.gif" alt=""> <img src="img/smilies/s15.gif" alt=""> <br>А выглядело это так:<br> 1 как учил Серж меняем количество сработок по адресу 006В64Е8 на 0B01, меняем по адресу 006В6910 на адрес нашей первой восстановленной таблицы 00107B00<br> 2 Сначала пытался как серж поставить 2 бряка, потом как пишет <b>Лучше всего установить F2 на адрес 00403ВАЕ и нажимая F9 следить за счётчиком в ЕВХ</b>. Однако видя вылеты не там стал по бряку до ходить до 00403ВАЕ Call EAX а уж затем по F7. Далее привожу, что  я записал в txt -типа дневника<br><br> ПОСЛЕ ЧЕГО НА КАЛЛЕ EAX Я УХОЖУ В ТАБЛИЦУ ПО 007B1000 ДОХОЖУ ДО 007B100F И УЛЕТАЮ СЮДА<br>пускает по Shift+F7,F8,F9<br>7C90EAF0    8B1C24                  MOV EBX,DWORD PTR SS:[ESP]<br>7C90EAF3    51                      PUSH ECX<br>7C90EAF4    53                      PUSH EBX<br>7C90EAF5    E8 C78C0200             CALL ntdll.7C9377C1 ---------------ПОСЛЕ ЧЕГО ПО F8 СРАЗУ ПРЁТ ОШИБКА МАЙКРОСОФТА,<br>ПОСЛЕ ЧЕГО ПО SHIFT+F8 ПИШЕТ НЕИЗВЕСТНЫЙ ШАГ ПО 010C0675<br><br>Добавлю ниже как выглядит с 007B1000 по 007B100F когда иду по F7<br>007B1000    24 73                   AND AL,73<br>007B1002    40                        INC EAX<br>007B1003    00C0                    ADD AL,AL<br>007B1005    70 40                   JO SHORT damp2_ic.007B1047<br>007B1007    0050 85               ADD BYTE PTR DS:[EAX-7B],DL<br>007B100A    40                        INC EAX<br>007B100B    0050 82               ADD BYTE PTR DS:[EAX-7E],DL<br>007B100E    40                        INC EAX<br>007B100F    0004EF                ADD BYTE PTR DS:[EDI+EBP*8],AL<b>------ВОТ отсюда и летим</b><br>007B1012    40                        INC EAX<br>007B1013    00B8 4E4200B4   ADD BYTE PTR DS:[EAX+B400424E],BH<br>007B1019    EF                        OUT DX,EAX                                                    ; I/O command<br>007B101A    40                        INC EAX<br>Причём в стеке ничего интересного (<b>падаем вообще не там где по статье надо</b>) Вот весь стек<br><br>0012FF88   00403BB0  RETURN to damp2_ic.00403BB0<br>0012FF8C   0012FFB4  Pointer to next SEH record<br>0012FF90   00403BBE  SE handler<br>0012FF94   0012FFA4<br>0012FF98   7C910738  ntdll.7C910738<br>0012FF9C   FFFFFFFF<br>0012FFA0   7FFDE000<br>0012FFA4   0012FFC0<br>0012FFA8   007B7ECB  damp2_ic.007B7ECB<br>0012FFAC   007B7FB4  damp2_ic.007B7FB4<br>0012FFB0   007B7822  damp2_ic.007B7822<br>0012FFB4   0012FFE0  Pointer to next SEH record<br>0012FFB8   00403A34  SE handler<br>0012FFBC   0012FFC0<br>0012FFC0   0012FFF0<br>0012FFC4   7C816D4F  RETURN to kernel32.7C816D4F<br>0012FFC8   7C910738  ntdll.7C910738<br>0012FFCC   FFFFFFFF<br>0012FFD0   7FFDE000<br>0012FFD4   805522FA<br>0012FFD8   0012FFC8<br>0012FFDC   8647C7A0<br>0012FFE0   FFFFFFFF  End of SEH chain<br>0012FFE4   7C8399F3  SE handler<br>0012FFE8   7C816D58  kernel32.7C816D58<br>0012FFEC   00000000<br>0012FFF0   00000000<br>0012FFF4   00000000<br>0012FFF8   007B728F  OFFSET damp2_ic.&lt;ModuleEntryPoint&gt;<br>0012FFFC   00000000<br><br><b>Всем</b> может кто подербанит прогу из опытных за компанию, сверить бы таблицу 1-ю расшифрованную скриптом, где тож есть ошибка или глюк скрипта, оли, или винды моей. <br><br>В аттаче папка со скриптом в моих условиях , изучение данных для скрипта с моими адресами, и тхт-шник где я пытался преодолеть проблемму.<br><br><b>Млинн, хелп, помогите,</b> ну хоть табличку расшифрованную 1-ю кто нибудь.<img src="img/smilies/s14.gif" alt=""> <img src="img/smilies/s14.gif" alt=""> <img src="img/smilies/s14.gif" alt=""> <img src="img/smilies/s14.gif" alt=""> <img src="img/smilies/s14.gif" alt=""><br><br><b>Таким как я</b> промежуток между предыдущим постом и этим опишу, когда разберусь в чём дело здесь.<br><br><br><br><br><br><img src="img/attach.gif" alt=""> <a href="./files/5087_25.02.2007_CRACKLAB.rU.tgz">5087_25.02.2007_CRACKLAB.rU.tgz</a> - начинаем мучать криптованные куски.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124338&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=19" class="addthx" data-post="124338"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 февраля 2007 17:54 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#20');return false;">#20</a> </span><div align=left><br>
Вот _http://www.mytempdir.com/1231952. Но была проблема с одной подменённой функцией, не помню исправил или нет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124351&amp;user=2420&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=20" class="addthx" data-post="124351"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 февраля 2007 11:27 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#21');return false;">#21</a> </span><div align=left><br>
<b>SergSh</b> Респектище, небеса и сообщество обучающихся распаковке Аспра тебя не забудет никогда!<img src="img/smilies/s1.gif" alt=""> Долго был на работе, поэтому только сел и скачал его файл.<br><br> 1 На основе анализа файла <b>SergSh</b> установлен точный ответ на вопрос <b>ПРИ ЧЁМ ЗДЕСЬ ntdll.RtlGetLastWin32Error КОГДА [7B204C] - &amp;kernel32.GetProcAddress и как такое может быть чтоб по одному адресу определялось 2 функции?</b> Не может быть и нет там действительно <br><br> 0040133C &#036;- FF25 4C207B00 JMP DWORD PTR DS:[&lt;&amp;kernel32.GetProcAddress&gt;] <br>видимо баг оли(или что ещё скорее импректа) при восстановлении импорта.<br><br> 2 Опять же на основе просмотра его файла установлено, что по крайней мере начало первой восстановленной таблицы каллов EAX правильно(вот например сверка от 007B1000 до 007B1018)<br><br>007B1000  00407324  &#036;s@.  damp2_ic.00407324 [МОЁ] 007B1000  00407324  &#036;s@.  icolover.00407324[Его] +<br>007B1004  004070C0  Аp@.  damp2_ic.004070C0 ====007B1004  004070C0  Аp@.  icolover.004070C0====+<br>007B1008  00408550  P…@.  damp2_ic.00408550 ====007B1008  00408550  P…@.  icolover.00408550====+<br>007B100C  00408250  P‚@.  damp2_ic.00408250  ====007B100C  00408250  P‚@.  icolover.00408250  ====+<br>007B1010  0040EF04  п@.  damp2_ic.0040EF04   ====007B1010  0040EF04  п@.  icolover.0040EF04    ====+<br>007B1014  00424EB8  ёNB.  damp2_ic.00424EB8 ====007B1014  00424EB8  ёNB.  icolover.00424EB8   ====+<br>007B1018  0040EFB4  ґп@.  damp2_ic.0040EFB4 ====007B1018  0040EFB4  ґп@.  icolover.0040EFB4   ====+<br><br>Отсюда следует, что рыть надо по прохождению(ибо таблица верна) что то не так интерпретирует эти адреса.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124493&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=21" class="addthx" data-post="124493"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 февраля 2007 11:32 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#22');return false;">#22</a> </span><div align=left><br>
Млин, сорри всем  за такую кучу малу(в окне ввода всё было красиво). ЧТож такое несоответствие между окном ввода и выводом на сайте? <img src="img/smilies/s13.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124494&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=22" class="addthx" data-post="124494"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 февраля 2007 12:04 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#23');return false;">#23</a> </span><div align=left><br>
Всем привет! Времени всё меньше становится даже не поковыряешь.  Респект ещё раз <b>SergSh</b> за предоставленный файл. Удалось всё быстро проверить. Была и невнимательность и небольшой сюрприз. Привожу свою запись из типа девника:<br><br>Точно не так, мало того, что я по невнимательности вбил адрес начала раскриптованной таблицы не по адресу <br><b>006B64EC  007B1000  .{.  damp2_ic.007B1000 - как надо </b>а по адресу<br>(оттуда первоначально была ссылка на 006В6910)<br><b>006В6910  007B1000  .{.  damp2_ic.007B1000 - так не надо.</b><br><br>Дак ещё пронаблюдал одну очень интересную весч(так и не пойму, кто баги даёт)<br>Вот строка в которой адресуется EAX в моём дампе(на втором круге работы цикла калла EAX) <br><b>00403BA0   &gt; /8B04DF                MOV EAX,DWORD PTR DS:[EDI+EBX*8]      ;  damp2_ic.00408550</b><br>а вот как должно быть(у SergSh)<br><b>00403BA0   &gt; /8B049F                MOV EAX,DWORD PTR DS:[EDI+EBX*4]      ;  icolover.004070C0</b><br>Таким образом видим, что даже если я задаю адрес правильно прога у меня прыгает через одну ссылку по адресу.<br>Могу поклясться что никогда в жизни не трогал этой строки. Всё перечисленное исправляем, сохраняем изменения в нашем дампе и наконец-то видим как всё заработало <img src="img/smilies/s1.gif" alt=""> <br>После 12h кругов по Call EAX(с бряком на 00403BAE по F9) наконец плюхаемся по обещанному Сержем 0040A763. Как и советует Серж заходим по F7 в процедуру 0040A75E и видим там вызов куска мяса иначе это не назовёшь из 01130000. Всё от туда сдампил регионом(пе-тулсом)  и в WINHEX-се вставил в наш дамп по 007B1880 (благо всего 9С нужно ). Всё, завтра поищу остальные 5 мест прыжков в небо обещанных Сержем.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124848&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=23" class="addthx" data-post="124848"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 марта 2007 11:52 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#24');return false;">#24</a> </span><div align=left><br>
Всем привет! Привожу в аттаче все шесть мест &quot;прыжков в неизвестность&quot;. Не думаю, что у кого то их поиск вызовет трудности, но всё же. Лишь два из шести вызвали интерес,- один тем, что его по началу из-за слепленного кода не было видно, другой почему-то без retn в конце. <b>Итак первый</b>(я имею ввиду из интересных):<br><br>0040A012     /31906800              DD damp2_ic.00689031<br>0040A016     |00                    DB 00<br>0040A017     |14                    DB 14<br>0040A018     |01                    DB 01<br>0040A019   . |C3                    RETN    ===== А вот так запутанно выглядит место вызова на 01140000 или<br><br>0040A014   ?  68 00001401           PUSH 1140000<br>0040A019   .  C3                    RETN    ====этот кусок в оригинале длиной 7Bh в нашем дампе поместил его по 003B1920<br><br>после изменения и сохранения выглядит так:<br>0040A013      90                    NOP<br>0040A014  /&#036;  68 20197B00           PUSH damp2_ic.007B1920<br>0040A019  .  C3                    RETN<br><br><b>Второй</b><br><br>0040A028   &#036;- E9 D35FD400     JMP 01150000  ---<b>Вот как без ретурна?</b> В оригинале кусок длиной 91h<br>0040A02D      BE 3229C147           MOV ESI,47C12932<br>в своём дампе я поместил его по 003B19A0 и рискнул добавить retn, получилось-<br><br>0040A028    - E9 73793A00           JMP damp2_ic.007B19A0<br>0040A02D      C3                    RETN<br><br>После чего Все каллы EAX действительно пройдены и у нас то место о котором говорил Серж(где выясняется, что в скрипте нужно изменять флаги) выглядит так:<br><br>007B7EB9    84C0                    TEST AL,AL<br>007B7EBB  ^ E9 D9FEFFFF             JMP damp2_ic.007B7D99  ------------<b>сюда он обращает внимание</b><br>007B7EC0  ^ 0F85 99FFFFFF           JNZ damp2_ic.007B7E5F<br>007B7EC6    E9 82020000             JMP damp2_ic.007B814D<br>007B7ECB    C3                      RETN<br><br>Всё спать хочу, как медведь бороться, продолжу завтра. <img src="img/smilies/s1.gif" alt=""><br><br><img src="img/attach.gif" alt=""> <a href="./files/c07d_01.03.2007_CRACKLAB.rU.tgz">c07d_01.03.2007_CRACKLAB.rU.tgz</a> - находим прыжки в неизвестность.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124999&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=24" class="addthx" data-post="124999"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2007 13:35 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#25');return false;">#25</a> </span><div align=left><br>
Всем привет! Сегодня важный, думаю переломный день в расковыривании аспра подопытной проги! <img src="img/smilies/s6.gif" alt=""><br>Удалось окончательно поправить JMP и Call-ы в секции VM (у меня это секция 010С0000), применив последнее по статье дополнение SergSh к скрипту по их восстановлению.<br><br> 1 Проверил как всё это (я имею ввиду флаги влияет на изменения в переходах). Очень подробно смотрите в аттаче(Разбираемся со сменой флагов2.txt) соответствующую часть дневника.<br> <br> 2 Между делом пока ходил по оригиналу туда и сюда манипулируя, как Серж с бряками и флагами, высмотрел все необходимые адреса для последнего куска скрипта.<br><br> 3 Видоизменил адреса, добавил небольшие коментарии и поставил кусок в нужное место скрипта по восстановлению каллов и джеемпе.(см. в аттаче сам скрипт).<br><br> 4 После работы скрипта обнаружилось, что из секции 010С0000 он не восстановил 5 JMP(см. в аттаче сравнение под названием Список всех вызовов процедур в секции 010С0000 после работы скрипта.txt)<br><br>Приведу здесь эти пять сравнительных строк:<br>010C0FBA   CALL 011C0000=====отличие 10C0FBA-10C0000+7B7000=7B7FBA<br>010C1659   CALL 011C0000=====отличие 10C1659-10C0000+7B7000=7B8659<br>010C1B14   CALL 011C0000=====отличие 10C1B14-10C0000+7B7000=7B8B14<br>010C1B40   CALL 011C0000=====отличие 10C1B40-10C0000+7B7000=7B8B40<br>010C1B4A   CALL 011C0000=====отличие 10C1B4A-10C0000+7B7000=7B8B4A<br>После этого видя, что именно по этим адресам дамп падает и что все они лежат задолго до Call EAX, который у нас давно и успешно был пройден в неисправленном дампе, просто взял и по вычисленным адресам надергал нужные адреса из неисправленного(в смысле снеучтёнными изменениями флагов) дампа используя две загруженные ОЛи. Про то, что  предварительно я пересохранил винхексом эту исправленную секцию в дамп после работы скрипта- это само собой.<br><br> Итог радует <img src="img/smilies/s1.gif" alt=""> при дальнейшей трассировке мы падаем как указывал маэстро по<br><br>0040405F   ------------- CMP CL,BYTE PTR DS:[EDX]<br><br>Чо то мне нехорошо, глазки повылазили, наверно на сёдня хватит. <img src="img/smilies/s5.gif" alt=""><br><br><br><br><img src="img/attach.gif" alt=""> <a href="./files/5027_02.03.2007_CRACKLAB.rU.tgz">5027_02.03.2007_CRACKLAB.rU.tgz</a> - окончательно исправляем Call-ы и JMP.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=125169&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=25" class="addthx" data-post="125169"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2007 10:34 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#26');return false;">#26</a> </span><div align=left><br>
Всем привет! Наконец могу торжественно написать, что мне удалось распаковать IconLover v3.0( под версией ASPra-2.13, да и ещё видимо со всеми прелестями и наворотами присущими этой версии ASPra, написана на Delphi 5 судя по DIE, так как у PEID она не имеет вида после распаковки). <br><br>Отдельный респект <b>Hellspawn</b> так как DIE работает, а PEID почемуто нет,- то что это делфи нет сомнения её бы EMS Source Rescuer не открывал, ну и SergSh в статье писал.<br><br> Прога теперь полностью рабоча и открывается, и закрывается, и не виснет! <img src="img/smilies/s3.gif" alt=""> <img src="img/smilies/s12.gif" alt=""> Что интересно, у SergSh распакованный файл оказался немного покрупнее (3,73метра против моих 3,72)<br>Особую радость у меня вызывает то, что китайцем мне не удалось получить работоспособный дамп, а ручками да(ну может я ещё неумею как следует пользоваться китайцем). Ну оставлю восторги. К делу.<br><br>Как всегда цепляю дневник произведённых действий в виде аттача. Были особенности:<br><br> 1Не паникуйте при трассировке сначала вылазит окно с триальными днями и только после него найдёте место где происходит первая проверка<br>006B5FBC  /&#036;  55 ---------------- PUSH EBP<br>Всего же, по крайней мере у меня так, можно поставив как советует Серж бряк на 0046636C по F9 пройти и исправить только 2 проверки(прога запустится), остальные 2 ищем через бинарный поиск(я предпочёл всё исправить, да и Серж об этом пишет).<br><br> 2Прога и так будет завершаться(не как у Сержа), но я сделал нормальный экзитпроцесс как Серж. А вот просто отследить куда падает при закрытии не удастся, адрес другой, так что идём сразу по адресу<br> 007B736C    FFD5                    CALL EBP<br>007B736E  - E9 EDA9FFFF             JMP damp2_ic.007B1D60  ------------вот делаем наш адрес ссылки на эксит<br>а там адрес в IAT( у меня в IAT kernel32.ExitProcess была)<br><br>Теперь вопрос общего характера. Меня волнует устойчивость полученного дампа в разных системах, так полученный от Сержа файл у меня не запускается(хотя он видимо тоже судя по адресам изготовлен в XP может, правда c SP1). Я конечно со временем проверю на разных машинах, но у нас на работе у всех XP SP2.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=125295&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=26" class="addthx" data-post="125295"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2007 02:30 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#27');return false;">#27</a> </span><div align=left><br>
В принципе работает... но что-то сдесь не так...<br>Например иконки на панели инструментов перепутаны
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=125400&amp;user=6946&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=27" class="addthx" data-post="125400"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2007 07:08 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#28');return false;">#28</a> </span><div align=left><br>
<b>Isaev</b> фенкс за то что посмотрел. Слушай, а какие перепутаны местами? У меня всё о&#039;кей вроде, изображения соответствуют назначению. Единственное, что я заметил вчера и с чего немного стал подозревать так это то, что на триальном окне кнопки ок и регистрация периодически меняются местами.<br>Больше никто не пробовал, а то у него то  XP SP2(в личке писал), а то пока я найду машину с 2000 или 98 виндой ещё времени пройдёт(на работе тоже только XP)?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=125460&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=28" class="addthx" data-post="125460"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2007 07:54 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#29');return false;">#29</a> </span><div align=left><br>
Da woobsche wse... screen w attache<br>izobrazhenija odni, a hinty wsplywajut sowsem s drugim smyslom...<br><br><img src="img/attach.gif" alt=""> <a href="./files/fd43_04.03.2007_CRACKLAB.rU.tgz">fd43_04.03.2007_CRACKLAB.rU.tgz</a> - quatsch.JPG
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=125465&amp;user=6946&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=29" class="addthx" data-post="125465"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2007 09:51 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#30');return false;">#30</a> </span><div align=left><br>
Странно у меня, всё вроде нормально! <br><b>Кто нить из стариков сталкивался с этим раньше, из-за чего это может быть?</b> При распаковке что ли часть адресов в проге привязывается к системе, к конкретному билду, дак не понятно, прога бы просто не работала. Она ж у него работает.<br><br>Да ещё <b>Isaev</b>, вопрос, ты мой файл файл врубал в папке с его родной версией 3.0, которую Серж в своё время давал или проинсталил последнюю 4.12, которая сейчас на сайте висит?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=125480&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=30" class="addthx" data-post="125480"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2007 10:42 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=4#31');return false;">#31</a> </span><div align=left><br>
Da ja woobsche nichego ne instalil... <img src="img/smilies/s1.gif" alt=""> zapustil... poschlo...<br>Sorry... mozgi tut wsem ebu<br>nawerno iz-za etogo.<br>Scha poprobuju 3.0 postawit&#039;
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=125487&amp;user=6946&amp;forum_n=3&amp;topic=7466&amp;page=4&amp;anchor=31" class="addthx" data-post="125487"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=3.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=3.html">4</a> . <b>5</b> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=7.html">8</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=11.html">12</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=12.html">13</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=5.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка AsProtect на примерах</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="3">
<input type="hidden" name="topic" value="7466">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=7466" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
