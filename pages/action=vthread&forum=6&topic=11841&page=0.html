<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Криптор на ассемблере - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте. Я новичек в программировании на ассемблере. Тем не менее пробую написать на нем простейший криптор. Моя программа шифрует по xor первую секцию и создет дополнительную секцию в конце файла. Проблема заключается в">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a>, <a target='_blank' href='?action=userinfo&amp;user=50833'>vasilevradislav</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Криптор на ассемблере</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Mol4un[/b]','')">Mol4un</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.17'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=16588">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2008 18:05 <br><script type="text/javascript">QU('Mol4un','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mol4un" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте. Я новичек в программировании на ассемблере.  Тем не менее пробую написать на нем простейший криптор. Моя программа шифрует по xor первую секцию и создет дополнительную секцию в конце файла. Проблема заключается в следующем: не придумал ничего лучше как брать код расшифровщика из самой программы в процессе выполнения, этот код копируется в последнюю секцию и меняется Entry Point. Но вот передать ей точные значения зашифрованной секции не могу (т.е. вместо [esi].oe_phys_size надо подставить конкретное значение):<br><br>            push ecx<br>	push ebx<br>	push edx<br>	<br>	mov ecx, [esi].oe_phys_size<br>	mov ebx, [esi].oe_phys_offs<br>	add ebx, [ebp-3*4]			<br>	sub ecx, 1h<br>_xor2:<br>	mov edx, dword ptr [ecx+ebx]		<br>	xor edx, 77h<br>	mov [ecx+ebx], edx<br>	loop _xor2<br><br>	pop edx<br>	pop ebx<br>	pop ecx<br><br>Правильно ли я делаю, или это можно сделать по-другому? И как лучше подставить значения секции? (компилятор TASM5Plus)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=188352&amp;user=16588&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=1" class="addthx" data-post="188352"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]El_Diablo[/b]','')">El_Diablo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 59.9 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.17'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2008 18:12 &middot; Поправил: El_Diablo <br><script type="text/javascript">QU('El_Diablo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=El_Diablo" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>Но вот передать ей точные значения зашифрованной секции не могу (т.е. вместо [esi].oe_phys_size надо подставить конкретное значение): </I><br>Вызывай GetModuleHandle(0), а дальше работай с полученным значение или считай ImageBase из PEB<br>А дальше доходи до первой секции и расшифровывай ее =)))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=188354&amp;user=11468&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=2" class="addthx" data-post="188354"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Mol4un[/b]','')">Mol4un</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.17'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=16588">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2008 18:32 <br><script type="text/javascript">QU('Mol4un','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mol4un" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Можно по подробнее? Сами значения у меня уже есть- [esi].oe_phys_size,... и т.д. я просто не могу их записать. Ты предлагаешь вызывать GetModuleHandle уже из закриптованного exe-файла?. Но тогда мне придеться редактировать директорию импорта и добавлять эту API? Не будет ли проблем с антивирусами?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=188358&amp;user=16588&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=3" class="addthx" data-post="188358"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]El_Diablo[/b]','')">El_Diablo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 59.9 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.17'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2008 18:37 &middot; Поправил: El_Diablo <br><script type="text/javascript">QU('El_Diablo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=El_Diablo" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>Но тогда мне придеться редактировать директорию импорта и добавлять эту API?</I><br>считай в секции твоего криптора значение ImageBase из PEB и дальше используй для своих нужд(собственно GeyModuleHandle(0) оттуда и считывает значение.<br>7C80B54C    64:A1 18000000  MOV EAX,DWORD PTR FS:[18]<br>7C80B552    8B40 30                MOV EAX,DWORD PTR DS:[EAX+30]<br>7C80B555    8B40 08                MOV EAX,DWORD PTR DS:[EAX+8]
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=188359&amp;user=11468&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=4" class="addthx" data-post="188359"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Mol4un[/b]','')">Mol4un</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.17'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=16588">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2008 19:04 <br><script type="text/javascript">QU('Mol4un','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mol4un" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Спасибо! Несовсем ясно, но по крайне мере понял в каком направлении копать дальше.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=188362&amp;user=16588&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=5" class="addthx" data-post="188362"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]El_Diablo[/b]','')">El_Diablo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 59.9 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.17'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2008 19:19 <br><script type="text/javascript">QU('El_Diablo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=El_Diablo" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
www.wasm.ru/article.php?article=packers2<br>почитай для начала дальше уже смотри исходники крипторов и пакеров =)))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=188363&amp;user=11468&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=6" class="addthx" data-post="188363"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]GlOFF[/b]','')">GlOFF</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 51.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.32'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10603">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 мая 2008 22:58 <br><script type="text/javascript">QU('GlOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GlOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>Mol4un</b> Посмотри крипт Morphine там есть интерфейс машинных опкодов, очень удобно и без компилятора обходиться будешь <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=188478&amp;user=10603&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=7" class="addthx" data-post="188478"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]trouble[/b]','')">trouble</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.26'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=16183">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 мая 2008 16:26 <br><script type="text/javascript">QU('trouble','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=trouble" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Читай.<br><br><img src="img/attach.gif" alt=""> <a href="./files/3b87_19.05.2008_CRACKLAB.rU.tgz">3b87_19.05.2008_CRACKLAB.rU.tgz</a> - own.packer.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=189400&amp;user=16183&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=8" class="addthx" data-post="189400"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 мая 2008 20:56 &middot; Поправил: Crawler <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Не могу не пропиарить свою статью, сорри ))))<br>Вот - все просто и понятно об инлайн-декодере =)))<br><br>www.xakep.ru/magazine/xa/104/068/1.asp
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=189448&amp;user=4825&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=9" class="addthx" data-post="189448"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 мая 2008 21:33 &middot; Поправил: Flint <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
вот, примерно так накидал код декриптора для всего файла, для начала естественно необходимо разрешить запись.<br><br>004041DF    MOV EDX,DWORD PTR DS:[EDI+14]            ; кидаем edx сохраненный  и полученный заранее ImageBase = 400000<br>004041E2    ADD EDX,3C ; переходим к PE<br>004041E5    MOV EDX,DWORD PTR DS:[EDX]; переходим к PE<br>004041E7    ADD EDX,DWORD PTR DS:[EDI+14]       ; переходим к PE<br>004041EA    XOR ESI,ESI<br>004041EC    MOV SI,WORD PTR DS:[EDX+6]             ; узнаем кол-во секций, т.к в последней секции наш стаб<br>004041F0    DEC SI    ; то уменьшаем кол-во секций на единицу                                                   <br>004041F2    MOV EBX,EDX<br>004041F4    ADD EBX,0F8    ; переходим к описанию первой секции<br>004041FA    MOV EBP,DWORD PTR DS:[EBX+C] ; узнаем VirtualAddress = 1000<br>004041FD    ADD EBP,DWORD PTR DS:[EDI+14] ; добавляем ImageBase<br>00404200    XOR ECX,ECX<br>00404202    MOV ECX,DWORD PTR DS:[EBX+8] ;узнаем VirtualSize<br>00404205    MOV AL,BYTE PTR DS:[ECX+EBP] ; копируем  последний  байт ксореного кода в AL<br>00404208    XOR AL,35 ; ксорим<br>0040420A    MOV BYTE PTR DS:[ECX+EBP],AL ; ложим на место<br>0040420D    LOOPD SHORT 00404205              ; мотаем цикл пока еще есть байты<br>0040420F    XOR BYTE PTR DS:[EBP],35      ; ксорим последний байт в секции<br>00404214    DEC ESI ; уменьшаем кол-во секций<br>00404215    CMP ESI,0 ; не последня?<br>00404218    JE SHORT 0040421F ; если была последняя выходим из цикла<br>0040421A    ADD EBX,28 ; иначе переходим к описанию сл. секции <br>0040421D    JMP SHORT 004041FA <br><br>тут чето с ксором я намудрил на скорую руку <img src="img/smilies/s1.gif" alt="">, но вроде робит,<br>естественно после всех этих манипуляций необходимо будет разобраться и загрузить таблицу импорта, восстановить стэк и прыгнуть на OEP
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=189456&amp;user=2981&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=10" class="addthx" data-post="189456"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Mol4un[/b]','')">Mol4un</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.17'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=16588">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 мая 2008 22:35 &middot; Поправил: Mol4un <br><script type="text/javascript">QU('Mol4un','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mol4un" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Всем спасибо за ответы!! Криптор я почти дописал)).<br><br>Заинтересовала TIB и TEB структуры, а также регистр FS. Не могли бы поделиться  ссылками где можно почерпнуть о них более подробную информацию?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=189473&amp;user=16588&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=11" class="addthx" data-post="189473"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 мая 2008 22:45 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
--&gt; Об упаковщиках в последний раз. Часть вторая &lt;-- http://wasm.ru/article.php?article=packers2
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=189475&amp;user=2981&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=12" class="addthx" data-post="189475"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]El_Diablo[/b]','')">El_Diablo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 59.9 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.17'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 мая 2008 23:30 <br><script type="text/javascript">QU('El_Diablo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=El_Diablo" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>Не могу не пропиарить свою статью, сорри )))) </I><br>чет код у тя в статье неоч<br>не проще ли было проще ли было процедуру декрипта реализовать через инструкции lodsd и stosd ?<br><I>Это необходимо для совершенствования умственных способностей. Тренируйся, выдумывай себе головоломки и скоро ты постигнешь искусство работы с форматом PE без инструментов.</I><br>А хрен ты че постигнешь, читая подобные статьи =<br>Курите доки по PE форматы и все будет ок.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=189483&amp;user=11468&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=13" class="addthx" data-post="189483"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Mol4un[/b]','')">Mol4un</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.17'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=16588">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 мая 2008 23:49 &middot; Поправил: Mol4un <br><script type="text/javascript">QU('Mol4un','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mol4un" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Васм я уже перечитывал. Но вот что за fs такой таинственный, для чего он нужен, где он находится физически, откуда он взялся и почему он вдруг указывает на TEB так и не понял!..... может я упустил какой-то ключевой момент???
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=189490&amp;user=16588&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=14" class="addthx" data-post="189490"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]DrFits[/b]','')">DrFits</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 200.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 мая 2008 02:15 <br><script type="text/javascript">QU('DrFits','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DrFits" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Ну если ты ещё пишешь такой код (просто сразу в глаза бросается)<br><code>xor edx, 77h</code><br>то посоветую, просто принять на вооружение, что FS:[0] указывает на TEB, и пока не лезть в дебри <img src="img/smilies/s1.gif" alt=""><br><br><I>Crawler пишет:<br>Не могу не пропиарить свою статью, сорри ))))<br>Вот - все просто и понятно об инлайн-декодере =))) </I> - ну, Вы даёте, разве это статья? Вот об упаковщиках в последний раз - это статья. А так - будут в программе FixUp-элементы и крипт в секции кода - просто загибается, давайте не будим дурить голову тем, кто хочет разобраться сам. ;)
<br><br><font size="1"><i>-----<br>Само плывет в pуки только то, что не тонет.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=189512&amp;user=411&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=15" class="addthx" data-post="189512"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 мая 2008 16:32 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>El_Diablo пишет:<br>не проще ли было проще ли было процедуру декрипта реализовать через инструкции lodsd и stosd ?  </I><br><br>Я уже на форуме писал, почему всё сделано именно так. Ибо загружать статью для новичков объяснением смысла инструкций - неправильно. Цель у статьи была другая. Хотя тут речь и о другом, сорри за флэйм
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=190101&amp;user=4825&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=16" class="addthx" data-post="190101"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]trouble[/b]','')">trouble</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.26'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=16183">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2008 10:13 <br><script type="text/javascript">QU('trouble','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=trouble" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>Mol4un</b><br>Если хочешь, можно в крипторе использовать полиморфный движок. Если что, ы личку или тут.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190172&amp;user=16183&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=17" class="addthx" data-post="190172"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]GlOFF[/b]','')">GlOFF</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 51.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.32'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10603">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2008 14:58 <br><script type="text/javascript">QU('GlOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GlOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Ага в morphine можешь поглядеть на реализацию интерфейса к полидвижку, ну и мусорные вставки, щас не эфективны, но все же...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190201&amp;user=10603&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=18" class="addthx" data-post="190201"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]SLV[/b]','')">SLV</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 309.8 (мудрец), 21thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.69'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=663">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2008 17:27 <br><script type="text/javascript">QU('SLV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SLV" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
&gt; ну и мусорные вставки, щас не эфективны, но все же...<br>это почему ещё)
<br><br><font size="1"><i>-----<br>Shalom ebanats!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=190218&amp;user=663&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=19" class="addthx" data-post="190218"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]trouble[/b]','')">trouble</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.26'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=16183">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2008 02:01 <br><script type="text/javascript">QU('trouble','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=trouble" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>GlOFF</b><br> кто это тебе сказал что хлам в программе не эфективен?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190284&amp;user=16183&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=20" class="addthx" data-post="190284"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]DaRKSiDE[/b]','')">DaRKSiDE</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1989.png" alt=""><br><span class=txtSm>Ранг: 462.8 (мудрец), 468thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1989">Участник</a><br><font color=blue>Only One!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2008 07:25 <br><script type="text/javascript">QU('DaRKSiDE','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DaRKSiDE" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>Mol4un</b><br><br>_http://wasm.ru/pub/6/files/VirGan.zip<br><br>Посмотри лучше это...
<br><br><font size="1"><i>-----<br>aLL rIGHTS rEVERSED!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=190289&amp;user=1989&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=21" class="addthx" data-post="190289"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]trouble[/b]','')">trouble</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.26'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=16183">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 июня 2008 14:54 <br><script type="text/javascript">QU('trouble','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=trouble" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Ты уже криптор сделал? Если да, скинь на мыло.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=190990&amp;user=16183&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=22" class="addthx" data-post="190990"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Mol4un[/b]','')">Mol4un</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.17'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=16588">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июня 2008 21:34 &middot; Поправил: Mol4un <br><script type="text/javascript">QU('Mol4un','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mol4un" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Криптор по видимому ещё очень далек от завершения. По нектороым причинам решил продолжить эксперименты с написанием криптора на MASM32. Написал как посоветовали. Но вот столкнулся с одной проблемой:<br>Программа копирует код расшифровщика из самой себя, управление на который никогда не передается:<br>           <br>            <code> mov eax,dword ptr fs:[18h]<br>	mov eax,dword ptr ds:[eax+30h]<br>	mov eax,dword ptr ds:[eax+8]		<br>	mov ebx,eax			<br>	add eax,dword ptr ds:[eax+3ch]	<br>	add eax,248d			<br>	mov ecx,dword ptr ds:[eax+10h]	<br>	add ebx,dword ptr ds:[eax+0ch]	<br>	sub ecx,4h<br>_xor2:<br>	mov edx, dword ptr [ecx+ebx]		<br>	xor edx,ecx<br>	not edx<br>	xor edx, 77777777h<br>	<br>	mov [ecx+ebx],edx<br>	loop _xor2<br>	jmp ebx</code><br><br>tasm такой код проглотил, а вот MASM32 ругается на регистр FS:<br>error A2108: use of register assumed to ERROR. <br>Подскажите пожалуйста в чем может быть проблема?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191505&amp;user=16588&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=23" class="addthx" data-post="191505"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]El_Diablo[/b]','')">El_Diablo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 59.9 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.17'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июня 2008 21:40 &middot; Поправил: El_Diablo <br><script type="text/javascript">QU('El_Diablo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=El_Diablo" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>а вот MASM32 ругается на регистр FS:<br>error A2108: use of register assumed to ERROR. </I><br>assume fs:nothing<br>Ты код декриптора добавляешь в файл как отдельную секцию?<br>Если да, то где ты сохраняешь OEP?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191507&amp;user=11468&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=24" class="addthx" data-post="191507"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Mol4un[/b]','')">Mol4un</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.17'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=16588">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июня 2008 23:13 &middot; Поправил: Mol4un <br><script type="text/javascript">QU('Mol4un','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mol4un" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
Спасибо!<br>Да, я создаю свою секцию. С OEP у меня пока тоже проблемы. Я допускаю что OEP указывает на начало первой секции. Может подскажете как его можно передать в криптуемый exe-файл?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191515&amp;user=16588&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=25" class="addthx" data-post="191515"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]El_Diablo[/b]','')">El_Diablo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 59.9 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.17'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2008 01:10 &middot; Поправил: El_Diablo <br><script type="text/javascript">QU('El_Diablo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=El_Diablo" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11841.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>Я допускаю что OEP указывает на начало первой секции.Может подскажете как его можно передать в криптуемый exe-файл?</I><br>оверлей или сохраняй в секции декриптора как константу.<br>Еще при создании отдельной секции надо учитывать:<br>1. секция должна быть выровнена<br>2. должен быть увеличен размер образа =)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=191523&amp;user=11468&amp;forum_n=6&amp;topic=11841.html&amp;page=0&amp;anchor=26" class="addthx" data-post="191523"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Криптор на ассемблере</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#27" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="11841">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=11841" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
