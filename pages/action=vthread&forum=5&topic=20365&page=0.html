<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Исследование D3DGear - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем привет Захотел я вот пропатчить его, нашел где вылезает наг, исправил и все вроде бы должно быть хорошо. Программа запускается и работает, а вот снимать она ничего не хочет, никак не пойму в чем загвоздка  --&gt; Оф сайт">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=41144'>Adler</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+9 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Исследование D3DGear</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Flasher-11[/b]','')">Flasher-11</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.2 (новичок), 9thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.95'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32610">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2012 23:29 &middot; Поправил: Flasher-11 <br><script type="text/javascript">QU('Flasher-11','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flasher-11" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20365.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Всем привет <img src="img/smilies/s1.gif" alt=""><br>Захотел я вот пропатчить его, нашел где вылезает наг, исправил и все вроде бы должно быть хорошо. Программа запускается и работает, а вот снимать она ничего не хочет, никак не пойму в чем загвоздка <img src="img/smilies/s4.gif" alt=""><br><br><noindex><a href="http://www.d3dgear.com/" rel="nofollow" target="_blank">--&gt; Оф сайт &lt;--</a></noindex><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004057FF</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">44B18C</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00405804</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>EAX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; /Arg2 =&gt; 00000000</span></li><li class="hl_l0"><span class="hl_number">00405805</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">44B188</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |</span></li><li class="hl_l1"><span class="hl_number">0040580B</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>ECX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |Arg1 =&gt; 00000000</span></li><li class="hl_l0"><span class="hl_number">0040580C</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">00414B90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; \d3dGear.00414B90</span></li><li class="hl_l1"><span class="hl_number">00405811</span>&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">8</span></li><li class="hl_l0"><span class="hl_number">00405814</span>&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00405816</span>&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">0040585D</span></li><li class="hl_l0"><span class="hl_number">00405818</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">0043D124</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; /Arg5 = 0043D124 ASCII &quot;D3DGear expired!&quot;</span></li><li class="hl_l1"><span class="hl_number">0040581D</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0BB</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |Arg4 = 000000BB</span></li><li class="hl_l0"><span class="hl_number">00405822</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">0043D184</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |Arg3 = 0043D184 ASCII &quot;.\d3dGearExe.cpp&quot;</span></li><li class="hl_l1"><span class="hl_number">00405827</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">3</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |Arg2 = 00000003</span></li><li class="hl_l0"><span class="hl_number">00405829</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">0044ADF0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |Arg1 = 0044ADF0</span></li><li class="hl_l1"><span class="hl_number">0040582E</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">00401D30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; \d3dGear.00401D30</span></li><li class="hl_l0"><span class="hl_number">00405833</span>&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">14</span></li><li class="hl_l1"><span class="hl_number">00405836</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">00413940</span></li>        </ol>
    </div>
</div></div>
<br><br>На <b>00405816</b> просто сделал прыжок и все вроде бы чудесно. Пробовал еще возвращать значение 0 в EAX, но все так же, работать она работает, а не снимает<img src="img/smilies/s4.gif" alt=""> Где могут быть подводные камни?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=312114&amp;user=32610&amp;forum_n=5&amp;topic=20365.html&amp;page=0&amp;anchor=1" class="addthx" data-post="312114"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]schokk_m4ks1k[/b]','')">schokk_m4ks1k</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 31.0 (посетитель), 70thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.43'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=31322">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2012 23:55 <br><script type="text/javascript">QU('schokk_m4ks1k','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=schokk_m4ks1k" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20365.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
значит где то еще проверка стоит! выйди из этой процедуры и там посмотри условия)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=312117&amp;user=31322&amp;forum_n=5&amp;topic=20365.html&amp;page=0&amp;anchor=2" class="addthx" data-post="312117"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]TryAga1n[/b]','')">TryAga1n</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 262.5 (наставник), 337thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.45'>Активность: 0.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=31275">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 сентября 2012 00:01 &middot; Поправил: TryAga1n <br><script type="text/javascript">QU('TryAga1n','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TryAga1n" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20365.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Не знаю что значит &quot;снимать&quot; в контексте данной софтины, видимо какие-то данные сохранять...<br><br>Может быть банальная проверка контрольной суммы секции кода. Чтобы узнать, так ли єто, попробуй поменять какой-нибудь не критичный байт(Например ноп или 0 между функциями). Либо может быть проверка целостности определенных функций. Система в принципе так же. Ну и еще что пришло в голову - мемори брейкпоинт на чтение секции кода, а там уже смотреть кто-что-куда-зачем...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=312119&amp;user=31275&amp;forum_n=5&amp;topic=20365.html&amp;page=0&amp;anchor=3" class="addthx" data-post="312119"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Flasher-11[/b]','')">Flasher-11</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.2 (новичок), 9thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.95'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32610">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 сентября 2012 00:11 <br><script type="text/javascript">QU('Flasher-11','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flasher-11" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20365.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Нашел<img src="img/smilies/s3.gif" alt="">! Видосы снимает, вопрос исчерпан<img src="img/smilies/s1.gif" alt=""> Всем спасибо!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=312121&amp;user=32610&amp;forum_n=5&amp;topic=20365.html&amp;page=0&amp;anchor=4" class="addthx" data-post="312121"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 сентября 2012 07:14 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20365.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
ну хоть выкладывали бы решение и логику рассуждения, всяко полезнее.
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=312130&amp;user=72&amp;forum_n=5&amp;topic=20365.html&amp;page=0&amp;anchor=5" class="addthx" data-post="312130"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Flasher-11[/b]','')">Flasher-11</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.2 (новичок), 9thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.95'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32610">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 сентября 2012 14:56 &middot; Поправил: Flasher-11 <br><script type="text/javascript">QU('Flasher-11','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flasher-11" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20365.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Исправляюсь, пишу где и что нашел <img src="img/smilies/s1.gif" alt=""><br>Как я уже писал выше, идет проверка на триальность и вызывается наг окошко.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004057FF</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">44B18C</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00405804</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>EAX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; /Arg2 =&gt; 00000000</span></li><li class="hl_l0"><span class="hl_number">00405805</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">44B188</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |</span></li><li class="hl_l1"><span class="hl_number">0040580B</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>ECX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |Arg1 =&gt; 00000000</span></li><li class="hl_l0"><span class="hl_number">0040580C</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">00414B90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; \d3dGear.00414B90</span></li><li class="hl_l1"><span class="hl_number">00405811</span>&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">8</span></li><li class="hl_l0"><span class="hl_number">00405814</span>&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00405816</span>&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">0040585D</span></li><li class="hl_l0"><span class="hl_number">00405818</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">0043D124</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; /Arg5 = 0043D124 ASCII &quot;D3DGear expired!&quot;</span></li><li class="hl_l1"><span class="hl_number">0040581D</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0BB</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |Arg4 = 000000BB</span></li><li class="hl_l0"><span class="hl_number">00405822</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">0043D184</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |Arg3 = 0043D184 ASCII &quot;.\d3dGearExe.cpp&quot;</span></li><li class="hl_l1"><span class="hl_number">00405827</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">3</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |Arg2 = 00000003</span></li><li class="hl_l0"><span class="hl_number">00405829</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">0044ADF0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |Arg1 = 0044ADF0</span></li><li class="hl_l1"><span class="hl_number">0040582E</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">00401D30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; \d3dGear.00401D30</span></li><li class="hl_l0"><span class="hl_number">00405833</span>&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">14</span></li><li class="hl_l1"><span class="hl_number">00405836</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">00413940</span></li>        </ol>
    </div>
</div></div>
<br><br>Можно поправить <b>00405816</b> на <b>JMP SHORT d3dGear.0040585D</b> и мы пролетаем наг окно и программа успешно запускается. По моему мнению можно сделать красивше, поместить 0 в EAX. Если 0, то мы пролетаем и запускаемся, если 1 то наг окно. Проверка происходит где-то здесь <b>0040580C  CALL d3dGear.00414B90 </b>. Входим и трассируем пока не натыкаемся на <b>00414930 PUSH EPB</b> в конце процедуры будет помещение 1 в EAX.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00414A6C</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_char">&lt;</span><span class="hl_char">&amp;</span>ADVAPI32<span class="hl_char">.</span>RegCloseKe<span class="hl_char">&gt;</span><span class="hl_comment">; \RegCloseKey</span></li><li class="hl_l1"><span class="hl_number">00414A72</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">00414A77</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span>C<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00414A7A</span>&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_registr">EBP</span></li><li class="hl_l0"><span class="hl_number">00414A7C</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">00423BF7</span></li><li class="hl_l1"><span class="hl_number">00414A81</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_registr">EBP</span></li><li class="hl_l0"><span class="hl_number">00414A83</span>&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EBP</span></li><li class="hl_l1"><span class="hl_number">00414A84</span>&nbsp;&nbsp;<span class="hl_function">RETN</span></li>        </ol>
    </div>
</div></div>
<br><br>Соответственно исправляем <b>00414A72  MOV EAX,1</b> на <b>00414A72  MOV EAX,0 </b>и трассируем дальше. На <b>00414A84</b>  премещаемся вот сюда<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00414BEB</span>&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">8</span></li><li class="hl_l1"><span class="hl_number">00414BEE</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">00414BF3</span>&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">00414BF7</span></li><li class="hl_l1"><span class="hl_number">00414BF5</span>&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">00414BF7</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_registr">EBP</span></li><li class="hl_l1"><span class="hl_number">00414BF9</span>&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EBP</span></li><li class="hl_l0"><span class="hl_number">00414BFA</span>&nbsp;&nbsp;<span class="hl_function">RETN</span></li>        </ol>
    </div>
</div></div>
<br><br>Тут также помещаем 0. Ну вот, наг окно убрано, идем дальше. Программа запускается, но не выполняет свой функционал. Далее при трассировке можно увидеть различные сообщения. По пути вроде бы ничего путного нет, но в самом конце есть создание Mutex&#039;a и именного из-за него не работает весь функционал.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00405A74</span>&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00405A76</span>&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">00405A8E</span></li><li class="hl_l0"><span class="hl_number">00405A78</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;d3dGear<span class="hl_char">.</span><span class="hl_number">0043D53C</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span>MutexName&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;{71971309-2B5E-4782-A72C-BFFD6C645341}&quot;</span></li><li class="hl_l1"><span class="hl_number">00405A7D</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">1</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |InitialOwner = TRUE</span></li><li class="hl_l0"><span class="hl_number">00405A7F</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |pSecurity = NULL</span></li><li class="hl_l1"><span class="hl_number">00405A81</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_char">&lt;</span><span class="hl_char">&amp;</span>KERNEL32<span class="hl_char">.</span>CreateMutexA<span class="hl_char">&gt;</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; \CreateMutexA</span></li>        </ol>
    </div>
</div></div>
<br>Просто поменял логику с <b>00405A76  JE SHORT d3dGear.00405A8E</b> на <b>JNZ SHORT d3dGear.00405A8E</b><br>Ну вот в принципе и все, программа запускается и функционал работает <img src="img/smilies/s1.gif" alt=""><br>Теперь думаю можно закрывать тему <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=312163&amp;user=32610&amp;forum_n=5&amp;topic=20365.html&amp;page=0&amp;anchor=6" class="addthx" data-post="312163"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=2470" title="28-09-2012 11:02, ранг:400.3" target="_blank">KingSise</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Исследование D3DGear</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=20365" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
