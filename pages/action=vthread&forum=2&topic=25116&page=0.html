<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>DoSWF Анпак. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброго времени суток. Столкнулся тут с такой вот штукой на флеше, называется DoSWF... Суть проблемы в кратце: Есть Encrypted SWF файл, который не открывается ни одним из дизасемблеров SWF/ActionScript. Нужно как то его">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=247'>NIKOLA</a>, <a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> DoSWF Анпак.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Fenrisus[/b]','')">Fenrisus</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2018 04:07 &middot; Поправил: Fenrisus <br><script type="text/javascript">QU('Fenrisus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Fenrisus" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25116.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброго времени суток. Столкнулся тут с такой вот штукой на флеше, называется DoSWF... <br><b>Суть проблемы в кратце:</b> Есть Encrypted SWF файл, который не открывается ни одним из дизасемблеров SWF/ActionScript. Нужно как то его декриптнуть, что бы читался.<br><br>Пробовал его анпакнуть ипользуя этот код (взято с гитхаба):<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>import</b></span>&nbsp;java<span class="hl_char">.</span>io<span class="hl_char">.</span>File<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>import</b></span>&nbsp;java<span class="hl_char">.</span>io<span class="hl_char">.</span>FileInputStream<span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>import</b></span>&nbsp;java<span class="hl_char">.</span>io<span class="hl_char">.</span>FileOutputStream<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>import</b></span>&nbsp;java<span class="hl_char">.</span>io<span class="hl_char">.</span>IOException<span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>import</b></span>&nbsp;java<span class="hl_char">.</span>io<span class="hl_char">.</span>InputStream<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>import</b></span>&nbsp;java<span class="hl_char">.</span>io<span class="hl_char">.</span>OutputStream<span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>import</b></span>&nbsp;java<span class="hl_char">.</span>nio<span class="hl_char">.</span>ByteBuffer<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>import</b></span>&nbsp;java<span class="hl_char">.</span>nio<span class="hl_char">.</span>ByteOrder<span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>import</b></span>&nbsp;java<span class="hl_char">.</span>util<span class="hl_char">.</span>zip<span class="hl_char">.</span>DataFormatException<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>import</b></span>&nbsp;java<span class="hl_char">.</span>util<span class="hl_char">.</span>zip<span class="hl_char">.</span>Inflater<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_char">*</span></li><li class="hl_l0">&nbsp;<span class="hl_char">*</span>&nbsp;Unpack&nbsp;DoSWF&nbsp;encrypted&nbsp;Flash&nbsp;<span class="hl_char">-</span>&nbsp;Useful&nbsp;for&nbsp;hacking&nbsp;dovogame&nbsp;<span class="hl_comment">;-)</span></li><li class="hl_l1">&nbsp;<span class="hl_char">*</span>&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_char">*</span>&nbsp;@author&nbsp;instcode</li><li class="hl_l1">&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span></li><li class="hl_l0"><span class="hl_function"><b>public</b></span>&nbsp;class&nbsp;DoSWFUnpacker&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_char">*</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>&nbsp;@param&nbsp;args</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>public</b></span>&nbsp;static&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;main<span class="hl_char">(</span>String<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;args<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DoSWFUnpacker&nbsp;decrypter&nbsp;</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;DoSWFUnpacker<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>try</b></span>&nbsp;{</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;inputFile&nbsp;</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;File<span class="hl_char">(</span>args<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputStream&nbsp;inputStream&nbsp;</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;FileInputStream<span class="hl_char">(</span>inputFile<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteBuffer&nbsp;buffer&nbsp;</span><span class="hl_char">=</span>&nbsp;ByteBuffer<span class="hl_char">.</span>allocate<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">int</span><span class="hl_char">)</span>&nbsp;inputFile<span class="hl_char">.</span>length<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inputStream</span><span class="hl_char">.</span>read<span class="hl_char">(</span>buffer<span class="hl_char">.</span>array<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decrypter</span><span class="hl_char">.</span>handle<span class="hl_char">(</span>buffer<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;File<span class="hl_char">(</span><span class="hl_quote">&quot;./output.swf&quot;</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="hl_function"><b>catch</b></span>&nbsp;<span class="hl_char">(</span>IOException&nbsp;e<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e</span><span class="hl_char">.</span>printStackTrace<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_char">*</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>&nbsp;Decompress&nbsp;CWS&nbsp;to&nbsp;FWS</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>&nbsp;CWS&nbsp;<span class="hl_char">(</span>compressed&nbsp;SWF<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>&nbsp;FWS&nbsp;<span class="hl_char">(</span>uncompressed&nbsp;SWF<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>&nbsp;@param&nbsp;<span class="hl_function">data</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>public</b></span>&nbsp;static&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;decompress<span class="hl_char">(</span><span class="hl_function">byte</span><span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;<span class="hl_function">data</span><span class="hl_char">,</span>&nbsp;File&nbsp;outputFile<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">byte</span><span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;output&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;<span class="hl_function">byte</span><span class="hl_char">[</span><span class="hl_function">data</span><span class="hl_char">.</span>length&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_number">10</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;size&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>try</b></span>&nbsp;{</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Inflater&nbsp;decompresser&nbsp;</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;Inflater<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;signature&nbsp;</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;String<span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">3</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>signature<span class="hl_char">.</span>equals<span class="hl_char">(</span><span class="hl_quote">&quot;CWS&quot;</span><span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decompresser</span><span class="hl_char">.</span>setInput<span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">data</span><span class="hl_char">.</span>length&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size&nbsp;</span><span class="hl_char">=</span>&nbsp;decompresser<span class="hl_char">.</span>inflate<span class="hl_char">(</span>output<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decompresser</span><span class="hl_char">.</span><span class="hl_function">end</span><span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OutputStream&nbsp;</span><span class="hl_function"><b>out</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;FileOutputStream<span class="hl_char">(</span>outputFile<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">out</span><span class="hl_char">.</span>write<span class="hl_char">(</span><span class="hl_function"><b>new</b></span>&nbsp;<span class="hl_function">byte</span><span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;{&nbsp;<span class="hl_quote">'F'</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">'W'</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">'S'</span>&nbsp;}<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">out</span><span class="hl_char">.</span>write<span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">3</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">5</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">out</span><span class="hl_char">.</span>write<span class="hl_char">(</span>output<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;size<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">out</span><span class="hl_char">.</span>close<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="hl_function"><b>catch</b></span>&nbsp;<span class="hl_char">(</span>DataFormatException&nbsp;e<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e</span><span class="hl_char">.</span>printStackTrace<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="hl_function"><b>catch</b></span>&nbsp;<span class="hl_char">(</span>IOException&nbsp;e<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e</span><span class="hl_char">.</span>printStackTrace<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>public</b></span>&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;unpack<span class="hl_char">(</span>ByteBuffer&nbsp;buffer<span class="hl_char">,</span>&nbsp;File&nbsp;outputFile<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteBuffer&nbsp;plain&nbsp;<span class="hl_char">=</span>&nbsp;decrypt<span class="hl_char">(</span>buffer<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handle<span class="hl_char">(</span>plain<span class="hl_char">,</span>&nbsp;outputFile<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;handle<span class="hl_char">(</span>ByteBuffer&nbsp;buffer<span class="hl_char">,</span>&nbsp;File&nbsp;outputFile<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;nonce&nbsp;<span class="hl_char">=</span>&nbsp;buffer<span class="hl_char">.</span>get<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>nonce&nbsp;<span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span>&nbsp;{</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;removeNonce</span><span class="hl_char">(</span>buffer<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;bool&nbsp;<span class="hl_char">=</span>&nbsp;buffer<span class="hl_char">.</span>get<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;size&nbsp;<span class="hl_char">=</span>&nbsp;buffer<span class="hl_char">.</span>getInt<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">byte</span><span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;head&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;<span class="hl_function">byte</span><span class="hl_char">[</span>size<span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer<span class="hl_char">.</span>get<span class="hl_char">(</span>head<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;size<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">byte</span><span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;tail&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;<span class="hl_function">byte</span><span class="hl_char">[</span>buffer<span class="hl_char">.</span>remaining<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer<span class="hl_char">.</span>get<span class="hl_char">(</span>tail<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">byte</span><span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;<span class="hl_function"><b>data</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;bool&nbsp;<span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_char">?</span>&nbsp;head&nbsp;<span class="hl_char">:</span>&nbsp;tail<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decompress<span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">,</span>&nbsp;outputFile<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;ByteBuffer&nbsp;removeNonce<span class="hl_char">(</span>ByteBuffer&nbsp;buffer<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;max&nbsp;<span class="hl_char">=</span>&nbsp;buffer<span class="hl_char">.</span>getInt<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;mark&nbsp;<span class="hl_char">=</span>&nbsp;buffer<span class="hl_char">.</span>getInt<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;length&nbsp;<span class="hl_char">=</span>&nbsp;buffer<span class="hl_char">.</span>getInt<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteBuffer&nbsp;<span class="hl_function"><b>data</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;ByteBuffer<span class="hl_char">.</span>allocate<span class="hl_char">(</span>length<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">data</span><span class="hl_char">.</span>order<span class="hl_char">(</span>ByteOrder<span class="hl_char">.</span>LITTLE_ENDIAN<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer<span class="hl_char">.</span>get<span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">.</span>array<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;length<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteBuffer&nbsp;output&nbsp;<span class="hl_char">=</span>&nbsp;ByteBuffer<span class="hl_char">.</span>allocate<span class="hl_char">(</span>max&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>output<span class="hl_char">.</span>position<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">&lt;</span>&nbsp;max<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">data</span><span class="hl_char">.</span>position<span class="hl_char">(</span><span class="hl_number">4</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">data</span><span class="hl_char">.</span>putInt<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">int</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span>mark&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_char">/</span>&nbsp;<span class="hl_number">4</span>&nbsp;<span class="hl_char">+</span>&nbsp;Math<span class="hl_char">.</span>random<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">*</span>&nbsp;mark&nbsp;<span class="hl_char">/</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output</span><span class="hl_char">.</span>put<span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">.</span>array<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;output<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;ByteBuffer&nbsp;decrypt<span class="hl_char">(</span>ByteBuffer&nbsp;buffer<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;block_size&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">byte</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span>buffer<span class="hl_char">.</span>get<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;key&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">byte</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span>buffer<span class="hl_char">.</span>get<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">3</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;buffer<span class="hl_char">.</span>getInt<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;length&nbsp;<span class="hl_char">=</span>&nbsp;buffer<span class="hl_char">.</span>getInt<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">2</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">byte</span><span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;<span class="hl_function"><b>data</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;<span class="hl_function">byte</span><span class="hl_char">[</span>length<span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer<span class="hl_char">.</span>position<span class="hl_char">(</span>buffer<span class="hl_char">.</span>limit<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;length<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer<span class="hl_char">.</span>get<span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;count&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; count &lt; length;) {</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;</span><span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; i &lt; block_size; i += 4) {</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">data</span><span class="hl_char">[</span>count<span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">byte</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">[</span>count<span class="hl_char">]</span>&nbsp;^&nbsp;key<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">+</span><span class="hl_char">+</span>count<span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>count&nbsp;<span class="hl_char">&gt;</span><span class="hl_char">=</span>&nbsp;length<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>break</b></span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;</span><span class="hl_char">=</span>&nbsp;count&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_function"><b>offset</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteBuffer&nbsp;output&nbsp;<span class="hl_char">=</span>&nbsp;ByteBuffer<span class="hl_char">.</span>allocate<span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">.</span>length&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_number">5</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>try</b></span>&nbsp;{</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Inflater&nbsp;decompresser&nbsp;</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;Inflater<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decompresser</span><span class="hl_char">.</span>setInput<span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">data</span><span class="hl_char">.</span>length<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>int</b></span>&nbsp;size&nbsp;<span class="hl_char">=</span>&nbsp;decompresser<span class="hl_char">.</span>inflate<span class="hl_char">(</span>output<span class="hl_char">.</span>array<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output</span><span class="hl_char">.</span>limit<span class="hl_char">(</span>size<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output</span><span class="hl_char">.</span>position<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decompresser</span><span class="hl_char">.</span><span class="hl_function">end</span><span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="hl_function"><b>catch</b></span>&nbsp;<span class="hl_char">(</span>DataFormatException&nbsp;e<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e</span><span class="hl_char">.</span>printStackTrace<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;output<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br>Раньше работало, сейчас уже нет... <br><br><b>Суть проблемы более подробно:</b><br>Все эти скрипты (а их всего то было две штуки) 2009 года... <img src="img/smilies/s4.gif" alt=""> Пробовал RABCDAsm&#039;ом, в лоб... Может не умею готовить, но это же бинарная шляпа... даже нет дизасм кода.... -_-&#039;&#039; Да в принципе и не будет. DoSWF работает как то так: запихивает одно в другое, и делает бинарной шляпой. Другой SWF аки лоадер имеет закриптованную функцию (а учитывая то что это китайский криптор, поди разбери...) которая собстно в памяти и собирает уже нормальный swf из бинарной шляпы.  Ну или как то похоже. Как это работает сейчас - без понятия. Ибо самому свежему мануалю как оно работает уже 6 лет... <br><br><br><noindex><a href="https://mega.nz/#!yU5ihRKZ!N_s3o4ADpbLqOj9SZLp5afOspT-Qclx-kFWosXU8h1I" rel="nofollow" target="_blank">Это лоадер</a></noindex><br><noindex><a href="https://mega.nz/#!TQYy3RgD!Nc8C11q2HHpQDS3xel0ZdO4eXR372W6IK5qXMigVUeo" rel="nofollow" target="_blank">Сам Файлик</a></noindex> который нужно разобрать.<br><noindex><a href="https://mega.nz/#!aJxmWSra!TwiFRtuJ2m2ilUAzjgmWnpsMy5dT48DTcKUgVSGeu4I" rel="nofollow" target="_blank">Еще файл 0.о</a></noindex> Да так и называется, загружается вместе с GL.swf (подсмотренно через консоль лисы)<br><br>По идее, GL.swf цепляет этот 0.0 файл и с помощью него анпакает 30005.swf(программу)... Но вот как оно это делает я увы не понял. Тыкал JPEX&#039;ом GL.swf но так и не понял как мне анпакнуть 30005.swf что бы он открывался JPEX&#039;ом или любой другой подобной утилитой. (а так - они не открываются, там ни хедера ничего нет, просто бинарная шляпа внутри и все).<br><br>Покажите и научите если не сложно. <img src="img/smilies/s1.gif" alt=""> Я бы и сам, как говорится методом тыка, проб и ошибок... да только нигде нет информации, примеров, мануалов о том как анпакать DoSWF, а та что была - уже сильно устарела... <img src="img/smilies/s4.gif" alt=""> Мне бы на примере этого файла (30005.swf) кто показал, как чего к чему... понимаю что прошу много, время - штука ценная. Я был бы благодарен за любую помощь - Скрипт-пример анпака с комментами, псевдокод с описанием алгоритма анпака, а может быть небольшой туториал/пример как это сделать через RABCDAsm?  Главное, это что бы этот encrypted файл можно было читать JPEX и другими утилитами для декомпиляции SWF файлов (Windows).<br><br><b>UPD:</b><br><noindex><a href="https://pastebin.com/AUjadGs3" rel="nofollow" target="_blank">GL.SWF декомпиль</a></noindex><br>Из этого кода ясно что это именно DoSWF (@doswf__u) Но вот как анпакнуть зашифрованные файлы...<br><br><br>PS. Знаю что возможно эта темка должна быть в обсуждениях протекторов... Но DoSWF (может я и ошибаюсь) это не протектор а encrypt tool. Вообщем у него различий с любыми пакер-протекторами больше чем сходств (насколько вообще применимо понятие протектора для Flash&#039;а), потому и написал сюда. Просьба не винить если если это не так.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=383029&amp;user=25149&amp;forum_n=2&amp;topic=25116.html&amp;page=0&amp;anchor=1" class="addthx" data-post="383029"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Rio[/b]','')">Rio</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.5 (постоянный), 36thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.56'>Активность: 0.08<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=8605">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2018 04:21 &middot; Поправил: Rio <br><script type="text/javascript">QU('Rio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rio" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25116.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
пробовали?:<br><noindex><a href="https://www.google.ru/search?newwindow=1&amp;ei=gaC5Wv2KLcufsgG5_r6oDw&amp;q=doswf+unpacker&amp;oq=DoSWF+unpack&amp;gs_l=psy-ab.3.0.0j0i22i10i30k1.11917.19867.0.24387.7.7.0.0.0.0.136.456.6j1.7.0....0...1.1.64.psy-ab..0.7.456...0i30k1j0i10i30k1.0.GMUSkI_N_mU" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=383030&amp;user=8605&amp;forum_n=2&amp;topic=25116.html&amp;page=0&amp;anchor=2" class="addthx" data-post="383030"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Fenrisus[/b]','')">Fenrisus</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2018 04:25 &middot; Поправил: Fenrisus <br><script type="text/javascript">QU('Fenrisus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Fenrisus" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25116.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>Rio пишет:<br>пробовали?:<br>--&gt; Link &lt;-- </I><br>Абсолютно ВСЕ из перечисленного. Ничего не работает. Самое новое (а скорее всего это просто репосты старой информации) 2012 года...<img src="img/smilies/s4.gif" alt=""><br><br>Скрипт с гитхаба - выше. Я его и пробовал. Ошибки буфферов. <br>Скрипт который на С++ invalid header. Тоже не работает. <br>Swf Reader (был такой), скачан с sourceforge - он его даже не может загрузить. <br>JPEX - не имеет анпакеров каких либо вообще.<br>Softonic - Не может загрузить.<br>Еще пара старых утилит (от которых нет исходников) - либо не могут загрузить этот файл в принципе, либо сыплются с exeption&#039;ами.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=383031&amp;user=25149&amp;forum_n=2&amp;topic=25116.html&amp;page=0&amp;anchor=3" class="addthx" data-post="383031"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2018 08:44 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25116.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18041&amp;page=9
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=383032&amp;user=2585&amp;forum_n=2&amp;topic=25116.html&amp;page=0&amp;anchor=4" class="addthx" data-post="383032"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=4773" title="27-03-2018 05:47, ранг:302.0" target="_blank">plutos</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]4kusNick[/b]','')">4kusNick</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1931.jpg" alt=""><br><span class=txtSm>Ранг: 748.2 <font color=magenta>(<b>! !</b>)</font>, 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.1'>Активность: 0.37<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1931">Участник</a><br><font color=blue>bytecode!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2018 10:31 <br><script type="text/javascript">QU('4kusNick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=4kusNick" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25116.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Ещё это почитайте:<br><noindex><a href="http://blog.codestage.ru/ru/2013/05/06/decrypting-doswf/" rel="nofollow" target="_blank">http://blog.codestage.ru/ru/2013/05/06/decrypting-doswf/</a></noindex>
<br><br><font size="1"><i>-----<br>Флэш, ява, дотнет - на завтрак, обед и ужин. Unity3D на закуску.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=383033&amp;user=1931&amp;forum_n=2&amp;topic=25116.html&amp;page=0&amp;anchor=5" class="addthx" data-post="383033"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=2585" title="27-03-2018 09:57, ранг:1058.8" target="_blank">Gideon Vi</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Fenrisus[/b]','')">Fenrisus</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2018 18:17 &middot; Поправил: Fenrisus <br><script type="text/javascript">QU('Fenrisus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Fenrisus" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25116.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Почитал, посмотрел. По ссылке на exelab, такой вот небольшой отчет для примера:<br><br>SWF iD - малоюзабельно, а то что это doSWF - и так понятно.<br>Action Script Viewer (ASV) -  <noindex><a href="http://www.doswf.org/doswf-swfencrypt/" rel="nofollow" target="_blank">На оффсайте doSWF </a></noindex> есть anti-hack proof, для версии 5.5, программа крашится.<br><br>Читал еще вот это<noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=16182" rel="nofollow" target="_blank"> на форуме</a></noindex><br>Но увы, метод энкрипта у них поменялся явно.<br><br>проблема собственно говоря вот в чем. :<br><img src="https://i.imgur.com/BckcY3f.png" border="0" align="" alt=""><br>Это лоадер(ы). А вот файлы, которые и являются собственно самим приложением (они не грузятся в плагине и являют собой просто бинарную дрянь): <br><img src="https://i.imgur.com/U7ORFyx.png" border="0" align="" alt=""><br>лежат как бы отдельно. И они не зашиты в лоадер (как в предыдущих версиях doSWF).<br>Лоадеров тут аж 3 штуки(???)<br>И каждый со своим кодом:<br><br><img src="https://i.imgur.com/pvfK0vF.png" border="0" align="" alt=""><br><br>Собственно:<br><noindex><a href="https://pastebin.com/34RVEsz8" rel="nofollow" target="_blank"> GL_back.swf</a></noindex> декомпиль<br><noindex><a href="https://pastebin.com/wbZWMpPV" rel="nofollow" target="_blank">GL_back1.swf </a></noindex> декомпиль<br><br>На данный момент, я использую простой код, и дампаю SWF через PID процесса, а именно указав плагин контейнер огнелисы. Как говорится &quot;в ручную&quot;<br>Код можно посмотреть<noindex><a href="https://pastebin.com/Jz7sJ6wJ" rel="nofollow" target="_blank">--&gt; Вот тут &lt;--</a></noindex><br><br>Файлы весьма себе читабельные, и что удивительно не шибко и обфусцированные (на уровне обычного декомпиля с _loc_ и прочими param43).<br><br>Но есть один фатальный недостаток такого метода, что дампая так, да ты получаешь анпакнутые swf, но при этом, какой из них какой - не понятно. Единственный метод, это дампнуть таким образом их все (а их там <br><img src="https://i.imgur.com/n625af0.png" border="0" align="" alt=""><br>и потом рученьками пересобрать целый проект в идее, попутно фикся декомпиль? Ну такое себе...<br><br>Я вот пытаюсь как то так - найти способ анпакнуть эти файлы не тыря их из памяти (с оригинальными именами)<br>через RABCdasm я отломаю doSWF лодыри хукнув туда обычный лоадер, что бы работали обычные swf, а не бинарная шляпа с лоадером.<br><br>Есть идеи как распаковать их <b>не</b> тыря их из памяти (в обход лоадера)?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=383036&amp;user=25149&amp;forum_n=2&amp;topic=25116.html&amp;page=0&amp;anchor=6" class="addthx" data-post="383036"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]4kusNick[/b]','')">4kusNick</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1931.jpg" alt=""><br><span class=txtSm>Ранг: 748.2 <font color=magenta>(<b>! !</b>)</font>, 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.1'>Активность: 0.37<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1931">Участник</a><br><font color=blue>bytecode!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2018 23:07 &middot; Поправил: 4kusNick <br><script type="text/javascript">QU('4kusNick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=4kusNick" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25116.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>Fenrisus пишет:<br>Action Script Viewer (ASV) - На оффсайте doSWF есть anti-hack proof, для версии 5.5, программа крашится. </I><br>Версия 5.5 - древний мамонт, удивительно что он у вас вообще запустился.<br>Да и не нужен он там особо.<br><br>Что нужно:<br>дамп двух swf, на которые doSWF делит исходную SWF, затем собрать их вместе, выкинув мусор от doSWF который он вписывает для инициализации.<br><br>В статье по ссылочке что я кидал описан этот метод.<br><br>Проблема у вас в идентификации валидных SWF в памяти. doSWF гадит фальшивками что вы уже заметили.<br>Для их отсеивания используйте на выбор:<br>- SWF Revealer Ultimate (платный, хз есть ли в паблике ломанный)<br>- SWF Revealer который идет плагинчиком к свежим ASV<br>- дампер памяти из замечательной тулзы SWF iD которую вы недооценили. В дампере есть механизмы отсеивания мусорных swf, чувствительность можно настроить слайдером, поизучайте<br><br>В итоге получите 2 swfки - в одной данные (ассеты графики шрифты и проч) в другой код.<br>И склеивайте их по инструкции из статейки.
<br><br><font size="1"><i>-----<br>Флэш, ява, дотнет - на завтрак, обед и ужин. Unity3D на закуску.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=383051&amp;user=1931&amp;forum_n=2&amp;topic=25116.html&amp;page=0&amp;anchor=7" class="addthx" data-post="383051"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=27703" title="28-03-2018 20:58, ранг:1.2" target="_blank">sashka2002</a>, <a href="action=userinfo&user=25149" title="30-03-2018 04:27, ранг:4.6" target="_blank">Fenrisus</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> DoSWF Анпак.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#8" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="2">
<input type="hidden" name="topic" value="25116">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=25116" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
