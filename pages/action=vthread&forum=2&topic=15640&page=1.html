<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите пофиксить чужой баг (Borland C++) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Описание софта: Есть софтинка CarTest-injector нужная мне для работы. Под неё уже сделано всё железо. Прога эта управляет стендом для чистки/проверки автомобильных бензиновых форсунок. Она формирует сигнал нужной формы на 4-ый">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=42610'>r0lka</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a>, <a target='_blank' href='?action=userinfo&amp;user=55550'>testrev1337</a>, <a target='_blank' href='?action=userinfo&amp;user=19256'>johnniewalker</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите пофиксить чужой баг (Borland C++)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=2&amp;topic=15640&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=2&amp;topic=15640&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 января 2010 01:31 &middot; Поправил: SergX <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15640&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
<u>Описание софта:</u> Есть софтинка CarTest-injector нужная мне для работы. Под неё уже сделано всё железо. Прога эта управляет стендом для чистки/проверки автомобильных бензиновых форсунок. Она формирует сигнал нужной формы на 4-ый пин COM порта (DTR). Ни как не проверяет наличие адаптера и не ждёт никакого ответа, просто посылает импульсы. Прога написана на Borland C++ и ни чем не пакована, защиты тоже нет. Не проблема конечно и самому написать аналог, но жалко времени, которого и так нет…<br><br><img src="http://www.imagepost.ru./images/rVoe4osCyKq7lYwJ06C6.jpg" border="0" align="" alt=""><br><br><u>Описание бага:</u> Прога проверялась мной на нескольких стационарных компах и на нескольких ноутах. На ноутах при нажатии на кнопку “Start”, тест который должен идти 60сек доходит до 100% за 15-20сек при этом и частота импульсов левая… На стационарных всё нормально. Читал на форумах что у многих та же хрень.<br><br><u>Что нарыл:</u><br>Прога юзает файл IOPORT.DLL который вовсе не DLL а какая-то хрень.<br>Событие при создание главного окна - 004025F0<br>Процедура кнопки СТАРТ - 00401784<br>Тут процедура СТАРТ начинает что-то чудить с IOPORT.DLL - 00401A93<br>Процедура кнопки СТОП - 00402488<br>Используется два VCL таймера, обработчик первого - 004025AC, со вторым не разобрался…<br><br><u>Софт тут</u>: <noindex><a href="http://slil.ru/28485204" rel="nofollow" target="_blank">http://slil.ru/28485204</a></noindex> (Размер: 366.83KB) <noindex><a href="http://www.virustotal.com/ru/analisis/62003dfe452208bf9a8ccc29b57ac1e4d8df298069959662ef0a38fcb76dbf77-1263595701" rel="nofollow" target="_blank">отчёт virustotal.com для параноиков <img src="img/smilies/s1.gif" alt=""></a></noindex><br><br><br><u>Просьба ко всем</u> у кого есть 3 свободные минуты:  проверьте сколько времени у вас будет длится тест после нажатия кнопки “START” (без изменения настроек). В идеале должно быть 60сек. И напишите какой у вас результат по времени, проц и версия маздая.<br><br>Буду благодарен за любые советы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=249124&amp;user=11974&amp;forum_n=2&amp;topic=15640&amp;page=1&amp;anchor=1" class="addthx" data-post="249124"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2010 14:24 &middot; Поправил: SergX <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15640&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
Всем большое спасибо.<br><br><I>ToBad пишет:<br>Ты не пробывал промониторить что идёт на ком порт? Может данные с ноутов вообще не посылаются? </I><br>Импульсы есть на всех компах где есть COM порт. Подключив стенд с форсунками ошибиться тут не возможно. Проблема в длине импульсов и задержках между ними.<br><br><I>ClockMan пишет:<br>/*401DD7*/  PUSH 0049B531//Данная версии программы не является зарегестрированной и не будет работать на данном компьютере! </I><br><I>SVLab пишет:<br>SergX, конечно, говорил, что &quot;Наличие устройства определить не возможно так как в нём нет никаких мозгов&quot;, но зачем тогда сообщение &quot;Блок не найден! Проверьте правильность подсоединения блока и его питания!&quot; </I><br>Странно.. Получается, что прога действительно ломана...<br><br><I>SVLab пишет:<br>Отличие COM портов на ноутах может быть аппаратным, обычно уровни сигналов там не соответствуют стандарту RS232 ...........//............. По моему, для этого особые мозги устройству и ненужны, достаточно проверить уровни. </I><br>Уровни могут конечно и отличаться, но программно можно узнать только состояние регистров COM порта. Устройство которое я сделал для этой проги подключается к СОМ порту только одним проводком к пину RTS. Этот пин однонаправлен и работает только как выход. <br><br>Ещё раз напомню что устройство реагирует на команды с порка как на стационарных так и на ноутах, проблема только в частоте/скорости. Например в режиме кавитиции форсунки должны издавыть громкое жужжание, из за неправильных частот на ноутах слышен только писк.<br><br><I>ToBad пишет:<br>Фишка в том, что весь процесс при нормальных условиях должен занимать где то минуту, ибо играют роль продолжительность импульсов и время между ними. Со слов топикстартера ясно, что на ноутах всё работает так же, только за 20 секунд, то есть ускорено в 3 раза. </I><br>Всё точно, но не ровно за 20 сек. это значение плавает +-5 сек. Причём меняется после перезапуска проги.<br><br><I>ToBad пишет:<br>p.s. В общем так получается, мы запоминаем значения вызвав функцию с инструкцией rdtsc, затем по адресу 401563 делаем секундную паузу sleep, затем ещё раз функу с rdtsc. Таким образом автор вычисляет на сколько изменился TSC (Time Stamp Counter) за секунду. Так или иначе проблема тут. У кого ещё остались сомнения - поменяйте интервал sleep в большую и меньшую сторону. Тут и ошибка про 4Ггц всплывёт, и проход за 15-20 секунд как на ноуте увидите на стационарном.... </I><br>Всё сходится <img src="img/smilies/s1.gif" alt=""><br>С rdtsc я не силён, сейчас буду гуглить. Насколько я понял могу решить проблему подбором константы для своего ноута ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=249257&amp;user=11974&amp;forum_n=2&amp;topic=15640&amp;page=1&amp;anchor=2" class="addthx" data-post="249257"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2010 16:04 &middot; Поправил: Clerk <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15640&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<u>NT не является операционной системой реального времени.</u><br>Также и железо не позволяет использовать сверхточные таймеры. HPET, APIC, RTC подключены к одному и томуже тактовому генератору, просто разный коэффициент деления, это значит что погрешность одинаковая. Также и прерывания - если они слишком часты, то ось захлебнётся. TSC использовать в условиях вытесняющей мультизадачности смысла нет - исполнение потока будет отложено в случайный момент и может быть весьма продолжительным, например дисковые операции, или тотже RIT - имеет наивысший приоритет.<br>Нормально реализуется в виде контроллера, который после сбора и обработки информации даст запрос на прерывание. Это позволяет разгрузить ось.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=249267&amp;user=17964&amp;forum_n=2&amp;topic=15640&amp;page=1&amp;anchor=3" class="addthx" data-post="249267"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2010 16:30 &middot; Поправил: SergX <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15640&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
<b>Clerk</b> я уже давно пришёл к выводу что стабильной и удобной работы стенда под управление ПК не добиться. Со временем сделаю автономный девайс с кнопочками и экранчиком на микроконтроллере Atmel который будет всем этим делом управлять. Но перед тем как делать что-то своё хочу поработать на чужом, чтобы понять, что мне нужно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=249270&amp;user=11974&amp;forum_n=2&amp;topic=15640&amp;page=1&amp;anchor=4" class="addthx" data-post="249270"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2010 18:20 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15640&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<I><b>SergX</b> пишет:<br>Насколько я понял могу решить проблему подбором константы для своего ноута ? </I><br><br>Да, если для одного ноута - то это идеальный вариант. Хотя оказаться может всё не так просто.<br>Дело в том, что описанный мною участок замера кол-ва тактов за секунду - это не большая проблема, и подобрать легко таймером и заменить можно результат на готовую константу снятую со схожего по частоте стационарного компа. Хуже то, что уже после нажатия кнопки старта функция с rdtsc вызывается очень часто в цикле. Фактических вызовов всего 4, два при запуске софта для замера кол-ва тактов в секунду - остальные по ходу работы. Как бы сделал я для одного ноута если бы решил не вдаваться в дебри глюков функи на мобильных процах? Во первых заменил бы все 4 вызова на вызов своей функи из длл. В ней определял бы место вызова из кода обозначив номерами. Далее заставил бы свою функцию выдавать результат работы оригинальной функции и писал бы всё в лог файл.  Думаю на точность расчётов сильно не повлияло бы... Как пишет <b>Clerk</b> <i class=x>NT не является операционной системой реального времени</i> но тут речи и не идёт о супер точности и супер скорости, мы же не операцию на сердце делаем, форсунки блин жужжат по разному <img src="img/smilies/s1.gif" alt=""> , проблема ведь в разнице 20 сек +-5 и 60 +-10, как я понял при минуте работы +-5-10 сек на разных компах не критично для подключенного оборудования... Следовательно логгер результатов работы функции запущенный на схожем с ноутом по быстродействию нормальном компе где нет проблемы - даст достаточно точные результаты для последующей эмуляции работы функции с вызовом rdtsc на ноуте... <br><br><b>SergX</b> В любом случае информируй об успехах, очень интересно чем всё закончится...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=249282&amp;user=702&amp;forum_n=2&amp;topic=15640&amp;page=1&amp;anchor=5" class="addthx" data-post="249282"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2010 18:46 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15640&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
<b>ToBad</b><br>&gt; но тут речи и не идёт о супер точности и супер скорости<br>Так как используется TSC, значит не достатончо частоты/стабильности(последнее в юзермоде теряет смысл):<br>o Ядерных таймеров в юзермоде.<br>o Системинфо.<br>o Так как системные счётчики можно читать, посредством маппинга ядерной памяти, сюда отнесём и PIT.<br>Тогда переносите весь функционал по обработке в ISR(дров как обычно). Тогда практически видно будет - работает или нет. В любом случае это не тру. Нужен полноценный интерфейс.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=249283&amp;user=17964&amp;forum_n=2&amp;topic=15640&amp;page=1&amp;anchor=6" class="addthx" data-post="249283"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2010 22:42 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15640&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<b>Clerk</b> по тулзе видно, что автор писал как мог, а мог он не очень, отсюда и глюк для мобильных процов... Думаю для инжекторов с которыми имеет дело <b>SergX</b> - -+10% погоды не сделает... Так что думаю подойдёт любой вариант который описан выше...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=249303&amp;user=702&amp;forum_n=2&amp;topic=15640&amp;page=1&amp;anchor=7" class="addthx" data-post="249303"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2010 23:06 &middot; Поправил: SergX <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15640&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<I>ToBad пишет:<br>Clerk по тулзе видно, что автор писал как мог, а мог он не очень, отсюда и глюк для мобильных процов... </I><br>бугага )) +100500<br><br><I>ToBad пишет:<br>Думаю для инжекторов с которыми имеет дело SergX - -+10% погоды не сделает... </I><br>Вся беда в том, что сделает... Дело не в продолжительности теста, а в частоте и скважности, на которой работает форсунка. Тот же режим кавитации или самопрокачки это не просто цоканье клапаном, а довольно сложный физический процесс.<br><br>З.Ы. Хотя я не уверен что аффтор софта сделал правильно всё остальное кроме расчёта задержек.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=249305&amp;user=11974&amp;forum_n=2&amp;topic=15640&amp;page=1&amp;anchor=8" class="addthx" data-post="249305"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]tomac[/b]','')">tomac</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 65.3 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.82'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6470">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2010 01:46 <br><script type="text/javascript">QU('tomac','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tomac" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15640&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
Поправьте меня, если я неправ.<br>Можно заменить вызов Sleep() на цикл до прохода одной секунды? Тогда процессор не будет тормозиться, и он будет выдавать то же число в rdtsc.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=249315&amp;user=6470&amp;forum_n=2&amp;topic=15640&amp;page=1&amp;anchor=9" class="addthx" data-post="249315"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2010 03:17 &middot; Поправил: Clerk <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15640&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
<b>SergX</b><br>хм <img src="img/smilies/s13.gif" alt=""><br><b>tomac</b><br>Системный счётчик тиков имеет разрешение в ~64ms. Тоесть примерно 1/16 секунды. Добавим сюда планирование - при нормальном приоритете тред свопится ~100 раз в секунду. Поэтому значение считанное из тск будет сильно плавать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=249321&amp;user=17964&amp;forum_n=2&amp;topic=15640&amp;page=1&amp;anchor=10" class="addthx" data-post="249321"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2010 03:54 <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15640&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
<I>Clerk пишет:<br>хм </I><br>я что-то не так сказал ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=249324&amp;user=11974&amp;forum_n=2&amp;topic=15640&amp;page=1&amp;anchor=11" class="addthx" data-post="249324"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2010 05:54 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15640&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
Цитата из книги <b>Нестандартные приёмы программирования на DELPI</b> автор Ревич.Ю.В. стр447<br><I><br>Отметим,что в Windows XP, согласно моим наблюдениям, ситуация одновременно и хуже и лучше: малые промежутки времени вообще не отмеряются, можно сказать никак,а большие (секунда и выше) измеряются точнее.Так обычно частоту процессора измеряют несколько раз, применяя ту же <b>rdtsc</b>, и затем усредняют полученные значения. Заметим также, что в ноутбуках с механизмом подстройки тактовой частоты всё это просто может не заработать<br></I>
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=249329&amp;user=17432&amp;forum_n=2&amp;topic=15640&amp;page=1&amp;anchor=12" class="addthx" data-post="249329"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 января 2010 14:08 &middot; Поправил: SergX <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15640&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<I>ToBad пишет:<br>SergX В любом случае информируй об успехах, очень интересно чем всё закончится... </I><br><br><b>ToBad</b>, в общем ты был абсолютно прав насчёт rdtsc. Спасибо <img src="img/smilies/s1.gif" alt=""><br>Пофиксить трабл с rdtsc пока не вышло, пробовал разные варианты...<br><br>В проге забил частоту проца константой и всё стало ок. А может и не всё...<br><br>проц: Intel Pentium M processor 1600MHz<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00401554</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">5F5E1000</span>&nbsp;&nbsp;&nbsp;<span class="hl_comment">;(5F5E1000h=1600Mhz)</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">NOP</span></li><li class="hl_l0"><span class="hl_number">00401589</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">NOP</span></li>        </ol>
    </div>
</div></div>
<br><br><I>ToBad пишет:<br>Хуже то, что уже после нажатия кнопки старта функция с rdtsc вызывается очень часто в цикле. </I><br>об этом я забыл... поковыряю, напишу о результатах.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=250089&amp;user=11974&amp;forum_n=2&amp;topic=15640&amp;page=1&amp;anchor=13" class="addthx" data-post="250089"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=2&amp;topic=15640&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=2&amp;topic=15640&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите пофиксить чужой баг (Borland C++)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#14" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="2">
<input type="hidden" name="topic" value="15640">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15640" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
