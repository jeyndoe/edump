<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Вопрос знатокам кто сталкивался с TrusCont TSFD Protection Toolkit - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="TrusCont TSFD Protection Toolkit - комплекс для защиты программ против копирования внедряет свою библиотеку в exe фаил и гадит весь код Пытаюсь отучить программу от проверки с какого носителя она запускается, в оригинале она">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вопрос знатокам кто сталкивался с TrusCont TSFD Protection Toolkit</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=13&amp;topic=21208&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=21208&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]unix3d[/b]','')">unix3d</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24392">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2013 18:49 <br><script type="text/javascript">QU('unix3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unix3d" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
TrusCont TSFD Protection Toolkit  - комплекс для защиты программ против копирования внедряет свою библиотеку в exe фаил и гадит весь код<br>Пытаюсь отучить программу от проверки с какого носителя она запускается,<br>в оригинале она запускается только с USB накопителя. В программе используется алгоритм получения из реестра данных о подключенном USB устройстве. Проверка VID и PID и серийного номера , ключ программы генерируется относительно серийного номера и 2 дополнительных параметров введенных пользователем , эту проверку я обошёл. Так же в оригинальном USB накопители странная разметка флеш накопителя там по мимо FAT32 разметки есть не понятные разделы,  при помощи Linux и команды dd был слит полный дамп с устройства,  из дампа были выдернуты те самые разделы которые были нужны  для полного клонирования флеш накопителя. Но тут меня ожидал очередной уровень защиты при запуске с клонированного устройства выдаётся окно с текстом вставте оригинальный USB <br>из дезассемблема вызов идёт с <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F6AC</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li>        </ol>
    </div>
</div></div>
<br>в регистре eax хронится  точка входа в библиотеку tcpm_exe_usb.dll<br>и внутри этой библиотеки принимается решение о том верный ли USB носитель или нет.<br><br>Если кто нибудь сталкивался с этим &quot;пакером&quot; поделитесь опытом как отвязать эту библиотеку или как обойти эту защиту
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321677&amp;user=24392&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=1" class="addthx" data-post="321677"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2013 19:25 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>unix3d пишет:<br>eax хронится точка входа в библиотеку tcpm_exe_usb.dll </I><br>Софт в студию
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321678&amp;user=26651&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=2" class="addthx" data-post="321678"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2013 19:26 <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
ну дык трассируйте, смотрите что происходит внутри библиотеки, как проверяется носитель  и т.д.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321679&amp;user=10534&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=3" class="addthx" data-post="321679"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]unix3d[/b]','')">unix3d</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24392">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2013 19:35 &middot; Поправил: unix3d <br><script type="text/javascript">QU('unix3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unix3d" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
2<b> ELF_7719116</b><br>софт можно скачать с http://dasm.dyndns.org/Norma.7z<br>около 600 мб скопировано с оригинальной флешки.<br>2<b>tihiy_grom</b><br>Уже 3 день этим занимаюсь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321681&amp;user=24392&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=4" class="addthx" data-post="321681"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]connect7[/b]','')">connect7</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.29'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34416">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2013 20:26 &middot; Поправил: connect7 <br><script type="text/javascript">QU('connect7','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=connect7" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>unix3d</b><br>Что означает для Вас &quot;полного клонирования флеш накопителя&quot;??? Сумели найти флеш диск на том-же самом конроллере (возможно и даже на том же самом флеш чипе/ах) и подправили его серийника и имя?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321683&amp;user=34416&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=5" class="addthx" data-post="321683"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]unix3d[/b]','')">unix3d</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24392">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2013 20:44 <br><script type="text/javascript">QU('unix3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unix3d" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Да USB на контролере SMI sm3254EA его анналоги SM3255AA и SM3257EANN было скопированно все визическое устройство ввключая разметку той части которая не определялась, кто знаком с Linux знает что такое dd с помошью нее можно скопировать все физическое устройство с первых до последних байтов относительно этого дампа был сделан дамп но для другого устройства на схожем чипе и поддеиживающем теже инструкции. после этого были естественно поправлены PID и VID и серийный номер на новом устройстве, соответственно это точная копия оригинального устройства даже дампы Jtagом это подтверждают физически наполнение модуля памяти идентичны друг другу
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321684&amp;user=24392&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=6" class="addthx" data-post="321684"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2013 20:59 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
если уверены что проверка в той длл<br>то длл и давайте
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321686&amp;user=15381&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=7" class="addthx" data-post="321686"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]connect7[/b]','')">connect7</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.29'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34416">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2013 21:28 &middot; Поправил: connect7 <br><script type="text/javascript">QU('connect7','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=connect7" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>unix3d</b><br>А плата двух флеш дисков одна и та же? Может там еще кое чего существенное есть кроме контроллера и флеш памяти. Можно фоткок на плату флеш диска с обеих сторон.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321687&amp;user=34416&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=8" class="addthx" data-post="321687"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]unix3d[/b]','')">unix3d</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24392">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2013 21:31 <br><script type="text/javascript">QU('unix3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unix3d" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
длл вызывается из корневого процесса, она вшита в ехешник программы я скачал версию софта с офф сайта но не уверен той ли версией накрыта программа на офф сайте версия 2.4. эта библиотека существует и в программе протектара она запокована ACProtect позже могу выложить библиотеку взятую из этого программного комплекса. То что я понял что этот комплекс очень сильно гадит полиморфом код приходится постоянно сидеть в IDA и трейсить там по томучто в Olly код попорчен!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321688&amp;user=24392&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=9" class="addthx" data-post="321688"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]unix3d[/b]','')">unix3d</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24392">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2013 21:34 <br><script type="text/javascript">QU('unix3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unix3d" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>connect7</b> если Вы по поводу хардварного лок чипа то его там нет!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321689&amp;user=24392&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=10" class="addthx" data-post="321689"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]connect7[/b]','')">connect7</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.29'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34416">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2013 22:44 <br><script type="text/javascript">QU('connect7','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=connect7" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Либо чего-то не полностью копируете либо там в железе есть еще чего-то ,что распознается программой.  Гадать некому без информацией )
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321694&amp;user=34416&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=11" class="addthx" data-post="321694"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]unix3d[/b]','')">unix3d</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24392">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2013 23:22 <br><script type="text/javascript">QU('unix3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unix3d" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Вас ни чего не смущает что даже JTAG дампы одинаковые а это уже на уровне микрокода контролера. Копируется все одинакого CRC  суммы даных совпадают скорее всего проверка в этой длл считывает ключ базируешся на модели чипа памяти и контролера флеш устройства и хронится он если мои догдки верны в области на USB диске а протекция ехешника на этой флешки сводится к тому что длл проверяет ключ из этой области с реальными данными о чипе устройства, но так как код очень замусорен требуется время и помощь более опытных людей в понятии алгоритма по которому идет расчет, дальнейшая эмуляция дело техники.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321695&amp;user=24392&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=12" class="addthx" data-post="321695"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]connect7[/b]','')">connect7</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.29'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34416">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2013 23:31 &middot; Поправил: connect7 <br><script type="text/javascript">QU('connect7','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=connect7" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Oо, у вас flash чипы еще отличаются...Шустрая защита, если проверяет и их. Может у данного контроллера поддержка уникального ID где-то в регистрах? Они пишут, что у них специальные флеш накопители. <br>Копайте...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321696&amp;user=34416&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=13" class="addthx" data-post="321696"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]unix3d[/b]','')">unix3d</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24392">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 13:43 <br><script type="text/javascript">QU('unix3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unix3d" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Вот библиотека tcp_exe_usb.dll<br><br><img src="img/attach.gif" alt=""> <a href="./files/5148_28.03.2013_EXELAB.rU.tgz">5148_28.03.2013_EXELAB.rU.tgz</a> - tcp_exe_usb.part1.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321719&amp;user=24392&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=14" class="addthx" data-post="321719"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]unix3d[/b]','')">unix3d</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24392">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 13:45 <br><script type="text/javascript">QU('unix3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unix3d" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Вторая часть архива<br><br><img src="img/attach.gif" alt=""> <a href="./files/7bb6_28.03.2013_EXELAB.rU.tgz">7bb6_28.03.2013_EXELAB.rU.tgz</a> - tcp_exe_usb.part2.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321720&amp;user=24392&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=15" class="addthx" data-post="321720"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 13:56 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
rghost.net
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321721&amp;user=15381&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=16" class="addthx" data-post="321721"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]unix3d[/b]','')">unix3d</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24392">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 14:11 <br><script type="text/javascript">QU('unix3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unix3d" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<noindex><a href="http://rghost.ru/44837966" rel="nofollow" target="_blank">http://rghost.ru/44837966</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321722&amp;user=24392&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=17" class="addthx" data-post="321722"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]unix3d[/b]','')">unix3d</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24392">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 14:14 <br><script type="text/javascript">QU('unix3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unix3d" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#18');return false;">#18</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001CEA</span>&nbsp;loc_4001CEA<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: tcpm_exe_usb.dll:0401FD09p</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001CEA</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; tcpm_exe_usb.dll:0401FD1Dp</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001CEA</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001CEB</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001CED</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FFFFFFF8h</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001CF0</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0FFFFFFFFh</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001CF2</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;unk_402FB91</li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001CF7</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;large&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_number">0</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001CFD</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001CFE</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001CFF</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">2B50Ch</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D04</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_40207E0</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D09</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_403F790</li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D0E</span>&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D10</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">2B508h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D17</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D18</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D19</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D1A</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_403F790</li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D1F</span>&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D21</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D22</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">2B520h</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D29</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;large&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D2F</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D32</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">48h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D36</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">10h</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D39</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">3094h</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D3E</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">24h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D42</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_401F7A1</li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D47</span>&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D49</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D4A</span>&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D4C</span>&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_4001D55</li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D4E</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_400E9F0</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D53</span>&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_4001D57</li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D55</span>&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------------</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D55</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D55</span>&nbsp;loc_4001D55<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: tcpm_exe_usb.dll:04001D4Cj</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D55</span>&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D57</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D57</span>&nbsp;loc_4001D57<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: tcpm_exe_usb.dll:04001D53j</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D57</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_40419AC<span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D5C</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_400EA70</li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D61</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;aDllmainEntered&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; &quot;DllMain entered&quot;</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D66</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_40419AC</li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D6C</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_40013F8</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D71</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D72</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D73</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D74</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">24Ch</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D7B</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_4001000</li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D80</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">48h</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D84</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">21Ch</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D8B</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">224h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D92</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">230h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001D99</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">220h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DA0</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">228h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DA7</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">234h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DAF</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">2B528h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DB6</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_40419AC</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DBB</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DBD</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_40018DE</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DC2</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">21Ch</span><span class="hl_char">]</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DC9</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_4001604</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DCE</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">20h</span><span class="hl_char">]</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DD2</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DD5</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">54h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DD9</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">18h</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DDC</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">38h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DE0</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">10h</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DE3</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">4Ch</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DE7</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">14h</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DEA</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">1Ch</span><span class="hl_char">]</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DED</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DEE</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;aVolumeKeyCrc0x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; &quot;Volume key crc: 0x%lx&quot;</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DF3</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_40419AC</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DF9</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">50h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001DFD</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">38h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E01</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_40013F8</li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E06</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">2Ch</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E0A</span>&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E0C</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">88h</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E13</span>&nbsp;<span class="hl_function">stosd</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E14</span>&nbsp;<span class="hl_function">stosd</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E15</span>&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0Ch</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E18</span>&nbsp;<span class="hl_function">stosd</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E19</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">60h</span>&nbsp;<span class="hl_comment">; '`'</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E1B</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E1C</span>&nbsp;<span class="hl_function">stosd</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E1D</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">104h</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E22</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">2B208h</span><span class="hl_char">]</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E29</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E2A</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">0A4h</span><span class="hl_char">]</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E31</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E32</span>&nbsp;<span class="hl_function"><b>rep</b></span>&nbsp;<span class="hl_function">movsd</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E34</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>off_4030038</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E3A</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">2B204h</span><span class="hl_char">]</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E41</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E42</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;aExeFilePathS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; &quot;Exe file path: %S&quot;</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E47</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_40419AC</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E4D</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_40013F8</li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E52</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">2B210h</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E59</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">24h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">al</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E5D</span>&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0Ch</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E60</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">632Ch</span><span class="hl_char">]</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E67</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E68</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_40034E0</li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E6D</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E6E</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">32C0h</span><span class="hl_char">]</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E75</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_4001000</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E7A</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">2795Ch</span><span class="hl_char">]</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E81</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_400C2A0</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E86</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">2B528h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">3</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E8E</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_40419AC</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E94</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E96</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">248E8h</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001E9D</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_40018DE</li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EA2</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EA4</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">27B6Ch</span><span class="hl_char">]</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EAB</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_40018DE</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EB0</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EB2</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">32BCh</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EB9</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_40018DE</li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EBE</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;aEnumeratingDev&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; &quot;Enumerating devices...&quot;</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EC3</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EC4</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_40013F8</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EC9</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001ECA</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001ECB</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001ECC</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">1Ch</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001ED0</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">6334h</span><span class="hl_char">]</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001ED7</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_4003830</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EDC</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">93A4h</span><span class="hl_char">]</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EE3</span>&nbsp;<span class="hl_function"><b>sub</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">93A0h</span><span class="hl_char">]</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EEA</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0CB8h</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EEF</span>&nbsp;<span class="hl_function">cdq</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EF0</span>&nbsp;<span class="hl_function"><b>idiv</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EF2</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EF3</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;aEnumerationDon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; &quot;Enumeration done, found %d disks...&quot;</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EF8</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_40419AC</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001EFE</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">24h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001F02</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;unk_40013F8</li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001F07</span>&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0Ch</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001F0A</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">34h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001F0E</span>&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">18h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1">tcpm_exe_usb<span class="hl_char">.</span>dll<span class="hl_char">:</span><span class="hl_number">04001F12</span>&nbsp;<span class="hl_function"><b>jle</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_4002400&nbsp;&nbsp;&nbsp;<span class="hl_char">&lt;</span>b<span class="hl_char">&gt;</span><span class="hl_char">&lt;</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;Вот&nbsp;с&nbsp;этого&nbsp;места&nbsp;вылетаем&nbsp;на&nbsp;код&nbsp;по&nbsp;отображению&nbsp;MessageBox&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">/</span>b<span class="hl_char">&gt;</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=321723&amp;user=24392&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=18" class="addthx" data-post="321723"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 14:30 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
там есть обращение к драйверу и есть обращение к COM интерфейсу<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100028D2</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;aDeviceiocontro<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; &quot;DeviceIoControl&quot;</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100028D8</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100028D9</span>&nbsp;<span class="hl_number">030</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span>dword_100032E6<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100028DF</span>&nbsp;<span class="hl_number">034</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;_loadproc_sub_10002A40</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100028E4</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span>_f_DeviceIoControl<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li>        </ol>
    </div>
</div></div>
<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">10121CB0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rclsid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">0F6D90F11h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Data1</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">10121CB0</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; DATA XREF: _TCPM_sub_10005A20+67o</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">10121CB0</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; sub_10006300+51o</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">10121CB0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dw</b></span>&nbsp;<span class="hl_number">9C73h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Data2</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">10121CB0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dw</b></span>&nbsp;<span class="hl_number">11D3h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Data3</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">10121CB0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">0B3h</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">2Eh</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0C0h</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">4Fh</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">99h</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0Bh</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0B4h</span><span class="hl_comment">; Data4</span></li>        </ol>
    </div>
</div></div>
<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">10005D27</span>&nbsp;<span class="hl_number">080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;aPleaseInsertTh&nbsp;<span class="hl_comment">; &quot;Please insert the original USB disk and&quot;...</span></li>        </ol>
    </div>
</div></div>
<br>надпись выводится помоему после обращение к COM интрефейсу<br><br>трейсите вообщем<br><br>есть проверка crc32<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100038E9</span>&nbsp;<span class="hl_number">0DC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>_crc32_dword_1014AD68<span class="hl_char">[</span><span class="hl_registr">ecx</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=321724&amp;user=15381&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=19" class="addthx" data-post="321724"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 14:40 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>unix3d</b><br>Приводите базу образа, с которой грузите библиотеку, иначе ваши листинги не позволяют попасть на то же место в коде, которое вы описываете. Или в иде выполните rebase на 10000000 (на базу образа из заголовка) и приведите кусок когда, где выводится сообщение, ещё раз. А то мне лично влом придумывать хитрожопые способы, как попасть на участок кода из ваших листингов.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=321725&amp;user=6336&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=20" class="addthx" data-post="321725"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]unix3d[/b]','')">unix3d</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24392">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 16:59 &middot; Поправил: unix3d <br><script type="text/javascript">QU('unix3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unix3d" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Exe шник самой программы, какой версией TrusCont TSFD Protection он накрыт затрудняюсь ответить <br><noindex><a href="http://rghost.ru/44841454" rel="nofollow" target="_blank">http://rghost.ru/44841454</a></noindex><br>Приведённая Dll взята с версии 2.4 с офф сайта<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF09</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_82F046&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span>&nbsp;Вызов&nbsp;первой&nbsp;процедуры&nbsp;проверки</li>        </ol>
    </div>
</div></div>
<br><br>EAX = FFFFFFFF  - Нужны права админа<br>EAX = 0 проверка непройдена<br>другое значение скорее всего буква диска USB<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF0E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">24833E5h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF14</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">248315Ah</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF1A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF1D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_82EF4B&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span>&nbsp;Прыжок&nbsp;на&nbsp;вызов&nbsp;MessageBox&nbsp;<span class="hl_char">(</span>Please&nbsp;Insert&nbsp;original&nbsp;USB&nbsp;disk<span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
 <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF1F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FFFFFFFFh</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF22</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_82EF26&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span>&nbsp;Прыжок&nbsp;на&nbsp;вызов&nbsp;MessageBox&nbsp;о&nbsp;нехватки&nbsp;прав</li>        </ol>
    </div>
</div></div>
 <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF24</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_82EF70</li>        </ol>
    </div>
</div></div>
<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF26</span>&nbsp;loc_82EF26<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: start+208j</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF26</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">10h</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF28</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">24833F0h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF2E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF2F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">24833FEh</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF36</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF38</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">24833DDh</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF3E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1F5h</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF43</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF44</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">24833E1h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF4A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Trap to Debugger</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF4B</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF4B</span>&nbsp;loc_82EF4B<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: start+203j</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF4B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">10h</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF4D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">248318Eh</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF54</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">24831DEh</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF5A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF5B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF5D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">24833D9h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF63</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1F4h</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF68</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF69</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">24833E1h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF6F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Trap to Debugger</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF70</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF70</span>&nbsp;loc_82EF70<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: start+20Aj</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">248314Ah</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF76</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF77</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">24833B1h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF7D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF7E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">24833A9h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF84</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">24833B5h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF8B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF8C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">24833B9h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF92</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF93</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">24833BDh</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF99</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF9A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">24833E5h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EFA0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">248315Eh</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EFA6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EFA7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_82F42A&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span>&nbsp;Вызов&nbsp;второй&nbsp;процедуры&nbsp;проверки</li>        </ol>
    </div>
</div></div>
 <br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F42A</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F42B</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F42D</span>&nbsp;<span class="hl_function"><b>sub</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">20h</span></li><li class="hl_l1"><span class="hl_comment">;---------------------------------- часть кода опущена</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F6A1</span>&nbsp;loc_82F6A1<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: sub_82F42A+1EDj</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F6A1</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_18<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F6A4</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_20<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F6A7</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F6A9</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F6AA</span>&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F6AC</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span>&nbsp;вызов&nbsp;Dll&nbsp;tcpm_exe_usb<span class="hl_char">.</span>dll&nbsp;</li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F6AE</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_14<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edi</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=321741&amp;user=24392&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=21" class="addthx" data-post="321741"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 17:51 &middot; Поправил: ELF_7719116 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>unix3d пишет:<br>EAX = FFFFFFFF - Нужны права админа<br>EAX = 0 проверка непройдена<br>другое значение скорее всего буква диска USB </I><br>он по очереди физические диски открывает и deviceiocontrol&#039;ит (IOCTL_DISK_GET_DRIVE_GEOMETRY, IOCTL_SCSI_GET_ADDRESS  и IOCTRL_SCSI_PASS_THROUGHT), чтобы какие-то сигнатуры<strike>(серийные номера?) найти (<b>привязка по железу</b>??)</strike>( сиги во флешке<img src="img/smilies/s1.gif" alt=""> )<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0082F1B5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">33C0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">0082F1B7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F3<span class="hl_char">:</span>A7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>REPE</b></span>&nbsp;CMPS&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESI</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">ES</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>D2&nbsp;<span class="hl_number">52</span>&nbsp;<span class="hl_number">35</span>&nbsp;<span class="hl_number">6E</span>&nbsp;<span class="hl_number">51</span>&nbsp;C3&nbsp;<span class="hl_number">71</span>&nbsp;<span class="hl_number">44</span>&nbsp;<span class="hl_number">93</span>&nbsp;<span class="hl_number">14</span>&nbsp;C1&nbsp;<span class="hl_number">46</span>&nbsp;F8&nbsp;<span class="hl_number">8C</span>&nbsp;E9&nbsp;<span class="hl_number">01</span>&nbsp;FF</li><li class="hl_l0"><span class="hl_number">0082F1B9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0F85</span>&nbsp;<span class="hl_number">8B000000</span>&nbsp;<span class="hl_function"><b>JNE</b></span>&nbsp;<span class="hl_number">0082F24A</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_number">0082F20E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8BF8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">0082F210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">33D2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_registr">EDX</span></li><li class="hl_l1"><span class="hl_number">0082F212</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F3<span class="hl_char">:</span>A7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>REPE</b></span>&nbsp;CMPS&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESI</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">ES</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_number">97</span>&nbsp;<span class="hl_number">90</span>&nbsp;<span class="hl_number">36</span>&nbsp;<span class="hl_number">1B</span>&nbsp;<span class="hl_number">7B</span>&nbsp;B8&nbsp;<span class="hl_number">8D</span>&nbsp;<span class="hl_number">49</span>&nbsp;<span class="hl_number">8D</span>&nbsp;FF&nbsp;<span class="hl_number">64</span>&nbsp;<span class="hl_number">74</span>&nbsp;<span class="hl_number">73</span>&nbsp;<span class="hl_number">19</span>&nbsp;<span class="hl_number">5B</span>&nbsp;<span class="hl_number">06</span></li><li class="hl_l0">D2&nbsp;<span class="hl_number">52</span>&nbsp;<span class="hl_number">35</span>&nbsp;<span class="hl_number">6E</span>&nbsp;<span class="hl_number">51</span>&nbsp;C3&nbsp;<span class="hl_number">71</span>&nbsp;<span class="hl_number">44</span>&nbsp;<span class="hl_number">93</span>&nbsp;<span class="hl_number">14</span>&nbsp;C1&nbsp;<span class="hl_number">46</span>&nbsp;F8&nbsp;<span class="hl_number">8C</span>&nbsp;E9&nbsp;<span class="hl_number">01</span></li><li class="hl_l1">FF</li><li class="hl_l0"><span class="hl_number">0082F214</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">74</span>&nbsp;<span class="hl_number">4E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">0082F264</span></li>        </ol>
    </div>
</div></div>
<br>Короче в <b>EAX</b> конечный результат от <b>VirtualAlloc</b> с определенным размером.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321745&amp;user=26651&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=22" class="addthx" data-post="321745"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]unix3d[/b]','')">unix3d</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24392">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 18:20 <br><script type="text/javascript">QU('unix3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unix3d" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Нет привязки к железу как токовой нету. С оригинальный USB носителя программа запускается на любом коме. Скорее всего привязка к USB а вот как он высчитывает правильный носитель пока неизвестно....  есть догадки что в разделах на флешки сидит последовательность в которой скорее всего зашита модель той флешки которую считать верной!!!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321750&amp;user=24392&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=23" class="addthx" data-post="321750"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 18:38 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>unix3d</b><br>Ну все правильно ( просто не принял во внимание,что usb-флешка). Последовательность(сигнатура) и подозрения, что адреса функций(возможно код), которые нужно выполнить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321752&amp;user=26651&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=24" class="addthx" data-post="321752"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]unix3d[/b]','')">unix3d</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24392">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 18:54 <br><script type="text/javascript">QU('unix3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unix3d" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
возможно, но даже после поблочного считывания оригинальной флешки в фаил и заливка этого дампа на другую флешку сигнатуры и возможно код так же были бы на флешки клоне и они бы выполнялись, но этого не происходит. все больше схожусь вомнении что на флешки оригинале возможно зашиты данные технические о самой флешки! на столе 20 флешок со схожеми контролерами и даже 3 из них на том же самом контролере и с тем же самым модулем памяти. заливка дампа на эти флешки результата не дала. Продолжаю трейсить код этой библиотеки может где то в нем разгадка этого &quot;протектора&quot;. в самой библиотеки есть противо копировальные функции.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321753&amp;user=24392&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=25" class="addthx" data-post="321753"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 20:01 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>unix3d пишет:<br>Продолжаю трейсить код этой библиотеки </I><br>обратите внимание на эти функции<br>text:10004570 ; Exported entry   4. <b>TCPM_GetInfo2</b><br>text:100047A0 ; Exported entry  10. <b>TCPM_TryProtection</b><br>text:10004990 ; Exported entry   8. <b>TCPM_Protect</b><br>text:10005280 ; Exported entry   5. <b>TCPM_GetOptionsDescription</b><br>text:10007060 ; Exported entry   6. <b>TCPM_GetProperties</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321754&amp;user=26651&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=26" class="addthx" data-post="321754"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 20:33 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>unix3d</b><br>Во-первых, непонятно, почему вы называете этот вид защиты &quot;протектором&quot;. Никакого протектора там нет, код неупакован, просто написан в так называемом shellcode-стиле для того, чтоб быть базонезависимым. Запутывания (обфускации) я тоже никакой не увидел. <br><br>Во-вторых, по делу. Внутри первой функции проверки:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">(</span><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082EF09</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_82F046&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span>&nbsp;Вызов&nbsp;первой&nbsp;процедуры&nbsp;проверки<span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br><br>оригинальной флэхи основной является работа кода, начинающегося внутри sub_82F366. Конкретнее:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F407</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; lpBytesReturned</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F408</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">50h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; nOutBufferSize</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F40A</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">6Ch</span><span class="hl_char">+</span>InBuffer<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F40E</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; lpOutBuffer</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F40F</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">50h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; nInBufferSize</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F411</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; lpInBuffer</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F412</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;IOCTL_SCSI_PASS_THROUGH_DIRECT&nbsp;<span class="hl_comment">; dwIoControlCode</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F417</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>hDevice<span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;<span class="hl_comment">; hDevice</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F41A</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F41A</span>&nbsp;loc_82F41A<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DeviceIoControl</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F41A</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_18<span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br>Как уже заметил <b>ELF_7719116</b>, флешковому устройству посылаются запросы IRP_MJ_DEVICE_CONTROL с dwIoControlCode == IOCTL_SCSI_PASS_THROUGH_DIRECT. <noindex><a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff560521(v=vs.85).aspx" rel="nofollow" target="_blank">--&gt; Подробнее &lt;--</a></noindex> Как конкретно обрабатывается этот запрос на стороне драйверов флешки и кто там их обрабатывает, мини-порт, фильтр или же драйвер устройства - я х.з. Далее результат работы этого кода сравнивается ещё здесь:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F20B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">4</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F20D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F20E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F212</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>repe</b></span>&nbsp;<span class="hl_function">cmpsd</span></li>        </ol>
    </div>
</div></div>
<br><br>Но, что хуже, от результатов выходного буфера этого вызова зависят параметры (в частности, размер выделяемой области памяти) для вызова API:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F296</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_14<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F299</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">0</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F29C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">4</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F29F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_registr">esi</span><span class="hl_char">+</span><span class="hl_number">0</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F2A2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_registr">ebx</span><span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F2A6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F2A8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>div</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F2AA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; flProtect</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F2AC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">3000h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; flAllocationType</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F2B1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F2B3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>imul</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F2B6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>esi</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; dwSize</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F2B7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; lpAddress</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F2B9</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">20h</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; VirtualAlloc</span></li>        </ol>
    </div>
</div></div>
<br><br>Тем не менее, всё не так плохо. У вас же есть оригинальная флэшка. Значит надо написать логгер, а потом эмулятор. Логгер будет перехватывать DeviceIoControl, идущие к устройству флэшки, и записывать входные/выходные параметры. Ещё надо будет перехватывать CreateFile и CloseHandle, чтоб не перехватывать то, что к работе с флешкой не относится. Поработайте с оригинальной флэшкой подольше, потом пишите эмулятор. Слово это громкое, но на практике будет этот эмулятор подставлять результаты перехвата логгера. Флешка, как вы понимаете, тогда будет не нужна совсем. <br><br>Что касается конкретно этой первой функции проверки, то всё закончится вот здесь:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F2B9</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">20h</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; VirtualAlloc</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F2BC</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F2BE</span>&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_char">.</span>itext<span class="hl_char">:</span><span class="hl_number">0082F2C0</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>Answer<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>ecx</b></span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;понятно<span class="hl_char">,</span>&nbsp;что&nbsp;адрес&nbsp;не&nbsp;должен&nbsp;быть&nbsp;нулевым</li>        </ol>
    </div>
</div></div>
<br><br>А, как вы выражаетесь, &quot;Нужны права админа&quot; для осуществления открытия девайсов дисков через CreateFile.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=321755&amp;user=6336&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=27" class="addthx" data-post="321755"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24392" title="28-03-2013 18:04, ранг:2.5" target="_blank">unix3d</a>, <a href="action=userinfo&user=4773" title="28-03-2013 19:09, ранг:91.2" target="_blank">plutos</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 21:20 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
Ну вот, пришел <b>ARCHANGEL</b>, прочитал, продебажил, не выдержал и все интересное сразу выложил <img src="img/smilies/s1.gif" alt=""><br>возможно, там просто OEP зашифрована(код программы не зашифрован и написан на делфи) и переход(расшифровка) в нее осуществляется с подачи данных оригинального usb-носителя.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321756&amp;user=26651&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=28" class="addthx" data-post="321756"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24392" title="28-03-2013 18:08, ранг:2.5" target="_blank">unix3d</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]unix3d[/b]','')">unix3d</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24392">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 22:02 <br><script type="text/javascript">QU('unix3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unix3d" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
я просто в шоке, мне реально нужно многому учится <b>ARCHANGEL</b> огромное спасибо за обьяснение. <b>ELF_7719116</b> мой респект за поддержку и за разьеснение всего. Огромное СПАСИБО за то что Вы удили время моему вопросу, а точнее просьбе о помоще! Я недавно занимаюсь реверсингом! и это  для меня будет уроком!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321757&amp;user=24392&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=29" class="addthx" data-post="321757"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2013 22:16 &middot; Поправил: SReg <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Ещё надо будет перехватывать CreateFile и CloseHandle </I><br> <img src="img/smilies/s8.gif" alt=""> http://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15420&amp;page=0#12<br>зы на виртуалбоксе кстати не взлетел, нтстатус 0xC0000039, а на реальной тачке воркает<br>зы2<br>с хаспом у меня фокус не прошел, запросы разные, пошифрованы, код обфусцирован. сама дровина эмуля под вмпротом.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=321758&amp;user=18316&amp;forum_n=13&amp;topic=21208&amp;page=0&amp;anchor=30" class="addthx" data-post="321758"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=6336" title="28-03-2013 18:30, ранг:502.3" target="_blank">ARCHANGEL</a>, <a href="action=userinfo&user=24392" title="28-03-2013 18:50, ранг:2.5" target="_blank">unix3d</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=13&amp;topic=21208&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=21208&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вопрос знатокам кто сталкивался с TrusCont TSFD Protection Toolkit</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="21208">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=21208" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
