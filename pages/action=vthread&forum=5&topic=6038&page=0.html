<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>ASM-кодинг. Только для спецов! - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здорово! Вопрос такой: Допустим, есть прога на масм32, например (ну, это тупо для экзампла): .386 .model flat,stdcall ; модель памяти - flat option casemap:none ; подключение необходимых библиотек:">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=5602'>ut2004</a>, <a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> ASM-кодинг. Только для спецов!</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 августа 2006 22:47 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Здорово!
<br>Вопрос такой:
<br>Допустим, есть прога на масм32, например (ну, это тупо для экзампла):
<br>
<br>.386
<br>
<br>.model flat,stdcall ; модель памяти - flat
<br>option casemap:none
<br>
<br>; подключение необходимых библиотек:
<br>;-------------------------------------
<br>include &#92;masm32&#92;include&#92;windows.inc   ;
<br>include &#92;masm32&#92;include&#92;kernel32.inc  ;
<br>includelib &#92;masm32&#92;lib&#92;kernel32.lib   ;
<br>include &#92;masm32&#92;include&#92;user32.inc    ;
<br>includelib &#92;masm32&#92;lib&#92;user32.lib     ;
<br>;-------------------------------------
<br>
<br>; секция данных
<br>.data
<br>alert_upper  db &quot;Simply program&quot;,0
<br>alert_text   db &quot;Hello, World!&quot;,0
<br>
<br>; секция кода
<br>.code
<br>start:
<br>
<br>   invoke MessageBox, NULL, addr alert_text, addr alert_upper, MB_OK
<br>   invoke ExitProcess, NULL
<br>end start
<br>
<br>
<br>Допустим, я ее скомпилил и хочу впаять криптор. Передвигаю все инструкции на 2 байта, вставляю прыжок на конец основного кода, где и находится мой криптор-жучок:
<br>
<br>00401028     B9 35000000    MOV ECX,24
<br>0040102D     52             PUSH EDX
<br>0040102E     8B91 00104000  MOV EDX,[ECX+00401000]
<br>00401034     83F2 65        XOR EDX,65h
<br>00401037     8991 00104000  MOV [ECX+00401000],EDX
<br>0040103D    ^E2 E9          LOOP 00401028
<br>0040103F    ^EB C1          JMP 00401002&lt;&lt; Прыжок на ориг. код, когда всё готово
<br>
<br>Потом при помощи WinHex -а я ксорю по (65h) весь мой ассемблированный двоичный код (кроме распаковки, естественно), начиная с [OEP+2] и кончая [00401028h]. Потом все сохраняю и запускаю под сайсом или олейДБГ. 
<br>
<br>По идее, все должно работать, но на инструкции MOV [ECX+00401000],EDX все вываливается. Система ругается, что нельзя писать в память. В чем причина?
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=90176&amp;user=4825&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=1" class="addthx" data-post="90176"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Cigan[/b]','')">Cigan</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.89'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=208">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 августа 2006 22:50 <br><script type="text/javascript">QU('Cigan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Cigan" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Ну как вариант атрибуты секции надо дать на запись
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=90178&amp;user=208&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=2" class="addthx" data-post="90178"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Asterix[/b]','')">Asterix</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 450.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.26<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=58">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 августа 2006 22:57 &middot; Поправил: Asterix <br><script type="text/javascript">QU('Asterix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Asterix" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
секция кода по умолчанию не имеет атрибута writeable
<br>
<br>опередили %)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=90181&amp;user=58&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=3" class="addthx" data-post="90181"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]theCollision[/b]','')">theCollision</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 271.5 (наставник), 12thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.24'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4439">Участник</a><br><font color=blue>Packer Reseacher</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2006 00:28 <br><script type="text/javascript">QU('theCollision','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=theCollision" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>Crawler</b>
<br>Думал сверх сложный вопрос, зашел уму разуму поучиться, а оказалось-то... Обидно!
<br><br><font size="1"><i>-----<br>My love is very cool girl.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=90198&amp;user=4439&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=4" class="addthx" data-post="90198"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Rascal[/b]','')">Rascal</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/60.jpg" alt=""><br><span class=txtSm>Ранг: 260.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=60">Участник</a><br><font color=blue>John Smith</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2006 02:27 &middot; Поправил: Rascal <br><script type="text/javascript">QU('Rascal','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rascal" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Нда. Название топика явно не соответсвует содержимому. И нафига ручками? Напиши криптор нормальный, всё ж удобнее, да и опыта поднаберёшь. А то <b>&quot;ASM-кодинг. Только для спецов!&quot;</b>... Смех
<br>А по теме вопроса - да, секция не поволяет писать. Поправь атрибуты или пиши через WritePtocessMemory <img src="img/smilies/s5.gif" alt=""> <img src="img/smilies/s5.gif" alt="">
<br><br><font size="1"><i>-----<br>Недостаточно только получить знания:надо найти им приложение</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=90214&amp;user=60&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=5" class="addthx" data-post="90214"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2006 09:20 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Crawler</b>
<br> Лучше сюда загляни.
<br><a href="http://www.exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6021&amp;page=-1" target="_new">http://www.exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6021&amp;p age=-1</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=90245&amp;user=4072&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=6" class="addthx" data-post="90245"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2006 09:26 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Ну, тогда и я поддержу идею и дакучи спрошу у великих умов мира. <img src="img/smilies/s6.gif" alt="">
<br>
<br>Существует функция
<br>invoke GetProp,hWindow,ADDR szSubClassPtr
<br>mov ebx,eax
<br>все мы знаем, что она возвращает!
<br>в IDA:
<br>.text:004029D8 mov eax,[ebx+100h]; где ebx == результату, который возвратила GetProp
<br>.text:004029DE mov edi,[ebx+104h]
<br>
<br>Вопрос:
<br>Как в IDA организовать структуру, которая смогла бы заменить +100h на +hWindow, +104h на +hOldProc и т. д..? <img src="img/smilies/s11.gif" alt="">
<br>
<br>P. S.
<br>Требуется полный ответ раз такая тема да еще с таким громким названием. ;) <img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=90247&amp;user=4551&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=7" class="addthx" data-post="90247"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2006 17:07 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Мда...<img src="img/smilies/s9.gif" alt=""> Во - первых, я обнаружил у себя в проге баг.:
<br>0040103D: E2 E9 LOOP 0040102D, а не &quot;LOOP 00401028&quot;.
<br>Вот в том - то и дело, что задача заключается в том, чтобы писать свою функцию, неточная формулировка вопроса, это плохо <img src="img/smilies/s14.gif" alt="">
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=90307&amp;user=4825&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=8" class="addthx" data-post="90307"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2006 17:35 <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>Crawler пишет:
<br>Во - первых, я обнаружил у себя в проге баг </I> 
<br>А ты хотел сдвинуть код вот так вот в наглую и не подавиться?
<br>Почитай учебники или хотя бы Дневники чайника, а уже потом с вопросами к &quot;спецам&quot; обращайся.
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=90311&amp;user=410&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=9" class="addthx" data-post="90311"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 августа 2006 18:10 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Слушай, <b>Bitfry</b>, я ОБЪЯСНЯЮ ПОДРОБНО: таблицу импорта я сдвинул, ПЕРЕХОДЫ ПОПРАВИЛ, И, ЧТО САМОЕ ГЛАВНОЕ, компилировал с ключом &quot;/SECTION:.text, RWE&quot;. А вы тут обзываетесь ламером. Обидно.
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=90495&amp;user=4825&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=10" class="addthx" data-post="90495"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 августа 2006 18:39 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>Demon666 пишет:
<br>Как в IDA организовать структуру, которая смогла бы заменить +100h на +hWindow, +104h на +hOldProc и т. д..?  </I>
<br>
<br>Ого! Неужели никто не знает <b>Господа реверсеры</b>?
<br>Тогда дополню вопрос, чтобы понятнее было!
<br>
<br>Вот так это будет выглядеть на Masm32:
<br><I>Crawler пишет:
<br>например (ну, это тупо для экзампла):</I>
<br>.data
<br>GetSubClassPtr PROTO :DWORD
<br>
<br>LOAD_IMAGE  STRUCT
<br>hImageNormal dd 0
<br>hImageHot dd 0
<br>hImagePushed dd 0
<br>rect RECT &lt;&gt;
<br>LOAD_IMAGE ENDS
<br>
<br>szSubClassPtr db &#039;SubClassPtr&#039;,0
<br>
<br>.code
<br>------------[Создание структуры]------------------
<br>invoke GlobalAlloc,GMEM_ZEROINIT,SizeOf LOAD_IMAGE
<br>invoke SetProp,hWnd,ADDR szSubClassPtr,eax
<br>-----------[Заполнение структуры]-----------------
<br>invoke GetSubClassPtr,hWnd
<br>mov ebx,eax
<br>...
<br>invoke LoadIcon,hInstance,1
<br>mov (LOAD_IMAGE PTR [ebx]).hImageNormal,eax
<br>invoke LoadIcon,hInstance,2
<br>mov (LOAD_IMAGE PTR [ebx]).hImageHot,eax
<br>invoke LoadIcon,hInstance,3
<br>mov (LOAD_IMAGE PTR [ebx]).hImagePushed,eax
<br>invoke GetWindowRect,hWnd,ADDR (LOAD_IMAGE PTR [ebx]).rect
<br>...
<br>--------------[Удаление структуры]------------------
<br>invoke GetSubClassPtr,hWnd
<br>mov edi,eax
<br>...
<br>mov eax,(LOAD_IMAGE PTR [edi]).rect.right
<br>invoke DeleteObject,(LOAD_IMAGE PTR [edi]).hImageNormal
<br>invoke DeleteObject,(LOAD_IMAGE PTR [edi]).hImageHot
<br>invoke DeleteObject,(LOAD_IMAGE PTR [edi]).hImagePushed
<br>invoke GlobalFree,edi
<br>...
<br>-------------------[no comments ;)]------------------
<br>GetSubClassPtr Proc hWindow:HWND
<br>invoke GetProp,hWindow,ADDR szSubClassPtr
<br>ret
<br>GetSubClassPtr EndP
<br>
<br>А вот так будет выглядеть в IDA:
<br>-----------[Заполнение структуры]-----------------
<br>...
<br>.text:00401255 push 1
<br>.text:00401257 push hInstance
<br>.text:0040125D call LoadIconA
<br>.text:00401262 mov [ebx],eax
<br>.text:00401264 push 2
<br>.text:00401266 push hInstance
<br>.text:0040126C call LoadBitmapA
<br>.text:00401271 mov [ebx+4],eax
<br>.text:00401274 push 3
<br>.text:00401276 push hInstance
<br>.text:0040127C call LoadBitmapA
<br>.text:00401281 mov [ebx+8],eax
<br>.text:00401284 lea eax,[ebx+0Ch]
<br>.text:00401287 push eax
<br>.text:00401288 push [ebp+hWnd]
<br>.text:0040128B call GetWindowRect
<br>...
<br>--------------[Удаление структуры]------------------
<br>...
<br>.text:004012DA mov eax,[edi+14h]
<br>.text:004012DD push dword ptr [edi]
<br>.text:004012DF call DeleteObject
<br>.text:004012E4 push dword ptr [edi+4]
<br>.text:004012E7 call DeleteObject
<br>.text:004012EC push dword ptr [edi+8]
<br>.text:004012EF call DeleteObject
<br>.text:004012F4 push edi
<br>.text:004012F5 call GlobalFree
<br>...
<br>
<br><b>Что нужно сделать</b>, чтобы получилось в IDA вот так: <b>(!?)</b>
<br>-----------[Заполнение структуры]-----------------
<br>...
<br>.text:00401255 push 1
<br>.text:00401257 push hInstance
<br>.text:0040125D call LoadIconA
<br>.text:00401262 mov [ebx+<b>hImageNormal</b>],eax
<br>.text:00401264 push 2
<br>.text:00401266 push hInstance
<br>.text:0040126C call LoadBitmapA
<br>.text:00401271 mov [ebx+<b>hImageHot</b>],eax
<br>.text:00401274 push 3
<br>.text:00401276 push hInstance
<br>.text:0040127C call LoadBitmapA
<br>.text:00401281 mov [ebx+<b>hImagePushed</b>],eax
<br>.text:00401284 lea eax,[ebx+<b>rect</b>]
<br>.text:00401287 push eax
<br>.text:00401288 push [ebp+hWnd]
<br>.text:0040128B call GetWindowRect
<br>...
<br>--------------[Удаление структуры]------------------
<br>...
<br>.text:004012DA mov eax,[edi+<b>rect.right</b>]
<br>.text:004012DD push dword ptr [edi+<b>hImageNormal</b>]
<br>.text:004012DF call DeleteObject
<br>.text:004012E4 push dword ptr [edi+<b>hImageHot</b>]
<br>.text:004012E7 call DeleteObject
<br>.text:004012EC push dword ptr [edi+<b>hImagePushed</b>]
<br>.text:004012EF call DeleteObject
<br>.text:004012F4 push edi
<br>.text:004012F5 call GlobalFree
<br>...
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=90498&amp;user=4551&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=11" class="addthx" data-post="90498"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 августа 2006 20:50 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Спасибо, Demon666. Такое я никогда не забуду. Респект <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=90723&amp;user=4825&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=12" class="addthx" data-post="90723"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 августа 2006 11:33 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>Crawler</b> а адреса констант, указатели, фиксапы, FirstThunk,Name, ....?
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=90818&amp;user=3232&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=13" class="addthx" data-post="90818"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 августа 2006 12:56 &middot; Поправил: Crawler <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Все, все сделано! Я вообще ничего не понимаю! <img src="img/smilies/s13.gif" alt="">
<br>Кстати, вроде, под отладчиком атрибуты секции кода стоят RWE, сотней тулз все проверено,но все равно Access Violation!
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=90830&amp;user=4825&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=14" class="addthx" data-post="90830"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 августа 2006 14:50 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>Crawler</b>
<br>  По-моему проще было прицепить экзешник, чем зря говорить...
<br><I>Crawler пишет:
<br>Во - первых, я обнаружил у себя в проге баг.:  </I>
<br>  1) loop   40102e
<br>  2)  Я бы еще заменил  EDX  на   DL, хотя и так работает.
<br>
<br>
<br><I>Crawler пишет:
<br>Кстати, вроде, под отладчиком атрибуты секции кода стоят RWE, сотней тулз все проверено, </I>
<br> Если бы ты в loop  два раза не ошибся - я бы поверил. А так - труп в студию !
<br> Кстати, только что смотрел в олли - на всех секциях стоит Access - R,  Initial - RWE.
<br> Ни то, ни другое неверно. Секции кода были нормальные, а Access я сам лично поменял в RWE, т.к.
<br> получил сначала Access Violation.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=90841&amp;user=4072&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=15" class="addthx" data-post="90841"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 августа 2006 14:57 <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>Crawler пишет:
<br>Кстати, вроде, под отладчиком атрибуты секции кода стоят RWE </I>
<br><img src="img/smilies/s1.gif" alt="">
<br>Инструкция для специалистов:
<br>открой файл в hiew&#039;e, далее: F4,F4,F8,F6, на секции кода F3, на атрибутах F3, старший бит включить, F9,F9,F9,Esc,Esc.
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=90843&amp;user=410&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=16" class="addthx" data-post="90843"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 августа 2006 16:06 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>Bitfry пишет:
<br>далее: F4,F4,F8,F6 </I>
<br>  Блин! Скоко там оказывается еще команд есть ?! Никогда бы не подумал.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=90858&amp;user=4072&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=17" class="addthx" data-post="90858"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 августа 2006 19:13 <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>tundra37</b> и не говори <img src="img/smilies/s5.gif" alt="">
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=90890&amp;user=410&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=18" class="addthx" data-post="90890"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 августа 2006 23:19 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>tundra37 пишет:
<br>А так - труп в студию !</I>
<br>Согласен! Непонятно что дальше код будет творить после примера в первом посте?
<br><I>Crawler пишет:
<br>0040103D: E2 E9 LOOP 0040102D, а не &quot;LOOP 00401028&quot;. </I>
<br>А вообще, зачем 0040102D 52 PUSH EDX записывать в стек столько раз, потом стек выравнивается?
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=90982&amp;user=4551&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=19" class="addthx" data-post="90982"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 августа 2006 11:08 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>Demon666 пишет:
<br>потом стек выравнивается? </I>
<br> Нет конечно. Надо loop 40102e поставить. &quot;Акела промахнулся&quot; и видимо не только здесь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=91055&amp;user=4072&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=20" class="addthx" data-post="91055"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 августа 2006 16:38 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>tundra37 пишет:
<br>Секции кода были нормальные, а Access я сам лично поменял в RWE, т.к. 
<br>получил сначала Access Violation. </I>
<br>Я же говорю , что /SECTION RWE, читать внимательно надо.
<br><I>Bitfry пишет:
<br>Инструкция для специалистов: 
<br>открой файл в hiew&#039;e, далее: F4,F4,F8,F6, на секции кода F3, на атрибутах F3, старший бит включить, F9,F9,F9,Esc,Esc. </I>
<br>Не в этом проблема, комментарий тот же самый. 
<br>Экзешник не могу прицепить, да и не в этом дело, ведь даже на такой симпли-проге что-то коматозит. Может с памятью что? Я уж задолбся.
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=91124&amp;user=4825&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=21" class="addthx" data-post="91124"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 августа 2006 17:33 &middot; Поправил: Bitfry <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>Crawler пишет:<br>на инструкции MOV [ECX+00401000],EDX все вываливается. Система ругается, что нельзя писать в память. </I><br><I>Crawler пишет:<br>сотней тулз все проверено,но все равно Access Violation! </I><br><br>Если в ECX не больше VSize данной секции (выровненной до SAlignment) минус 1, то исключение Access Violation может возникнуть только по причине защиты от записи страниц данной секции. <br>А защиту от записи на страницы устанавливает загрузчик по значению старшего бита атрибутов секции. <br>Ведь потом не было никаких манипуляций типа Vprotect и т.п.?
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=91139&amp;user=410&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=22" class="addthx" data-post="91139"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 августа 2006 18:13 &middot; Поправил: Demon666 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>Crawler пишет:
<br>Может с памятью что? Я уж задолбся. </I>
<br>Память на целостность можно проверить при загрузке компа и если что-то с памятью, то у тебя не только вылетала бы твоя прожка но и система тоже показывала бы синий экран!
<br>
<br>
<br><I>tundra37 пишет:
<br>Нет конечно. Надо loop 40102e поставить. &quot;Акела промахнулся&quot; и видимо не только здесь. </I>
<br>Может у него после джампа идет ESP+24 и он из стека потом читает данные?
<br>Так для примера:
<br>invoke GetDC,hWindow
<br>push eax
<br>invoke SelectObject,[esp+4],hFont
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=91149&amp;user=4551&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=23" class="addthx" data-post="91149"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2006 07:56 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>Demon666 пишет:<br>Может у него после джампа идет ESP+24  </I><br> Он вообще про эту тему забыл и теперь SniperZ  обстреливает  <img src="img/smilies/s6.gif" alt=""><br> <a href="http://www.exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6021" target="_new">http://www.exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6021</a> <br>  Он добавил еще push  cx    и  перед командой  loop     добавил   два    pop-a<br>  Видимо справился с  RWE  и  теперь  ему  стыдно  <img src="img/smilies/s3.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=92247&amp;user=4072&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=24" class="addthx" data-post="92247"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2006 09:19 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>tundra37</b><br>да я уже здесь делал пост (повторение ниже) <br>пост исчез наверно из-за переезда сайта, но если кто-то удалил, то пусть обоснует, в чем я тут ниже неправ, а то недоразумение  какое-то получается!?<br>------------------------<br><b>tundra37</b><br>я после<br><I>Crawler пишет:<br>Допустим, есть прога на масм32, например (ну, это тупо для экзампла): </I><br>Даже не глянул, там можно для экспериментов тупо придумать что угодно, я имел в виду оригинал!<br><br>Ну, если так разбираться с вот этим куском кода: <br><I>Crawler пишет:<br>00401028 B9 35000000 MOV ECX,24 <br>0040102D 52 PUSH EDX <br>0040102E 8B91 00104000 MOV EDX,[ECX+00401000] <br>00401034 83F2 65 XOR EDX,65h <br>00401037 8991 00104000 MOV [ECX+00401000],EDX <br>0040103D ^E2 E9 LOOP 00401028 <br>0040103F ^EB C1 JMP 00401002&lt;&lt; Прыжок на ориг. код, когда всё готово </I><br><br>То тогда можно сделать вывод:<br>1.	естественно ошибка видна, ибо регистр ECX по основному коду имеет значение 24 (вечный цикл <img src="img/smilies/s5.gif" alt=""> )<br>2.	в стек ложится значение регистра EDX, отгадай, что произойдет, когда регистр ESP дойдет до нуля (если только дойдет <img src="img/smilies/s5.gif" alt=""> )<br>3.	Crawler утверждает, что все <b>OK!</b> И что секция с “правильными атрибутами”<br>Короче дальше не хочу описывать все, какие я должен сделать выводы?<br>Только одни, знания ассемблера <b>Crawler</b> на лицо!<br><br>P. S.<br>Поэтому тема и оказалась в <b>Вопросы новичков</b>! <br>----------------------------<br><b>tundra37</b><br>а разве 3- неравно 2+ <img src="img/smilies/s3.gif" alt="">
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=92259&amp;user=4551&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=25" class="addthx" data-post="92259"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 сентября 2006 05:02 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<b>Demon666</b><br> С этим переездом автор забыл все <img src="img/smilies/s2.gif" alt=""> Ошибки-то он уже исправил. А 3- ( даже двумя) просто по доброте.<br> А ошибку  LOOP 00401028  он исправил 21 августа, см. внимательней. Мне интересно, что же с RWE было ?!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=92410&amp;user=4072&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=26" class="addthx" data-post="92410"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 сентября 2006 17:40 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
Побудило сие написать одно сообщение в ЛС. <img src="img/smilies/s1.gif" alt=""><br>Инструкция как добавить новую структуру в IDA без скриптов!<br>1. Качаем IDA 5, где найти думаю, проблем не будет =)<br>2. Устанавливаем!<br>3. Запихиваем в IDA жертву, ждемс пока IDA выполнит свою грязную работу.<br>4. Потом в <b>меню-&gt; Windows-&gt; Structures (по умолчанию клавиши Alt+8) -&gt; F1</b> отроется хелп посвященный этому сабжу, читаем внимательно! Там все подробно описывается, в том числе и команды скри… (Подробнее чем там информации во всем Интернете не найти!)<br>5. Что требуется, <b>знание Английского!</b> ;)<br>6. Все!
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=93565&amp;user=4551&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=27" class="addthx" data-post="93565"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Crawler[/b]','')">Crawler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4825.jpg" alt=""><br><span class=txtSm>Ранг: 216.9 (наставник), 85thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.31<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=4825">Участник</a><br><font color=blue>X-Literator</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2006 12:23 <br><script type="text/javascript">QU('Crawler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crawler" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6038.html&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
Тундра зач0т. Это был аццкий отжег, и если модеры хотят, они могут сделать мне -1000 рангу.<img src="img/smilies/s14.gif" alt=""> <img src="img/smilies/s14.gif" alt=""> <img src="img/smilies/s14.gif" alt=""> <img src="img/smilies/s14.gif" alt="">
<br><br><font size="1"><i>-----<br>Харе курить веники и нюхать клей, к вам едет из Америки бог Шива, и он еврей.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=94920&amp;user=4825&amp;forum_n=5&amp;topic=6038.html&amp;page=0&amp;anchor=28" class="addthx" data-post="94920"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> ASM-кодинг. Только для спецов!</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=6038" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
