<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Неочевидные фичи иды - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="В IDA есть много прикольных штук, которые добавляются втихую. И натыкаешься на них только случайно. Давайте постить всякие неочевидные фичи иды сюда. Только с пояснениями как пользоваться, а не просто названия меню. Фича номер">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Неочевидные фичи иды</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2009 15:36 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
В IDA есть много прикольных штук, которые добавляются втихую. И натыкаешься на них только случайно. Давайте постить всякие неочевидные фичи иды сюда. Только с пояснениями как пользоваться, а не просто названия меню.<br><br>Фича номер раз: &quot;Create Struct from Data&quot;<br><br>Позволяет создать структуру (в окне структур) по данным. Например были данные:<br>RAM:300A0E58 DCW 0x203<br>RAM:300A0E5A DCD 0x4050102<br>RAM:300A0E5E DCW 0x304<br>RAM:300A0E60 DCD 0x2030304<br><br>Выделяем эти данные и заходим в меню &quot;edit&quot; - &quot;structs&quot; - &quot;Create Struct from Data&quot;.<br>Вуаля! Получаем структуру:<br>00000000 struct_0 struc ; (sizeof=0xC)<br>00000000 anonymous_0 DCW ?<br>00000002 anonymous_1 DCD ?<br>00000006 anonymous_2 DCW ?<br>00000008 anonymous_3 DCD ?<br>0000000C struct_0 ends<br><br>Остается только проименовать поля. <br><br>Офигенно помагает когда нужно восставливать таблицу виртуальных функций. Выделил весь массив - и готово. Не надо руками вбивать.
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=218208&amp;user=10168&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=1" class="addthx" data-post="218208"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2009 15:59 &middot; Поправил: Hexxx <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Фича номер два: &quot;Manual operand&quot;<br><br>Казалось бы ну нафига нужно вбивать операнды вручную? Что это дает? Ну изменится отображение, а дальше?<br><br>А дальше оказывается что IDA анализирует manual operand&#039;ы на предмет имен уже встречающихся в базе. То есть если сделать Manual Operand и в качестве текста вбить имя ASCII константы, имя глобальной переменной или имя функции, то IDA автоматом проставит XREF. А для ASCII проставит комент. <br><br>Как это работает:<br>Ставим курсор на операнд и нажимаем Alt-F1. Вылазит окно куда можно вбить текст операнда. <br><br>Пример. <br>Есть вот такой код:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R0<span class="hl_char">,</span>&nbsp;<span class="hl_char">=</span>aSmErr_allocfreeunitNlunDN&nbsp;<span class="hl_comment">; 0x102DD6F4</span></li><li class="hl_l1">LDRH&nbsp;&nbsp;&nbsp;&nbsp;R2<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R4<span class="hl_char">,</span>#4<span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; nVun</span></li><li class="hl_l0">LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">SP</span><span class="hl_char">,</span>#0x30<span class="hl_char">+</span>Id1<span class="hl_char">]</span>&nbsp;<span class="hl_comment">; nLun</span></li><li class="hl_l1"><span class="hl_function"><b>ADD</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R0<span class="hl_char">,</span>&nbsp;#0x3C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; pString</span></li><li class="hl_l0">BLX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OAM_Debug_thunk_TA</li>        </ol>
    </div>
</div></div>
<br><br>Здесь через R0 передают указатель на текст дебажного сообщения, но адрес текста вычисляется относительно адреса какой-то строковой константы. В нашем случае идет обращение к строке по адресу 0x102DD6F4 + 0x3C = 0x102DD730<br>Вот собственно строка:<br>102DD730 aSmErr_allocfreeunitNlun_0 DCB &quot;[SM :ERR] _AllocFreeUnit(nLun:%d, nVun:%d) : Erase fail!&quot;,0xD<br><br>Имя у этой константы = aSmErr_allocfreeunitNlun_0<br>Теперь сделаем Manual Operand вот такой:<br>ADD     R0, aSmErr_allocfreeunitNlun_0<br><br>На выходе получаем:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R0<span class="hl_char">,</span>&nbsp;<span class="hl_char">=</span>aSmErr_allocfreeunitNlunDN</li><li class="hl_l1">LDRH&nbsp;&nbsp;&nbsp;&nbsp;R2<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R4<span class="hl_char">,</span>#4<span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; nVun</span></li><li class="hl_l0">LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">SP</span><span class="hl_char">,</span>#0x30<span class="hl_char">+</span>Id1<span class="hl_char">]</span>&nbsp;<span class="hl_comment">; nLun</span></li><li class="hl_l1"><span class="hl_function"><b>ADD</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R0<span class="hl_char">,</span>&nbsp;aSmErr_allocfreeunitNlun_0&nbsp;<span class="hl_comment">; &quot;[SM :ERR] _AllocFreeUnit(nLun:%d, nVun:&quot;...</span></li><li class="hl_l0">BLX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OAM_Debug_thunk_TA</li>        </ol>
    </div>
</div></div>
<br><br>+ автоматом был проставлен xref на адрес  102DD730 с 11308BDA
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=218363&amp;user=10168&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=2" class="addthx" data-post="218363"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b][wl][/b]','')">[wl]</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/2760.jpg" alt=""><br><span class=txtSm>Ранг: 196.6 (ветеран), 11thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.76'>Активность: 0.07<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2760">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2009 22:43 <br><script type="text/javascript">QU('[wl]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[wl]" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
как сделать настройку Options/Demangled names.../(о) Names, [x] Assume GCC v3.x names - настройкой по умолчанию?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218409&amp;user=2760&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=3" class="addthx" data-post="218409"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2009 23:38 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>[wl] пишет:<br>как сделать настройку Options/Demangled names.../(о) Names, [x] Assume GCC v3.x names - настройкой по умолчанию? </I><br>В ida.cfg сделай вот так:<br>ShortNameForm   =       0x0EA3BE6F      <br>LongNameForm    =       0x0640000F <br>DemangleNames   = DEMNAM_NAME
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=218415&amp;user=10168&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=4" class="addthx" data-post="218415"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Getorix[/b]','')">Getorix</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1541.jpg" alt=""><br><span class=txtSm>Ранг: 209.5 (наставник), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.28'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1541">Участник</a><br><font color=blue>WinCE ARM M@sTeR</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 января 2009 01:34 <br><script type="text/javascript">QU('Getorix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Getorix" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<i class=x>Потому что я аццкий флудер, и постю всякую херню ради рейтинга.</i><br>Жжошь ваще <img src="img/smilies/s1.gif" alt=""><br><br>А если по делу, не мог бы ты описать тут такую неочевидную фичу как &quot;создание битовых поля&quot;. Помню ты говорил что разобрался с ними по мануалам, я думаю многим было бы интересно (у мну так и не вышло). <br><br>P.S. Тебе кстати ваще уже пора книгу по IDA писать типа &quot;IDA Unleashed&quot; или &quot;ПоIDAние бинарников&quot;...
<br><br><font size="1"><i>-----<br>Get busy living or get busy dying ©</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=218423&amp;user=1541&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=5" class="addthx" data-post="218423"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 января 2009 05:27 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
не в тему немного  <img src="img/smilies/s1.gif" alt=""><br>January 20, 2009<br>IDA v5.4 release is not that far away<br><br>I&#039;m happy to inform you that we are entering the beta stage of IDA v5.4!<br><br>In addition to numerous small and not that small improvements, the new version will have hree debugger modules: bochs, gdb, and windbg, selectable on the fly (the active debugger session will be closed, though ;))<br><br>With the bochs debugger, we offer three different worlds: run-any-code-snippet facility, windows-like-environment for PE files, and any-bochs-image bare-bone machine emulation mode. You can read more about this module in our blog: hexblog.com/2008/11/bochs_plugin_goes_alpha.html<br>With gdb, x86 and arm targets are supported. Among other things, it is possible to connect IDA to QEMU or debug a virtual machine inside VMWare. We tried it iPhone as well. However, while it works in some curcimstances, there were some problems on the gdbserver side.<br>With windbg, user and kernel mode debugging is available. The debugger engine from Microsoft, which is currently the only choice for driver and kernel mode debugging, can be used from IDA. It can automatically load required PDB files and populate the listing with meaningful names, types, etc. Speaking of PDB files, IDA imports more information from them: local function variables and types are retrieved too, c++ base classes are handled, etc.<br><br>The gdb and windbg debugger modules support local and remote debugging. We tried to make the debugger modules as open as possible: target-specific commands can be sent to all backend engines in a very easy and user-friendly way.<br><br>As usual, better analysis and many minor changes have been made. If you spend plenty of time analyzing gcc generated binaries, you&#039;ll certainly appreciate that IDA handles its weird way of preparing outgoing function arguments. Now it can trace and find arguments copies to the stack with mov statements.<br><br>The new IDA will support Python out of box, thanks to Gergely Erdelyi, who kindly agreed the Python plugin to be included in the official distribution. In fact, the main IDA window will have a command line to enter any python (or other language) expressions and immediately get a result in the message window.<br><br>We will prepare the detailed list of improvements later this week.<br><br>Posted by Ilfak Guilfanov at 01:29 AM
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218433&amp;user=293&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=6" class="addthx" data-post="218433"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 января 2009 15:56 &middot; Поправил: Hexxx <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Фича номер три: &quot;Bitfield и маски&quot;<br><br>Полезная штука, только очень криво реализована, потому почти никто ей непользуется <img src="img/smilies/s1.gif" alt=""><br>Битовое поле в IDA сделать очень просто, надо при создании enum&#039;a просто указать птичку &quot;Bitfield&quot;. Дальше IDA будет следить за тем, чтобы каждое поле такого энума было степенью двойки. Т.е. возможнные значения для полей будут 1, 2, 4, 8, 16, 32 и т.д.<br><br>Например есть код:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>pDEVICE_OBJECT<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span>IO_STACK_LOCATION<span class="hl_char">.</span>CompletionRoutine<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;BrbpIrpSyncCompletionRoutine<span class="hl_char">(</span>x<span class="hl_char">,</span>x<span class="hl_char">,</span>x<span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span>IO_STACK_LOCATION<span class="hl_char">.</span>Context<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;ecx</li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span>IO_STACK_LOCATION<span class="hl_char">.</span>Control<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;0E0h</li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>pDeviceExtension<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">34h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;ebx</li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>__declspec<span class="hl_char">(</span>dllimport<span class="hl_char">)</span>&nbsp;IofCallDriver<span class="hl_char">(</span>x<span class="hl_char">,</span>x<span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br><br><br>поле IO_STACK_LOCATION.Control - это битовое поле. Если загрузить соответствующий энум:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00000001</span>&nbsp;<span class="hl_comment">; enum MACRO_SL (bitfield)</span></li><li class="hl_l1"><span class="hl_number">00000001</span>&nbsp;SL_PENDING_RETURNED&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;1</li><li class="hl_l0"><span class="hl_number">00000020</span>&nbsp;SL_INVOKE_ON_CANCEL&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;20h</li><li class="hl_l1"><span class="hl_number">00000040</span>&nbsp;SL_INVOKE_ON_SUCCESS&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;40h</li><li class="hl_l0"><span class="hl_number">00000080</span>&nbsp;SL_INVOKE_ON_ERROR&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">80h</span></li>        </ol>
    </div>
</div></div>
<br><br>То можем наблюдать отображение вот в таком виде:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span>IO_STACK_LOCATION<span class="hl_char">.</span>Control<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;SL_INVOKE_ON_CANCEL&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;SL_INVOKE_ON_SUCCESS&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;SL_INVOKE_ON_ERROR</li>        </ol>
    </div>
</div></div>
<br><br>Мне например такое отображение не нравится. Я хочу чтобы вместо трех значений было одно. <br>Хочу чтобы была маска SL_INVOKE_ALWAYS = SL_INVOKE_ON_CANCEL or SL_INVOKE_ON_SUCCESS or SL_INVOKE_ON_ERROR.<br><br>Как сделать такую маску?<br>Для существующего enum&#039;a сделать такую маску уже не получится. Потому что маску надо создавать первой, до создания самих элементов которые в нее входят. Вот такое ограничение в IDA. Поэтому придетcя делать новый битфилд. <br><br>Создавать битфилд надо начинать с создания маски. <br>Создаем новый энум и добавлем поле самой маски. Делается это вот так:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Name<span class="hl_char">:</span>&nbsp;SL_INVOKE_ALWAYS</li><li class="hl_l1">Value<span class="hl_char">:</span>&nbsp;0xE0</li><li class="hl_l0">Mask<span class="hl_char">:</span>&nbsp;0xE0</li><li class="hl_l1">Mask&nbsp;Name<span class="hl_char">:</span>&nbsp;SL_INVOKE_ALWAYS_MASK</li>        </ol>
    </div>
</div></div>
<br>Если не ясно см скриншот:<br><img src="http://pic.ipicture.ru/uploads/090120/2K9uspk4mn.jpg" border="0" align="" alt=""><br><br>Получится вот такой битфилд:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">000000E0</span>&nbsp;<span class="hl_comment">; enum MACRO_SL_MY (bitfield)</span></li><li class="hl_l1"><span class="hl_number">000000E0</span>&nbsp;SL_INVOKE_ALWAYS_MASK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;0E0h</li><li class="hl_l0"><span class="hl_number">000000E0</span>&nbsp;SL_INVOKE_ALWAYS&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0E0h</span></li>        </ol>
    </div>
</div></div>
<br><br>Дальше добиваем остальные части битфилда. Для каждого из полей которые входят в маску <b><u>надо</u></b> указывать:<br>Mask: 0xE0<br>Mask Name: SL_INVOKE_ALWAYS_MASK<br>Если не ясно см скриншот:<br><img src="http://pic.ipicture.ru/uploads/090120/7i276BUhtH.jpg" border="0" align="" alt=""><br><br>Какие поля попадают в маску? В нашем случае это SL_INVOKE_ON_CANCEL, SL_INVOKE_ON_SUCCESS и SL_INVOKE_ON_ERROR.<br>Поле SL_PENDING_RETURNED не входит в маску 0xE0. Потому что 1 &amp; 0xE0 = 0. В маску входят долько поля для которых<br>&quot;логическое и&quot; с 0xE0 = само значение поля.<br>То есть: <br>0x20 &amp; 0xE0 = 0x20<br>0x40 &amp; 0xE0 = 0x40<br>0x80 &amp; 0xE0 = 0x80<br><br>Я все это к тому, что для поля SL_PENDING_RETURNED маску не ставим. <br><br>Получается вот такой enum:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00000001</span>&nbsp;<span class="hl_comment">; enum MACRO_SL_MY (bitfield)</span></li><li class="hl_l1"><span class="hl_number">00000001</span>&nbsp;SL_PENDING_RETURNED_MY&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;1</li><li class="hl_l0"><span class="hl_number">000000E0</span>&nbsp;SL_INVOKE_ALWAYS_MASK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;0E0h</li><li class="hl_l1"><span class="hl_number">000000E0</span>&nbsp;SL_INVOKE_ON_CANCEL_MY&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;20h</li><li class="hl_l0"><span class="hl_number">000000E0</span>&nbsp;SL_INVOKE_ON_SUCCESS_MY&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;40h</li><li class="hl_l1"><span class="hl_number">000000E0</span>&nbsp;SL_INVOKE_ON_ERROR_MY&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;80h</li><li class="hl_l0"><span class="hl_number">000000E0</span>&nbsp;SL_INVOKE_ALWAYS&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0E0h</span></li>        </ol>
    </div>
</div></div>
<br><br><br>Применяем:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>pDEVICE_OBJECT<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span>IO_STACK_LOCATION<span class="hl_char">.</span>CompletionRoutine<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;BrbpIrpSyncCompletionRoutine<span class="hl_char">(</span>x<span class="hl_char">,</span>x<span class="hl_char">,</span>x<span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span>IO_STACK_LOCATION<span class="hl_char">.</span>Context<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;ecx</li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span>IO_STACK_LOCATION<span class="hl_char">.</span>Control<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;SL_INVOKE_ALWAYS</li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>pDeviceExtension<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">34h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;ebx</li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>__declspec<span class="hl_char">(</span>dllimport<span class="hl_char">)</span>&nbsp;IofCallDriver<span class="hl_char">(</span>x<span class="hl_char">,</span>x<span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br><br>проверяем, как работают другие части энума. Если применить наш энум на значении 0xE1, то IDA отобразит его вот так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">SL_PENDING_RETURNED_MY&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;SL_INVOKE_ALWAYS</li>        </ol>
    </div>
</div></div>
<br><br>Но что будет если попытаться применить энум на значении 0xA0? <br>Поидее должно бы показать:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">SL_INVOKE_ON_CANCEL_MY&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;SL_INVOKE_ON_ERROR_MY</li>        </ol>
    </div>
</div></div>
<br>Но фиг вам! Просто пометит красным, как будто мы применили энум на значении, которого нет в энуме. <br>Так и есть, когда мы указали маску, IDA перестает совмещать значения, которые находятся в пределах маски SL_INVOKE_ALWAYS_MASK. <br>Значение 0xA0 - как раз входит в маску 0xE0. И чтобы 0xA0 хоть как-то отображалось придется создать еще одно поле в энуме:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Name<span class="hl_char">:</span>&nbsp;SL_INVOKE_ON_CANCEL_OR_ERROR</li><li class="hl_l1">Value<span class="hl_char">:</span>&nbsp;0xA0</li><li class="hl_l0">Mask<span class="hl_char">:</span>&nbsp;0xE0</li><li class="hl_l1">Mask&nbsp;Name<span class="hl_char">:</span>&nbsp;SL_INVOKE_ALWAYS_MASK</li>        </ol>
    </div>
</div></div>
<br><br>p.s. Судя по IDA 5.4 Ильфака подменили. Я думал что все фишки в 5.3 - это редкое озарение. А тут снова столько всяких полезных вещей добавил 0_o. Даже купить захотелось <img src="img/smilies/s6.gif" alt=""> Но я крепкий и сдержусь <img src="img/smilies/s5.gif" alt="">
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=218470&amp;user=10168&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=7" class="addthx" data-post="218470"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]__[/b]','')">__</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.1 (ветеран), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.73'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7172">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 января 2009 18:00 <br><script type="text/javascript">QU('__','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=__" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Hexxx пишет:<br>Судя по IDA 5.4 Ильфака подменили. </I><br><br>судя по всему и по некоторым сообщениям Ильфака на форуме он сейчас координирует проект<br>а разработкой занимается команда, аля Солодовников )
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218483&amp;user=7172&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=8" class="addthx" data-post="218483"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 января 2009 22:39 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
&gt;То можем наблюдать отображение вот в таком виде: <br>и дальше невидная форма<br>то глюк или у меня екплоер так показывает?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218509&amp;user=15381&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=9" class="addthx" data-post="218509"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 января 2009 23:02 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>reversecode пишет:<br>и дальше невидная форма </I><br>Там было:<br>mov     [eax+IO_STACK_LOCATION.Control], SL_INVOKE_ON_CANCEL or SL_INVOKE_ON_SUCCESS or SL_INVOKE_ON_ERROR<br><br>В опере нормально все видно.
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=218510&amp;user=10168&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=10" class="addthx" data-post="218510"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2009 14:54 &middot; Поправил: Hexxx <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Фича №4. Русские символы.<br><br>Поумолчанию IDA заточена для буржуинов. Поэтому вместо русского языка, можно наблюдать вот такое:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">0041573C</span>&nbsp;unk_41573C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">0CFh</span>&nbsp;<span class="hl_comment">; ¦             ; DATA XREF: _wmain+20o</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">0041573D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">0F0h</span>&nbsp;<span class="hl_comment">; &amp;#168;</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">0041573E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">0E5h</span>&nbsp;<span class="hl_comment">; &amp;#245;</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">0041573F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">0E2h</span>&nbsp;<span class="hl_comment">; &amp;#242;</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">00415740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">0E5h</span>&nbsp;<span class="hl_comment">; &amp;#245;</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">00415741</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">0E4h</span>&nbsp;<span class="hl_comment">; &amp;#244;</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">00415742</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;&nbsp;<span class="hl_number">21h</span>&nbsp;<span class="hl_comment">; !</span></li>        </ol>
    </div>
</div></div>
<br><br>Не весело вообще. Исправляется через правку таблицы перекодирования в файле ida.cfg:<br>По умолчанию там стоит вот эта:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_char">(</span>trivial&nbsp;translation&nbsp;<span class="hl_char">-</span>&nbsp;no&nbsp;changes<span class="hl_char">)</span></li><li class="hl_l1">XlatAsciiOutput&nbsp;<span class="hl_char">=</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">00</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">0F</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0A\x0B\x0C\x0D\x0E\x0F&quot;</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">10</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">1F</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1A\x1B\x1C\x1D\x1E\x1F&quot;</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">20</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">2F</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f&quot;</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br>ее надо всю закоментить, т.е.  добавить // вначале каждой строки. <br>И раскоментить следующую таблицу:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;translation&nbsp;table&nbsp;for&nbsp;win1251&nbsp;encoding</li><li class="hl_l1">&nbsp;XlatAsciiOutput&nbsp;<span class="hl_char">=</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">00</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">0F</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f&quot;</span></li><li class="hl_l1">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">10</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">1F</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f&quot;</span></li><li class="hl_l0">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">20</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">2F</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f&quot;</span></li><li class="hl_l1">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">30</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">3F</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f&quot;</span></li><li class="hl_l0">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">40</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">5F</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f&quot;</span></li><li class="hl_l1">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">50</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">5F</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f&quot;</span></li><li class="hl_l0">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">60</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">6F</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f&quot;</span></li><li class="hl_l1">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">70</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">7F</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f&quot;</span></li><li class="hl_l0">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">80</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">8F</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\x3f\x3f\x27\x3f\x22\x3a\xc5\xd8\x3f\x25\x3f\x3c\x3f\x3f\x3f\x3f&quot;</span></li><li class="hl_l1">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">90</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">9F</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\x3f\x27\x27\x22\x22\x07\x2d\x2d\x3f\x54\x3f\x3e\x3f\x3f\x3f\x3f&quot;</span></li><li class="hl_l0">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>A0<span class="hl_char">.</span><span class="hl_char">.</span>AF<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\xff\xf6\xf7\x3f\xfd\x3f\xb3\x15\xf0\x63\xf2\x3c\xbf\x2d\x52\xf4&quot;</span></li><li class="hl_l1">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>B0<span class="hl_char">.</span><span class="hl_char">.</span>BF<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\xf8\x2b\x49\x69\x3f\xe7\x14\xfa\xf1\xfc\xf3\x3e\x3f\x3f\x3f\xf5&quot;</span></li><li class="hl_l0">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>C0<span class="hl_char">.</span><span class="hl_char">.</span>CF<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f&quot;</span></li><li class="hl_l1">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>D0<span class="hl_char">.</span><span class="hl_char">.</span>DF<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f&quot;</span></li><li class="hl_l0">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>E0<span class="hl_char">.</span><span class="hl_char">.</span>EF<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf&quot;</span></li><li class="hl_l1">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>F0<span class="hl_char">.</span><span class="hl_char">.</span>FF<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_quote">&quot;\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef&quot;</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>После этого можно будет видеть русские символы:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">0041573C</span>&nbsp;unk_41573C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">0CFh</span>&nbsp;<span class="hl_comment">; П             ; DATA XREF: _wmain+20o</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">0041573D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">0F0h</span>&nbsp;<span class="hl_comment">; р</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">0041573E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">0E5h</span>&nbsp;<span class="hl_comment">; е</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">0041573F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">0E2h</span>&nbsp;<span class="hl_comment">; в</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">00415740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">0E5h</span>&nbsp;<span class="hl_comment">; е</span></li><li class="hl_l1"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">00415741</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">0E4h</span>&nbsp;<span class="hl_comment">; д</span></li><li class="hl_l0"><span class="hl_char">.</span>rdata<span class="hl_char">:</span><span class="hl_number">00415742</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;&nbsp;<span class="hl_number">21h</span>&nbsp;<span class="hl_comment">; !</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=220091&amp;user=10168&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=11" class="addthx" data-post="220091"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]vptrlx[/b]','')">vptrlx</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 56.1 (постоянный), 9thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.91'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22056">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 января 2010 01:35 &middot; Поправил: vptrlx <br><script type="text/javascript">QU('vptrlx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vptrlx" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
&gt;&gt;Фича номер два: &quot;Manual operand&quot;<br><br>(Может я конечно расскажу о велосипеде, но) есть ещё одна похожая фича:<br>пусть есть кодес типа такого:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">10h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">0Ch</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">10h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">14h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_12345</li>        </ol>
    </div>
</div></div>
<br><br>Но мы знаем, что функция sub_12345 - это jmp ReadFile, хотя как такая не определяется например из-за того, что код - это нерабочий дамп какого-нибудь прота без восстановленного импорта и тп.<br>Если теперь выделить sub_12345, нажать &quot;n&quot; и написать название ReadFile, а затем, когда ида спросит, не хотим ли мы добавить к столь необычному названию &quot;a numerical suffix&quot;, согласиться с предложением, то (в данном случае) она автоматом добавит комментарии, а если бы я выбрал пример поудачнее, то и переменные бы переименовала и функцию бы подправила:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">10h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">0Ch</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>edx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; lpOverlapped</span></li><li class="hl_l0"><span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">10h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>edx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; lpNumberOfBytesRead</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; nNumberOfBytesToRead</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">14h</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; lpBuffer</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; hFile</span></li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;ReadFile_0</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=250072&amp;user=22056&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=12" class="addthx" data-post="250072"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]s0l[/b]','')">s0l</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 60.6 (постоянный), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.96'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=21841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 января 2010 05:32 <br><script type="text/javascript">QU('s0l','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0l" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Такой вопрос к Вам, о гуру ИДЫ:<br>Допустим есть такой участок кода:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004300C2</span>&nbsp;&nbsp;&nbsp;&nbsp;F0<span class="hl_char">:</span><span class="hl_number">04</span>&nbsp;<span class="hl_number">14</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LOCK</b></span>&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">AL</span><span class="hl_char">,</span><span class="hl_number">14</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; LOCK prefix is not allowed</span></li><li class="hl_l1"><span class="hl_number">004300C5</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">004300C6</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">880C54</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_registr">EDX</span><span class="hl_char">*</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">CL</span></li><li class="hl_l1"><span class="hl_number">004300C9</span>&nbsp;&nbsp;&nbsp;&nbsp;DFDE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>FISTP</b></span>&nbsp;<span class="hl_registr"><b>ESI</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; Illegal use of register</span></li><li class="hl_l0"><span class="hl_number">004300CB</span>&nbsp;&nbsp;&nbsp;&nbsp;BE&nbsp;BD0814FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ESI</span><span class="hl_char">,</span>FF1408BD</li><li class="hl_l1"><span class="hl_number">004300D0</span>&nbsp;&nbsp;&nbsp;&nbsp;D319&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RCR</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ECX</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">CL</span></li><li class="hl_l0"><span class="hl_number">004300D2</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">04397D71</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">71C039DB</span></li><li class="hl_l1"><span class="hl_number">004300D7</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8C77</span>&nbsp;FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">,</span>SEG<span class="hl_char">?</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Undefined segment register</span></li><li class="hl_l0"><span class="hl_number">004300DA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0083</span>&nbsp;<span class="hl_number">7E58FF14</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBX</span><span class="hl_char">+</span><span class="hl_number">14FF587E</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">AL</span></li><li class="hl_l1"><span class="hl_number">004300E0</span>&nbsp;&nbsp;&nbsp;&nbsp;BA&nbsp;<span class="hl_number">9DFB7465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_number">6574FB9D</span></li><li class="hl_l0"><span class="hl_number">004300E5</span>&nbsp;&nbsp;&nbsp;&nbsp;FF76&nbsp;<span class="hl_number">34</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESI</span><span class="hl_char">+</span><span class="hl_number">34</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">004300E8</span>&nbsp;&nbsp;&nbsp;&nbsp;BD&nbsp;<span class="hl_number">3585C033</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EBP</span><span class="hl_char">,</span><span class="hl_number">33C08535</span></li>        </ol>
    </div>
</div></div>
<br>Можно ли при создании асм-файла(File-&gt;Produce file...-&gt;asm file) заставить иду захватывать и функции которые вызываются из выделенного участка. В данном случае это <b>004300D2    E8 04397D71     CALL 71C039DB</b>. А то уж очень не приятно по кусочкам (:
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=250077&amp;user=21841&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=13" class="addthx" data-post="250077"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 января 2010 11:43 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>s0l пишет:<br>Можно ли при создании асм-файла(File-&gt;Produce file...-&gt;asm file) заставить иду захватывать и функции которые вызываются из выделенного участка.  </I><br>Только если сделать скрипт, который будет рекурсивно это(вывод асма в файл) делать. Я когда-то такой делал, он по инету разошелся.
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=250085&amp;user=10168&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=14" class="addthx" data-post="250085"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 мая 2010 21:28 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
теперь не найти. Но в общем там ничего сложного: идешь по функции, собираешь все ее ветвления и xref&#039;ы на данные, и дальше через GenerateFile(OFILE_ASM,...) выписываешь по порядку все подфункции и данные. Чтобы не было повторов ставишь на пройденой функции коммент, например &quot;1&quot;. Когда заходишь в функцию, проверяешь есть ли у нее комент &quot;1&quot;, если есть - скипаешь, если нет - выписываешь в файл.<br><br>Еще я делал чтобы код писался в один файл, а данные в другой. А потом их соединял. Так проще, чтобы не трахаться с объявлениями.
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=257838&amp;user=10168&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=15" class="addthx" data-post="257838"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 мая 2010 06:54 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Тема почищена, зачинщик (VodoleY) отбанен на три дня.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=257866&amp;user=2449&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=16" class="addthx" data-post="257866"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 марта 2011 02:00 &middot; Поправил: Hexxx <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Фича номер пять: &quot;местное переименование регистра&quot;<br><br>Если выбрать регистр в пределах фунции и нажать на нем &#039;N&#039;, то можно его переименовать. И в пределах всей функции вместо привычного esi будет This:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">sub_443F70&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">var_C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">-</span><span class="hl_number">0Ch</span></li><li class="hl_l1">var_4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">-</span><span class="hl_number">4</span></li><li class="hl_l0">arg_8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">0Ch</span></li><li class="hl_l1">arg_C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">10h</span></li><li class="hl_l0">arg_10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">14h</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>This</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0FFFFFFFFh</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;loc_466D18</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;large&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_number">0</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">This</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;dword_487050</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">1Ch</span><span class="hl_char">+</span>var_C<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;large&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">This</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">1Ch</span><span class="hl_char">+</span>arg_8<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_443FD7</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_function">This</span><span class="hl_char">+</span><span class="hl_number">0D20h</span><span class="hl_char">]</span><span class="hl_char">,</span></li>        </ol>
    </div>
</div></div>
<br>Про это знают все. И это вообще никак не помогает в случае, когда сначала регистр используется для хранения указателя на одну структуру, а потом на другую, и все в пределах одной функции. <br>Для этого используется фича &quot;местного переименования&quot;:<br>1) выделяем нужный кусок кода<br>2) нажимаем &#039;V&#039;, вылазит окно &quot;Rename Register&quot;<br>3) в поле Old Name - пишем имя регистра, который надо переименовать<br>4) в поле New Name - новое имя <br>получаем:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>context<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FFFFFFCEh</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;@@end</li><li class="hl_l0">AppleKeychainExtra&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>&nbsp;<span class="hl_char">(</span>alloc&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1461h</span><span class="hl_char">)</span><span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>&nbsp;<span class="hl_char">(</span>NSAutoreleasePool&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1461h</span><span class="hl_char">)</span><span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;_objc_msgSend</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>&nbsp;<span class="hl_char">(</span>init&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1461h</span><span class="hl_char">)</span><span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;_objc_msgSend</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>&nbsp;<span class="hl_char">(</span>updateMenuState&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1461h</span><span class="hl_char">)</span><span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;AppleKeychainExtra</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;_objc_msgSend</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>&nbsp;<span class="hl_char">(</span>release&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1461h</span><span class="hl_char">)</span><span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;_objc_msgSend</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">@@end<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_C<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_8<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_4<span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br>edi был переименован в AppleKeychainExtra после jz      short @@end, и переименование актуально до  @@end
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=278724&amp;user=10168&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=17" class="addthx" data-post="278724"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=7090" title="09-03-2011 00:29, ранг:5.3" target="_blank">Vintersorg</a>, <a href="action=userinfo&user=3650" title="09-03-2011 08:55, ранг:30.5" target="_blank">Fallout</a>, <a href="action=userinfo&user=28195" title="09-03-2011 09:12, ранг:3.5" target="_blank">rr222</a>, <a href="action=userinfo&user=3520" title="09-03-2011 11:08, ранг:510.7" target="_blank">mak</a>, <a href="action=userinfo&user=25470" title="09-03-2011 13:15, ранг:6.8" target="_blank">int 26h</a>, <a href="action=userinfo&user=68" title="10-03-2011 09:38, ранг:48.0" target="_blank">V0ldemAr</a>, <a href="action=userinfo&user=21589" title="16-03-2011 09:33, ранг:84.0" target="_blank">_ruzmaz_</a>, <a href="action=userinfo&user=22498" title="09-09-2011 11:48, ранг:9.1" target="_blank">kp0m</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 марта 2011 02:11 &middot; Поправил: Hexxx <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Фича номер шесть: &quot;событие срабатывания брейкпоинта под свои нужды&quot;<br><br>Думаю все видели в окошке, которое вылазит при установке брейкпоинта, есть поле Condition. В нем предлагается писать условие срабатывания брейкпоинта, типа &quot;EAX==0xDEAD&quot;. Ну и в Help&#039;e есть такая приписочка, что эта строчка может быть любым IDC выражением. Вот и хорошо <img src="img/smilies/s1.gif" alt=""><br><br>Есть в IDA\idc файл ida.idc, в который можно дописывать свои функции, или инклюдить из других idc, и они будут доступны из редактора скриптов, а кроме того из того самого поля Condition. Или вообще их можно поставить на hotkey, гуглите &quot;Associating IDC Scripts with Hotkeys&quot; и вам откроется истина. <br><br>Короче, пишем в ida.idc свою функцию вида:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">static&nbsp;PrintArgs<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auto&nbsp;<span class="hl_registr"><b>esp</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">=</span>GetRegValue<span class="hl_char">(</span><span class="hl_quote">&quot;ESP&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Message<span class="hl_char">(</span><span class="hl_quote">&quot;Hello arg1 is %08X\n&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">Dword</span><span class="hl_char">(</span><span class="hl_registr">esp</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Message<span class="hl_char">(</span><span class="hl_quote">&quot;Hello arg2 is %08X\n&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">Dword</span><span class="hl_char">(</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Message<span class="hl_char">(</span><span class="hl_quote">&quot;Hello arg3 is %08X\n&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">Dword</span><span class="hl_char">(</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div>
<br>&quot;return 1&quot; нужно для того, чтобы брейкпоинт срабатывал всегда.<br><br>Ставим брейк поинт на инструкцию call в коде:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>edx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; RawDataSize</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; RawData</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>ecx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; int</span></li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;CryptEncrypt</li>        </ol>
    </div>
</div></div>
<br>В поле condition пишем:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">PrintArgs<span class="hl_char">(</span><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br>убираем у брейк поинта птичку &quot;Break&quot; и получаем самый настоящий логгер аргументов:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Hello&nbsp;arg1&nbsp;is&nbsp;<span class="hl_number">123DCEF0</span></li><li class="hl_l1">Hello&nbsp;arg2&nbsp;is&nbsp;<span class="hl_number">48AD12A0</span></li><li class="hl_l0">Hello&nbsp;arg3&nbsp;is&nbsp;<span class="hl_number">00000008</span></li><li class="hl_l1">Hello&nbsp;arg1&nbsp;is&nbsp;<span class="hl_number">123DCEF0</span></li><li class="hl_l0">Hello&nbsp;arg2&nbsp;is&nbsp;<span class="hl_number">48AD12D0</span></li><li class="hl_l1">Hello&nbsp;arg3&nbsp;is&nbsp;<span class="hl_number">0000001C</span></li>        </ol>
    </div>
</div></div>
<br>Можно пойти дальше, и дописать дамп данных:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">static&nbsp;PrintDump<span class="hl_char">(</span><span class="hl_function">addr</span><span class="hl_char">,</span>&nbsp;len<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auto&nbsp;i<span class="hl_char">,</span><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">end</span><span class="hl_char">=</span><span class="hl_function">addr</span><span class="hl_char">+</span>len<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span>i<span class="hl_char">=</span><span class="hl_function"><b>addr</b></span><span class="hl_comment">; i&lt; end ; i++)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Message<span class="hl_char">(</span><span class="hl_quote">&quot;%02X &quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">Byte</span><span class="hl_char">(</span>i<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Message<span class="hl_char">(</span><span class="hl_quote">&quot;\n&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">static&nbsp;PrintArgs<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auto&nbsp;<span class="hl_registr"><b>esp</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">=</span>GetRegValue<span class="hl_char">(</span><span class="hl_quote">&quot;ESP&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PrintDump<span class="hl_char">(</span><span class="hl_function">Dword</span><span class="hl_char">(</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">Dword</span><span class="hl_char">(</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br>И получаем полноценный API логгер
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=279185&amp;user=10168&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=18" class="addthx" data-post="279185"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24529" title="15-03-2011 23:16, ранг:73.5" target="_blank">NikolayD</a>, <a href="action=userinfo&user=11966" title="16-03-2011 08:12, ранг:108.0" target="_blank">r_e</a>, <a href="action=userinfo&user=6801" title="16-03-2011 09:07, ранг:357.2" target="_blank">OKOB</a>, <a href="action=userinfo&user=3520" title="16-03-2011 11:02, ранг:513.7" target="_blank">mak</a>, <a href="action=userinfo&user=1541" title="16-03-2011 21:37, ранг:190.6" target="_blank">Getorix</a>, <a href="action=userinfo&user=21589" title="17-03-2011 16:18, ранг:84.1" target="_blank">_ruzmaz_</a>, <a href="action=userinfo&user=7" title="06-04-2011 21:53, ранг:518.5" target="_blank">Bad_guy</a>, <a href="action=userinfo&user=27787" title="25-12-2013 21:47, ранг:6.0" target="_blank">ximerus</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]redlord[/b]','')">redlord</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 33.4 (посетитель), 24thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.71'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2889">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 марта 2011 12:19 <br><script type="text/javascript">QU('redlord','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=redlord" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>Hexxx</b><br><I>Hexxx пишет:<br>esp=GetRegValue(&quot;ESP&quot;); </I><br><br>имена регистров разве не зарезервированы?<br>можно и так:<br>auto r_esp;<br>r_esp = esp;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=279206&amp;user=2889&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=19" class="addthx" data-post="279206"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 марта 2011 12:42 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>redlord пишет:<br>имена регистров разве не зарезервированы? </I><br>не знаю, на &quot;auto esp;&quot; не возмутилось.
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=279210&amp;user=10168&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=20" class="addthx" data-post="279210"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 марта 2011 23:27 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>Hexxx пишет:</I><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">static&nbsp;PrintArgs<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auto&nbsp;<span class="hl_registr"><b>esp</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">=</span>GetRegValue<span class="hl_char">(</span><span class="hl_quote">&quot;ESP&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Message<span class="hl_char">(</span><span class="hl_quote">&quot;Hello arg1 is %08X\n&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">Dword</span><span class="hl_char">(</span><span class="hl_registr">esp</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Message<span class="hl_char">(</span><span class="hl_quote">&quot;Hello arg2 is %08X\n&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">Dword</span><span class="hl_char">(</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Message<span class="hl_char">(</span><span class="hl_quote">&quot;Hello arg3 is %08X\n&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">Dword</span><span class="hl_char">(</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div>
<br>Лучше так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">static&nbsp;PrintArgs<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Message<span class="hl_char">(</span><span class="hl_quote">&quot;Hello arg1 is %08X\n&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">Dword</span><span class="hl_char">(</span><span class="hl_registr">esp</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Message<span class="hl_char">(</span><span class="hl_quote">&quot;Hello arg2 is %08X\n&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">Dword</span><span class="hl_char">(</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Message<span class="hl_char">(</span><span class="hl_quote">&quot;Hello arg3 is %08X\n&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">Dword</span><span class="hl_char">(</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=279257&amp;user=2449&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=21" class="addthx" data-post="279257"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 марта 2011 23:31 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13601.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
как скажете <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=279259&amp;user=10168&amp;forum_n=1&amp;topic=13601.html&amp;page=0&amp;anchor=22" class="addthx" data-post="279259"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Неочевидные фичи иды</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#23" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="13601">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=13601" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
