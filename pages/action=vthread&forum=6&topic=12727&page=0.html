<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Работа с занятыми файлами. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT=" Вообщем такое дело, написал прогу и драйвер, прога через иоктл шлет запрос драйверу передавая в параметре адрес того файла когорого надо скопировать. Как я знаю файл SAM занят системой , проба на нем прошла успешно , файл">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a>, <a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a>, <a target='_blank' href='?action=userinfo&amp;user=50833'>vasilevradislav</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Работа с занятыми файлами.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2008 14:21 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
<img src="img/smilies/s1.gif" alt=""> Вообщем такое дело, написал прогу и драйвер, прога через иоктл шлет запрос драйверу передавая в параметре адрес того файла когорого надо скопировать. Как я знаю файл SAM занят системой , проба на нем прошла успешно , файл скопировался. Я сделал теперь запрос на другой файл занятый , он не скопировался , точнее скопировался но пустой а инфа не прочиталась. Я думал что если САМ файл скопировало то и тот текстовик скопирует. Текстовый файл , лежит в скрытом режиме может это причина скопированного файла с 0 байтами? <br><br>Исаев сделал пробу на своем коме с другой прогой , она через<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;Switch&nbsp;uMsg</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;WM_COMMAND</li><li class="hl_l1"></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;WM_DROPFILES</li>        </ol>
    </div>
</div></div>
<br>копирует файл тоже, странно то что файл у меня скопировался , но на другом компе скопировался файл с 0 байтами.<br>У кого какое мнение ?
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202075&amp;user=3520&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=1" class="addthx" data-post="202075"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2008 14:30 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>mak пишет:<br>Текстовый файл , лежит в скрытом режиме </I><br>Этот текстовый файл отрывается следующим образом:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0012E438</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">0040BB7B</span>&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_function"><b>CALL</b></span>&nbsp;to&nbsp;CreateFileA&nbsp;from&nbsp;proga<span class="hl_char">.</span>0040BB79</li><li class="hl_l1"><span class="hl_number">0012E43C</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00ED4DE8</span>&nbsp;&nbsp;<span class="hl_char">|</span>FileName&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;[Path]\name.txt&quot;</span></li><li class="hl_l0"><span class="hl_number">0012E440</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">001F01FF</span>&nbsp;&nbsp;<span class="hl_char">|</span>Access&nbsp;<span class="hl_char">=</span>&nbsp;1F01FF</li><li class="hl_l1"><span class="hl_number">0012E444</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;&nbsp;<span class="hl_char">|</span>ShareMode&nbsp;<span class="hl_char">=</span>&nbsp;0</li><li class="hl_l0"><span class="hl_number">0012E448</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;&nbsp;<span class="hl_char">|</span>pSecurity&nbsp;<span class="hl_char">=</span>&nbsp;NULL</li><li class="hl_l1"><span class="hl_number">0012E44C</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00000003</span>&nbsp;&nbsp;<span class="hl_char">|</span>Mode&nbsp;<span class="hl_char">=</span>&nbsp;OPEN_EXISTING</li><li class="hl_l0"><span class="hl_number">0012E450</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00000006</span>&nbsp;&nbsp;<span class="hl_char">|</span>Attributes&nbsp;<span class="hl_char">=</span>&nbsp;HIDDEN<span class="hl_char">|</span>SYSTEM</li><li class="hl_l1"><span class="hl_number">0012E454</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;&nbsp;<span class="hl_char">\</span>hTemplateFile&nbsp;<span class="hl_char">=</span>&nbsp;NULL</li>        </ol>
    </div>
</div></div>
<br>тут наверное всё что нужно знать для того, чтобы получить к нему доступ
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202078&amp;user=6946&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=2" class="addthx" data-post="202078"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2008 18:14 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Разбирать надо прогу твою, файлы, коды ошибок смотреть, чо это за вопрос то, гадать что ли? Как вариант-Рема статью почитай про занятые файлы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=202134&amp;user=1556&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=3" class="addthx" data-post="202134"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2008 20:40 &middot; Поправил: mak <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<img src="img/smilies/s1.gif" alt=""> Поэксперименитровал и понял разницу<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">CopyFile&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;uszDeviceName<span class="hl_char">:</span>DWORD</li><li class="hl_l1"><span class="hl_function"><b>local</b></span>&nbsp;oa<span class="hl_char">:</span>OBJECT_ATTRIBUTES</li><li class="hl_l0"><span class="hl_function"><b>local</b></span>&nbsp;iosb<span class="hl_char">:</span>IO_STATUS_BLOCK</li><li class="hl_l1"><span class="hl_function"><b>local</b></span>&nbsp;hFile<span class="hl_char">:</span>HANDLE</li><li class="hl_l0"><span class="hl_function"><b>local</b></span>&nbsp;p<span class="hl_char">:</span>PVOID</li><li class="hl_l1"><span class="hl_function"><b>local</b></span>&nbsp;cb<span class="hl_char">:</span>DWORD</li><li class="hl_l0"><span class="hl_function"><b>local</b></span>&nbsp;fsi<span class="hl_char">:</span>FILE_STANDARD_INFORMATION</li><li class="hl_l1"><span class="hl_function"><b>local</b></span>&nbsp;usDeviceName<span class="hl_char">:</span>UNICODE_STRING</li><li class="hl_l0"></li><li class="hl_l1"><span class="hl_function"><b>invoke</b></span>&nbsp;RtlInitUnicodeString<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;usDeviceName<span class="hl_char">,</span>uszDeviceName&nbsp;<span class="hl_comment">; offset uszDeviceName</span></li><li class="hl_l0"></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;InitializeObjectAttributes&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;oa<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;usDeviceName<span class="hl_char">,</span>&nbsp;OBJ_CASE_INSENSITIVE&nbsp;<span class="hl_char">+</span>&nbsp;OBJ_KERNEL_HANDLE<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span></li>        </ol>
    </div>
</div></div>
<br><br>addr usDeviceName эта переменная дается с ехе программы через иоктл , я точно не уверен но наверное причина в том что поданная сточка не соотвествует любимому формату драйверов.После попадания в драйвер делается RtlInitUnicodeString где addr usDeviceName это уникод строка а последний праметр это адрес нахождения пути до файла которого надо копировать. Поэтому дровина отрабатывает создавая вариант пустого файла но не записывающего данные ибо путь то не был верен.<br><br><br>Если я пишу строку <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">$</span>CCOUNTED_UNICODE_STRING<span class="hl_char">(</span><span class="hl_quote">&quot;\SystemRoot&quot;</span><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
 <br><br>в месте <br><br><br>InitializeObjectAttributes addr oa,&#036;CCOUNTED_UNICODE_STRING(&quot;\SystemRoot&quot;),OBJ_CASE_INSENSITIVE + OBJ_KERNEL_HANDLE, NULL, NULL<br>то тогда копируется все на ура. Это означает что я неправильно подаю данные в драйвер или чего то еще не хватает. В приложении скомпиленная прога с дровиной. В папке сам должнасоздать копию сам с именем ver. То есть это вариант без &#036;CCOUNTED_UNICODE_STRING. <br><br>Вопрос ? Как передать правильно строку в драйвер в понятном для него формате динамически , разблокируемый файл может быть каждый раз разный.
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202158&amp;user=3520&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=4" class="addthx" data-post="202158"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2008 20:46 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
файл <br><br><img src="img/attach.gif" alt=""> <a href="./files/bb6b_05.09.2008_CRACKLAB.rU.tgz">bb6b_05.09.2008_CRACKLAB.rU.tgz</a> - Xen.rar
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202159&amp;user=3520&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=5" class="addthx" data-post="202159"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2008 21:03 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Вот еще забыл момент с буфером <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">]</span><span class="hl_char">.</span>Parameters<span class="hl_char">.</span>DeviceIoControl<span class="hl_char">.</span>IoControlCode&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;мой&nbsp;код</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">]</span><span class="hl_char">.</span>AssociatedIrp<span class="hl_char">.</span>SystemBuffer</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>assume</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">:</span><span class="hl_function"><b>ptr</b></span>&nbsp;DWORD</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;CopyFile<span class="hl_char">,</span><span class="hl_registr">edx</span></li>        </ol>
    </div>
</div></div>
<br><br>в SystemBuffer будет лежать моя строка или адрес строки которые пришли с приложения?
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202166&amp;user=3520&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=6" class="addthx" data-post="202166"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2008 21:34 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Обычно в таких случаях я сам просто беру и смотрю это в сайсе, что проще-взять воткнуть в дров __asm int 3, в сайсе поставить bpint 3 и посмотреть, что интересно. По-моему, это гораздо лучше, чем тыкать народ на форуме, тем более, что это можно легко глянуть самому.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=202174&amp;user=1556&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=7" class="addthx" data-post="202174"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]MACKLIA[/b]','')">MACKLIA</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/5822.gif" alt=""><br><span class=txtSm>Ранг: 279.1 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.96'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5822">Участник</a><br><font color=blue>wizard</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2008 22:56 &middot; Поправил: MACKLIA <br><script type="text/javascript">QU('MACKLIA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MACKLIA" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>mak пишет:<br>файл<br><br>bb6b_05.09.2008_CRACKLAB.rU.tgz - Xen.rar<br> </I><br><b>mak</b> у меня после старта твоей проги комп сразу ребутнулся <img src="img/smilies/s14.gif" alt=""> ,как будто я какой то выжный  системный процес кильнул
<br><br><font size="1"><i>-----<br>Что один человек сделал , другой всегда сломать может...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202183&amp;user=5822&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=8" class="addthx" data-post="202183"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2008 22:57 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>Archer</b> спсб хороший метод , все верно в функцию идет адрес файла которого потом проходит RtlInitUnicodeString переводит и потом даже крит файл открывает все супер , а падение было вот тут<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>invoke</b></span>&nbsp;ZwQueryInformationFile<span class="hl_char">,</span>&nbsp;hFile<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;iosb<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;fsi<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>sizeof</b></span>&nbsp;fsi<span class="hl_char">,</span>&nbsp;FileStandardInformation</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;fsi<span class="hl_char">.</span>EndOfFile<span class="hl_char">.</span>LowPart</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;&nbsp;&nbsp;&nbsp;eax</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;cb<span class="hl_char">,</span>&nbsp;eax</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;ExAllocatePool<span class="hl_char">,</span>&nbsp;PagedPool<span class="hl_char">,</span>&nbsp;cb</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;p<span class="hl_char">,</span>&nbsp;eax</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;RtlZeroMemory<span class="hl_char">,</span>&nbsp;p<span class="hl_char">,</span>&nbsp;cb</li>        </ol>
    </div>
</div></div>
<br><br>на коде invoke ExAllocatePool, PagedPool, cb<br> вернуло 0 ну а потом естественно пишет в файл 0 байт но создает его . Самое интеерсное что при строке &#036;CCOUNTED_UNICODE_STRING работает а с динамическим адресом не работает. Какая может быть разница ?
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202184&amp;user=3520&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=9" class="addthx" data-post="202184"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2008 23:01 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>MACKLIA</b> не не , там ничего не киляет , у меня пока не было такого с этим кодом что тут. Было синий экран с другой версией , но там ясно было не так адреса выделяллись. Тут же я проверял с &#036;CCOUNTED_UNICODE_STRING  копирует , а без нее просто пустой файл создает. <br><br>Извиняюсь за такое последствие <img src="img/smilies/s4.gif" alt="">
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202186&amp;user=3520&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=10" class="addthx" data-post="202186"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]MACKLIA[/b]','')">MACKLIA</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/5822.gif" alt=""><br><span class=txtSm>Ранг: 279.1 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.96'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5822">Участник</a><br><font color=blue>wizard</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2008 23:08 <br><script type="text/javascript">QU('MACKLIA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MACKLIA" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>mak</b> мак за эксперемент никаких претензий ,просто сообщил как у меня комп отреагировал.
<br><br><font size="1"><i>-----<br>Что один человек сделал , другой всегда сломать может...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202189&amp;user=5822&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=11" class="addthx" data-post="202189"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2008 23:25 &middot; Поправил: mak <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
=) нашел ошибку всетаки точную , память не выделяется потому что имя файла подается не правильно ,в  IOCTL  передается строка адрес файла , далее в драйвере берется буфер проверил в софтайсе , с правильным адресом файла , но адрес не сформирован как строка <b>DW</b> нужная для драйвера , в свою очередь я видел в дровине работы с реестром , там адреса не имеют формата <b>DW</b>но делают RtlInitUnicodeString.<br><br>В итоге ошибка тут , как ее решить честно не знаю ..<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>local</b></span>&nbsp;usDeviceName<span class="hl_char">:</span>UNICODE_STRING</li><li class="hl_l1"></li><li class="hl_l0"><span class="hl_function"><b>invoke</b></span>&nbsp;RtlInitUnicodeString<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;usDeviceName<span class="hl_char">,</span>uszDeviceName</li><li class="hl_l1"></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;InitializeObjectAttributes&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;oa<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;usDeviceName<span class="hl_char">,</span>&nbsp;OBJ_CASE_INSENSITIVE&nbsp;<span class="hl_char">+</span>&nbsp;OBJ_KERNEL_HANDLE<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span></li>        </ol>
    </div>
</div></div>
<br><br>где uszDeviceName адрес на буфер с адресом файла в виде например C:\windows\xxx\ <br>а далее в InitializeObjectAttributes параметр addr usDeviceName идет уже готовая уникод строка , но как получается как раз она и неверная.
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202190&amp;user=3520&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=12" class="addthx" data-post="202190"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]LazzY[/b]','')">LazzY</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 110.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.36'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3961">Участник</a><br><font color=blue>~ tPORt ~</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 сентября 2008 12:28 <br><script type="text/javascript">QU('LazzY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=LazzY" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>mak</b>, смотрите коды ошибок ну и на коды бсодов тоже внимание обращайте.. а то падает тут а почему хз)<br><br>имя файла хоть с \??\ начинается то? 6)<br>а то без сырцов даже непоймешь где ошибка то <img src="img/smilies/s15.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=202222&amp;user=3961&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=13" class="addthx" data-post="202222"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 сентября 2008 17:19 &middot; Поправил: mak <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
имя файла обыкновенный путь вида С:\tmpDrv.sys требуется вот что ..<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">drvnameW&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dw</b></span>&nbsp;<span class="hl_quote">&quot;c&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;:&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;t&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;m&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;p&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;D&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;r&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;v&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;.&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;s&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;y&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;s&quot;</span><span class="hl_char">,</span>0</li><li class="hl_l1">drvname&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_quote">'c:\tmpDrv.sys'</span><span class="hl_char">,</span><span class="hl_number">0</span></li>        </ol>
    </div>
</div></div>
<br><br>Перевести строку динамически drvname в drvnameW , естественно оба буфера будут пустые до перевода и поиска файла<br><br>P.S<br>это уже сделал , оказалось просто <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>invoke</b></span>&nbsp;lstrlen<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;adwInBuffer</li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;cchWideChar<span class="hl_char">,</span>eax</li><li class="hl_l0"><span class="hl_function"><b>invoke</b></span>&nbsp;MultiByteToWideChar<span class="hl_char">,</span>CP_ACP<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;adwInBuffer<span class="hl_char">,</span>cchWideChar<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;adwInBufferW<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>sizeof</b></span>&nbsp;adwInBufferW</li><li class="hl_l1"><span class="hl_function"><b>invoke</b></span>&nbsp;SysAllocStringLen<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;adwInBufferW<span class="hl_char">,</span>&nbsp;eax</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;pBSTR<span class="hl_char">,</span><span class="hl_registr">eax</span></li>        </ol>
    </div>
</div></div>
<br>теперь у драйвера есть уникод строка .... ноооо опять же есть ошибка , вариант такой по моему мнению  я 2слэша не сделал в пути вместо одного. Значит после получения пути нужно парсить и вставлять второй флэш ?! Может есть апи упрощающая действие ?
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202239&amp;user=3520&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=14" class="addthx" data-post="202239"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]requiem4[/b]','')">requiem4</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.87'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=17944">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 сентября 2008 10:25 &middot; Поправил: requiem4 <br><script type="text/javascript">QU('requiem4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=requiem4" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Правильное имя файла должно быть:<br>&quot;&#92;\??&#92;\c:&#92;\tmpdrv.sys&quot; (Си строка)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=202395&amp;user=17944&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=15" class="addthx" data-post="202395"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]LazzY[/b]','')">LazzY</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 110.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.36'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3961">Участник</a><br><font color=blue>~ tPORt ~</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 сентября 2008 10:53 &middot; Поправил: LazzY <br><script type="text/javascript">QU('LazzY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=LazzY" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
ога ну а поруски это будет \??\c:\tmpdrv.sys<br>add:почитайте не много стотей Four-F на васме
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=202402&amp;user=3961&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=16" class="addthx" data-post="202402"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 сентября 2008 13:13 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>requiem4</b> <b>LazzY</b> Спасибо за замечание , это и так ястно <img src="img/smilies/s3.gif" alt="">
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202421&amp;user=3520&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=17" class="addthx" data-post="202421"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 сентября 2008 22:27 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<img src="img/smilies/s1.gif" alt=""> вообщем сделал я подачу Уникод строки в дровину и добавление слэшей , файл не открылся и тут сразу возник вопрос такой <br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>local</b></span>&nbsp;usDeviceName<span class="hl_char">:</span>UNICODE_STRING</li><li class="hl_l1"></li><li class="hl_l0"><span class="hl_function"><b>invoke</b></span>&nbsp;RtlInitUnicodeString<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;usDeviceName<span class="hl_char">,</span><span class="hl_registr"><b>edx</b></span>&nbsp;<span class="hl_comment">; offset uszDeviceName</span></li><li class="hl_l1"></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;InitializeObjectAttributes&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;oa<span class="hl_char">,</span><span class="hl_function"><b>offset</b></span>&nbsp;usDeviceName<span class="hl_char">,</span>&nbsp;OBJ_CASE_INSENSITIVE&nbsp;<span class="hl_char">+</span>&nbsp;OBJ_KERNEL_HANDLE<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span></li>        </ol>
    </div>
</div></div>
<br> сработает ли InitializeObjectAttributes , когда подаешь динамически строку ? в edx Адрес правильной строки в юникод формате , но при  ZwCreateFile в еах с0000033 ошибка<br><br>А вот ее код STATUS_OBJECT_NAME_INVALID = &#036;C0000033 , значит ошибка в InitializeObjectAttributes. Проверял правильность адресов в софтайсе поставив инт3 в код драйвера перед Пуш едх и колл адрес где в едх адрес уникод строки.<br><br><img src="img/attach.gif" alt=""> <a href="./files/39b5_08.09.2008_CRACKLAB.rU.tgz">39b5_08.09.2008_CRACKLAB.rU.tgz</a> - Driver.rar
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202466&amp;user=3520&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=18" class="addthx" data-post="202466"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]requiem4[/b]','')">requiem4</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.87'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=17944">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 сентября 2008 08:48 <br><script type="text/javascript">QU('requiem4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=requiem4" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
InitializeObjectAttributes это очень простенькая функция<br><br>#define InitializeObjectAttributes(p,n,a,r,s) <br>    do { <br>        (p)-&gt;Length = sizeof(OBJECT_ATTRIBUTES); <br>        (p)-&gt;RootDirectory = r; <br>        (p)-&gt;Attributes = a; <br>        (p)-&gt;ObjectName = n; <br>        (p)-&gt;SecurityDescriptor = s; <br>        (p)-&gt;SecurityQualityOfService = NULL; <br>    } while (0)<br><br>Непонятно в последнем примере что именно ты пытаешься открыть: файл или драйвер?<br>Если драйвер, то код будет таким<br><br>	RtlInitUnicodeString(&amp;uDriver,L&quot;&#92;\DosDevices&#92;\DriverName&quot;);<br><br>	   InitializeObjectAttributes(&amp;ObjectAttributes,<br>	      &amp;uDriver,<br>	      OBJ_CASE_INSENSITIVE|OBJ_KERNEL_HANDLE   ,<br>	      NULL,<br>	      NULL);<br><br>Скидывай исходник или кусок его, чтобы вопросов было меньше.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=202486&amp;user=17944&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=19" class="addthx" data-post="202486"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 сентября 2008 11:47 &middot; Поправил: mak <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
Как заполняется эта структура? есть пример ? Я писал уже что не играет роли драйвер это или файл , в приложенной проге идет работа только с файлом соответсвенно и строка готовится к иоктл для файла а не драйвера. Если есть разница заполнения  InitializeObjectAttributes с драйверами то какая ? <br><br>По выше приведенному коду я показл участок где макрос вроде бы не выполняет своих функций , как можно инициализировать то чего нету. С другой стороны в коде дровины инициализация присуствует. Но судя по всему она неверная. <br><br><br><b>PS </b>. я щас побегал по даресам структур , и понял что строки моей передаваемой уже подавно , нету <img src="img/smilies/s14.gif" alt="">  я подал адрес на <br>   mov edx, [esi].AssociatedIrp.SystemBuffer<br>   assume edx:ptr DWORD<br>далее идет <br><br>invoke RtlInitUnicodeString, addr usDeviceName,edx <br>RtlInitUnicodeString вроде заполняет структуру в usDeviceName где последний параметр должен быть адрес на строку мою, но во первых там нету почему то адреса а во вторых по адресу в едх который я запомнил уже нет более моей строки , а если в структуру пишется только указатель на едх это значит что кто то стер мою строку и это RtlInitUnicodeString !<br><br>далее InitializeObjectAttributes addr oa,addr usDeviceName, OBJ_CASE_INSENSITIVE + OBJ_KERNEL_HANDLE, NULL, NULL <br><br>где опять же лажовый адрес без имени моего и звКритфайл говорит неправильно емя. Странно ..<br>А вот прототипы структур<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">OBJECT_ATTRIBUTES&nbsp;struct&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;Len&nbsp;ULONG&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;RootDirectory&nbsp;HANDLE&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;ObjectName&nbsp;PVOID&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;Attributes&nbsp;ULONG&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;SecurityDescriptor&nbsp;PVOID&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;SecurityQualityOfService&nbsp;PVOID&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">OBJECT_ATTRIBUTES&nbsp;ends</li><li class="hl_l0"></li><li class="hl_l1">UNICODE_STRING&nbsp;struct</li><li class="hl_l0">&nbsp;&nbsp;Len&nbsp;USHORT&nbsp;&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;MaximumLen&nbsp;USHORT&nbsp;&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;Buffer&nbsp;PWSTR&nbsp;&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">UNICODE_STRING&nbsp;ends</li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=202517&amp;user=3520&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=20" class="addthx" data-post="202517"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]requiem4[/b]','')">requiem4</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.87'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=17944">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 сентября 2008 13:43 <br><script type="text/javascript">QU('requiem4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=requiem4" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12727.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
&gt; Если есть разница заполнения InitializeObjectAttributes с драйверами то какая ? <br>Сравни мои 2 поста и заметишь.<br>&gt; код таким не будет , потому что строка в ртлинит неизвестная на момент инициализации<br>Какая разница то?<br>RtlInitUnicodeString(&amp;str,buffer);<br>Наверное ты запутался в указателях на выделяемую память. <br><br>можно тебе поможет с опцией выделением памяти<br>RtlAnsiStringToUnicodeString<br><br>Но лучше показывай текущее свое творение
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=202536&amp;user=17944&amp;forum_n=6&amp;topic=12727.html&amp;page=0&amp;anchor=21" class="addthx" data-post="202536"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Работа с занятыми файлами.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#22" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="12727">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=12727" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
