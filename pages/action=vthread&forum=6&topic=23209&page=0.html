<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Странное поведение NtLoadDriver - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Пытаюсь загрузить драйвер через сабж, создал нужные ветки реестра, скопировал драйвер в system32/drivers, при загрузке драйвера возникает сообщение, что винда заблокировала неподписанный драйвер - но сам драйвер не загружается!">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Странное поведение NtLoadDriver</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]KillerX[/b]','')">KillerX</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22800">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 ноября 2014 18:47 <br><script type="text/javascript">QU('KillerX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=KillerX" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23209.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Пытаюсь загрузить драйвер через сабж, создал нужные ветки реестра, скопировал драйвер в system32/drivers, при загрузке драйвера возникает сообщение, что винда заблокировала неподписанный драйвер - но сам драйвер не загружается! NtLoadDriver возвращает 0, проверку подписи дров, ессно. отключил. Через SCM драйвер грузится нормально.<br><br>В чем может быть причина? Винда - х64, 8.1
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348622&amp;user=22800&amp;forum_n=6&amp;topic=23209.html&amp;page=0&amp;anchor=1" class="addthx" data-post="348622"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 ноября 2014 19:42 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23209.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>KillerX пишет:<br>Пытаюсь загрузить драйвер через сабж, создал нужные ветки реестра, скопировал драйвер в system32/drivers, при загрузке драйвера возникает сообщение, что винда заблокировала неподписанный драйвер - но сам драйвер не загружается! NtLoadDriver возвращает 0, проверку подписи дров, ессно. отключил. Через SCM драйвер грузится нормально.<br><br>В чем может быть причина? Винда - х64, 8.1<br> </I><br>Причина в том, что драйвер не подписан.<br>Либо подпишите драйвер (есть утилита в сети для этой цели),<br>либо при начальной загрузке Windows выберите (по F8) пункт меню &quot;Загружать неподписанные драйвера&quot;.<br>Мне тоже не удавалось насовсем отключить эту опцию, следуя рекомендациям. <br>Времени ковыряться на чужой машине не было - грузился как описано выше, через выбор пункта в загрузочном меню. <br><br>Посмотрите материалы по теме &quot;Driver Signing&quot;. Например, <noindex><a href="http://forum.exetools.com/showthread.php?t=14496" rel="nofollow" target="_blank">--&gt; тут &lt;--</a></noindex><br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348624&amp;user=35473&amp;forum_n=6&amp;topic=23209.html&amp;page=0&amp;anchor=2" class="addthx" data-post="348624"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]KillerX[/b]','')">KillerX</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22800">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 ноября 2014 21:11 <br><script type="text/javascript">QU('KillerX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=KillerX" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23209.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Интересно, я даже не знал, что есть утилита.<br><br>Но вопрос в том, что я именно включал при загрузке оси опцию загружать неподписанные дрова!!!) Я же говорю - прикол в том, что через scm дров прекрасно загружается и работает)<br><br><b>Добавлено спустя 1 час 6 минут</b><br><img src="img/smilies/s14.gif" alt=""><br><br>Так... попытаюсь рассказать подробнее. Загружаю винду через параметры загрузки, отключающие проверку подписей дров. При таком раскладе при попытке загрузить неподписанный драйвер все равно возникает сообщение, что дескать винда заблокировала установку неподписаного дрова, но по факту дров загружается. Пробовал загружать через SCM - работает, дров есть в списке загруженных драйверов.<br><br>Когда загружаю драйвер, используя NtLoadDriver, то так же возникает это же сообщение от винды - но драйвер по факту не загружается. Использую для загрузки такой код:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwType&nbsp;<span class="hl_char">=</span>&nbsp;SERVICE_KERNEL_DRIVER<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwStart&nbsp;<span class="hl_char">=</span>&nbsp;SERVICE_DEMAND_START<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HKEY&nbsp;hKey<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WCHAR&nbsp;szMain<span class="hl_char">[</span><span class="hl_number">512</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;<span class="hl_number">0</span>&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WCHAR&nbsp;szImgPath<span class="hl_char">[</span><span class="hl_number">512</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;<span class="hl_number">0</span>&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wchar_t&nbsp;szRegPath<span class="hl_char">[</span><span class="hl_number">512</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;<span class="hl_number">0</span>&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wsprintfW<span class="hl_char">(</span>szMain<span class="hl_char">,</span>&nbsp;<span class="hl_quote">L&quot;%s%s&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">L&quot;SYSTEM\CurrentControlSet\Services\&quot;</span><span class="hl_char">,</span>&nbsp;szDriverName<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wsprintfW<span class="hl_char">(</span>szImgPath<span class="hl_char">,</span>&nbsp;<span class="hl_quote">L&quot;%s%s&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">L&quot;\??\&quot;</span><span class="hl_char">,</span>&nbsp;pszDestSys<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>RegCreateKeyW<span class="hl_char">(</span>HKEY_LOCAL_MACHINE<span class="hl_char">,</span>&nbsp;szMain<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>hKey<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;ERROR_SUCCESS<span class="hl_char">)</span>&nbsp;cout&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;GoodReg\n&quot;</span><span class="hl_comment">; else cout &lt;&lt; &quot;Error code &quot; &lt;&lt; GetLastError();</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RegSetValueExW<span class="hl_char">(</span>hKey<span class="hl_char">,</span>&nbsp;<span class="hl_quote">L&quot;DisplayName&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;REG_SZ<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span>LPBYTE<span class="hl_char">)</span>szDriverName<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>lstrlenW<span class="hl_char">(</span>szDriverName<span class="hl_char">)</span>&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RegSetValueExW<span class="hl_char">(</span>hKey<span class="hl_char">,</span>&nbsp;<span class="hl_quote">L&quot;ImagePath&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;REG_EXPAND_SZ<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span>LPBYTE<span class="hl_char">)</span>szImgPath<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>lstrlenW<span class="hl_char">(</span>szImgPath<span class="hl_char">)</span>&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RegSetValueExW<span class="hl_char">(</span>hKey<span class="hl_char">,</span>&nbsp;<span class="hl_quote">L&quot;Type&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;REG_DWORD<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span>LPBYTE<span class="hl_char">)</span><span class="hl_char">&amp;</span>dwType<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span><span class="hl_function">sizeof</span><span class="hl_char">(</span>dwType<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RegSetValueExW<span class="hl_char">(</span>hKey<span class="hl_char">,</span>&nbsp;<span class="hl_quote">L&quot;Start&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;REG_DWORD<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span>LPBYTE<span class="hl_char">)</span><span class="hl_char">&amp;</span>dwStart<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span><span class="hl_function">sizeof</span><span class="hl_char">(</span>dwStart<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">TOKEN_PRIVILEGES&nbsp;tp&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;<span class="hl_number">0</span>&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE&nbsp;hToken&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTSTATUS&nbsp;status<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp<span class="hl_char">.</span>PrivilegeCount&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp<span class="hl_char">.</span>Privileges<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">.</span>Attributes&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">2</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;<span class="hl_char">=</span>&nbsp;OpenProcessToken<span class="hl_char">(</span>GetCurrentProcess<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;TOKEN_ADJUST_PRIVILEGES<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>hToken<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>status&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span>&nbsp;cout&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;OpenProcessToken filed\n&quot;</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;<span class="hl_char">=</span>&nbsp;LookupPrivilegeValue<span class="hl_char">(</span><span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">L&quot;SeLoadDriverPrivilege&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>tp<span class="hl_char">.</span>Privileges<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">.</span>Luid<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>status&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span>&nbsp;cout&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;LookupPrivilegeValue filed\n&quot;</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;<span class="hl_char">=</span>&nbsp;AdjustTokenPrivileges<span class="hl_char">(</span>hToken<span class="hl_char">,</span>&nbsp;<span class="hl_function">FALSE</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>tp<span class="hl_char">,</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>tp<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>status&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span>&nbsp;cout&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;AdjustTokenPrivileges filed\n&quot;</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>hToken<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">NTSTATUS&nbsp;status<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNICODE_STRING&nbsp;driverServicePath&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;<span class="hl_number">0</span>&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RtlInitUnicodeString<span class="hl_char">(</span><span class="hl_char">&amp;</span>driverServicePath<span class="hl_char">,</span>&nbsp;pszDestSys<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;<span class="hl_char">=</span>&nbsp;NtLoadDriver<span class="hl_char">(</span><span class="hl_char">&amp;</span>driverServicePath<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>status&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;0x00000000<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;NtLoadDriver STATUS_SUCCESS\n&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348626&amp;user=22800&amp;forum_n=6&amp;topic=23209.html&amp;page=0&amp;anchor=3" class="addthx" data-post="348626"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 ноября 2014 23:25 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23209.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>KillerX пишет:<br>Интересно, я даже не знал, что есть утилита. </I><br><br>Собственно, для работы таких &quot;непроверенных&quot; подписанных драйверов в системе должен быть всё равно включён &quot;тестовый режим&quot;. Я не экспериментировал с этой всей фигнёй. Вообще, по-моему, это натуральное скотство микрософтовское и стоило бы выковырять бообще такое счастье из системы, но, повторюсь, для этого нужна собственно система и желание\время с этим возиться.<br><br>Ну, попробуйте включить у себя этот самый &quot;тестовый режим&quot; и &quot;подписать драйвер непроверенной подписью&quot;.  Что получится..  <br><noindex><a href="http://pctuner.ru/page.php?id=844" rel="nofollow" target="_blank">--&gt; Вот  &lt;--</a></noindex>статья на эту тему.<br><br><I>KillerX пишет:<br>Добавлено спустя 1 час 6 минут </I><br><br>Я столкнулся с этой лажей из-за драйвера эмулятора донгла к одному софту под Win7/64bit.<br>При загрузке по F8 c &quot;отключением проверки подписи&quot; та система грузила без вопросов ВСЕ драйвера - и подписанные, и неподписанные, и динамически и при начальной загрузке. Никаких сообщений не выдавалось.<br>У меня даже мелькнула мысль поковырять загрузчик Windows для дефолтного запуска режима &quot;без проверки подписи&quot; (как сделал тот чел в статье выше для Vista). Но на чужой машине не было возможностей этим заниматься.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348630&amp;user=35473&amp;forum_n=6&amp;topic=23209.html&amp;page=0&amp;anchor=4" class="addthx" data-post="348630"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=22800" title="13-11-2014 11:32, ранг:6.0" target="_blank">KillerX</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 ноября 2014 13:36 &middot; Поправил: Gideon Vi <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23209.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
раз<br><br><img src="img/attach.gif" alt=""> <a href="./files/d44a_13.11.2014_EXELAB.rU.tgz">d44a_13.11.2014_EXELAB.rU.tgz</a> - Driver Signature Enforcement Overrider v1.3b.part1.rar<br><br><b>Добавлено спустя</b><br>два<br><br><img src="img/attach.gif" alt=""> <a href="./files/6812_13.11.2014_EXELAB.rU.tgz">6812_13.11.2014_EXELAB.rU.tgz</a> - Driver Signature Enforcement Overrider v1.3b.part2.rar<br><br><noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15123" rel="nofollow" target="_blank">Как отладить драйвер на windows 7 x64?</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348642&amp;user=2585&amp;forum_n=6&amp;topic=23209.html&amp;page=0&amp;anchor=5" class="addthx" data-post="348642"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=22800" title="13-11-2014 11:32, ранг:6.0" target="_blank">KillerX</a>, <a href="action=userinfo&user=35473" title="13-11-2014 15:25, ранг:72.3" target="_blank">dosprog</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]KillerX[/b]','')">KillerX</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22800">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 ноября 2014 15:26 &middot; Поправил: KillerX <br><script type="text/javascript">QU('KillerX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=KillerX" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23209.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Спасибо за программу - буду пробовать)<br><br>А почему тогда  неподписанный драйвер средствами SCM загружается?)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348645&amp;user=22800&amp;forum_n=6&amp;topic=23209.html&amp;page=0&amp;anchor=6" class="addthx" data-post="348645"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 ноября 2014 19:22 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23209.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>Gideon Vi пишет:<br>Как отладить драйвер на windows 7 x64?<br> </I><br><br>Мне нравится <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15123&amp;page=0#23" rel="nofollow" target="_blank">--&gt; Такое решение &lt;--</a></noindex><br>Но это, к сожалению, выход только на моей машине, перенести куда-то потом софтину проблематично.<br><br>P.S.<br>Кстати,  аттач с <b>dseo13b</b> вышел нерабочим.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348653&amp;user=35473&amp;forum_n=6&amp;topic=23209.html&amp;page=0&amp;anchor=7" class="addthx" data-post="348653"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]KillerX[/b]','')">KillerX</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22800">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 ноября 2014 20:10 <br><script type="text/javascript">QU('KillerX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=KillerX" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23209.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>dosprog пишет:<br>Мне нравится --&gt; Такое решение &lt;-- </I><br><br>Интересно, будет ли в 8-ке работать. Хотя врятли, конечно(<br><br><I>dosprog пишет:<br>Кстати, аттач с dseo13b вышел нерабочим. </I><br><br>А у меня работает...) Всмысле этож 2 части рара, они у меня распаковываются в приложение, которое работает)<br><br><b>Добавлено спустя -58 минут</b><br>А все таки - почему же драйвер работает через SCM ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348657&amp;user=22800&amp;forum_n=6&amp;topic=23209.html&amp;page=0&amp;anchor=8" class="addthx" data-post="348657"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2014 04:00 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23209.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>dosprog пишет:<br>Кстати, аттач с dseo13b вышел нерабочим. </I><br><br>Обновите архиватор.<br><br><b>Добавлено спустя -58 минут</b><br><I>KillerX пишет:<br>А все таки - почему же драйвер работает через SCM ?  </I><br><br>что такое scm?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348664&amp;user=2585&amp;forum_n=6&amp;topic=23209.html&amp;page=0&amp;anchor=9" class="addthx" data-post="348664"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2014 07:56 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23209.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>Gideon Vi пишет:<br>что такое scm?<br> </I><br>Если не ошибаюсь, имеется в виду <noindex><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms686321%28v=vs.85%29.aspx" rel="nofollow" target="_blank">--&gt; это &lt;--</a></noindex><br><br><br><I>Gideon Vi пишет:<br>Обновите архиватор.<br> </I><br>Мда.. Значит, вер.4.11 (2012 г.) уже не может распаковывать архив версии 5.11.<br>Головняк.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348667&amp;user=35473&amp;forum_n=6&amp;topic=23209.html&amp;page=0&amp;anchor=10" class="addthx" data-post="348667"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2014 08:55 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23209.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>dosprog пишет:<br>Если не ошибаюсь, имеется в виду --&gt; это &lt;-- </I><br><br>ну тогда смотреть, чего там и как. Может не стандартный способ юзается. Мну драйвера не пишет <img src="img/smilies/s12.gif" alt=""><br><br><I>dosprog пишет:<br>Мда.. Значит, вер.4.11 (2012 г.) уже не может распаковывать архив версии 5.11. </I><br><br>начиная с 5,хх серьезно изменился алгоритм, так что версия 5 поддерживает упаковку в обоих вариантах.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348671&amp;user=2585&amp;forum_n=6&amp;topic=23209.html&amp;page=0&amp;anchor=11" class="addthx" data-post="348671"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]KillerX[/b]','')">KillerX</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22800">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2014 10:17 &middot; Поправил: KillerX <br><script type="text/javascript">QU('KillerX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=KillerX" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23209.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>Gideon Vi пишет:<br>что такое scm?  </I><br><br>http://msdn.microsoft.com/ru-RU/library/windows/desktop/ms685150(v=vs.85).aspx<br><br><span style="word-break: break-all">https://ru.wikipedia.org/wiki/%D0%94%D0%B8%D1%81%D0%BF%D0%B5%D1%82%D1%87%D0%B5%D1%80_%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F_%D1%81%D0%BB%D1%83%D0%B6%D0%B1%D0%B0%D0%BC%D0%B8</span><br><br><I>dosprog пишет:<br>Если не ошибаюсь, имеется в виду --&gt; это &lt;-- </I><br><br>Это одна из функций менеджера. Загрузка дрова происходит так:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;</li><li class="hl_l1">SC_HANDLE&nbsp;sch&nbsp;<span class="hl_char">=</span>&nbsp;OpenSCManager<span class="hl_char">(</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SC_MANAGER_ALL_ACCESS<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>sch<span class="hl_char">)</span>&nbsp;cout&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;OpenSCManager SUCCESS\n&quot;</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;OpenSCManager failed &quot;</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;GetLastError<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;\n&quot;</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;schService&nbsp;<span class="hl_char">=</span>&nbsp;CreateService<span class="hl_char">(</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sch<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drv_service_name<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drv_service_description<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SERVICE_ALL_ACCESS<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SERVICE_KERNEL_DRIVER<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SERVICE_DEMAND_START<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SERVICE_ERROR_NORMAL<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pszCurrentDest1<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>schService<span class="hl_char">)</span>&nbsp;cout&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;CreateService SUCCESS\n&quot;</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;CreateService failed (%d)\n&quot;</span><span class="hl_char">,</span>&nbsp;GetLastError<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>StartService<span class="hl_char">(</span>schService<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;cout&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;StartService SUCCESS\n&quot;</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;StartService failed (%d)\n&quot;</span><span class="hl_char">,</span>&nbsp;GetLastError<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br><I>Gideon Vi пишет:<br>ну тогда смотреть, чего там и как. Может не стандартный способ юзается. </I><br><br>В том то и дело, что загрузка через SCM - как раз <i class=x>стандартный</i> способ загрузки. Но фишка в том, что вроде как он делает как раз то, что и мой первоначальный код - повышает привилегии до права загрузки драйвера, а потом вызывает ту же NtLoadDriver(); Кстати через SCM работает KmdManager от Four-F
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348672&amp;user=22800&amp;forum_n=6&amp;topic=23209.html&amp;page=0&amp;anchor=12" class="addthx" data-post="348672"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2014 16:03 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23209.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Потыкайте палочкой Арчера, он в драйверах жутко грамотный.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348681&amp;user=2585&amp;forum_n=6&amp;topic=23209.html&amp;page=0&amp;anchor=13" class="addthx" data-post="348681"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2014 17:56 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23209.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Раз стандартным способом драйвер грузится, тогда зачем ещё что-то изобретать  и пытаться эмулировать этот стандартный способ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348685&amp;user=35473&amp;forum_n=6&amp;topic=23209.html&amp;page=0&amp;anchor=14" class="addthx" data-post="348685"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]KillerX[/b]','')">KillerX</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22800">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2014 20:53 <br><script type="text/javascript">QU('KillerX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=KillerX" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23209.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>Gideon Vi пишет:<br>Потыкайте палочкой Арчера, он в драйверах жутко грамотный.  </I><br><br>Вы имеете ввиду через личку?<img src="img/smilies/s1.gif" alt=""><br><br><I>dosprog пишет:<br>Раз стандартным способом драйвер грузится, тогда зачем ещё что-то изобретать и пытаться эмулировать этот стандартный способ?  </I><br><br>Вообще просто хотелось поднабить скиллов по поводу загрузки дровин<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348692&amp;user=22800&amp;forum_n=6&amp;topic=23209.html&amp;page=0&amp;anchor=15" class="addthx" data-post="348692"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Странное поведение NtLoadDriver</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#16" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="23209">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23209" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
