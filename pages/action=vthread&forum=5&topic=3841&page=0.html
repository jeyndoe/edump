<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Вопрос по секциям - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Возможно-ли добавить в ехе файл секцию, которая проектировалась бы в память по адресу меньшему, чем Image Base? Все мои попыткм добится такого результата в LordPe преводили к тому, что винда ругается, что файл не является">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вопрос по секциям</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Klajnor[/b]','')">Klajnor</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.78'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2708">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 января 2006 19:36 &middot; Поправил: Klajnor <br><script type="text/javascript">QU('Klajnor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Klajnor" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3841.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Возможно-ли добавить в ехе файл секцию, которая проектировалась бы в память по адресу меньшему, чем Image Base?
<br>Все мои попыткм добится такого результата в LordPe преводили к тому, что винда ругается, что файл не является приложением Win32
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52030&amp;user=2708&amp;forum_n=5&amp;topic=3841.html&amp;page=0&amp;anchor=1" class="addthx" data-post="52030"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Step[/b]','')">Step</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.6 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.78'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 января 2006 19:39 <br><script type="text/javascript">QU('Step','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Step" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3841.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Хм. Как по втоему, что такое RVA ? Или я не понял сути вопросса?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52031&amp;user=2702&amp;forum_n=5&amp;topic=3841.html&amp;page=0&amp;anchor=2" class="addthx" data-post="52031"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]xDriver[/b]','')">xDriver</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 45.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.71'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=587">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 января 2006 19:55 <br><script type="text/javascript">QU('xDriver','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xDriver" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3841.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
RVA - это сокращение от Relative Virtual Address, т.е. относительный виртуальный адрес. 
<br>Относительно чего? - Относительно Image Base. 
<br>
<br>Отрицательных RVA помоему нет (IMXO)  если я не прав пусть меня поправят.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52035&amp;user=587&amp;forum_n=5&amp;topic=3841.html&amp;page=0&amp;anchor=3" class="addthx" data-post="52035"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Klajnor[/b]','')">Klajnor</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.78'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2708">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 января 2006 20:09 <br><script type="text/javascript">QU('Klajnor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Klajnor" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3841.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>xDriver пишет:
<br>RVA - это сокращение от Relative Virtual Address, т.е. относительный виртуальный адрес. 
<br>Относительно чего? - Относительно Image Base. </I>
<br>Абсолютно согласен
<br>
<br>
<br><I>xDriver пишет:
<br>Отрицательных RVA помоему нет (IMXO) если я не прав пусть меня поправят. </I>
<br>Значит нельзя?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52038&amp;user=2708&amp;forum_n=5&amp;topic=3841.html&amp;page=0&amp;anchor=4" class="addthx" data-post="52038"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 января 2006 20:23 &middot; Поправил: Bitfry <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3841.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Klajnor пишет:
<br>Значит нельзя? </I>
<br>Нельзя.
<br>Если ты не понял из объяснений выше, можно сказать так.
<br><b>Секции и заголовок составляют сам образ.</b>
<br>Вполне можно добавить данные после образа, они не будут грузиться в память из файла, но они не помешают быть ему рабочим ПЕ. Однако никак нельзя ни-то что добавить секцию перед образом, но даже и какие-нибудь другие данные, которые не будут входить в образ.
<br>Это объясняется очень просто. Загрузчик рассчитывает в PE-файле увидеть сразу заголовок ДОС и за ним сигнатуру PE (dword).
<br>Можно только в нутрии образа изгиляться, например секции в файл записывать не в том порядке, в котором они будут размещены в памяти, то есть можно создать PE, где у секции кода будет VA 405000h, за ней в файле пойдёт секция, у которой будет база 401000h.
<br>
<br>Читай статьи по PE-формату:
<br><a href="http://www.exelab.ru/art/pe.php
" target="_new">http://www.exelab.ru/art/pe.php
</a><br><a href="http://www.exelab.ru/art/wasm1.php
" target="_new">http://www.exelab.ru/art/wasm1.php
</a><br><a href="http://www.exelab.ru/art/wasm2.php
" target="_new">http://www.exelab.ru/art/wasm2.php
</a><br>
<br>ЗЫ А зачем тебе это?
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52042&amp;user=410&amp;forum_n=5&amp;topic=3841.html&amp;page=0&amp;anchor=5" class="addthx" data-post="52042"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Klajnor[/b]','')">Klajnor</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.78'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2708">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 января 2006 21:37 <br><script type="text/javascript">QU('Klajnor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Klajnor" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3841.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Для распаковки PESpin (на примере виндовского калькулятора)
<br>При опции API Redirection прот создаёт в памяти область(начало по адресу 790000h), куда пишет код, который вызывает функции API. На простой проге написанной мной за 5 минут просто сдампил эту область( она была по другому адресу; вроде 860000h) и прикрепил к eхе-шнику.
<br>Хотел сделать тоже самое в кальке, но не смог, т.к. у него Image Base = 1000000
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52060&amp;user=2708&amp;forum_n=5&amp;topic=3841.html&amp;page=0&amp;anchor=6" class="addthx" data-post="52060"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]DrGolova[/b]','')">DrGolova</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/301.jpg" alt=""><br><span class=txtSm>Ранг: 199.6 (ветеран), 12thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.84'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=301">Участник</a><br><font color=blue>www.uinc.ru</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 января 2006 21:40 <br><script type="text/javascript">QU('DrGolova','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DrGolova" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3841.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
1) Захукать VirtualAlloc и заставить его выделить память по адресу == ImageSize - получится какраз новая секция
<br>2) Пропатчить в PESpin&#039;овском настройщике импорта один jmp и получить импорт без редирекции
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52064&amp;user=301&amp;forum_n=5&amp;topic=3841.html&amp;page=0&amp;anchor=7" class="addthx" data-post="52064"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Klajnor[/b]','')">Klajnor</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.78'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2708">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 января 2006 22:04 <br><script type="text/javascript">QU('Klajnor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Klajnor" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3841.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>DrGolova пишет:
<br>2) Пропатчить в PESpin&#039;овском настройщике импорта один jmp и получить импорт без редирекции </I>
<br>Лан... Всё-же надо прочитать статью по распаковке =) И время теперь есть =)
<br>Всем спасибо
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52070&amp;user=2708&amp;forum_n=5&amp;topic=3841.html&amp;page=0&amp;anchor=8" class="addthx" data-post="52070"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вопрос по секциям</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=3841" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
