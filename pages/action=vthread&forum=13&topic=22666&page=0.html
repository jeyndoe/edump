<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Снятие, распаковка, модификация, сборка утилиты пирогов - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Привет всем. Ковыряюсь с программой уже долгое время. Опыта и знаний в этом деле 0. Но очень уж интересная тема. Зацепило. Как завороженный прогоняю код через ольку и смотрю что и как. Программа проверяет валидность дампа по">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Снятие, распаковка, модификация, сборка утилиты пирогов</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Nialon[/b]','')">Nialon</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.33'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37001">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 марта 2014 14:19 <br><script type="text/javascript">QU('Nialon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nialon" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22666.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Привет всем. Ковыряюсь с программой уже долгое время.<br>Опыта и знаний в этом деле 0. Но очень уж интересная тема. Зацепило.<br>Как завороженный прогоняю код через ольку и смотрю что и как.<br><br>Программа проверяет валидность дампа по своей базе md5 и прочее.<br>После анализа в консоли выводится кол-во ошибок, предупреждений.<br>При нажатии ввода, выводится страничка с отчетом всего что там есть.<br><br>Задача заменить старые md5 суммы на новые везде где есть строка danger.<br>Просьба у кого есть свободное время поковыряться с этим файлом.<br>Понимаю что кол-во реализаций огромный вариант. Интересно посмотреть кто что умеет.<br>В идеале было неплохо вынести эту базу в отдельный файл для редактирования.<br>Занопить проверку последней версии в инете. Добавить к строке фразу билда (версии) &quot;exp A1&quot;<br>После простой упаковки был одним файлом.<br><br>Все лавры конечно достанутся не мне, обидно до жути. Сурсов нет, иначе было бы проще.<br>Для всего этого безобразия видимо придется снять защиту. В Die 0.82 следующее:<br>1. ASProtect(1.23-2.56)[EXE32] ... + ASPriNFv1.6beta = 2.58 build 11.11<br>2. Enigma Virtual Box(-)[EXE32]<br><br>Список md5 для добавления: <br><br>A95161EFC064B18A405068590CE548AC<br>2273C5B5042B8C7BAA4822C5FF58C30E<br>C5DAD63FC2C6C0733FF05E20331BAC2B<br>E2D1F0C0DB02FB0D739BB95D5313BF4F<br>AC44F0ABEDECD6D290ED24680AA5B552<br>F51B36DD9317B4336482A3728C9A3A4E<br>B59248115B178B29738E0A8BB09C163D<br>38C38C9B244DDF1122033C4A9B3678F6<br>241169F3DB8354FE2089F7B0730291A4<br>EA91617F68E2ABB14C0BFE55F176ED55<br>58A19D8997E4585D1F5552FBF68930C1<br>D087E9700DFD2A17154DA0CF09547961<br>B53CC2DD3566927570915DC408B08B3A<br>183956D2CAAC76B9195299DCF9ACD617<br>441E7B94A34E4B7DF3ADF2C3351C09CF<br>DA235284AB32EB5AD718E2D8F94D8D56<br>B5E03911B5B41D636DCF9D021601D803<br>52A5BD9C26B75036E9D8B5AEB64C56CB<br>81818E9EB8CEAB010B10048385B920CB<br>A0DA2D839F60541613928DD7CB6F0D81<br>8845D70EAB7B28BB829C378A37121DDF <br><br>Одна MD5: B5F54D9A11D1EAE71F35B5907C6B9D3A &#10004; уже в базе. По ней поиск.<br>Все секции распаковываются уже на этапе выбора файла по списку. Эти суммы лежат в приватной безымянной секции. <br>Плюс &quot;exe&quot; запакован в виртуалку, распаковываются еще 19 файлов во время работы в папку pdk-**-**.<br>Массив перебирается модулем perl516.dll как начинается анализ файла (после выбора и отказа 2 раза от патча)<br>Попробовал прикола ради заменить в памяти значения на новые, все отлично.<br><br>В аттаче екзкшник helpme.exe, новый файл для анализа sample.bin .. <br>Для примера отчет файла старой версии где полный гууд.<br>Новый отчет собственно сами сгенерируете вот так: <br><br>Распаковываем все в одну папку, открываем прогу, выбираем цифрой наш сэмпл,<br>отказываемся от патча 2 раза, пойдет распаковка семпла в промежуточный вариант (не нужен),<br>потом анализ с общим выводом сколько там ошибок и прочее .. тыкаем в итоге ввод и откроется страница данных.<br><br>http://rghost.ru/53227835<br><br>Ну-с, буду ждать ответов. На большее меня не хватит.<br>Надеюсь, пинать не будут. ))) Если что упустил, спрашивайте.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=339933&amp;user=37001&amp;forum_n=13&amp;topic=22666.html&amp;page=0&amp;anchor=1" class="addthx" data-post="339933"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Nialon[/b]','')">Nialon</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.33'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37001">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 марта 2014 22:00 &middot; Поправил: Nialon <br><script type="text/javascript">QU('Nialon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nialon" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22666.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
После публикации нашел золотую жилу. Что-ни день замечаю что-то новое. <br>Секция в которой исполняемый код высокого уровня. Видимо, подобие блокнота, которая проходит через перл интерпретатор.<br>Это самое элегантное и простое решение. Не знаю почему там дублирующий код и мусор в конце.<br>Сделал запрет проверки, новую строку и, к сожалению, замененные старые данные. Отчет работает все 100%.<br>Хочу проработать этот вариант дальше. Вопрос гуру форума:<br><br>Как теперь фиксировать эти изменения, какие есть решения и что делать-то дальше.<br>Пробовал через дамп секции в файл, менять данные и загружать, но оля не меняет участок, лишь светит измененные блоки.<br>Причем в конце слишком много отличий. Решение, лучше искать фиксированные наборы байтов и менять. Так надежнее.<br>Плюс в XP и Семерке эта секция динамическая, у них свое расположение. Есть вариант написать скрипт как в плагине? Не?<br>Для примера я все делаю так:<br><br>Запускаю прогу до входа 00401000. Ищу &quot;ntdll.ZwMapViewOfSection&quot; (ctrl+g), ставлю бряк и открываю карту памяти (alt+m).<br>Тыкая F9, слежу за создаваемыми секциями, сразу после большого доб вначале, следующие новые 2 пустые секции.<br>Примечательно в регистре появляется ST5 empty 1000.0. Еще раз F9 и появляются данные в дампе.<br>Ее адрес 495 в семерке и размер 10.000 .. Тыкаем и меняем по адресу 049892FD набор байтов на свой. Все.<br><br>То есть знаю где и что менять в динамике. Теперь нужно решение, зафиксировать на уровне экзешника.<br>Правда это другой вариант, статика, в моем понимании сейчас сделать патч по принципу скриптов в оле.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=339976&amp;user=37001&amp;forum_n=13&amp;topic=22666.html&amp;page=0&amp;anchor=2" class="addthx" data-post="339976"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]vovanre[/b]','')">vovanre</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 92.1 (постоянный), 83thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.9'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=35597">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 марта 2014 22:31 &middot; Поправил: vovanre <br><script type="text/javascript">QU('vovanre','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vovanre" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22666.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Я наверное чегото не понимаю,  но что мешает сделать лоадер , только вместо адресов , сигнатуры  (слово для гугля: AOBscan)<br>Ну или за инлайнить (примеры есть в статьях на главной )
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=339977&amp;user=35597&amp;forum_n=13&amp;topic=22666.html&amp;page=0&amp;anchor=3" class="addthx" data-post="339977"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Nialon[/b]','')">Nialon</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.33'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37001">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2014 19:12 <br><script type="text/javascript">QU('Nialon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nialon" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22666.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
vovanre, все бы ничего, лень вникать в ассемблер.<br>AOBscan работает в паре с &quot;Cheat Engine&quot;? Как-то неудобно будет. Инлайн в этом плане интереснее. <br>Пока не смог найти промежуточную точку от данных до запуска программы. Иначе только цикл.<br>Не написал даже скрипт для оли. Нет толковой документации для bpcnd, FINDMEM.<br>Пардон, только методом тыка. Ссылки мертвые.<br><br>Скачано 6 раз, у кого есть уже результаты, интересное?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340052&amp;user=37001&amp;forum_n=13&amp;topic=22666.html&amp;page=0&amp;anchor=4" class="addthx" data-post="340052"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2014 19:52 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22666.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Nialon пишет:<br>Привет всем. Ковыряюсь с программой уже долгое время.<br>Опыта и знаний в этом деле 0.  </I><br>Не надо было писать целый блог после этих трех предложений. В Вашем случае целесообразно использовать топик &quot;Запросы на взлом программ&quot;.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340053&amp;user=26651&amp;forum_n=13&amp;topic=22666.html&amp;page=0&amp;anchor=5" class="addthx" data-post="340053"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]vovanre[/b]','')">vovanre</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 92.1 (постоянный), 83thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.9'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=35597">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2014 20:32 <br><script type="text/javascript">QU('vovanre','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vovanre" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22666.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>Nialon пишет:<br>AOBscan работает в паре с &quot;Cheat Engine&quot;?  </I><br>Нет. Самый простой вариант:<br>Пишешь dll с аоб сканом. на ЛЮБОМ языке. далее куришь <noindex><a href="http://exelab.ru/art/?action=view&amp;id=367" rel="nofollow" target="_blank">--&gt; Статью &lt;--</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340054&amp;user=35597&amp;forum_n=13&amp;topic=22666.html&amp;page=0&amp;anchor=6" class="addthx" data-post="340054"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Nialon[/b]','')">Nialon</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.33'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37001">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 апреля 2014 13:26 &middot; Поправил: Nialon <br><script type="text/javascript">QU('Nialon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nialon" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22666.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
vovanre, прокурил статью, суть я понял.<br>Написал рабочий скрипт в оле. Написал консоль по замене данных если встать на бряке. <br>В библку недолго переделать.<br><br>Попробовал прикрутить в импорт тестовую функцию через PE_lord. <br>Вроде верно, но ехе крешится еще на запуске и его раздувает в размерах.<br>Там с таблицей бардак. Кто может прикрутить мне библу на любое имя?<br><br>Правда это полбеды, надо знать где. Тоже вопрос.<br>У меня в скрипте стоит бряк по условию: bpcnd 00859DAC, &quot;EAX==00000164&quot;<br>Если писать загрузчик, как имитировать эту строку .. да и как сам загрузчик пишется? <br>Через CreateProcess / Delphi / ? Пойду ковыряться дальше.<br><br>ппс: Прога написана на Visual С++. А там в отличии от Делфи, где-то вычитал, таблицы нет.<br>ТАк что почти все скрипты внекрылова по анпаку не работают по скольку завязана на IAT.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340308&amp;user=37001&amp;forum_n=13&amp;topic=22666.html&amp;page=0&amp;anchor=7" class="addthx" data-post="340308"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]TryAga1n[/b]','')">TryAga1n</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 262.5 (наставник), 337thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.45'>Активность: 0.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=31275">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 апреля 2014 16:01 <br><script type="text/javascript">QU('TryAga1n','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TryAga1n" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22666.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Nialon пишет:<br>Прога написана на Visual С++. А там в отличии от Делфи, где-то вычитал, таблицы нет.<br>ТАк что почти все скрипты внекрылова по анпаку не работают по скольку завязана на IAT.  </I><br>О<br>МОЙ<br>БОГ<br>!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340314&amp;user=31275&amp;forum_n=13&amp;topic=22666.html&amp;page=0&amp;anchor=8" class="addthx" data-post="340314"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=17048" title="06-04-2014 12:37, ранг:96.5" target="_blank">CyberGod</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 апреля 2014 17:14 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22666.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>Nialon</b> для добавления длл и апи в импорт попробуй <b>IIDKing 2.0</b><br><br><I>Nialon пишет:<br>ппс: Прога написана на Visual С++. А там в отличии от Делфи, где-то вычитал, таблицы нет.ТАк что почти все скрипты внекрылова по анпаку не работают по скольку завязана на IAT. </I><br><br>нет - это бред.
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=340317&amp;user=72&amp;forum_n=13&amp;topic=22666.html&amp;page=0&amp;anchor=9" class="addthx" data-post="340317"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Nialon[/b]','')">Nialon</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.33'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37001">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 апреля 2014 10:46 &middot; Поправил: Nialon <br><script type="text/javascript">QU('Nialon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nialon" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22666.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Хорошо, попробую IIDKing 2.0. Уже натыкался <noindex><a href="http://exelab.ru/F/action=vthread&amp;forum=5&amp;topic=18336" rel="nofollow" target="_blank">тут</a></noindex>. Изучаю механизмы инжекта\хука. Бяка..<br><br>Ну вот, теперь я лОсь. Ссылку ту теперь не найду *привет йоде*. )) Значит я чего-то сииильно не понимаю. <br>Могу и по-другому аргументировать. Дуем <noindex><a href="https://ssl.exelab.ru/f/action=vthread&amp;forum=13&amp;topic=11596" rel="nofollow" target="_blank">--&gt; сюда &lt;--</a></noindex>. ОТкрываем часть 2, стр 3. <br>Пардон, я мог перепутать термины INIT. =( Цитирую:<br><br>Если же таблица INIT не закриптована, или она отсутствует (для программ, написанных<br>на других языках программирования), значение флажка Z равно 1,<br>Естественно, что для поиска этой волшебной точки нужно использовать строку ASCII<br>“60”, которая, как я отметил выше, имеется во всех версиях Asprotect.dll.<br><br>Проверял лично, так и есть. МОжно юзать скрипт &quot;Восстановление таблицы INIT.osc&quot;, выскочит окно.<br><br>Вообще отд тема, &quot;Восстановление таблицы IAT и вызовов APIs.osc&quot; восст все вызовы по 0.<br>Хотя скрипт &quot;Поиск OEP (SBOEP).osc&quot; фиксирует наличие:<br><br>          Программа имеет следующие опции защиты:<br>           + эмулированные APIs!<br>           + SBOEP!<br>           + вызовы APIs Asprotect 2.xx SKE!<br><br>И куча другого непонятного. Кто хотя бы ковырялся, в курсе..<br><br><i class=x>&quot;ТАк что почти все скрипты внекрылова по анпаку не работают по скольку завязана на IAT.&quot;</i><br><br>Тут я еще имел ввиду следующее. Это например 10 часть. Глава. 16.3 Цитирую:<br><br>скрипт “Восстановление таблицы IAT и вызовов APIs.osc” сохраняет <br>все основные параметры распаковываемой программы в файле “main_parameters.bin”, <br>который используется при работе скриптов “Восстановление эмулированных подпрограмм в коде программы.osc”,<br>“Устранение проверки целостности кода (CRC) программы.osc”, “Эмуляция APIs Asprotect, <br>вызываемых из кода программы.osc” и “Восстановление секции импорта (.idata) в распакованных программах.osc”.<br><br>Короче все завязано друг на друге, у меня нет файла main_parameters.bin .....
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340331&amp;user=37001&amp;forum_n=13&amp;topic=22666.html&amp;page=0&amp;anchor=10" class="addthx" data-post="340331"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Nialon[/b]','')">Nialon</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.33'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37001">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 апреля 2014 00:07 &middot; Поправил: Nialon <br><script type="text/javascript">QU('Nialon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nialon" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22666.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Перепробовал IIDKing, PElord, Cff. Все что может добавить функцию в импорт.<br>Отлично добавляется, но не работает. Сунул в обычную программу, все грузится вместе с библиотекой. <br>Не понятно почему Import Tible Size меньше чем в оригинале после сборки. Из-за защиты? <br>Тут я уже не силен.. Я так понял импорт прикручивают на распакованный экзешник. печаль.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340378&amp;user=37001&amp;forum_n=13&amp;topic=22666.html&amp;page=0&amp;anchor=11" class="addthx" data-post="340378"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]unknownproject[/b]','')">unknownproject</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.1 (постоянный), 247thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.52'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=27422">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 апреля 2014 01:11 <br><script type="text/javascript">QU('unknownproject','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unknownproject" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22666.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>Nialon пишет:<br>Я так понял импорт прикручивают на распакованный экзешник. печаль.  </I><br>Естественно на распакованный, куда же еще ? Чтобы он функционировал нормально или вообще функционировал как до применения к нему защитных механизмов.
<br><br><font size="1"><i>-----<br>TEST YOUR MIGHT</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=340381&amp;user=27422&amp;forum_n=13&amp;topic=22666.html&amp;page=0&amp;anchor=12" class="addthx" data-post="340381"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Nialon[/b]','')">Nialon</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.33'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37001">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 апреля 2014 15:03 &middot; Поправил: Nialon <br><script type="text/javascript">QU('Nialon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nialon" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22666.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<strike>Туплю, у меня скрипт &quot;Восстановление таблицы IAT и вызовов APIs&quot; клинит на:<br>&quot;Ошибка!!! SBOEP: Таблица прыжков не найдена!&quot; Есть решение?<br>Поэтому нет файла main_parameters.bin, это финал скрипта с дампами и коррекцией..<br><br>Дублирую ссылку на <noindex><a href="https://ssl.exelab.ru/f/files/69ca_18.02.2011_CRACKLAB.rU.tgz" rel="nofollow" target="_blank">скрипты</a></noindex>. Из поста выше.</strike><br><br>Upd: Оказалось, виртуальная машина тоже неправильно работает, включая семерку.<br>На ХР проблема в следующем, не работает скрипт в области 3 прививки API3, при дополнительной защите импорта.<br><br>Сама прививка рабочая, пробовал распаковывать аспр той же версии и опции. Проблема в данных.<br><br>Связанный вопрос, какая стоит защита? Die 0.82 врет или нет?<br>Я так понял сначала пакуется пакет файлов в Enigma Virtual Box, потом на файл - ASProtect.<br>Тогда должен правильно ковыряться с приоритетом, первый ASProtect.<br><br>По хуку zwmapviewofsection ничего не нашел ... Написано: давно известно, уже палится ...<br>Как выглядит толково в реализации не понял и прочее.. Пока забил.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340512&amp;user=37001&amp;forum_n=13&amp;topic=22666.html&amp;page=0&amp;anchor=13" class="addthx" data-post="340512"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Снятие, распаковка, модификация, сборка утилиты пирогов</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#14" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="22666">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22666" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
