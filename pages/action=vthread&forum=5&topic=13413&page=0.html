<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Распаковка ASPack 2.12 с помощью olly - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Добрый день! Решил научится в ручную распаковывать файлы, но не все так просто. Для своей первой распаковки взял блокнот из Win XP, запаковал его ASPack 2.12, и приступил к делу. И так, и спользуя ольку, загружаю прогу, иду на">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка ASPack 2.12 с помощью olly</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Massimo[/b]','')">Massimo</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.56'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19183">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2008 20:53 <br><script type="text/javascript">QU('Massimo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Massimo" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=13413.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Добрый день! Решил научится в ручную распаковывать файлы, но не все так просто.<br><br>Для своей первой распаковки взял блокнот из Win XP, запаковал его ASPack 2.12, и приступил к делу.<br>И так, и спользуя ольку, загружаю прогу, иду на EP:<br><br>01014001 &gt; 60                      PUSHAD<br>01014002   E8 03000000      CALL NOTEPAD.0101400A<br><br>Ставлю бряк hr esp-4, жму F9, останавливаюсь тут:<br><br>010143A7   0BC9                     OR ECX,ECX<br>010143A9   8985 A8030000    MOV DWORD PTR SS:[EBP+3A8],EAX<br>010143AF   61                         POPAD<br><b>010143B0   75 08               JNZ SHORT NOTEPAD.010143BA</b><br>010143B2   B8 01000000        MOV EAX,1<br>010143B7   C2 0C00               RETN 0C<br>010143BA   68 9D730001       PUSH NOTEPAD.0100739D<br>010143BF   C3                         RETN<br><br>Как я понял 0100739D это и есть OEP. Далее зацикливаю программу jmp 010143B0, и F9<br>Потом делаю полный дамп через lordPE.<br>Вычисляю RVA OEP = 0100739D - 1000000 (ImageBase, смотрел в lordpe) = 739D.<br>Потом запускаю дамп (вот тут я не знаю, нормально ли сообщение &quot;Ошибка пр инициали<br>зации приложения&quot;? Ни где про это не нашел) следом запускаю IMPREC, выбираю этот процесс, ввожу в OEP 739D и нажимаю авто поиск и у меня выдается ошибка &quot;Could not find anything good at this OEP!&quot;<br><br>Меня это не остановило, узнаю адресс GetModuleHandleA который равен 7С80b529. Ищу его в дампе через  hex редактор (10сс), смотрю выше и перед нулями 1ый адресс 108С. В lordpe ввожу оффсет 108с, нажимаю DO и он показывает RVA тоже 108с. Далее в IMPREC указываю OEP 739D; RVA 108c, жму Get Imports, и вижу для kernel32 определены 39 функций, а далее у всех стоит Valid: 0. Удаляю их и фиксю дамп. После этого программа не работает. Просто ни чего не происходит. В отладчике программа останавливается на программе call dword ptr ds:[1001338] с сообщением &quot;Dont know how to step becouse memory at address 77c2537c<br><br>Помогите плиз разобраться в чем моя ошибка?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=214419&amp;user=19183&amp;forum_n=5&amp;topic=13413.html&amp;page=0&amp;anchor=1" class="addthx" data-post="214419"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2008 21:52 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=13413.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Что значит &quot;зацикливаю программу jmp 010143B0, и F9&quot;?<br>Перейди на 100739D, и потом сделай дамп. Пока его запускать не надо, импорт ведь не восстановлен. В импреке выбираешь процесс блокнота, который запущен под олей, и когда ты стоишь на OEP. Затем полученный импорт пристыковываешь к сохранненому дампу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=214425&amp;user=4026&amp;forum_n=5&amp;topic=13413.html&amp;page=0&amp;anchor=2" class="addthx" data-post="214425"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Oott[/b]','')">Oott</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/14476.jpg" alt=""><br><span class=txtSm>Ранг: 106.9 (ветеран), 27thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.59'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=14476">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2008 22:51 <br><script type="text/javascript">QU('Oott','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Oott" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=13413.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Цыклить надо в софтайсе, чтобы приложение не смогло ни че инициализировать в секции данных и кода.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=214434&amp;user=14476&amp;forum_n=5&amp;topic=13413.html&amp;page=0&amp;anchor=3" class="addthx" data-post="214434"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2008 22:52 &middot; Поправил: Archer <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=13413.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Циклить надо только под ринг0 отладчиком, иначе просто убежит дальше. А под ринг3, типа ольки, процесс и так стоит, дампи и импорт снимай с него сразу, без зацикливания и без F9.<br>З.Ы. Блё, опоздал на пол минуты <img src="img/smilies/s9.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=214435&amp;user=1556&amp;forum_n=5&amp;topic=13413.html&amp;page=0&amp;anchor=4" class="addthx" data-post="214435"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Massimo[/b]','')">Massimo</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.56'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19183">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 декабря 2008 00:19 <br><script type="text/javascript">QU('Massimo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Massimo" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=13413.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Всем спасибо!!! Все получилось!!! <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=214444&amp;user=19183&amp;forum_n=5&amp;topic=13413.html&amp;page=0&amp;anchor=5" class="addthx" data-post="214444"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 декабря 2008 20:38 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=13413.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Тогда топик можно закрыть, видимо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=214602&amp;user=1556&amp;forum_n=5&amp;topic=13413.html&amp;page=0&amp;anchor=6" class="addthx" data-post="214602"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка ASPack 2.12 с помощью olly</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=13413" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
