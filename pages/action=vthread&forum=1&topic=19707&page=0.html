<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Развёртывание ключа - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Если есть у кого время, укажите правильный ход. Ковыряю BlowFish, начало проверки пароля начинается тут: 0052F398, 005245CC - CryptUnit&#039;(unit шифрования/дешифрования?), 005245F2 (вектор инициализации), длина ключа 10 это то">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a>, <a target='_blank' href='?action=userinfo&amp;user=55940'>exp50848</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Развёртывание ключа</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Rio[/b]','')">Rio</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.5 (постоянный), 36thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.56'>Активность: 0.08<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=8605">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2012 12:58 &middot; Поправил: Rio <br><script type="text/javascript">QU('Rio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rio" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=19707.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Если есть у кого время, укажите правильный ход.<br>Ковыряю BlowFish, начало проверки пароля начинается тут: 0052F398, 005245CC - CryptUnit&#039;(unit шифрования/дешифрования?), 005245F2 (вектор инициализации), длина ключа 10<br>это то что нашёл.<br>Прошу помощи в поиске инициализации BlowFish&#039;a и развёртывания ключа.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302611&amp;user=8605&amp;forum_n=1&amp;topic=19707.html&amp;page=0&amp;anchor=1" class="addthx" data-post="302611"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2012 13:07 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=19707.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Ну вопервых прога делфишная.. во вторых, скачай себе dcpcrypt2-laz-2.0.3-2.zip  эти модуили используюца для работы с blowfish. Далее смотрим модуль DCPblowfish  и функа  <br>function TDCP_blowfish.SelfTest: boolean;<br>покажет тебе на примере,как с ним работать, далее тебе останеца только вытащить ключи и данные
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=302613&amp;user=17319&amp;forum_n=1&amp;topic=19707.html&amp;page=0&amp;anchor=2" class="addthx" data-post="302613"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Rio[/b]','')">Rio</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.5 (постоянный), 36thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.56'>Активность: 0.08<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=8605">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2012 13:25 &middot; Поправил: Rio <br><script type="text/javascript">QU('Rio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rio" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=19707.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
спасибо VodoleY, уже накидал:<br>http://rghost.ru/37228703<br>так?<br>вот:<br>class function TDCP_blowfish.SelfTest: boolean;<br>const<br>  Key1: array[0..7] of byte= (&#036;00,&#036;00,&#036;00,&#036;00,&#036;00,&#036;00,&#036;00,&#036;00);<br>  Key2: array[0..7] of byte= (&#036;7C,&#036;A1,&#036;10,&#036;45,&#036;4A,&#036;1A,&#036;6E,&#036;57);<br>  InData1: array[0..7] of byte= (&#036;00,&#036;00,&#036;00,&#036;00,&#036;00,&#036;00,&#036;00,&#036;00);<br>  InData2: array[0..7] of byte= (&#036;01,&#036;A1,&#036;D6,&#036;D0,&#036;39,&#036;77,&#036;67,&#036;42);<br>  OutData1: array[0..7] of byte= (&#036;4E,&#036;F9,&#036;97,&#036;45,&#036;61,&#036;98,&#036;DD,&#036;78);<br>  OutData2: array[0..7] of byte= (&#036;59,&#036;C6,&#036;82,&#036;45,&#036;EB,&#036;05,&#036;28,&#036;2B);<br>var<br>  Cipher: TDCP_blowfish;<br>  Data: array[0..7] of byte;<br>begin<br>  Cipher:= TDCP_blowfish.Create(nil);<br>  Cipher.Init(Key1,Sizeof(Key1)*8,nil);<br>  Cipher.EncryptECB(InData1,Data);<br>  Result:= boolean(CompareMem(@Data,@OutData1,Sizeof(Data)));<br>  Cipher.Reset;<br>  Cipher.DecryptECB(Data,Data);<br>  Result:= boolean(CompareMem(@Data,@InData1,Sizeof(Data))) and Result;<br>  Cipher.Burn;<br>  Cipher.Init(Key2,Sizeof(Key2)*8,nil);<br>  Cipher.EncryptECB(InData2,Data);<br>  Result:= boolean(CompareMem(@Data,@OutData2,Sizeof(Data))) and Result;<br>  Cipher.Reset;<br>  Cipher.DecryptECB(Data,Data);<br>  Result:= boolean(CompareMem(@Data,@InData2,Sizeof(Data))) and Result;<br>  Cipher.Burn;<br>  Cipher.Free;<br>end;<br>.................<br>Далее идёт как раз инициализация<br>но в оле на асме?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302615&amp;user=8605&amp;forum_n=1&amp;topic=19707.html&amp;page=0&amp;anchor=3" class="addthx" data-post="302615"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2012 13:37 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=19707.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
чет я не понял.. Cipher.InitStr(KeyStr,TDCP_md5);  это как? но вникать ща некогда.<br>Cipher.EncryptString(Memo1.Lines[i]); у тебя в мемо, список зашифрованных строк чели?<br>чет мне подсказывает что InitStr не из этой оперы<br>З.ы. естественно на асме. тебе модуль дал, чтоб ты код СРАВНИВАЛ. а не изобретал велик, реверсирую и отлаживая асм код. Во первых убедись, что это точно этот модуль используеца, дальше пообзывай Call addr правильными именами, а там уже смотри входные выходные данные
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=302617&amp;user=17319&amp;forum_n=1&amp;topic=19707.html&amp;page=0&amp;anchor=4" class="addthx" data-post="302617"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Rio[/b]','')">Rio</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.5 (постоянный), 36thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.56'>Активность: 0.08<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=8605">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2012 13:56 &middot; Поправил: Rio <br><script type="text/javascript">QU('Rio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rio" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=19707.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
&gt;&gt;Cipher.EncryptString(Memo1.Lines[i]); у тебя в мемо, список зашифрованных строк чели?<br>да.<br>&gt;&gt;Во первых убедись, что это точно этот модуль<br>DCPcrypt2.<br>этот.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302619&amp;user=8605&amp;forum_n=1&amp;topic=19707.html&amp;page=0&amp;anchor=5" class="addthx" data-post="302619"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2012 14:09 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=19707.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
DCPcrypt2 это как бы глобальный модуль, из которого вызываеца остальное.. вобщем обзывай функи, и разбирайся. по факту у тебя все есть. сверяй куски промежуточного кода с результатами из ольки
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=302622&amp;user=17319&amp;forum_n=1&amp;topic=19707.html&amp;page=0&amp;anchor=6" class="addthx" data-post="302622"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2012 14:23 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=19707.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
создай при помощи idr мап файл, после чего подгрузи его в ольку при помощи плагина mapimp, сразу станет видней что где и как вызывается.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302623&amp;user=5291&amp;forum_n=1&amp;topic=19707.html&amp;page=0&amp;anchor=7" class="addthx" data-post="302623"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2012 14:24 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=19707.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>Vovan666</b> +1 <img src="img/smilies/s1.gif" alt=""> но я предпочитаю делать это руками, на верочку...
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=302624&amp;user=17319&amp;forum_n=1&amp;topic=19707.html&amp;page=0&amp;anchor=8" class="addthx" data-post="302624"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Rio[/b]','')">Rio</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.5 (постоянный), 36thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.56'>Активность: 0.08<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=8605">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2012 09:18 <br><script type="text/javascript">QU('Rio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rio" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=19707.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
&gt;&gt;Vovan666:<br>&gt;&gt;создай при помощи idr мап файл<br>Спс Vovan666,сделал.<br>С помощью Idr декомпилировал.<br>...............................................................<br>005245CC по этому адресу подключается модуль CryptUnit, далее - 0051F580 создаётся класс <br>BlowFish, вот здесь непонятно что это за набор символов:<br>00524626   MOV EAX, &lt;aEExC85MrjdNj_g&gt; ;  ASCII &quot;e&lt;}^eX[c8/5)MrjD,NJ_Ge0U&amp;wG.:w/r&quot;<br>0052462B  |.  E8 785CEEFF   CALL &lt;Sysutils::StrLen(char *)&gt; (кол. символов строки)<br>далее по адресу 0052043D происходит инициализация (TDCP_blowfish.InitKey).<br>далее (как в исходнике) 00520465 - CALL &lt;System::Move(void *,void *,int) и<br>                        0052047A - CALL &lt;System::Move(void *,void *,int)&gt;<br>..Move(SBoxOrg,SBox,Sizeof(SBox));// из исходника<br>  Move(PBoxOrg,PBox,Sizeof(PBox));<br>..<br>00402A59 - REP MOVS DWORD PTR ES:[EDI], DWORD PTR D (здесь подключи?)<br>далее опять считывается посимвольно &quot;e&lt;}^eX[c8/5)MrjD,NJ_Ge0U&amp;wG.:w/r&quot;<br>потом:<br> for i:= 0 to 8 do<br>  begin<br>    EncryptECB(Block,Block);<br>    PBox[i*2]:= dword(Block[3]) + (dword(Block[2]) shl 8) + (dword(Block[1]) shl 16) + (dword(Block[0]) shl 24);<br>    PBox[i*2+1]:= dword(Block[7]) + (dword(Block[6]) shl 8) + (dword(Block[5]) shl 16) + (dword(Block[4]) shl 24);<br>  end;// из исходника<br>а, в оле:<br>005204F0 &gt; &gt; /8D4C24 08     LEA ECX, DWORD PTR SS:[ESP+8]            ;  loc_5204F0<br>005204F4   . |8D5424 08     LEA EDX, DWORD PTR SS:[ESP+8]<br>005204F8   . |8BC6          MOV EAX, ESI<br>005204FA   . |8B38          MOV EDI, DWORD PTR DS:[EAX]<br>005204FC   . |FF57 6C       CALL DWORD PTR DS:[EDI+6C]<br>005204FF   . |33D2          XOR EDX, EDX<br>00520501   . |8A5424 0B     MOV DL, BYTE PTR SS:[ESP+B]<br>00520505   . |33C9          XOR ECX, ECX<br>00520507   . |8A4C24 0A     MOV CL, BYTE PTR SS:[ESP+A]<br>0052050B   . |C1E1 08       SHL ECX, 8<br>0052050E   . |03D1          ADD EDX, ECX<br>00520510   . |33C9          XOR ECX, ECX<br>00520512   . |8A4C24 09     MOV CL, BYTE PTR SS:[ESP+9]<br>00520516   . |C1E1 10       SHL ECX, 10<br>00520519   . |03D1          ADD EDX, ECX<br>0052051B   . |33C9          XOR ECX, ECX<br>0052051D   . |8A4C24 08     MOV CL, BYTE PTR SS:[ESP+8]<br>00520521   . |C1E1 18       SHL ECX, 18<br>00520524   . |03D1          ADD EDX, ECX<br>00520526   . |8BC3          MOV EAX, EBX<br>00520528   . |03C0          ADD EAX, EAX<br>0052052A   . |899486 481000&gt;MOV DWORD PTR DS:[ESI+EAX*4+1048], EDX<br>00520531   . |33D2          XOR EDX, EDX<br>00520533   . |8A5424 0F     MOV DL, BYTE PTR SS:[ESP+F]<br>00520537   . |33C9          XOR ECX, ECX<br>00520539   . |8A4C24 0E     MOV CL, BYTE PTR SS:[ESP+E]<br>0052053D   . |C1E1 08       SHL ECX, 8<br>00520540   . |03D1          ADD EDX, ECX<br>00520542   . |33C9          XOR ECX, ECX<br>00520544   . |8A4C24 0D     MOV CL, BYTE PTR SS:[ESP+D]<br>00520548   . |C1E1 10       SHL ECX, 10<br>0052054B   . |03D1          ADD EDX, ECX<br>0052054D   . |33C9          XOR ECX, ECX<br>0052054F   . |8A4C24 0C     MOV CL, BYTE PTR SS:[ESP+C]<br>00520553   . |C1E1 18       SHL ECX, 18<br>00520556   . |03D1          ADD EDX, ECX<br>00520558   . |899486 4C1000&gt;MOV DWORD PTR DS:[ESI+EAX*4+104C], EDX<br>0052055F   . |43            INC EBX<br>00520560   . |83FB 09       CMP EBX, 9<br>00520563   .^\75 8B         JNZ SHORT &lt;loc_5204F0&gt;<br>.............................................................................<br>правильно ли я нашёл место инициализации?<br>какие должны быть дальнейшие действия?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302649&amp;user=8605&amp;forum_n=1&amp;topic=19707.html&amp;page=0&amp;anchor=9" class="addthx" data-post="302649"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2012 09:30 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=19707.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>Rio</b> для начала выяснить, откуда ростут ноги у строчки &quot;e&lt;}^eX[c8/5)MrjD,NJ_Ge0U&amp;wG.:w/r&quot; если она константа (в экзешнике в чистом виде) то смело ее тырим (посмотрел в экзешнике.. да, это константа)<br>  Cipher:= TDCP_blowfish.Create(nil);<br>  Cipher.Init(Key1,Sizeof(Key1)*8,nil); Зашифровали<br>  Cipher.EncryptECB(InData1,Data);<br> <br><br>  Cipher.Reset;<br>  Cipher.DecryptECB(Data,Data); расшифровали<br>  Cipher.Burn; <br>PBox[i*2]:= dword(Block[3]) + (dword(Block[2]) shl 8) + (dword(Block[1]) shl 16) + (dword(Block[0]) shl 24);<br>PBox[i*2+1]:= dword(Block[7]) + (dword(Block[6]) shl 8) + (dword(Block[5]) shl 16) + (dword(Block[4]) shl 24);<br>dword-ов ты зря налипил, имхо. разбирай дальше, где входные данные, где зашишфрованные /расшифрованные, пробуй делать в делфе аналог
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=302650&amp;user=17319&amp;forum_n=1&amp;topic=19707.html&amp;page=0&amp;anchor=10" class="addthx" data-post="302650"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Rio[/b]','')">Rio</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.5 (постоянный), 36thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.56'>Активность: 0.08<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=8605">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2012 09:31 &middot; Поправил: Rio <br><script type="text/javascript">QU('Rio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rio" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=19707.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
to:VodoleY<br>&gt;&gt;если она константа <br>да.<br>там в exe&#039;шнике в открытом виде упоминается md5,sha1, а константы:&quot;e&lt;}^eX[c8/5)MrjD,NJ_Ge0U&amp;wG.:w/r&quot; и<br>&quot;X]FSD!d%&quot;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302651&amp;user=8605&amp;forum_n=1&amp;topic=19707.html&amp;page=0&amp;anchor=11" class="addthx" data-post="302651"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2012 09:55 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=19707.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
хех.. ну вот смотри.. руками, без др. инструментов... ты дал адресс 0052462B я прошелся чуть ниже <br>00524649  |. 8B45 08        MOV EAX,DWORD PTR SS:[EBP+8]<br>переходим на смотрим ниже<br> 0051F76C  /. 55             PUSH EBP<br> 0051F76D  |. 8BEC           MOV EBP,ESP<br>подымаем глазки чуть высше..  <br>хитрая процедурка <br>0051F764   . B8 40000000    MOV EAX,40<br>0051F769   . C3             RETN<br>типа result:=64 <br>еще высше глазки...<br>0051F638   . 00F75100       DD testexam.0051F700                     ;  ASCII 12,&quot;TDCP_blockcipher64&quot;<br>0051F63C     48             DB 48                                    ;  CHAR &#039;H&#039;<br>Теперь ищем это дело в pas файлах, этой либы<br>unit DCPblockciphers;<br>...  <br> TDCP_blockcipher64= class(TDCP_blockcipher)<br>  private<br>    IV, CV: array[0..7] of byte;<br><br><br>.....<br><br>class function TDCP_blockcipher64.GetBlockSize: integer;<br>begin<br>  Result:= 64;<br>end;<br><br>procedure TDCP_blockcipher64.Init(const Key; Size: longword; InitVector: pointer);<br>begin<br>  inherited Init(Key,Size,InitVector);<br>  InitKey(Key,Size);<br>  if InitVector= nil then<br>  begin<br>    FillChar(IV,8,{&#036;IFDEF DCP1COMPAT}&#036;FF{&#036;ELSE}0{&#036;ENDIF});<br>    EncryptECB(IV,IV);<br>    Reset;<br>  end<br>  else<br>  begin<br>    Move(InitVector^,IV,8);<br>    Reset;<br>  end;<br>end;<br>похоже? асм и пас?  вот таким образом (или ищи свой )ты должен обозвать все процедурки для того чтоб было проще разбираца, после этого написать аналог этого кода на делфе. дирзай<br><br><br>0051F49C  /. 55             PUSH EBP<br>0051F49D  |. 8BEC           MOV EBP,ESP<br>0051F49F  |. 53             PUSH EBX<br>0051F4A0  |. 56             PUSH ESI<br>0051F4A1  |. 57             PUSH EDI<br>0051F4A2  |. 8BFA           MOV EDI,EDX<br>..... ==  unit DCPcrypt2;<br>procedure TDCP_blockcipher.Decrypt(const Indata; var Outdata; Size: longword);<br>begin<br>  case fCipherMode of<br>    cmCBC: DecryptCBC(Indata,Outdata,Size);<br>    cmCFB8bit: DecryptCFB8bit(Indata,Outdata,Size);<br>    cmCFBblock: DecryptCFBblock(Indata,Outdata,Size);<br>    cmOFB: DecryptOFB(Indata,Outdata,Size);<br>    cmCTR: DecryptCTR(Indata,Outdata,Size);<br>  end;<br>end;
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=302653&amp;user=17319&amp;forum_n=1&amp;topic=19707.html&amp;page=0&amp;anchor=12" class="addthx" data-post="302653"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Rio[/b]','')">Rio</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.5 (постоянный), 36thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.56'>Активность: 0.08<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=8605">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2012 10:15 &middot; Поправил: Rio <br><script type="text/javascript">QU('Rio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rio" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=19707.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Спасибо VodoleY, буду &quot;копать&quot;...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302654&amp;user=8605&amp;forum_n=1&amp;topic=19707.html&amp;page=0&amp;anchor=13" class="addthx" data-post="302654"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Развёртывание ключа</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19707" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
