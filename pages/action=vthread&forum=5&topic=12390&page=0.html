<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Пара вопросов по инлайн-патчу ASPack&#039;а - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Пробую сделать инлайн патч, читаю статейки, и кое-что непонятно. Вот выдержки из --&gt; статьи &lt;-- Bad_guy&#039;а &quot;Полуавтоматическая распаковка ASPack 2.12 за 29 секунд&quot;: беру и нахожу прогу запакованную ASPack 2.12">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Пара вопросов по инлайн-патчу ASPack&#039;а</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 июля 2008 02:08 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Пробую сделать инлайн патч, читаю статейки, и кое-что непонятно. Вот выдержки из <a href="http://www.exelab.ru/art/?action=view&amp;id=156" target="_blank">--&gt; статьи &lt;--</a> Bad_guy&#039;а &quot;Полуавтоматическая распаковка ASPack 2.12 за 29 секунд&quot;:<br><br><code>беру и нахожу прогу запакованную ASPack 2.12 ..., ищу там эти самые опкоды (68 00 00 00 00 C3)...<br>...вот еще одна интересность, которую можно провернуть с аспаком, да и почти любым другим упакованным файлом:<br>Вспомним<br>push 00D63B9C<br>ret<br>но нам ведь вовсе не обязательно сейчас прыгать на Entry Point, нам же надо прогу попатчить...<br>...Тогда вместо push 00D63B9C можно написать jmp 12345678</code><br><br>Так вот, непонятно, как можно вместо push 00D63B9C написать jmp 12345678. Ведь 4 байта в этом месте во время распаковки затираются: вместо PUSH 0 появляется PUSH OEP, а если написать jmp 12345678, то вместо этого получится JMP OEP.<br>Второй вопрос по <a href="http://www.exelab.ru/art/?action=view&amp;id=303" target="_blank">--&gt; статье &lt;--</a> BiT-H@ck&#039;а &quot;Объективный взгляд на DrWeb&quot;<br><br><code>...Теперь будем писать так называемый in-line патч. Грузим в олю запакованный файл и ищем переход на ОЕР. Вот:<br>004C43AF	61		POPAD<br>004C43B0	7508		JNZ SHORT 004C43BA<br>004C43B2	B801000000	MOV EAX, 1<br>...<br>Теперь ищем место под патч. Я взял вот тут:<br>004C6AB5	00	DB 00<br>...<br>Теперь переход по адресу 004C43B0 перенаправляем на будущий патч</code><br><br>И как перенаправить этот переход, ведь там JNZ - SHORT, и до адреса 004С6АB5 он никак не достанет, значит будет JNZ обычный, который затрет MOV EAX,1.<br>Кто нибудь может просветить по этим двум вопросам?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=196708&amp;user=4026&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=1" class="addthx" data-post="196708"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 июля 2008 10:22 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
В ASPack под PUSH OEP зарезервирована пятибайтная команда:<br>6800000000 PUSH  0<br>C3                 RET<br>Ее легко заменить на jmp 12345678, то же  пятибайтная команда. А еще лучше менять на <br>PUSH адрес инлайна (не надо высчитывать смещение джампа). Тогда по RET ты перейдешь на свой код.<br>Но в этом случае необходимо учесть, что байты после 68 будут затерты предыдущей командой. Ее нужно нопить. Это что касается метода Bad_guy&#039;а <br>У BiT-H@ck&#039;а проще, он меняет команду которая не затирается. <I>SVLab пишет:<br>ведь там JNZ - SHORT, и до адреса 004С6АB5 он никак не достанет </I> <br>Но ты то напишешь длинный джамп, который достанет<img src="img/smilies/s5.gif" alt=""> А то что следующие команды затрутся, не обращай внимания. Они не выполнятся.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=196722&amp;user=423&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=2" class="addthx" data-post="196722"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 июля 2008 00:17 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>crc1 пишет:<br>А то что следующие команды затрутся, не обращай внимания. Они не выполнятся. </I><br>Когда все проходит нормально, эти команды действительно не выполняются, но разве можно на 100% исключить ситуацию, когда они все-таки выполнятся.<br>А насчет того, чтобы занопить команду, затирающую PUSH, действительно - это решение, почему я сам не додумался? Спасибо, <b>crc1</b>. И почему в статье об этом ничего не сказано?<br>Но есть еще один способ перехода к инлайну, когда ничего не затрется и не нужно ничего нопить. Когда смотрел, что нопить, увидел смещение на OEP открытым текстом<br><code>MOV EAX,offset<br>PUSH EAX<br>ADD EAX,DWORD PTR SS:[EBP+422]<br>POP ECX<br>OR ECX,ECX<br>MOV DWORD PTR SS:[EBP+3A8],EAX<br>POPAD<br>JNZ SHORT 006003BA<br>MOV EAX,1<br>RETN 0C<br>PUSH 0<br>RETN</code><br>В этот MOV EAX,offset и можно записать смещение на инлайн, а вообще, вариантов здесь куча.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=196766&amp;user=4026&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=3" class="addthx" data-post="196766"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 июля 2008 05:04 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>SVLab пишет:<br>Когда смотрел, что нопить, увидел смещение на OEP открытым текстом </I><br>Оно и лежит в табличке вместе с базой , иат и т.д Ну и пиши туда нужное тебе значение
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=196775&amp;user=293&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=4" class="addthx" data-post="196775"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 июля 2008 03:07 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Писать, в смысле, в табличку? Только что-то я не нашел ничего похожего на такую табличку. Как ее искать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=196825&amp;user=4026&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=5" class="addthx" data-post="196825"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 августа 2008 13:51 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Кто нибудь может просветить по этим двум вопросам?</b><br>Объяснять тут особо нечего, при дальнем переходе( а переход будет действительно дальним) комада MOV EAX,1 (или какая-то другая в любом другом пакере при написании инлайна при таких же условиях) затрётся, но после дальнего перехода можно пропатчить код, выполнить затёртую команду и радоваться жизни<img src="img/smilies/s8.gif" alt="">
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=198076&amp;user=6336&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=6" class="addthx" data-post="198076"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]aspirin[/b]','')">aspirin</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/5336.gif" alt=""><br><span class=txtSm>Ранг: 111.0 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.05'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5336">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2008 15:32 <br><script type="text/javascript">QU('aspirin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=aspirin" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>SVLab пишет:<br>беру и нахожу прогу запакованную ASPack 2.12 ..., ищу там эти самые опкоды (68 00 00 00 00 C3)...<br>...вот еще одна интересность, которую можно провернуть с аспаком, да и почти любым другим упакованным файлом:<br>Вспомним<br>push 00D63B9C<br>ret  </I><br>зачем так заморачиваться, можно же проще HR ESP-4, лично я так делаю.<br>push 00D63B9C - это адрес твоего ОЕР, поэтому я не трогаю этот код.<br><I>SVLab пишет:<br>...Теперь будем писать так называемый in-line патч. Грузим в олю запакованный файл и ищем переход на ОЕР. Вот:<br>004C43AF 61 POPAD<br>004C43B0 7508 JNZ SHORT 004C43BA<br>004C43B2 B801000000 MOV EAX, 1<br>...<br>Теперь ищем место под патч. Я взял вот тут:<br>004C6AB5 00 DB 00<br>...<br>Теперь переход по адресу 004C43B0 перенаправляем на будущий патч<br><br>И как перенаправить этот переход, ведь там JNZ - SHORT, и до адреса 004С6АB5 он никак не достанет, значит будет JNZ обычный, который затрет MOV EAX,1.<br>Кто нибудь может просветить по этим двум вопросам? </I><br>004C43B0 7508 JNZ SHORT 004C43BA - я просто меняю этот код на JMP xxx(х -адрес моего кода на нулях) , Short тоже убираю.
<br><br><font size="1"><i>-----<br>Ламер - не профессия :))</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=198367&amp;user=5336&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=7" class="addthx" data-post="198367"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2008 17:58 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Что-то мне подсказывает, что автор уже разобрался 33 раза, хорош топик поднимать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=198400&amp;user=1556&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=8" class="addthx" data-post="198400"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 августа 2008 03:07 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Прошу прощения, но еще раз подниму тему.<br>С инлайном я, действительно, давно разобрался:<br><I>SVLab пишет:<br>В этот MOV EAX,offset и можно записать смещение на инлайн</I><br><br><b>aspirin</b><br>Может, я не совсем правильно оформил пост, но написанное моноширинным шрифтом - это не я пишу, а там_же_упомянутые авторы статей - Bad_guy и BiT-H@ck. <img src="img/smilies/s2.gif" alt=""><br><br>И хотелось бы выяснить возникший попутно вопрос: о какой табличке писал <b>pavka</b> в своем посте?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=199416&amp;user=4026&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=9" class="addthx" data-post="199416"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 августа 2008 08:44 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Видимо про ту внутреннюю табличку, в которую аспак складывает нужные для себя значения и данные: оеп, таблицу импорта, релоки и тд.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=199431&amp;user=1556&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=10" class="addthx" data-post="199431"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 августа 2008 08:50 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>SVLab пишет:<br>попутно вопрос: о какой табличке писал pavka в своем посте? </I><br> а чего там выяснять в 2.12 к примеру ставь бряк на GetModuleHandleA<br>erun<br>erun<br>bc eip<br>rtu<br>в esi будет IAT VA отнимай базу и ищи в загрузчке &#036;RESULT-4<br>==OEP RVA
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=199433&amp;user=293&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=11" class="addthx" data-post="199433"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 августа 2008 01:43 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>pavka</b><br>Ты так пишешь, как будто мои познания равны твоим. <b>bc eip</b> похоже на снятие точки останова с eip, а что такое <b>erun</b>, <b>rtu</b>? Это команды скрипта или что-то другое?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=199542&amp;user=4026&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=12" class="addthx" data-post="199542"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 августа 2008 08:06 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Это всё скрипт для ольки, почитай ман по скриптам.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=199547&amp;user=1556&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=13" class="addthx" data-post="199547"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 августа 2008 17:56 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Вообще-то, я сразу попробовал запустить этот скрипт, но Olly споткнулась на erun, т.к. скриптовая dll была старая (0.85). Нашел новую, сделал такой скрипт:<br><code>gpa &quot;GetModuleHandleA&quot;, &quot;Kernel32.dll&quot;<br>bp &#036;RESULT<br>erun<br>erun<br>bc eip <br>rtu</code><br>В ESI получаю IAT VA, а вот дальше мне не совсем понятно:<br><I>pavka пишет:<br>отнимай базу и ищи в загрузчке &#036;RESULT-4 <br>==OEP RVA </I><br>Т.е. от ESI надо отнять 400000 (получить IAT RVA) и полученное значение найти в модуле Aspack&#039;а, найденный результат вернется в &#036;RESULT, от которой надо отнять 4 и получится адрес, по которому будет лежать OEP RVA. Дописал скрипт:<br><code>var _esi<br>mov _esi,esi<br>sub _esi,400000<br>find 8b3000, _esi<br>log &#036;RESULT-4</code><br>Или я что-то делаю не так, или... что-то не так делаю. Вобщем, находится адрес, где IAT RVA грузится в ESI. И по адресу &#036;RESULT-4 нет никакого намека ни на OEP RVA ни на какую-нибудь таблицу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=199679&amp;user=4026&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=14" class="addthx" data-post="199679"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 августа 2008 08:53 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>SVLab пишет:<br>crc1 пишет: <br>А то что следующие команды затрутся, не обращай внимания. Они не выполнятся. <br>Когда все проходит нормально, эти команды действительно не выполняются, но разве можно на 100% исключить ситуацию, когда они все-таки выполнятся. </I><br>mov eax,1 - выполняется только если файл - DLL. Если не dll то никогда не выполнится.<br><br><b>SVLab</b> поищи статик анпакер доктора Головы, он там по определенному смещению табличку читает. Или посмотри динамик анпакер йоды, он вообще для разных аспаков по разным смещениям табличку берет.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=200041&amp;user=3232&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=15" class="addthx" data-post="200041"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 августа 2008 02:24 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>mov eax,1 - выполняется только если файл - DLL </I><br>Понял, спасибо за информацию.<br><br><I>PE_Kill пишет:<br>поищи статик анпакер доктора Головы ... Или посмотри динамик анпакер йоды </I><br>Ты имеешь в виду, посмотреть исходники? Посмотрел AspackDie1.4 yoda. И что же там видно? А видно, что у разных версий пакера OEP RWA и IAT RWA лежат то рядышком (т.е. можно говорить о табличке), то сравнительно далеко друг от друга (как у 2.12) прямо в исполняемом коде. И в этом случае говорить о таблице, содержащей OEP RWA и IAT RWA, нельзя, так как онной не существует.<br>Кстати, этот анпакер не смог распаковать ни одного из трех имеющихся у меня файлов, запакованных Aspack&#039;ом. В двух случаях вообще не определил, что это Aspack (2.12b по PEiD0.94), хотя о поддержке написано, а в одном неправильно определил версию, и файл получился нерабочий. А может это разработчики программ постарались и защитили свои творения от автоматов.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=200120&amp;user=4026&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=16" class="addthx" data-post="200120"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 августа 2008 09:54 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>SVLab пишет:<br>Кстати, этот анпакер не смог распаковать ни одного из трех имеющихся у меня файлов </I><br>Юзай мой. Он на защиту от автоанпакеров не обращает внимания.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=200143&amp;user=3232&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=17" class="addthx" data-post="200143"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 августа 2008 13:17 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>SVLab пишет:<br>А видно, что у разных версий пакера OEP RWA и IAT RWA лежат то рядышком (т.е. можно говорить о табличке), то сравнительно далеко друг от друга (как у 2.12) прямо в исполняемом коде. И в этом случае говорить о таблице, содержащей OEP RWA и IAT RWA, нельзя, так как онной не существует. </I><br>Это твое личное имхо ;) Вобще я не понимаю в чем твои претензии ? Тебя ткнули носом, надо рой дальше <img src="img/smilies/s1.gif" alt=""> Да естественно разные версии аспака различаются <img src="img/smilies/s1.gif" alt=""> притом довольно сильно если брать первую и последнюю <img src="img/smilies/s1.gif" alt=""> Любой пакер, протектор сохранет информацию о структуре обработаного Pe , и если ты ее не видишь или не можешь найти это не значит сто ее нет
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=200175&amp;user=293&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=18" class="addthx" data-post="200175"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 августа 2008 16:01 &middot; Поправил: SVLab <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>Юзай мой </I><br>Спасибо. Ради интереса попробовал. Те, которые были запакованы 2.12b, после распаковки нормально работают, а третий (2.001 по PEiD) при запуске выдает Runtime error 216 at 000032D4. Хотя файл этот немного странный - с двумя секциями .rsrc, одна до Aspack&#039;а, другая - нулевого размера - после. Возможно, из-за удаления второй вместе с Aspack&#039;ом, файл и получается нерабочим.<br><I>pavka пишет:<br>Это твое личное имхо </I><br>Возможно и так, но оно основано на том, что я вижу в конкретных файлах.<br><I>pavka пишет:<br>Вобще я не понимаю в чем твои претензии ? </I><br>Да с чего ты взял, что у меня есть претензии? <img src="img/smilies/s1.gif" alt=""><br><I>pavka пишет:<br>Тебя ткнули носом, надо рой дальше </I><br>Так я, вроде, и рою... с вашей помощью<br><I>pavka пишет:<br>Любой пакер, протектор сохранет информацию о структуре обработаного Pe</I><br>Конечно, сохраняет. Кто же это отрицает? Вопрос в том, всегда ли используется для этого какая-либо структура (т.е. табличка), или некоторые данные могут сохраняться прямо в исполняемом коде упаковщика. Ты утверждаешь первое, я - второе (хотя спорить с авторитетами - дело опасное :s1<img src="img/smilies/s1.gif" alt=""><br><I>pavka пишет:<br>если ты ее не видишь или не можешь найти это не значит сто ее нет </I><br>Почему же не могу? И нахожу, и вижу. Конкретный пример (Offline explorer enterprise 3.7.2008SR1 - Aspack2.12b):<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">008B3279</span>&nbsp;&nbsp;&nbsp;&nbsp;BE&nbsp;<span class="hl_number">00703A00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ESI</span><span class="hl_char">,</span><span class="hl_number">3A7000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">3A7000</span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;IAT&nbsp;RVA</li><li class="hl_l1"><span class="hl_char">.</span>&nbsp;<span class="hl_char">.</span>&nbsp;<span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_number">008B339B</span>&nbsp;&nbsp;&nbsp;&nbsp;B8&nbsp;B40C3800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">380CB4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">380CB4</span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;OEP&nbsp;RVA</li>        </ol>
    </div>
</div></div>
<br><br>Я только не вижу, где же тут таблица?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=200195&amp;user=4026&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=19" class="addthx" data-post="200195"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 августа 2008 16:34 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>SVLab пишет:<br>Я только не вижу, где же тут таблица? </I><br>А зачем ты привел здесь этот код ? Что я должен здесь увидеть? <img src="img/smilies/s1.gif" alt=""> <I>SVLab пишет:<br>Вопрос в том, всегда ли используется для этого какая-либо структура (т.е. табличка), или некоторые данные могут сохраняться прямо в исполняемом коде упаковщика </I><br>Хм а в чем разница? <img src="img/smilies/s1.gif" alt="">)Имхо или ты не внимательно читаешь или просто не понимаешь о чем идет речь
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=200200&amp;user=293&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=20" class="addthx" data-post="200200"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 августа 2008 19:51 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Код я привел что бы развеять твои сомнения в моей способности найти и увидеть эти RVA.<br><I>pavka пишет:<br>Хм а в чем разница? </I><br>Разницы, в принципе, нет. А читаю я внимательно (не всегда понимаю - это точно). Просто после твоего поста<br><I>pavka пишет:<br>Оно и лежит в табличке вместе с базой , иат и т.д  </I>,<br>пояснения Archer&#039;а<br><I>Archer пишет:<br>Видимо про ту внутреннюю табличку, в которую аспак складывает нужные для себя значения и данные: оеп, таблицу импорта, релоки и тд. </I><br>и твоего поста со скриптом, я стал искать эту табличку (где лежат OEP RVA и IAT RVA), но в Aspack2.12 и некоторых других версиях этого пакера такой таблицы просто нет. Нельзя же назвать таблицей приведенный выше код. И что же я здесь не понимаю?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=200214&amp;user=4026&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=21" class="addthx" data-post="200214"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 августа 2008 10:26 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>SVLab пишет:<br>но в Aspack2.12 и некоторых других версиях этого пакера такой таблицы просто нет. </I><br>Т ы как в том анекдоте про исполнительных и не внимательныхВерсии разные таблички разные такой нет есть другая <img src="img/smilies/s1.gif" alt=""> За каким хреном ему записывать смещения иат и оеп если он пихает их в регистры открытым текстом На память не помню чего он там пишет, базу чето еще..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=200249&amp;user=293&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=22" class="addthx" data-post="200249"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 августа 2008 17:54 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12390.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Ну вот, наконец-то, и договорились. <img src="img/smilies/s2.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=200287&amp;user=4026&amp;forum_n=5&amp;topic=12390.html&amp;page=0&amp;anchor=23" class="addthx" data-post="200287"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Пара вопросов по инлайн-патчу ASPack&#039;а</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=12390" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
