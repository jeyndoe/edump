<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Подскажите новичку по перехвату Api функций - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброго времени суток. Разбираюсь с перехватом API функций через dll инъекцию. В сети нашел интересный пример и на нем сделал библиотечку которая подменяет нужные функции. В частности: GetDriveTypeA, GetVolumeInformationA,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=1288'>UniSoft</a>, <a target='_blank' href='?action=userinfo&amp;user=55953'>laslo</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Подскажите новичку по перехвату Api функций</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=19274&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=19274&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=6&amp;topic=19274&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Freeon[/b]','')">Freeon</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.1'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=5046">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 17:16 <br><script type="text/javascript">QU('Freeon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Freeon" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброго времени суток. <br>Разбираюсь с перехватом API функций через dll инъекцию.<br>В сети нашел интересный пример и на нем сделал библиотечку которая подменяет нужные функции.<br>В частности: GetDriveTypeA, GetVolumeInformationA, GetVersion, GetVersionExA<br>Все они находятся в kernel32.dll, что усложняет задачку<br>GetDriveTypeA и GetVersion удалось подменить выводы на нужные, а вот<br>GetVolumeInformationA и GetVersionExA проблемы<br>GetVolumeInformationA  возвращает 0 (наверное потому что не знаю в какой регистр писать и в один ли <img src="img/smilies/s1.gif" alt=""> )<br>А с GetVersionExA  вообще труба каким образом и как там идет возврат.<br>К сожалению приходится пользоватся почти наугад, завести на 64 битном 4 ядерном проце SoftIce не удалось а в виртуалке проблемы с видеодрайвером.<br>Да и мешает еще одна проблема <img src="img/smilies/s1.gif" alt=""> последний раз на асме писал лет 10 назад (уже с трудом что-то вспоминается).<br><br>Прошу помощи подсказками:<br>Каким софтом можно подсмотреть саму функцию kernel32 <br>Советами по поводу вовратов от функции, примером или чем нибудь еще.<br><br>В архиве программка мишень, библиотека, flat assembler и исходники всего.<br><br>http://narod.ru/disk/31656508001/project.zip.html
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295701&amp;user=5046&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=1" class="addthx" data-post="295701"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Kaimi[/b]','')">Kaimi</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 60.6 (постоянный), 87thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.85'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26297">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 17:21 &middot; Поправил: Kaimi <br><script type="text/javascript">QU('Kaimi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kaimi" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>Каким софтом можно подсмотреть саму функцию kernel32 </I><br>Любым дизассемблером, например, IDA.<br><br><I><br>GetVolumeInformationA возвращает 0 (наверное потому что не знаю в какой регистр писать и в один ли )<br>А с GetVersionExA вообще труба каким образом и как там идет возврат.<br>К сожалению приходится пользоватся почти наугад, завести на 64 битном 4 ядерном проце SoftIce не удалось а в виртуалке проблемы с видеодрайвером.<br>Да и мешает еще одна проблема последний раз на асме писал лет 10 назад (уже с трудом что-то вспоминается).<br></I><br>Может в таком случае стоит взять detours или easyhook и не заморачиваться с разбором функций и ассемблером?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295702&amp;user=26297&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=2" class="addthx" data-post="295702"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 17:28 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
http://wasm.ru/article.php?article=apihook_1<br>http://wasm.ru/article.php?article=apihook_2<br>http://wasm.ru/article.php?article=apihook_3
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295703&amp;user=3232&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=3" class="addthx" data-post="295703"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Freeon[/b]','')">Freeon</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.1'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=5046">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 17:28 <br><script type="text/javascript">QU('Freeon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Freeon" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Может в таком случае стоит взять detours или easyhook и не заморачиваться с разбором функций и ассемблером? <br><br>Спасибо за совет. Но у меня задача академическая. Я хочу улучшить защиту для своей программы. Но любую защиту можно сломать, поэтому сделал мишешь и её ломаю. По этой причине именно инъекция. Потому что теоретически представим что программу патчить нельзя (не будет свои функции выполнять или 10001 проверка положем). <br>за ida спасибо посмотрю. По практиве пробовал олькой не разобрался как они работают (сложновато для меня - куча ссылок с мета на место в итоге путаешься в показаниях)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295704&amp;user=5046&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=4" class="addthx" data-post="295704"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 17:31 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>Freeon</b><br>На сях или делфи пишется 5 минут, готового кода как говна, только выбирай, если конечно не смущает авер.<br>Юзермод, можешь использовать OllyDbg.<br>С перехватом пиречисленных функций нет проблем, если нужен только асм жди Инди.<br><br>&gt;Все они находятся в kernel32.dll, что усложняет задачку<br><br>Улыбнуло.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295706&amp;user=6&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=5" class="addthx" data-post="295706"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]NikolayD[/b]','')">NikolayD</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 189.9 (ветеран), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.36'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24529">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 17:58 <br><script type="text/javascript">QU('NikolayD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NikolayD" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Freeon</b> вот <noindex><a href="http://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=19262" rel="nofollow" target="_blank">--&gt; тут &lt;--</a></noindex> почитай.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295709&amp;user=24529&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=6" class="addthx" data-post="295709"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 20:06 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Я даже не читал топик, кроме названия. Думаю угадаю. Перехват - патч. Патч не годно. Вы портите ось. Посему в биореактор вам дорога.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295737&amp;user=29629&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=7" class="addthx" data-post="295737"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 20:22 <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Ну и в чем проблема в GetVolumeInformationA и GetVersionExA? Читаешь из [esp+4], или по какому там окажется смещению, указатель-аргумент. Правишь поля структуры, относительно полученного смещения, и все.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295740&amp;user=3136&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=8" class="addthx" data-post="295740"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Freeon[/b]','')">Freeon</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.1'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=5046">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 20:28 <br><script type="text/javascript">QU('Freeon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Freeon" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Всем спасибо заработало!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295742&amp;user=5046&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=9" class="addthx" data-post="295742"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 00:29 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>bowrouco пишет:</b><br><i class=x>Я даже не читал топик, кроме названия. Думаю угадаю. Перехват - патч</i><br><br>Я, видимо, чего-то не понимаю. Многократно видел подобные посты от Клерка, и назрел вопрос. Допустим, у нас есть некая функция. Проще говоря, некий фрагмент кода, расположенный в кодосекции какого-то модуля. Нам нужно выполнить перехват этой функции, цель - фильтровать некоторые входные параметры (типичная задача). Предположим, что мы не можем определить участки кода, из которых происходят (могут происходить) все вызовы этой функции (код запротекчен или просто генерируется динамически). Т.е. всякие Search for all references ничего не дадут. Мы строим граф потока выполнения этой функции. Получаем, что граф представляет из себя тривиальное дерево - т.е. имеется орграф, заданный множеством вершин <b>Х</b>, и отображением этих вершин на множество <b>Х</b> так, что отображение состоит из одного элемента. Не думайте, что это - надуманный пример. Таких функций масса - GetCurrentProcessId, GetLastError, GetCommandLineA и т.д. Для перехвата нам следует изменить граф потока выполнения. Всякие трюки с доступом к памяти не катят, т.к. это юзермод, и нам надо как-то хэндлить исключения без дебаггера (мы под протом). Какие есть в таком случае варианты без патча?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295769&amp;user=6336&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=10" class="addthx" data-post="295769"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 01:56 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>ARCHANGEL</b><br><br>Отложенная передача управления.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295784&amp;user=29629&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=11" class="addthx" data-post="295784"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 05:53 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Я, видимо, чего-то не понимаю. Многократно видел подобные посты от Клерка, и назрел вопрос. </I><br>Ну если ты не понял, то клерк оперирует выдуманными технологиями и понятиями и неприемлет ничего другого, считая, что кроме его илитной архитектуры и терминологии нет вообще ничего, только мусор.<br><br>Причем тут граф? Если ты привел пример с API функциями, то можно сделать похукать экспорт модуля к себе и фильтровать. Если прот чекает валидность экспорта, то можно заюзать секцию релоков модуля или  выделить память пониже модуля, и пофиксить модулю SizeOfImage и/или размеры секций. Можно использовать PAGE_GUARD или Dr регистры, с их хендлингом в KiUserExceptionDispatcher или VEH.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295792&amp;user=3232&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=12" class="addthx" data-post="295792"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 08:15 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>Много что можно, давайте на примере. Как WriteConsole() захачить, так чтобы без порчи(чтоб рку ничего не видал), #PG и #DB не годится, ибо первое однократно и асинхронно с другими потоками, второе не подхолит так как всего четыре брейка.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295801&amp;user=29629&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=13" class="addthx" data-post="295801"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 09:40 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Ты помешался на VX, это форум исследования защиты программного обеспечения, при чем здесь рку? Это протектор, менеджер лицензий? Протекторы не могут использовать все методы антируткитов. Допустим прот спалил что похукана LoadLibrary, что ему делать, убивать защищенное приложение? Тогда юзерам сразу нужно писать, что программа не работает с антивирусами и проактивками.<br><br>Собственно поэтому ответы здесь именно в контексте защиты программного обеспечения. Для одной WriteConsole я бы переправил RVA экспорта функции в экспорте на секцию экспорта и вписал туда forward на свою DLL. Таким образом RVA будет валидным, а GPA вернет адрес моей функции. А, что на это скажет рку мне срать, ибо у меня не трой.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295809&amp;user=3232&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=14" class="addthx" data-post="295809"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 465thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 10:44 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>Freeon пишет:<br>Каким софтом можно подсмотреть саму функцию kernel32 </I><br>Про <b>OLLYDBG</b> что небуть слыхал,<b>SoftIce </b> это эспонат музея<img src="img/smilies/s1.gif" alt=""><br>Так хучить вообще не айс и некрасиво.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>GetVolumeInformation</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">361024</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ESI</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">361029</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">36102E</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span>B4DBBF89</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">361033</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">361035</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function">RETN</span></li>        </ol>
    </div>
</div></div>
<br>желательно делать переход на хученную функу а потом подменять значение а так хучить это какоето варворство( если ты конечно не начинающий троянщик те варворы вообще конченные<img src="img/smilies/s6.gif" alt="">:s6<img src="img/smilies/s1.gif" alt=""> а так пример кода хороший нашёл <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295812&amp;user=17432&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=15" class="addthx" data-post="295812"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 11:06 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>Freeon</b><br>А почему исключается патч? Можешь ты выложить код с проверкой целостности?
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295813&amp;user=2775&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=16" class="addthx" data-post="295813"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 13:00 &middot; Поправил: Gideon Vi <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Вот интересно, почему до сих пор ни кто кроме Клерка не сказал автору, что защищать приложение своими кривыми хуками - <img src="img/smilies/s16.gif" alt=""> ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295818&amp;user=2585&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=17" class="addthx" data-post="295818"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 13:13 &middot; Поправил: Maximus <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>Gideon Vi</b><br>Автор хочет не защитить приложение, а сломать.<br><br>&gt;или 10001 проверка положем<br>Я хочу показать автору как легко можно обойти все проверки, перехватив всего одну функцию ReadFile и сделать обычный патч<br><br>В любом случае понятно что метод иньекции для отлома никто использовать не будет.<br><br>Патч + перехват АПИ функций, как сейчас это делают со всеми протекторами для подмены ХВИДа.<br>Причем функи хукать будут именно в ИАТ программы, а не в kernel библиотеке.<br><br>Ссылки по теме. Обход проверки патча у ASProtect (Хучится одна функция чтения образа в память и обходятся сразу все проверки)<br>http://exelab.ru/rar/htm.php?n=102<br>читать раздел &quot;[Обход проверки изменения файла на диске]&quot;<br><br>Обход проверок на патч Темида (Хучится 3 функции считывания файла с диска, и обходится проверка прота и 100001 проверки в самой программе). Причем в программе как раз подменяется хвид.<br>http://depositfiles.com/ru/files/foengopiq
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295820&amp;user=2775&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=18" class="addthx" data-post="295820"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 13:43 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>Maximus пишет:<br>Автор хочет не защитить приложение, а сломать. </I><br><br><I>Freeon пишет:<br>Я хочу улучшить защиту для своей программы </I><br><br>не?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295822&amp;user=2585&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=19" class="addthx" data-post="295822"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 14:15 &middot; Поправил: Maximus <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>Gideon Vi</b><br>Хуками он хочет не защитить приложение, а сломать. Но вектор изначально задан не правильно.<br>Через хуки ломать никто не будет, будут делать инлайн патч. А все проверки на целостность обходятся элементарно путем подмены измененных байтов на первоначальные при считывании данных в память.<br><br><b>Freeon</b> смирись с неизбежностью, приложение все равно сломают. Лучше направь свои силы на улучшение программы, а не на ее защиту.
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295823&amp;user=2775&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=20" class="addthx" data-post="295823"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 16:09 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
ну может я не так понял. Автор поправит.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295836&amp;user=2585&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=21" class="addthx" data-post="295836"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]HiEndsoft[/b]','')">HiEndsoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 237.0 (наставник), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.74'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13651">Участник</a><br><font color=blue>sysenter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 19:52 <br><script type="text/javascript">QU('HiEndsoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HiEndsoft" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>Maximus пишет:<br>Обход проверок на патч Темида (Хучится 3 функции считывания файла с диска, и обходится проверка прота........ </I><br>Обычно хватает одного перехвата CreateFileW.
<br><br><font size="1"><i>-----<br>продавец резиновых утёнков</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295842&amp;user=13651&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=22" class="addthx" data-post="295842"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 20:00 &middot; Поправил: bowrouco <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>Вопрос:<br><br>&gt; Нам нужно выполнить перехват этой функции, цель - фильтровать некоторые входные параметры (типичная задача).<br><br>Ответ:<br><br>&gt; Отложенная передача управления.<br><br>Комент:<br><br>&gt; Ты.. далее идёт высер и есчо делее:<br><br>&gt; Для одной WriteConsole я бы переправил RVA экспорта функции в экспорте на секцию экспорта и вписал туда forward на свою DLL. Таким образом RVA будет валидным, а GPA вернет адрес моей функции. А, что на это скажет рку мне срать, ибо у меня не трой.<br><br>Тоесть бредятина, не имеющая отношения к вопросу. Это как говорится обосраться. Если нихуя не понимаете, то и писать не нужно. Вы кроме как код патчить не начто больше не годны, тупой по простому говоря. Школота возамнившая себя хз чем.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295846&amp;user=29629&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=23" class="addthx" data-post="295846"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 02:04 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>PE_Kill пишет:</b><br><i class=x>Причем тут граф? </i><br><br>Да, в общем-то, ни при чём. Можно выбрать разную терминологию для постановки задачи. Я просто пояснил, как я понимаю данную задачу с точки зрения теории графов.<br><br><i class=x>Если ты привел пример с API функциями, то можно сделать похукать экспорт модуля к себе и фильтровать</i><br>АПИ - тот же код, который можно описывать графом - думаю, не открыл для вас ничего нового. Ключевая фраза здесь - похукать экспорт. Это разве не относится к патчу, просто патчится не код целевой функции?<br><br><i class=x>и пофиксить модулю SizeOfImage и/или размеры секций</i><br>И это - тоже патч.<br><br><i class=x>Можно использовать PAGE_GUARD или Dr регистры, с их хендлингом в KiUserExceptionDispatcher или VEH</i><br><br>Хэндлинг в KiUserExceptionDispatcher - но ведь это возможно, если пропатчить этот самый KiUserExceptionDispatcher. VEH - это другое дело, но, как уже было замечено, любой последующий обработчик станет приоритетным над моим, а чтоб этого не было, нужен патч RtlAddVectoredExceptionHandler, либо же заюзать один из отладочных регистров или поменять доступ к памяти в этой функции, но говорят (в соседнем топике) что не шибко быстро, т.е. если некая малварь будет так делать, падение производительности юзеры заметят &quot;на глаз&quot;. Значит для малвари не годится, да и тормозящий легальный софт - тоже не хорошо.<br><br><b>bowrouco пишет:</b><br><i class=x>Отложенная передача управления.</i><br><br>Можно конкретнее?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295867&amp;user=6336&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=24" class="addthx" data-post="295867"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 07:43 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>ARCHANGEL</b><br><br><img src="img/attach.gif" alt=""> <a href="./files/9d15_19.11.2011_EXELAB.rU.tgz">9d15_19.11.2011_EXELAB.rU.tgz</a> - IDPxSrt.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295878&amp;user=29629&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=25" class="addthx" data-post="295878"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 11:39 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<b>ARCHANGEL</b> я же говорю, что он троль:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;VEH</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">%</span>CALLIDP&nbsp;IDP_ADD_VEH</li>        </ol>
    </div>
</div></div>
<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>PL2</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0EAH</span>&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Jmp far</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_function"><b>offset</b></span>&nbsp;Stub</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>word</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">5</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">cs</span></li>        </ol>
    </div>
</div></div>
<br><br>Да, да - это не VEH и не патч, это отложенная передача управления! Я уж не говорю о том, что для фильтра одной бедной апи делается перезагрузка имейджа в памяти, трассировка кода и тонна атсос виолейшенов, что естественно не работает на новых ОС.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295881&amp;user=3232&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=26" class="addthx" data-post="295881"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=27614" title="19-11-2011 08:19, ранг:3.0" target="_blank">0x90h</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 12:03 &middot; Поправил: bowrouco <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>Это ты троль. Итак по пунктам:<br><br>1. Я не говорил что нельзя юзать VEH. В вашем варианте с #PG и вообще с блокированием страниц в памяти это не приемлимо, ибо в пределах страницы помимо нужного кода есть есчо много левого. В данном случае возникает несколько десятков фолтов. Но это в данном примере не существенно, так как пример простой и собран чтобы показать как выполняется маршрутизация, а не как юзать IDP, я специально удалил левые файлы, ибо для понимания не нужно знать в данном случае что такое IDP, как релоцируется образ и прочие не нужные детали. В оптимальном варианте может быть всего несколько фолтов, либо вообще их может не быть, это уже детали реализации, зависящие от апи и не имеют отношения к самому механизму отложенной передачи управления.<br><br>2. Это не патч. Образа нет в памяти, есть код в буфере, с которым можно делать что угодно. Оригинальный модуль не изменяется. Вы не сможите обнаружить подобного рода хак никаким существующим детектором.<br><br>3. Релокация образа необходима для стековой или поточной маршрутизации, именно для того, чтобы не трассировать код и небыло лишних трапов.<br><br>4. В новой W8 трап процессинг остался не изменным.<br><br>5. Ответ для <b>ARCHANGEL</b>, не для твердолобых типа <b>PE_Kill</b>.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295883&amp;user=29629&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=27" class="addthx" data-post="295883"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 12:14 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<I>bowrouco пишет:<br>В данном случае возникает несколько десятков фолтов. Но это в данном примере не существенно, так как пример простой и собран чтобы показать как выполняется маршрутизация </I><br>А у тебя других и нет, у тебя все примеры либо просто чтобы..., либо не оптимизированы, либо код старый и т.д. Зациклился на VX, нашел детекторы и раз их обошел, то теперь всем говорит, что патч - гавно, а, то что при этом портит системную структуру и генерит кучу фолтов - это фигня, главное детекторы не видят. Так зачем столько извратов, сломал структуру, получил фолт и иди трапом до начала API, это хоть работать везде будет. Короче как обычно бред один от тебя.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295885&amp;user=3232&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=28" class="addthx" data-post="295885"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Alchemistry[/b]','')">Alchemistry</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 145.8 (ветеран), 191thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.05'>Активность: 0.14<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=21411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 12:19 <br><script type="text/javascript">QU('Alchemistry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alchemistry" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<b>bowrouco</b><br><br>Весь твой бред не читал, но основная суть видимо в том чтобы заменить ненавистный тебе патч на &quot;патч от Инде&quot;, то есть православный. Вроде как основная идея твоего IDP (или как-там называется твой двиг, чето на четыре буквы, ББПЕ?) в организации передачи управления нестандартным способом с использованием исключений и т.д. и т.п. Скажи мне, дружище, в каких проектах (малварь, энтерпрайз) был задействован твой двиг и где с ними можно ознакомиться (в случае малвари можешь кинуть MD5 или просто аверское имя). За три года существования в разных вариантах, при непомерной крутизне методы, его уже должны были применить где-нибудь.<br><br>p.s.<br>Мне тут сказали, что ты постишь свои ресерчи на дваче. Я прослезился.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295887&amp;user=21411&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=29" class="addthx" data-post="295887"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 12:20 &middot; Поправил: bowrouco <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19274&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>Есчо оправдания есть ?<br><br>&gt; Мне тут сказали, что ты постишь свои ресерчи на дваче. Я прослезился.<br><br>Я не знаю что такое двач.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295888&amp;user=29629&amp;forum_n=6&amp;topic=19274&amp;page=0&amp;anchor=30" class="addthx" data-post="295888"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=19274&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=19274&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=6&amp;topic=19274&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Подскажите новичку по перехвату Api функций</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="19274">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19274" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
