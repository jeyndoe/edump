<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Capstone - The Ultimate Disassembler - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="2 марта 2017 года, была выпущена версия 3.0.5-rc2 дизассемблера Capstone. Предыдущий релиз был в 2015 году. Скачать: www.capstone-engine.org/download.html Компактный пример на питоне: Code:      ">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a>, <a target='_blank' href='?action=userinfo&amp;user=33192'>morgot</a>, <a target='_blank' href='?action=userinfo&amp;user=54646'>sashalogout</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Capstone - The Ultimate Disassembler</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=3&amp;topic=24600&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=3&amp;topic=24600&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=3&amp;topic=24600&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=3&amp;topic=24600&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=3&amp;topic=24600&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 00:47 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
2 марта 2017 года, была выпущена версия 3.0.5-rc2 дизассемблера Capstone.<br><br>Предыдущий релиз был в <noindex><a href="http://www.capstone-engine.org/Version-3.0.4-changelog/" rel="nofollow" target="_blank">2015</a></noindex> году.<br><br><b>Скачать</b>:<br><noindex><a href="http://www.capstone-engine.org/download.html" rel="nofollow" target="_blank">www.capstone-engine.org/download.html</a></noindex><br><br>Компактный пример на питоне:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#&nbsp;test1<span class="hl_char">.</span>py</li><li class="hl_l1"><span class="hl_number">2</span>&nbsp;from&nbsp;capstone&nbsp;<span class="hl_function"><b>import</b></span>&nbsp;<span class="hl_char">*</span></li><li class="hl_l0"><span class="hl_number">3</span>&nbsp;</li><li class="hl_l1"><span class="hl_number">4</span>&nbsp;<span class="hl_function"><b>CODE</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">b&quot;\x55\x48\x8b\x05\xb8\x13\x00\x00&quot;</span></li><li class="hl_l0"><span class="hl_number">5</span>&nbsp;</li><li class="hl_l1"><span class="hl_number">6</span>&nbsp;md&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_registr">Cs</span><span class="hl_char">(</span>CS_ARCH_X86<span class="hl_char">,</span>&nbsp;CS_MODE_64<span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_number">7</span>&nbsp;for&nbsp;i&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;md<span class="hl_char">.</span>disasm<span class="hl_char">(</span><span class="hl_function">CODE</span><span class="hl_char">,</span>&nbsp;0x1000<span class="hl_char">)</span><span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;0x%x:\t%s\t%s&quot;</span>&nbsp;<span class="hl_char">%</span><span class="hl_char">(</span>i<span class="hl_char">.</span>address<span class="hl_char">,</span>&nbsp;i<span class="hl_char">.</span>mnemonic<span class="hl_char">,</span>&nbsp;i<span class="hl_char">.</span>op_str<span class="hl_char">)</span><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br>Запуск и выхлоп:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">$</span>&nbsp;python&nbsp;test1<span class="hl_char">.</span>py</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">0x1000<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">rbp</span></li><li class="hl_l1">0x1001<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">rax</span><span class="hl_char">,</span>&nbsp;qword&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span>rip&nbsp;<span class="hl_char">+</span>&nbsp;0x13b8<span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br><b>Описание изменений</b>:<br><noindex><a href="http://www.capstone-engine.org/changelog.html" rel="nofollow" target="_blank">www.capstone-engine.org/changelog.html</a></noindex><br><br>Version <b>3.0.5-rc2</b><br><br><i class=x>March 2, 2017</i><br>Release 3.0.5-RC2 is a release candidate version, with important fixes in the core &amp; several bindings.<br><br><b>Library</b><br><br>Fix build for Visual Studio 2012<br>Fix X86_REL_ADDR macro<br>Add CS_VERSION_MAJOR, CS_VERSION_MINOR, CS_VERSION_EXTRA<br>Better support for embedding Capstone into Windows kernel drivers<br>Support to embedded Capstone into MacOS kernel<br>Support MacOS 10.11 and up<br>Better support for Cygwin<br>Support build packages for FreeBSD &amp; DragonflyBSD<br>Add a command-line tool &quot;cstool&quot;<br>Properly handle switching to Endian mode at run-time for Arm, Arm64, Mips &amp; Sparc<br><br><b>X86</b><br><br>Some random 16-bit code can be handled wrongly.<br>Remove abundant operand type X86_OP_FP<br>Fix instructions MOVQ, LOOP, LOOPE, LOOPNE, CALL/JMP rel16, REPNE LODSD, MOV *AX, MOFFS, FAR JMP/CALL<br>Add X86_REG_EFLAGS for STC and STD<br>Fix instruction attributes for SYSEXIT, MOVW, ROL, LGS, SLDT<br>Rename registers ST0-ST7 to be consistent with asm output<br><br><b>Arm</b><br><br>Properly handle IT instruction<br>Fix LDRSB<br>Fix writeback for LDR<br>Fix Thumb BigEndian setup<br>Fix arith extender<br>Fix writeback for LDR<br>Rename enum arm64_mrs_reg to arm64_sysreg<br><br><b>PowerPC</b><br><br>Print 0 offset for memory operand<br><br><b>Sparc</b><br><br>Fix POPC instruction<br><br><b>Python binding</b><br><br>Better PyPy support<br>Add __version__<br>Better support for Python 3<br>Fix CS_SKIPDATA_CALLBACK prototype<br>Cast skipdata function inside binding to simplify the API<br><br><b>Java binding</b><br><br>Better handle input with invalid code<br><br><b>PowerShell binding</b><br><br>New binding
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372741&amp;user=1379&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=1" class="addthx" data-post="372741"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=33253" title="02-03-2017 20:58, ранг:22.8" target="_blank">Abraham</a>, <a href="action=userinfo&user=4773" title="02-03-2017 21:33, ранг:236.8" target="_blank">plutos</a>, <a href="action=userinfo&user=41088" title="02-03-2017 22:06, ранг:29.5" target="_blank">oldman</a>, <a href="action=userinfo&user=29" title="03-03-2017 05:41, ранг:384.1" target="_blank">nice</a>, <a href="action=userinfo&user=24257" title="14-03-2017 14:46, ранг:259.5" target="_blank">DenCoder</a></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 01:14 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>Jupiter пишет:<br>Сегодня, 2 марта 2017 года, </I><br>ага... теперь понятно под какое событие, тебя ждать в следующий раз.<img src="img/smilies/s3.gif" alt=""><br>с возвращением кстати...<img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372744&amp;user=3230&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=2" class="addthx" data-post="372744"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 01:38 <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Спасибо, Jupiter!<br>Очень, на мой взгляд, полезная тема!<br>Хотелось бы, чтобы участники форума, имеющие опыт использования этого инструмента, поделились им (опытом): теория, практика,  примеры использования, выводы и заключения, ну и т.д. в этом роде.
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372747&amp;user=4773&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=3" class="addthx" data-post="372747"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 01:45 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>plutos</b><br>Ну как быстрый ответ на твой вопрос: есть твик использования движка на конкретной платформе.<br>Если двиг будет использоваться только для x86 (например), то имеет смысл собрать специальную &quot;diet&quot; версию, которая будет содержать только то, что необходимо на конкретной платформе. Это позволяет значительно сократить размер библиотеки.<br><br>Пример сборки:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">$</span>&nbsp;CAPSTONE_ARCHS<span class="hl_char">=</span><span class="hl_quote">&quot;x86&quot;</span>&nbsp;<span class="hl_char">.</span><span class="hl_char">/</span>make<span class="hl_char">.</span>sh</li><li class="hl_l1"><span class="hl_char">$</span>&nbsp;<span class="hl_char">.</span><span class="hl_char">/</span>make<span class="hl_char">.</span>sh</li><li class="hl_l0"><span class="hl_char">$</span>&nbsp;sudo&nbsp;<span class="hl_char">.</span><span class="hl_char">/</span>make<span class="hl_char">.</span>sh&nbsp;install</li>        </ol>
    </div>
</div></div>
<br>Пример проверки поддержки архитектуры:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>cs_support<span class="hl_char">(</span>CS_ARCH_X86<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;X86&nbsp;is&nbsp;supported<span class="hl_char">.</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1">}&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;X86&nbsp;was&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;compiled<span class="hl_char">-</span><span class="hl_function">in</span><span class="hl_char">,</span>&nbsp;thus&nbsp;unsupported<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br>Подробнее:<br><noindex><a href="http://www.capstone-engine.org/compile.html" rel="nofollow" target="_blank">capstone-engine.org/compile.html</a></noindex>
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372748&amp;user=1379&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=4" class="addthx" data-post="372748"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.52'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 02:04 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Хорошая библиотека, всё работает быстро и без ошибок. Использую её в нескольких проектах.<br><br>Единственный минус - большой размер всей библиотеки(примерно 3 мб).<br><br>Есть еще интересные вещи от той же группы координаторов:<br><br><noindex><a href="http://www.unicorn-engine.org/" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex> Эмулятор на основе QEMU. Работает, но нестабильно и с костылями(версия 0.9). Написал на нём анализатор-распаковщик. <br>Последнее обновление библиотеки(1.0), было настолько радикальным, что старые костыли перестали работать. Нужно всё переписывать.<br><br><noindex><a href="http://www.keystone-engine.org/" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex> Ассемблерный фреймворк. Описание интересное, но пока тесно с ним не общался.
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372752&amp;user=31056&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=5" class="addthx" data-post="372752"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 03:09 <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>hors пишет:<br>Написал на нём анализатор-распаковщик.  </I><br><br>как интегрируются capstone и unicorn? Я простейщий пример на уникорне написал, ну выполняет код, да,<br>а чтобы получить дизасм текущей выполняемой инструкции, получалось что надо было ещё капстоновский <br>cs_disasm вызывать, что видимо добавляет тормозов.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372753&amp;user=41088&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=6" class="addthx" data-post="372753"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 03:17 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>hors</b><br><br>&gt; всё работает быстро и без ошибок.<br><br>Задачи дизасма две - раскодировка инструкций или выхлоп текста(мнемоник). Профайл важен для первой задачи, тогда чем это лучше кседа, проводили тесты ?<br><br>На стабильность тесты проводятся не на системном коде, а на спец конструкциях не корректных или на рандом буфере.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372754&amp;user=40990&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=7" class="addthx" data-post="372754"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 03:32 <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>difexacaw пишет:<br>На стабильность тесты проводятся не на системном коде </I><br><br>ну да, так то авторы капстоуна конечно об этом не знали, на calc.exe быстро пару раз прогнали и в паблик <br>выдали.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372755&amp;user=41088&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=8" class="addthx" data-post="372755"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 03:48 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>oldman пишет:<br>на calc.exe быстро пару раз </I><br>ну как это быстро, 2 года гоняли, и на блокноте так же...<img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372756&amp;user=3230&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=9" class="addthx" data-post="372756"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 03:53 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Интересно потестить, но нечем собрать. Я не помню, но вроде я прошлую версию тестил, можно тут поискать где то моя тема была.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372757&amp;user=40990&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=10" class="addthx" data-post="372757"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 04:11 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>difexacaw пишет:<br>но нечем собрать </I><br><br><b>Windows - Core engine </b><br>* The Capstone header files (*.h) for C programming.<br>* 32-bit/64-bit DLLs &amp; static libraries for Microsoft Windows 32-bit/64-bit.<br>* A test file (test.exe)<br><br>Win32<br><noindex><a href="https://github.com/aquynh/capstone/releases/download/3.0.5-rc2/capstone-3.0.5-rc2-win32.zip" rel="nofollow" target="_blank">capstone-3.0.5-rc2-win32.zip</a></noindex><br><br>Win64<br><noindex><a href="https://github.com/aquynh/capstone/releases/download/3.0.5-rc2/capstone-3.0.5-rc2-win64.zip" rel="nofollow" target="_blank">capstone-3.0.5-rc2-win64.zip</a></noindex>
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372759&amp;user=1379&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=11" class="addthx" data-post="372759"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40990" title="03-03-2017 01:13, ранг:79.1" target="_blank">difexacaw</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 04:13 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>difexacaw пишет: а на спец конструкциях не корректных или на рандом буфере </I><br><br>Как и xed проверялся процессором, на данный момент один из самых стабильных и удобных движков, xed слишком громоздкий, а остальное либо сырое или же вообще школьное творчество.<br><noindex><a href="http://rgho.st/6j5RjwQW4" rel="nofollow" target="_blank">собрал</a></noindex> но без кернел варианта, нет инклудов на этой машине.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372760&amp;user=41575&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=12" class="addthx" data-post="372760"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40990" title="03-03-2017 01:13, ранг:79.1" target="_blank">difexacaw</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 04:13 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>Jupiter</b><br><br>File not found
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372761&amp;user=40990&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=13" class="addthx" data-post="372761"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 04:14 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>difexacaw пишет:<br>File not found</I><br><br>Заменил ссылкой на GitHub, проверь
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372762&amp;user=1379&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=14" class="addthx" data-post="372762"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 05:10 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Спасибо.<br><br>.lib файл там кривой, не содержит прототипов.<br>В хидерах описание кривое, какой прототип у cs_disasm ?<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">size_t&nbsp;CAPSTONE_API&nbsp;cs_disasm<span class="hl_char">(</span>csh&nbsp;handle<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>const</b></span>&nbsp;uint8_t&nbsp;<span class="hl_char">*</span><span class="hl_function">code</span><span class="hl_char">,</span>&nbsp;size_t&nbsp;code_size<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint64_t&nbsp;address<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;count<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_insn&nbsp;<span class="hl_char">*</span><span class="hl_char">*</span>insn<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>4-й аргумент:<br>&gt; @address: address of the first instruction in given raw code buffer.<br><br>Это виртуальный адрес или это относительно начала буфера смещение, не понятно. Если смещение, то зачем 64-битное.. тогда вероятно что это всё же адрес(VA).<br><br>Куда статус возвращается, size_t это не cs_err судя по дефейну, вероятно какой то размер.<br><br>Передаю адрес rdtsc/ret. Возвращает Eax = 1, в буфер ссылку на выделенный буфер в хипе, в котором число 0x254.<br>Если предположить что возвращается cs_err, то это CS_ERR_MEM - страничного нарушения нет, это бага.<br><br>Как это заюзать ?
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372766&amp;user=40990&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=15" class="addthx" data-post="372766"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 05:50 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>difexacaw пишет: Как это заюзать ?</I><br><br><noindex><a href="http://rgho.st/65sdsnxhp" rel="nofollow" target="_blank">собранный</a></noindex> пример и исходный код примера.<br>Судя по соседней теме, для вашей задачи нужно немного переписать код движка, это значительно ускорить работу и уменьшит размер.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372768&amp;user=41575&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=16" class="addthx" data-post="372768"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 07:01 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>shellstorm</b><br><br>У вас в импорте 8 либ типо api-ms-win-crt-heap-l1-1-0, я их гуглом нашёл, но всё равно не запускается - видимо это сишное дерьмо меняется в версиях. Зачем такой компиль нужен не понятно..<br><br>&gt;  нужно немного переписать код движка<br><br>Ксед для той задачи заюзать не получилось, так как он винапишный, а тот прожект нэйтивный.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372771&amp;user=40990&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=17" class="addthx" data-post="372771"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 10:03 &middot; Поправил: SReg <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>difexacaw пишет:<br>У вас в импорте 8 либ типо api-ms-win-crt-heap-l1-1-0, я их гуглом нашёл, </I><br>инде, семпл выше не воркает на хп<br>на 7 норм
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372775&amp;user=18316&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=18" class="addthx" data-post="372775"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 10:44 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>difexacaw пишет:<br>4-й аргумент:<br>&gt; @address: address of the first instruction in given raw code buffer.<br><br>Это виртуальный адрес или это относительно начала буфера смещение, не понятно. Если смещение, то зачем 64-битное.. тогда вероятно что это всё же адрес(VA).</I><br><br>Это виртуальный адрес (я в первом посте привёл сорс на питоне, там по выхлопу понятно):<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#&nbsp;test1<span class="hl_char">.</span>py</li><li class="hl_l1"><span class="hl_number">2</span>&nbsp;from&nbsp;capstone&nbsp;<span class="hl_function"><b>import</b></span>&nbsp;<span class="hl_char">*</span></li><li class="hl_l0"><span class="hl_number">3</span>&nbsp;</li><li class="hl_l1"><span class="hl_number">4</span>&nbsp;<span class="hl_function"><b>CODE</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">b&quot;\x55\x48\x8b\x05\xb8\x13\x00\x00&quot;</span></li><li class="hl_l0"><span class="hl_number">5</span>&nbsp;</li><li class="hl_l1"><span class="hl_number">6</span>&nbsp;md&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_registr">Cs</span><span class="hl_char">(</span>CS_ARCH_X86<span class="hl_char">,</span>&nbsp;CS_MODE_64<span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_number">7</span>&nbsp;for&nbsp;i&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;md<span class="hl_char">.</span>disasm<span class="hl_char">(</span><span class="hl_function">CODE</span><span class="hl_char">,</span>&nbsp;0x1000<span class="hl_char">)</span><span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;0x%x:\t%s\t%s&quot;</span>&nbsp;<span class="hl_char">%</span><span class="hl_char">(</span>i<span class="hl_char">.</span>address<span class="hl_char">,</span>&nbsp;i<span class="hl_char">.</span>mnemonic<span class="hl_char">,</span>&nbsp;i<span class="hl_char">.</span>op_str<span class="hl_char">)</span><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br>Запуск и выхлоп:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">$</span>&nbsp;python&nbsp;test1<span class="hl_char">.</span>py</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">0x1000<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">rbp</span></li><li class="hl_l1">0x1001<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">rax</span><span class="hl_char">,</span>&nbsp;qword&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span>rip&nbsp;<span class="hl_char">+</span>&nbsp;0x13b8<span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br>На сях вызов:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">cs_disasm<span class="hl_char">(</span>handle<span class="hl_char">,</span>&nbsp;<span class="hl_function">CODE</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span><span class="hl_function">CODE</span><span class="hl_char">)</span><span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">,</span>&nbsp;0x1000<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>insn<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>По сути этот параметр задаёт <b>базовое абсолютное смещение</b> для использования движком <b>при расчёте абсолютных адресов</b>
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372776&amp;user=1379&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=19" class="addthx" data-post="372776"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.52'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 11:46 &middot; Поправил: hors <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>oldman пишет:<br>как интегрируются capstone и unicorn? Я простейщий пример на уникорне написал, ну выполняет код, да,<br>а чтобы получить дизасм текущей выполняемой инструкции, получалось что надо было ещё капстоновский<br>cs_disasm вызывать, что видимо добавляет тормозов.  </I><br><br>Полный дизасм текущей инструкции или только длины? Если полный, то да, нужно Capstone подключать.<br>Подключается стандартно, никаких проблем не было замечено.<br><br>Если нужна только длина и адрес, то можно без Capstone. <br><br>Ставится хук на область памяти:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">addHook<span class="hl_char">(</span><span class="hl_char">&amp;</span>traceCode<span class="hl_char">,</span>UC_HOOK_CODE<span class="hl_char">,</span><span class="hl_char">(</span><span class="hl_function"><b>void</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>hookCode<span class="hl_char">,</span><span class="hl_function">this</span><span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span>0x1000<span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br><br>Теперь на каждой инструкции в этой области памяти вызывается функция:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;hookCode<span class="hl_char">(</span>uc_engine&nbsp;<span class="hl_char">*</span>uc<span class="hl_char">,</span>&nbsp;uint64_t&nbsp;address<span class="hl_char">,</span>&nbsp;uint32_t&nbsp;size<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;<span class="hl_char">*</span>user_data<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div>
<br><br>address адрес текущей инструкции<br>size длина текущей инструкции.<br><br>Но останавливаться на каждой инструкции долго(с Capstone или без). <br>Поэтому намного быстрее сканировать текущую память на предмет нужных сигнатур и ставить в нужных местах брейкпойнты.<br>То есть по сути тоже самое что мы делаем при трассировке/распаковке в обычном отладчике.<br><br><b>Добавлено спустя -50 минут</b><br><I>difexacaw пишет:<br><br>Задачи дизасма две - раскодировка инструкций или выхлоп текста(мнемоник). Профайл важен для первой задачи, тогда чем это лучше кседа, проводили тесты ? </I><br><br>Лучше Кседа тем, что больше поддерживаемых архитектур.
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372778&amp;user=31056&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=20" class="addthx" data-post="372778"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=41088" title="03-03-2017 09:08, ранг:29.8" target="_blank">oldman</a>, <a href="action=userinfo&user=24257" title="12-03-2017 11:21, ранг:259.2" target="_blank">DenCoder</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 21:02 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>difexacaw пишет: Зачем такой компиль нужен не понятно </I><br><br>Я собрал &quot;как есть&quot;, без настройки сборки, при необходимости подобный мусор отключается, а по хорошему там нужно переписать аллокатор и вообще выкинуть crt.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372796&amp;user=41575&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=21" class="addthx" data-post="372796"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 21:23 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>shellstorm</b><br><br>А зачем тогда такой пример выкладывать вообще, если это невозможно запустить без установки IDE, которым вы это собрали. И я это не на XP запускал, а на x64-w8. Мне просто надоело копировать на варю скачанные либы..
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372801&amp;user=40990&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=22" class="addthx" data-post="372801"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2017 22:16 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>difexacaw пишет: А зачем тогда такой пример выкладывать </I><br><br>Вы действительно думаете, что я после каждой сборки бегу проверять секции с импортом?<br>Открыл проектный файл, нажал кнопку собрать, залил результат на обменник, все.<br>Нужно еще компилятор обновить, последнее обновление оказалось бажным, не отключается security check.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372805&amp;user=41575&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=23" class="addthx" data-post="372805"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2017 19:13 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
Хороша вещь. В плане анализа кода - хорошая альтернатива иде, может помочь обойти трудности в скриптах иды быстрее, есть такая теоретическая возможность.<br><br>Под &quot;В плане анализа кода&quot; я имел в виду автоматический анализ. Большинство конструкций кода, применяемых техник шаблонные. И можно упростить себе анализ, разгрузив мозг от рутинных операций по анализу. А двиг на кэпстоуне хорош тем, что может позволить анализировать быстрей и легче код и под x86/x64, и под мипс, и под арм. Ну это моё мнение.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372851&amp;user=24257&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=24" class="addthx" data-post="372851"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 марта 2017 02:41 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>hors пишет:<br>addHook(&amp;traceCode,UC_HOOK_CODE,(void *)hookCode,this,0,0x1000) </I><br>На своём любимом си так пока не попробовал. Решил ради освоения питона, заюзать unicorn на нём. Хорошее дело - хуки. Вот только по-разному себя ведёт функция reg_read() внутри хука и вне её<br><br>Например, определили функцию<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">def&nbsp;print_common_regs<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot; pc: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_PC<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot; sp: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_SP<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot; r0: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_R0<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot; r1: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_R1<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot; r2: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_R2<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot; r3: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_R3<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot; r4: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_R4<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot; r5: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_R5<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot; r6: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_R6<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot; r7: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_R7<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot; r8: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_R8<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot; r9: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_R9<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;r10: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_R10<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;r11: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_R11<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;r12: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_R12<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;lr: %x&quot;</span>&nbsp;<span class="hl_char">%</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_ARM_REG_LR<span class="hl_char">)</span><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br><br>Внутри функции хука:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">def&nbsp;hook_code<span class="hl_char">(</span>uc<span class="hl_char">,</span>&nbsp;address<span class="hl_char">,</span>&nbsp;size<span class="hl_char">,</span>&nbsp;user_data<span class="hl_char">)</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insn_type&nbsp;<span class="hl_char">=</span>&nbsp;idautils<span class="hl_char">.</span>DecodeInstruction<span class="hl_char">(</span>address<span class="hl_char">)</span><span class="hl_char">.</span>itype</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>insn_type&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;ARM_INS_bl&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;insn_type&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;ARM_INS_blx1&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;insn_type&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;ARM_INS_blx2&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;insn_type&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;ARM_INS_bx&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;insn_type&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;ARM_INS_bxj<span class="hl_char">)</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;&gt;&gt;&gt; break on branch at 0x%x, block size = 0x%x&quot;</span>&nbsp;<span class="hl_char">%</span><span class="hl_char">(</span>address<span class="hl_char">,</span>&nbsp;size<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_common_regs<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uc<span class="hl_char">.</span>emu_stop<span class="hl_char">(</span><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br><br>и в конце модуля<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function">try</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu<span class="hl_char">.</span>emu_start<span class="hl_char">(</span>pc<span class="hl_char">,</span>&nbsp;0x32318<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;Emulation done. Below is the CPU context&quot;</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>except</b></span>&nbsp;UcError&nbsp;as&nbsp;e<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;Error: %s&quot;</span>&nbsp;<span class="hl_char">%</span>e<span class="hl_char">)</span></li><li class="hl_l1">finally<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_common_regs<span class="hl_char">(</span><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br><br>По остановке на одной из инструкций из<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_registr">BL</span></li><li class="hl_l1">BLX</li><li class="hl_l0"><span class="hl_registr">BX</span></li><li class="hl_l1">BXJ</li>        </ol>
    </div>
</div></div>
<br>будет 2 вывода основных регистров ARM.<br><br>Они должны бы быть одинаковые, но это не так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">&gt;</span><span class="hl_char">&gt;</span><span class="hl_char">&gt;</span>&nbsp;<span class="hl_function"><b>break</b></span>&nbsp;on&nbsp;branch&nbsp;at&nbsp;0x31fa0<span class="hl_char">,</span>&nbsp;block&nbsp;size&nbsp;<span class="hl_char">=</span>&nbsp;0x4</li><li class="hl_l1">&nbsp;pc<span class="hl_char">:</span>&nbsp;<span class="hl_number">31fa0</span></li><li class="hl_l0">&nbsp;<span class="hl_registr">sp</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">1fe9b8</span></li><li class="hl_l1">&nbsp;r0<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">&nbsp;r1<span class="hl_char">:</span>&nbsp;<span class="hl_number">1fea0c</span></li><li class="hl_l1">&nbsp;r2<span class="hl_char">:</span>&nbsp;<span class="hl_number">10006</span></li><li class="hl_l0">&nbsp;r3<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">&nbsp;r4<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0">&nbsp;r5<span class="hl_char">:</span>&nbsp;<span class="hl_number">2</span></li><li class="hl_l1">&nbsp;r6<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">&nbsp;r7<span class="hl_char">:</span>&nbsp;<span class="hl_number">3</span></li><li class="hl_l1">&nbsp;r8<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">&nbsp;r9<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l1">r10<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">r11<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l1">r12<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">lr<span class="hl_char">:</span>&nbsp;adb4c</li><li class="hl_l1">Emulation&nbsp;done<span class="hl_char">.</span>&nbsp;Below&nbsp;is&nbsp;the&nbsp;CPU&nbsp;context</li><li class="hl_l0">&nbsp;pc<span class="hl_char">:</span>&nbsp;<span class="hl_number">31f88</span></li><li class="hl_l1">&nbsp;<span class="hl_registr">sp</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">1fe9b8</span></li><li class="hl_l0">&nbsp;r0<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">&nbsp;r1<span class="hl_char">:</span>&nbsp;<span class="hl_number">1fea0c</span></li><li class="hl_l0">&nbsp;r2<span class="hl_char">:</span>&nbsp;<span class="hl_number">10006</span></li><li class="hl_l1">&nbsp;r3<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">&nbsp;r4<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l1">&nbsp;r5<span class="hl_char">:</span>&nbsp;<span class="hl_number">2</span></li><li class="hl_l0">&nbsp;r6<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">&nbsp;r7<span class="hl_char">:</span>&nbsp;<span class="hl_number">3</span></li><li class="hl_l0">&nbsp;r8<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">&nbsp;r9<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0">r10<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">r11<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0">r12<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">lr<span class="hl_char">:</span>&nbsp;adb4c</li>        </ol>
    </div>
</div></div>
<br><br>Отличается PC
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373393&amp;user=24257&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=25" class="addthx" data-post="373393"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2017 05:31 &middot; Поправил: Bronco <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>hors пишет:<br>Лучше Кседа тем, что больше поддерживаемых архитектур.  </I><br>+1<br>отличный дизасм, описание инструкций в структурах, иногда даже слишком &quot;глубоко&quot;<br>для X86_OP_IMM (__int64) не мешало бы добавить размер константы в байтах, размер  операнда указывает только на макси значение.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span>&nbsp;D8468294</li><li class="hl_l1"><span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">DI</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">DI</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378948&amp;user=3230&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=26" class="addthx" data-post="378948"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2017 19:21 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>Bronco</b><br><br>У дизасма есть две совершенно не связанные задачи. Первая это декодер инструкций, который предоставляет базовую инфу - наличие MRM, SRC/DST операндов, флаги и регистры(IN/OUT) etc. Вторая это текстовый вывод мнемоник. Обычно нужна вторая задача, но для неё подходит вообще любой дизасм, лучше/хуже оценивается по текстовому выхлопу. Для первой задачи важен профайл и гибкость мотора, что он может раскодировать. Есно для первой задачи никакая портабельность смысла не имеет. Для второй задачи смысла не и имеет профайл.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378958&amp;user=40990&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=27" class="addthx" data-post="378958"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 сентября 2017 05:01 <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
Пытаюсь установить CAPSTONE на FreeBSD.<br><br>./make.sh install =&gt;<br><br>install -m0755 cstool/cstool /usr/bin<br>install: cannot stat &#039;cstool/cstool&#039;: No such file or directory<br><br>Похоже, что вот эта строчка в Makefile &#036;(INSTALL_LIB) cstool/cstool &#036;(BINDIR)<br>вызывает ошибку.<br><br>в google есть упоминание о подобной ошибке, но у них она каким-то образом исчезла сама по себе
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378984&amp;user=4773&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=28" class="addthx" data-post="378984"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]rmn[/b]','')">rmn</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 158.4 (ветеран), 123thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.28'>Активность: 0.14<span style='color:green'>&nearr;</span>0.49</span><br>Статус: <a href="action=userinfo&amp;user=1533">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 сентября 2017 11:42 <br><script type="text/javascript">QU('rmn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rmn" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<b>plutos</b><br>sudo же. Или ты из тех, кто до сих пор под рутом сидит? <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=379010&amp;user=1533&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=29" class="addthx" data-post="379010"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2017 00:12 <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24600&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
&#036; sudo ./make.sh install =&gt; абсолютно идентичная ошибка. <br><br>Я FreeBSD установил три дня назад и для меня это  темный лес. Кое-что из Unix&#039;a помню, но давно не пользовался. Так что, если кто может помочь, то обьясните пожалуйста подробно.<br><br>Кроме того, куда устанавливается Capstone? и как убедится, что он установлен?<br><br>пытался ./tests/test*, но валится на первом же файле: ./test_arm.c Permission denied, хотя я вроде как root.
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=379036&amp;user=4773&amp;forum_n=3&amp;topic=24600&amp;page=0&amp;anchor=30" class="addthx" data-post="379036"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=3&amp;topic=24600&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=3&amp;topic=24600&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=3&amp;topic=24600&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=3&amp;topic=24600&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=3&amp;topic=24600&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Capstone - The Ultimate Disassembler</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="3">
<input type="hidden" name="topic" value="24600">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24600" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
