<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Реверсинг диалога о завершении работы Windows - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем хай. Ситуация следующая, Windows XP SP3, в течении некоторого времени пытаюсь отреверсить и воспроизвести функционал меню Пуск -&gt; Завершение работы. Т.е. хочу создать такой диалог программно. После определённого">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=1288'>UniSoft</a> (+11 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Реверсинг диалога о завершении работы Windows</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2012 15:52 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Всем хай. Ситуация следующая, Windows XP SP3, в течении некоторого времени пытаюсь отреверсить и воспроизвести функционал меню <b>Пуск -&gt; Завершение работы</b>. Т.е. хочу создать такой диалог программно. После определённого исследования (всего исследования я уж не помню, буду описывать то, что ещё помнится) удалось выяснить, что в <b>explorer.exe</b> подгружается <b>msgina.dll</b>, потом по ординалу ищется и вызывается функция под номером 16 (10h). Внутри этой функции CreateWindowExW создаёт окно, потом после ShowWindow моё приложение ведёт себя странно, а explorer.exe - адекватно. Т.е. эксплорер отображает окно, а мой софт, в случае, если пашет под Olly - вешает систему (выходом является нажатие Ctrl+Alt+Del и завершение процесса отладчика). Без отладчика софт просто не отображает окно, но система не вешается. В дебаггере решил ресёрчить причину. Т.к. перед созданием окно вызывается RegisterClassExW, отсюда можно определить lpfnWndProc, определил - это CDimmedWindow__WndProc. Поставил на него бряк, последний (перед зависанием) бряк показал, что обрабатывается сообщение WM_WINDOWPOSCHANGING. Вышел я из этой CDimmedWindow__WndProc, дотопал до XyCallbackReturn, а потом (собственно, как и описывается <noindex><a href="http://www.wasm.ru/article.php?article=keumc" rel="nofollow" target="_blank">--&gt; Здесь &lt;--</a></noindex>), отправился в ядро посредством <b> int 2Bh </b>. После чего всё подвисло. <br><br>Пробовал зайти с другой стороны, запускал оконное приложение, через Spy++ отслеживал очередь сообщений, и смотрел, что произойдёт после отображения пресловутого окна. Так вот пока окно активно - очередь пуста (может, она не пуста, просто строки в эдите Spy++ появляются только после того, как отмену нажать), а как только нажимаю отмену, то множество сообщений сразу передаются оконной процедуре. Первым из них обрабатывается WM_SYNCPAINT. Так вот я в своём оконном софте сделал так, чтоб при обработке этого сообщения моя софтина просто входила бы в бесконечный цикл, но это не повесило систему, значит моя догадка о том, что при создании этого окна о завершении работы система рассылает некие сообщения топ-левел окнам, неверна. Да, рассылка происходит, но при выборе какого-то из пунктов (перезагрузка, завершение работы), но не при отрисовке окна выбора. <br><br>А началось всё с того, что на одном из компов этот диалог завершения работы перестал отображаться. Причём эффект тот же, что и для моей самописной софтины - попытка завершения работы вешает систему. WTF? Натолкните на мысль, что бы ещё можно бы такое сделать/посмотреть/поресёрчить и как, а то уже идеи закончились. Проект на 2010 студии прикладываю, где моё приложение вызывает зависание под олькой, и завершается без неё, но не рисует диалог.<br><br><img src="img/attach.gif" alt=""> <a href="./files/4098_14.06.2012_EXELAB.rU.tgz">4098_14.06.2012_EXELAB.rU.tgz</a> - GinaTest.rar
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=307119&amp;user=6336&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=1" class="addthx" data-post="307119"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]mdscorp[/b]','')">mdscorp</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.6 (посетитель), 15thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.37'>Активность: 0.03<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=24498">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2012 17:01 &middot; Поправил: mdscorp <br><script type="text/javascript">QU('mdscorp','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mdscorp" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
&quot;rundll32 ExitWindowsEx&quot;<br>а через командную строку  параметр завершения работы передать не проще ?<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">ShellExecute<span class="hl_char">(</span>handle<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;open&quot;</span><span class="hl_char">,</span>&nbsp;shutdown&nbsp;<span class="hl_char">-</span>f&nbsp;<span class="hl_char">-</span>s&nbsp;<span class="hl_char">-</span>t&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;SW_SHOWNORMAL<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>&quot;shutdown -f -s -t 0 &quot;<br><br>и да, сами ресурсы окна находятся в ntoskrnl.exe
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=307125&amp;user=24498&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=2" class="addthx" data-post="307125"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2012 17:03 <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
возможно, чуть не в тему<br>из своих экспериментов я помню, что этот диалог открывается также,<br>если послать WM_CLOSE окну с заголовком &quot;Program Manager&quot; и классом &quot;Progman&quot;<br><br>btw. а в чём суть исследования?<br>вернуть на поврежденный комп диалог завершения работы?<br>или просто сымитировать функционал оригинального диалога?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=307126&amp;user=26242&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=3" class="addthx" data-post="307126"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31932" title="30-07-2012 19:12, ранг:0.8" target="_blank">TLN</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2012 17:15 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
У Руссиновича почитайте главу 4 &quot;Запуск и завершение работы системы&quot;
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=307129&amp;user=2981&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=4" class="addthx" data-post="307129"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]yagello[/b]','')">yagello</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.1 (постоянный), 30thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.56'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=23568">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2012 20:11 <br><script type="text/javascript">QU('yagello','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=yagello" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Возможно, система не вешается, а пытается отобразить какой-то диалог и не может это сделать.<br>Вообще подозреваю, что DimmedWindow берет текущую картинку десктопа, а потом в ней палитру крутит в сторону обесцвечивания. Соответственно, если это не десктоп, а статик картинка, то ничего программа отобразить не сможет. Тем более через ГУЙ, который остановлен в это время.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=307147&amp;user=23568&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=5" class="addthx" data-post="307147"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2012 21:26 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Ответы по порядку.<br><br><b>mdscorp</b><br>Написать софт, который бы также вызывал ExitWindowsEx - не проблема, и тут можно обойтись без rundll32.exe, тем более, что так как вы указали - работать не будет, ибо надо указать имя_либы имя_функи в качестве параметров, но я вас понял. Интерес именно знать, почему вдруг стандартный диалог перестал работать.<br><br><b>-=AkaBOSS=- пишет:</b><br><i class=x>из своих экспериментов я помню, что этот диалог открывается также,<br>если послать WM_CLOSE окну с заголовком &quot;Program Manager&quot; и классом &quot;Progman&quot;</i><br><br>Да, но только потом произойдёт всё тоже самое - explorer подгрузит msgina.dll и начнётся та же канитель.<br><br><b>Flint пишет:</b><br><i class=x>У Руссиновича почитайте главу 4 &quot;Запуск и завершение работы системы&quot;</i><br><br>Читал, но там не то, ибо там описывается, что происходит при завершении работы системы, а мне нужно знать, что происходит при отрисовке предложения о завершении работы, т.е. если вывелось это окно, то я могу и не завершать работу - нажму &quot;отмена&quot; и дальше буду работать, и завершения не произойдёт.<br><br><b>yagello</b><br>Вот и я так подумал. Поэтому стал трейсить функцию с ординалом 16. В ней CreateWindowEx завершается норм, куда дальше смотреть - я не догадался пока. Но у вас так много идей, не подскажете, как оно может &quot;крутить палитру в сторону обесцвечивания&quot;, а я попробую это проверить.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=307165&amp;user=6336&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=6" class="addthx" data-post="307165"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2012 22:12 <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>как оно может &quot;крутить палитру в сторону обесцвечивания&quot; </I><br>чисто по логике, там не именно десктоп, а скрин (все окна). хотя, хз. мож сырки win2k глянуть по этому поводу?
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=307176&amp;user=8830&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=7" class="addthx" data-post="307176"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]neomant[/b]','')">neomant</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/24900.jpg" alt=""><br><span class=txtSm>Ранг: 164.6 (ветеран), 65thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24900">Участник</a><br><font color=blue>Волшебник</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2012 22:25 &middot; Поправил: neomant <br><script type="text/javascript">QU('neomant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neomant" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Как то странно, что функа получает указатели на два нулевых дворда. Это вполне себе могут быть какие-то предустановленные структуры. Я бы лучше поковырял 16 функцию и ближайшее место её вызова.
<br><br><font size="1"><i>-----<br>Следуй за белым кроликом</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=307179&amp;user=24900&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=8" class="addthx" data-post="307179"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2012 00:33 &middot; Поправил: Hexxx <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Имхо надо курить <noindex><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa376105(v=vs.85).aspx" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br>И диалог не выводится скорее всего из-за того, что какие-то настройки джины накрылись. Или поставили какую-то хрень для аутентификации, которая мешает работе джины. Отладку джины надо делать установив специальные ключи в реестре, там не все так просто, иначе вешаться будет.
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=307194&amp;user=10168&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=9" class="addthx" data-post="307194"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2012 00:34 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>neomant пишет:</b><br><i class=x>Как то странно, что функа получает указатели на два нулевых дворда.</i><br>На такую мысль натолкнули два вызова IsBadWritePtr в начале функции, где ucb был равен 4.  Но ещё посмотрю - может, высмотрю что-то.<br><br><b>ajax</b><br>Пока не нашёл там ничего полезного.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=307195&amp;user=6336&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=10" class="addthx" data-post="307195"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2012 10:21 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Большая часть функций есть в MSDN, есть исходники msgina, к чему реверс?<br>В атаче сурсы, грузи dll в IDA, грузи PDB и сравнивай с исходниками ибо я никогда сам не интересовался вызовом этого диалога, ибо он мне не нужен, так что мне лень для тебя искать.<br><br><img src="img/attach.gif" alt=""> <a href="./files/1c1c_15.06.2012_EXELAB.rU.tgz">1c1c_15.06.2012_EXELAB.rU.tgz</a> - gina.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=307208&amp;user=6&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=11" class="addthx" data-post="307208"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2012 11:32 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>F_a_u_s_t</b><br>Такие сорцы я видел в составе пака сорцов Windows 2000, но, несмотря на то, что папка называется <b>gina</b>, сорцов самой джины там нет, есть только winlogon.exe и userenv.dll. <br><br>Не знаю, правильно ли я понял содержимое MSDN, но, похоже, аналогичный диалог должен вызваться при обращении к WlxActivateUserShell. В описании меня смущают такие строки:<br><br><i class=x>Before calling WlxActivateUserShell, Winlogon sets the desktop state so that the current desktop is the Winlogon desktop and sets the workstation state so that the desktop is locked.</i><br><br>Т.е. если этого не сделать, может ли происходить такое зависание?<br><br><b>Hexxx</b><br>Прочитал про отладку джины <noindex><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa374744(v=vs.85).aspx" rel="nofollow" target="_blank">--&gt; Здесь &lt;--</a></noindex>. Получается, что я не могу так просто подгружать её к своему процессу и что-то из неё вызывать? Я должен все вызовы делать из Winlogon.exe, что ли? Но тогда почему вызов этого диалога из explorer.exe работает. Нет, там видимо, имели ввиду отладку функций завршения сеанса, блокирования рабочего стола, аутентификации и т.д., т.е. спец.функций джины. Да и нигде не говорится, что без отладочных флажков и отладочной версии винлогона система будет виснуть, откуда такая информация?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=307213&amp;user=6336&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=12" class="addthx" data-post="307213"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2012 11:51 &middot; Поправил: F_a_u_s_t <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>В исходниках есть часть wlx функций.<br>Судя по написанному может виснуть, сам не сталкивался.<br>Вот что ахтунги с microsoft советуют юзать, сам не пробовал.<br><noindex><a href="http://msdn.microsoft.com/en-us/library/aa380571(v=vs.85).aspx" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>Add:<br>Посмотрел твой семпл...<br>ShellDimScreen эта функа дает только эффект затенения, она ничего не выключает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=307216&amp;user=6&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=13" class="addthx" data-post="307216"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2012 12:21 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>F_a_u_s_t</b><br>Да, этот эффект мне и надо воспроизвести. А то у меня (если запускать этот сэмпл) нет никакого эффекта.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=307219&amp;user=6336&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=14" class="addthx" data-post="307219"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]==DJ==[ZLO][/b]','')">==DJ==[ZLO]</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/3756.png" alt=""><br><span class=txtSm>Ранг: 74.4 (постоянный), 76thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.41'>Активность: 0.05<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=3756">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2012 14:01 <br><script type="text/javascript">QU('==DJ==[ZLO]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto===DJ==[ZLO]" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Может не по теме , вроде такой эффект CureIt! от веба делает. Посмотри что там да как.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=307229&amp;user=3756&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=15" class="addthx" data-post="307229"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2012 14:20 &middot; Поправил: F_a_u_s_t <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
typedef HRESULT (__stdcall *ShellDimScreen) (IUnknown* *Unknown, HWND* hWindow);<br>HMODULE _ShellDimScreen(HWND hWindow)<br>{<br>    HMODULE Dll = LoadLibraryA(&quot;msgina.dll&quot;);<br>    if (Dll != NULL)<br>    {<br>        IUnknown* Unknown;<br>        ShellDimScreen Func = (ShellDimScreen) GetProcAddress(Dll,(LPSTR) 16);<br>        Func(&amp;Unknown, &amp;hWindow);<br>        return Dll;<br>    }<br>    else<br>    return NULL;<br>}<br><br>Add:<br>Надо было сразу уточнить. <br>Ждемс новый винлокер. <br><br>Скомпиленный семпл.<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/335e_15.06.2012_EXELAB.rU.tgz">335e_15.06.2012_EXELAB.rU.tgz</a> - GinaTest.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=307230&amp;user=6&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=16" class="addthx" data-post="307230"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3756" title="15-06-2012 10:41, ранг:22.2" target="_blank">==DJ==[ZLO]</a>, <a href="action=userinfo&user=6336" title="15-06-2012 10:49, ранг:427.1" target="_blank">ARCHANGEL</a>, <a href="action=userinfo&user=2981" title="15-06-2012 11:28, ранг:216.4" target="_blank">Flint</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2012 14:56 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>F_a_u_s_t</b><br>Вау, какой эффект <img src="img/smilies/s1.gif" alt=""> Блин, прав был <b>neomant</b> - надо было мне больше ресёрчить эту #16, и там действительно не указатели на два нулевых дворда. Ладно, буду разбираться.<br><br>Но, что интересно, этот эффект серости возникает только если я не дебажу софт отладчиком (OllyDbg). Под дебаггером стабильно вешает все приложения. Но это уже что-то.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=307231&amp;user=6336&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=17" class="addthx" data-post="307231"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2012 15:02 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>CureIt на сколько я помню свое окно создает которое перекрывает рабочий стол, ибо совместимость с другими осями.<br>А проблемы с отладкой из за того что gina это часть winlogon, плюс com == ахтунг, ms вообще пугает что винда может слететь, там специально встроена такая куйня, как логирование.<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=307232&amp;user=6&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=18" class="addthx" data-post="307232"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2012 15:22 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>F_a_u_s_t пишет:<br>Ждемс новый винлокер.  </I><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_number">386</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function"><b>model</b></span>&nbsp;small<span class="hl_char">,</span>&nbsp;<span class="hl_function">stdcall</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>option</b></span>&nbsp;casemap&nbsp;<span class="hl_char">:</span><span class="hl_function">none</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>assume</b></span>&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_function">nothing</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>include</b></span>&nbsp;<span class="hl_char">\</span>MASM32<span class="hl_char">\</span>INCLUDE<span class="hl_char">\</span>kernel32<span class="hl_char">.</span><span class="hl_function">inc</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>include</b></span>&nbsp;<span class="hl_char">\</span>MASM32<span class="hl_char">\</span>INCLUDE<span class="hl_char">\</span>user32<span class="hl_char">.</span><span class="hl_function">inc</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>include</b></span>&nbsp;<span class="hl_char">\</span>MASM32<span class="hl_char">\</span>INCLUDE<span class="hl_char">\</span>ntdll<span class="hl_char">.</span><span class="hl_function">inc</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>include</b></span>&nbsp;<span class="hl_char">\</span>MASM32<span class="hl_char">\</span>INCLUDE<span class="hl_char">\</span>gdi32<span class="hl_char">.</span><span class="hl_function">inc</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>include</b></span>&nbsp;<span class="hl_char">\</span>MASM32<span class="hl_char">\</span>INCLUDE<span class="hl_char">\</span>windows<span class="hl_char">.</span><span class="hl_function">inc</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>includelib</b></span>&nbsp;<span class="hl_char">\</span>MASM32<span class="hl_char">\</span>LIB<span class="hl_char">\</span>kernel32<span class="hl_char">.</span>lib</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>includelib</b></span>&nbsp;<span class="hl_char">\</span>MASM32<span class="hl_char">\</span>LIB<span class="hl_char">\</span>user32<span class="hl_char">.</span>lib</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>includelib</b></span>&nbsp;<span class="hl_char">\</span>MASM32<span class="hl_char">\</span>LIB<span class="hl_char">\</span>ntdll<span class="hl_char">.</span>lib</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>includelib</b></span>&nbsp;<span class="hl_char">\</span>MASM32<span class="hl_char">\</span>LIB<span class="hl_char">\</span>gdi32<span class="hl_char">.</span>lib</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_comment">; #########################################################################</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_function">data</span></li><li class="hl_l1">text&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_quote">&quot;ВАШ КОМПЬЮТЕР ЗАБЛОКИРОВАН.&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">fontname&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_quote">&quot;Arial&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">msgina&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_quote">&quot;msgina.dll&quot;</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l1">ptitle&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_quote">&quot;Эффект затенения&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">ptext&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_quote">&quot;Проверка программы&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_function">data</span><span class="hl_char">?</span></li><li class="hl_l1">DC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">4</span>&nbsp;<span class="hl_function"><b>dup</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">?</span><span class="hl_char">)</span></li><li class="hl_l0">ShellDimScreen&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">x&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_function">code</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">start<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;GetDesktopWindow</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;GetWindowDC&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span>DC<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;TRANSPARENT</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span>DC<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;SetBkMode</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;White</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span>DC<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;SetTextColor</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;fontname</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;DEFAULT_PITCH&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;FF_ROMAN</li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;DEFAULT_QUALITY</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;CLIP_DEFAULT_PRECIS</li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;OUT_DEFAULT_PRECIS</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;RUSSIAN_CHARSET</li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function">FALSE</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function">FALSE</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">400</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">50</span></li><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;CreateFontA&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span>DC<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;SelectObject</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;text</li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;lstrlenA</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;text</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">150</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">150</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span>DC<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;TextOutA</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;GetDesktopWindow</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span>DC<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;ReleaseDC</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;msgina</li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;LoadLibraryA</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">16</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;GetProcAddress</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span>ShellDimScreen<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;x</li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;x</li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;ptext</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;ptitle</li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;MessageBoxA</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;ExitProcess</li><li class="hl_l1"><span class="hl_function"><b>end</b></span>&nbsp;start</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_comment">; #########################################################################</span></li>        </ol>
    </div>
</div></div>
<br><br>))
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=307234&amp;user=2981&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=19" class="addthx" data-post="307234"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2012 18:56 &middot; Поправил: F_a_u_s_t <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>Flint</b><br>Зачет. <img src="img/smilies/s6.gif" alt=""><br><br><b>ARCHANGEL</b><br>Тут знакомый семпл подкинул (где то подобрал на просторах интронета) там этот эффект реализован без зависимости от msgin, будет работать и на XP и на Seven.<br>Код на Delphi но WinApi так что с переводом проблем не будет.<br>Даешь винлокеры с поддержкой скинов пролетариату. <img src="img/smilies/s6.gif" alt=""><br><br>Add:<br>Атач забыл.<br><br><img src="img/attach.gif" alt=""> <a href="./files/4e18_15.06.2012_EXELAB.rU.tgz">4e18_15.06.2012_EXELAB.rU.tgz</a> - Attach.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=307247&amp;user=6&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=20" class="addthx" data-post="307247"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2012 19:04 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>F_a_u_s_t пишет:<br>Даешь винлокеры с поддержкой скинов пролетариату. </I><br>А был же какой-то винлокермэйкер, можно было менять цвет текст и еще что-то.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=307248&amp;user=5291&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=21" class="addthx" data-post="307248"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2012 19:14 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Не надоело ещё ерундой заниматься с локерами? Посты выпиливать лишние буду.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=307249&amp;user=1556&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=22" class="addthx" data-post="307249"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2012 13:00 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<b>F_a_u_s_t</b><br><br>Смотрел я на ваш пример, сделал свой, вроде бы, один в один, а не работает. Не подскажете, что не так?<br><noindex><a href="http://rghost.ru/38730771" rel="nofollow" target="_blank">--&gt; Пример &lt;--</a></noindex> Код, который на Delphi - это хороршо, но мне нужно изучить именно алго работы ShellDimScreen для устранения вышеописанной проблемы, а, как я понял, этот код и код на делфях - не одно и то же.<br><br>А к локерам мои изыскания никаких отношений не имеют, ибо я не пытаюсь его (локер) написать, и не пытаюсь после него восстанавливать систему.<br><br><b>Добавлено</b><br><br>Уже и так делал:
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">IUnknown<span class="hl_char">*</span>&nbsp;lp<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
, а ничего не меняется и не работает.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=307410&amp;user=6336&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=23" class="addthx" data-post="307410"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2012 13:26 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">typedef&nbsp;HRESULT&nbsp;<span class="hl_char">(</span>__stdcall&nbsp;<span class="hl_char">*</span>ShellDimScreen<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span>IUnknown<span class="hl_char">*</span>&nbsp;<span class="hl_char">*</span>Unknown<span class="hl_char">,</span>&nbsp;HWND<span class="hl_char">*</span>&nbsp;hWindow<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">HMODULE&nbsp;_ShellDimScreen<span class="hl_char">(</span>HWND&nbsp;hWindow<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">HMODULE&nbsp;Dll&nbsp;<span class="hl_char">=</span>&nbsp;LoadLibraryA<span class="hl_char">(</span><span class="hl_quote">&quot;msgina.dll&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>Dll&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">IUnknown<span class="hl_char">*</span>&nbsp;Unknown<span class="hl_comment">; // Обязательно ибо com.</span></li><li class="hl_l1">ShellDimScreen&nbsp;Func&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>ShellDimScreen<span class="hl_char">)</span>&nbsp;GetProcAddress<span class="hl_char">(</span>Dll<span class="hl_char">,</span><span class="hl_char">(</span>LPSTR<span class="hl_char">)</span>&nbsp;<span class="hl_number">16</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;hWindow&nbsp;HANDLE&nbsp;окна&nbsp;в&nbsp;котором&nbsp;вызываешь&nbsp;функу<span class="hl_char">.</span></li><li class="hl_l1">Func<span class="hl_char">(</span><span class="hl_char">&amp;</span>Unknown<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>hWindow<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">return&nbsp;Dll<span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0"><span class="hl_function">else</span></li><li class="hl_l1">return&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br><br>Мой семпл, в написании использовался самопальный класс типа mfc ну думаю суть поймешь.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">typedef&nbsp;HRESULT&nbsp;<span class="hl_char">(</span>__stdcall&nbsp;<span class="hl_char">*</span>ShellDimScreen<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span>IUnknown<span class="hl_char">*</span>&nbsp;<span class="hl_char">*</span>Unknown<span class="hl_char">,</span>&nbsp;HWND<span class="hl_char">*</span>&nbsp;hWindow<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">HMODULE&nbsp;_ShellDimScreen<span class="hl_char">(</span>HWND&nbsp;hWindow<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">HMODULE&nbsp;Dll&nbsp;<span class="hl_char">=</span>&nbsp;LoadLibraryA<span class="hl_char">(</span><span class="hl_quote">&quot;msgina.dll&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>Dll&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">IUnknown<span class="hl_char">*</span>&nbsp;Unknown<span class="hl_comment">;</span></li><li class="hl_l0">ShellDimScreen&nbsp;Func&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>ShellDimScreen<span class="hl_char">)</span>&nbsp;GetProcAddress<span class="hl_char">(</span>Dll<span class="hl_char">,</span><span class="hl_char">(</span>LPSTR<span class="hl_char">)</span>&nbsp;<span class="hl_number">16</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">Func<span class="hl_char">(</span><span class="hl_char">&amp;</span>Unknown<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>hWindow<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">return&nbsp;Dll<span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0"><span class="hl_function">else</span></li><li class="hl_l1">return&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>int</b></span>&nbsp;WINAPI&nbsp;WinMain&nbsp;<span class="hl_char">(</span>HINSTANCE&nbsp;hInstance<span class="hl_char">,</span>&nbsp;HINSTANCE&nbsp;hPrevInstance<span class="hl_char">,</span>&nbsp;LPSTR&nbsp;lpszArgument<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;CmdShow<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;CWindow&nbsp;window<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;ClassName&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;MyApp&quot;</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;Name&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;Example&quot;</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;window<span class="hl_char">.</span>Create<span class="hl_char">(</span>hInstance<span class="hl_char">,</span>&nbsp;ClassName<span class="hl_char">,</span>&nbsp;Name<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;HMODULE&nbsp;Dll&nbsp;<span class="hl_char">=</span>&nbsp;_ShellDimScreen<span class="hl_char">(</span>window<span class="hl_char">.</span>hWindow<span class="hl_char">)</span><span class="hl_comment">; // Вызываем функцию</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;window<span class="hl_char">.</span>Show<span class="hl_char">(</span>CmdShow<span class="hl_char">)</span><span class="hl_comment">; // Тут идет цикл обработки сообщений окна, суть не важна, можно прям там //воткнуть вызов.</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>Dll&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;FreeLibrary<span class="hl_char">(</span>Dll<span class="hl_char">)</span><span class="hl_comment">; // тут понятно, освобождаем хендл джины.</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;еще&nbsp;надо&nbsp;Uncnown<span class="hl_char">.</span>Release<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">; забыл написать. &lt;img src=&quot;http://exelab.ruimg/smilies/s1.gif&quot; border=&quot;0&quot; align=&quot;&quot; alt=&quot;&quot;&gt;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br><br>У тебя просто нет задержки, оно срабатывает и сразу закрывается, делай или в цикле обработки сообщений или перед ним.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=307412&amp;user=6&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=24" class="addthx" data-post="307412"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=6336" title="18-06-2012 09:45, ранг:430.1" target="_blank">ARCHANGEL</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2012 13:47 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>F_a_u_s_t</b><br><br>Добавил <br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">ShowWindow<span class="hl_char">(</span><span class="hl_char">(</span>HWND<span class="hl_char">)</span>&nbsp;a2<span class="hl_char">,</span>nCmdShow<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>GetMessageA<span class="hl_char">(</span><span class="hl_char">&amp;</span>Mess<span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TranslateMessage<span class="hl_char">(</span><span class="hl_char">&amp;</span>Mess<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DispatchMessageA<span class="hl_char">(</span><span class="hl_char">&amp;</span>Mess<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div>
<br><br>И всё заработало!
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=307414&amp;user=6336&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=25" class="addthx" data-post="307414"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2012 14:01 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Мои поздравления.<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=307415&amp;user=6&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=26" class="addthx" data-post="307415"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2012 11:29 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
В ходе изучения проблемы выяснилась следующая, весьма интересная, ситуация. При выключении компьютера диалог <b>Завершения работы</b> не то, чтоб не создавался, а создавался очень долго - появления этого диалога можно ожидать минутами. В ходе поиска в гугле, ресёрча с дизассемблером и активной помощи <b>F_a_u_s_t</b> была проведена аналогия с диалогом ShellShutdownDialog, и ситуация - идентичная. Проблема оказалась в функции <b>WUCheckForUpdatesAtShutdown</b>, знаете, иногда возникает такая ситуация, что перед выключением система предлагает установить обновления, и уже только потом выключить комп, либо же не устанавливать апдейты и выйти. Вот эта функа и проверяет, есть ли такие апдейты, которые следует установить. Внутри неё торможение происходит при вызове CoCreateInstance, и вообще жутко тормозит любая работа с COM - объектами. Что самое интереное, так это то, что всё неизменно тормозит на <b>ZwRequestWaitReplyPort</b>, и тут возникает вопрос - возможна ли такая ситуация, что проблема кроется ни в COM-интерфейсах и объектах, а в RPC или же LPC? И что по этому поводу можно почитать?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=307499&amp;user=6336&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=27" class="addthx" data-post="307499"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2012 11:35 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>У меня как то был косяк с RPC так все через попу работало, так что вполне может,  с LPC не разу проблем не было.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=307500&amp;user=6&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=28" class="addthx" data-post="307500"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2012 13:34 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20044.html&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
А решение проблемы было (и есть) <noindex><a href="http://support.microsoft.com/kb/971058" rel="nofollow" target="_blank">--&gt; Здесь &lt;--</a></noindex>. Спасибо <b>F_a_u_s_t</b>.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=307508&amp;user=6336&amp;forum_n=6&amp;topic=20044.html&amp;page=0&amp;anchor=29" class="addthx" data-post="307508"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Реверсинг диалога о завершении работы Windows</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#30" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="20044">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=20044" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
