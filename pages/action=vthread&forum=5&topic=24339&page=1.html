<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как внутри DllMain, определить возврата  из загрузки длл в основной код? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Пропустил в названии слово &quot;адрес&quot; возврата. Не знаю как исправить на этом форуме. Пишу длл. Внутри ее DllMain, выполняю необходимую работу. Но по выходу из загрузки этой длл хочу удалить ее из памяти процесса. Т.е.">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=6859'>cppasm</a>, <a target='_blank' href='?action=userinfo&amp;user=55996'>dutyfree</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как внутри DllMain, определить возврата  из загрузки длл в основной код?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=5&amp;topic=24339&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=5&amp;topic=24339&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 сентября 2016 18:42 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Пропустил в названии слово &quot;адрес&quot; возврата. Не знаю как исправить на этом форуме.<br>Пишу длл. Внутри ее DllMain, выполняю необходимую работу. Но по выходу из загрузки этой длл хочу удалить ее из памяти процесса. Т.е. если знать адрес возврата в основной код, то туда можно поместить код удаления этой длл, и загрузки оригинальной.  Что я и делаю сейчас, поэтому приходится постоянно искать вручную  адрес возврата , и задавать принудительно. Но хочется находить этот адрес автоматически внутри самой, загружаемой длл.<br>Так вот, можно - ли каким-то образом узнать этот адрес?<br>Изыскания в стеке с помощью ebp, не подходят. Некоторые протекторы рвут связанную цепочку кадров вызова фукций. Да и нет уверенности, что вложенность ф-ций будет постоянной на разных ОС и программах.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367933&amp;user=29098&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=1" class="addthx" data-post="367933"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 02:34 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
<I>dosprog пишет:<br>Иногда другого выхода нет, <br>тем более, что такие &quot;тупые методы&quot; тоже работают. </I><br><I>difexacaw пишет:<br>есть апи для получения стека, RtlWalkFrameChain() etc.  </I><br>А вот еще вопрос (прошу прощения за безграмотность, но поэтому и пишу в разделе для начинающих). А базу стека кто определяет? Вернее от чего зависит смена места в памяти выделенная под стек. Например я начну искать адрес возврата методом связанных кадров (через ebp). И наткнусь на разрушенную связь. Работая-то в отладчике, это сразу видно. А вот как быть коду, который пока не видит &quot;глазами&quot;. То-есть, как мне определить, что в этом месте разрыв? Ведь ebp наверное может выйти за границы памяти выделенной под стек, не только по причине разрыва связей из-за протектора. Или внутри одного и того-же файла, стек всегда находится в одном и том-же диапазоне?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368021&amp;user=29098&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=2" class="addthx" data-post="368021"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 02:44 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<b>Kuzya69</b><br><br>Есть есчо метод фаззинга, это перебор адресов с их проверкой, но это по дефолту вроде отключено. Границы стека описаны в TEB. Система при получении стека вызовов использует карту, в которой отображаются проецированные регионы. Далее обычная защита загрузчик не трогает, по крайней мере я такого не видел. По нормальному если делать, то нужно описать код, через который вызывается загрузчик и далее пролистать стек и найти адрес.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368022&amp;user=40990&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=3" class="addthx" data-post="368022"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 02:48 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
какой такой &quot;разрыв&quot;?..<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span><span class="hl_registr">esp</span></li><li class="hl_l1"><span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_registr">ecx</span></li><li class="hl_l0">@@next<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_function">cld</span></li><li class="hl_l0"><span class="hl_function">lodsd</span></li><li class="hl_l1"><span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_number">401000h</span></li><li class="hl_l0"><span class="hl_function"><b>jb</b></span>&nbsp;@@next</li><li class="hl_l1"><span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_number">0fFFffFFh</span></li><li class="hl_l0"><span class="hl_function"><b>ja</b></span>&nbsp;@@next</li><li class="hl_l1"><span class="hl_function"><b>inc</b></span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">10</span>&nbsp;<span class="hl_comment">;&lt;----------- например,10</span></li><li class="hl_l1"><span class="hl_function"><b>ja</b></span>&nbsp;&nbsp;@@error</li><li class="hl_l0"><span class="hl_function">lodsd</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;сравнить&nbsp;строку&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span>&nbsp;&nbsp;с&nbsp;именем&nbsp;DLL</li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;если&nbsp;не&nbsp;равно&nbsp;<span class="hl_char">-</span>&nbsp;прыг&nbsp;в&nbsp;@@next</li><li class="hl_l1"><span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_number">2</span>&nbsp;&nbsp;&nbsp;<span class="hl_comment">;&lt;------ 2 или другое число, надо определить</span></li><li class="hl_l0"><span class="hl_function"><b>jb</b></span>&nbsp;@@next</li><li class="hl_l1"><span class="hl_function"><b>sub</b></span>&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span><span class="hl_number">4</span>&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_number">2</span></li><li class="hl_l0">@@ok<span class="hl_char">:</span>&nbsp;<span class="hl_comment">;---- ESI = искомый адрес возврата из LoadLibrary() </span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0">@@error<span class="hl_char">:</span>&nbsp;<span class="hl_comment">;---- ошибка, ничего найти не удалось.</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368024&amp;user=35473&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=4" class="addthx" data-post="368024"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 02:52 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<I>difexacaw пишет:<br>По нормальному если делать, то нужно описать код, через который вызывается загрузчик и далее пролистать стек и найти адрес.  </I><br>Тут немного попонятнее, как для первоклассника, можно написАть? <br>А то я ничерта не понял, особенно про код, который нужно описАть.<br>И кстати, как вызывается эта фукция RtlWalkFrameChain(), с какими параметрами? А то чего-то про нее в поисковиках не видно.<br><I>dosprog пишет:<br>cmp ecx,2   ;&lt;------ 2 или другое число, надо определить </I><br>А если протектор сметит версию? Или например, помимо того, что он делает копии длл-ок, он еще и избранные апи-шки (тот-же самый LoadLibraryW например) начнет под ВМ протектить?<br>А разрыв, я имел ввиду, когда идешь по стеку вниз(в Олли), типа ebp, [ebp],[[ebp]], и на каком-то этапе этот ebp начинает смотреть в небо, за пределы стека. Все, цепочка закончилась.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368025&amp;user=29098&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=5" class="addthx" data-post="368025"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 03:05 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
<I>Kuzya69 пишет:<br>А если протектор смеНит версию? </I><br><br>тогда -  &lt;jmp @@error:&gt;<br><br><I>Kuzya69 пишет:<br>типа ebp, [ebp],[[ebp]], и на каком-то этапе этот ebp начинает смотреть в небо, за пределы стека. Все, цепочка закончилась.  </I><br><br>На это и не надо расчитывать.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368028&amp;user=35473&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=6" class="addthx" data-post="368028"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 03:07 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<b>Kuzya69</b><br><br>Тут прототипы имеются.<br><br><img src="img/attach.gif" alt=""> <a href="./files/fd8a_26.09.2016_EXELAB.rU.tgz">fd8a_26.09.2016_EXELAB.rU.tgz</a> - stktrace.rar
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368029&amp;user=40990&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=7" class="addthx" data-post="368029"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 03:11 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<I>dosprog пишет:<br>На это и не надо расчитывать.  </I><br>А есть гарантия, что если в WinXP, для программы, пусть одной версии, это число (в вашем коде 2), будет равно например 3, то и в Win10, это число тоже будет 3 ?<br><br><I>dosprog пишет:<br>тогда - &lt;jmp @@error:&gt; </I><br>Вот и я про это. А адрес возврата-то, есть. И его надо искать. Значит по идее надо увеличивать ту двойку до трех, и продолжать. Но с таким подходом нарвемся на разрыв в стеке вызовов.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368030&amp;user=29098&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=8" class="addthx" data-post="368030"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 03:13 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<I>Kuzya69 пишет:<br>А есть гарантия, что если в WinXP, для программы, пусть одной версии, это число (в вашем коде 2), будет равно например 3, то и в Win10, это число тоже будет 3 ?  </I><br><br>2 там потому, что LoadLibraryA() это &quot;обёртка&quot; для &quot;LoadLibraryExA()&quot;.<br><br>Раз начали костылять, то надо тогда проверить на всей линейке.<br><br>Впрочем, по-любому, универсальным этот способ не будет.<br>Задача, полагаю, так и не стоИт.<br><br><I>Kuzya69 пишет:<br>(в вашем коде 2) </I><br><br>Это не от фонаря, а в стеке при чистом вызове LoadLibrary() у меня в системе.<br>А уже оттуда 2 попало в код.<br><br>Надо проверять, короче.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368031&amp;user=35473&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=9" class="addthx" data-post="368031"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 03:21 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
А вот кстати вспомнил, почему я не хотел с ebp-методом связываться. Метод рушился на двух одинаковых ОС WinXPsp3, только в одной была установлена программа Unlocker, а в другой нет. Вот и получалось ваше число на единицу различалось.<br>И я думаю, это не одна такая программа, которая &quot;вклинивается&quot; в стек, перед загрузкой каких-то модулей-библиотек и прочего.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368032&amp;user=29098&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=10" class="addthx" data-post="368032"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 03:23 <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
Вполне ожидаемо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368033&amp;user=35473&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=11" class="addthx" data-post="368033"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 03:23 <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
<I>Kuzya69 пишет:<br>типа ebp, [ebp],[[ebp]], и на каком-то этапе этот ebp начинает смотреть в небо, за пределы стека. Все, цепочка закончилась </I><br><br><I>Kuzya69 пишет:<br>Вот и получалось ваше число на единицу различалось </I><br><br>так ebp тут никто и не трогает<br>предоставленный <b>dosprog</b> код по сути просто поднимается по стэку в поисках числа в диапазоне 401000h ..  0fFFffFFh<br>ecx в этом случае - счётчик найденных подходящих чисел<br>по идее, внутри вызова &quot;LoadLibrary и так далее&quot; это число встречаться не должно (разве что может остаться после конвертации ANSI в unicode), поэтому и предполагается что найдётся хоть что-то
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368034&amp;user=26242&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=12" class="addthx" data-post="368034"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 03:28 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>поэтому и предполагается что найдётся хоть что-то<br> </I><br>И вдобавок уточняется строка-аргумент LoadLibrary().<br>То (выше)  вполне работоспособный кусок кода. Дописать только сравнение строк по &lt;rep cmpsb&gt;.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368035&amp;user=35473&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=13" class="addthx" data-post="368035"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 03:36 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>так ebp тут никто и не трогает </I><br>Да, действительно, <I>dosprog </I> прошу прощения. Просто разговор был про поиск по кадрам стека, вот я и взглянул бегло на код, даже не разбирал его &quot;по полочкам&quot;. Надо было успевать отвечать в топике. Вот я и подумал, что код про это-же.<br>Щас пригляделся к коду. Смысл понял. Но, то что я писАл про Unlocker, тоже разрушит логику поиска по вашему алгоритму, точно так-же как и в случае поиска по ebp.<br>PS<br>Хотя наверное нет, сравнение с диапазоном 401000..0fffffff, не даст посчитать ненужное. Чужие длл-ки , то будут с другими адресами возврата, не с адресами основного ехе. Еще бы быть уверенным, что на других ОС база загрузки ехе, по адресу 400000.<br>Но действительно, костыль, ничего не гарантирующий.<br>Хотя наверное нужно подрезать диапазон адресов, не конкретными значениями 401000..0fffffff. А например значениями региона загрузки файла ехе, который можно взять из связанных списков загруженных модулей, в LdrData.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368036&amp;user=29098&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=14" class="addthx" data-post="368036"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 03:45 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
<I>Kuzya69 пишет:<br>Но, то что я писАл про Unlocker, тоже разрушит логику поиска по вашему алгоритму, точно так-же как и в случае поиска по ebp.  </I><br><br>Надо пробовать, короче.<br><br><I>Kuzya69 пишет:<br>можно взять ..., в PEB.  </I><br><br>Можно.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368038&amp;user=35473&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=15" class="addthx" data-post="368038"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 03:50 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
Цепочка есть вторая, которая в SEH-фреймах.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368039&amp;user=40990&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=16" class="addthx" data-post="368039"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 03:56 <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
<I>Kuzya69 пишет:<br>Чужие длл-ки , то будут с другими адресами возврата, не с адресами основного ехе. </I><br>ну знач надо их базу брать, и определять для новой цели какой-то диапазон<br><br><I>Kuzya69 пишет:<br>что на других ОС база загрузки ехе, по адресу 400000 </I><br>в 99.9999% случаях база загрузки ехе по адресу указанному в поле ImageBase хидера<br><br><I>Kuzya69 пишет:<br>Но действительно, костыль, ничего не гарантирующий.  </I><br>это с самого начала был костыль, и им он и останется.<br>главное задачу решить, а универсальное решение на всё случаи жизни напишешь как-нибудь в другой раз
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368040&amp;user=26242&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=17" class="addthx" data-post="368040"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 04:07 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>а универсальное решение на всё случаи жизни напишешь как-нибудь в другой раз </I><br>   <img src="img/smilies/s1.gif" alt=""><br>Да мне этого раза уже на пол жизни хватило. Я же в основном только одной программой и занимаюсь,  только разных версий, для себя. <br>Хотя занятие-то конечно интересное. Это не за столом сидеть и пьяные разговоры слушать. Вот так занятие я себе придумал. Но я рад честно говоря, что есть чем свободное после работы время занять.<br>Ладно, до завтра (вернее до сегодня). Пойду мысли в кучу собирать.<br>Спасибо, ребята, за ликбез. Пойду отдыхать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368041&amp;user=29098&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=18" class="addthx" data-post="368041"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 11:40 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
<b>Kuzya69</b><br><br>Собрал маленький семпл(не существенные детали опущены, типо выделения тлс, отдельной сборки дллки етц).<br><br><img src="img/attach.gif" alt=""> <a href="./files/90b3_26.09.2016_EXELAB.rU.tgz">90b3_26.09.2016_EXELAB.rU.tgz</a> - StkWalk.rar
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368055&amp;user=40990&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=19" class="addthx" data-post="368055"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2016 11:43 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
после этц, клерк опять спалился <img src="img/smilies/s5.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368056&amp;user=15381&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=20" class="addthx" data-post="368056"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2016 00:54 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Собрал маленький семпл... </I><br>Ух, штука может и хорошая, но я бы ее с удовольствием на Делфи поглядел. Ладно положу на полочку, можт позж въеду.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368085&amp;user=29098&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=21" class="addthx" data-post="368085"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2016 00:58 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
<I>Kuzya69 пишет:<br> А в Си я </I><br><br>Там ассемблер. Причём по стилю да, что-то очень знакомое<br><br><br><I>Kuzya69 пишет:<br>Для какого это компиллятора (МАСМ, ТАСМ ...). В смысле, что из оболочек качать, чтоб проект туда засунуть, и не было ошибок при открытии?<br> </I><br><b>-=AkaBOSS=-</b> дальше написал.<br>Но критичное там прилинковывается в двоичном виде.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368086&amp;user=35473&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=22" class="addthx" data-post="368086"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2016 01:05 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
Для какого это компиллятора (МАСМ, ТАСМ ...). В смысле, что из оболочек качать, чтоб проект туда засунуть, и не было ошибок при открытии?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368087&amp;user=29098&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=23" class="addthx" data-post="368087"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2016 02:55 <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#24');return false;">#24</a> </span><div align=left><br>
<I>Kuzya69 пишет:<br>Для какого это компиллятора (МАСМ, ТАСМ ...) </I><br>строки типа<br>include \<b>masm32</b>\include\ntdll.inc<br>подсказок не дают?<br><br>там ведь есть уже бинарник собранный
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368088&amp;user=26242&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=24" class="addthx" data-post="368088"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2016 15:31 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#25');return false;">#25</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>строки...подсказок не дают? </I><br>Вроде понял. Но что-то не могу разобраться, как это все в куче загрузить в МАСМ32. Ладно, пока изучаю справку по МАСМ. Я с асмом на уровне отладчика знаком, а высокоуровневые команды, приходится изучать пока.<br><I>-=AkaBOSS=- пишет:<br>там ведь есть уже бинарник собранный  </I><br>Но бинарник-то мне зачем?. Мне готовое не надо. Я должен суть понять. И если пойму в свой проект на Делфи перепишу.<br>Вот только я не совсем понял, это что, это проект длл-ки с экспортными функциями типа GpInSnapPointer, xLog, xReturn....? Т.е. код, сам, ничего не делает? Не нашел знакомого слова &quot;start&quot; или &quot;end start&quot; .
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368093&amp;user=29098&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=25" class="addthx" data-post="368093"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 сентября 2016 02:02 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24339&amp;page=1#26');return false;">#26</a> </span><div align=left><br>
<b>Kuzya69</b><br><br>&gt; Но бинарник-то мне зачем?<br><br>Потому что по сурцу можите не понять, а вы с отладчиком знакомы ^. А если код не нужен, то и компилить его не надо, и дллка тоже не нужна. Такое только для рипа необходимо, но просто это взять себе не получится, как и вновь скомпилить <img src="img/smilies/s2.gif" alt="">
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368107&amp;user=40990&amp;forum_n=5&amp;topic=24339&amp;page=1&amp;anchor=26" class="addthx" data-post="368107"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=5&amp;topic=24339&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=5&amp;topic=24339&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как внутри DllMain, определить возврата  из загрузки длл в основной код?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#27" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="24339">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24339" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
