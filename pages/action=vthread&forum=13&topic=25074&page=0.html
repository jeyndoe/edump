<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Прошу помощи с &quot;изменённым&quot; UPX - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Добрый день! Прошу помощи с методикой распаковки кривого UPX http://ge.tt/3lIbFko2 Суть такая: если распаковать UPX-ом, то файл оказывается нерабочим, тем не менее, если далее проюзать на файл из PE Tools v1.5 RC7 плагин Reloc">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Прошу помощи с &quot;изменённым&quot; UPX</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ap0stol[/b]','')">ap0stol</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.62'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41697">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2018 08:19 &middot; Поправил: ap0stol <br><script type="text/javascript">QU('ap0stol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ap0stol" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=25074.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Добрый день!<br><br>Прошу помощи с методикой распаковки кривого UPX<br>http://ge.tt/3lIbFko2<br><br>Суть такая:<br>если распаковать UPX-ом, то файл оказывается нерабочим, тем не менее, если далее проюзать на файл из PE Tools v1.5 RC7 плагин Reloc Rebuilder, то получаем работоспособный файл.<br><br>Если пытаться распаковать x64dbg + scylla используя скрипт<br>https://github.com/x64dbg/Scripts/blob/master/upx391.txt<br>, то получаем <br>oep 000000013FF3A4FC<br>va 000000013FF3B000<br>size 00000550<br>и кривой импорт 000000013FF3A9D4 с инструкцией RET 0x0<br>либо 19 кривых импортов, если не соглашаться с advanced search<br>и естественно нерабочий дамп.<br><br>Скрипт https://github.com/x64dbg/Scripts/blob/master/3.06_to_3.91.txt не находит OEP вообще.<br><br>Если пытаться распаковать через бряк на доступ к памяти по rsp на втором шагу модуля zm.exe<br>то получаю аналогичные скрипту oep и va<br>и аналогичный кривой импорт 000000013F5FA9D4 с инструкцией RET 0x0<br><br>я понимаю что где-то, видимо, косячю с правильным OEP, но не могу понять где. Прошу помощи.<br><br>цель не столько именно распаковать (т.к. распакованный вариант есть), а понять что делаю не правильно и делать правильно, ну и распаковать новую версию этого майнера) http://ge.tt/4X1yHko2 (в неё как минимум ssl влинковано)<br><br><b>Добавлено спустя 12 минут</b><br>да, более свежая версия этого файла\майнера распаковывается UPX-ом, но Reloc Rebuilder не берёт распакованный файл<br><br>Ps это dstm майнер
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=382456&amp;user=41697&amp;forum_n=13&amp;topic=25074.html&amp;page=0&amp;anchor=1" class="addthx" data-post="382456"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]SDK[/b]','')">SDK</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 54.0 (постоянный), 49thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.66'>Активность: 0.72<span style='color:green'>&nearr;</span>1.1</span><br>Статус: <a href="action=userinfo&amp;user=41635">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2018 09:06 <br><script type="text/javascript">QU('SDK','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SDK" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=25074.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
после Pushad бряк на доступ на Dword смотрим стек,дальше там Popad и джамп на OEP.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=382457&amp;user=41635&amp;forum_n=13&amp;topic=25074.html&amp;page=0&amp;anchor=2" class="addthx" data-post="382457"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ap0stol[/b]','')">ap0stol</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.62'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41697">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2018 10:02 &middot; Поправил: ap0stol <br><script type="text/javascript">QU('ap0stol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ap0stol" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=25074.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
ей богу, туплю что-ли...<br><br>если распаковывать  через x64dbg, я делаю следующее:<br>из<br>0000000077BD7981 | EB 00                    | jmp ntdll.77BD7983                      |<br>выполнить до<br>&gt;&gt;000000013F3CC190 | 53                       | push rbx                                |<br>000000013F3CC191 | 56                       | push rsi                                |<br>000000013F3CC192 | 57                       | push rdi                                |<br>000000013F3CC193 | 55                       | push rbp                                |<br>000000013F3CC194 | 48 8D 35 65 DE FD FF     | lea rsi,qword ptr ds:[13F3AA000]        |<br>000000013F3CC19B | 48 8D BE 00 70 CB FF     | lea rdi,qword ptr ds:[rsi-349000]       |<br><br>делаю шаг до второй строки<br>000000013F3CC191 | 56                       | push rsi                                |<br>далее RSP-перейти к дампу, аппаратный бряк на память\доступ dword<br><br>попадаем в <br>(даже если шаг сделать до 000000013F3CC194 и там RSP-перейти к дампу - переход всё-равно в этот код происходит)<br>000000013F3CC3FD | 48 8D 44 24 80           | lea rax,qword ptr ss:[rsp-80]           |<br>000000013F3CC402 | 6A 00                    | push 0                                  |<br>000000013F3CC404 | 48 39 C4                 | cmp rsp,rax                             |<br>000000013F3CC407 | 75 F9                    | jne zm.13F3CC402                        |<br>000000013F3CC409 | 48 83 EC 80              | sub rsp,FFFFFFFFFFFFFF80                |<br>000000013F3CC40D | E9 EA E0 CA FF           | jmp zm.13F07A4FC                        |<br>000000013F3CC412 | 00 00                    | add byte ptr ds:[rax],al                |<br>000000013F3CC414 | 00 00                    | add byte ptr ds:[rax],al                |<br>000000013F3CC416 | 00 00                    | add byte ptr ds:[rax],al                |<br>000000013F3CC418 | 94                       | xchg esp,eax                            |<br>000000013F3CC419 | 00 00                    | add byte ptr ds:[rax],al                |<br>000000013F3CC41B | 00 00                    | add byte ptr ds:[rax],al                |<br><br><br><br>далее видим цикл, ставим бряк на <br>000000013F3CC40D | E9 EA E0 CA FF           | jmp zm.13F07A4FC                        |<br>после срабатывания бряка - шаг с заходом, попадаем в<br>000000013F07A4FC | 48 83 EC 28              | sub rsp,28                              |<br>000000013F07A500 | E8 07 04 00 00           | call zm.13F07A90C                       |<br>000000013F07A505 | 48 83 C4 28              | add rsp,28                              |<br>000000013F07A509 | E9 76 FE FF FF           | jmp zm.13F07A384                        |<br>000000013F07A50E | CC                       | int3                                    |<br>000000013F07A50F | CC                       | int3                                    |<br>000000013F07A510 | CC                       | int3                                    |<br>000000013F07A511 | CC                       | int3                                    |<br>000000013F07A512 | CC                       | int3                                    |<br>000000013F07A513 | CC                       | int3                                    |<br>000000013F07A514 | CC                       | int3                                    |<br>000000013F07A515 | CC                       | int3                                    |<br>000000013F07A516 | 66 66 0F 1F 84 00 00 00  | nop word ptr ds:[rax+rax]               |<br>000000013F07A520 | 48 3B 0D 11 EE 00 00     | cmp rcx,qword ptr ds:[13F089338]        |<br>и далее в scylla видим битые импорты..<br><br><br><br>Попробовал дефолтный win32app из msvc2015 скомпилить в x64 и запаковть upx 3.94 с ключём -5<br>http://ge.tt/3NQrOko2<br>при распаковке upx -d экзешник получается не рабочим.<br>при ручной распаковке, по вот такому методу - также не рабочий...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=382458&amp;user=41697&amp;forum_n=13&amp;topic=25074.html&amp;page=0&amp;anchor=3" class="addthx" data-post="382458"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]hypn0[/b]','')">hypn0</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.9 (посетитель), 94thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.02'>Активность: 0.05<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=21535">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2018 10:48 &middot; Поправил: hypn0 <br><script type="text/javascript">QU('hypn0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hypn0" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=25074.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<img src="img/attach.gif" alt=""> <a href="./files/37ca_27.02.2018_EXELAB.rU.tgz">37ca_27.02.2018_EXELAB.rU.tgz</a> - zm_unp.7z<br><br><b>Добавлено спустя 2 минуты</b><br>С методикой не помогу. Прога автоматом распаковала. Вроде запускается. Что за прога - не скажу. Автор тут обитает, но когда зарелизит - не знаю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=382459&amp;user=21535&amp;forum_n=13&amp;topic=25074.html&amp;page=0&amp;anchor=4" class="addthx" data-post="382459"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ap0stol[/b]','')">ap0stol</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.62'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41697">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2018 10:54 &middot; Поправил: ap0stol <br><script type="text/javascript">QU('ap0stol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ap0stol" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=25074.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>hypn0</b><br><br>эх, жаль, эту версию у меня получается распаковать через upx+pe tools+Reloc Rebuilder, а размер екзешника получается ~800kb<br><br>а вот эту, более свежую та прога сможет?<br>http://ge.tt/4X1yHko2<br>или может автора назовёшь, чтобы черкануть ему?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=382460&amp;user=41697&amp;forum_n=13&amp;topic=25074.html&amp;page=0&amp;anchor=5" class="addthx" data-post="382460"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]hypn0[/b]','')">hypn0</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.9 (посетитель), 94thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.02'>Активность: 0.05<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=21535">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2018 11:06 <br><script type="text/javascript">QU('hypn0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hypn0" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=25074.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
http://www52.zippyshare.com/v/IiECjt6D/file.html<br>Вот и свежая распакованная.<br>Распаковщик очень универсальный. Он эмулятор, что угодно распакует. В теории. <img src="img/smilies/s5.gif" alt=""><br><br>Ник автора hors. Он автор Detect It Easy (DIE). Напиши, спроси.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=382461&amp;user=21535&amp;forum_n=13&amp;topic=25074.html&amp;page=0&amp;anchor=6" class="addthx" data-post="382461"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=41697" title="27-02-2018 14:09, ранг:1.5" target="_blank">ap0stol</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ap0stol[/b]','')">ap0stol</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.62'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41697">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2018 12:33 &middot; Поправил: ap0stol <br><script type="text/javascript">QU('ap0stol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ap0stol" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=25074.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Мне кажется, что в для свежих upx-ов или свежих msvc такой типовой алгоритм не работает. Также попробовал win32app собрать в msvc2015 но для x86 и также не смог найти корректный oep/va. Аналогичная проблема с битыми импортами. Может кто-то направит на путь истинный..<br><br><b>Добавлено спустя 2 часа 57 минут</b><br>#include &lt;stdio.h&gt;<br><br>int main()<br>{<br>	printf(&quot;Hello, World\n&quot;);<br>	return 0;<br>}<br><br>спомпилен в msvc2015 x86, запакован upx 3.91 с ключём -5<br>получаю также битый импорт и нерабочий exe.<br>не понимаю что делаю не так<br><br><img src="img/attach.gif" alt=""> <a href="./files/0f30_27.02.2018_EXELAB.rU.tgz">0f30_27.02.2018_EXELAB.rU.tgz</a> - ConsoleApplication5.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=382463&amp;user=41697&amp;forum_n=13&amp;topic=25074.html&amp;page=0&amp;anchor=7" class="addthx" data-post="382463"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2018 16:09 &middot; Поправил: Gideon Vi <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=25074.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
может баг. Посмотри <noindex><a href="https://github.com/upx/upx/releases" rel="nofollow" target="_blank">3.94</a></noindex><br>Во всяком случает с импортом после анпака все нормально.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=382467&amp;user=2585&amp;forum_n=13&amp;topic=25074.html&amp;page=0&amp;anchor=8" class="addthx" data-post="382467"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]ap0stol[/b]','')">ap0stol</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.62'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41697">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2018 16:36 &middot; Поправил: ap0stol <br><script type="text/javascript">QU('ap0stol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ap0stol" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=25074.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>Gideon Vi</b><br>чуть раньше про 3.94 писал что также<br><i class=x>Попробовал дефолтный win32app из msvc2015 скомпилить в x64 и запаковть upx 3.94 с ключём -5<br>http://ge.tt/3NQrOko2<br>при распаковке upx -d экзешник получается не рабочим.<br>при ручной распаковке, по вот такому методу - также не рабочий... </i><br><br>ну и сабж из первого поста, как же всё-таки корректно распаковать то? Дабы знать, уметь это делать<br><br><b>Добавлено спустя 51 минуту</b><br><b>msvc 2015, upx 3.94</b><br>msbuild C:\Users\ap0stol\Downloads\0f30_27.02.2018_EXELAB.rU\ConsoleApplication5.vcxproj /p:configuration=release /p:platform=win32<br>compiled.exe (переименованный ConsoleApplication5.exe) - рабочий<br>upx -5 compiled.exe -o packed.exe<br>packed.exe - рабочий<br>upx -d packed.exe -o unpacked.exe<br>unpacked.exe - не рабочий<br><br>и также, если через x32dbg попытать распаковать, то в scylla ошибки в импортах...<br><br><img src="img/attach.gif" alt=""> <a href="./files/7bc9_27.02.2018_EXELAB.rU.tgz">7bc9_27.02.2018_EXELAB.rU.tgz</a> - souce_with_exe.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=382468&amp;user=41697&amp;forum_n=13&amp;topic=25074.html&amp;page=0&amp;anchor=9" class="addthx" data-post="382468"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2018 19:52 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=25074.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>ap0stol</b><br><br>Обьясняю популярно. Нет никакого смысла собирать кучу тулз и пытаться ими как то решить софт(иначе человек искал бы решение не перебором софта, а учил матчасть). Вам это может быть нужно для повышения личного скилла(опыта/знаний), но тогда это всё уг не нужно, либо вам это нужно для заработка &#036;, но вы эти задачи не можите решить из за отсутствия того самого скилла. Так что вы впали в рекурсию. А так как вы из неё выйти не можите и одновременно хотите, то есть спец раздел, где за ваши цели(&#036;) решают задачи.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=382473&amp;user=40990&amp;forum_n=13&amp;topic=25074.html&amp;page=0&amp;anchor=10" class="addthx" data-post="382473"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 февраля 2018 02:28 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=25074.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>ap0stol пишет:<br>ну и сабж из первого поста, как же всё-таки корректно распаковать то? </I><br><br>чувак, у тебя конкретные чудеса происходят, в виде гробящего семпл оригинального upx. Я бы начал с проверки компьютера, а уже потом занимался распаковкой.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=382474&amp;user=2585&amp;forum_n=13&amp;topic=25074.html&amp;page=0&amp;anchor=11" class="addthx" data-post="382474"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ap0stol[/b]','')">ap0stol</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.62'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41697">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 февраля 2018 06:05 &middot; Поправил: ap0stol <br><script type="text/javascript">QU('ap0stol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ap0stol" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=25074.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>Gideon Vi</b><br>2 разных компа, на одном win7 x64 + msvc2015, на другом win10 x64 + Visual C++ Build Tools.<br>Ну и zm.exe из первого поста не я компилировал.<br>И на гитхабе в тикетах кто-то другой отписывался что upx -d не работает, думаю и при распаковке вручную также байда с импортами: <noindex><a href="https://github.com/upx/upx/issues/75" rel="nofollow" target="_blank">https://github.com/upx/upx/issues/75</a></noindex><br><br>P.s. Если просто экзешник собранный по моему проекту загрузить в x96dbg, то в scylla я тоже вижу битый импорт, с той лишь разницей, что если удалить битый fthunk то сдампленный exe запустится, а вот после upx уже нет.<br><br><b>Добавлено спустя 20 минут</b><br>частично выяснил, что если exe-шник собран с флагом /DYNAMICBASE то распаковать UPX не получается, если без него (ASRL) - то распаковывается без проблем.<br><br><b>Добавлено спустя 32 минуты</b><br>всем спасибо за участие, разобрался, как распаковывать.<br>с оригинального exe скидываю флаг DynamicBase, гружу в x64dbg, далее OEP, scylla, прибиваю один битый импорт, dump, fix dump <img src="img/smilies/s8.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=382476&amp;user=41697&amp;forum_n=13&amp;topic=25074.html&amp;page=0&amp;anchor=12" class="addthx" data-post="382476"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]TryAga1n[/b]','')">TryAga1n</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 262.5 (наставник), 337thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.45'>Активность: 0.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=31275">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 февраля 2018 08:51 &middot; Поправил: TryAga1n <br><script type="text/javascript">QU('TryAga1n','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TryAga1n" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=25074.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>ap0stol пишет:<br>с оригинального exe скидываю флаг DynamicBase, гружу в x64dbg, далее OEP, scylla, прибиваю один битый импорт, dump, fix dump  </I><br>Ну это как бы первое что нужно сделать, при распаковке или реверсе тела с ASLR. Неужели ты сразу не заметил, что у тебя постоянно менялись адреса в отладчике? о_О
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=382478&amp;user=31275&amp;forum_n=13&amp;topic=25074.html&amp;page=0&amp;anchor=13" class="addthx" data-post="382478"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 февраля 2018 09:29 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=25074.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Ну дошел и ладно, молодец. Хотя, надо бы иметь отдельную ось под реверс, с котлюченными aslr и прочим.<br>В upx действительно баг. Причем, на DYNAMICBASE ему должно бы быть пофиг, распаковка-то static.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=382479&amp;user=2585&amp;forum_n=13&amp;topic=25074.html&amp;page=0&amp;anchor=14" class="addthx" data-post="382479"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ap0stol[/b]','')">ap0stol</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.62'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41697">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 февраля 2018 10:21 &middot; Поправил: ap0stol <br><script type="text/javascript">QU('ap0stol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ap0stol" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=25074.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>TryAga1n</b><br>Ну вот я и спрашивал помощи, что я упустил из виду. И да, я вроде не замечал что oep основной программы менялся. Да и опыта в этом деле почти нет<br><br><b>Gideon Vi</b><br>Теперь уже понимаю что нужно именно так делать. Ну и не мог изначально подумать на баг в upx-е разных версий
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=382481&amp;user=41697&amp;forum_n=13&amp;topic=25074.html&amp;page=0&amp;anchor=15" class="addthx" data-post="382481"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Прошу помощи с &quot;изменённым&quot; UPX</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=25074" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
