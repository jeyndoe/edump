<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Передать код через переменную окружения - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Приведенная ниже программа при запуске без аргументов работает и исполняет свой шеллкод. Однако при передаче тот же код через переменную окружения отказывается работать. В отладчике GDB видно, что EIP настраивается правильно, но">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=242'>Alf</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Передать код через переменную окружения</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2015 18:25 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Приведенная ниже программа при запуске без аргументов работает <br>и исполняет свой шеллкод. Однако при передаче тот же код через<br>переменную окружения отказывается работать. В отладчике GDB<br>видно, что EIP настраивается правильно, но принятый код не тот.<br>Вот начало массива shellcode: 0x33785c22 0x63785c32 0x33785c30...<br>----------------------<br>Подскажите, пожалуйста, как нейтрализовать эту напасть?!<br>----------------------<br>В программе 1-й аргумент - для настройки (равен 4), через 2-й<br>аргумент передаётся имя переменной окружения.<br>----------------------<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#include&nbsp;<span class="hl_char">&lt;</span>stdio<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l1">#include&nbsp;<span class="hl_char">&lt;</span>stdlib<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l0">#include&nbsp;<span class="hl_char">&lt;</span>string<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l1"><span class="hl_function"><b>char</b></span>&nbsp;shellcode<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;</li><li class="hl_l0"><span class="hl_quote">&quot;\x31\xc0\x31\xdb\x31\xc9\x99\xb0\xa4\xcd\x80\x6a\x0b\x58\x51\x68&quot;</span></li><li class="hl_l1"><span class="hl_quote">&quot;\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x51\x89\xe2\x53\x89&quot;</span></li><li class="hl_l0"><span class="hl_quote">&quot;\xe1\xcd\x80&quot;</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>int</b></span>&nbsp;main<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;argc<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span>argv<span class="hl_char">[</span><span class="hl_char">]</span><span class="hl_char">)</span>{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_function">ret</span><span class="hl_char">,</span>&nbsp;n<span class="hl_char">=</span><span class="hl_number">4</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_function"><b>ptr</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>argc&nbsp;<span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;&nbsp;n&nbsp;<span class="hl_char">=</span>&nbsp;atoi<span class="hl_char">(</span>argv<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>argc&nbsp;<span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">)</span>{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bzero<span class="hl_char">(</span>shellcode<span class="hl_char">,</span>&nbsp;<span class="hl_number">200</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy<span class="hl_char">(</span>shellcode<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">)</span>getenv<span class="hl_char">(</span>argv<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">int</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">&amp;</span><span class="hl_function"><b>ret</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;n<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">int</span><span class="hl_char">)</span>shellcode<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=359468&amp;user=29754&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=1" class="addthx" data-post="359468"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2015 18:43 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
BAD:
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function">if</span><span class="hl_char">(</span>argc&nbsp;<span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">)</span>{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bzero<span class="hl_char">(</span>shellcode<span class="hl_char">,</span>&nbsp;<span class="hl_number">200</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy<span class="hl_char">(</span>shellcode<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">)</span>getenv<span class="hl_char">(</span>argv<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div>
GOOD:
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function">if</span><span class="hl_char">(</span>argc&nbsp;<span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy<span class="hl_char">(</span>shellcode<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">)</span>getenv<span class="hl_char">(</span>argv<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br><br><b>-- Добавлено --</b><br><br>Или так (лучше):<br><br>BAD:
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>char</b></span>&nbsp;shellcode<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;</li>        </ol>
    </div>
</div></div>
GOOD
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>char</b></span>&nbsp;shellcode<span class="hl_char">[</span><span class="hl_number">200</span><span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;</li>        </ol>
    </div>
</div></div>
<br>А нщё лучше - вообще оба варианта.<br><br>Хорошие программы от не очень хороших отличаются тем, что там учтены всех этих мелочей ..<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359470&amp;user=35473&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=2" class="addthx" data-post="359470"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=13190" title="22-10-2015 15:50, ранг:97.6" target="_blank">Rainbow</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2015 19:34 &middot; Поправил: ksol <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>dosprog</I> К сожалению, предложение  <i class=x>char shellcode[200+1] =</i> не соотносится<br>с инициализацией!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359473&amp;user=29754&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=3" class="addthx" data-post="359473"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2015 19:52 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>ksol пишет:<br>К сожалению, предложение char shellcode[200+1] = не соотносится<br>с инициализацией!<br> </I><br>Не знаю, о чём вообще речь.<br>Вот готовый рабочий пример: <img src="img/attach.gif" alt=""> <a href="./files/a079_22.10.2015_EXELAB.rU.tgz">a079_22.10.2015_EXELAB.rU.tgz</a> - SHELLCOD.ZIP<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359474&amp;user=35473&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=4" class="addthx" data-post="359474"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2015 12:49 &middot; Поправил: cppasm <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Да там не с инициализацией проблемы.<br>Очевидный же косяк.<br>Тебе строчку получаемую от getenv() конвертировать надо самому.<br>Т.е. если ты в коде пишешь <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>char</b></span>&nbsp;shellcode<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;\x33&quot;</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>то получишь строку из одного символа с кодом 0x33 - т.е. это эквивалентно<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>char</b></span>&nbsp;shellcode<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;3&quot;</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>Короче говоря компилятор обрабатывает esc-последовательности в твоей строке.<br>А если ты то же самое получишь через getenv() то в строке будет то что ты написал - т.е. в данном случае 4 символа &quot;\x33&quot; что эквивалентно записи в коде<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>char</b></span>&nbsp;shellcode<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;\\x33&quot;</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>Разница между <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>char</b></span>&nbsp;shellcode<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;\x33&quot;</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>и<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>char</b></span>&nbsp;shellcode<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;\\x33&quot;</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>надеюсь понятна и почему не работает думаю тоже.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359495&amp;user=6859&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=5" class="addthx" data-post="359495"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2015 15:18 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>cppasm</I> - Спасибо за теорию! А вы не сможете сказать, что практически<br> надо сделать с полученной через getenv() строкой?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359496&amp;user=29754&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=6" class="addthx" data-post="359496"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2015 15:24 <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>ksol пишет:<br>что практически<br>надо сделать с полученной через getenv() строкой?  </I><br>да ничего с ней не нужно делать, главное поместить ее в окружение правильно нужно
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=359497&amp;user=15500&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=7" class="addthx" data-post="359497"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2015 17:48 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>BoRoV</I> - а это как?<br>-----------------------------------<br>Если блок if(argc &gt; 2) заменить на<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">setenv<span class="hl_char">(</span><span class="hl_quote">&quot;CODE1&quot;</span><span class="hl_char">,</span>shellcode<span class="hl_char">,</span><span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">bzero<span class="hl_char">(</span>shellcode<span class="hl_char">,</span><span class="hl_number">200</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">strcpy<span class="hl_char">(</span>shellcode<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">)</span>getenv<span class="hl_char">(</span><span class="hl_quote">&quot;CODE1&quot;</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>то всё работает! Т.е. определение переменной окружения в самой<br>программе проходит. А из другой программы или оболочки bash - не идёт!<br>------------------------------------<br><I>dosprog</I> Вашу программу запустил - да, работает в Windows, без проверки<br>передачи кода. Если у вас есть Linux, проверьте может у вас пройдёт транспортировка<br>кода без искажений?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359498&amp;user=29754&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=8" class="addthx" data-post="359498"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2015 17:52 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>ksol пишет:<br>проверьте </I><br><br>Вот же написали уже:<br><br><br><I>cppasm пишет:<br>Разница между<br>    char shellcode[] = &quot;\x33&quot;;<br>и<br>    char shellcode[] = &quot;&#92;\x33&quot;;<br>надеюсь понятна и почему не работает думаю тоже. </I><br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359499&amp;user=35473&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=9" class="addthx" data-post="359499"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2015 18:09 <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>ksol пишет:<br> А из другой программы или оболочки bash </I><br>с другой программы и не будет проходить, она устанавливает ее в свое окружение а не общее. а с баша нормально все устанавливается<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">export&nbsp;<span class="hl_function">CODE</span><span class="hl_char">=</span>`echo&nbsp;<span class="hl_char">-</span>ne&nbsp;<span class="hl_quote"><span style="word-break: break-all">&quot;\x31\xc0\x31\xdb\x31\xc9\x99\xb0\xa4\xcd\x80\x6a\x0b\x58\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x51\x89\xe2\x53\x89\xe1\xcd\x80&quot;</span></span>`</li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=359500&amp;user=15500&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=10" class="addthx" data-post="359500"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29754" title="24-10-2015 11:54, ранг:49.7" target="_blank">ksol</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2015 18:12 &middot; Поправил: ksol <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>dosprog</I><br>Да это я давно в gdb вижу как каждый символ 16-ричного кода заменяется<br>на их значения из таблицы ascii. И что с этим сделаешь?<br><I>BoRoV</I> - что-то интересное вы предложили!Спасибо! Проверю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359501&amp;user=29754&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=11" class="addthx" data-post="359501"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2015 18:24 <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>ksol пишет:<br>И что с этим сделаешь? </I><br>С чем? Тебе уже всё тут разжевали.
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=359502&amp;user=15500&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=12" class="addthx" data-post="359502"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2015 18:30 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>BoRoV</I> Да я за вами не успеваю! Пока я набираю ответ - вы уже другой отправили.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359503&amp;user=29754&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=13" class="addthx" data-post="359503"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2015 14:53 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Программа работает, успешно глотает предложенный код,<br>если переменную окружения задать в виде контекстной подстановки<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">export&nbsp;<span class="hl_function">CODE</span><span class="hl_char">=</span><span class="hl_char">$</span><span class="hl_char">(</span>printf&nbsp;`cat&nbsp;cod1<span class="hl_char">.</span>s`<span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br>где файл cod1.s содержит передаваемый код.<br>Всех благодарю за активное участие, а особенно <I>BoRoV</I>.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359516&amp;user=29754&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=14" class="addthx" data-post="359516"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 октября 2015 17:51 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
---- Родственный вопрос ---<br>В Сети есть статьи, в которых адрес переменной окружения с шеллкодом<br>в ней, пересылается для переполнения буфера в стеке. Адрес вычисляется<br>либо на использовании числа 0xbfffffff в качестве &quot;верхушки&quot; стека, либо<br>функции getenv(), с некоторыми поправками на число символов имени программы. <br>Считается, что вычисленный адрес остается тем же и для программы с буфером.<br>Но у меня ни 1-й, ни 2-й варианты вычисления адреса не идут. Адреса имеют<br>вид 0xbf&#039;d69&#039;f24 , 0xbf&#039;927&#039;f24 и не сохраняются в другой программе, а меняются<br>от запуска к запуску одной и той же программы. А адрес 0xbfffffff вообще не доступен.<br>Возможна ли передача реального адреса переменной окружения в программу?!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359683&amp;user=29754&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=15" class="addthx" data-post="359683"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 октября 2015 20:16 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Адрес там для примера. Инициалиазация базы указателя стека может быть произведена наполовину рандомно. Не надо даже в Windows XP полагать, что если стартовый тред всегда инициируется базой 0x00130000, то так всегда будет. Это не так! Всё зависит от базы(Image Base) exe-модуля, от баз подгруженных статически dll-модулей, от размеров модулей и от размеров куч...<br><br>То же самое и для области переменных окружения. +:<br>1) Регион может иметь атрибут shared, тогда адреса всегда одни и те же, а может не иметь - тогда адреса у каждой программы могут быть свои. Тут зависит от версии ОС.<br>2) От версии ОС также зависит &quot;обычный&quot; адрес базы переменных окружения и методы доступа к ним.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=359689&amp;user=24257&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=16" class="addthx" data-post="359689"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 октября 2015 11:16 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>ksol пишет:<br>Возможна ли передача реального адреса переменной окружения в программу?!  </I><br><br>Адреса переменной <b>чьего</b> окружения? Чужое окружение недоступно - изоляция процессов.<br><br>Вообще, зачем эти извраты? Всё это спокойно реализуется через файловый ввод/вывод.<br>Единстственно, приходят на ум всякие регистрационные подлости, с передачей раскриптованных адресов в программу. Не надо этого делать, право же.<br>Подумайте лучше над фичами самой программы, чтоб она была классная.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359700&amp;user=35473&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=17" class="addthx" data-post="359700"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 октября 2015 12:54 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23806.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Переменная окружения создается в оболочке bash, запускается программа, которую я привел <br>в самом начале. Она по полученному имени через getenv() определяет адрес и запускает шеллкод<br>из переменной окружения. Но эта программа подходит только для тестирования шеллкода.<br>Если бы заставить через настройки оболочку bash не обновлять адреса, то<br>адрес можно определить самому и кинуть в программу с буфером в стеке.<br>Настроечный файл .bash_profile имеет раздел User specific environment . Может туда можно<br>что-то записать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359702&amp;user=29754&amp;forum_n=5&amp;topic=23806.html&amp;page=0&amp;anchor=18" class="addthx" data-post="359702"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Передать код через переменную окружения</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23806" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
