<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>По взлому SpellForce перезагружается комп. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Пытаюсь отвязать игру от cd, после вызова функции DeviceIoControl этот запрос направляются драйверу, которая игра установила. После выполнения этой функции, следующая команда в отладчике вызывает перезагрузку компа. По аргументам">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=19256'>johnniewalker</a>, <a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> По взлому SpellForce перезагружается комп.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=2&amp;topic=18271&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=2&amp;topic=18271&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]neutronion[/b]','')">neutronion</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.5 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24909">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2011 18:04 &middot; Поправил: neutronion <br><script type="text/javascript">QU('neutronion','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neutronion" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Пытаюсь отвязать игру от cd, после вызова функции DeviceIoControl<br>этот запрос направляются драйверу, которая игра установила. После выполнения<br>этой функции, следующая команда в отладчике вызывает перезагрузку компа.<br>По аргументам функции видно, что передаетя код операции и адрес одной из секций программы. <br>В самом драйвере проводятся манипуляции с переданным адресом, вызываются такие функции как<br>MmProbeAndLockPages, MmMapLockedPagesSpecifyCache.<br>Вопрос такой по какой причине может перезагружаться комп. Дамп указывает ошибку в неком модуле<br>crthook.sys.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284564&amp;user=24909&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=1" class="addthx" data-post="284564"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2011 18:09 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Грузи дамп в виндбг да разбирайся. Возможностей перезагрузить комп из ринг0 с синим экраном овер 9000.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284566&amp;user=1556&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=2" class="addthx" data-post="284566"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]neutronion[/b]','')">neutronion</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.5 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24909">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2011 18:16 <br><script type="text/javascript">QU('neutronion','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neutronion" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
В дампах слабоват я, вот он, посмотрите, добрые люди.<br><br><img src="img/attach.gif" alt=""> <a href="./files/eb41_25.05.2011_EXELAB.rU.tgz">eb41_25.05.2011_EXELAB.rU.tgz</a> - Mini052411-05.dmp
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284567&amp;user=24909&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=3" class="addthx" data-post="284567"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2011 20:24 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Похоже на старый стар 3 или 4 версии. Если это так то забудь про взлом
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284570&amp;user=4618&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=4" class="addthx" data-post="284570"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]inffo[/b]','')">inffo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/26678.jpg" alt=""><br><span class=txtSm>Ранг: 57.7 (постоянный), 49thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26678">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2011 20:39 &middot; Поправил: inffo <br><script type="text/javascript">QU('inffo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=inffo" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>neutronion</b> во-первых, проблема не в &quot;crthook.sys&quot;, а в cpthook.sys.<br>А во-вторых, у тебя видимо установлена DriverStudio (SoftIce) попробуй либо обновить ее, либо удалить если не нужна <img src="img/smilies/s3.gif" alt=""><br><br>ADD: Ты случайно не под виртуальной машиной сидел (VirtualBox)? А то в логах дампа встречалась билиотека с VBoxDrv.sys.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284573&amp;user=26678&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=5" class="addthx" data-post="284573"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]neutronion[/b]','')">neutronion</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.5 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24909">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2011 20:52 <br><script type="text/javascript">QU('neutronion','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neutronion" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Под виртуалкой запускается, но выполняется другой код, который говорит, что под отладчиком запускаться не будет, хотя в вируалке нет установленного softice. Хак делаю на основной машине. Дошел успешно до<br>расжатия protect.dll, в ней в принципе найдена функция, которая проверяет сд, однако до ее вызова выше, совсем не далеко, есть вызов DeviceIOControl, после которого ручной трейс отправляет машину спать.<br>Драйвера юзаются 3 штуки: sfdrv01, sfhlp02, sfsync02.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284576&amp;user=24909&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=6" class="addthx" data-post="284576"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]neutronion[/b]','')">neutronion</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.5 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24909">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2011 20:54 <br><script type="text/javascript">QU('neutronion','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neutronion" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>Nightshade пишет:<br>Похоже на старый стар 3 или 4 версии. Если это так то забудь про взлом  </I><br>Почему?  Никто не взламывал разве?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284577&amp;user=24909&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=7" class="addthx" data-post="284577"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]inffo[/b]','')">inffo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/26678.jpg" alt=""><br><span class=txtSm>Ранг: 57.7 (постоянный), 49thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26678">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2011 21:17 <br><script type="text/javascript">QU('inffo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=inffo" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>neutronion</b> попробуй переименовать вышеуказанный мной файл и проверь будет ли &quot;машина спать&quot; после вызова DeviceIOControl и ручного трейса.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284578&amp;user=26678&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=8" class="addthx" data-post="284578"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]neutronion[/b]','')">neutronion</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.5 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24909">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2011 21:37 &middot; Поправил: neutronion <br><script type="text/javascript">QU('neutronion','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neutronion" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Какой файл, извините я плоховато соображаю?<br>cpthook.sys?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284579&amp;user=24909&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=9" class="addthx" data-post="284579"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]inffo[/b]','')">inffo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/26678.jpg" alt=""><br><span class=txtSm>Ранг: 57.7 (постоянный), 49thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26678">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2011 21:49 &middot; Поправил: inffo <br><script type="text/javascript">QU('inffo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=inffo" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>neutronion пишет:<br>Какой файл, извините я плоховато соображаю?cpthook.sys? </I><br><br>Да. Из твоего дампа видно, что ошибка произошла при чтении памяти. И драйвер причины указан cpthook.sys. Найди его в своей системе (в папке с установленной Windows) и переименуй. <br>После попробуй <I>проверь будет ли &quot;машина спать&quot; после вызова DeviceIOControl и ручного трейса </I>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284580&amp;user=26678&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=10" class="addthx" data-post="284580"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2011 22:23 &middot; Поправил: Nightshade <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Судя по этим названиям<br>sfdrv01, sfhlp02, sfsync02 это 100% стар. Там виртуальная машина исполняется в ядре.<br>Без хуков int1 и int3 отладчик грузить нельзя, иначе сразу хапнешь бсод.<br>Если напишешь хукер - можно будет смотреть дальше. А пока кури маны релоадед.<br>инт1 не помню точно зачем используют, но вызовов должно быть мало(установка хуков чтоли...)<br>инт3 используют для вызовов вм в ring0.<br>Суть в том что твой дров должен проверять исключение отладчика произошло или нет. Если не отладчика - отдаем исключение защите.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284584&amp;user=4618&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=11" class="addthx" data-post="284584"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Av0id[/b]','')">Av0id</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 516.1 (<b>!</b>), 39thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1378">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2011 10:24 <br><script type="text/javascript">QU('Av0id','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Av0id" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
trivium релизил кряк на сабж
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284604&amp;user=1378&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=12" class="addthx" data-post="284604"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2011 10:53 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>Nightshade пишет:</b><br><i class=x>Суть в том что твой дров должен проверять исключение отладчика произошло или нет. Если не отладчика - отдаем исключение защите.</i><br><br>Или же можно перевесить отладочные иксепшены на другие векторы. Но это - в теории.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=284607&amp;user=6336&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=13" class="addthx" data-post="284607"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2011 13:28 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>Av0id пишет:<br>trivium релизил кряк на сабж </I><br>Это они
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284616&amp;user=4618&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=14" class="addthx" data-post="284616"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=28614" title="26-05-2011 09:44, ранг:15.6" target="_blank">Usulgurt</a>, <a href="action=userinfo&user=28862" title="26-05-2011 15:33, ранг:0.0" target="_blank">Kylak</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]neutronion[/b]','')">neutronion</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.5 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24909">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2011 19:24 <br><script type="text/javascript">QU('neutronion','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neutronion" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
я с Урала, чуваки, на божий крякерский свет только вылез, объясните плиз, где найти этот чудной trivium? Рок группу только нашел.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284638&amp;user=24909&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=15" class="addthx" data-post="284638"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]neutronion[/b]','')">neutronion</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.5 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24909">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2011 19:27 <br><script type="text/javascript">QU('neutronion','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neutronion" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Я так понимаю комп перезагружается возможно из-за того, что Оля при ручной пошаговой трассировке генерирует исключение отладки, который дров перехватывает и отправляет компик спать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284640&amp;user=24909&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=16" class="addthx" data-post="284640"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2011 19:30 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Тебе уже тонко намекнули, начни с чего попроще. И тривиум ты не найдёшь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284641&amp;user=1556&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=17" class="addthx" data-post="284641"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]neutronion[/b]','')">neutronion</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.5 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24909">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2011 19:38 <br><script type="text/javascript">QU('neutronion','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neutronion" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
С чего попроще я уже начал, просто увидел, что кто-то эту проблему уже решил, вот и хотел узнать у добрых людей как это сделано. Мне бы только сделать так, чтобы комп не перезагружался, остальное я сам.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284642&amp;user=24909&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=18" class="addthx" data-post="284642"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Usulgurt[/b]','')">Usulgurt</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.28'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=28614">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2011 19:47 <br><script type="text/javascript">QU('Usulgurt','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Usulgurt" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>neutronion пишет:<br>Я так понимаю комп перезагружается возможно из-за того, что Оля при ручной пошаговой трассировке  </I><br><br>Если ты при этом юзаешь защиту АЛЯ  phantom.plugin, то как раз он может приводить к перезагрузке. Проверено.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284643&amp;user=28614&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=19" class="addthx" data-post="284643"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]neutronion[/b]','')">neutronion</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.5 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24909">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2011 19:51 <br><script type="text/javascript">QU('neutronion','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neutronion" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
И что? Попробовать убрать все плагины? Фантом я только сегодня скачал и поставил, перезагружается комп так же.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284644&amp;user=24909&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=20" class="addthx" data-post="284644"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]neutronion[/b]','')">neutronion</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.5 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24909">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2011 19:53 <br><script type="text/javascript">QU('neutronion','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neutronion" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Вообще-то одному наверное сложные защиты трудно взламывать, существуют ли группы кракеров? И можно ли туда записаться?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284645&amp;user=24909&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=21" class="addthx" data-post="284645"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2011 20:11 <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>neutronion пишет:<br>существуют ли группы кракеров? И можно ли туда записаться?  </I><br>Существуют. Можно.
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=284646&amp;user=15500&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=22" class="addthx" data-post="284646"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Usulgurt[/b]','')">Usulgurt</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.28'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=28614">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2011 21:24 <br><script type="text/javascript">QU('Usulgurt','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Usulgurt" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Попробуй с ограниченными правами, чтоли запускать....
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284650&amp;user=28614&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=23" class="addthx" data-post="284650"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2011 22:22 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
Ты правильно понял. Драйвер защиты воспринимает исключения отладки как команды сделать определенные действия.<br> Например обычный бряк он воспримет как вызов вм. Потом посмотрит где бряк, не найдет код который должен выполнить и мы получим бсод. Поэтому надо писать свой драйвер или не пользоваться бряками и трассировкой
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284652&amp;user=4618&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=24" class="addthx" data-post="284652"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]int_256[/b]','')">int_256</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.8 (новичок), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.69'>Активность: 0.01<span style='color:green'>&nearr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=18773">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2011 22:57 <br><script type="text/javascript">QU('int_256','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int_256" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
ну и кстати будет то, что сф 3 точно патчил  кусок кода в KiDispatchInterrupt, где проводится переключения контекста записью в cr3, и при каждом переключении на защищенный процесс, сф3 вписывает в идт свои хендлеры на инт1/инт3. Была идея перехватывать запись хуков в идт и исключений по инт1/инт3 путем перемещения части 1-й части идт в страницу с NO_ACCESS аттрибутами, чтоб по GP_FAULT отлавливать вызовы в вм, но тут риск при следущем исключении  словить triple-fault, после чего идет ребут <img src="img/smilies/s1.gif" alt=""><br>На DeviceIoControl забей. Там протект.длл напрямую из юзермода командует IDE-портом, естественно перед этим подправив маску доступа на прямое обращение  к портам.<br><br>Если используется стар бейсик без выполнения частей кода в вм, то 3 сф снимает чуть потяжелее упх без извращений с написанием собственной дровины и дебага р0
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284655&amp;user=18773&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=25" class="addthx" data-post="284655"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]neutronion[/b]','')">neutronion</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.5 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24909">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2011 23:59 <br><script type="text/javascript">QU('neutronion','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neutronion" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
Чтобы написать свой драйвер, нужно очень хорошо изучить, что делает старовский дров.<br>Это что же, полностью реверсить нужно весь дров? Боюсь, у меня уровень не дотягивает до этого.<br>Лет 10 буду этим заниматься. Хотя ида конечно позволяет получить си код, с помощью своего плагина.<br>Про хэндлеры в инт1\3 это интересная мысля, то есть, если я подставлю свои обработчики вместо старовских,<br>то стар будет отдыхать и соответственно более не утомлять перезагрузкой? Или может сначала найти эти обработчики и проанализировать их, почему они отправляют комп в лимбо?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284658&amp;user=24909&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=26" class="addthx" data-post="284658"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]neutronion[/b]','')">neutronion</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.5 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24909">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2011 00:15 <br><script type="text/javascript">QU('neutronion','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neutronion" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
попробую в СофтАйсе установить останов на обработчики int1\3
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284659&amp;user=24909&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=27" class="addthx" data-post="284659"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2011 09:58 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
Ты можешь попробовать зациклиться в апи которая близко к еп и снять дамп. Воткни на какой-нибудь апи ebfe и сними дамп. А там видно будет есть вм или нет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284672&amp;user=4618&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=28" class="addthx" data-post="284672"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2011 10:24 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<b>neutronion пишет:</b><br><i class=x>попробую в СофтАйсе установить останов на обработчики int1\3</i><br><br>Вы не поняли суть проблемы. Давайте по-простому. При переключении контекста из EPROCESS берётся значение каталога страниц и записывается в cr3. Там ещё немного добавляется кода при наличии LDT, т.е. если она есть, то дескрипторы меняются, но это по сути и всё, контекст переключён. Далее дравйвер патчит обработчики из IDT, заменяя их на свои. Если вы в айсе или каком-то другом дебаггере поставите бряк на код, то перед тем, как айс обработает отладочный иксепш, его вначале получит и обработает старфорс. Если вы снимете хуки и с помощью своего драйвера добьётесь того, чтоб старфорс их не ставил, то и это не решит проблему, т.к. по отладочным иксепшенам работает виртуальная машина ядра, которая при снятии хуков работать перестанет, код не распакуется, и процесс (или вся система) рухнет. Первый вариант заключается в написании своего драйвера, который поддерживает пул брейкпоинтов, установленных вами. Проще говоря, вы поставили бряк (опкодом СС), перед его срабатыванием ваш драйвер проверяет, находится ли адрес, по которому сработал бряк, в пуле бряков. Если да, то исключение получает айс, если нет, то значит его поставили не вы, а защита, и исключение получает старфорс. Я когда-то видел на <noindex><a href="http://www.rootkits.su" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex> (кажется) кто-то создал такую тему, и вроде бы, наваял такой дров. Но сам дров он не выкладывал, так что вряд ли вы его найдёте. Да и проблема будет в том, что вам как-то нужно будет перехватывать _KiTrap01/_KiTrap03 до старфорса. <br><br>Мне кажется, что стоит использовать альтернативный метод. А именно - поменять местами _KiTrap01/_KiTrap03 с какими-то неиспользуемыми прерываниями. Т.е. ещё до запуска старфорса (или антируткит алгоритмами) определяете истинные адреса обработчиков. Меняете их местами. И можно дебажить любым адаптированным под это дело дебаггером. Даже олькой, если пропатчите её. Патчить нужно вставку бряка, ведь теперь вам нужно лепить не опкод инструкции int 3, а какой-то другой int X, и такая инструкция уже будет двухбайтовой. Значит перед установкой бряка (и после его снятия) надо читать два байта (и восстанавливать 2). Но на рабочей системе так делать не рекомендую, поскольку у вас могут быть софтины, которые не будут адаптированы под это дело, и будут юзать, например, отладочный цикл в его прежней реализации. Плюс это подойдёт для программных бряков, а для трассировки там свои заморочки.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=284674&amp;user=6336&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=29" class="addthx" data-post="284674"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]neutronion[/b]','')">neutronion</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.5 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24909">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2011 13:15 <br><script type="text/javascript">QU('neutronion','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neutronion" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=18271&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
Пошел курить маны.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=284680&amp;user=24909&amp;forum_n=2&amp;topic=18271&amp;page=0&amp;anchor=30" class="addthx" data-post="284680"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=2&amp;topic=18271&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=2&amp;topic=18271&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> По взлому SpellForce перезагружается комп.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="2">
<input type="hidden" name="topic" value="18271">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=18271" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
