<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Распаковка StarForce 4.70 - Пьеса в нескольких действиях - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Информации об исследовании данной защиты в свободном доступе почти нет,кроме мануала про снятие SF 5.50 с игры King&#039;s Bounty. Особого интереса этот мануал не представляет по той причине,что на игру есть нормальные NoDVD.">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=41144'>Adler</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка StarForce 4.70 - Пьеса в нескольких действиях</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=7.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=7.html">8</a> . <b>9</b> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=9.html">10</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=9.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Calypso[/b]','')">Calypso</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.71'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30561">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2011 23:54 <br><script type="text/javascript">QU('Calypso','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Calypso" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#1');return false;">#1</a> </span><div align=left><br>
Информации об исследовании данной защиты в свободном доступе почти нет,кроме мануала про снятие SF 5.50 с игры King&#039;s Bounty. Особого интереса этот мануал не представляет по той причине,что на игру есть нормальные NoDVD.<br>Идея была такая - снять дамп с запущенного через эмулятор процесса ,затем восстанавливать недостающие процедуры из Protect.dll.<br>Версия 4.70 очень поганая, запустить её с эмулятором удается с 10-15 раза.<br>Если в отладчике открывать сам exe-файл ,то после тыкания Shift+F9 выбрасывает в Protect.dll . Никакого EP нет.<br>Вообщем пусть гуру объяснят как тут надо действовать
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=293888&amp;user=30561&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=1" class="addthx" data-post="293888"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2011 16:18 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#2');return false;">#2</a> </span><div align=left><br>
<I>Olenevod пишет:<br>Странно, что мало кто этим пользуется. </I><br>Кто сказал? <img src="img/smilies/s8.gif" alt=""><br><br>P.S. ТС лох, ответственно заявляю. <img src="img/smilies/s12.gif" alt=""> Я не буду объяснять почему, т.к. это могла быть банальная провокация.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294743&amp;user=2449&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=2" class="addthx" data-post="294743"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2011 17:22 <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#3');return false;">#3</a> </span><div align=left><br>
с древних времен существует правило - относись к людям так, как хочешь чтоб относились к тебе.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294753&amp;user=3136&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=3" class="addthx" data-post="294753"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Olenevod[/b]','')">Olenevod</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 48.8 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.1'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5086">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2011 17:42 <br><script type="text/javascript">QU('Olenevod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Olenevod" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#4');return false;">#4</a> </span><div align=left><br>
<I>Calypso пишет:<br>Может у вас плохо со зрением,но в дампе Velieant вся память ВМ прикручена к файлу, и ничего не работает.<br>Так что кто из нас идиот,ещё не известно</I><br><I>Olenevod пишет:<br>К дампу прикручены только те страницы памяти, которые были выделены при распаковке .exe старом, т.е. буфер под переходы в ВМ и спертые апи. Где память, выделенная в процессе инициализации ВМ? </I><br><br>2<b>All</b>, я был несколько груб, говоря о ЛС, прошу прощения. Я читаю форум с другого акка, и, только если считаю нужным ответить, логинюсь этим. Написав мне в ЛС, вы рискуете остаться без ответа только потому, что я этого не узнаю.<br>2<b>OspylaC</b>, мое ЧСВ раздуто до бесконечности. Я поездат.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294756&amp;user=5086&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=4" class="addthx" data-post="294756"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2011 20:10 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#5');return false;">#5</a> </span><div align=left><br>
<b>Olenevod</b> про прокси не забывай. А когда отвечаешь на личку, пости личку, все посмеемся.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=294762&amp;user=3232&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=5" class="addthx" data-post="294762"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2011 23:33 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#6');return false;">#6</a> </span><div align=left><br>
После такой рекламы в 9 страниц даже мне захотелось покопать старфорс. Нет, не именно эту игру - я не могу скачать её - уж слишком огромна. Просто файл под старфорсом. Говорят, что в бейсике нет ВМ. Наверное, имеется ввиду, что вызовы в ВМ отсутствуют в запротекченом приложении. Но сам код protect.dll может быть накрыт ВМ. Иначе скажите мне, может я что-то не понял, это ли не ВМ:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">100D1E20</span>&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">00000000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;PROTECT<span class="hl_char">.</span><span class="hl_number">100D1E25</span></li><li class="hl_l1"><span class="hl_number">100D1E25</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">100D1E26</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">89C1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">100D1E28</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">81C0</span>&nbsp;<span class="hl_number">2F731100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">11732F</span></li><li class="hl_l0"><span class="hl_number">100D1E2E</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">81C1</span>&nbsp;DB21F6FF&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span>FFF621DB</li><li class="hl_l1"><span class="hl_number">100D1E34</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">01D0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EDX</span></li><li class="hl_l0"><span class="hl_number">100D1E36</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">8B00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">100D1E38</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">01C8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">ECX</span></li><li class="hl_l0"><span class="hl_number">100D1E3A</span>&nbsp;&nbsp;&nbsp;FFE0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_registr"><b>EAX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>        </ol>
    </div>
</div></div>
<br><br>Ах да, весь этот код читается из оверлея и грузится в память, выделенную загрузчиком под вот эту секцию:<br><br><noindex><a href="http://s1.ipicture.ru/" rel="nofollow" target="_blank"> <img src="http://s1.ipicture.ru/uploads/20111105/fQ96ovk3.jpg" border="0" align="" alt=""></a></noindex>
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=294766&amp;user=6336&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=6" class="addthx" data-post="294766"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2011 00:29 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#7');return false;">#7</a> </span><div align=left><br>
В выложенном петьке так же все функции protect.dll завиртуализированы собственной ВМ. Поэтому я и мог ее ковырять без диска. Приведенный тобой код - переход между обработчиками команд. Ставь условие для трейса - команду jmp eax и по ctrl+f11 будешь прыгать от команды к команде. (так же советую поставить jmp edx вторым условием, тк по этой команде ВМ из некоторых обработчиков выходит на внешние процедуры)<br><br>Не знаю зависит ли от компа, но попробовал сравнивать свою ВМ до OEP и его дампы на OEP - адреса обработчиков вообще не совпадают. Так что предполагаю либо зависит от машины и ВМ генерится перед проверкой, либо для защищаемого приложения ВМ перестраивается (менее вероятно)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294768&amp;user=3136&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=7" class="addthx" data-post="294768"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2011 02:28 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#8');return false;">#8</a> </span><div align=left><br>
Здоровенная ВМ у этого старфорса. Полтора часа тупого трейса дали возможность подтвердить присутствие <noindex><a href="http://qunpack.ahteam.org/?p=60" rel="nofollow" target="_blank">--&gt; Этого &lt;--</a></noindex> приёма детекта Вари. <br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>sforce3<span class="hl_char">:</span><span class="hl_number">1021FC22</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">60h</span></li><li class="hl_l1"><span class="hl_char">.</span>sforce3<span class="hl_char">:</span><span class="hl_number">1021FC24</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">24h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>sforce3<span class="hl_char">:</span><span class="hl_number">1021FC28</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>sforce3<span class="hl_char">:</span><span class="hl_number">1021FC2A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>sforce3<span class="hl_char">:</span><span class="hl_number">1021FC2D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>sforce3<span class="hl_char">:</span><span class="hl_number">1021FC30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">+</span><span class="hl_number">0Ch</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>sforce3<span class="hl_char">:</span><span class="hl_number">1021FC33</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>dx</b></span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;ОНО<span class="hl_char">,</span>&nbsp;собака</li>        </ol>
    </div>
</div></div>
<br><br>Заменил на cli, приложение упало. При перезагрузке до этого места ВМ не дошла, но файлик запустился. Мистика.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=294774&amp;user=6336&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=8" class="addthx" data-post="294774"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]yagello[/b]','')">yagello</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.1 (постоянный), 30thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.56'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=23568">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2011 12:01 <br><script type="text/javascript">QU('yagello','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=yagello" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#9');return false;">#9</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>При перезагрузке до этого места ВМ не дошла, но файлик запустился. Мистика. </I><br>Возможно, проверки исполняются рандомно? Этот блок в этот раз не вызывался.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294781&amp;user=23568&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=9" class="addthx" data-post="294781"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2011 17:25 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#10');return false;">#10</a> </span><div align=left><br>
Виртуалка детектится каждый раз - не было ещё такого случая, чтоб без дополнительных мероприятий удалось запуститься на Варе. Значит, даже если проверки и выполняются рандомно, то они всё же выполняются каждый раз, но в разных местах. А тут получается, что она не выполнилась, и приложение запустилось. Нет, тут дело в другом.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=294789&amp;user=6336&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=10" class="addthx" data-post="294789"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2011 22:51 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#11');return false;">#11</a> </span><div align=left><br>
ТС в бане, что ли, без него скучно. Он меня веселил, что ж, пока я продолжу. При дальнейшем исследовании ВМ обнаружилось подтверждение факта вызова API функций, не принадлежащих таблице импорта ехе-файла.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">10113B2E</span>&nbsp;&nbsp;&nbsp;FFB7&nbsp;<span class="hl_number">38070000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">+</span><span class="hl_number">738</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">10113B34</span>&nbsp;&nbsp;&nbsp;FF97&nbsp;<span class="hl_number">30070000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">+</span><span class="hl_number">730</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>EnterCriticalSection</li>        </ol>
    </div>
</div></div>
<br><br>EDI = 00EB0000 в тот момент. А это значит, что и такую область (для запуска дампа на той же машине) нужно прикручивать к дампу. Короче, бедный, бедный ТС.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=294802&amp;user=6336&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=11" class="addthx" data-post="294802"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ratsforce[/b]','')">ratsforce</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.4 (гость), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=30630">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2011 23:04 <br><script type="text/javascript">QU('ratsforce','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ratsforce" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#12');return false;">#12</a> </span><div align=left><br>
Вот держите,дамп ВМ выполнен полностью:<br><noindex><a href="http://rghost.ru/28830841" rel="nofollow" target="_blank">http://rghost.ru/28830841</a></noindex><br><br>Валится в модуле Python23.dll:<br>1E0166C6   FF15 D83A0E1E    CALL DWORD PTR DS:[_PyThreadState_GetFra&gt;<br>1E0166CC   83C4 04          ADD ESP,4<br>1E0166CF   C3               RETN<br><br>[DS:1E0E3AD8]=00000000 , в оригинале 1E069890<br>Что-то где-то упустили
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294805&amp;user=30630&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=12" class="addthx" data-post="294805"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ratsforce[/b]','')">ratsforce</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.4 (гость), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.68'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=30630">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2011 13:41 <br><script type="text/javascript">QU('ratsforce','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ratsforce" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#13');return false;">#13</a> </span><div align=left><br>
Ну что,кто-нибудь разобрался как восстановить импорт типа:<br>02040B48 - E9 9C0B307A JMP MSVCR71.malloc  ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295098&amp;user=30630&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=13" class="addthx" data-post="295098"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]neprovad[/b]','')">neprovad</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.4 (посетитель), 15thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.7'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18733">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2011 19:24 &middot; Поправил: neprovad <br><script type="text/javascript">QU('neprovad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neprovad" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#14');return false;">#14</a> </span><div align=left><br>
делаешь свою библиотеку с переходниками типа как во вложении, подсовываешь программе вместо оригинала, импрек рад, реверсер тоже<br><br><img src="img/attach.gif" alt=""> <a href="./files/c048_10.11.2011_EXELAB.rU.tgz">c048_10.11.2011_EXELAB.rU.tgz</a> - user32.dll<br>в принципе можно так самые &quot;нужные&quot; библиотеки запатчить и держать в снапшоте в vmware для распаковки многих пакеров, коверкающих импорт. вот такой ход конем
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295118&amp;user=18733&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=14" class="addthx" data-post="295118"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2011 19:37 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#15');return false;">#15</a> </span><div align=left><br>
<b>neprovad</b><br>Подсуньте так вместо оригинала ntdll. А вот <b>Olenevod</b> советовал дело.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295120&amp;user=6336&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=15" class="addthx" data-post="295120"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]neprovad[/b]','')">neprovad</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.4 (посетитель), 15thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.7'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18733">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2011 19:52 <br><script type="text/javascript">QU('neprovad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neprovad" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#16');return false;">#16</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>это просто еще одна идея, имеющая право на жизнь. на то и форум чтоб кто-то предлагал, кто-то критиковал, в итоге все в выигрыше <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295121&amp;user=18733&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=16" class="addthx" data-post="295121"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=8545" title="11-11-2011 05:46, ранг:25.8" target="_blank">obfuskator</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2011 20:29 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#17');return false;">#17</a> </span><div align=left><br>
Любая API функция представляет собой множество <b>А</b> инструкций. Морфинг берёт множество инструкций <b>М</b>, которое является подмножеством <i class=x>А</i>, и перемещает в выделенную область. Если <b>А = М</b>, т.е. <b>|A| = |M|</b> &amp; F(A) = M - биекция, это полное морфирование. Понятие частичного морфирования очевидно. И первый, и второй вид морфа подразумевают, что при эффективном их применении константный поиск ничего не даст. Поэтому не расстраивайтесь, если поиск по константе не привёл к желаемому результату. Разумеется, здесь уже имеется ввиду не просто морф, а морф с разбавлением мусором и обфускацией.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295125&amp;user=6336&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=17" class="addthx" data-post="295125"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 ноября 2011 06:51 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#18');return false;">#18</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Хм. Раз уж пошли теоретические вопросы...<br><br>Во-первых не понял, к чему ты написал про морфинг? Причем здесь вообще поиск по константе? Смысл в том, что морфинг НЕ БУДЕТ вызывать функцию чтобы ее заморфить. А пока она в таком виде, как дал <b>neprovad</b>, там морфить нечего. Ну т.е. можно конечно повесить какую-нибудь игрушку с долгим расчетом x&lt;&gt;0, y, z, а потом сделать раздвоение графа кода путем проверки [x^3+y^3==z^3] (я таких приколов могу много привести в пример, долго вам придется в деобфускатор мат. логику встраивать), но мы имеем дело не с абстрактной задачей, а с вполне не звездной защитой, которую писали люди, не до конца понимающие принципы построения защитных систем (но нельзя не признать красоту реализации ВМ). Поясню, что хотел сказать: <b>neprovad</b>&#039;овская либа является примером обмана самой защиты. Ее несовершенство не позволяет ей определить, что за функция на самом деле вызывается. Значения имени лежит по смещению, до первого запуска переходника не будет даже явного адреса оригинальной функции. Вопрос об ntdll по-моему вообще не стоит. Где вы видели прямое использование в прикладных программах этой библиотеки? Я имею в виду непосредственное наличие в таблице импорта (не считая переходников из kernel32, которые лишь после загрузки программы превращаются в адреса из ntdll). Поэтому полностью согласен:<br><br><I>neprovad пишет:<br>это просто еще одна идея, имеющая право на жизнь. </I>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295161&amp;user=2449&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=18" class="addthx" data-post="295161"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3232" title="11-11-2011 03:53, ранг:729.3" target="_blank">PE_Kill</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 ноября 2011 11:07 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#19');return false;">#19</a> </span><div align=left><br>
<b>int пишет:</b><br><i class=x>Во-первых не понял, к чему ты написал про морфинг?</i><br><br>Не понял, почему ты не понял. <br><br><i class=x>Смысл в том, что морфинг НЕ БУДЕТ вызывать функцию чтобы ее заморфить.</i><br>Это и не требуется. <br><br><i class=x>А пока она в таком виде, как дал neprovad, там морфить нечего. Ну т.е. можно конечно повесить какую-нибудь игрушку с долгим расчетом x&lt;&gt;0, y, z, а потом сделать раздвоение графа кода путем проверки [x^3+y^3==z^3] (я таких приколов могу много привести в пример, долго вам придется в деобфускатор мат. логику встраивать)</i><br><br>Вот именно об этом я пытался сказать - не надо писать деморфер и искать константы - надо просто не дать защите морфить функции, ведь она ж не морфит их все, а лишь некоторые. Значит надо найти место в коде, которое выбирает - морфить или нет, и подправить его, что морфа не было вообще. А эта деобфускация - это сегодня работает, а завтра морф изменился (добавилось на один проход больше и правил чуток больше стало), и техника стала нерабочей. Или вы так и хотите плясками с бубном ипорт восстанавливать?<br><br><i class=x>Вопрос об ntdll по-моему вообще не стоит. Где вы видели прямое использование в прикладных программах этой библиотеки?</i><br><br>Я сказал про неуниверсальность метода. Нравится вам идею - пользуйтесь, никто ж не запрещает.<br><br><i class=x>...которую писали люди, не до конца понимающие принципы построения защитных систем</i><br>Да, обсирать защиты просто.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295169&amp;user=6336&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=19" class="addthx" data-post="295169"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 ноября 2011 11:29 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#20');return false;">#20</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Или вы так и хотите плясками с бубном ипорт восстанавливать? </I><br>Это не пляски с бубном, это очень хороший способ, которым очень многие пользуются, не в таком именно виде конечно, всё более автоматизировано, но всё же это почти универсальный способ для любой защиты.<br><br><I>ARCHANGEL пишет:<br>Да, обсирать защиты просто. </I><br>В плане API я соглашусь с интом, сделано на коленке, морф вообще никакой, на глаз деморфится. Техника трамплинов изжила себя еще в Win98, а тут используется во всю. Самый продвинутый метод защиты импорта - это документированный механизм DelayImport, который взят на вооружение многими защитами, только вот реализовать по человечески не смогли, за исключением EXECryptor, там почти идеально этот механизм реализован. Старфорсу видимо до этого еще читать и читать маны.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295172&amp;user=3232&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=20" class="addthx" data-post="295172"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 ноября 2011 11:40 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#21');return false;">#21</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>Самый продвинутый метод защиты импорта - это документированный механизм DelayImport, который взят на вооружение многими защитами </I><br>дай почитать)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295173&amp;user=16624&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=21" class="addthx" data-post="295173"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 ноября 2011 11:58 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#22');return false;">#22</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>обсирать защиты просто </I><br>Писать защиты для которых возможно написать кейген еще проще. Такое ощущение, что все кто берутся писать какие-либо программные защиты, вообще никогда до этого с криптографией не сталкивались... Почти любой прот начинал свою историю с дыр в той же ЭЦП или даже в симметричном шифровании.<br><br><I>ARCHANGEL пишет:<br>что морфа не было вообще. </I><br>Метод Оленевода хуже, он заточен только под стар. Не задумывался почему автоматические средства находящиеся в привате годами работают без сбоев? Потому что по ту сторону баррикад никто не знает КАК реализована методика снятия защиты. Это вовсе не означает, что надо запереться, закрыть двери и окна, и любую информацию хранить как золотые слитки. Просто можно поделиться с народом идеями, но для себя всегда немного изменять.<br><br><I>MasterSoft пишет:<br>дай почитать) </I><br>лол, открой любую доку по PE формату <img src="img/smilies/s3.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295174&amp;user=2449&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=22" class="addthx" data-post="295174"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=10650" title="11-11-2011 19:37, ранг:147.8" target="_blank">kioresk</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 ноября 2011 12:05 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#23');return false;">#23</a> </span><div align=left><br>
<I>MasterSoft пишет:<br>дай почитать) </I><br>Забей в гугл Delay Load Import, даже Delphi XE его юзает.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295175&amp;user=3232&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=23" class="addthx" data-post="295175"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 ноября 2011 12:38 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#24');return false;">#24</a> </span><div align=left><br>
<I>int пишет:<br>Метод Оленевода хуже, он заточен только под стар </I><br>+1<br>Стоит распарсит таблицу экспорта и увидеть что вызов эспортируемых фунок находятся в не кода любой длл... да если ещё прот деревянный наподобии <b>GameShild</b> который ставит  хуки в виде простого JMP на начало функи  то вообще получити облом...
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295176&amp;user=17432&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=24" class="addthx" data-post="295176"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]GoldenJoe[/b]','')">GoldenJoe</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.66'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=30679">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 ноября 2011 14:40 <br><script type="text/javascript">QU('GoldenJoe','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GoldenJoe" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#25');return false;">#25</a> </span><div align=left><br>
По поводу метода Оленевода. Зачем ставить хуки на все экспортируемые апи? Не проще ли поставить хук лишь на GetProcAddress так, чтобы в ней генерировались эти самые jmp ds:[buf]? Перед тем, как спереть апишку, старик уж точно вызовет GetProcAddress. А она сгенерирует jmp и вернет адрес, по которому он лежит.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295325&amp;user=30679&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=25" class="addthx" data-post="295325"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Dart Sergius[/b]','')">Dart Sergius</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/22828.jpg" alt=""><br><span class=txtSm>Ранг: 105.6 (ветеран), 36thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22828">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 ноября 2011 15:30 <br><script type="text/javascript">QU('Dart Sergius','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dart Sergius" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#26');return false;">#26</a> </span><div align=left><br>
<b>GoldenJoe</b>, насколько я копал(а я копал недолго:s6<img src="img/smilies/s1.gif" alt="">, стар копирует память того же самого Kernel32 там парсит таблицу экспорта, и дальше юзает не станадрт функу, а то что копирнул. Так что твой метод тут не подойдёт.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295329&amp;user=22828&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=26" class="addthx" data-post="295329"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 ноября 2011 15:34 &middot; Поправил: PE_Kill <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#27');return false;">#27</a> </span><div align=left><br>
Выше уже написали, что это лишь концепт. Допили до идеала, проблемы не вижу.<br><br><b>Dart Sergius</b> почему не пойдет, можно StarForce_GetProcAddress хукать
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295331&amp;user=3232&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=27" class="addthx" data-post="295331"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 ноября 2011 20:29 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#28');return false;">#28</a> </span><div align=left><br>
Да импорт там вообще не самое главное. Что в него так упёрлись все. Про вм надо думать, про ВМ!
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295365&amp;user=6336&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=28" class="addthx" data-post="295365"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2011 02:16 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#29');return false;">#29</a> </span><div align=left><br>
<b>ARCHANGEL</b> метод оленевода само то, покодить немного надо только, менеджер памяти, редиректы, етц. Не сказал бы что сложно, просто видимо никому не надо. Мне лично некогда пока, так бы помог.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295408&amp;user=3232&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=29" class="addthx" data-post="295408"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2011 06:19 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#30');return false;">#30</a> </span><div align=left><br>
Импорт только в старых версиях спирается. Зачем кодить защиту от мертвого протектора?<br>В новых версиях довольно просто все восстановить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295412&amp;user=4618&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=30" class="addthx" data-post="295412"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=16624" title="14-11-2011 08:04, ранг:183.2" target="_blank">MasterSoft</a>, <a href="action=userinfo&user=18733" title="14-11-2011 16:07, ранг:8.3" target="_blank">neprovad</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]Buratino[/b]','')">Buratino</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.61'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=30838">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 декабря 2011 00:00 <br><script type="text/javascript">QU('Buratino','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Buratino" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=8#31');return false;">#31</a> </span><div align=left><br>
Нужно как-то прилепить к дампу память,не используемую ВМ во время инициализации и работы, но в которую во время расшифровки кода производится запись некоторых данных. А именно, вызовы служебных библиотек движка игры. И память эта находится ниже Imagebase. Вот такая головоломка
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=296742&amp;user=30838&amp;forum_n=5&amp;topic=19176&amp;page=8&amp;anchor=31" class="addthx" data-post="296742"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=7.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=7.html">8</a> . <b>9</b> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=9.html">10</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=9.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка StarForce 4.70 - Пьеса в нескольких действиях</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19176" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
