<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Альтиус на .NET 2.0 с защитой HASP HL (HASP 5) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Есть некая программа для бизнеса - Альтиус. Написан основной .ехе файл на .NET 2.0 но используется защита HASP5 HL. Хотел бы узнать у умных людей что там взято от хаспа и реально ли взломать её? Reflector открывает .ехе основной">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Альтиус на .NET 2.0 с защитой HASP HL (HASP 5)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]romich666777[/b]','')">romich666777</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.64'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=23246">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2009 13:49 <br><script type="text/javascript">QU('romich666777','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=romich666777" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Есть некая программа для бизнеса - Альтиус. Написан основной .ехе файл на .NET 2.0 но используется защита HASP5 HL.<br><br>Хотел бы узнать у умных людей что там взято от хаспа и реально ли взломать её?<br>Reflector открывает .ехе основной без проблем, весь код виден.<br><br>Помогите чем поправить код и как внести изменения или нужно перекомпилировать ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=245064&amp;user=23246&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=1" class="addthx" data-post="245064"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]romich666777[/b]','')">romich666777</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.64'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=23246">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2009 13:52 <br><script type="text/javascript">QU('romich666777','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=romich666777" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Как мне сказали, ключ там вставляется один раз, после этого программа работает без ключа. Там 4 вида активации.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=245065&amp;user=23246&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=2" class="addthx" data-post="245065"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]zeppe1in[/b]','')">zeppe1in</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/18780.png" alt=""><br><span class=txtSm>Ранг: 127.3 (ветеран), 44thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.68'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18780">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2009 16:33 <br><script type="text/javascript">QU('zeppe1in','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zeppe1in" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>romich666777 пишет:<br>Помогите чем поправить код и как внести изменения или нужно перекомпилировать ? </I><br>для рефлектора есть плагин Reflexil, или можно тупо хекс редактором, ну или перекомпилировать да.
<br><br><font size="1"><i>-----<br>zzz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=245081&amp;user=18780&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=3" class="addthx" data-post="245081"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]romich666777[/b]','')">romich666777</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.64'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=23246">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2009 16:40 <br><script type="text/javascript">QU('romich666777','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=romich666777" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Так а к какому месту туда прикручен HASP5 ? <br>Это же <img src="img/smilies/s16.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=245083&amp;user=23246&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=4" class="addthx" data-post="245083"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]romich666777[/b]','')">romich666777</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.64'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=23246">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2009 17:24 <br><script type="text/javascript">QU('romich666777','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=romich666777" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Поставил плагин Reflixir, додумался как подключить, как поправить код, но не пойму, сохранения сразу идут в файл или надо где-то найти кнопку сохранить.<br><br>Кто бы просвятил для чего программе нужен драйвер HASP, если ключ вставляется один раз, активирует нужную функцию и вынимается. Или может мне неправильно сказали. Может там куски кода шифрованы по ключу ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=245084&amp;user=23246&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=5" class="addthx" data-post="245084"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2009 21:20 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Есть кнопка Правка, убедительная просьба ей пользоваться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=245096&amp;user=1556&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=6" class="addthx" data-post="245096"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]romich666777[/b]','')">romich666777</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.64'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=23246">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 ноября 2009 18:32 <br><script type="text/javascript">QU('romich666777','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=romich666777" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Кто-нибудь скажет мне, если там HASP HL есть ли смысл пытаться что-то копать ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=245345&amp;user=23246&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=7" class="addthx" data-post="245345"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]digger70[/b]','')">digger70</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 106.6 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.45'>Активность: 0.04<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=9508">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 ноября 2009 22:10 &middot; Поправил: digger70 <br><script type="text/javascript">QU('digger70','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=digger70" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>romich666777</b> А ты думаешь это можно определить телепатический, не видя самой программы <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=245628&amp;user=9508&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=8" class="addthx" data-post="245628"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]romich666777[/b]','')">romich666777</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.64'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=23246">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2009 12:35 <br><script type="text/javascript">QU('romich666777','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=romich666777" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
file.qip.ru/file/110055461/ec58e7db/part3.html<br>file.qip.ru/file/110055463/25686f7/part1.html<br>file.qip.ru/file/110055465/eb3523c2/part2.html
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=245648&amp;user=23246&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=9" class="addthx" data-post="245648"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]digger70[/b]','')">digger70</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 106.6 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.45'>Активность: 0.04<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=9508">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2009 18:30 <br><script type="text/javascript">QU('digger70','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=digger70" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>romich666777</b><br>Я так понимаю, что раз в запросы на взлом разместил, то самому не интересно копать стало.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=245666&amp;user=9508&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=10" class="addthx" data-post="245666"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]romich666777[/b]','')">romich666777</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.64'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=23246">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2009 18:54 &middot; Поправил: romich666777 <br><script type="text/javascript">QU('romich666777','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=romich666777" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Эта функция внутри altius.exe<br><br>public void ProcessHaspCheck()<br>{<br>    this.n.Change(-1, -1);<br>    if (HaspHelper.HaspHelperInstance != null)<br>    {<br>        HaspHelper.HaspHelperInstance.Logout();<br>    }<br>    else<br>    {<br>        HaspHelper.HaspHelperInstance = new HaspHelper();<br>    }<br>    bool flag = HaspHelper.HaspHelperInstance.Login(Context.CurrentWorkplace.Task);<br>    if (!flag)<br>    {<br>        HaspHelper.HaspHelperInstance.Logout();<br>    }<br>    this.o = flag ? 0 : (this.o + 1);<br>    Context.IsDemo = this.o &gt; 3;<br>    if (flag)<br>    {<br>        SubVersion.Initialize(Context.CurrentWorkplace.Task);<br>        int dBVersion = DbFunc.GetDBVersion(Context.CurrentWorkplace.Task);<br>        int taskDatabaseVersion = HaspHelper.HaspHelperInstance.GetTaskDatabaseVersion(Context.CurrentWo rkplace.Task);<br>        if (dBVersion &gt; taskDatabaseVersion)<br>        {<br>            MessageBox.Show(string.Format(&quot;Несоответствие версий базы данных ({0,2:00}.{1,3:000}) и ключа HASP ({2,2:00}.{3,3:000}).\nПрограмма работает в ДЕМО режиме.&quot;, new object[] { Context.CurrentWorkplace.Task, dBVersion, Context.CurrentWorkplace.Task, taskDatabaseVersion }), &quot;Ошибка ключа HASP&quot;, MessageBoxButtons.OK, MessageBoxIcon.Exclamation);<br>            HaspHelper.HaspHelperInstance.Logout();<br>            Context.IsDemo = true;<br>            return;<br>        }<br>    }<br>    switch (this.o)<br>    {<br>        case 2:<br>        case 3:<br>            MessageBox.Show(string.Format(&quot;{0}\n{1} через {2} минуты.\nСохраните все несохраненные документы или подключите ключ HASP.&quot;, &quot;Ключ HASP не найден или превышено число лицензий.&quot;, &quot;Программа будет переведена в ДЕМО режим.&quot;, 4 - this.o), &quot;Ошибка ключа HASP&quot;, MessageBoxButtons.OK, MessageBoxIcon.Exclamation);<br>            break;<br><br>        case 4:<br>            MessageBox.Show(string.Format(&quot;{0}\n{1}&quot;, &quot;Ключ HASP не найден или превышено число лицензий.&quot;, &quot;Программа работает в ДЕМО режиме.&quot;), &quot;Ошибка ключа HASP&quot;, MessageBoxButtons.OK, MessageBoxIcon.Exclamation);<br>            break;<br>    }<br>    if (Context.IsDemo)<br>    {<br>        SubVersion.ClearState();<br>    }<br>    this.n.Change(0xea60, 0xea60);<br>}<br><br> <br><br> <br>Что если я пункт THIS.O сделаю = 2 ?<br><br>В файле altius_data.mdf нашел<br><br> if ( ДемоРежим())<br>         Сообщение( &#039;Эта функция доступна только в версии &amp;quot;Проф&amp;quot; (при наличии модуля &amp;quot;Документооборот&amp;quot;)&#039;)<br><br><br>Декомпилировал .ехе, скомпилировал. Запускается без проблем. Осталось понять как этот бредовый IL код править.<br><br>Через VS2005 открыл SQL базу данных, вижу функции. Пытаюсь что-то найти.<br>Пробежался бегло по функциям, не нашел никаких  if ( ДемоРежим()) <br>расстроился. ))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=245669&amp;user=23246&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=11" class="addthx" data-post="245669"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]digger70[/b]','')">digger70</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 106.6 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.45'>Активность: 0.04<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=9508">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2009 20:14 &middot; Поправил: digger70 <br><script type="text/javascript">QU('digger70','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=digger70" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Ну так уже направление верное, если Hasp эмулировать не хочешь. Одним this.o не отделаешся только - смотри код внимательнее.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=245675&amp;user=9508&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=12" class="addthx" data-post="245675"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]romich666777[/b]','')">romich666777</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.64'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=23246">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2009 20:49 &middot; Поправил: romich666777 <br><script type="text/javascript">QU('romich666777','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=romich666777" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Открыл .ldf и .mdf файлы в Winhex,<br>if ( ДемоРежим() == true )<br>поправил на<br>if ( ДемоРежим() == 0     )<br><br>Прога ругнулась на отсутствие ключа HASP, запустилась и написала что мол я версия &quot;Стандарт&quot;<br><br>Докопался до того, что с любым логином в SQL базу не пускает )))))<br><br>Непонятно, код в рефлекторе нормально можно читать на Си, а править нужно в каком-то безумном IL. Почему прям сишный код нельзя поправить?<br><br>Непонятно как добраться до скриптов MS SQL
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=245679&amp;user=23246&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=13" class="addthx" data-post="245679"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]romich666777[/b]','')">romich666777</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.64'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=23246">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 ноября 2009 16:49 &middot; Поправил: romich666777 <br><script type="text/javascript">QU('romich666777','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=romich666777" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Если в функции ProcessHASPcheck вместо<br>this.o = flag ? 0 : (this.o + 1);<br>--------<br>ldc.i4.1<br>sub<br>--------<br><br>пропатчить чтобы было<br>this.o = flag ? 0 : (this.o - 2);<br>--------<br>ldc.i4.2<br>sub<br>--------<br>тогда проверка<br>switch (this.o)<br>{<br>case 2:<br><br>Выполнится нормально и пропустит наги раздражающие.<br><br><br>То программа запускается молча в режиме &quot;Стандарт&quot; и нигде не чертыхается что оно демо, даже HASP драйвера не ставил я. Ща буду искать где версию поменять, чтобы она стала думать, что она &quot;Проф&quot;<br><br><br><br>Слабо верится что HASP5 там для того, чтобы пару бит менять и запускать прогу по нужному направлению. В MS SQL базе миллион скриптов натыкано, где проверяется версия. Буду думать как до них добраться.<br><br><br>Никак не пойму что за язык такой внутри sql баз используется (файлы .ldf и .mdf)<br>вот несколько вырезок<br>1. <br> if ( GetProgFlags( 9) &amp;gt; 0 )&#xD;&#xA;         {&#xD;&#xA;            ПерГлобЗап( &#039;ВерсияПрограммы&#039;, _Версия_ДокументоОборота +  Вер);&#xD;&#xA;            ДокНаГлавнойФорме(&#039;ЗаставкаДокументоОборота&#039;); &#xD;&#xA;         }&#xD;&#xA;&#xD;&#xA;// Вешаем таймер на сообщения, высылаемые пользователями&#xD;&#xA;ТаймерСтоп(&#039;СообщПоВрем&#039;);<br><br>2. <br>if ( ДемоРежим() == true )&#xD;&#xA;      Вер = &#039;Демо&#039;&#xD;&#xA;   else&#xD;&#xA;      Вер = &#039;стандарт&#039;;<br><br>Че за скрипты такие, которые можно по-русски в SQL базе писать? 1с чтоли ))))))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=245714&amp;user=23246&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=14" class="addthx" data-post="245714"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]romich666777[/b]','')">romich666777</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.64'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=23246">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 декабря 2009 10:11 &middot; Поправил: romich666777 <br><script type="text/javascript">QU('romich666777','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=romich666777" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Попытки поменять что-либо в какой-либо библиотеке приводят к падению в модуле HASP.OP_lnequality<br>Похоже он что-то с ключа в этом случае пытается прочитать и обламывается.<br><br>У меня прям блог получается тут, разговариваю сам с собой, никто помочь не хочет <img src="img/smilies/s1.gif" alt=""><br><br><br>Разорбал файл attaching.exe который подключает базу, узнал логин пароль на доступ к базе<br>builder.UserID = &quot;sa&quot;;<br>builder.Password = &quot;aLTiuS%2005&quot;;<br><br>Подключил MS SQL базу, открыл таблицы, там есть раздел XML в котором находятся скрипты русские, ясно теперь откуда они берутся. Копаем дальше...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=245758&amp;user=23246&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=15" class="addthx" data-post="245758"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]zeppe1in[/b]','')">zeppe1in</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/18780.png" alt=""><br><span class=txtSm>Ранг: 127.3 (ветеран), 44thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.68'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18780">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 декабря 2009 12:38 <br><script type="text/javascript">QU('zeppe1in','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zeppe1in" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>romich666777 пишет:<br>Попытки поменять что-либо в какой-либо библиотеке приводят к падению </I><br>библиотки тоже нетовские? может дело в Strong Name Signature. нужно после изменения убрать подпись с дллки, и со всего остального что эту длл использует.
<br><br><font size="1"><i>-----<br>zzz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=245766&amp;user=18780&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=16" class="addthx" data-post="245766"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]romich666777[/b]','')">romich666777</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.64'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=23246">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 декабря 2009 14:47 &middot; Поправил: romich666777 <br><script type="text/javascript">QU('romich666777','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=romich666777" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15367.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Не, это не SN иначе вообще бы не запустилось.<br>Библиотеки тоже на дот-нет 2.0<br><br>Застопорился пока. Через правку altius.exe кроме режима &quot;стандарт&quot; ничего не могу добиться, активации &quot;Проф&quot; не найду. Правка библиотек приводит к куче ошибок, запуск происходит, но скрипты валятся.<br><br>Остается только правка XML скриптов внутри SQL файла, но это уже имхо слишком. Берутся XML скрипты и парсером выполняются. Это ж надо было до такого ивзрата додуматься.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=245771&amp;user=23246&amp;forum_n=5&amp;topic=15367.html&amp;page=0&amp;anchor=17" class="addthx" data-post="245771"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Альтиус на .NET 2.0 с защитой HASP HL (HASP 5)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#18" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="15367">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15367" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
