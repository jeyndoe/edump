<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>ACProtect - фишки протектора - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Таргет: AutoFlowchart v1.01 (_hччp://www.ezprog.com/autoflowchart.exe ~1.3Мб) Протекчена по всей видимости ACProtect&#039;ом. Какой версии и им ли точно незнаю ибо peid молчит. Но по ощущениям оно. Из той инфы, которя была у меня">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=20667'>Slinger</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> ACProtect - фишки протектора</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Sax0n[/b]','')">Sax0n</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1969">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2006 08:46 <br><script type="text/javascript">QU('Sax0n','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sax0n" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Таргет: AutoFlowchart  v1.01 (_hччp://www.ezprog.com/autoflowchart.exe  ~1.3Мб)<br>Протекчена по всей видимости ACProtect&#039;ом. Какой версии и им ли точно незнаю ибо peid молчит. Но по ощущениям оно.<br><br>Из той инфы, которя была у меня по данному проту, удалось нарыть только толковое описание антиотладочных приемов. Все остальное - боян.Поковыряв его денек пришел вот к чему:<br><br>1. OEP. Находится легко бряком на доступ к секции CODE. Но и тут похож засада небольшая. Бряк срабатывает на 4FFC36, но похож 6 байт сперто и OEP = 4FFC30. Недостающие байты я сочинил <img src="img/smilies/s1.gif" alt=""> Это следующие команды (по памяти):<br><code>push ebp<br>mov ebp, esp<br>sub esp, 10</code><br>Есть ли способ точно восстановить то, что было сперто? Ато вдруг будет сперто много или неудастся догадаться.<br><br>2. С импортом все вроде просто. Все символьные строки закодированы <img src="img/smilies/s1.gif" alt=""> Кодирование осуществляется просто сдвигом каждого символа циклически на 3 бита в лево/право (уже непомню, не суть). Поэтому получается импорт безовсякого импрека. А так вообще прот импорт поганит. Переходники детские строит. Но есть апи, которую прот любит особо - MessageBoxA. С ней все непросто.<br><br>3.OEP есть, импорт есть, дамп есть... в дампе есть туева хуча CALL 0058D0DD. По адресу вызова там определяется, какой код необходимо выполнить. Нужный код расшифровывается (xor, ключ однобайтовый <img src="img/smilies/s1.gif" alt=""> , вычисляется из адреса EP в программу. он равен D8) и на место вызова вместо CALL 0058D0DD записывается CALL на расшифрованый участок кода. Восстановил все эти участки.<br><br>4. Остались приколы с функцией MessageBoxA... Вот тут я кончился. Вот адреса по которым происходит что-то плохое<br><code>4EC333, 4F29FB, 4F9BEA, 4F61E6, 4DFB32</code><br><br>Если кто-то бодался с этим протом, то не сочтите за труд поделиться опытом. А если кто захочет впервые поковыряться в нем, то маленькое напутствие: в проте дофига слоев расшифровки. Это убивает.. Все они выглядят примерно одинакого. В цикле расшифровки куча мусора, бесполезных прыжков и трюков со стеком. Но каждый цикл заканчивается условным прыжком в младшие адреса кода. Зная это проходить слои расшивровки немного легче: находите первый условный прыг на младшие адреса и ставите бряк на следующую за прыгом команду. Вот вроде бы (не пользовался) и скрипт который помогает проходить слои расшифровки (скрипт не мой, я его чесно спер <img src="img/smilies/s1.gif" alt="">) ):<br><code>LABEL01:<br>find eip,#0F85????FFFF#<br>add &#036;RESULT,6<br>bp &#036;RESULT<br>esto<br>bc eip<br>msgyn &quot;One more layer?&quot;<br>cmp &#036;RESULT,0<br>jne LABEL01<br>ret<br></code><br><br><br>PS: Интерес представляет собственно распаковка проги. То, что счетчик запусков можно сбросить стерев файло в корне диска C я знаю <img src="img/smilies/s1.gif" alt="">)<br>PPS: то, до чего я дошел могу выложить, если кто-то не хочет начинать распаковку с нуля
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99653&amp;user=1969&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=1" class="addthx" data-post="99653"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2006 09:38 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
[HIGHLIGHT=asm]<br>push ebp<br>mov ebp, esp<br>sub esp, 10  [/HIGHLIGHT]<br>А откуда ты знаешь что на стеке выделяется именно 10h bytes? Или это библиотечная функция?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99665&amp;user=1737&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=2" class="addthx" data-post="99665"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Sax0n[/b]','')">Sax0n</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1969">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2006 10:14 <br><script type="text/javascript">QU('Sax0n','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sax0n" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
1. гуляя по коду протектора наткнулся на сравнение EP с двумя константами: 18C000 и FFC30. Отсюда и подумал, что OEP это 4FFC30. Значит 6 байт сперто и их надо вернуть как-то. <br>2. посмотрел как выглядят регистры и стек на EP в запротекченой проге<br>3. посмотрел как выглядят регистры и стек на falseOEP (4FFC36) в запротекченой проге.<br>4. в 6 байт уместился приведенный код. После его выполнения в строке 4FFC36 распакованой проги, значения регистров EBP и ESP такиеже как и в запротекченой.<br><br>Т.е. если коротко, то я просто попытался догадаться... Не удивлюсь особо, если я всеж не угадал.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99674&amp;user=1969&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=3" class="addthx" data-post="99674"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Sax0n[/b]','')">Sax0n</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1969">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2006 10:50 &middot; Поправил: Sax0n <br><script type="text/javascript">QU('Sax0n','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sax0n" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Распишу пока восстановление импорта по шагам (мож кому пригодится)<br>1. Запустить прогу под отладчиком, IAT (гдето в секции .idata) и поставить хардварный бряк на запись в ячейку.<br>2. Перезапустить прогу. Сработает бряк. Теперь можно изучить цикл создания импорта и найти начало цикла. <br>3. Начало цикла - 597A0D. Хардбряк на выполнение на этот адрес. И снова перезапуск проги.<br>4.1 Затирается Name RVA в Import Directory Table - ссылка на имя библы.<br>4.2 Расшифровывается имя библы<br>4.3 Если еще не загружена такая библиотека, то она грузится<br>4.4 Расшифрованое имя затирается<br>4.5 Обрабатываются функции<br>4.5.1 Расшифровывается имя функции<br>4.5.2 Запрашивается адрес функции (GetProcAddress)<br>4.5.3 Если функция MessageBoxA - то строится переходник (отдельно)<br>4.5.4 Если библа из kernel32 или user32 то строится переходник<br>4.5.5 Иначе записывается адрес функции.<br><br>Пропатчив понятным образом этот цикл я получил нормальную секцию импорта.<br><code><br>00597A1A    and     dword ptr [esi+C], 0     ; занопить. здесь затирается Name RVA<br><br>00597A87    mov     byte ptr [ebx], al        ; занопить блок. Здесь затирается имя библы<br>00597A89    inc     ebx<br>00597A8A    cmp     byte ptr [ebx], al<br>00597A8C  ^jnz     short 00597A87<br><br>00597B16    mov     byte ptr [ebx], al        ; занопить блок. Здесь затирается имя api-функции    <br>00597B18    inc     ebx<br>00597B19    cmp     byte ptr [ebx], al<br>00597B1B  ^jnz     short 00597B16<br><br>00597B2C    jnz     short 00597B38        ; заменить на jmps. Типа мессажбокс ненайден <img src="img/smilies/s1.gif" alt="">    <br><br>00597B46    je      short 00597B5D        ; занопить чтобы небыло переходников<br><br>00597B52    je      short 00597B5D        ; занопить чтобы небыло переходников<br><br>00597BBE    mov     dword ptr [edi], eax ;занопить, чтобы получить чистую секцию импорта<br></code><br><br>00597BDA - конец цикла создания импорта. стоя на этой строке можно дампить .idata<br>Вот и все с импортом. И без импрека (хоть это и не показатель) <img src="img/smilies/s1.gif" alt=""><br><br>В атаче бинарник секции .idata<br><img src="img/attach.gif" alt=""> <a href="./files/39c8_18.10.2006_CRACKLAB.rU.tgz">39c8_18.10.2006_CRACKLAB.rU.tgz</a> - .idata.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99683&amp;user=1969&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=4" class="addthx" data-post="99683"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Styx[/b]','')">Styx</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 103.1 (ветеран), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.07<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=12">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2006 11:07 <br><script type="text/javascript">QU('Styx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Styx" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>Sax0n</b><br>Я тож с етой прогой калупалса, но наткнувшись на пошифрованные куски кода забил,  механизм понял, но после 4 шт. решил, что бесполезно и их там еще много... так их там много?
<br><br><font size="1"><i>-----<br>Crack your mind, save the planet</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=99690&amp;user=12&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=5" class="addthx" data-post="99690"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Sax0n[/b]','')">Sax0n</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1969">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2006 12:11 <br><script type="text/javascript">QU('Sax0n','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sax0n" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Styx</b><br>Пошифрованные куски - это ты имел в виду типа CALL 0058D0DD в моем описании? если да, то таких вызовов в проге 999 (посчитал на калькуляторе <img src="img/smilies/s1.gif" alt=""> ) <br><br>Прот тырит из проги 5байт (естественно дизасмом, естественно инструкции не разрываются), и вставляет на это место CALL _DISPATCHER (5 байт). Там в цикле просматривается таблица (TABLE START : 58D382, TABLE END : 58E31E) Если элемент таблицы совпадает с адресом вызова, то индекс этого элемента используется для вычисления адреса куска кода со спертыми инструкциями (сам код зашифрован, расшифровка - xor с D8 побайтно). Адрес нужного куска вычисляется как CRYPTED_CODE_START+I*0x0A, где I - индекс найденного элемента в предыдущей таблице (CRYPTED_CODE_START : 58E322, CRYPTED_CODE_SIZE : 2706) Потом код расшифровывается и по адресу вызова прописывается CALL _Decrypted_code_N (5 байт) а там будет что-то типа:<br><code><br>0058E322    mov     dword ptr [edx+C], eax ; это было сперто<br>0058E325    xor     esp, ecx                     ; мусор<br>0058E327    xor     esp, ecx                     ; мусор<br>0058E329    mov     eax, dword ptr [ebx] ; и это было сперто<br>0058E32B    retn<br></code><br><br>Собственно вернуть на место сами инструкции достаточно проблематично. Нужно, как мне представляется, писать анализатор этих 0x0A байтных функций и искать там полезные 5байт кода. Я лишь расшифровал все функции и во все места с CALL _DISPATCHER прописал жестко CALL _Decrypted_code_N
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99701&amp;user=1969&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=6" class="addthx" data-post="99701"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]DrFits[/b]','')">DrFits</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 200.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2006 12:48 &middot; Поправил: DrFits <br><script type="text/javascript">QU('DrFits','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DrFits" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Глянул прогу - IAT правил почти как и ты, импорт прикрутил к дампу, поправил EP проги, т.к. на основе EP  раскриптовывается участок в ВМ (ВМ-сдампил тоже(чтоб ВМ неразбирать) =&gt; неотрезал). Остался один баг - щас лень смотреть, окошко выскакивает с ошибкой, функционал недопер как посмотреть.Если надо - могу выложить что получилось.<br>P.S:Сильно не пинать - я новичек;)
<br><br><font size="1"><i>-----<br>Само плывет в pуки только то, что не тонет.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=99704&amp;user=411&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=7" class="addthx" data-post="99704"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Mario555[/b]','')">Mario555</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/15.jpg" alt=""><br><span class=txtSm>Ранг: 332.0 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15">Участник</a><br><font color=blue>•Pr0tEcToRs KiLLeR•</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2006 13:05 <br><script type="text/javascript">QU('Mario555','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mario555" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Sax0n пишет:<br>Собственно вернуть на место сами инструкции достаточно проблематично. Нужно, как мне представляется, писать анализатор этих 0x0A байтных функций и искать там полезные 5байт кода. </I><br>На самом деле это не сложно, вариантов мусора у прота немного, анализатор довольно простой. Но в принципе способ который ты использовал наиболее быстр и описан в статьях ещё Нарвахой.<br><br><I>Sax0n пишет:<br>4. Остались приколы с функцией MessageBoxA... </I><br>Эту функцию прот использует для своих апи (читай SDK), возможно это апи проверки регистрации - тогда можно просто вернуть TRUE, а возможно они отвечают за расшифровку кусков кода - тогда без ключа наверно нераспаковать (хотя мож там есть какие-то дыры в реализации крипты, но их надо искать, а на такой редкий прот как ацпр тратить время...), вообщем всё зависит от того насколько хорошо афторы проги прочитали сдк прота и как они его использовали.<br><br><I>DrFits пишет:<br>т.к. на основе EP раскриптовывается участок в ВМ (ВМ-сдампил тоже(чтоб ВМ неразбирать) =&gt; неотрезал) </I><br>ВМ ? данунах =) раньше там всегда был обыкновенный метаморф, хотя мож версия какая-то новая... что ты называешь ВМ ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99708&amp;user=15&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=8" class="addthx" data-post="99708"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]DrFits[/b]','')">DrFits</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 200.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2006 13:20 &middot; Поправил: DrFits <br><script type="text/javascript">QU('DrFits','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DrFits" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Ну а как еще называть код, который эмулирует спертые инструкции, я думал что это ВМ называется, хотя там метаморф тоже присутствует?<br><br>[HIGHLIGHT=asm]00404479    8B30            mov esi, dword ptr ds:[eax]<br>0040447B    E8 40A11800     call 0058E5C0      ; пример инструкции спертой<br>00404480    E8 45A11800     call 0058E5CA <br>00404485    55              push ebp<br><br>[/HIGHLIGHT]<br><br>Просто в метаморфе раскриптовываются инструкции для эмуляции, а потом они выполняются, как я писал - в раскриптовке учавствует и значение EP программы, поэтому я в своем дампе поменял EP на первоначальную
<br><br><font size="1"><i>-----<br>Само плывет в pуки только то, что не тонет.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=99712&amp;user=411&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=9" class="addthx" data-post="99712"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Mario555[/b]','')">Mario555</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/15.jpg" alt=""><br><span class=txtSm>Ранг: 332.0 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15">Участник</a><br><font color=blue>•Pr0tEcToRs KiLLeR•</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2006 14:02 <br><script type="text/javascript">QU('Mario555','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mario555" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>DrFits пишет:<br>который эмулирует спертые инструкции, я думал что это ВМ называется </I><br>ВМ - виртуальная машина. Если инструкции просто преобразовали (полиморф, метаморф) и разбавили мусором, то какая тут ВМ ? %) это обычное исполнение команд процессором, а не обработка псевдокода функцией виртуальной машины.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99713&amp;user=15&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=10" class="addthx" data-post="99713"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2006 18:05 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>Sax0n пишет:<br>Из той инфы, которя была у меня по данному проту, удалось нарыть только толковое описание антиотладочных приемов. Все остальное - боян. </I><br>Плохо искал инфы полным полно! ;) Антиотладочных приемов? Так по сравнению к примеру с Ехекриптором о них и говорить не стоит! Импорт так же востановить проще чем у некотрых пакеров! <br>Единственая проблема как правило Коде реплейс с использованием дебаг регистров! При небольшом количестве можно обойтись элементарным трейсом!  Соде сплайсинг если используется  так вообще элементарный! 5стырено ? тут и говорить не о чем <br>К примеру вот начло в самом ACprotecte2<br>0079E4B1    61                  popad<br>0079E4B2    8B06                mov eax,dword ptr ds:[esi]<br>0079E4B4    8F05 058B7800       pop dword ptr ds:[788B05]<br>0079E4BA    FF35 058B7800       push dword ptr ds:[788B05]<br>0079E4C0    5E                  pop esi<br>0079E4C1    56                  push esi<br>0079E4C2    8F05 45887800       pop dword ptr ds:[788845]<br>0079E4C8    FF35 45887800       push dword ptr ds:[788845]<br>0079E4CE    C70424 FC6B4000     mov dword ptr ss:[esp],ACProtec.00406BFC<br>0079E4D5    8F05 7D887800       pop dword ptr ds:[78887D]<br>0079E4DB    FF15 7D887800       call dword ptr ds:[78887D]<br>0079E4E1    A1 B4375200         mov eax,dword ptr ds:[5237B4]<br>0079E4E6    8B00                mov eax,dword ptr ds:[eax]<br><br>0079E4E8    52                  push edx<br>0079E4E9    891C24              mov dword ptr ss:[esp],ebx<br>0079E4EC    57                  push edi<br>0079E4ED    BF CCE84600         mov edi,ACProtec.0046E8CC<br>0079E4F2    8BDF                mov ebx,edi<br>0079E4F4    5F                  pop edi<br>0079E4F5    50                  push eax<br>0079E4F6    B8 D5887800         mov eax,ACProtec.007888D5<br>0079E4FB    8918                mov dword ptr ds:[eax],ebx<br>0079E4FD    58                  pop eax<br>0079E4FE    90                  nop<br>0079E4FF    90                  nop<br>0079E500    60                  pushad<br>0079E501    EB 0B               jmp short ACProtec.0079E50E<br><br>Вот востановленое начало<br>004FEE90 &gt;  55                  push ebp<br>004FEE91    8BEC                mov ebp,esp<br>004FEE93    83C4 F0             add esp,-10<br>004FEE96    B8 D4EB4F00         mov eax,ACProtec.004FEBD4<br>004FEE9B    E8 5C7DF0FF         call ACProtec.00406BFC<br>004FEEA0    A1 B4375200         mov eax,dword ptr ds:[5237B4]<br>004FEEA5    8B00                mov eax,dword ptr ds:[eax]<br>004FEEA7    E8 20FAF6FF         call ACProtec.0046E8CC<br>004FEEAC    8B0D 28355200       mov ecx,dword ptr ds:[523528]              ; ACProtec.00525D38<br>004FEEB2    A1 B4375200         mov eax,dword ptr ds:[5237B4]<br>004FEEB7    8B00                mov eax,dword ptr ds:[eax]<br>004FEEB9    8B15 8CBF4700       mov edx,dword ptr ds:[47BF8C]              ; ACProtec.0047BFD8<br>004FEEBF    E8 20FAF6FF         call ACProtec.0046E8E4<br>004FEEC4    8B0D 44345200       mov ecx,dword ptr ds:[523444]              ; ACProtec.00525D2C<br>004FEECA    A1 B4375200         mov eax,dword ptr ds:[5237B4]<br>004FEECF    8B00                mov eax,dword ptr ds:[eax]<br>004FEED1    8B15 4CB94700       mov edx,dword ptr ds:[47B94C]              ; ACProtec.0047B998<br>004FEED7    E8 08FAF6FF         call ACProtec.0046E8E4<br>004FEEDC    A1 B4375200         mov eax,dword ptr ds:[5237B4]<br>004FEEE1    8B00                mov eax,dword ptr ds:[eax]<br>004FEEE3    E8 7CFAF6FF         call ACProtec.0046E964<br>004FEEE8    E8 BB5AF0FF         call ACProtec.004049A8
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99722&amp;user=293&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=11" class="addthx" data-post="99722"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 октября 2006 01:58 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
В этой проге вобще все просто коде реплейс в одном месте Если очистить от мусора то будет примерно так<br>0058D0DD    60                  pushad<br>0058D0DE    90                  nop<br>..................................................<br>0058D288    E8 13510000         call UAutoFlo.005923A0<br>0058D28D    8B4424 20           mov eax,dword ptr ss:[esp+20]<br>0058D291    33C9                xor ecx,ecx<br>0058D293    8B9C8D 82234000     mov ebx,dword ptr ss:[ebp+ecx*4+402382]<br>0058D29A    039D EA614000       add ebx,dword ptr ss:[ebp+4061EA]<br>0058D2A0    3BC3                cmp eax,ebx<br>0058D2A2    74 07               je short UAutoFlo.0058D2AB<br>0058D2A4    90                  nop<br>0058D2A5    90                  nop<br>0058D2A6    90                  nop<br>0058D2A7    90                  nop<br>0058D2A8    41                  inc ecx<br>0058D2A9  ^ EB E8               jmp short UAutoFlo.0058D293<br>0058D2AB    8DB5 22334000       lea esi,dword ptr ss:[ebp+403322]<br>0058D2B1    B8 0A000000         mov eax,0A<br>0058D2B6    F7E1                mul ecx<br>0058D2B8    03F0                add esi,eax<br>0058D2BA    51                  push ecx<br>0058D2BB    56                  push esi<br>0058D2BC    8A85 CD204000       mov al,byte ptr ss:[ebp+4020CD]<br>0058D2C2    0AC0                or al,al<br>0058D2C4    75 28               jnz short UAutoFlo.0058D2EE<br>...................................................................... .................<br>0058D2F8    90                  nop<br>0058D2F9    5E                  pop esi<br>0058D2FA    8BFE                mov edi,esi<br>0058D2FC    90                  nop<br><br>0058D305    59                  pop ecx<br>0058D306    56                  push esi<br>0058D307    90                  nop<br>..........................................................<br>0058D30F    50                  push eax<br>..........................................................<br>0058D323    90                  nop<br>0058D324    58                  pop eax<br>0058D325    03C3                add eax,ebx<br>0058D327    90                  nop<br>0058D328    90                  nop<br>0058D329    90                  nop<br>0058D32A    5E                  pop esi<br>0058D32B    56                  push esi<br>0058D32C    33C9                xor ecx,ecx<br>0058D32E    83F9 08             cmp ecx,8<br>0058D331    74 0E               je short UAutoFlo.0058D341<br>...................................................................... ...................<br>0058D337    8B448C 04           mov eax,dword ptr ss:[esp+ecx*4+4]<br>0058D33B    89048C              mov dword ptr ss:[esp+ecx*4],eax<br>0058D33E    41                  inc ecx<br>0058D33F  ^ EB ED               jmp short UAutoFlo.0058D32E<br>0058D341    89348C              mov dword ptr ss:[esp+ecx*4],esi<br>0058D344    60                  pushad<br>0058D345    E8 00000000         call UAutoFlo.0058D34A<br>0058D34A    5E                  pop esi<br>...................................................................... ........<br>0058D37F    61                  popad<br>0058D380    61                  popad<br>0058D381    C3                  retn<br>все что между этими командами залить нопами<br>и вот по аддрессам у меня они начинаются с 0058E320 до 00590A27 копипастнуть из запущеной проги в дамп там такого вида команды<br>00590A14    03D6                add edx,esi<br>00590A16    33C9                xor ecx,ecx<br>00590A18    894D FC             mov dword ptr ss:[ebp-4],ecx<br>00590A1B    2BD6                sub edx,esi<br>00590A1D    C3                  retn<br>00590A1E    33CA                xor ecx,edx<br>00590A20    8B46 64             mov eax,dword ptr ds:[esi+64]<br>00590A23    33CA                xor ecx,edx<br>00590A25    8903                mov dword ptr ds:[ebx],eax<br>00590A27    C3                  retn<br><br>0058E446    8B45 F8             mov eax,dword ptr ss:[ebp-8]<br>0058E449    33CF                xor ecx,edi<br>0058E44B    03C3                add eax,ebx<br>0058E44D    C3                  retn<br>0058E44E    33FA                xor edi,edx<br>0058E450    8B40 08             mov eax,dword ptr ds:[eax+8]<br>0058E453    03D8                add ebx,eax<br>0058E455    33FA                xor edi,edx<br>0058E457    C3                  retn<br>Код что привел <b>DrFits</b> можно вообще убрать и переписать на стандартный дельфи вот так<br>00404473    55                  push ebp<br>00404474    8BEC                mov ebp,esp<br>00404476    53                  push ebx<br>00404477    56                  push esi<br>00404478    57                  push edi<br>00404479    A1 37FC4F00         mov eax,dword ptr ds:[4FFC37]<br>0040447E    85C0                test eax,eax<br>00404480    74 4B               je short UAutoFlo.004044CD<br>00404482    8B30                mov esi,dword ptr ds:[eax]<br>00404484    33DB                xor ebx,ebx<br>00404486    8B78 04             mov edi,dword ptr ds:[eax+4]<br>00404489    33D2                xor edx,edx<br>0040448B    55                  push ebp<br>0040448C    68 B9444000         push UAutoFlo.004044B9<br>00404491    64:FF32             push dword ptr fs:[edx]<br>00404494    64:8922             mov dword ptr fs:[edx],esp<br>00404497    3BF3                cmp esi,ebx<br>00404499    7E 14               jle short UAutoFlo.004044AF<br>0040449B    8B04DF              mov eax,dword ptr ds:[edi+ebx*8]<br>0040449E    43                  inc ebx<br>0040449F    891D 40465200       mov dword ptr ds:[524640],ebx<br>004044A5    85C0                test eax,eax<br>004044A7    74 02               je short UAutoFlo.004044AB<br>004044A9 &gt;  FFD0                call eax<br>004044AB    3BF3                cmp esi,ebx<br>004044AD  ^ 7F EC               jg short UAutoFlo.0040449B<br>004044AF    33C0                xor eax,eax<br>004044B1    5A                  pop edx<br>004044B2    59                  pop ecx<br>004044B3    59                  pop ecx<br>004044B4    64:8910             mov dword ptr fs:[eax],edx<br>004044B7    EB 14               jmp short UAutoFlo.004044CD<br>004044B9  ^ E9 FEF9FFFF         jmp UAutoFlo.00403EBC<br>004044BE    E8 31FFFFFF         call UAutoFlo.004043F4<br>004044C3    E8 08FDFFFF         call UAutoFlo.004041D0<br>004044C8    E8 57FDFFFF         call UAutoFlo.00404224
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99749&amp;user=293&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=12" class="addthx" data-post="99749"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]NIKOLA[/b]','')">NIKOLA</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/247.jpg" alt=""><br><span class=txtSm>Ранг: 500.6 (<b>!</b>), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.87'>Активность: 0.26<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=247">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 октября 2006 03:42 <br><script type="text/javascript">QU('NIKOLA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NIKOLA" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Кошдато, написал пару скриптов для этого прота, но, не оптимизировал их, приведу их текст здесь, кому интересно может их оптимизировать:<br><br>Коде сплисинг:<br>// Для работы скрипта нужно отредактировать строку:<br>// findop eip,#E8????1F00#, E8????1F00 - это CALL XXXXXX, а в этом вызове JMP DWORD PTR <br>// DS:[хххххх].<br>// Скрипт предназначен для востановления этих вызовов в UltraProtect 1.x -&gt; RISCO Software Inc.<br><br><br><br><br>var  _eip<br>var _oep<br>var _memcpy<br>var  _eip2<br><br><br>start:<br>bpmc<br>gpa &quot;memcpy&quot;, &quot;msvcrt.dll&quot;<br>mov _memcpy, &#036;RESULT<br>mov _oep,eip<br>mov eip,401000<br><br>l1:<br>findop eip,#E8????2?00#<br>cmp &#036;RESULT,0<br>je l3<br><br>l2:<br>mov eip,&#036;RESULT<br>mov _eip,eip<br>sti<br>sti<br>mov _eip2,eip<br>exec<br>pushad<br>push 5<br>push {_eip2}<br>push {_eip}<br>call {_memcpy}<br>popad<br>ende<br>mov eip,_eip<br>jmp l1<br><br>l3:<br>mov eip,_oep<br>mov _oep,eip<br>mov eip,401000<br><br>l4:<br>findop eip,#E8????1?00#<br>cmp &#036;RESULT,0<br>je not<br><br>l5:<br><br>mov eip,&#036;RESULT<br>mov _eip,eip<br>sti<br>sti<br>mov _eip2,eip<br>exec<br>pushad<br>push 5<br>push {_eip2}<br>push {_eip}<br>call {_memcpy}<br>popad<br>ende<br>mov eip,_eip<br>jmp l4<br><br><br><br><br>not:<br>mov eip,_oep<br>ret<br><br>Украденные байты:<br>var faund<br>var _CreateFileW<br><br><br><br>start:<br>bpmc<br>gpa    &quot;CreateFileW&quot;,&quot;kernel32.dll&quot;<br>mov _CreateFileW,&#036;RESULT<br>bp _CreateFileW<br>esto<br>esto<br>bc eip<br>rtu<br>rtu<br>find eip,#C8000000??????????????90909090#<br>cmp &#036;RESULT,0<br>je not<br>mov faund,&#036;RESULT<br>sub faund,E<br>bpwm faund,1<br>esto<br>esto<br>find eip,#61#<br>cmp &#036;RESULT,0<br>je not<br>bp &#036;RESULT<br>find eip,#60#<br>cmp &#036;RESULT,0<br>je not<br>bp &#036;RESULT<br>bpmc<br>esto<br>bc eip<br>sti<br>cmt eip, &quot;This is stolen bytes !!!&quot;<br>esto<br>bc eip<br>find eip,#FF25??????00#<br>cmp &#036;RESULT,0<br>je not<br>bphws &#036;RESULT, &quot;x&quot;<br>MSG &quot;Writen stolen bytes.&quot;<br>esto<br>bphwc eip<br>sti<br>cmt eip, &quot;This is OEP !!!&quot;<br>ret<br><br>not:<br>MSG &quot;Not supported.&quot;<br>ret
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99761&amp;user=247&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=13" class="addthx" data-post="99761"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]NIKOLA[/b]','')">NIKOLA</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/247.jpg" alt=""><br><span class=txtSm>Ранг: 500.6 (<b>!</b>), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.87'>Активность: 0.26<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=247">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 октября 2006 03:47 <br><script type="text/javascript">QU('NIKOLA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NIKOLA" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Первый скрипт запускается с оригинального оеп, второй с оеп пакера.<br>Таблицу импорта, можно востановить если поймать пакер при распаковке секции с импортом, но нужно несколько джампов или занопить или изменить (не помню уже), когда пакер распакует секцию, нужно её сдампить и прикрудить к дампу, а дальше пе редактором всё поправить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99762&amp;user=247&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=14" class="addthx" data-post="99762"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 октября 2006 07:26 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Вот <br>004074BC  - FF25 20565000       jmp dword ptr ds:[505620] &lt;--------0059178D<br>004074B4  - FF25 20565000       jmp dword ptr ds:[505620]    &lt;------- UAutoFlo.0059178D<br>0059178D это еще одна процедура с коде реплейс <br>самя большая процедура там<br>004F5C1D    61                  popad<br>004F5C1E    8D85 F0FEFFFF       lea eax,dword ptr ss:[ebp-110]<br>004F5C24    33C9                xor ecx,ecx<br>004F5C26    BA 00010000         mov edx,100<br>004F5C2B    E8 D4D6F0FF         call UAutoFlo.00403304<br>004F5C30    6A 00               push 0<br>004F5C32    6A 00               push 0<br>004F5C34    8D85 F0FEFFFF       lea eax,dword ptr ss:[ebp-110]<br>004F5C3A    50                  push eax<br>004F5C3B    6A FF               push -1<br>004F5C3D    E8 7218F1FF         call UAutoFlo.004074B4<br>004F5C42    8D85 E0FEFFFF       lea eax,dword ptr ss:[ebp-120]<br>004F5C48    8D95 F0FEFFFF       lea edx,dword ptr ss:[ebp-110]<br>004F5C4E    B9 00010000         mov ecx,100<br>004F5C53    E8 CCEDF0FF         call UAutoFlo.00404A24<br>004F5C58    8B85 E0FEFFFF       mov eax,dword ptr ss:[ebp-120]<br>004F5C5E    8D95 E4FEFFFF       lea edx,dword ptr ss:[ebp-11C]<br>004F5C64    E8 F32FF1FF         call UAutoFlo.00408C5C<br>004F5C69    83BD E4FEFFFF 00    cmp dword ptr ss:[ebp-11C],0<br>004F5C70    74 6D               je short UAutoFlo.004F5CDF<br>004F5C72    8D45 F4             lea eax,dword ptr ss:[ebp-C]<br>004F5C75    8D95 F0FEFFFF       lea edx,dword ptr ss:[ebp-110]<br>004F5C7B    B9 00010000         mov ecx,100<br>004F5C80    E8 9FEDF0FF         call UAutoFlo.00404A24<br>004F5C85    8D95 D8FEFFFF       lea edx,dword ptr ss:[ebp-128]<br>004F5C8B    8B45 F4             mov eax,dword ptr ss:[ebp-C]<br>004F5C8E    E8 C92FF1FF         call UAutoFlo.00408C5C<br>004F5C93    8B8D D8FEFFFF       mov ecx,dword ptr ss:[ebp-128]<br>004F5C99    8D85 DCFEFFFF       lea eax,dword ptr ss:[ebp-124]<br>004F5C9F    BA C85D4F00         mov edx,UAutoFlo.004F5DC8                  ; ASCII &quot; Register to: &quot;<br>004F5CA4    E8 17EEF0FF         call UAutoFlo.00404AC0<br>004F5CA9    8B95 DCFEFFFF       mov edx,dword ptr ss:[ebp-124]<br>004F5CAF    8B45 FC             mov eax,dword ptr ss:[ebp-4]<br>004F5CB2    8B80 20040000       mov eax,dword ptr ds:[eax+420]<br>004F5CB8    E8 DB7EF6FF         call UAutoFlo.0045DB98<br>004F5CBD    33D2                xor edx,edx<br>004F5CBF    8B45 FC             mov eax,dword ptr ss:[ebp-4]<br>004F5CC2    8B80 E4030000       mov eax,dword ptr ds:[eax+3E4]<br>004F5CC8    E8 BB7DF6FF         call UAutoFlo.0045DA88<br>004F5CCD    33D2                xor edx,edx<br>004F5CCF    8B45 FC             mov eax,dword ptr ss:[ebp-4]<br>004F5CD2    8B80 D8030000       mov eax,dword ptr ds:[eax+3D8]<br>004F5CD8    E8 4FA0F7FF         call UAutoFlo.0046FD2C<br>004F5CDD    EB 49               jmp short UAutoFlo.004F5D28<br>004F5CDF    6A 01               push 1<br>004F5CE1    6A 00               push 0<br>004F5CE3    8D45 FB             lea eax,dword ptr ss:[ebp-5]<br>004F5CE6    50                  push eax<br>004F5CE7    6A FF               push -1<br>004F5CE9    E8 C617F1FF         call UAutoFlo.004074B4<br>004F5CEE    8D95 D0FEFFFF       lea edx,dword ptr ss:[ebp-130]<br>004F5CF4    33C0                xor eax,eax<br>004F5CF6    8A45 FB             mov al,byte ptr ss:[ebp-5]<br>004F5CF9    E8 9230F1FF         call UAutoFlo.00408D90<br>004F5CFE    8B8D D0FEFFFF       mov ecx,dword ptr ss:[ebp-130]<br>004F5D04    8D85 D4FEFFFF       lea eax,dword ptr ss:[ebp-12C]<br>004F5D0A    BA E05D4F00         mov edx,UAutoFlo.004F5DE0                  ; ASCII &quot; Trial Time : &quot;<br>004F5D0F    E8 ACEDF0FF         call UAutoFlo.00404AC0<br>004F5D14    8B95 D4FEFFFF       mov edx,dword ptr ss:[ebp-12C]<br>004F5D1A    8B45 FC             mov eax,dword ptr ss:[ebp-4]<br>004F5D1D    8B80 20040000       mov eax,dword ptr ds:[eax+420]<br>004F5D23    E8 707EF6FF         call UAutoFlo.0045DB98<br>004F5D28    60                  pushad<br>004F5D29    6A 04               push 4<br>004F5D2B    6A 00               push 0<br>004F5D2D    6A 00               push 0<br>004F5D2F    68 FFFFFFFF         push -1<br>004F5D34    E8 8317F1FF         call UAutoFlo.004074BC<br>004F5D39    EB 1E               jmp short UAutoFlo.004F5D59<br><br>00419532    E8 F1FEFFFF         call UAutoFlo.00419428<br>Остальное пустяки если захотите сами востановите, ну все вроде там ни чего больше нет!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99789&amp;user=293&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=15" class="addthx" data-post="99789"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 октября 2006 04:26 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Вот примерно так должно пулучится если кому интересно вот <br>slil.ru/23277786
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99889&amp;user=293&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=16" class="addthx" data-post="99889"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Sax0n[/b]','')">Sax0n</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1969">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 октября 2006 14:14 <br><script type="text/javascript">QU('Sax0n','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sax0n" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6547.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Все. Разобрался сам со всеми вопросами. всем помогавшим большое спасибо за помощь. тема раскрыта.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99994&amp;user=1969&amp;forum_n=1&amp;topic=6547.html&amp;page=0&amp;anchor=17" class="addthx" data-post="99994"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> ACProtect - фишки протектора</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=6547" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
