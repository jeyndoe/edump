<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Многопоточность в Delphi - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Решил на досуге поковыряться с потоками... На текущий момент нарушена синхронизация вывода, что вполне логично... Тут немного встрял. Каким образом её наладить? 1. В процедуре, что передаётся в Synchronize организовываются только">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Многопоточность в Delphi</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 апреля 2011 01:02 &middot; Поправил: Isaev <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Решил на досуге поковыряться с потоками...<br>На текущий момент нарушена синхронизация вывода, что вполне логично...<br>Тут немного встрял. Каким образом её наладить?<br><b>1.</b> В процедуре, что передаётся в Synchronize организовываются только изменение переменных <i class=x>по минимуму</i> или туда можно влепить весомый кусок кода? Полностью вывод например в данный момент в Memo потом будет в файл...<br><b>2.</b> Как в неё передавать значения? Если в файл нужно кидать массив например (или просто вывести строку, как сейчас)<br><b>3.</b> Как добиться, чтобы нумерация строк не нарушалась?<br><br>Запись в файл нужно наверное вообще в критическую секцию помещать?
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=281070&amp;user=6946&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=1" class="addthx" data-post="281070"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]A V[/b]','')">A V</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок), 44thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 апреля 2011 23:10 <br><script type="text/javascript">QU('A V','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=A V" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
1. можно впринципе что угодно туда влепить, Synchronize вобщем-то нужен только для работы с главным потоком, т.е фактически с gui<br>2. собственно через поля потока<br>3. я так понял нумерация строк зависит от порядка выполнения потоков, их конечно можно заставить выполняться последовательно, через любые примитивы синхронизации, в т.ч и крит. секции, но в чем тогда вообще смысл _последовательного_ выполнения потоков? если нужно просто отсортировать строки в нужной последовательности, то это можно сделать и после завершения всех потоков..<br><br>все AFAIK&amp;AFAIR <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=281212&amp;user=26841&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=2" class="addthx" data-post="281212"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 апреля 2011 23:27 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>A V</b> всё правильно сказал.<br><br>По исходнику. Всё неправильно. Обращение к VCL из потока только через Synchronize. Параметры передаются через поля потока. Обращение к глобальным переменным только через критические секции, блокировки,.... Если не уверен в чем то, то представь как 2 потока одновременно с этим работают. Вот пример:<br><br>Procedure TMyThread.ThreadExit(Sender:TObject);<br>Begin<br>  Dec(Alive);<br>End;<br><br>Представь, что Alive = 10. Dec(Alive) выглядит как<br>mov eax, [mem]<br>dec eax<br>mov [mem], eax<br><br>если все 10 потоков одновременно выполнят первую строчку, то последний поток запишет в Alive 9 хотя ни одного потока уже не будет.<br><br>Synchronize тормозит вызывающий поток и выполняет метод в контексте главного потока, поэтому если нужно много писать в лог, то могу предложить следующий трюк:<br><br>Динамически создаем строку. Копируем туда нужные данные. Засылаем указатель на строку главному окну функцией PostMessage. В главном окне в обработчике этого сообщения читаем строку и освобождаем память. Так поток не будет прерываться, а лог будет сваливаться стеком на главный поток VCL, проверено на одном ресурсоемком проекте со 150 одновременно работающими и срущими в лог потоками.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=281216&amp;user=3232&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=3" class="addthx" data-post="281216"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 апреля 2011 01:14 &middot; Поправил: Isaev <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>Обращение к глобальным переменным только через критические секции, блокировки,... </I><br>Да, да... этот пример был для 1 потока, потому и не была учтена эта проблема.<br><I>PE_Kill пишет:<br>Synchronize тормозит вызывающий поток </I><br>я потому и задумался... если каждый поток будет на долго тормозиться, смысл от них<br><I>PE_Kill пишет:<br>могу предложить следующий трюк </I><br>Интересное решение, сделаю )<br><br><I>A V пишет:<br>я так понял нумерация строк зависит от порядка выполнения потоков </I><br>тут да, потому и путанка... в идеале не должна зависеть, появляется результат - прирост счётчика<br>как раз &quot;трюк&quot; PE_Kill&#039;а это решит<br><br><I>PE_Kill пишет:<br>По исходнику. Всё неправильно. </I><br>Надо было с чего-то начать <img src="img/smilies/s1.gif" alt=""><br>Сейчас нашёл приятную статью по теме: <noindex><a href="http://forum.vingrad.ru/forum/topic-60076/hl/%25D0%25BC%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE%25D0%25BF%25D0%25BE%25D1%2582%25D0%25BE%25D1%2587%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D1%258C/index.html" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br>Изучу, будет вторая попытка...
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=281222&amp;user=6946&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=4" class="addthx" data-post="281222"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 апреля 2011 03:23 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Можно LOCK dec Alive. (опкод F0 FE 0D xx xx xx xx, если размер переменной 1 байт, F0 FF 0D xx xx xx xx, если 4, 66 F0 FF 0D xx xx xx xx, если 2) То есть в простых случаях, применяя ассемблерные вставки с префиксом LOCK, отпадает необходимость думать о синхронизации.<br><br>По опыту - Дельфи достаточно крив в плане синхронизации потоков, если пользоваться стандартными компонентами, теми которые предлагает борланд. В частности, класс TSemaphore представляет собой вовсе не объект &quot;семафор&quot;. WinAPI здесь решает много проблем. А ассемблерные вставки с блокировкой шины, если такое уместно, оптимизируют! Поэтому давно не пользуюсь Дельфи.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=281228&amp;user=24257&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=5" class="addthx" data-post="281228"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 апреля 2011 10:12 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>DenCoder пишет:<br>По опыту - Дельфи достаточно крив в плане синхронизации потоков, если пользоваться стандартными компонентами, теми которые предлагает борланд. </I><br>По опыту, если писать в VCL приложении потоки на API, то имеем редкие и странные баги, которые можно годами отлавливать. Единственное с чем иногда приходится ковыряться это создание объектов внутри потоков, почему то некоторые работают корректно только если их создавать в контексте основного потока, приходится тогда делать синхронизацию для Create.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=281240&amp;user=3232&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=6" class="addthx" data-post="281240"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Enigma[/b]','')">Enigma</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 88.3 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.58'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8396">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 апреля 2011 11:50 <br><script type="text/javascript">QU('Enigma','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Enigma" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Так из опыта... Использовал EnterCriticalSection/LeaveCriticalSection для выполнения участка кода в многопотоковом приложении, в делфи, причем внутри этого кода было и создание классов, и динамические массивы, и АПИ, почти все что угодно, и никогда никаких проблем не было...<br><br>Зато были проблемы писания данных в файл в таком коде (скорее всего такая же проблема как и тут...), пишешь в один файл из двух потоков, в резальтате в файле непонятно что, данные из двух потоков перекрываются.. <br>Как вообще правильно писать в файл из нескольких потоков?<br><br>PS: операнды LOCK можно не использовать прямо в коде, есть же АПИ <br><br>function InterlockedIncrement(var Addend: Integer): Integer; stdcall;<br>function InterlockedDecrement(var Addend: Integer): Integer; stdcall;<br>function InterlockedExchange(var Target: Integer; Value: Integer): Integer; stdcall;<br>function InterlockedCompareExchange(var Destination: Longint; Exchange: Longint; Comperand: Longint): Longint stdcall;<br>function InterlockedExchangeAdd(Addend: PLongint; Value: Longint): Longint stdcall; overload;<br>function InterlockedExchangeAdd(var Addend: Longint; Value: Longint): Longint stdcall; overload;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=281247&amp;user=8396&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=7" class="addthx" data-post="281247"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 апреля 2011 12:00 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Enigma пишет:<br>и создание классов, и динамические массивы, и АПИ, почти все что угодно, и никогда никаких проблем не было </I><br>Ключевое слово здесь: <b>V</b>CL - <b>Visual</b> Component Library. С обычными классами такой проблемы нет, косяк кроется в потоконебезопасной организации кеша VCL. Простой пример - создай форму с ListView в режиме Report и потоков 50 на апи, которые будут с ним активно работать, добавлять/удалять/изменять данные и юзать поле Data, максимум через час вылезает отсос виолейшн.<br><br><I>Enigma пишет:<br>Как вообще правильно писать в файл из нескольких потоков? </I><br>Перекрываются в смысле накладываются друг на друга? Если структура лога не важна я использую WinApi и флешу буферы после записи. Иначе делаю на каждый поток по логу и если нужен общий, то объединяю их потом.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=281248&amp;user=3232&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=8" class="addthx" data-post="281248"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=8396" title="06-04-2011 09:12, ранг:78.4" target="_blank">Enigma</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Enigma[/b]','')">Enigma</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 88.3 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.58'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8396">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 апреля 2011 12:19 <br><script type="text/javascript">QU('Enigma','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Enigma" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>максимум через час вылезает отсос виолейшн. </I><br><br><img src="img/smilies/s1.gif" alt=""> Ясно! Кстати, видел в кое каком приложении (многие наверное тоже это видели...), и обеспечения нормальной работы многопоточности, используеются все 3 метода, EnterCriticalSection/LeaveCriticalSection + InterlockedExchange + CreateSemaphore/ReleaseSemaphore. Возможно имеет смысл повзаимствовать эту идеи и проверить ее на VCL.<br><br><I>PE_Kill пишет:<br>Перекрываются в смысле накладываются друг на друга? Если структура лога не важна я использую WinApi и флешу буферы после записи. Иначе делаю на каждый поток по логу и если нужен общий, то объединяю их потом. </I><br>Ага, просто покдадываются.. Пишется пол буфера из одного треда, потом пол буфера из второго, потом дописываются остатки...<br>Флешишь буферы это FlushFileBuffers...? Хм.. не знал такой АПИ, спасибо! Можно наверное еще файл открывать через ZwCreateFile/ZwOpenFile с параметром FILE_SEQUENTIAL_ONLY, надо протестировать..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=281249&amp;user=8396&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=9" class="addthx" data-post="281249"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 апреля 2011 13:09 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>Enigma пишет:<br>Возможно имеет смысл повзаимствовать эту идеи и проверить ее на VCL. </I><br>Не поможет. Т.к. это лишь разграничит доступ между потоками, а главный то поток ничего не знает о других. Поэтому борланд и сделал такой костыль (Synchronize), как в свое время и Application.ProcessMessages.<br><br><I>Enigma пишет:<br>Флешишь буферы это FlushFileBuffers...? </I><br>Ага, а то тоже бывало, что буферы накладывались.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=281253&amp;user=3232&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=10" class="addthx" data-post="281253"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]xShadow[/b]','')">xShadow</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 54.9 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.59'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=875">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 апреля 2011 18:46 <br><script type="text/javascript">QU('xShadow','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xShadow" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Запись в файл из нескольких потоков будет тормозить работу, хотя если данных не много, то и не заметно будет. Критические секции тормозят все потоки до выхода из неё, можно использовать мьютекс для синхронизации записи в файл. Все это проверял на многопоточном приложении, с кучей вспомогательных exe файлов пишущих все в один файл, итог как описано выше все приложения пишут в свой файл, потом все сливается в один. Если использовать winapi createfile, FileWrite для записи в один файл, то можно не синхронизировать, ос делает это сама, проверял.<br>По поводу многопоточности в делфи, есть весьма продвинутые исходники http://otl.17slon.com/download.htm можно скачать архив, но лучше по svn. В коммерческой разработке использовались весьма успешно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=281390&amp;user=875&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=11" class="addthx" data-post="281390"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 апреля 2011 07:24 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>xShadow пишет:<br>Запись в файл из нескольких потоков будет тормозить работу, хотя если данных не много, то и не заметно будет. </I><br>Если использовать PostMessage как я выше писал, то пишет в файл только один поток, он как бы является менеджером логов. Поэтому тормозов нет, хотя винчестер конечно насилуется.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=281414&amp;user=3232&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=12" class="addthx" data-post="281414"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Enigma[/b]','')">Enigma</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 88.3 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.58'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8396">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 апреля 2011 14:33 <br><script type="text/javascript">QU('Enigma','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Enigma" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Да, попробовал у себя использовать FlushFileBuffers, все стало рабоать наверное раз в 100 медленнее... хотя теперь без ошибок. Данных у меня как раз пишется много..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=281445&amp;user=8396&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=13" class="addthx" data-post="281445"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 апреля 2011 15:58 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
FlushFileBuffers - только хард мучать. Я нашел эту функу полезной только когда приложение бсодит и надо лог о последних действиях записать. Без нее вроде виндовый кеш нормально рулит...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=281449&amp;user=24257&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=14" class="addthx" data-post="281449"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 апреля 2011 16:31 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Без нее вроде виндовый кеш нормально рулит... </I><br>С потоками не нормально.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=281455&amp;user=3232&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=15" class="addthx" data-post="281455"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 апреля 2011 19:29 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Писать в файл несколькими потоками на мой взгляд вообще не самый лучший  вариант их применения. Один вполне справится. Понимаю, если нужно например процессы анализировать на предмет нужной сигнатуры. <br>Самое главное грамотно распорядится  их количеством и назначением. А синхронизация - вышеупомянутый LOCK и через глобальные переменные(мне в VC++ этого хватало). Кстати сама мелкософт говорит что мьютексы, семафоры это долго все, критические секции самые быстрые(в rsdn  статья была за синхронизацию)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=281460&amp;user=26651&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=16" class="addthx" data-post="281460"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 апреля 2011 20:00 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>Enigma пишет:<br>попробовал у себя использовать FlushFileBuffers, все стало рабоать наверное раз в 100 медленнее... </I><br>Ну так конечно...<br>А если использовать 1 раз в конце не то же самое будет?
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=281462&amp;user=6946&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=17" class="addthx" data-post="281462"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]tomac[/b]','')">tomac</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 65.3 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.82'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6470">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 апреля 2011 11:14 <br><script type="text/javascript">QU('tomac','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tomac" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17995.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>Isaev</b><br>Что значит, в конце? Либо сбрасывать буфера после каждой записи каждым потоком, и тогда запись медленная, но последовательная. Или винда сбрасывает буферы сама, когда файл закрывается, или когда буферы переполняются. И тут быстро, но мешанина.<br>А по сабжу - правильно PE_Kill говорит, я думаю. Один поток и postmessage. Ну или нафигачить еще один поток, сделать лист строк, которые писать, лочить его в потоках, кидать в него строку, разлочивать. И в новом потоке лочить, клонировать, очищать, анлочить, писать на хард клона.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=281591&amp;user=6470&amp;forum_n=6&amp;topic=17995.html&amp;page=0&amp;anchor=18" class="addthx" data-post="281591"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Многопоточность в Delphi</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#19" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="17995">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=17995" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
