<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Софт управления контроллером под HASP&#039;ом - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Привет ломателям донглов. Есть софт. Софт несколько приватен, поэтому выложить его не могу. К софту прилагается ключ HASP HL Pro. Сложилось впечатление, что софт умеет работать с ключами двух типов - Aladdin HASP и Rainbow">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a>, <a target='_blank' href='?action=userinfo&amp;user=55940'>exp50848</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Софт управления контроллером под HASP&#039;ом</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 августа 2011 16:42 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18969.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Привет ломателям донглов.<br><br>Есть софт. Софт несколько приватен, поэтому выложить его не могу. К софту прилагается ключ HASP HL Pro. Сложилось впечатление, что софт умеет работать с ключами двух типов - Aladdin HASP и Rainbow Technologies  Sentinel (более того, я так понял обе конторы подмял под себя SafeNet).<br><br>Итак, что накопал. Во время работы данного софта обращений к ключу не обнаружено (скорее всего их нет). Но если дернуть ключ во время работы, софтина подвисает (я полагаю так ведет оборону сам драйвер хаспа). Насколько я понял, обращение к ключу происходит на FormCreate. Сначала идет обращение к ключу HASP и сразу за ним проверка строки ошибки с шаблонной строкой &quot;OK&quot;:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;aOk&nbsp;<span class="hl_comment">; &quot;OK&quot;</span></li><li class="hl_l1"><span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_9C<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;strcpy2</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_function"><b>inc</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_CC<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_D8<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">344</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">4</span></li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;HASP_test</li><li class="hl_l0"><span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_98<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;strcpy2</li><li class="hl_l0"><span class="hl_function"><b>inc</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_CC<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>edx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Check HASP error message</span></li><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;@System@AnsiString@<span class="hl_char">$</span>beql<span class="hl_char">$</span>xqqrrx17System@AnsiString&nbsp;<span class="hl_comment">; System::AnsiString::operator==(System::AnsiString &amp;)</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">al</span></li><li class="hl_l1"><span class="hl_function"><b>jnz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_nextNormalCode</li>        </ol>
    </div>
</div></div>
<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">HASP_test&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;<span class="hl_function">near</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">arg_0<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">8</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;hasp_handle</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;vendor_code&nbsp;<span class="hl_comment">; &quot;aYkhErjfgz/VEqShjFt//uRT3n06h+hRyt4H74fd&quot;...  текст я изменил, всего 940 символ, включая знак '=' в конце</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_0<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;check_hasp_key_state</li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dword_9605C0<span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;dword_9605C0</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;GetMessageByErrorCode&nbsp;<span class="hl_comment">; здесь формируется сообщение об ошибке</span></li><li class="hl_l1"><span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_function">retn</span></li><li class="hl_l0">HASP_test&nbsp;<span class="hl_function">endp</span></li>        </ol>
    </div>
</div></div>
<br>Как мне подсказали опытные ломатели хасп, строка &quot;aYkhErjfgz/VEqShjFt//uRT3n06h+hRyt4H74fd&lt;...&gt;=&quot; представляет собой <strike>некий пароль для доступа к ключу</strike> <b>vendor code</b>. В дебрях check_hasp_key_state есть и AES и MD5, что очень характерно для HASP. Если строка сформированная GetMessageByErrorCode не соответствует строке &quot;OK&quot;, выполнение передается на следующий кусок кода:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">openSentinel<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;openSentinelDevice&nbsp;<span class="hl_comment">; открывается хендл на &quot;\\.\RNBODRV0&quot;</span></li><li class="hl_l0"><span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ax</span></li><li class="hl_l1"><span class="hl_function"><b>jnz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openSentinel</li><li class="hl_l0"><span class="hl_function"><b>jmp</b></span>&nbsp;_askSentinelKey</li><li class="hl_l1">_printError<span class="hl_char">:</span></li><li class="hl_l0">SEND_ERROR_MESSAGE</li><li class="hl_l1">_askSentinelKey<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;waitSentinelKeyState</li><li class="hl_l1"><span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ax</span></li><li class="hl_l0"><span class="hl_function"><b>jnz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_printError</li><li class="hl_l1">_nextNormalCode<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_char">&lt;</span>КОД&nbsp;ДЛЯ&nbsp;ДАЛЬНЕЙШЕЙ&nbsp;РАБОТЫ&nbsp;ПРОГРАММЫ<span class="hl_char">&gt;</span></li>        </ol>
    </div>
</div></div>
<br>Итак, код выше выполняется только в том случае, если почему-то произошла ошибка. Естественно в моем случае этой ошибкой является отсутствие вставленного в машину ключа. Машина на которой есть рабочий ключ хаспа подключена к &quot;суровому&quot; станку. У меня особо нет возможности для экспериментов на той машинке, у себя же развернул виртуалку.<br><br>А в чем собственно вопрос? А вопросы будут такие:<br><br>1. Дейсвительно ли все так, как я описал? Т.е. верно ли, что представленная схема это реально связка HASP+Sentinel по принципу &quot;что есть, с тем и работает&quot;? Если нужны дополнительные данные (кроме драйверов, с которыми работают эти куски кода), могу попробовать достать.<br>2. Во время эксперимента на боевой машине, я пропатчил переход &quot;jnz     _printError&quot;, и софт там завис. Потом удалил на своей машине драйвер Sentinel и понял, что виснуть может и на цикле &quot;jnz     openSentinel&quot;. Т.е. как пропатчить правильно я то конечно понимаю (либо убить оба цикла, либо сразу после сравнения строк поставить железный JMP вместо условного JNZ), но во время экспериментов выяснилось, что HASP жестко обороняется. Вот что я под этим имею в виду:<br>2.1) восстановить файл из бекапа не получается, вылезает ошибка, что файл уже используется (при этом пропатчить его никаких проблем <img src="img/smilies/s6.gif" alt=""> );<br>2.2) ни один из файлов в каталоге нельзя переименовать (зато можно переместить, можно добавить произвольный файл);<br>2.3) нельзя переименовать какой-либо файл в каталоге, изменив его разрешение на .exe, можно только скопировать его на нейтральную территорию, а затем пропатчить если надо, переименовать и скопировать обратно.<br><br>Отсюда следующий вопрос: как мне запустить патченную версию из этого же каталога, т.е. что умеет HASP? Допустим я убедился, что эта софтина &quot;научилась&quot; работать без ключа, как вообще вынести драйвера HASP с их дебильной защитой (дебильной в плане рациональности)?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290717&amp;user=2449&amp;forum_n=1&amp;topic=18969.html&amp;page=0&amp;anchor=1" class="addthx" data-post="290717"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 августа 2011 16:50 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18969.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Скачай вот эту хреньку<br>http://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=6248&amp;page=7#12<br><br>и сразу поймешь что там за 940 символов и как правильно функции называются. Я даже с помощью этой хреньки и память ключа всю считал, и эту память в ключе подредактировал и проэмулил все HaspEncrypt/Decrypt
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=290718&amp;user=3232&amp;forum_n=1&amp;topic=18969.html&amp;page=0&amp;anchor=2" class="addthx" data-post="290718"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 августа 2011 17:06 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18969.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
У меня цель немного другая. Мне не особо интересно, что это за 940 символов. Мне сказали, что это ключ, я этому верю. В данном случае явно есть возможность отвязать от ключа патчем одного байта. И если так, то очень хорошо. Софт слишком кривой, чтобы полагаться на него и дальше. Конечная цель вообще обойтись без ключа, а затем и без проги (сделать свою софтину управления контроллером станка).<br><br>Т.е. основной вопрос, что вообще умеет хасп? Может ли спалить свой же ключ в целях безопасности? Может ли заблокировать систему, так что ее потом только сносить придется? И как корректно удалить драйвер хаспа?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290720&amp;user=2449&amp;forum_n=1&amp;topic=18969.html&amp;page=0&amp;anchor=3" class="addthx" data-post="290720"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 августа 2011 21:56 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18969.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>int</b><br>По вашему описанию я понял, что вся суть защиты заключается в вызовах так называемых HASP API. Они вручную расставляются на этапе компиляции разработчиком, так что хасп в таком случае может ровно столько, сколько прописано в SDK. В нём можно найти прототипы, примеры вызова и описание возможностей всех защитных функций. Лежит он на оф. сайте хаспа. Весь дистрибутив весит 1,4 Гб, но если попросите, то могут выложить лишь pdf с описанием АПИ хаспа. Я б сам выложил, но мой рабочий жёсткий сейчас временно недоступен. <br><br>А, вообще, как показывает мне мой скромный опыт, то ИМХО виной всему Sentinel. Алладиновский ключ так себя не ведёт.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=290739&amp;user=6336&amp;forum_n=1&amp;topic=18969.html&amp;page=0&amp;anchor=4" class="addthx" data-post="290739"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 августа 2011 22:04 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18969.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
С SDK благодаря прямой наводке <b>PE_Kill</b>&#039;а я уже разобрался. Реально используется только hasp_login. Т.е. имеем защиту по типу IsDonglePresent. Просто реально интересно узнать от тех, кто имел опыт распаковки драйвера, на что у меня сейчас сил и опыта не хватит (конверт в ядре это для меня крутой уровень), что он может. Т.е. насколько опасны такие эксперименты? Может он поймает факт модификации софта и сделает что-нибудь интересное. Например, поломает ключ или завесит систему через пару дней (тайм-бомба). Поэтому я сразу и спросил, как избавится от драйвера. Я нагуглил один способ (вроде бы штатный), попробую его.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290740&amp;user=2449&amp;forum_n=1&amp;topic=18969.html&amp;page=0&amp;anchor=5" class="addthx" data-post="290740"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 августа 2011 22:52 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18969.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
афаик, драйвера ни у хаспа, ни тем более у сента не несут никаких дополнительных функций окромя транспортных. Так что все блокировки, проверки целостности, защита каталога и прочее - действие сторонних програм либо, что более вероятно, сервисов.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=290744&amp;user=11966&amp;forum_n=1&amp;topic=18969.html&amp;page=0&amp;anchor=6" class="addthx" data-post="290744"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 августа 2011 02:18 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18969.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Едем дальше. Собственно, основной функционал этой софтины это управление контроллером одной железки. Как я уже выше обозначил, конечная цель дернуть ключевые алгоритмы из этой программы.<br><br>Напоролся на очень интересный момент. Железка подцеплена к <b>COM</b>-порту. А вот программа работает с портами ввода/вывода с номерами 0x378 и 0x37A, что соответствует <b>LPT</b>-портам. Чудеса? Может кто-нибудь этот момент прокомментировать?<br><br>P.S. Не знаю зачем Archer тему перетащил. Вроде ковыряю конкретную программу, а HASP по-большому счету вообще не причем.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290752&amp;user=2449&amp;forum_n=1&amp;topic=18969.html&amp;page=0&amp;anchor=7" class="addthx" data-post="290752"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 августа 2011 09:43 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18969.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<i class=x>Железка подцеплена к COM-порту. А вот программа работает с портами ввода/вывода с номерами 0x378 и 0x37A, что соответствует LPT-портам. Чудеса? Может кто-нибудь этот момент прокомментировать?</i><br>А ключ в какой порт всунут?
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=290758&amp;user=20406&amp;forum_n=1&amp;topic=18969.html&amp;page=0&amp;anchor=8" class="addthx" data-post="290758"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 августа 2011 10:02 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18969.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>int пишет:<br>Железка подцеплена к COM-порту. А вот программа работает с портами ввода/вывода с номерами 0x378 и 0x37A, что соответствует LPT-портам </I><br>Может используется эмуль COM&gt;LPT ? (моё предположение на основе того что есть эмуль USB&gt;COM).
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=290759&amp;user=17432&amp;forum_n=1&amp;topic=18969.html&amp;page=0&amp;anchor=9" class="addthx" data-post="290759"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 августа 2011 10:45 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18969.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<i class=x>А вот программа работает с портами ввода/вывода с номерами 0x378 и 0x37A</i><br>Думаю, ошибся. Эмулятор обычно порты не эмулирует, он выше сидит. Порты может проверять только на предмет наличия ключа под этот интерфейс и все. Помню его выполняли в виде переходника, на который дальше вешали принтер.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290760&amp;user=4072&amp;forum_n=1&amp;topic=18969.html&amp;page=0&amp;anchor=10" class="addthx" data-post="290760"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 августа 2011 13:22 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18969.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Какой нафиг эмулятор и ключ? Вы о чем? Софт уже без ключа работает, я там один переход пропатчил. Я сейчас изучаю протокол взаимодействия программы и станка (которым программа и управляет).<br><br><I>Vamit пишет:<br>А ключ в какой порт всунут? </I><br>Ключ был USB-шный, хасповский.<br><br><I>tundra37 пишет:<br>Думаю, ошибся. </I><br>Не, не ошибся. Там реально используются только эти два порта.<br><br>На самом деле я обнаружил что в компьютер вставлены два контроллера LPT портов, порты замкнуты между собой каким-то шлейфом (вроде без микросхем внутри). Отдельно от них есть контроллер COM-портов. К одному из них зацеплен станок.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290771&amp;user=2449&amp;forum_n=1&amp;topic=18969.html&amp;page=0&amp;anchor=11" class="addthx" data-post="290771"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 августа 2011 13:49 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18969.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Если есть железячный анализатор, посмотри трафик на этом шлейфе. Возможно, там схема<br>твой софт (front-end gui) &lt;-&gt; lpt0 (out) &lt;-&gt; lpt1 (in) &lt;-&gt; служба, либо другой сервис (типа сервер-диспетчер, back-end) &lt;-&gt; com &lt;-&gt; твой агрегат
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=290773&amp;user=11966&amp;forum_n=1&amp;topic=18969.html&amp;page=0&amp;anchor=12" class="addthx" data-post="290773"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 августа 2011 14:04 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18969.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>r_e</b><br>У меня такое же предположение, только склонялся к мысли что в твоей схеме вместо back-end служит обычный шнурок сцепляющий внутри корпуса LPT плату с COM платой. Хотя контроллер COM-портов выглядит вполне себе стандартно. В принципе похоже на то, что раньше в цепи было два компа. Производитель решил объединить все в один, но не стал переписывать софт.<br><br>P.S. Пошел вскрывать корпус. <img src="img/smilies/s8.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290774&amp;user=2449&amp;forum_n=1&amp;topic=18969.html&amp;page=0&amp;anchor=13" class="addthx" data-post="290774"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 августа 2011 16:09 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18969.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Вскрытие корпуса разрешило все вопросы.<br><br>LPT-порт на материнской плате &lt;--&gt; шлейф на планку с внешним LPT-портом &lt;--&gt; внешний шлейф LPT&lt;-&gt;LPT &lt;--&gt; контроллер с внешним LPT-портом, внутри питание от материнской платы и шлейф к другой планке &lt;--&gt; планка с разветвлением на два COM-порта &lt;--&gt; нуль-модемный кабель от станка до этой планки.<br><br>Таким образом, все выглядит как какой-то девайс подключенный к LPT-порту - это единственный канал данных.<br><br>На этом изучение софтины завершено (изучен протокол управления через LPT-порт), всех благодарю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290777&amp;user=2449&amp;forum_n=1&amp;topic=18969.html&amp;page=0&amp;anchor=14" class="addthx" data-post="290777"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Софт управления контроллером под HASP&#039;ом</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=18969" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
