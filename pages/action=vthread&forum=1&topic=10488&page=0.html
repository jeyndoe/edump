<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Исследование чужого приложения - COM - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Привет всем, может кто-нибудь поможет? Внедрил свою DLL в чужой процесс, проанализировав зависимости импортируемых библиотек и функции нашел функцию получения интерфейса главного приложения. в проект включил tlb файл выдранный из">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41556'>subword</a>, <a target='_blank' href='?action=userinfo&amp;user=55853'>rtsgreg1989</a>, <a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Исследование чужого приложения - COM</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Twist[/b]','')">Twist</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.02'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=5472">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2007 17:33 <br><script type="text/javascript">QU('Twist','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Twist" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10488.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Привет всем, может кто-нибудь поможет?<br>Внедрил свою DLL в чужой процесс, проанализировав зависимости импортируемых библиотек и функции нашел функцию получения интерфейса главного приложения. в проект включил tlb файл выдранный из той же библиотеки, получил указатель на интерфейс, убедился в правельности полученного результата вызвав пару методов. Но вот проблема не могу получить указатели на другие интерфейсы - решил поставить перехватчики на некоторые методы интерфейса по статье rsdn.ru/article/com/comintercept.xml?print#EFC и тоже лажа. Любые идеи.<img src="img/smilies/s1.gif" alt=""><br>Вот коды:<br>/////////////////////////////Часть файла TLB нужного интерфеса//////////////<br>// в начале <br>MCore;<br>GUID = {AE0A4503-EB6C-4A5B-BF8E-9D973EB73A04};<br><br>...<br><br>Dispatch MIDApp;<br>GUID = {613AC42F-72C3-42A1-8184-AC35D5B61C2B};<br>  function QueryInterface(riid: ^GUID; out ppvObj: ^^VOID); stdcall;<br>  function AddRef: UI4; stdcall;<br>  function Release: UI4; stdcall;<br>  function GetTypeInfoCount(out pctinfo: ^UINT); stdcall;<br>  function GetTypeInfo(itinfo: UINT; lcid: UI4; out pptinfo: ^^VOID); stdcall;<br>  function GetIDsOfNames(riid: ^GUID; rgszNames: ^^I1; cNames: UINT; lcid: UI4; out rgdispid: ^I4); stdcall;<br>  function Invoke(dispidMember: I4; riid: ^GUID; lcid: UI4; wFlags: UI2; pdispparams: ^DISPPARAMS; out pvarResult: ^Variant; out pexcepinfo: ^EXCEPINFO; out puArgErr: ^UINT); stdcall;<br>  function AttachEvent(pEventName: BSTR; pHandler: IDispatch): ^MIDEventHandler; stdcall;<br>  function Init(out bszConfigDir: BSTR); stdcall;<br>  function Shutdown: Bool; stdcall;<br>  function CreateOwner(bsOwnerName: BSTR; flags: I4): ^MIDOwner; stdcall;<br>  function GetService(bstrServiceId: BSTR): IUnknown; stdcall;<br>  function RegisterLastOwner(pOwner: ^MIDOwner); stdcall;<br><br>Dispatch MIDScriptable;<br>GUID = {431890FC-B324-4553-9DF5-93458C620587};<br>  function QueryInterface(riid: ^GUID; out ppvObj: ^^VOID); stdcall;<br>  function AddRef: UI4; stdcall;<br>  function Release: UI4; stdcall;<br>  function GetTypeInfoCount(out pctinfo: ^UINT); stdcall;<br>  function GetTypeInfo(itinfo: UINT; lcid: UI4; out pptinfo: ^^VOID); stdcall;<br>  function GetIDsOfNames(riid: ^GUID; rgszNames: ^^I1; cNames: UINT; lcid: UI4; out rgdispid: ^I4); stdcall;<br>  function Invoke(dispidMember: I4; riid: ^GUID; lcid: UI4; wFlags: UI2; pdispparams: ^DISPPARAMS; out pvarResult: ^Variant; out pexcepinfo: ^EXCEPINFO; out puArgErr: ^UINT); stdcall;<br>  function AttachEvent(pEventName: BSTR; pHandler: IDispatch): ^MIDEventHandler; stdcall;<br><br>Dispatch MIDContactList;<br>GUID = {D7A21EA9-9701-4A3E-997D-4D0F2E4306A1};<br>  function QueryInterface(riid: ^GUID; out ppvObj: ^^VOID); stdcall;<br>  function AddRef: UI4; stdcall;<br>  function Release: UI4; stdcall;<br>  function GetTypeInfoCount(out pctinfo: ^UINT); stdcall;<br>  function GetTypeInfo(itinfo: UINT; lcid: UI4; out pptinfo: ^^VOID); stdcall;<br>  function GetIDsOfNames(riid: ^GUID; rgszNames: ^^I1; cNames: UINT; lcid: UI4; out rgdispid: ^I4); stdcall;<br>  function Invoke(dispidMember: I4; riid: ^GUID; lcid: UI4; wFlags: UI2; pdispparams: ^DISPPARAMS; out pvarResult: ^Variant; out pexcepinfo: ^EXCEPINFO; out puArgErr: ^UINT); stdcall;<br>  function AttachEvent(pEventName: BSTR; pHandler: IDispatch): ^MIDEventHandler; stdcall;<br>  function InsertUser(pUser: ^MIDUser; bsGroupName: BSTR; nFlags: UI4; eUserType: MEUserType; bszInsertionNote: BSTR; pSink: IUnknown): ^MIDRequest; stdcall;<br>  function RemoveUser(pIUser: ^MIDUser; pSink: IUnknown): ^MIDRequest; stdcall;<br>  function ReplaceUser(pOldUser: ^MIDUser; pNewUser: ^MIDUser; pSink: IUnknown): ^MIDRequest; stdcall;<br>  function SendAuthorizationRequest(pUser: ^MIDUser; bszMessage: BSTR); stdcall;<br>  function PreauthorizeUser(pUser: ^MIDUser); stdcall;<br>  function FindUser(bszName: BSTR; nFlags: UI4): ^MIDUser; stdcall;<br>  function FindUsers(bszName: BSTR; nFlags: UI4): IDispatch; stdcall;<br>  function GetFrequentUsers(out nMax: UI4; out nFlags: UI4): ^MIDCollection; stdcall;<br>  function FindGroup(bszName: BSTR): ^MIDGroup; stdcall;<br>  function InsertGroup(bstrName: BSTR; pos: INT; pSink: IUnknown): ^MIDRequest; stdcall;<br>  function RemoveGroup(bstrName: BSTR; pSink: IUnknown): ^MIDRequest; stdcall;<br>  function MoveGroup(bstrName: BSTR; pos: INT; pSink: IUnknown): ^MIDRequest; stdcall;<br>  function MoveUser(pUser: ^MIDUser; bszGroupName: BSTR; pSink: IUnknown): ^MIDRequest; stdcall;<br>  function SortGroups; stdcall;<br><br>...<br>// в конце<br>CoClass MCApplication;<br>GUID = {731A9926-454E-494F-A2AD-D2BC796BEDEA};<br><br>...<br><br>/////////////////////////////Часть файла TLH сгенерированного Microsoft Visual//////////////<br><br>...<br><br>struct __declspec(uuid(&quot;613ac42f-72c3-42a1-8184-ac35d5b61c2b&quot;))<br>MIDApp : MIDScriptable<br>{<br>    //<br>    // Wrapper methods for error-handling<br>    //<br><br>    HRESULT Init (<br>        _bstr_t bszConfigDir );<br>    VARIANT_BOOL Shutdown ( );<br>    MIDOwnerPtr CreateOwner (<br>        _bstr_t bsOwnerName,<br>        long flags );<br>    IUnknownPtr GetService (<br>        _bstr_t bstrServiceId );<br>    HRESULT RegisterLastOwner (<br>        struct MIDOwner * pOwner );<br><br>    //<br>    // Raw methods provided by interface<br>    //<br><br>      virtual HRESULT __stdcall raw_Init (<br>        /*[in]*/ BSTR bszConfigDir ) = 0;<br>      virtual HRESULT __stdcall raw_Shutdown (<br>        /*[out,retval]*/ VARIANT_BOOL * pbCanceled ) = 0;<br>      virtual HRESULT __stdcall raw_CreateOwner (<br>        /*[in]*/ BSTR bsOwnerName,<br>        /*[in]*/ long flags,<br>        /*[out,retval]*/ struct MIDOwner * * ppIOwner ) = 0;<br>      virtual HRESULT __stdcall raw_GetService (<br>        /*[in]*/ BSTR bstrServiceId,<br>        /*[out,retval]*/ IUnknown * * ppIService ) = 0;<br>      virtual HRESULT __stdcall raw_RegisterLastOwner (<br>        /*[in]*/ struct MIDOwner * pOwner ) = 0;<br>};<br><br>struct __declspec(uuid(&quot;431890fc-b324-4553-9df5-93458c620587&quot;))<br>MIDScriptable : IDispatch<br>{<br>    //<br>    // Wrapper methods for error-handling<br>    //<br><br>    MIDEventHandlerPtr AttachEvent (<br>        _bstr_t pEventName,<br>        IDispatch * pHandler );<br><br>    //<br>    // Raw methods provided by interface<br>    //<br><br>      virtual HRESULT __stdcall raw_AttachEvent (<br>        /*[in]*/ BSTR pEventName,<br>        /*[in]*/ IDispatch * pHandler,<br>        /*[out,retval]*/ struct MIDEventHandler * * ppHandler ) = 0;<br>};<br><br>struct __declspec(uuid(&quot;d7a21ea9-9701-4a3e-997d-4d0f2e4306a1&quot;))<br>MIDContactList : MIDScriptable<br>{<br>    //<br>    // Wrapper methods for error-handling<br>    //<br><br>    MIDRequestPtr InsertUser (<br>        struct MIDUser * pUser,<br>        _bstr_t bsGroupName,<br>        unsigned long nFlags,<br>        enum MEUserType eUserType,<br>        _bstr_t bszInsertionNote,<br>        IUnknown * pSink );<br>    MIDRequestPtr RemoveUser (<br>        struct MIDUser * pIUser,<br>        IUnknown * pSink );<br>    MIDRequestPtr ReplaceUser (<br>        struct MIDUser * pOldUser,<br>        struct MIDUser * pNewUser,<br>        IUnknown * pSink );<br>    HRESULT SendAuthorizationRequest (<br>        struct MIDUser * pUser,<br>        _bstr_t bszMessage );<br>    HRESULT PreauthorizeUser (<br>        struct MIDUser * pUser );<br>    MIDUserPtr FindUser (<br>        _bstr_t bszName,<br>        unsigned long nFlags );<br>    IDispatchPtr FindUsers (<br>        _bstr_t bszName,<br>        unsigned long nFlags );<br>    MIDCollectionPtr GetFrequentUsers (<br>        unsigned long nMax,<br>        unsigned long nFlags );<br>    MIDGroupPtr FindGroup (<br>        _bstr_t bszName );<br>    MIDRequestPtr InsertGroup (<br>        _bstr_t bstrName,<br>        int pos,<br>        IUnknown * pSink );<br>    MIDRequestPtr RemoveGroup (<br>        _bstr_t bstrName,<br>        IUnknown * pSink );<br>    MIDRequestPtr MoveGroup (<br>        _bstr_t bstrName,<br>        int pos,<br>        IUnknown * pSink );<br>    MIDRequestPtr MoveUser (<br>        struct MIDUser * pUser,<br>        _bstr_t bszGroupName,<br>        IUnknown * pSink );<br>    HRESULT SortGroups ( );<br><br>    //<br>    // Raw methods provided by interface<br>    //<br><br>      virtual HRESULT __stdcall raw_InsertUser (<br>        /*[in]*/ struct MIDUser * pUser,<br>        /*[in]*/ BSTR bsGroupName,<br>        /*[in]*/ unsigned long nFlags,<br>        /*[in]*/ enum MEUserType eUserType,<br>        /*[in]*/ BSTR bszInsertionNote,<br>        /*[in]*/ IUnknown * pSink,<br>        /*[out,retval]*/ struct MIDRequest * * ppRequest ) = 0;<br>      virtual HRESULT __stdcall raw_RemoveUser (<br>        /*[in]*/ struct MIDUser * pIUser,<br>        /*[in]*/ IUnknown * pSink,<br>        /*[out,retval]*/ struct MIDRequest * * ppRequest ) = 0;<br>      virtual HRESULT __stdcall raw_ReplaceUser (<br>        /*[in]*/ struct MIDUser * pOldUser,<br>        /*[in]*/ struct MIDUser * pNewUser,<br>        /*[in]*/ IUnknown * pSink,<br>        /*[out,retval]*/ struct MIDRequest * * ppRequest ) = 0;<br>      virtual HRESULT __stdcall raw_SendAuthorizationRequest (<br>        /*[in]*/ struct MIDUser * pUser,<br>        /*[in]*/ BSTR bszMessage ) = 0;<br>      virtual HRESULT __stdcall raw_PreauthorizeUser (<br>        /*[in]*/ struct MIDUser * pUser ) = 0;<br>      virtual HRESULT __stdcall raw_FindUser (<br>        /*[in]*/ BSTR bszName,<br>        /*[in]*/ unsigned long nFlags,<br>        /*[out,retval]*/ struct MIDUser * * ppIUser ) = 0;<br>      virtual HRESULT __stdcall raw_FindUsers (<br>        /*[in]*/ BSTR bszName,<br>        /*[in]*/ unsigned long nFlags,<br>        /*[out,retval]*/ IDispatch * * ppIUserCollection ) = 0;<br>      virtual HRESULT __stdcall raw_GetFrequentUsers (<br>        /*[in]*/ unsigned long nMax,<br>        /*[in]*/ unsigned long nFlags,<br>        /*[out,retval]*/ struct MIDCollection * * ppIUserCollection ) = 0;<br>      virtual HRESULT __stdcall raw_FindGroup (<br>        /*[in]*/ BSTR bszName,<br>        /*[out,retval]*/ struct MIDGroup * * ppIGroup ) = 0;<br>      virtual HRESULT __stdcall raw_InsertGroup (<br>        /*[in]*/ BSTR bstrName,<br>        /*[in]*/ int pos,<br>        /*[in]*/ IUnknown * pSink,<br>        /*[out,retval]*/ struct MIDRequest * * pRequest ) = 0;<br>      virtual HRESULT __stdcall raw_RemoveGroup (<br>        /*[in]*/ BSTR bstrName,<br>        /*[in]*/ IUnknown * pSink,<br>        /*[out,retval]*/ struct MIDRequest * * pRequest ) = 0;<br>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=168736&amp;user=5472&amp;forum_n=1&amp;topic=10488.html&amp;page=0&amp;anchor=1" class="addthx" data-post="168736"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Twist[/b]','')">Twist</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.02'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=5472">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2007 17:37 <br><script type="text/javascript">QU('Twist','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Twist" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10488.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
////// ПРОДОЛЖЕНИЕ НЕ ХВАТИЛО МЕСТА ДЛЯ ПОЛНОГО СООБЩЕНИЯ/////////////////<br>      virtual HRESULT __stdcall raw_MoveUser (<br>        /*[in]*/ struct MIDUser * pUser,<br>        /*[in]*/ BSTR bszGroupName,<br>        /*[in]*/ IUnknown * pSink,<br>        /*[out,retval]*/ struct MIDRequest * * pRequest ) = 0;<br>      virtual HRESULT __stdcall raw_SortGroups ( ) = 0;<br>};<br><br>...<br><br>extern &quot;C&quot; const GUID __declspec(selectany) IID_MIDApp =<br>    {0x613ac42f,0x72c3,0x42a1,{0x81,0x84,0xac,0x35,0xd5,0xb6,0x1c,0x2b}}; <br>extern &quot;C&quot; const GUID __declspec(selectany) IID_MIDScriptable =<br>    {0x431890fc,0xb324,0x4553,{0x9d,0xf5,0x93,0x45,0x8c,0x62,0x05,0x87}}; <br>extern &quot;C&quot; const GUID __declspec(selectany) IID_MIDContactList =<br>    {0xd7a21ea9,0x9701,0x4a3e,{0x99,0x7d,0x4d,0x0f,0x2e,0x43,0x06,0xa1}}; <br><br>...<br><br>///////////////////////////////Исходный код в DLL  внедренной в чужой процесс///////////////////////////////<br>//код получения нужного интерфейса:<br><br>#import &quot;test.tlb&quot; no_namespace named_guids<br><br>typedef MIDApp* (__cdecl *LPGETMIDAPP)(void);<br><br>#define		MCoreDLL		TEXT(&quot;MCoreLib.dll&quot;)<br><br>void test1()<br>{<br>        CoInitialize(NULL);<br><br>        HMODULE _hMCore	= GetModuleHandle(MCoreDLL);<br>	LPGETMIDAPP GetMIDAppProc = (LPGETMIDAPP)GetProcAddress(_hMCore,&quot;?GetApp@MNAppUtils@@YAPAUMIDApp@@ XZ&quot;);<br>       //?GetApp@MNAppUtils@@YAPAUMIDApp@@XZ - функция в MCoreLib.dll возвращающая нужный интерфейс<br><br>	CComPtr&lt;MIDApp&gt; pMIDApp = GetMIDAppProc(); // Все ок получил интерфейс<br>        if(pMIDApp==NULL)<br>           return;<br><br>	CComQIPtr&lt;MIDScriptable&gt; pMIDScriptable = pMIDApp;// тоже нормально отрабатывает<br><br>        CComQIPtr&lt;MIDUser&gt; pMIDUser = pMIDScriptable; // NULL<br>        CComQIPtr&lt;MIDContactList&gt; pMIDContactList = pMIDScriptable; // NULL<br><br>        HRESULT Result = pMIDApp-&gt;Shutdown();// работает ок<br>	if( FAILED(Result) )<br>		return;<br><br>        CoUninitialize();<br>}<br><br>функция Shutdown работает отлично, но вот QueryInterface с любым другим GUID из того же TLB возвращает E_NOINTERFACE.<br>Возможно что получение интерфейсов происходит через GetService но ведь неизвестно что нужно в нее передавать.<br>Решил её перехватить по выше указанной статье из RSDN но в самом начале облом:<br><br>/////////////////получение ICallInterceptor//////////////////<br>#include &lt;callobj.h&gt;<br>CComModule _Module;<br>void test2()<br>{<br>  _Module.Init(0, 0 );<br>  {<br>    CComPtr&lt;MIDApp&gt; spFoo;<br>    HRESULT hr = spFoo.CoCreateInstance(__uuidof(MIDApp)); // возращает что класс не зарегистрирован<br><br>    CComPtr&lt;ICallInterceptor&gt; spInt;<br>    hr = CoGetInterceptor(__uuidof(MIDApp), 0, __uuidof(ICallInterceptor), // возвращает что файл не найден<br>      reinterpret_cast&lt;void**&gt;(&amp;spInt));<br>  }<br>  _Module.Term();<br>}<br><br>Если есть у кого нибудь хоть какие-то идеи пишите... спасибо<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=168737&amp;user=5472&amp;forum_n=1&amp;topic=10488.html&amp;page=0&amp;anchor=2" class="addthx" data-post="168737"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 ноября 2007 03:21 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10488.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Обычно, получив первый интерфейс ты вызываешь что-то что б получить след. GetService() как раз возвращает IUnknown. То есть, просишь что-то там по строке, получаешь IUnknown и потом делаешь QueryInterface() в то что нужно.<br><br>Посмотри что ожидает этот GetService() отлажчиком или IDA.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=169981&amp;user=1737&amp;forum_n=1&amp;topic=10488.html&amp;page=0&amp;anchor=3" class="addthx" data-post="169981"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Исследование чужого приложения - COM</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#4" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="10488">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=10488" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
