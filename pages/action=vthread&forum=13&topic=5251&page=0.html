<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как реализовать восстановление импорта программно? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здраствуйте, уважаемый all. Прошу у вам помощи. Решился-таки написать динамический унпакер, чисто для себя, для повышения опыта, выбрал FSG. Вообщем реализовал всё, до OEP дохожу, там брякаюсь, делаю дамп, правлю таблицу секций,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как реализовать восстановление импорта программно?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]BUGOR[/b]','')">BUGOR</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.39'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1350">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июня 2006 15:07 &middot; Поправил: BUGOR <br><script type="text/javascript">QU('BUGOR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BUGOR" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Здраствуйте, уважаемый all. Прошу у вам помощи. Решился-таки написать динамический унпакер, чисто для себя, для повышения опыта, выбрал FSG. 
<br>Вообщем реализовал всё, до OEP дохожу, там брякаюсь, делаю дамп, правлю таблицу секций, заголовки и встал я на импорте. Как программно восстановить импорт? Нашёл место где FSG заполняет IAT, но я видать туговатый, не могу догнать, что мне с этим делать, хотя довольно отчётливо представляю как в программе устроен импорт, но вот как его восстановить понять не могу, прошу помочь. 
<br>В аттач кладу распакованный, запакованный файлы и дамп, который делает мой унпакер.
<br>
<br>Так же, место где FSG заполняет импорт находится по адресу: 004001C2
<br>
<br>Не могу приаттачить: fearus.narod.ru/ASMmd5.rar
<br>
<br>Если есть какие-нибудь статьи, которые объясняют динамическое восстановление импорта, то буду благодарен за ссылку.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=76825&amp;user=1350&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=1" class="addthx" data-post="76825"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июня 2006 15:18 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Как вариант-некоторые анпакеры юзают библиотеку от ImpRec, может её заюзать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=76827&amp;user=1556&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=2" class="addthx" data-post="76827"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]BUGOR[/b]','')">BUGOR</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.39'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1350">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июня 2006 15:22 <br><script type="text/javascript">QU('BUGOR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BUGOR" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>Archer</b>
<br>Да я же для себя пишу, мне охото понять как это делается, а не просто наляпать анпакер, он скорее всего дальше моего винта и не уйдёт.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=76829&amp;user=1350&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=3" class="addthx" data-post="76829"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июня 2006 15:39 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>padonak</b> ты реально идиот.
<br><b>BUGOR</b> если действительно хочешь разобраться пиши в личку, помогу, но только если действительно есть желание, иначе  лучше не расстаивай меня.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=76839&amp;user=3232&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=4" class="addthx" data-post="76839"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июня 2006 16:30 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
как-то давно, тоже писал нечто подобное и нашёл полезное в нете <img src="img/smilies/s1.gif" alt="">
<br>держи, разбирайся....
<br>
<br><img src="img/attach.gif" alt=""> <a href="./files/76ca_12.06.2006_CRACKLAB.rU.tgz">76ca_12.06.2006_CRACKLAB.rU.tgz</a> - rebIT11-SRC.zip
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=76857&amp;user=72&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=5" class="addthx" data-post="76857"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]BUGOR[/b]','')">BUGOR</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.39'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1350">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июня 2006 16:34 <br><script type="text/javascript">QU('BUGOR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BUGOR" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Hellspawn</b>, спасибо, буду смотреть. Вопрос актуален, кто как может объясните, буду очень благодарен.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=76859&amp;user=1350&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=6" class="addthx" data-post="76859"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июня 2006 16:45 &middot; Поправил: PE_Kill <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
if dll&lt;&gt;curren dll 
<br>  then
<br>    begin
<br>        invoke paste_null
<br>        invoke read_entry
<br>    end;
<br>
<br>Пойдет?
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=76861&amp;user=3232&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=7" class="addthx" data-post="76861"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Valenok Pirojkov[/b]','')">Valenok Pirojkov</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 15.3 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.33'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4048">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июня 2006 16:45 <br><script type="text/javascript">QU('Valenok Pirojkov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Valenok Pirojkov" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
где уже не помню попался исходник импрек.длл
<br>древний правда<br><br><img src="img/attach.gif" alt=""> <a href="./files/b3e3_12.06.2006_CRACKLAB.rU.tgz">b3e3_12.06.2006_CRACKLAB.rU.tgz</a> - imprecdll.7z
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=76862&amp;user=4048&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=8" class="addthx" data-post="76862"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]BUGOR[/b]','')">BUGOR</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.39'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1350">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июня 2006 16:50 <br><script type="text/javascript">QU('BUGOR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BUGOR" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>PE_Kill</b>, или я не понимаю тонкий крэкерский юмор или чё, но нахрена мне тут кидать понты? Я попросил по-человечески, ну ответь ты по-человечески, ну коли не хочешь помогать, лучше не начинай вообще.
<br>
<br><b>Valenok Pirojkov</b>, спасибо большое, буду разбираться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=76865&amp;user=1350&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=9" class="addthx" data-post="76865"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июня 2006 17:18 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
я могу конечно выложить весь исходник на 1200 строк, но если ты не понимаешь элементарного, то о чем речь?
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=76870&amp;user=3232&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=10" class="addthx" data-post="76870"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]BUGOR[/b]','')">BUGOR</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.39'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1350">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июня 2006 17:34 &middot; Поправил: BUGOR <br><script type="text/javascript">QU('BUGOR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BUGOR" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>PE_Kill</b>, ты гуру спору нет, и твой экзамен мне в личке очень понравился, да только я тебе сказал, что у меня есть желание и если я не понимаю как восстановить импорт, то это не значит, что я не смогу это понять, для тебя это элементарно, да, может быть это дейтсвительно элементарно, я это пойму, когда смогу сделать это. То, чего ты достиг в этой области никто не ставит под сомнение, но не надо считать меня сопляком, который пришёл просить научить его хэкать и выносить приговоры типа &quot;но если ты не понимаешь элементарного, то о чем речь?&quot;, поэтому давай закончим этот бессмысленный спор и каждый пойдёт своей дорогой, если ты можешь помочь в чём-то, то помоги, я буду тебе благодарен и возможно в чём-то смогу помочь тебе, если же не хочешь мне помогать, то просто проигнорируй этот топик.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=76881&amp;user=1350&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=11" class="addthx" data-post="76881"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b][dicr0n][/b]','')">[dicr0n]</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 14.9 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4643">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2006 12:08 <br><script type="text/javascript">QU('[dicr0n]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[dicr0n]" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Было бы неплохо реализовать задуманное в виде плагина к ollydbg...
<br>
<br>Попроси FEUERRADER-а, мож поможет...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=77109&amp;user=4643&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=12" class="addthx" data-post="77109"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]BUGOR[/b]','')">BUGOR</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.39'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1350">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2006 12:39 <br><script type="text/javascript">QU('BUGOR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BUGOR" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Что задуманное? Восстановление импорта? Так уже реализовано, например в плагине OllyDump
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=77114&amp;user=1350&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=13" class="addthx" data-post="77114"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b][dicr0n][/b]','')">[dicr0n]</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 14.9 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4643">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2006 13:07 <br><script type="text/javascript">QU('[dicr0n]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[dicr0n]" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>BUGOR пишет:
<br>Так уже реализовано, например в плагине OllyDump </I>
<br>Реализация-то в ollydbg есть... но не всегда восстанавливает, например, у FSG 2.0.
<br>Если твоя реализация будет восстанавливать импорт FSG - скорее всего и у большинства пакеров будет &quot;нормально&quot; восстанавливать импорт ;)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=77123&amp;user=4643&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=14" class="addthx" data-post="77123"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]MoonShiner[/b]','')">MoonShiner</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 186.8 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2006 13:58 <br><script type="text/javascript">QU('MoonShiner','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MoonShiner" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Я клепал изврата ради свою реализацию примерно следущим способом:
<br>1) Находил границы подгруженных либ;
<br>2) брал адрес из IAT и смотрел чьей либе он принадлежит. Дальше вручную разбирал экспорт этой либы и определял имя или ординал.
<br>3) добавлял его в таблицу импорта.
<br>
<br>Сложного ничего, а попрактиковаться полезно=)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=77138&amp;user=2&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=15" class="addthx" data-post="77138"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]BUGOR[/b]','')">BUGOR</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.39'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1350">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2006 14:22 &middot; Поправил: BUGOR <br><script type="text/javascript">QU('BUGOR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BUGOR" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>MoonShiner</b>, скажи, как ты определял нижнюю границу IAT? 
<br>Да, и вроде бы была апи которая по адресу функции возвращал её имя?
<br>И ещё<img src="img/smilies/s1.gif" alt=""> Как определить имя библиотеки, которой принадлежит данная фукнкция(допустим нам известны её имя и адрес, а imagebase этой библиотеки неизвестен)?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=77142&amp;user=1350&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=16" class="addthx" data-post="77142"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]BUGOR[/b]','')">BUGOR</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.39'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1350">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2006 15:17 &middot; Поправил: BUGOR <br><script type="text/javascript">QU('BUGOR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BUGOR" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Так, со всем вроде разобрался, спасибо людям с никами nice и UsAr, оч помогли. Осталось понять как определить границы IAT, как рациональней и более универсальней сделать это?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=77151&amp;user=1350&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=17" class="addthx" data-post="77151"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2006 15:50 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Посмотрел я твою прогу. Короче так. По адресу 004001C2 LODS DWORD PTR DS:[ESI]. Так вот там немного извратная директория импорта. По адресу из ESI лежит массив укзателей на имена АПИ. По адресу ESI+4 лежит указатель на имя DLL. Всё можешь ребилдить импорт. Размер директории импорта ревен числу ImageImportDescriptors*0x14 + 0x14. Мутишь новый массив из IIDs, FirstThunks которого получаешь из ESI пишешь его в новую секцию (если будишь отрезать секцию пакера), пересчитываешь размер и пишешь в Import Directory RVA адрес первого IID, в Size пересчитаный размер
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=77157&amp;user=3232&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=18" class="addthx" data-post="77157"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2006 07:54 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Держи сорс, думаю дальше сам разберешься. Дампить надо на обработке импорта.<br><br><img src="img/attach.gif" alt=""> <a href="./files/6582_14.06.2006_CRACKLAB.rU.tgz">6582_14.06.2006_CRACKLAB.rU.tgz</a> - Project1.dpr
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=77316&amp;user=3232&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=19" class="addthx" data-post="77316"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]BUGOR[/b]','')">BUGOR</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.39'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1350">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2006 11:57 <br><script type="text/javascript">QU('BUGOR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BUGOR" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>PE_Kill</b>, большое спасибо. Но ты знаешь, там если брякнутся на адресе LODS DWORD PTR DS:[ESI], то в esi будет указатели на адреса функций, а в esi+4 указатели на имена длл, так вот если от всех этих VA (на имена функций) отнять ImageBase+1, то мы получим offset&#039;ы на имена функций, после чего заменяем все FFFFFFFF и 7FFFFFFF  в этом массиве указателей на нули, это будут границы массивов FirstFunk. Далее из той таблицы, что в [ESI] от первого значение отнимаем ImageBase, это будет ни что иное как IMAGE_IMPORT_DESCRIPTOR.FirstFunk, от значения [ESI+4] тоже отнимаем ImageBase и получаем IMAGE_IMPORT_DESCRIPTOR.Name(RVA). Таким образом можно не добавлять новую секцию, а записать импорт на тоже место, где он и был, только обработав FirstFunk и Сгенерив IID на основе Таблицы в [ESI].
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=77346&amp;user=1350&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=20" class="addthx" data-post="77346"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]BUGOR[/b]','')">BUGOR</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.8 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.39'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1350">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2006 12:00 <br><script type="text/javascript">QU('BUGOR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BUGOR" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
А, да ты точно так же сделал, только с добавлением секции. Вот чё-то мне секцию добавлять нехочется, дамп и так распирает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=77347&amp;user=1350&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=21" class="addthx" data-post="77347"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2006 12:07 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=5251.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Возможно, это я за пару минут накидал, особо не смотрел, что там да как, ты же просил подсказку, я тебе ее дал. Кстати границы FirstThunk только 7FFFFFFF, а FFFFFFFF это конец IAT, но вместо него тоже надо 0 втыкать. Удачи.
<br>
<br>PS Проверь, как FSG с импортом по ординалам работает.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=77348&amp;user=3232&amp;forum_n=13&amp;topic=5251.html&amp;page=0&amp;anchor=22" class="addthx" data-post="77348"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как реализовать восстановление импорта программно?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#23" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="5251">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=5251" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
