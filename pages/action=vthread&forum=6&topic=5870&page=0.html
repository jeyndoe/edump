<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Debug API + Delphi - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="procedure TForm1.Button1Click(Sender: TObject); Var SI: TStartUpInfo; PI: TProcessInformation; DE: TDebugEvent; buf:array[0..511] of Char; begin GetStartupInfo(SI); CreateProcess(PChar(Edit.Text),&#039;&#039;,nil,nil,false,DEBUG_P">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=39467'>hgdagon</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Debug API + Delphi</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]sniperZ[/b]','')">sniperZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 260.2 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.07'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5211">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 14:04 <br><script type="text/javascript">QU('sniperZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sniperZ" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
procedure TForm1.Button1Click(Sender: TObject);
<br>Var
<br> SI: TStartUpInfo;
<br> PI: TProcessInformation;
<br> DE: TDebugEvent;
<br> buf:array[0..511] of Char;
<br>begin
<br> GetStartupInfo(SI);
<br> CreateProcess(PChar(Edit.Text),&#039;&#039;,nil,nil,false,DEBUG_PROCESS+DEBUG_ON LY_THIS_PROCESS,
<br>                 nil,&#039;&#039;,SI,PI);
<br> While true do
<br>  begin
<br>   WaitForDebugEvent(DE,INFINITE);
<br>   if DE.dwDebugEventCode=EXCEpTION_DEBUG_EVENT then
<br>    ContinueDebugEvent(DE.dwProcessId,DE.dwThreadId,DBG_CONTINUE);
<br>  end;
<br>end;
<br>
<br>Не хочет грузить процесс!<img src="img/smilies/s4.gif" alt="">
<br>В чём ошибка?
<br>
<br>Подскажите статьи по Debug API.<img src="img/smilies/s2.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=86866&amp;user=5211&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=1" class="addthx" data-post="86866"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]nice[/b]','')">nice</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 384.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29">Участник</a><br><font color=blue>www.int3.net</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 14:13 <br><script type="text/javascript">QU('nice','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nice" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
наступал на такие грабли, смотри внимательно на параметры
<br>   if not CreateProcessA(nil,PChar(GetStartDir+&#039;xxxx.exe&#039;),nil,nil,False,
<br>  NORMAL_PRIORITY_CLASS,nil,nil,strucStInfo,strucPrInfo) then begin
<br><br><font size="1"><i>-----<br>Подписи - ЗЛО! Нужно убирать!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=86867&amp;user=29&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=2" class="addthx" data-post="86867"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 14:16 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>sniperZ пишет:
<br>Подскажите статьи по Debug API. </I>
<br>
<br>www.progers.ru/articles/425.htm
<br>www.podgoretsky.com/ftp/Docs/Asm/IczTutor/ (на асме)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=86868&amp;user=5291&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=3" class="addthx" data-post="86868"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 15:11 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
ZeroMemory(@SI,SizeOf(TStartUpInfo)) иначе на некоторых ОС может не работать. На ХП например.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=86876&amp;user=3232&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=4" class="addthx" data-post="86876"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]sniperZ[/b]','')">sniperZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 260.2 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.07'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5211">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 17:05 <br><script type="text/javascript">QU('sniperZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sniperZ" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
nice, PE_Kill, не работает!<img src="img/smilies/s4.gif" alt="">
<br>Жду помощи!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=86893&amp;user=5211&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=5" class="addthx" data-post="86893"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 17:34 &middot; Поправил: Ara <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<a href="http://exelab.ru/art/?action=view&amp;id=75" target="_blank">http://exelab.ru/art/?action=view&amp;id=75</a>
<br><a href="http://exelab.ru/art/?action=view&amp;id=74" target="_blank">http://exelab.ru/art/?action=view&amp;id=74</a>
<br>Покури статьи Hex&#039;a...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=86896&amp;user=24&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=6" class="addthx" data-post="86896"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]BoOMBoX[/b]','')">BoOMBoX</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 116.1 (ветеран), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4579">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 17:47 <br><script type="text/javascript">QU('BoOMBoX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoOMBoX" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Замени &#039;&#039; на nil
<br>Вот так попробуй <img src="img/smilies/s3.gif" alt="">
<br>CreateProcess(PChar(Edit.Text),nil,nil,nil,false,DEBUG_PROCESS+DEBUG_O NLY_THIS_PROCESS, 
<br>nil,nil,SI,PI); 
<br>
<br>Удачи!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=86899&amp;user=4579&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=7" class="addthx" data-post="86899"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]deNULL[/b]','')">deNULL</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 174.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.83'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=321">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 18:55 <br><script type="text/javascript">QU('deNULL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=deNULL" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>BoOMBoX/TSRh пишет:
<br>Замени &#039;&#039; на nil </I>
<br>Именно так. Второй параметр должен быть равен первому или nil. Остальное вроде и так правильно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=86919&amp;user=321&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=8" class="addthx" data-post="86919"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 19:59 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
у мну так 
<br><code>
<br>if CreateProcess(nil,PChar(exe_name),nil,nil,false,NORMAL_PRIORITY_CLASS or
<br>  DEBUG_ONLY_THIS_PROCESS or CREATE_SUSPENDED,nil,nil,sti,lpPi)=FALSE then
<br>  begin
<br>    log(&#039;[Failed to create process]&#039;);
<br>    Exit;
<br>  end;
<br></code>
<br>...
<br><code>
<br>  resumethread(lpPi.hThread);
<br>  log(&#039;-&gt; Run...&#039;);
<br></code>
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=86939&amp;user=72&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=9" class="addthx" data-post="86939"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]nice[/b]','')">nice</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 384.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29">Участник</a><br><font color=blue>www.int3.net</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 20:56 <br><script type="text/javascript">QU('nice','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nice" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>deNULL</b>
<br>Не брат, первый параметр, <b>Hellspawn</b> правильно написал
<br><br><font size="1"><i>-----<br>Подписи - ЗЛО! Нужно убирать!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=86954&amp;user=29&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=10" class="addthx" data-post="86954"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]BoOMBoX[/b]','')">BoOMBoX</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 116.1 (ветеран), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4579">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 21:50 <br><script type="text/javascript">QU('BoOMBoX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoOMBoX" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Первый параметр не может быть nil:
<br>BOOL CreateProcess(
<br>    LPCTSTR lpApplicationName,	// pointer to name of executable module 
<br>    LPTSTR lpCommandLine,	// pointer to command line string
<br>    LPSECURITY_ATTRIBUTES lpProcessAttributes,	// pointer to process security attributes 
<br>    LPSECURITY_ATTRIBUTES lpThreadAttributes,	// pointer to thread security attributes 
<br>    BOOL bInheritHandles,	// handle inheritance flag 
<br>    DWORD dwCreationFlags,	// creation flags 
<br>    LPVOID lpEnvironment,	// pointer to new environment block 
<br>    LPCTSTR lpCurrentDirectory,	// pointer to current directory name 
<br>    LPSTARTUPINFO lpStartupInfo,	// pointer to STARTUPINFO 
<br>    LPPROCESS_INFORMATION lpProcessInformation 	// pointer to PROCESS_INFORMATION  
<br>   );
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=86964&amp;user=4579&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=11" class="addthx" data-post="86964"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 22:04 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>BoOMBoX/TSRh пишет:
<br>Первый параметр не может быть nil </I>
<br>...странно,вы как будто не читали MSDN...
<br>lpApplicationName -- это указатель на имя модуля,который должен быть исполнен.Если он равен нулю,то используется первый член командной строки,определяемой с помощью lpCommandLine.Если же последний равен нулю,то в качестве командной строки используется строка,указанная в lpApplicationName.
<br>А вообще я согласен с вариантом <b>BoOmBoX</b>&#039;a.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=86967&amp;user=1613&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=12" class="addthx" data-post="86967"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]NaumLeNet[/b]','')">NaumLeNet</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/2212.gif" alt=""><br><span class=txtSm>Ранг: 103.3 (ветеран), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.99'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2212">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 22:06 &middot; Поправил: NaumLeNet <br><script type="text/javascript">QU('NaumLeNet','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NaumLeNet" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>BoOMboX/TSRh</b>
<br>первый параметр nil ) абсолютно спокойно. почему не может быть то?
<br>
<br>[code]
<br>  zeroMemory(@si, sizeOf(TStartupInfo));
<br>  si.cb := sizeOf(TStartupInfo);
<br>  si.dwFlags := STARTF_USESHOWWINDOW;
<br>  si.wShowWindow := SW_SHOWNORMAL;
<br>  CreateProcess(nil, PChar(AFileName), nil, nil, false, 0,
<br>    nil, PChar(APath), si, pi);
<br>[/code]
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=86968&amp;user=2212&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=13" class="addthx" data-post="86968"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 22:14 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
если второй параметр nil, а в первом путь, иногда получается странная ситуация, отлажеваемая программа не видит файл настройки, а он в свою очередь оказался в диресктории с отладчиком, странно да? <img src="img/smilies/s1.gif" alt=""> так что выходит первый нил, а второй путь (подсмотривел в нескольких примерах)
<br>
<br>адд // хотя вроде ща попробовал и так и так пашет...
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=86969&amp;user=72&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=14" class="addthx" data-post="86969"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]BoOMBoX[/b]','')">BoOMBoX</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 116.1 (ветеран), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4579">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 22:22 <br><script type="text/javascript">QU('BoOMBoX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoOMBoX" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Полностью cогласен с DillerInc.
<br>Первый параметр может быть nil, просто у меня предпочтение, чтобы все параметры функции были на своем месте.
<br>И человеку, у которого есть трудности с работой функции, проще разобраться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=86970&amp;user=4579&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=15" class="addthx" data-post="86970"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]BoOMBoX[/b]','')">BoOMBoX</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 116.1 (ветеран), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4579">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 22:25 <br><script type="text/javascript">QU('BoOMBoX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoOMBoX" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Я в качестве параметра lpApplicationName всегда указываю полный путь к запускаемому файлу, и никогда с работой функции не было проблем.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=86971&amp;user=4579&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=16" class="addthx" data-post="86971"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 22:35 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
смотрим как это делает олли
<br><code>
<br>0078C140   00000000  |ModuleFileName = NULL
<br>0078C144   0078C5F0  |CommandLine = &quot;&quot;&quot;C:&#92;WINDOWS&#92;Рабо.ий стол&#92;ПАКЕРЫ&#92;Не пакованные&#92;TestDebugger.EXE&quot;&quot;&quot;
<br>0078C148   00000000  |pProcessSecurity = NULL
<br>0078C14C   00000000  |pThreadSecurity = NULL
<br>0078C150   00000000  |InheritHandles = FALSE
<br>0078C154   04000022  |CreationFlags = DEBUG_ONLY_THIS_PROCESS|NORMAL_PRIORITY_CLASS|CREATE_DEFAULT_ERROR_MOD E
<br>0078C158   00000000  |pEnvironment = NULL
<br>0078C15C   0078DC7C  |CurrentDir = &quot;C:&#92;WINDOWS&#92;Рабо.ий стол&#92;ПАКЕРЫ&#92;Не пакованные&#92;&quot;
<br>0078C160   0078C3A4  |pStartupInfo = 0078C3A4
<br>0078C164   0078C2B4  &#92;pProcessInfo = 0078C2B4
<br></code>
<br>я думаю всем всё ясно <img src="img/smilies/s3.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=86974&amp;user=72&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=17" class="addthx" data-post="86974"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]BoOMBoX[/b]','')">BoOMBoX</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 116.1 (ветеран), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4579">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 22:58 <br><script type="text/javascript">QU('BoOMBoX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoOMBoX" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Oleh Yuschuk respect!
<br>А вообще кому, что удобнее.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=86980&amp;user=4579&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=18" class="addthx" data-post="86980"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2006 23:20 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
кстати кто нить может объяснить про третий флаг &quot;CREATE_DEFAULT_ERROR_MODE&quot; прочитал хелп,
<br>да что то я мало понял, для чего он нужен то?
<br>
<br><i class=x>Новый процесс не наследует error mode вызывающего процесса</i> <img src="img/smilies/s4.gif" alt="">
<br>
<br>как это отразится при дальнейшей отладке?
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=86986&amp;user=72&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=19" class="addthx" data-post="86986"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]sniperZ[/b]','')">sniperZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 260.2 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.07'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5211">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 августа 2006 11:02 <br><script type="text/javascript">QU('sniperZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sniperZ" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
Hellspawn,исправил-всё равно не работает!!!<img src="img/smilies/s4.gif" alt="">
<br>
<br>procedure TForm1.Button1Click(Sender: TObject);
<br>Var
<br> SI: TStartUpInfo;
<br> PI: TProcessInformation;
<br> DE: TDebugEvent;
<br> buf:array[0..511] of Char;
<br>begin
<br> ZeroMemory(@SI,SizeOf(TStartUpInfo));
<br> GetStartupInfo(SI);
<br> CreateProcess(PChar(Edit.Text),&#039;&#039;,nil,nil,false,NORMAL_PRIORITY_CLASS or 
<br>   DEBUG_ONLY_THIS_PROCESS or CREATE_SUSPENDED,nil,nil,SI,PI);
<br> While true do
<br>  begin
<br>   WaitForDebugEvent(DE,INFINITE);
<br>   if DE.dwDebugEventCode=EXCEpTION_DEBUG_EVENT then
<br>    ContinueDebugEvent(DE.dwProcessId,DE.dwThreadId,DBG_CONTINUE);
<br>  end;
<br>end;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=87051&amp;user=5211&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=20" class="addthx" data-post="87051"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 августа 2006 11:30 &middot; Поправил: PE_Kill <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Первый параметр не должен быть nil. Этот вопрос разбирался в книге &quot;Безопасный код&quot;. Там есть примеры, доказывающие неправильность вызова CreateProcess с первым параметром = nil. Хотя работать будет.
<br>
<br>[MSDN]
<br>The first parameter, lpApplicationName, can be NULL, in which case the executable name must be in the white space-delimited string pointed to by lpCommandLine. If the executable or path name has a space in it, there is a risk that a different executable could be run because of the way the function parses spaces. The following example is dangerous because the function will attempt to run &quot;Program.exe&quot;, if it exists, instead of &quot;MyApp.exe&quot;.
<br>
<br>CreateProcess(NULL, &quot;C:&#92;&#92;Program Files&#92;&#92;MyApp&quot;, ...)
<br>If a malicious user were to create an application called &quot;Program.exe&quot; on a system, any program that incorrectly calls CreateProcess using the Program Files directory will run this application instead of the intended application.
<br>
<br>To avoid this problem, do not pass NULL for lpApplicationName. If you do pass NULL for lpApplicationName, use quotation marks around the executable path in lpCommandLine, as shown in the example below.
<br>
<br>CreateProcess(NULL, &quot;&#92;&quot;C:&#92;&#92;Program Files&#92;&#92;MyApp.exe&#92;&quot; -L -S&quot;, ...)
<br>
<br>[/MSDN]
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=87064&amp;user=3232&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=21" class="addthx" data-post="87064"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 августа 2006 11:38 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>sniperZ</b> попробуй так:
<br>
<br>procedure TForm1.Button1Click(Sender: TObject); 
<br>Var 
<br>SI: TStartUpInfo; 
<br>PI: TProcessInformation; 
<br>DE: TDebugEvent; 
<br>buf:array[0..511] of Char; 
<br>begin 
<br>ZeroMemory(@SI,SizeOf(TStartUpInfo)); 
<br>CreateProcess(PChar(Edit.Text),nil,nil,nil,false,NORMAL_PRIORITY_CLASS  or 
<br>DEBUG_ONLY_THIS_PROCESS ,nil,nil,SI,PI); 
<br>While true do 
<br>begin 
<br>WaitForDebugEvent(DE,INFINITE); 
<br>if DE.dwDebugEventCode=EXCEpTION_DEBUG_EVENT then 
<br>ContinueDebugEvent(DE.dwProcessId,DE.dwThreadId,DBG_CONTINUE); 
<br>end; 
<br>end;
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=87066&amp;user=3232&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=22" class="addthx" data-post="87066"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]sER[/b]','')">sER</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.95'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2290">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 августа 2006 11:39 <br><script type="text/javascript">QU('sER','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sER" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
может так:
<br>
<br>var
<br>  si:STARTUPINFO;
<br>  pi: PROCESS_INFORMATION;
<br>  sa:_SECURITY_ATTRIBUTES;
<br>begin
<br>sa. nLength := sizeof(sa);
<br>sa.bInheritHandle := false;
<br>sa.lpSecurityDescriptor := nil;
<br>GetStartupInfo(si);
<br>CreateProcess(&#039;Project1.exe&#039;, Nil, @sa, @sa, true,
<br>              NORMAL_PRIORITY_CLASS or DEBUG_ONLY_THIS_PROCESS or CREATE_SUSPENDED,
<br>              Nil, Nil, si, pi);
<br>if pi.hProcess=0 then  RaiseLastOSError;
<br>
<br>Бла, бла...
<br>end;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=87067&amp;user=2290&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=23" class="addthx" data-post="87067"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 августа 2006 16:35 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>sniperZ</b>
<br>С какой ошибкой хоть падает-то??
<br>Что находится в Edit.Text -- полное имя,часть его??
<br>И из параметра dwCreationFlags не стоит делать масло-масляное -- если указываешь флаг DEBUG_ONLY_THIS_PROCESS,то процесс и так создаётся в замороженном состоянии,т.е. не надо ещё указывать CREATE_SUSPENDED.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=87138&amp;user=1613&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=24" class="addthx" data-post="87138"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]sniperZ[/b]','')">sniperZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 260.2 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.07'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5211">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 августа 2006 19:41 <br><script type="text/javascript">QU('sniperZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sniperZ" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>DillerInc пишет:
<br>С какой ошибкой хоть падает-то?? </I>
<br>Просто прога ВИСИТ!?
<br>Ничего не помогло из советов.
<br>
<br>Edit.text-полный путь к EXE.
<br>
<br>Вот сорцы.
<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/1eb8_04.08.2006_CRACKLAB.rU.tgz">1eb8_04.08.2006_CRACKLAB.rU.tgz</a> - Project.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=87169&amp;user=5211&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=25" class="addthx" data-post="87169"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 августа 2006 19:53 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>DillerInc пишет:
<br>И из параметра dwCreationFlags не стоит делать масло-масляное -- если указываешь флаг DEBUG_ONLY_THIS_PROCESS,то процесс и так создаётся в замороженном состоянии,т.е. не надо ещё указывать CREATE_SUSPENDED. </I>
<br>
<br>разве? в хелпе ничё про это не сказано, а всего лишь
<br>
<br><i class=x>DEBUG_ONLY_THIS_PROCESS	
<br>If not set and the calling process is being debugged, the new process becomes another process being debugged by the calling process&#039;s debugger. If the calling process is not a process being debugged, no debugging-related actions occur.</i>
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=87172&amp;user=72&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=26" class="addthx" data-post="87172"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 августа 2006 21:59 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>sniperZ</b>
<br>Значит так:
<br>
<br>1. В качестве параметра dwCreationFlags выставляем <u>только</u> DEBUG_ONLY_THIS_PROCESS.Если кто-то не согласен,то пускай попробует это отладить -- процесс-то создастся,но функция WaitForDebugEvent тут же вывалится от такого масла-масляного.
<br>
<br>2. У тебя неправильно обрабатывается отладочный цикл -- ты начинаешь цикл функцией WaitForDebugEvent и должен в любом случае его <u>закончить/продолжить функцией ContinueDebugEvent</u>,чтобы потом его опять начать сначала.У тебя же функция ContinueDebugEvent вызывается,только если произойдёт исключение.А исключение может просто-напросто не произойти.И тогда,по твоему коду,ты начинаешь заново отладочный цикл,не закончив/продолжив его.
<br>
<br>Должно быть что-то в этом роде:
<br><code>
<br>procedure TForm1.Button1Click(Sender: TObject);
<br>Var
<br> SI: TStartUpInfo;
<br> PI: TProcessInformation;
<br> DE: TDebugEvent;
<br> buf:array[0..511] of Char; // &lt;-- массив кстати почему-то нигде не используется
<br>begin
<br> ZeroMemory(@SI,SizeOf(TStartUpInfo));
<br> GetStartupInfo(SI);
<br> CreateProcess(PChar(Edit.Text),nil,nil,nil,false,DEBUG_ONLY_THIS_PROCE SS,
<br>               nil,nil,SI,PI);
<br> While true do
<br>  begin
<br>   WaitForDebugEvent(DE,INFINITE); // Начинаем отладочный цикл
<br>   if DE.dwDebugEventCode = EXCEPTION_DEBUG_EVENT then
<br>    begin
<br>     ContinueDebugEvent(DE.dwProcessId,DE.dwThreadId,DBG_CONTINUE); // если выполняется условие
<br>    end;
<br>   ContinueDebugEvent(DE.dwProcessId,DE.dwThreadId,DBG_CONTINUE); // а это в любом случае
<br>  end;
<br>end;
<br></code>
<br>
<br>Да,и когда-то надо всё-таки наверно выйти из цикла(Break) -- иначе зациклишься.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=87206&amp;user=1613&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=27" class="addthx" data-post="87206"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2006 13:53 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5870.html&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
Так ясен перец что висит. Надо же если с CREATE_SUSPEND то ResumeThread делать. sniperZ и вообще непонятно тебе дают один код а ты раз за разом постишь абсолютно другой. Даже у меня в примере нет SUSPEND_THREAD.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=87441&amp;user=3232&amp;forum_n=6&amp;topic=5870.html&amp;page=0&amp;anchor=28" class="addthx" data-post="87441"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Debug API + Delphi</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=5870" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
