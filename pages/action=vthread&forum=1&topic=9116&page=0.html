<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите разобраться с генерацией SN, который не содержится в памяти в явном виде - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Помогите разобраться с генерацией SN, который не содержится в памяти в явном виде 	Собственно говоря, мне нужен не взлом программы, а прошу я помощи, чтобы разобраться с алгоритмом генерации SN, который не содержится в памяти в">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите разобраться с генерацией SN, который не содержится в памяти в явном виде</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]DivisionByZero[/b]','')">DivisionByZero</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.07'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=12041">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2007 23:41 &middot; Поправил: DivisionByZero <br><script type="text/javascript">QU('DivisionByZero','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DivisionByZero" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9116.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Помогите разобраться с генерацией SN, который не содержится в памяти в явном виде<br><br>	Собственно говоря, мне нужен не взлом программы, а <br>прошу я помощи, чтобы разобраться с алгоритмом генерации SN,<br>который не содержится в памяти в явном виде. Но всё по-порядку.<br>	Сам я скачивал эту прогу отсюда - <br>www.videocharge.com/download/VideoChargeFull_Install.exe<br>Весит она 22,5 МВ. Trial работает 20 дней, но этот этап мной<br>уже пройден - сбросить trial я теперь могу сам, и мне захотелось<br>добить эту прогу. Тут я должен немного отвлечься, чтобы было<br>понятнее. Вначале, как и положено ничего не понимающему в крэкинге<br>чайнику, я искал кейгены к вышеуказанной программе по всему<br>инету, и находил, но вот какую удивительную вещь обнаружил:<br>нет ни одного кейгена, соответствующего какой-нибудь из скачаных<br>версий ехе-файла. Допустим, с указанного URL я скачивал как<br>версию Full 3.8, а после инсталляции оказалось, что версия<br>ехе-файла 3.8.1.1. А до этого мной была предпринята масса<br>попыток скачать определенную версию и к ней же кейген, но<br>каждый раз результат был один и тот же: после установки<br>оказывалось, что версия хоть на одну циферку отличается, и<br>кейген уже не работает! Я подумал, что это и есть способ<br>защиты от создания универсального кейгена. Это меня так<br>заинтересовало, что я решил присоединится к сообществу<br>крэкинга...<br>	Итак, я начал исследовать эту программу и довольно<br>быстро нашел способ сбросить trial, как я уже говорил, а вот<br>дальше дела пошли хуже. Мне не удается ни пропатчить прогу,<br>ни, тем более, написать кейген к ней. Она, кстати, ничем не<br>упакована, а написана на Microsoft Visual C++ 7.0. SoftIce<br>не работает у меня даже с официальными патчами от Numega,<br>поэтому использую Ollydbg. Вот чего мне удалось добиться:<br>Допустим, если в строке:<br><br>004060F4   . 74 1B          JE SHORT VideoCha.00406111<br><br>поменять JE на JNZ, то появится красивое окошко с сообщением:<br>&quot;Congratulations! You have succesfully activated...&quot; Но это<br>только надпись, зарегеной она себя считать не будет. Я попытался<br>ещё продвинуться в этом направлении - находил и менял ещё<br>несколько условных переходов -, появлялись надписи типа:<br>&quot;Licensed version&quot; и т.д., но результата (желаемого) так и не<br>добился - прога упорно не регистрируется. Тогда я попытался<br>разобраться с алгоритмом генерации и проверки кода, но и тут<br>застрял, и без посторонней помощи, похоже, не выберусь. Как я<br>уже говорил нужный мне код не содержится в памяти в явном<br>виде. Вообще, чтобы &quot;открыть&quot; программу, нужно иметь три &quot;ключа&quot;:<br>1. Код инсталляции (Instalation Code), который генерируется,<br>	насколько я понял, при инсталляции и зависит от конкретного<br>	компьютера. Его искать не надо;<br>2. Серийный номер (Serial Namber), который предоставляется <br>	компанией за определенную плату;<br>3. Ключ активации (Activation Key), который сообщается <br>	компанией после предоставления ей первых двух ключей.<br>	Вот участок программы, где последовательно проверяются<br>все три ключа:<br><br>0040318B  |. 57             PUSH EDI<br>0040318C  |. 8D8E 10040000  LEA ECX,DWORD PTR DS:[ESI+410]<br>00403192  |. 8945 74        MOV DWORD PTR SS:[EBP+74],EAX<br>00403195  |. E8 6DFCFFFF    CALL VideoCha.00402E07<br>0040319A  |. 57             PUSH EDI<br>0040319B  |. 8D8E 0C040000  LEA ECX,DWORD PTR DS:[ESI+40C]<br>004031A1  |. 8BD8           MOV EBX,EAX<br>004031A3  |. E8 5FFCFFFF    CALL VideoCha.00402E07<br>004031A8  |. 57             PUSH EDI<br>004031A9  |. 8D8E F4050000  LEA ECX,DWORD PTR DS:[ESI+5F4]<br>004031AF  |. 8945 04        MOV DWORD PTR SS:[EBP+4],EAX<br>004031B2  |. E8 50FCFFFF    CALL VideoCha.00402E07<br><br>как видим, три раза вызывается подпрограмма по адресу 00402E07.<br>Перед этим в ECX заносится адрес памяти, по этому адресу и<br>находится проверяемый ключ. Вот сама процедура проверки:<br><br>00402E07  /&#036; 56             PUSH ESI<br>00402E08  |. 8BF1           MOV ESI,ECX<br>00402E0A  |. 8B06           MOV EAX,DWORD PTR DS:[ESI]<br>00402E0C  |. 33C9           XOR ECX,ECX<br>00402E0E  |. 83E8 10        SUB EAX,10<br>00402E11  |. 41             INC ECX<br>00402E12  |. 2B48 0C        SUB ECX,DWORD PTR DS:[EAX+C]<br>00402E15  |. 8B40 08        MOV EAX,DWORD PTR DS:[EAX+8]<br>00402E18  |. 2B4424 08      SUB EAX,DWORD PTR SS:[ESP+8]<br>00402E1C  |. 0BC8           OR ECX,EAX<br>00402E1E  |. 7D 0B          JGE SHORT VideoCha.00402E2B<br>00402E20  |. FF7424 08      PUSH DWORD PTR SS:[ESP+8]<br>00402E24  |. 8BCE           MOV ECX,ESI<br>00402E26  |. E8 B1FEFFFF    CALL VideoCha.00402CDC<br>00402E2B  |&gt; 8B06           MOV EAX,DWORD PTR DS:[ESI]<br>00402E2D  |. 5E             POP ESI<br>00402E2E  \. C2 0400        RETN 4<br><br>в ней, как я понял, идет сначала предварительная проверка, и<br>если всё хорошо, то вызывается процедура более детальной<br>проверки по адресу 00402CDC:<br><br>00402CDC  /&#036; 8B01           MOV EAX,DWORD PTR DS:[ECX]<br>00402CDE  |. 8B50 F4        MOV EDX,DWORD PTR DS:[EAX-C]<br>00402CE1  |. 83E8 10        SUB EAX,10<br>00402CE4  |. 56             PUSH ESI<br>00402CE5  |. 8B7424 08      MOV ESI,DWORD PTR SS:[ESP+8]<br>00402CE9  |. 3BD6           CMP EDX,ESI<br>00402CEB  |. 7E 02          JLE SHORT VideoCha.00402CEF<br>00402CED  |. 8BF2           MOV ESI,EDX<br>00402CEF  |&gt; 8378 0C 01     CMP DWORD PTR DS:[EAX+C],1<br>00402CF3  |. 7E 08          JLE SHORT VideoCha.00402CFD<br>00402CF5  |. 56             PUSH ESI<br>00402CF6  |. E8 D2ECFFFF    CALL VideoCha.004019CD<br>00402CFB  |. EB 22          JMP SHORT VideoCha.00402D1F<br>00402CFD  |&gt; 8B40 08        MOV EAX,DWORD PTR DS:[EAX+8]<br>00402D00  |. 3BC6           CMP EAX,ESI<br>00402D02  |. 7D 1B          JGE SHORT VideoCha.00402D1F<br>00402D04  |. BA 00040000    MOV EDX,400<br>00402D09  |. 3BC2           CMP EAX,EDX<br>00402D0B  |. 7E 04          JLE SHORT VideoCha.00402D11<br>00402D0D  |. 03C2           ADD EAX,EDX<br>00402D0F  |. EB 02          JMP SHORT VideoCha.00402D13<br>00402D11  |&gt; 03C0           ADD EAX,EAX<br>00402D13  |&gt; 3BC6           CMP EAX,ESI<br>00402D15  |. 7D 02          JGE SHORT VideoCha.00402D19<br>00402D17  |. 8BC6           MOV EAX,ESI<br>00402D19  |&gt; 50             PUSH EAX<br>00402D1A  |. E8 15EDFFFF    CALL VideoCha.00401A34<br>00402D1F  |&gt; 5E             POP ESI<br>00402D20  \. C2 0400        RETN 4<br><br>Вот с алгоритмами этих процедур я и не могу разобраться. в<br>первой всё время идет считывание из памяти, не могу найти,<br>когда и как эти данные туда заносятся, чему они должны <br>соответствовать? Вторую процедуру тоже бы хотелось разложить<br>по полочкам, у меня никак не получается.<br>	Я в этом деле новичок, поэтому даже не знаю, насколько<br>глупые вопросы я задаю. Но если кто-нибудь заинтересовался,<br>то помогите, пожалуйста!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=142177&amp;user=12041&amp;forum_n=1&amp;topic=9116.html&amp;page=0&amp;anchor=1" class="addthx" data-post="142177"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Wild_One[/b]','')">Wild_One</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.3 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.45'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1158">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2007 08:20 <br><script type="text/javascript">QU('Wild_One','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wild_One" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9116.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Ничего практически полезного в приведенном коде не вижу. Покажи лучше дамп около перехода 004060F4 . 74 1B JE SHORT VideoCha.00406111
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=142196&amp;user=1158&amp;forum_n=1&amp;topic=9116.html&amp;page=0&amp;anchor=2" class="addthx" data-post="142196"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]DivisionByZero[/b]','')">DivisionByZero</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.07'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=12041">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2007 15:55 <br><script type="text/javascript">QU('DivisionByZero','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DivisionByZero" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9116.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>Wild_One</b><br><br>Вот код программы этого участка:<br><br>004060C2   &gt; 53             PUSH EBX<br>004060C3   . 33DB           XOR EBX,EBX<br>004060C5   . 3BC3           CMP EAX,EBX<br>004060C7   . 7D 06          JGE SHORT VideoCha.004060CF<br>004060C9   . 899E F4070000  MOV DWORD PTR DS:[ESI+7F4],EBX<br>004060CF   &gt; 8B86 F4070000  MOV EAX,DWORD PTR DS:[ESI+7F4]<br>004060D5   . 83F8 03        CMP EAX,3<br>004060D8   . 0F85 8E000000  JNZ VideoCha.0040616C<br>004060DE   . 6A 01          PUSH 1<br>004060E0   . 8D8E 30040000  LEA ECX,DWORD PTR DS:[ESI+430]<br>004060E6   . E8 846F0600    CALL VideoCha.0046D06F<br>004060EB   . 8BCE           MOV ECX,ESI<br>004060ED   . E8 82D0FFFF    CALL VideoCha.00403174<br>004060F2   . 85C0           TEST EAX,EAX<br>004060F4     74 1B          JE SHORT VideoCha.00406111<br>004060F6   . 53             PUSH EBX<br>004060F7   . 8D8E F4050000  LEA ECX,DWORD PTR DS:[ESI+5F4]<br>004060FD   . E8 05CDFFFF    CALL VideoCha.00402E07<br>00406102   . 68 84284800    PUSH VideoCha.00482884            ;  ASCII &quot;ActivationKeyFull&quot;<br>00406107   . 50             PUSH EAX<br>00406108   . E8 E7B6FFFF    CALL VideoCha.004017F4<br><br>вызывается процедура по адресу 00403174, которую я привел выше,<br>затем TEST EAX,EAX, если 0, то перепрыгиваем на нехорошее сообщение:<br>&quot;Invalid Activation Key. Please verify your serial number and<br>activation key&quot;, а если не 0, то идем дальше и CALL VideoCha.004017F4,<br>а это и есть процедура вывода &quot;хорошего&quot; сообщения.<br>А в памяти можно найти только код инсталляции, который и так всегда доступен, и введеные мною<br>неправильные ключи. Правильных нет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=142291&amp;user=12041&amp;forum_n=1&amp;topic=9116.html&amp;page=0&amp;anchor=3" class="addthx" data-post="142291"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]drunk_master[/b]','')">drunk_master</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.2 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.4'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9998">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2007 18:51 <br><script type="text/javascript">QU('drunk_master','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=drunk_master" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9116.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>DivisionByZero пишет:<br>www.videocharge.com/download/VideoChargeFull_Install.exe<br>Весит она 22,5 МВ </I>...спасибо, конечно за заботу, можно было бы что-нить вымутить из дистра, чтоб около метра-двух да выложить, а так хер его знает, да и -&gt;<br><br><I>DivisionByZero пишет:<br>CALL VideoCha.004017F4  </I> &lt;- о чем может поведать, что там, видеоканал али защита там...<br>...с уважением ...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=142319&amp;user=9998&amp;forum_n=1&amp;topic=9116.html&amp;page=0&amp;anchor=4" class="addthx" data-post="142319"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]DivisionByZero[/b]','')">DivisionByZero</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.07'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=12041">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2007 21:52 <br><script type="text/javascript">QU('DivisionByZero','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DivisionByZero" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9116.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>drunk_master</b><br>Могу залить рабочий ехешник (1,38 МВ), подскажите, куда и как?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=142355&amp;user=12041&amp;forum_n=1&amp;topic=9116.html&amp;page=0&amp;anchor=5" class="addthx" data-post="142355"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]NIKOLA[/b]','')">NIKOLA</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/247.jpg" alt=""><br><span class=txtSm>Ранг: 500.6 (<b>!</b>), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.87'>Активность: 0.26<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=247">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2007 22:02 <br><script type="text/javascript">QU('NIKOLA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NIKOLA" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9116.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>DivisionByZero пишет:<br>Могу залить рабочий ехешник </I><br><br>Нужно чтобы он ещё и запускался на другой машине.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=142359&amp;user=247&amp;forum_n=1&amp;topic=9116.html&amp;page=0&amp;anchor=6" class="addthx" data-post="142359"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]deNULL[/b]','')">deNULL</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 174.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.83'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=321">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2007 22:02 <br><script type="text/javascript">QU('deNULL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=deNULL" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9116.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>DivisionByZero пишет:<br>Могу залить рабочий ехешник (1,38 МВ), подскажите, куда и как? </I><br>Куда - RapidShare http://www.rapidshare.com/ , WebFile http://www.webfile.ru/ , вестимо. А как - ну, руками, наверное <img src="img/smilies/s1.gif" alt=""> Там всё интуитивно понятно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=142360&amp;user=321&amp;forum_n=1&amp;topic=9116.html&amp;page=0&amp;anchor=7" class="addthx" data-post="142360"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Wild_One[/b]','')">Wild_One</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.3 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.45'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1158">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2007 22:21 <br><script type="text/javascript">QU('Wild_One','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wild_One" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9116.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Так и правда &quot;хер его знает&quot;. Хоть ответь на следующие вопросы:<br>Что происходит при срабатывании перехода:<br>004060D5 . 83F8 03 CMP EAX,3 <br>004060D8 . 0F85 8E000000 JNZ VideoCha.0040616C // если  [ESI+7F4]&lt;&gt;3, то переходим  куда-то<br><br>0040318B |. 57 PUSH EDI 						// а что в edi? значение часто используется<br><br>что содержится в Eax и [eax] при выполнении инструкции по адресу 00402E0A? (нужен дамп близлежащей памяти [eax])<br><br>Трасса программы (какие переходы исполняются) ?<br><br>Исследование лучше всего начинать не с начала проверки ключа, а с конца. Нам нужно значение eax на выходе из процедуры проверки. Его и отлавливаем. <br>В данном случае основная проверка должна быть <br>00402D1A |. E8 15EDFFFF CALL VideoCha.00401A34 <br>или<br>00402D1A |. E8 15EDFFFF CALL VideoCha.00401A34 <br><br>Какова длина ключей и какие они (из кейгенов других версий)?<br><br>Теперь насчет того, что вывод хорошего сообщения не ведет к нужным последствиям. Тут либо при основной проверке результат дополнительно сохраняется в глобальных переменных либо после вывода сообщения дополнительная проверка. Отследить можно через аппаратные брякпоинты. В окне памяти Ольки выделяешь нужный байт далее ПКМ -&gt;Breakpoint-&gt;Hardware, on access-&gt; Byte или DWORD<br>Когда программа обратится к указанному байту, олька остановится.<br>Отследи таким все обращения к памяти, где содержится введенны тобой ключ.<br>А экзешник отдельно от других файлов из папки запускается?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=142366&amp;user=1158&amp;forum_n=1&amp;topic=9116.html&amp;page=0&amp;anchor=8" class="addthx" data-post="142366"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]DivisionByZero[/b]','')">DivisionByZero</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.07'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=12041">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2007 22:35 &middot; Поправил: DivisionByZero <br><script type="text/javascript">QU('DivisionByZero','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DivisionByZero" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9116.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Ехешник тута http://rapidshare.com/files/38382277/VideoCharge.exe.html , у меня он запускался<br>даже после удаления программы и всех её ключей из реестра.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=142369&amp;user=12041&amp;forum_n=1&amp;topic=9116.html&amp;page=0&amp;anchor=9" class="addthx" data-post="142369"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]RSI[/b]','')">RSI</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 284.8 (наставник), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6361">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2007 23:14 <br><script type="text/javascript">QU('RSI','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=RSI" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9116.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>DivisionByZero</b><br>Ну что тебе сказать если терпения хватит тогда сможешь разобраться:<br>Вот функция проверки: (начало)<br><br>00403174  /&#036; 55             PUSH EBP<br>00403175  |. 8D6C24 88      LEA EBP,DWORD PTR SS:[ESP-78]<br>00403179  |. 81EC 14020000  SUB ESP,214<br>0040317F  |. A1 00E94900    MOV EAX,DWORD PTR DS:[49E900]<br>00403184  |. 53             PUSH EBX<br>00403185  |. 56             PUSH ESI<br>00403186  |. 57             PUSH EDI<br>00403187  |. 8BF1           MOV ESI,ECX<br>00403189  |. 33FF           XOR EDI,EDI<br>0040318B  |. 57             PUSH EDI<br>0040318C  |. 8D8E 10040000  LEA ECX,DWORD PTR DS:[ESI+410]<br>00403192  |. 8945 74        MOV DWORD PTR SS:[EBP+74],EAX<br>00403195  |. E8 6DFCFFFF    CALL VideoCha.00402E07                                      -&gt; Переводим в числа SN<br>0040319A  |. 57             PUSH EDI<br>0040319B  |. 8D8E 0C040000  LEA ECX,DWORD PTR DS:[ESI+40C]<br>004031A1  |. 8BD8           MOV EBX,EAX<br>004031A3  |. E8 5FFCFFFF    CALL VideoCha.00402E07                                       -&gt; Переводим в числа ID<br>004031A8  |. 57             PUSH EDI<br>004031A9  |. 8D8E F4050000  LEA ECX,DWORD PTR DS:[ESI+5F4]<br>004031AF  |. 8945 04        MOV DWORD PTR SS:[EBP+4],EAX<br>004031B2  |. E8 50FCFFFF    CALL VideoCha.00402E07                                      -&gt; Переводим Актив. ключ<br>004031B7  |. 8945 24        MOV DWORD PTR SS:[EBP+24],EAX<br>004031BA  |. 33F6           XOR ESI,ESI<br>004031BC  |. 8D45 54        LEA EAX,DWORD PTR SS:[EBP+54]<br>004031BF  |. 53             PUSH EBX<br>004031C0  |. 46             INC ESI<br>004031C1  |. 50             PUSH EAX<br>004031C2  |. 8975 30        MOV DWORD PTR SS:[EBP+30],ESI                            -&gt; заносим в память 1<br>004031C5  |. E8 73E6FFFF    CALL VideoCha.0040183D<br>004031CA  |. 84C0           TEST AL,AL<br>004031CC  |. 59             POP ECX<br>004031CD  |. 59             POP ECX<br>004031CE  |. 75 03          JNZ SHORT VideoCha.004031D3                                   <br><br>Дальше идет туева хуча проверок, с кучей математических действий ( прям как шифрование )<br><br>И вот конец функции:<br><br>00405997  |. 0BC2              OR EAX,EDX<br>00405999  |. 0BC1              OR EAX,ECX<br>0040599B  |. 3BC6              CMP EAX,ESI<br>0040599D  |. 5E                POP ESI<br>0040599E  |. 5B                POP EBX<br>0040599F  |. 74 04             JE SHORT VideoCha.004059A5<br>004059A1  |. 8365 30 00        AND DWORD PTR SS:[EBP+30],0<br>004059A5  |&gt; 8B4D 74           MOV ECX,DWORD PTR SS:[EBP+74]<br>004059A8  |. 8B45 30           MOV EAX,DWORD PTR SS:[EBP+30]                         &lt; - EAX = [EBP+30]<br>004059AB  |. E8 294B0500       CALL VideoCha.0045A4D9 <br>004059B0  |. 83C5 78           ADD EBP,78<br>004059B3  |. C9                LEAVE<br>004059B4  \. C3                RETN<br><br>Одним словом бери трассируй и делай так чтобы после всех проверок у тебя в [ebp+30] осталась 1 это и будет правильная регистрация <img src="img/smilies/s2.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=142373&amp;user=6361&amp;forum_n=1&amp;topic=9116.html&amp;page=0&amp;anchor=10" class="addthx" data-post="142373"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Wild_One[/b]','')">Wild_One</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.3 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.45'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1158">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июня 2007 00:06 <br><script type="text/javascript">QU('Wild_One','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wild_One" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9116.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Нет, так не катит.<b>RSI</b> мне показалось или результат тот же: при запуске прога считает себя незарегенной.<br> Там же пишут, что программу нужно перезапустить (считай проверка кода при запуске программы). По адресу 00402AB1 считывается значение ключей из реестра. Далее переходим на 2 retn вверх и там проверка полученных значений. Писать кейген на это нерентабельно. Лечение геморроя обойдется дороже <img src="img/smilies/s1.gif" alt=""><br>Но можешь там поковыряться на предмет патчинга.<br><br><b>DivisionByZero</b>, тебе же просто нужно чтобы прога не домогалась этим окошком при запуске? Тогда можно заставить диалоговое окно закрываться, до его появления и запускать программу. Дилог создается CreateDialogIndirectParam.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=142377&amp;user=1158&amp;forum_n=1&amp;topic=9116.html&amp;page=0&amp;anchor=11" class="addthx" data-post="142377"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]RSI[/b]','')">RSI</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 284.8 (наставник), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6361">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июня 2007 11:55 <br><script type="text/javascript">QU('RSI','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=RSI" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9116.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>Wild_One</b><br>Епть я тока показал функцию проверки! Если подберешь по ней ключ он будет работать...<br><br>А так ищи по сигнатуре похожую дублирующую функцию проверки, тогда не будет нага!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=142439&amp;user=6361&amp;forum_n=1&amp;topic=9116.html&amp;page=0&amp;anchor=12" class="addthx" data-post="142439"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]DivisionByZero[/b]','')">DivisionByZero</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.07'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=12041">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 июня 2007 21:13 <br><script type="text/javascript">QU('DivisionByZero','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DivisionByZero" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9116.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Да уж, разобраться с подпрограммой проверки кода, текст которой занимает 53(!) страницы, конечно<br>можно, но уж очень это хлопотно <img src="img/smilies/s11.gif" alt="">. Обойти процедуру вывода первого диалога пока тоже не<br>получается, да оно мне и не мешает. Похоже, проще будет просто сбрасывать trial каждые 20 дней - <br>это 5-7 минут.<br>Спасибо всем, кто откликнулся!<br>Тема закрыта.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=143669&amp;user=12041&amp;forum_n=1&amp;topic=9116.html&amp;page=0&amp;anchor=13" class="addthx" data-post="143669"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите разобраться с генерацией SN, который не содержится в памяти в явном виде</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=9116" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
