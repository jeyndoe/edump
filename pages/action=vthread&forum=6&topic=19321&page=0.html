<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Delphi, получить значение EAX - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="В Olly ставлю бряк допустим по адресу 0045AB38 PUSH DWORD PTR DS:[EAX+60] В дампе получаю значение лежащее в памяти по адресу EAX+60 Как программно можно узнать значение EAX если оно динамично и получить значение по EAX+60?">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55953'>laslo</a>, <a target='_blank' href='?action=userinfo&amp;user=1288'>UniSoft</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Delphi, получить значение EAX</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Terminate[/b]','')">Terminate</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.07'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29414">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 декабря 2011 21:22 <br><script type="text/javascript">QU('Terminate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Terminate" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
В Olly ставлю бряк допустим по адресу 0045AB38  PUSH DWORD PTR DS:[EAX+60]<br>В дампе получаю значение лежащее в памяти по адресу EAX+60<br><br>Как программно можно узнать значение EAX если оно динамично и получить значение по EAX+60?<br><br>ReadProcessMemory(Handle, EAX+60, Buffer, SizeOf(Buffer), BytesRead);
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=296901&amp;user=29414&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=1" class="addthx" data-post="296901"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 декабря 2011 21:33 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
http://msdn.microsoft.com/en-us/library/windows/desktop/ms679362(v=VS.85).aspx
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=296905&amp;user=2775&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=2" class="addthx" data-post="296905"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Promix_17[/b]','')">Promix_17</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 37.1 (посетитель), 11thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.61'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=27050">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 декабря 2011 21:34 <br><script type="text/javascript">QU('Promix_17','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Promix_17" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Сначала нужно получить само значение регистра EAX. Код примерно следующий:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">hThread<span class="hl_char">=</span>OpenThread<span class="hl_char">(</span>THREAD_GET_CONTEXT<span class="hl_char">,</span>&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">thread_context<span class="hl_char">.</span>ContextFlags&nbsp;<span class="hl_char">=</span>&nbsp;CONTEXT_ALL<span class="hl_comment">;</span></li><li class="hl_l0">GetThreadContext<span class="hl_char">(</span>hThread<span class="hl_char">,</span><span class="hl_char">&amp;</span>thread_context<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">ReadProcessMemory<span class="hl_char">(</span>Handle<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>void</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>thread_context<span class="hl_char">.</span><span class="hl_registr">Eax</span><span class="hl_char">+</span><span class="hl_number">60</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;Buffer<span class="hl_char">,</span>&nbsp;<span class="hl_function">SizeOf</span><span class="hl_char">(</span>Buffer<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;BytesRead<span class="hl_char">)</span><span class="hl_comment">; </span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=296906&amp;user=27050&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=3" class="addthx" data-post="296906"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Terminate[/b]','')">Terminate</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.07'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29414">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 декабря 2011 22:51 <br><script type="text/javascript">QU('Terminate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Terminate" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function">const</span></li><li class="hl_l1">&nbsp;&nbsp;THREAD_ALL_ACCESS&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">2032639</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;CONTEXT_ALL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">524351</span><span class="hl_comment">;</span></li><li class="hl_l1">var</li><li class="hl_l0">&nbsp;&nbsp;TreadContext<span class="hl_char">:</span>&nbsp;TContext<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ThreadRecord<span class="hl_char">:</span>&nbsp;TThreadEntry32<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;BytesRead<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>DWord</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ThreadHandle<span class="hl_char">:</span>&nbsp;THandle<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;Buffer&nbsp;<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>DWord</b></span><span class="hl_comment">;</span></li><li class="hl_l1">begin</li><li class="hl_l0">&nbsp;&nbsp;ThreadHandle&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;OpenThread<span class="hl_char">(</span>THREAD_ALL_ACCESS<span class="hl_char">,</span>&nbsp;<span class="hl_function">False</span><span class="hl_char">,</span>&nbsp;ThreadRecord<span class="hl_char">.</span>th32ThreadID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;TreadContext<span class="hl_char">.</span>ContextFlags&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;CONTEXT_ALL<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;GetThreadContext<span class="hl_char">(</span>ThreadHandle<span class="hl_char">,</span>&nbsp;TreadContext<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ReadProcessMemory<span class="hl_char">(</span>ThreadHandle<span class="hl_char">,</span>&nbsp;PChar<span class="hl_char">(</span>TreadContext<span class="hl_char">.</span><span class="hl_registr">EAX</span><span class="hl_char">+</span><span class="hl_number">60</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;@Buffer<span class="hl_char">,</span>&nbsp;<span class="hl_function">SizeOf</span><span class="hl_char">(</span>Buffer<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;BytesRead<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ShowMessage<span class="hl_char">(</span>PChar<span class="hl_char">(</span>@Buffer<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>ThreadHandle<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>Получилось так, но EAX в в чужой запущенной программе, как мне теперь подвязать это к чужой программе?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=296913&amp;user=29414&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=4" class="addthx" data-post="296913"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 декабря 2011 23:08 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Чет вопрос не понятен.
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=296914&amp;user=2775&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=5" class="addthx" data-post="296914"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Terminate[/b]','')">Terminate</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.07'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29414">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 декабря 2011 23:21 <br><script type="text/javascript">QU('Terminate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Terminate" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Чужая программа запущенна и работает, нужно написать код, чтобы изменить значение в её адресном пространстве, а чтобы найти адрес значения в памяти нужно брякнуть 0045AB38 PUSH DWORD PTR DS:[EAX+60] и по адресу EAX+60, будет значение, но EAX динамичен и адреса в памяти разные.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=296918&amp;user=29414&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=6" class="addthx" data-post="296918"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 декабря 2011 23:42 <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
пишите свой мини-отладчик, который будет запускать прогу, ставить бряк, и после срабатывания бряка читать контекст<br><br>PE_Kill выкладывал где-то тут сырки своего отладчика (TDebugger вроде назывался)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=296919&amp;user=10534&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=7" class="addthx" data-post="296919"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Terminate[/b]','')">Terminate</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.07'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29414">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 декабря 2011 23:51 <br><script type="text/javascript">QU('Terminate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Terminate" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Нет, я не пишу отладчик, мне нужно лишь прочитать значение в памяти по адресу, который постоянно меняется.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=296920&amp;user=29414&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=8" class="addthx" data-post="296920"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 00:19 <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>Terminate</b><br>Или отладчик или запись прыжка зацикленного на себя. Другого не дано. <b>tihiy_grom</b> верно сказал
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=296923&amp;user=2777&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=9" class="addthx" data-post="296923"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Terminate[/b]','')">Terminate</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.07'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29414">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 00:32 <br><script type="text/javascript">QU('Terminate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Terminate" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Ясно. Всем спасибо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=296925&amp;user=29414&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=10" class="addthx" data-post="296925"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]yanus0[/b]','')">yanus0</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 137.9 (ветеран), 45thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.35'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10382">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 02:42 <br><script type="text/javascript">QU('yanus0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=yanus0" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>Terminate</b><br>я думаю не приват:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">unit&nbsp;Unit1<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">interface</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function">uses</span></li><li class="hl_l1">&nbsp;&nbsp;Windows<span class="hl_char">,</span>&nbsp;Messages<span class="hl_char">,</span>&nbsp;SysUtils<span class="hl_char">,</span>&nbsp;Variants<span class="hl_char">,</span>&nbsp;Classes<span class="hl_char">,</span>&nbsp;Graphics<span class="hl_char">,</span>&nbsp;Controls<span class="hl_char">,</span>&nbsp;Forms<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;Dialogs<span class="hl_char">,</span>&nbsp;StdCtrls<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">type</li><li class="hl_l1">&nbsp;&nbsp;TForm1&nbsp;<span class="hl_char">=</span>&nbsp;class<span class="hl_char">(</span>TForm<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;eName<span class="hl_char">:</span>&nbsp;TEdit<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;ePass<span class="hl_char">:</span>&nbsp;TEdit<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;btnSniff<span class="hl_char">:</span>&nbsp;TButton<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;btnClose<span class="hl_char">:</span>&nbsp;TButton<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;lblLog<span class="hl_char">:</span>&nbsp;TLabel<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;Button1<span class="hl_char">:</span>&nbsp;TButton<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;procedure&nbsp;btnSniffClick<span class="hl_char">(</span>Sender<span class="hl_char">:</span>&nbsp;TObject<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;procedure&nbsp;Button1Click<span class="hl_char">(</span>Sender<span class="hl_char">:</span>&nbsp;TObject<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;private</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;Private&nbsp;declarations&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function">public</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span class="hl_function"><b>Public</b></span>&nbsp;declarations&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">var</li><li class="hl_l1">&nbsp;&nbsp;Form1<span class="hl_char">:</span>&nbsp;TForm1<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;WantToClose<span class="hl_char">:</span>&nbsp;boolean&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>false</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function">const</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function">LOOP</span><span class="hl_char">:</span>&nbsp;array&nbsp;<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;of&nbsp;<span class="hl_function"><b>Byte</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">$</span>EB<span class="hl_char">,</span><span class="hl_char">$</span>FE<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">$</span><span class="hl_number">0044D10F</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;addr1&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">$</span><span class="hl_number">0040130a</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">implementation</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">{<span class="hl_char">$</span>R&nbsp;<span class="hl_char">*</span><span class="hl_char">.</span>dfm}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">function&nbsp;SniffSerial<span class="hl_char">(</span>PI<span class="hl_char">:</span>&nbsp;PROCESS_INFORMATION<span class="hl_comment">; Ctx: _Context): string;</span></li><li class="hl_l0">var</li><li class="hl_l1">&nbsp;&nbsp;X<span class="hl_char">:</span>&nbsp;Cardinal<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;Buff<span class="hl_char">:</span>&nbsp;PChar<span class="hl_comment">;</span></li><li class="hl_l1">begin</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;выделяем&nbsp;немного&nbsp;памяти</li><li class="hl_l1">&nbsp;&nbsp;GetMem<span class="hl_char">(</span>Buff<span class="hl_char">,</span><span class="hl_number">50</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;останавливаем&nbsp;программу<span class="hl_char">,</span>&nbsp;чтобы&nbsp;получить&nbsp;контекст</li><li class="hl_l0">&nbsp;&nbsp;SuspendThread<span class="hl_char">(</span>PI<span class="hl_char">.</span>hThread<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;GetThreadContext<span class="hl_char">(</span>PI<span class="hl_char">.</span>hThread<span class="hl_char">,</span>Ctx<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;считываем&nbsp;<span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">(</span>правильный&nbsp;серийный&nbsp;номер<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;ReadProcessMemory<span class="hl_char">(</span>PI<span class="hl_char">.</span>hProcess<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span>Ctx<span class="hl_char">.</span><span class="hl_registr">Edx</span><span class="hl_char">)</span><span class="hl_char">,</span>Buff<span class="hl_char">,</span><span class="hl_number">50</span><span class="hl_char">,</span>X<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;устанавливаем&nbsp;результат&nbsp;и&nbsp;освобождаем&nbsp;буффер</li><li class="hl_l1">&nbsp;&nbsp;Result<span class="hl_char">:</span><span class="hl_char">=</span>Trim<span class="hl_char">(</span>Buff<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;FreeMem<span class="hl_char">(</span>Buff<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">procedure&nbsp;TForm1<span class="hl_char">.</span>btnSniffClick<span class="hl_char">(</span>Sender<span class="hl_char">:</span>&nbsp;TObject<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">var</li><li class="hl_l1">&nbsp;&nbsp;PI<span class="hl_char">:</span>&nbsp;PROCESS_INFORMATION<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_registr">SI</span><span class="hl_char">:</span>&nbsp;STARTUPINFO<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;Context<span class="hl_char">:</span>&nbsp;_CONTEXT<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;Buffer<span class="hl_char">:</span>&nbsp;PChar<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ORIG<span class="hl_char">:</span>&nbsp;array&nbsp;<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;of&nbsp;<span class="hl_function"><b>Byte</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;S<span class="hl_char">:</span>&nbsp;string<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;W<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>DWORD</b></span><span class="hl_comment">;</span></li><li class="hl_l0">begin</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;дисаблим&nbsp;кнопку&nbsp;<span class="hl_char">(</span>избегаем&nbsp;запуска&nbsp;цели&nbsp;несколько&nbsp;раз<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;btnSniff<span class="hl_char">.</span>Enabled&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>False</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;выделяем&nbsp;паямть&nbsp;и&nbsp;инициализируем&nbsp;вары</li><li class="hl_l0">&nbsp;&nbsp;GetMem<span class="hl_char">(</span>Buffer<span class="hl_char">,</span>&nbsp;<span class="hl_number">255</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;FillChar<span class="hl_char">(</span>PI<span class="hl_char">,</span>&nbsp;<span class="hl_function">SizeOf</span><span class="hl_char">(</span>TProcessInformation<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;#0<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;FillChar<span class="hl_char">(</span><span class="hl_registr">SI</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">SizeOf</span><span class="hl_char">(</span>TStartupInfo<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;#0<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_registr">SI</span><span class="hl_char">.</span>cb&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">SizeOf</span><span class="hl_char">(</span><span class="hl_registr">SI</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>создаём&nbsp;процесс&nbsp;<span class="hl_char">(</span>засуспеженный<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;CreateProcess<span class="hl_char">(</span><span class="hl_quote">'1.exe'</span><span class="hl_char">,</span>&nbsp;nil<span class="hl_char">,</span>&nbsp;nil<span class="hl_char">,</span>&nbsp;nil<span class="hl_char">,</span>&nbsp;<span class="hl_function">False</span><span class="hl_char">,</span>&nbsp;CREATE_SUSPENDED<span class="hl_char">,</span>&nbsp;nil<span class="hl_char">,</span>&nbsp;nil<span class="hl_char">,</span>&nbsp;<span class="hl_registr">SI</span><span class="hl_char">,</span>&nbsp;PI<span class="hl_char">)</span>&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;активируем&nbsp;кнопку</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;btnSniff<span class="hl_char">.</span>Enabled&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>True</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;устанавливаем&nbsp;новый&nbsp;лог</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;lblLog<span class="hl_char">.</span>Caption&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_quote">'Failed to load process!'</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;Exit<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;читаем&nbsp;оригинальные&nbsp;байты</li><li class="hl_l0">&nbsp;&nbsp;ReadProcessMemory<span class="hl_char">(</span>PI<span class="hl_char">.</span>hProcess<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span><span class="hl_function">addr</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;@ORIG<span class="hl_char">,</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">,</span>&nbsp;W<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;пишем&nbsp;непрерывный&nbsp;цикл</li><li class="hl_l0">&nbsp;&nbsp;WriteProcessMemory<span class="hl_char">(</span>PI<span class="hl_char">.</span>hProcess<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span><span class="hl_function">addr</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;@LOOP<span class="hl_char">,</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">,</span>&nbsp;W<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;восставнавливаем&nbsp;работу&nbsp;программы</li><li class="hl_l0">&nbsp;&nbsp;ResumeThread<span class="hl_char">(</span>PI<span class="hl_char">.</span>hThread<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;Context<span class="hl_char">.</span>ContextFlags&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">$</span><span class="hl_number">00010000</span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">15</span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_char">$</span><span class="hl_number">10</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;устанавливаем&nbsp;новый&nbsp;лог</li><li class="hl_l1">&nbsp;&nbsp;lblLog<span class="hl_char">.</span>Caption&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_quote">'Process patched!'</span>&nbsp;<span class="hl_char">+</span>&nbsp;#13&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_quote">'Now enter a name and press the &quot;Check&quot; button...'</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;GetThreadContext<span class="hl_char">(</span>PI<span class="hl_char">.</span>hThread<span class="hl_char">,</span>&nbsp;Context<span class="hl_char">)</span>&nbsp;do</li><li class="hl_l1">&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;проверяем&nbsp;достигли&nbsp;ли&nbsp;мы&nbsp;цикла<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;Context<span class="hl_char">.</span>Eip&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;получаем&nbsp;серийный&nbsp;номер&nbsp;и&nbsp;кладём&nbsp;его&nbsp;в&nbsp;<span class="hl_quote">&quot;S&quot;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;SniffSerial<span class="hl_char">(</span>PI<span class="hl_char">,</span>&nbsp;Context<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;восстанавливаем&nbsp;оригинальныйе&nbsp;байты&nbsp;и&nbsp;продолжаем&nbsp;работу&nbsp;программы</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WriteProcessMemory<span class="hl_char">(</span>PI<span class="hl_char">.</span>hProcess<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span><span class="hl_function">addr</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;@ORIG<span class="hl_char">,</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">,</span>&nbsp;W<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ResumeThread<span class="hl_char">(</span>PI<span class="hl_char">.</span>hThread<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;копируем&nbsp;серийный&nbsp;номер&nbsp;в&nbsp;буффер&nbsp;обмена&nbsp;и&nbsp;устанавливаем&nbsp;новый&nbsp;лог</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ePass<span class="hl_char">.</span>Text&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;s<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblLog<span class="hl_char">.</span>Caption&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_quote">'Your serial has been copied to clipboard!'</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;ждём&nbsp;<span class="hl_number">10</span>&nbsp;миллисекунд</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;Sleep<span class="hl_char">(</span><span class="hl_number">10</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;Application<span class="hl_char">.</span>ProcessMessages<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;если&nbsp;пользователь&nbsp;хочет&nbsp;закрыть&nbsp;сниффер&nbsp;до&nbsp;выхода&nbsp;из&nbsp;программы<span class="hl_char">,</span>&nbsp;то&nbsp;закрываем&nbsp;и&nbsp;цель&nbsp;тоже</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;WantToClose&nbsp;then</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TerminateThread<span class="hl_char">(</span>PI<span class="hl_char">.</span>hThread<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Close<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;высвобождаем&nbsp;память&nbsp;выделенную&nbsp;в&nbsp;начале</li><li class="hl_l1">&nbsp;&nbsp;FreeMem<span class="hl_char">(</span>Buffer<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;активируем&nbsp;кнопку</li><li class="hl_l1">&nbsp;&nbsp;btnSniff<span class="hl_char">.</span>Enabled&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>True</b></span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">function&nbsp;SniffMain<span class="hl_char">(</span>ProcessName<span class="hl_char">:</span>&nbsp;string<span class="hl_comment">; Adress: Cardinal): string;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;function&nbsp;Sniff<span class="hl_char">(</span>PI<span class="hl_char">:</span>&nbsp;PROCESS_INFORMATION<span class="hl_comment">; Ctx: _Context): string;</span></li><li class="hl_l1">var</li><li class="hl_l0">&nbsp;&nbsp;X<span class="hl_char">:</span>&nbsp;Cardinal<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;Buff<span class="hl_char">:</span>&nbsp;PChar<span class="hl_comment">;</span></li><li class="hl_l0">begin</li><li class="hl_l1">&nbsp;&nbsp;GetMem<span class="hl_char">(</span>Buff<span class="hl_char">,</span><span class="hl_number">50</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;SuspendThread<span class="hl_char">(</span>PI<span class="hl_char">.</span>hThread<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;GetThreadContext<span class="hl_char">(</span>PI<span class="hl_char">.</span>hThread<span class="hl_char">,</span>Ctx<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ReadProcessMemory<span class="hl_char">(</span>PI<span class="hl_char">.</span>hProcess<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span>Ctx<span class="hl_char">.</span><span class="hl_registr">Edx</span><span class="hl_char">)</span><span class="hl_char">,</span>Buff<span class="hl_char">,</span><span class="hl_number">50</span><span class="hl_char">,</span>X<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;Result<span class="hl_char">:</span><span class="hl_char">=</span>Trim<span class="hl_char">(</span>Buff<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;FreeMem<span class="hl_char">(</span>Buff<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">function&nbsp;MemFind<span class="hl_char">(</span>ProcessHandle<span class="hl_char">:</span>&nbsp;Thandle<span class="hl_comment">; Addr: Cardinal; Value: array of byte; var RetAdr: Cardinal): boolean;</span></li><li class="hl_l0">var</li><li class="hl_l1">&nbsp;&nbsp;Mbi<span class="hl_char">:</span>&nbsp;TMemoryBasicInformation<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;Buf<span class="hl_char">:</span>&nbsp;PChar<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;gif<span class="hl_char">:</span>&nbsp;Pchar<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;I<span class="hl_char">,</span>&nbsp;J<span class="hl_char">:</span>&nbsp;Cardinal<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;BytesRead<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>Dword</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">begin</li><li class="hl_l0">&nbsp;Result&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>false</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;ProcessHandle&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">0</span>&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function">try</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;J&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;RetAdr&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;Result&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>false</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>VirtualQueryEx<span class="hl_char">(</span>ProcessHandle<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span><span class="hl_function">Addr</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;Mbi<span class="hl_char">,</span>&nbsp;<span class="hl_function">SizeOf</span><span class="hl_char">(</span>Mbi<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_char">(</span>RetAdr&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span>&nbsp;do</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>Mbi<span class="hl_char">.</span>State&nbsp;<span class="hl_char">=</span>&nbsp;MEM_COMMIT<span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span>Mbi<span class="hl_char">.</span>Protect&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;PAGE_GUARD<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;PAGE_GUARD<span class="hl_char">)</span>&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetMem<span class="hl_char">(</span>Buf<span class="hl_char">,</span>&nbsp;Mbi<span class="hl_char">.</span>RegionSize<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">try</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;ReadProcessMemory<span class="hl_char">(</span>ProcessHandle<span class="hl_char">,</span>&nbsp;Mbi<span class="hl_char">.</span>BaseAddress<span class="hl_char">,</span>&nbsp;Buf<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mbi<span class="hl_char">.</span>RegionSize<span class="hl_char">,</span>&nbsp;BytesRead<span class="hl_char">)</span>&nbsp;then</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;I&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;to&nbsp;BytesRead&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">SizeOf</span><span class="hl_char">(</span>Value<span class="hl_char">)</span>&nbsp;do</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_function">byte</span><span class="hl_char">(</span>Buf<span class="hl_char">[</span>I<span class="hl_char">]</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>Value<span class="hl_char">[</span>J<span class="hl_char">]</span><span class="hl_char">)</span>&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;J&nbsp;<span class="hl_char">&lt;</span>&nbsp;<span class="hl_function">SizeOf</span><span class="hl_char">(</span>Value<span class="hl_char">)</span>&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">Inc</span><span class="hl_char">(</span>j<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RetAdr&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;Cardinal<span class="hl_char">(</span>Mbi<span class="hl_char">.</span>BaseAddress<span class="hl_char">)</span>&nbsp;<span class="hl_char">+</span>&nbsp;I<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>true</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">end</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;J&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">end</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;Pchar<span class="hl_char">(</span><span class="hl_quote">'Failed to read process memory '</span>&nbsp;<span class="hl_char">+</span>&nbsp;IntToStr<span class="hl_char">(</span>GetLastError<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">''</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;finally</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FreeMem<span class="hl_char">(</span>Buf<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>Addr</b></span>&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>Addr</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;Mbi<span class="hl_char">.</span>RegionSize<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;finally</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function">end</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;MessageBox<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;Pchar<span class="hl_char">(</span><span class="hl_quote">'Failed to open process'</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">''</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">var</li><li class="hl_l0">&nbsp;&nbsp;PI<span class="hl_char">:</span>&nbsp;PROCESS_INFORMATION<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_registr">SI</span><span class="hl_char">:</span>&nbsp;STARTUPINFO<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;Context<span class="hl_char">:</span>&nbsp;_CONTEXT<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;Buffer<span class="hl_char">:</span>&nbsp;PChar<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ORIG<span class="hl_char">:</span>&nbsp;array&nbsp;<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;of&nbsp;<span class="hl_function"><b>Byte</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;S<span class="hl_char">:</span>&nbsp;string<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;W<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>DWORD</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;adr2<span class="hl_char">:</span>&nbsp;Cardinal<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;GetMem<span class="hl_char">(</span>Buffer<span class="hl_char">,</span>&nbsp;<span class="hl_number">255</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;FillChar<span class="hl_char">(</span>PI<span class="hl_char">,</span>&nbsp;<span class="hl_function">SizeOf</span><span class="hl_char">(</span>TProcessInformation<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;#0<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;FillChar<span class="hl_char">(</span><span class="hl_registr">SI</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">SizeOf</span><span class="hl_char">(</span>TStartupInfo<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;#0<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_registr">SI</span><span class="hl_char">.</span>cb&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">SizeOf</span><span class="hl_char">(</span><span class="hl_registr">SI</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;CreateProcess<span class="hl_char">(</span>pchar<span class="hl_char">(</span>ProcessName<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;nil<span class="hl_char">,</span>&nbsp;nil<span class="hl_char">,</span>&nbsp;nil<span class="hl_char">,</span>&nbsp;<span class="hl_function">False</span><span class="hl_char">,</span>&nbsp;CREATE_SUSPENDED<span class="hl_char">,</span>&nbsp;nil<span class="hl_char">,</span>&nbsp;nil<span class="hl_char">,</span>&nbsp;<span class="hl_registr">SI</span><span class="hl_char">,</span>&nbsp;PI<span class="hl_char">)</span>&nbsp;then</li><li class="hl_l1">&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;Exit<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;SuspendThread<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;ResumeThread<span class="hl_char">(</span>PI<span class="hl_char">.</span>hThread<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;Context<span class="hl_char">.</span>ContextFlags&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">$</span><span class="hl_number">00010000</span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">15</span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_char">$</span><span class="hl_number">10</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;GetThreadContext<span class="hl_char">(</span>PI<span class="hl_char">.</span>hThread<span class="hl_char">,</span>&nbsp;Context<span class="hl_char">)</span>&nbsp;do</li><li class="hl_l1">&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;Context<span class="hl_char">.</span>Eip&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;then</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ResumeThread<span class="hl_char">(</span>PI<span class="hl_char">.</span>hThread<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;s<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>Break</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;Sleep<span class="hl_char">(</span><span class="hl_number">10</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;Application<span class="hl_char">.</span>ProcessMessages<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>PI<span class="hl_char">.</span>hThread<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;FreeMem<span class="hl_char">(</span>Buffer<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">procedure&nbsp;TForm1<span class="hl_char">.</span>Button1Click<span class="hl_char">(</span>Sender<span class="hl_char">:</span>&nbsp;TObject<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">begin</li><li class="hl_l0">SniffMain<span class="hl_char">(</span><span class="hl_quote">'1.exe'</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function">end</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=296931&amp;user=10382&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=11" class="addthx" data-post="296931"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 05:42 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>yanus0</b> вся работа ведется с одним потоком, поэтому нужно смотреть основной ли поток мы хотим обрабатывать, иначе добавить функционал слежения за потоками.<br><br>&gt;&gt; function MemFind(ProcessHandle: Thandle; Addr: Cardinal; Value: array of byte; var RetAdr: Cardinal): boolean;<br>Очень опасно так писать. При таком подходе компилятор генерирует код, который копирует массив на стек и передает в качестве параметра весь массив на стеке, у меня были случаи переполнения стека из за этого. Лучше так:<br><br>function MemFind(ProcessHandle: Thandle; Addr: Cardinal; Value: PByteArray; var RetAdr: Cardinal): boolean;<br>***<br>if byte(Buf[I]) = (Value^[J]) then
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=296936&amp;user=3232&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=12" class="addthx" data-post="296936"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 14:02 <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>Terminate пишет:<br>Чужая программа запущенна и работает, нужно написать код, чтобы изменить значение в её адресном пространстве, а чтобы найти адрес значения в памяти нужно брякнуть 0045AB38 PUSH DWORD PTR DS:[EAX+60] и по адресу EAX+60, будет значение, но EAX динамичен и адреса в памяти разные. </I><br><br>а лодырь не канает ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=296959&amp;user=11974&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=13" class="addthx" data-post="296959"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Terminate[/b]','')">Terminate</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.07'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29414">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 15:41 <br><script type="text/javascript">QU('Terminate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Terminate" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>yanus0</b> Спасибо за исходник.<br>Из всего кода достаточно procedure btnSniffClick и function SniffSerial, но это при использовании как лоадера, а вот как подключится к существующему процессу без CreateProcess и без Аттача, вот это вопрос.<br><br>Я так понимаю нужно получить ID главного треда, только пока неясно как.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=296972&amp;user=29414&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=14" class="addthx" data-post="296972"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 15:51 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
В большинстве случаев значение еах есть где-то в памяти. Найдете где и сможете получать свое значение в любой момент через обычное чтение памяти. Почитайте про создание трейнеров и динамические значения в памяти.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=296974&amp;user=4618&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=15" class="addthx" data-post="296974"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 15:56 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>Terminate</b><br>Если используется аттач, то нужно делать, как в дебаггерах - DebugActiveProcess, перечислили все потоки в отлаживаемом приложении через те же Tool help, OpenThread для каждого потока, а на интересующее место CC (int3). Когда WaitForDebugEvent будет сигнализировать о срабатывании бряка, смотрим, наш ли бряк, GetThreadContext + ReadProcessMemory, декремент EIP, восстанавливаем затёртый байт, SetThreadContext, FlushInstructionCache, а в конце - DebugActiveProcessStop.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=296977&amp;user=6336&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=16" class="addthx" data-post="296977"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Terminate[/b]','')">Terminate</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.07'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29414">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 16:06 <br><script type="text/javascript">QU('Terminate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Terminate" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>Nightshade</b> В данном случае, значение EAX постоянно изменяется и чтобы получить правильные данные, нужно после определённых действий читать EAX.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=296978&amp;user=29414&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=17" class="addthx" data-post="296978"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Terminate[/b]','')">Terminate</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.07'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29414">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 16:14 <br><script type="text/javascript">QU('Terminate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Terminate" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>ARCHANGEL</b> В принципе, действия с отладкой я думаю тут и не потребуются, тут достаточно зациклить как в исходниках, только вот проблема с определением главного потока.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=296980&amp;user=29414&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=18" class="addthx" data-post="296980"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 16:16 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>Terminate</b><br>Да ну - всё гораздо проще. Если зациклили, то читайте контексты всех потоков и сравнивайте EIP с адресом, на котором зациклили. Если нашлось совпадение, то берёте из считанного контекста значение еах, читаете память, снимаете зацикливание и всё.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=296981&amp;user=6336&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=19" class="addthx" data-post="296981"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 17:38 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>Terminate пишет:<br>В данном случае, значение EAX постоянно изменяется и чтобы получить правильные данные, нужно после определённых действий читать EAX.  </I><br>Оно же не берется от балды, <b>Nightshade</b> всё правильно написал, только видимо ты не понимаешь сути, а реализовать пытаешься тупо по тому что в отладчике видел, в этом и проблема.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=296991&amp;user=3232&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=20" class="addthx" data-post="296991"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 18:24 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>Terminate</b><br>&gt;<b>PE_Kill выкладывал где-то тут сырки своего отладчика (TDebugger вроде назывался)</b><br><br>Не парься, найди компонент и используй его, там все просто...<br><br>Компонента создаст тебе процесс, остановит в нужном месте, и отдаст значение EAX, и все
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=296995&amp;user=2775&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=21" class="addthx" data-post="296995"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Terminate[/b]','')">Terminate</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.07'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29414">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 18:36 <br><script type="text/javascript">QU('Terminate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Terminate" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Что-то я таких компонентов не встречал, по запросу TDebugger выдаёт ссылки на отладчик для php.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=296996&amp;user=29414&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=22" class="addthx" data-post="296996"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Terminate[/b]','')">Terminate</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.07'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29414">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 19:58 <br><script type="text/javascript">QU('Terminate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Terminate" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
На основе вышеизложенного исходника, получился код:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">procedure&nbsp;TForm1<span class="hl_char">.</span>Button1Click<span class="hl_char">(</span>Sender<span class="hl_char">:</span>&nbsp;TObject<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function">const</span></li><li class="hl_l0">&nbsp;&nbsp;THREAD_ALL_ACCESS&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">2032639</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;CONTEXT_ALL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">524351</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function">LOOP</span><span class="hl_char">:</span>&nbsp;array&nbsp;<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;of&nbsp;<span class="hl_function"><b>Byte</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">$</span>EB<span class="hl_char">,</span><span class="hl_char">$</span>FE<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">var</li><li class="hl_l0">&nbsp;&nbsp;ORIG<span class="hl_char">:</span>&nbsp;array&nbsp;<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;of&nbsp;<span class="hl_function"><b>Byte</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;s<span class="hl_char">:</span>&nbsp;string<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;Buffer<span class="hl_char">:</span>&nbsp;PChar<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ProcessID<span class="hl_char">,</span>&nbsp;ThreadsID<span class="hl_char">,</span>&nbsp;Bytes<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>DWord</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ProcessHandle<span class="hl_char">:</span>&nbsp;THandle<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ThreadContext<span class="hl_char">:</span>&nbsp;TContext<span class="hl_comment">;</span></li><li class="hl_l0">begin</li><li class="hl_l1">&nbsp;&nbsp;ProcessHandle&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;FindWindow<span class="hl_char">(</span>nil<span class="hl_char">,</span>&nbsp;<span class="hl_quote">'Прога'</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;GetWindowThreadProcessId<span class="hl_char">(</span>ProcessHandle<span class="hl_char">,</span>&nbsp;@ProcessID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ProcessHandle&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;OpenProcess<span class="hl_char">(</span>PROCESS_ALL_ACCESS<span class="hl_char">,</span>&nbsp;<span class="hl_function">False</span><span class="hl_char">,</span>&nbsp;ProcessID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ThreadsID&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;CreateToolHelp32Snapshot<span class="hl_char">(</span>TH32CS_SNAPTHREAD<span class="hl_char">,</span>&nbsp;ProcessID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;OpenThread<span class="hl_char">(</span>THREAD_ALL_ACCESS<span class="hl_char">,</span>&nbsp;<span class="hl_function">False</span><span class="hl_char">,</span>&nbsp;ThreadsID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ThreadContext<span class="hl_char">.</span>ContextFlags&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;CONTEXT_ALL<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;SuspendThread<span class="hl_char">(</span>ThreadsID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ReadProcessMemory<span class="hl_char">(</span>ProcessHandle<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span><span class="hl_char">$</span><span class="hl_number">0045AB38</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;@ORIG<span class="hl_char">,</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">,</span>&nbsp;Bytes<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;WriteProcessMemory<span class="hl_char">(</span>ProcessHandle<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span><span class="hl_char">$</span><span class="hl_number">0045AB38</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;@LOOP<span class="hl_char">,</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">,</span>&nbsp;Bytes<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ResumeThread<span class="hl_char">(</span>ThreadsID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_function"><b>True</b></span>&nbsp;do</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetThreadContext<span class="hl_char">(</span>ThreadsID<span class="hl_char">,</span>&nbsp;ThreadContext<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;ThreadContext<span class="hl_char">.</span>EIP&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">$</span><span class="hl_number">0081E9F4</span>&nbsp;then</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SuspendThread<span class="hl_char">(</span>ThreadsID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetThreadContext<span class="hl_char">(</span>ThreadsID<span class="hl_char">,</span>&nbsp;ThreadContext<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadProcessMemory<span class="hl_char">(</span>ProcessHandle<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span>ThreadContext<span class="hl_char">.</span><span class="hl_registr">EAX</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;Buffer<span class="hl_char">,</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">,</span>&nbsp;Bytes<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;Trim<span class="hl_char">(</span>Buffer<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WriteProcessMemory<span class="hl_char">(</span>ProcessHandle<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span><span class="hl_char">$</span><span class="hl_number">0045AB38</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;@ORIG<span class="hl_char">,</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">,</span>&nbsp;Bytes<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ResumeThread<span class="hl_char">(</span>ThreadsID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ShowMessage<span class="hl_char">(</span>s<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sleep<span class="hl_char">(</span><span class="hl_number">10</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application<span class="hl_char">.</span>ProcessMessages<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>ProcessHandle<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>но он отрабатывает не правильно, программу он вроде зацикливает но EIP не находит.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=297001&amp;user=29414&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=23" class="addthx" data-post="297001"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]yanus0[/b]','')">yanus0</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 137.9 (ветеран), 45thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.35'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10382">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 20:34 <br><script type="text/javascript">QU('yanus0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=yanus0" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>Terminate</b><br>Под дебагером посмотри  что происходит.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=297005&amp;user=10382&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=24" class="addthx" data-post="297005"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 20:48 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>Terminate</b><br>Так вы ж хрень открываете:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;ThreadsID&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;CreateToolHelp32Snapshot<span class="hl_char">(</span>TH32CS_SNAPTHREAD<span class="hl_char">,</span>&nbsp;ProcessID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;OpenThread<span class="hl_char">(</span>THREAD_ALL_ACCESS<span class="hl_char">,</span>&nbsp;<span class="hl_function">False</span><span class="hl_char">,</span>&nbsp;ThreadsID<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=297006&amp;user=6336&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=25" class="addthx" data-post="297006"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 21:09 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
+1, снапшот открывает <img src="img/smilies/s1.gif" alt=""> <img src="img/smilies/s1.gif" alt=""> <img src="img/smilies/s1.gif" alt=""><br>Елы палы, апи же в мсдн описаны, как такую хуйню можно написать?
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=297010&amp;user=3232&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=26" class="addthx" data-post="297010"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=18316" title="28-12-2011 01:39, ранг:76.0" target="_blank">SReg</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Terminate[/b]','')">Terminate</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.07'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29414">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 21:19 &middot; Поправил: Terminate <br><script type="text/javascript">QU('Terminate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Terminate" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
Я подозревал, что в этом одна из проблем <img src="img/smilies/s5.gif" alt=""><br>Прочитал: &quot;If the function succeeds, it returns an open handle to the specified snapshot.&quot; оказывается хендл снимка <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=297014&amp;user=29414&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=27" class="addthx" data-post="297014"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 21:53 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>Terminate</b><br>Щас посмотрел ваш код дальше. О, господи! Святые небеса! Мало того, что снапшот открываете, так вы  не используете результат OpenThread, вы потом хэндл снапшота используете как хэндл потока для чтения контекста!
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=297020&amp;user=6336&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=28" class="addthx" data-post="297020"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Terminate[/b]','')">Terminate</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.07'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29414">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 22:10 <br><script type="text/javascript">QU('Terminate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Terminate" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#29');return false;">#29</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">procedure&nbsp;TForm1<span class="hl_char">.</span>Button1Click<span class="hl_char">(</span>Sender<span class="hl_char">:</span>&nbsp;TObject<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function">const</span></li><li class="hl_l0">&nbsp;&nbsp;THREAD_ALL_ACCESS&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">2032639</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;CONTEXT_ALL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">524351</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function">LOOP</span><span class="hl_char">:</span>&nbsp;array&nbsp;<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;of&nbsp;<span class="hl_function"><b>Byte</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">$</span>EB<span class="hl_char">,</span><span class="hl_char">$</span>FE<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">var</li><li class="hl_l0">&nbsp;&nbsp;PI<span class="hl_char">:</span>&nbsp;PROCESS_INFORMATION<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ORIG<span class="hl_char">:</span>&nbsp;array&nbsp;<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;of&nbsp;<span class="hl_function"><b>Byte</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;s<span class="hl_char">:</span>&nbsp;string<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;Buffer<span class="hl_char">:</span>&nbsp;PChar<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ThreadEntry<span class="hl_char">:</span>&nbsp;TThreadEntry32<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;SnapHandle<span class="hl_char">,</span>&nbsp;ProcessID<span class="hl_char">,</span>&nbsp;ThreadsID<span class="hl_char">,</span>&nbsp;Bytes<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>DWord</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ProcessHandle<span class="hl_char">:</span>&nbsp;THandle<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ThreadContext<span class="hl_char">:</span>&nbsp;TContext<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;Find<span class="hl_char">:</span>&nbsp;Boolean<span class="hl_comment">;</span></li><li class="hl_l1">begin</li><li class="hl_l0">&nbsp;&nbsp;ProcessHandle&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;FindWindow<span class="hl_char">(</span>nil<span class="hl_char">,</span>&nbsp;<span class="hl_quote">'Прога'</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;GetWindowThreadProcessId<span class="hl_char">(</span>ProcessHandle<span class="hl_char">,</span>&nbsp;@ProcessID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ProcessHandle&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;OpenProcess<span class="hl_char">(</span>PROCESS_ALL_ACCESS<span class="hl_char">,</span>&nbsp;<span class="hl_function">False</span><span class="hl_char">,</span>&nbsp;ProcessID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;SnapHandle&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;CreateToolHelp32Snapshot<span class="hl_char">(</span>TH32CS_SNAPTHREAD<span class="hl_char">,</span>&nbsp;ProcessID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ThreadEntry<span class="hl_char">.</span>dwSize&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">SizeOf</span><span class="hl_char">(</span>ThreadEntry<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;Find&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;Thread32First<span class="hl_char">(</span>SnapHandle<span class="hl_char">,</span>&nbsp;ThreadEntry<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;Find&nbsp;do</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;ProcessID&nbsp;<span class="hl_char">=</span>&nbsp;ThreadEntry<span class="hl_char">.</span>th32OwnerProcessID&nbsp;then</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThreadsID&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;ThreadEntry<span class="hl_char">.</span>th32ThreadID<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>Break</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Find&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;Thread32Next<span class="hl_char">(</span>SnapHandle<span class="hl_char">,</span>&nbsp;ThreadEntry<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>SnapHandle<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;OpenThread<span class="hl_char">(</span>THREAD_ALL_ACCESS<span class="hl_char">,</span>&nbsp;<span class="hl_function">False</span><span class="hl_char">,</span>&nbsp;ThreadsID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ThreadContext<span class="hl_char">.</span>ContextFlags&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;CONTEXT_ALL<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;SuspendThread<span class="hl_char">(</span>ThreadsID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ReadProcessMemory<span class="hl_char">(</span>ProcessHandle<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span><span class="hl_char">$</span><span class="hl_number">0081E9F4</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;@ORIG<span class="hl_char">,</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">,</span>&nbsp;Bytes<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;WriteProcessMemory<span class="hl_char">(</span>ProcessHandle<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span><span class="hl_char">$</span><span class="hl_number">0081E9F4</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;@LOOP<span class="hl_char">,</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">,</span>&nbsp;Bytes<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ResumeThread<span class="hl_char">(</span>ThreadsID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_function"><b>True</b></span>&nbsp;do</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetThreadContext<span class="hl_char">(</span>ThreadsID<span class="hl_char">,</span>&nbsp;ThreadContext<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;ThreadContext<span class="hl_char">.</span>EIP&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">$</span><span class="hl_number">0081E9F4</span>&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SuspendThread<span class="hl_char">(</span>ThreadsID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetThreadContext<span class="hl_char">(</span>ThreadsID<span class="hl_char">,</span>&nbsp;ThreadContext<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadProcessMemory<span class="hl_char">(</span>ProcessHandle<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span>ThreadContext<span class="hl_char">.</span><span class="hl_registr">EAX</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;Buffer<span class="hl_char">,</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">,</span>&nbsp;Bytes<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;Trim<span class="hl_char">(</span>Buffer<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WriteProcessMemory<span class="hl_char">(</span>ProcessHandle<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span><span class="hl_char">$</span><span class="hl_number">0081E9F4</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;@ORIG<span class="hl_char">,</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">,</span>&nbsp;Bytes<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ResumeThread<span class="hl_char">(</span>ThreadsID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ShowMessage<span class="hl_char">(</span>s<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sleep<span class="hl_char">(</span><span class="hl_number">10</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application<span class="hl_char">.</span>ProcessMessages<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>ProcessHandle<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><b>ARCHANGEL</b> как использовать результат от OpenThread? в SuspendThread(?);<br>Результат от OpenThread почему-то равен хендлу снапшота. <img src="img/smilies/s9.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=297024&amp;user=29414&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=29" class="addthx" data-post="297024"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 декабря 2011 22:42 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19321.html&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
надо понимать, что пишешь, а не бездумно копировать<br><br>http://vsokovikov.narod.ru/New_MSDN_API/Process_thread/fn_openthread.htm<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">hThread&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;OpenThread<span class="hl_char">(</span>THREAD_ALL_ACCESS<span class="hl_char">,</span>&nbsp;<span class="hl_function">False</span><span class="hl_char">,</span>&nbsp;ThreadsID<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">SuspendThread<span class="hl_char">(</span>hThread<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=297028&amp;user=72&amp;forum_n=6&amp;topic=19321.html&amp;page=0&amp;anchor=30" class="addthx" data-post="297028"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Delphi, получить значение EAX</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="19321">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19321" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
