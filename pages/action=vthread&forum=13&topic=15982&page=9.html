<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>VMProtect (Туторы, скрипты, плагины, ...) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Решил создать отдельную тему по VMProtect&#039;у, чтобы собирать в одном месте информацию по этому проту и обсуждать детали. Для начала ответ на самый распространенный вопрос. 1. Почему OllyDbg вылетает при запуске программы,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> VMProtect (Туторы, скрипты, плагины, ...)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=8.html">&lt;&lt;</a> <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=0.html">1</a> ... <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=8.html">9</a> . <b>10</b> . <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=10.html">11</a> . <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=11.html">12</a> . <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=12.html">13</a> . <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=13.html">14</a> . <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=14.html">15</a> . <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=10.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]kioresk[/b]','')">kioresk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/10650.gif" alt=""><br><span class=txtSm>Ранг: 154.2 (ветеран), 66thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10650">Участник</a><br><font color=blue>REVENGE Crew</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2010 11:56 &middot; Поправил: kioresk <br><script type="text/javascript">QU('kioresk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kioresk" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#1');return false;">#1</a> </span><div align=left><br>
Решил создать отдельную тему по VMProtect&#039;у, чтобы собирать в одном месте информацию по этому проту и обсуждать детали.<br><br>Для начала ответ на самый распространенный вопрос.<br><br><b>1. Почему OllyDbg вылетает при запуске программы, защищенной VMProtect&#039;ом?</b><br><br>Потому что VMProtect использует баг с переполнением буфера в старых версиях dbghelp.dll, из-за которого отладчик падает. Чтобы обойти его необходимо исправить баг в dbghelp.dll или положить в папку отладчика новую версию файла dbghelp.dll, который можно взять из комплекта Debugging Tools for Windows:<br><br><noindex><a href="http://www.microsoft.com/whdc/devtools/debugging/default.mspx" rel="nofollow" target="_blank">http://www.microsoft.com/whdc/devtools/debugging/default.mspx</a></noindex><br><br><b>Добавлено</b><br><br>Microsoft включил дистрибутив Debugging Tools в состав пакета Windows SDK (который весит достаточно прилично), поэтому вот альтернативные ссылки на:<br><br>1. <noindex><a href="http://www.revenge-crew.com/xchg/kio/Debugging_Tools_for_Windows_v6.12.2.633_x86.msi" rel="nofollow" target="_blank">Дистрибутив Debugging Tools v6.12.2.633 x86 от 26.02.2010</a></noindex> (18,3 Мбайт)<br><br>2. <noindex><a href="http://www.revenge-crew.com/xchg/kio/dbghelp_v6.12.2.633_x86.zip" rel="nofollow" target="_blank">Только библиотека dbghelp.dll из дистрибутива Debugging Tools v6.12.2.633 x86</a></noindex> (0,5 Мбайт)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=254206&amp;user=10650&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=1" class="addthx" data-post="254206"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]zolodei[/b]','')">zolodei</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.29'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28541">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2016 16:01 <br><script type="text/javascript">QU('zolodei','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zolodei" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#2');return false;">#2</a> </span><div align=left><br>
<b>MasterSoft</b>,  поставил, происходит ошибка, может галочки, не так поставил?<br><noindex><a href="http://rgho.st/8hml5rzqX" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367609&amp;user=28541&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=2" class="addthx" data-post="367609"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2016 17:18 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#3');return false;">#3</a> </span><div align=left><br>
<I>zolodei пишет:<br>поставил, происходит ошибка, может галочки, не так поставил? </I><br>ещё галку на NtSetInformationThread
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367610&amp;user=16624&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=3" class="addthx" data-post="367610"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=28541" title="14-09-2016 15:42, ранг:4.8" target="_blank">zolodei</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2016 17:32 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#4');return false;">#4</a> </span><div align=left><br>
<I>zolodei пишет:<br>поставил, происходит ошибка, может галочки, не так поставил? </I><br>А какой бряк ты ставишь? Если софт, то вмпрот их палит, нужен хард, и его ставить без разницы куда.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=367612&amp;user=20406&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=4" class="addthx" data-post="367612"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]zolodei[/b]','')">zolodei</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.29'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28541">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 сентября 2016 01:04 <br><script type="text/javascript">QU('zolodei','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zolodei" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#5');return false;">#5</a> </span><div align=left><br>
А как поставить &quot;Set memory breakpoint on access&quot; на секцию кода 00401000 в &quot;Memory map&quot; в версий OllyDBG v2.01?<br>И не подскажите, как сделать, чтоб в &quot;Memory map OllyDBG v2.01&quot; секций отображались как в &quot;Memory map OllyDBG v1.10&quot;?<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/a8dc_20.09.2016_EXELAB.rU.tgz">a8dc_20.09.2016_EXELAB.rU.tgz</a> - VMP.jpg
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367800&amp;user=28541&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=5" class="addthx" data-post="367800"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]script_kidis[/b]','')">script_kidis</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/39388.jpg" alt=""><br><span class=txtSm>Ранг: 56.2 (постоянный), 14thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.01'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=39388">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 сентября 2016 21:14 <br><script type="text/javascript">QU('script_kidis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=script_kidis" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#6');return false;">#6</a> </span><div align=left><br>
///offtop///<br>интересно если какое либо онлайн П0 <br>будет снабжено adware модулем по сбору инф.и отправке на сервер автора П0 в режиме демо <br>но при покупке в режиме фул этот модуль будет отключён,далее данную поделку накроют вм и отправят на vtotal<br>то работникам АВ компаний придётся изучить данный софт и выдвинуть вердикт через минут 5 мы увидим результат,я предпологаю его оставят как полезное ПО и не станут разворачивать и глядеть что в нутри потому что нет времяни на всё это прав ли я или нет?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367817&amp;user=39388&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=6" class="addthx" data-post="367817"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2016 00:44 <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#7');return false;">#7</a> </span><div align=left><br>
<I>script_kidis пишет:<br>прав ли я или нет?  </I><br>Не прав
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=367820&amp;user=2777&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=7" class="addthx" data-post="367820"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39388" title="21-09-2016 08:23, ранг:41.9" target="_blank">script_kidis</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2016 03:40 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#8');return false;">#8</a> </span><div align=left><br>
<b>script_kidis</b>, на первичной проверке уйдёт, как adware downloader, т.к. подозрительная активность на лицо. Копаться в вм для этого не нужно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367822&amp;user=2585&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=8" class="addthx" data-post="367822"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39388" title="21-09-2016 08:23, ранг:41.9" target="_blank">script_kidis</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]inf1kek[/b]','')">inf1kek</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/13233.png" alt=""><br><span class=txtSm>Ранг: 95.2 (постоянный), 26thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.82'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13233">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2016 04:22 <br><script type="text/javascript">QU('inf1kek','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=inf1kek" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#9');return false;">#9</a> </span><div align=left><br>
Да и сэндбоксы они не просто так себе пишут.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367823&amp;user=13233&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=9" class="addthx" data-post="367823"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39388" title="21-09-2016 08:22, ранг:41.9" target="_blank">script_kidis</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]uncown[/b]','')">uncown</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.72'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=41484">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2016 07:47 <br><script type="text/javascript">QU('uncown','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=uncown" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#10');return false;">#10</a> </span><div align=left><br>
модуль проги, (dll),  залочен vmp (файл1), унпакер выкинул два файла (DLLLoader.exe) и (ххх.clm.module), прога и модуль работают только с S..SEL.ck, как определить кто из этих двух просит ключег? если лоадер то чем прикрутить другой лоад к модулю? лоадер есть, почему унпакер разрезал длл? <br><br><img src="img/attach.gif" alt=""> <a href="./files/eb5c_28.10.2016_EXELAB.rU.tgz">eb5c_28.10.2016_EXELAB.rU.tgz</a> - скрин.png
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368927&amp;user=41484&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=10" class="addthx" data-post="368927"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2016 12:29 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#11');return false;">#11</a> </span><div align=left><br>
<I>uncown пишет:<br>прога и модуль работают только с S..SEL.ck, как определить кто из этих двух просит ключег? </I><br>SenseLock? Кто подгрузит hid.dll, тот виновен.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368936&amp;user=16624&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=11" class="addthx" data-post="368936"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]uncown[/b]','')">uncown</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.72'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=41484">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2016 18:12 <br><script type="text/javascript">QU('uncown','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=uncown" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#12');return false;">#12</a> </span><div align=left><br>
Подкидываю модуль в прошу предыдущих версию без сенса ключ просит модуль, а так как модуль разделился на лоадер и подпрограмму и возникает вопрос кто из них. Есть базовые модули из прошлой версии проги без сенса, унпакуются так же на две части, чем срастить лоадер из баз версии с подпрогр с новой? Чтоб целое получилось?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368951&amp;user=41484&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=12" class="addthx" data-post="368951"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]alexcoder1[/b]','')">alexcoder1</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.4 (гость), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.46'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=40168">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2016 02:57 &middot; Поправил: alexcoder1 <br><script type="text/javascript">QU('alexcoder1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=alexcoder1" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#13');return false;">#13</a> </span><div align=left><br>
Привет всем! Оказывается на днях поломал VMProtect. Сделал это, конечно, через одно место, сначала сделал, а затем разбирался что же такое ломал. Заранее прошу прощения если мои методы покажутся топорными. Начну изложение.<br>Исследование пациента и поиск OEP. Распаковка секций программы происходит внутри виртуальной машины ее байт-кодом. В момент когда искал OEP, я этого еще не понимал, думал просто жуткая обфускация. Поэтому поступил следующим способом. В OllyDbg поставил условные аппаратные бряки на версии GetModuleHandle(Ex,A,W) (в Olly 2.01). В условии указал [esp]&gt;=401000&amp;&amp;[esp]&lt;4d0000, остановка по условию. Бряк произошел на функции GetModuleHandleW. Вышел из функции и вуаля, я где-то в начале кода программы. Задампил процесс, загрузил дамп в IDA, текущий EIP использовал пока что в качестве OEP. В IDA при помощи перекрестных ссылок нашел вызов функции, из которой вызывается GetModuleHandleW, это и оказалось начало программы с настоящей EP. Зная OEP, поставил на него аппаратный бряк при следующем запуске Olly и я на месте. Теперь еще раз сделал дамп, но уже с настоящей OEP и загрузил его в IDA. На этот раз код раскрасился как новогодняя елка – определились сигнатуры Delphi, а после применения FLIRT определилось почти все.<br>Передо мной не стояла задача снятия протектора, нужно было исследовать метод генерации кода. Поэтому импорт не восстанавливал и не получал рабочую версию программы, хотя с восстановлением импорта были бы проблемы. Протектор (я пока еще не знал какой) заменяет все вызовы API на ближние вызовы в свою секцию, где пропускает их через свою обфускационную матрицу, в которой заново формирует стек для вызова и уже потом вызывает функцию API. Я не придумал ничего лучше чем залогировать все вызовы API по библиотекам. Для этого определяется список статически импортируемых модулей (на момент загрузки программы). Для каждого модуля для конкретной ОС определяются импортируемые функции. То есть, если программа исследуется на 7ке, то и адреса функций нужно получать на 7ке. Я применил DependencyWalker. Открываем в нем исследуемую программу, и по очереди переходим к каждой импортируемой библиотеке. В окне экспортируемых функций библиотеки выделяем их все, нажимаем Ctrl+A, Ctrl+C, создаем текстовый файл с именем этой библиотеки обязательно в формате kernel32.dll.txt, user32.dll.txt и  т.д. и в эти файлы заносим имена соответствующих функций этих библиотек. Далее все эти имена нужно преобразовать в списки точек останова для Olly Breakpoint Manager v0.1.<br>Все эти txt файлы должны находиться в одной папке. Я написал программу (просьба не пинать за ужасный стиль программирования, быдлокодер из меня знатный), исходник в файле kernel.cpp, обычное Win32 приложение. Она по очереди открывает все txt файлы в своей папке, построчно читает из них имена функций, ищет эту функцию в dll с именем до .txt и преобразовывает найденный адрес в точку останова для Olly Breakpoint Manager v0.1. То есть например был файл kernel32.dll.txt  с содержимым:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">ActivateActCtx</li><li class="hl_l1">AddAtomA</li><li class="hl_l0">AddAtomW</li><li class="hl_l1">AddConsoleAliasA</li><li class="hl_l0">AddConsoleAliasW</li>        </ol>
    </div>
</div></div>
<br>…<br>Получили kernel32.dll.obp:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">kernel32<span class="hl_char">:</span><span class="hl_number">00015458</span><span class="hl_char">:</span>K<span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">]</span><span class="hl_char">:</span><span class="hl_function">ADDR</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">]</span><span class="hl_char">&lt;</span><span class="hl_number">40000000</span></li><li class="hl_l1">kernel32<span class="hl_char">:</span><span class="hl_number">0002ED56</span><span class="hl_char">:</span>K<span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">]</span><span class="hl_char">:</span><span class="hl_function">ADDR</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">]</span><span class="hl_char">&lt;</span><span class="hl_number">40000000</span></li><li class="hl_l0">kernel32<span class="hl_char">:</span><span class="hl_number">0002CDEC</span><span class="hl_char">:</span>K<span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">]</span><span class="hl_char">:</span><span class="hl_function">ADDR</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">]</span><span class="hl_char">&lt;</span><span class="hl_number">40000000</span></li><li class="hl_l1">kernel32<span class="hl_char">:</span><span class="hl_number">000B6BEE</span><span class="hl_char">:</span>K<span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">]</span><span class="hl_char">:</span><span class="hl_function">ADDR</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">]</span><span class="hl_char">&lt;</span><span class="hl_number">40000000</span></li><li class="hl_l0">kernel32<span class="hl_char">:</span><span class="hl_number">000B6B84</span><span class="hl_char">:</span>K<span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">]</span><span class="hl_char">:</span><span class="hl_function">ADDR</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">]</span><span class="hl_char">&lt;</span><span class="hl_number">40000000</span></li>        </ol>
    </div>
</div></div>
<br>…<br>Нужно только ввести букву, которой кодируются флаги Pause program (never, on condition, always), log expression, log arguments, как они кодируются можно почитать в описании к плагину. Каждый бит отвечает за какой-то переключатель, эти биты складываются в байт и ASCII-символ этого байта и передается программе Для чего служат параметры, указанные через двоеточия, строки останова также можно также ознакомиться в описании плагина.<br>Условие [ESP]&lt;40000000 необходимо поскольку без него логирутся вызовы всех функций, даже когда они вызываю друг друга из разных системных библиотек, это сильно замедляет программу и усложняет анализ. Одна беда: Olly Breakpoint Manager v0.1 по умолчанию не позволяет ставить условия на точки останова! Поэтому пришлось его модифицировать, чтобы понимал. Но сделал только на половину – на чтение из файла (такое я ленивое существо). Данный плагин идет с исходниками, нужно только заменить модифицированный файл olly_bp_man.c. Кстати, Olly Breakpoint Manager я тестировал под Olly 1.10. Итак, когда плагин скомпилирован и подключен, сформированы все obp файлы, загружаем в olly исследуемую программу, и по очереди загружаем в плагин obp-файлы (все сразу не советую, слишком замедляется программа, может сработать защита по времени исполнения). Переходим в Log, перенаправляем его в файл, я использовал kernel32.txt для функций kernel32.dll и так далее, и запускаем программу. В результате получаем примерно следующий лог:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">750F4992</span>&nbsp;&nbsp;COND<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">00409A49</span></li><li class="hl_l1"><span class="hl_number">750F4992</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;to&nbsp;GetSystemInfo&nbsp;from&nbsp;cm17F<span class="hl_char">.</span><span class="hl_number">00409A44</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pSystemInfo&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0018FF1C</span></li><li class="hl_l1"><span class="hl_number">750F51EB</span>&nbsp;&nbsp;COND<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">004CB077</span></li><li class="hl_l0"><span class="hl_number">750F51EB</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;to&nbsp;GetCommandLineW&nbsp;from&nbsp;cm17F<span class="hl_char">.</span><span class="hl_number">004CB072</span></li><li class="hl_l1"><span class="hl_number">750F0E00</span>&nbsp;&nbsp;COND<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">004025A6</span></li><li class="hl_l0"><span class="hl_number">750F0E00</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;to&nbsp;GetStartupInfoA&nbsp;from&nbsp;cm17F<span class="hl_char">.</span><span class="hl_number">004025A1</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pStartupinfo&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0018FEF8</span></li><li class="hl_l0"><span class="hl_number">750F177C</span>&nbsp;&nbsp;COND<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">004CB08B</span></li><li class="hl_l1"><span class="hl_number">750F177C</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;to&nbsp;GetACP&nbsp;from&nbsp;cm17F<span class="hl_char">.</span><span class="hl_number">004CB086</span></li><li class="hl_l0"><span class="hl_number">750F1430</span>&nbsp;&nbsp;COND<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">004CB09F</span></li><li class="hl_l1"><span class="hl_number">750F1430</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;to&nbsp;GetCurrentThreadId&nbsp;from&nbsp;cm17F<span class="hl_char">.</span><span class="hl_number">004CB09A</span></li><li class="hl_l0"><span class="hl_number">750F442F</span>&nbsp;&nbsp;COND<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">00409A59</span></li><li class="hl_l1"><span class="hl_number">750F1AC5</span>&nbsp;&nbsp;COND<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0040BEDB</span></li><li class="hl_l0"><span class="hl_number">750F1AC5</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;to&nbsp;GetVersionExW&nbsp;from&nbsp;cm17F<span class="hl_char">.</span><span class="hl_number">0040BED6</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pVersionInformation&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0018FE2C</span></li><li class="hl_l0"><span class="hl_number">750F1836</span>&nbsp;&nbsp;COND<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">004029CF</span></li><li class="hl_l1"><span class="hl_number">750F1836</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;to&nbsp;VirtualAlloc&nbsp;from&nbsp;cm17F<span class="hl_char">.</span><span class="hl_number">004029CA</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Address&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Size&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">13FFF0</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">1310704</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AllocationType&nbsp;<span class="hl_char">=</span>&nbsp;MEM_COMMIT</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Protect&nbsp;<span class="hl_char">=</span>&nbsp;PAGE_READWRITE</li><li class="hl_l0"><span class="hl_number">750F4918</span>&nbsp;&nbsp;COND<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">004080DF</span></li><li class="hl_l1"><span class="hl_number">750F4918</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;to&nbsp;GetModuleFileNameW&nbsp;from&nbsp;cm17F<span class="hl_char">.</span><span class="hl_number">004080DA</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hModule&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">00400000</span>&nbsp;<span class="hl_char">(</span>cm17F<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PathBuffer&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0018DCE0</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufSize&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">20A</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">522</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1"><span class="hl_number">750F4918</span>&nbsp;&nbsp;COND<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">00408F59</span></li><li class="hl_l0"><span class="hl_number">750F4918</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;to&nbsp;GetModuleFileNameW&nbsp;from&nbsp;cm17F<span class="hl_char">.</span><span class="hl_number">00408F54</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hModule&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PathBuffer&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0018DACA</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufSize&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">105</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">261</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l0">…</li>        </ol>
    </div>
</div></div>
<br>При помощи регулярных выражений отделяем название функции и адрес ее вызова и в IDA вручную меняем их. Их, кстати, получилось не более двух сотен разных на все библиотеки. Теоретически после этого шага можно восстанавливать импорт, но я не стал.<br>Когда определены сигнатуры функций Delphi при помощи FLIRT и вызовы WinAPI, я начал искать вычисление кода. Flirt даже определил метод Click кнопки регистрации, я поставил бряк на метод @Controls@TControl@GetText&#036;qqrv, определенный им же. И вот тут то меня ждал сюрпайз. После получения введенного кода управление передавалось на нечто жутко обфусцированное и непонятное. После нескольких попыток протрассировать это вручную стал думать. В результате использовал инструмент Trace into из olly 2. Трассировал с аппаратными бряками. Проверка кода заняла более 300K инструкций x86! Начал изучать эти логи. Сначала пытался удалить незначащие инструкции и разобраться с алгоритмом, обнаружил что они часто повторяются, даже писал программу, которая удаляет строки из лога с EIP незначащих команд (эта программа промежуточное звено, потом она выпадает, и становится ненужной). Это немного сократило код и позволило найти общие закономерности, в частности начало каждой виртуальной команды. Затем начал разбирать что же делают эти команды. Оказалось виртуалка – это стековая машина по типу сопроцессора. Кроме стека есть область памяти, которую я назвал блоком регистров, состоящая из 16ти 32-х битных ячеек памяти. Все это хозяйство организовано в реальном стеке программы. На вершину стека виртуалки всегда указывает EBP. ESI играет роль EIP виртуальной машины. (Нет никакой гарантии, что в другой программе назначение регистров останется таким же). Основные команды: положить в стек числа разной разрядности, извлечь, косвенно положить (по адресу из вершины), косвенно извлечь (адрес в памяти и извлекаемое значение на вершине стека). Основными математико-логическими операциями являются NAND (Not-And) и ADD. Есть еще умножение, деление. Математические и логические операции могут производиться над 32-х битными целыми и 16-ти битными (я их назвал half). После каждой математической или логической операции кроме результата в стек записываются и флаги процессора. Практически всегда они извлекаются из стека в блок регистров и затем затираются, но при проверке условия как раз при помощи флагов и формируется адрес перехода. Условных переходов нет, есть только безусловный переход на адрес из вершины стека, а этот адрес уже формируется по флагам операций. Таким образом мне удалось вычислить для каждой виртуальной команды адреса eip ее реальных команд. В среднем на одну виртуальную команду приходится 60-100 реальных. Поэтому написал программу, которая заменяет блоки реальных команд на виртуальные, она находится в файле module1.vb, и которая для всех команд вытаскивает из текста их реальные операнды и результаты работы команд. Также кроме непосредственной замены сделал небольшую оптимизацию: после всех математических команд удалял извлечение флагов и помечал куда извлекается в комментарии математической/логической команды и явно пустые команды помечал в начале знаком #(на всякий случай не удалял). В результате получился подобный листинг:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0053440C</span><span class="hl_char">:</span>&nbsp;PUSHM&nbsp;<span class="hl_char">(</span><span class="hl_number">008DBA98</span><span class="hl_char">)</span></li><li class="hl_l1"><span class="hl_number">0053440A</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>PUSH</b></span><span style="word-break: break-all">&nbsp;ST0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;008DBA98</span></li><li class="hl_l0"><span class="hl_number">00534408</span><span class="hl_char">:</span><span style="word-break: break-all">&nbsp;NOTAND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;Before: st0 = 008DBA98, st1 = 008DBA98. After: st0=FLAGS, st1 = FF724567 FLAGS--&gt;0000003C(00200282)</span></li><li class="hl_l1"><span class="hl_number">00534405</span><span class="hl_char">:</span>&nbsp;PUSHM&nbsp;<span class="hl_number">00000018</span><span class="hl_char">(</span>F007549B<span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_number">00534403</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>PUSH</b></span><span style="word-break: break-all">&nbsp;ST0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;F007549B</span></li><li class="hl_l1"><span class="hl_number">00534401</span><span class="hl_char">:</span><span style="word-break: break-all">&nbsp;NOTAND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;Before: st0 = F007549B, st1 = F007549B. After: st0=FLAGS, st1 = 0FF8AB64 FLAGS--&gt;0000002C(00200202)</span></li><li class="hl_l0"><span class="hl_number">005343FE</span><span class="hl_char">:</span><span style="word-break: break-all">&nbsp;NOTAND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;Before: st0 = 0FF8AB64, st1 = FF724567. After: st0=FLAGS, st1 = 00051098 FLAGS--&gt;00000028(00200202)</span></li><li class="hl_l1"><span class="hl_number">005343FB</span><span class="hl_char">:</span>&nbsp;PUSHM&nbsp;<span class="hl_char">(</span><span class="hl_number">008DBA98</span><span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_number">005343F9</span><span class="hl_char">:</span>&nbsp;PUSHM&nbsp;<span class="hl_number">00000018</span><span class="hl_char">(</span>F007549B<span class="hl_char">)</span></li><li class="hl_l1"><span class="hl_number">005343F7</span><span class="hl_char">:</span><span style="word-break: break-all">&nbsp;NOTAND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;Before: st0 = F007549B, st1 = 008DBA98. After: st0=FLAGS, st1 = 0F700164 FLAGS--&gt;0000002C(00200202)</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=369425&amp;user=40168&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=13" class="addthx" data-post="369425"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]alexcoder1[/b]','')">alexcoder1</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.4 (гость), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.46'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=40168">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2016 02:59 &middot; Поправил: alexcoder1 <br><script type="text/javascript">QU('alexcoder1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=alexcoder1" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#14');return false;">#14</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">005343F4</span><span class="hl_char">:</span><span style="word-break: break-all">&nbsp;NOTAND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;Before: st0 = 0F700164, st1 = 00051098. After: st0=FLAGS, st1 = F08AEE03 FLAGS--&gt;0000002C(00200286)</span></li><li class="hl_l1"><span class="hl_number">005343F1</span><span class="hl_char">:</span>&nbsp;POPM&nbsp;<span class="hl_number">0000002C</span><span class="hl_char">(</span>F08AEE03<span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_number">005343EF</span><span class="hl_char">:</span>&nbsp;PUSHI&nbsp;E4462EAD</li><li class="hl_l1"><span class="hl_number">005343EA</span><span class="hl_char">:</span><span style="word-break: break-all">&nbsp;ADDT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;Before: st0 = E4462EAD, st1 = 1C0A1FC1. After: st0=FLAGS, st1 = 00504E6E FLAGS--&gt;00000028(00200203)</span></li><li class="hl_l0"><span class="hl_number">005343E7</span><span class="hl_char">:</span>&nbsp;PUSHM&nbsp;<span class="hl_number">00000034</span><span class="hl_char">(</span><span class="hl_number">00000000</span><span class="hl_char">)</span></li><li class="hl_l1"><span class="hl_number">005343E5</span><span class="hl_char">:</span><span style="word-break: break-all">&nbsp;ADDT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;Before: st0 = 00000000, st1 = 00504E6E. After: st0=FLAGS, st1 = 00504E6E FLAGS--&gt;00000018(00200202)</span></li><li class="hl_l0"><span class="hl_number">005343E2</span><span class="hl_char">:</span>&nbsp;PUSHHALFINDIRECT&nbsp;FROM&nbsp;<span class="hl_number">00504E6E</span>&nbsp;VAL&nbsp;<span class="hl_number">00004FA6</span></li><li class="hl_l1"><span class="hl_number">005343E1</span><span class="hl_char">:</span><span style="word-break: break-all">&nbsp;ADDHALF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;Before: op1 = 00004FA6, op2 = 0000B062. After: st0=FLAGS, st1' = 0008 FLAGS--&gt;00000018(00200203)</span></li><li class="hl_l0"><span class="hl_number">005343DE</span><span class="hl_char">:</span>&nbsp;PUSHM&nbsp;<span class="hl_number">0000002C</span><span class="hl_char">(</span>F08AEE03<span class="hl_char">)</span></li><li class="hl_l1"><span class="hl_number">005343DC</span><span class="hl_char">:</span><span style="word-break: break-all">&nbsp;POPMHALF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;adr = 0000003C, val = 0000EE03</span></li><li class="hl_l0"><span class="hl_number">005343DA</span><span class="hl_char">:</span><span style="word-break: break-all">&nbsp;PUSHSTADR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;st0 = 0018F520</span></li><li class="hl_l1"><span class="hl_number">005343D9</span><span class="hl_char">:</span><span style="word-break: break-all">&nbsp;LOADHALF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;Before: st0 = 0018F520. After st0' = F08A</span></li><li class="hl_l0"><span class="hl_number">005343D8</span><span class="hl_char">:</span><span style="word-break: break-all">&nbsp;SHLT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;Before: st0 = F08AF08A, st1' = 0008. After: st0=FLAGS, st1 = 8AF08A00 FLAGS--&gt;00000014(00200286)</span></li><li class="hl_l1"><span class="hl_number">005343D5</span><span class="hl_char">:</span>&nbsp;PUSHIHALF&nbsp;<span class="hl_number">9B6A</span></li><li class="hl_l0"><span class="hl_number">005343D2</span><span class="hl_char">:</span>&nbsp;PUSHI&nbsp;<span class="hl_number">5B910DD4</span></li><li class="hl_l1"><span class="hl_number">005343CD</span><span class="hl_char">:</span>&nbsp;PUSHI&nbsp;E4C00295</li><li class="hl_l0"><span class="hl_number">005343C8</span><span class="hl_char">:</span>&nbsp;PUSHIHALF&nbsp;<span class="hl_number">6502</span></li><li class="hl_l1"><span class="hl_number">005343C5</span><span class="hl_char">:</span>&nbsp;PUSHI&nbsp;A4D11512</li>        </ol>
    </div>
</div></div>
<br><br>В команде указан ее адрес (ESI), удобно ставить аппаратный бряк на доступ к этой ячейки и опа – мы остановились в нужном месте.<br>PUSH/POP/ADD/NOTAND/SHL/SHR/DIV/MUL… понятно из названия.<br>Суффикс M – команда работает с локальной памятью (блок регистров) или в команде или в комментариях указан адрес регистра<br>Суффикс I (PUSHI) – записать в стек непосредственное значение, хранится в самой команде<br>Суффикс HALF – команда работает с половинным (16 бит) числом.<br>Суффикс T или никакого –   команда работает с 32-х битным числом.<br>Суффикс INDIRECT – откуда загружать или куда выталкивать значение находится в вершине стека (а уже в команде или комментарии указано что, откуда и куда)<br>Суффикс BYTE – команда работает с байтом (но в стеке или блоке регистров он все равно будет занимать 2 байта, а использоваться только один).<br>Полный список команд можно посмотреть в module1.vb. Каждый регексп в начале – это команда. Но для другой программы эти данные нужно будет получать заново, поскольку адреса реальных команд будут другими, мусорные команды также будут другими.<br>Таким образом список из 300000+ команд превратился всего в несколько тысяч, которые уже можно исследовать.<br>Еще полезной функцией может оказаться логирование всех команд без операндов. Этот способ хуже поддается анализу, но он намного быстрее. Заключается в следующем. У меня, к примеру каждая команда начинается кодом, в котором производится выборка и декодирование:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DD456</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>INC</b></span>&nbsp;<span class="hl_registr"><b>CX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ECX</span><span class="hl_char">=</span><span class="hl_number">004DE544</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DD459</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADC</b></span>&nbsp;<span class="hl_registr">CL</span><span class="hl_char">,</span><span class="hl_registr"><b>AL</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ECX</span><span class="hl_char">=</span><span class="hl_number">004DE5C4</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DD45B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSHAD</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ESP</span><span class="hl_char">=</span><span class="hl_number">0018F410</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DD45C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">AL</span><span class="hl_char">,</span><span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESI</span><span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_number">005CE948</span><span class="hl_char">]</span><span class="hl_char">=</span><span class="hl_number">86</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">=</span><span class="hl_number">0018F486</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DD45F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RCL</b></span>&nbsp;<span class="hl_registr">CL</span><span class="hl_char">,</span><span class="hl_number">1</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ECX</span><span class="hl_char">=</span><span class="hl_number">004DE588</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DD461</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ESI</span><span class="hl_char">+</span>B0842D5B<span class="hl_char">]</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ECX</span><span class="hl_char">=</span>B0E116A4</li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DD467</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_number">004DD5AF</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DD5AF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>SHL</b></span>&nbsp;<span class="hl_registr">CH</span><span class="hl_char">,</span><span class="hl_number">3</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ECX</span><span class="hl_char">=</span>B0E1B0A4</li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DD5B2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">AL</span><span class="hl_char">,</span><span class="hl_registr"><b>BL</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">EAX</span><span class="hl_char">=</span><span class="hl_number">0018F479</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DD5B4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ROL</b></span>&nbsp;<span class="hl_registr">CX</span><span class="hl_char">,</span><span class="hl_registr"><b>CL</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ECX</span><span class="hl_char">=</span>B0E10A4B</li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DD5B7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>INC</b></span>&nbsp;<span class="hl_registr"><b>CL</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ECX</span><span class="hl_char">=</span>B0E10A4C</li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DD5B9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">AH</span><span class="hl_char">,</span><span class="hl_registr">DL</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DD5BB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>BSR</b></span>&nbsp;<span class="hl_registr">CX</span><span class="hl_char">,</span><span class="hl_registr"><b>BX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ECX</span><span class="hl_char">=</span>B0E1000F</li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DD5BF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">AL</span><span class="hl_char">,</span><span class="hl_number">2F</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">EAX</span><span class="hl_char">=</span><span class="hl_number">0018F4A8</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DD5C1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ECX</span><span class="hl_char">+</span>A6C37C28<span class="hl_char">]</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ECX</span><span class="hl_char">=</span><span class="hl_number">57A47C37</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DD5C7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ROR</b></span>&nbsp;<span class="hl_registr">AL</span><span class="hl_char">,</span><span class="hl_number">7</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">EAX</span><span class="hl_char">=</span><span class="hl_number">0018F451</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DD5CA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>BTR</b></span>&nbsp;<span class="hl_registr">CX</span><span class="hl_char">,</span><span class="hl_number">2</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ECX</span><span class="hl_char">=</span><span class="hl_number">57A47C33</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DD5CF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">AL</span><span class="hl_char">,</span><span class="hl_number">0F1</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">EAX</span><span class="hl_char">=</span><span class="hl_number">0018F442</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DD5D1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>NOT</b></span>&nbsp;<span class="hl_registr"><b>CX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ECX</span><span class="hl_char">=</span><span class="hl_number">57A483CC</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DD5D4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">BL</span><span class="hl_char">,</span><span class="hl_registr"><b>AL</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">EBX</span><span class="hl_char">=</span>C99F89BD</li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DD5D6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSHFD</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">[</span><span class="hl_number">0018F40C</span><span class="hl_char">]</span><span class="hl_char">=</span><span class="hl_number">0018F480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">=</span><span class="hl_number">0018F40C</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DD5D7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>NOT</b></span>&nbsp;<span class="hl_registr"><b>CX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ECX</span><span class="hl_char">=</span><span class="hl_number">57A47C33</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DD5DA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span><span style="word-break: break-all">&nbsp;E09323E7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">[</span><span class="hl_number">0018F408</span><span class="hl_char">]</span><span class="hl_char">=</span>cm17F<span class="hl_char">.</span><span class="hl_number">004DE543</span>&nbsp;&nbsp;&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">=</span><span class="hl_number">0018F408</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DD5DF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSHFD</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">[</span><span class="hl_number">0018F404</span><span class="hl_char">]</span><span class="hl_char">=</span><span class="hl_number">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">=</span><span class="hl_number">0018F404</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DD5E0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr"><b>AL</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">EAX</span><span class="hl_char">=</span><span class="hl_number">00000042</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DD5E3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>NOT</b></span>&nbsp;<span class="hl_registr"><b>CH</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ECX</span><span class="hl_char">=</span><span class="hl_number">57A48333</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DD5E5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>BSWAP</b></span>&nbsp;<span class="hl_registr"><b>CX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ECX</span><span class="hl_char">=</span><span class="hl_number">57A40000</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DD5E8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">+</span><span class="hl_number">4E0F10</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_number">004E1018</span><span class="hl_char">]</span><span class="hl_char">=</span>AA151327&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">=</span>AA151327</li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DD5EF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">004C4EEF</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ESP</span><span class="hl_char">=</span><span class="hl_number">0018F400</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004C4EEF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DEC</b></span>&nbsp;<span class="hl_registr"><b>ESI</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ESI</span><span class="hl_char">=</span><span class="hl_number">005CE948</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004C4EF0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_number">004DDBE0</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DDBE0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSHFD</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">[</span><span class="hl_number">0018F3FC</span><span class="hl_char">]</span><span class="hl_char">=</span><span class="hl_number">0018F410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">=</span><span class="hl_number">0018F3FC</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DDBE1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>SUB</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span style="word-break: break-all">A9C73BB7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">ECX</span><span class="hl_char">=</span><span class="hl_number">004DD770</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DDBE7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_number">0018F400</span><span class="hl_char">]</span><span class="hl_char">=</span>cm17F<span class="hl_char">.</span><span class="hl_number">004DD5F4</span>&nbsp;&nbsp;&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">=</span><span class="hl_number">0018F3F8</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DDBEB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">CLC</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DDBEC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">DI</span><span class="hl_char">,</span><span class="hl_number">0A0FC</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DDBF1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_number">0018F3FC</span><span class="hl_char">]</span><span class="hl_char">=</span><span class="hl_number">00200206</span><span class="hl_char">,</span>&nbsp;UNICODE&nbsp;<span class="hl_quote">&quot;d MMM yyyy&quot;</span><span class="hl_comment">;ESP=0018F3F4</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DDBF5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DDBFB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_number">0018F3F4</span><span class="hl_char">]</span><span class="hl_char">=</span><span class="hl_number">00200206</span><span class="hl_char">,</span>&nbsp;UNICODE&nbsp;<span class="hl_quote">&quot;d MMM yyyy&quot;</span><span class="hl_comment">;ESP=0018F3F0</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DDBFE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">3C</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr"><b>ECX</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_number">0018F42C</span><span class="hl_char">]</span><span class="hl_char">=</span><span class="hl_number">0018F480</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DDC02</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">14</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">4D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_number">0018F404</span><span class="hl_char">]</span><span class="hl_char">=</span><span class="hl_number">86</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DDC07</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>EBP</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">[</span><span class="hl_number">0018F3EC</span><span class="hl_char">]</span><span class="hl_char">=</span><span class="hl_number">8141E72E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">=</span><span class="hl_number">0018F3EC</span></li><li class="hl_l0">main&nbsp;&nbsp;<span class="hl_number">004DDC08</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">40</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_number">0018F42C</span><span class="hl_char">]</span><span class="hl_char">=</span>cm17F<span class="hl_char">.</span><span class="hl_number">004DD770</span>&nbsp;&nbsp;&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">=</span><span class="hl_number">0018F3E8</span></li><li class="hl_l1">main&nbsp;&nbsp;<span class="hl_number">004DDC0C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RETN</b></span>&nbsp;<span class="hl_number">44</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">[</span><span class="hl_number">0018F3E8</span><span class="hl_char">]</span><span class="hl_char">=</span>cm17F<span class="hl_char">.</span><span class="hl_number">004DD770</span>&nbsp;&nbsp;&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">=</span><span class="hl_number">0018F430</span></li>        </ol>
    </div>
</div></div>
<br>Далее за retn 44 выполняется сама команда. Эта команда имеет всегда один адрес. На него во втором Olly можно поставить аппаратный бряк с экспрешном типа: _CMD=[ESP], _ESI=ESI,_EBP=EBP,S1=[EBP],S2=[EBP+4],S3=[EBP+8],S4=[EBP+0C]<br>Получается лог:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004DDC0C</span>&nbsp;&nbsp;HARD<span class="hl_char">:</span>&nbsp;_CMD&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">4DCEBB</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">5099195</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ESI&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">53AEA3</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">5484195</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_EBP&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">18DE60</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">1629792</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2&nbsp;<span class="hl_char">=</span>&nbsp;C9D95B74&nbsp;<span class="hl_char">(</span><span class="hl_number">3386465140</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S3&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">18DE6C</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">1629804</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S4&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">2371370</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">37163888</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1"><span class="hl_number">004DDC0C</span>&nbsp;&nbsp;HARD<span class="hl_char">:</span>&nbsp;_CMD&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">4DE543</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">5104963</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ESI&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">53AEA1</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">5484193</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_EBP&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">18DE64</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">1629796</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1&nbsp;<span class="hl_char">=</span>&nbsp;C9D95B74&nbsp;<span class="hl_char">(</span><span class="hl_number">3386465140</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">18DE6C</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">1629804</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S3&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">2371370</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">37163888</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S4&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_number">004DDC0C</span>&nbsp;&nbsp;HARD<span class="hl_char">:</span>&nbsp;_CMD&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">4DD770</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">5101424</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ESI&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">53AE9C</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">5484188</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_EBP&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">18DE60</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">1629792</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">36BD5F24</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">918380324</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2&nbsp;<span class="hl_char">=</span>&nbsp;C9D95B74&nbsp;<span class="hl_char">(</span><span class="hl_number">3386465140</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S3&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">18DE6C</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">1629804</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S4&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">2371370</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">37163888</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1"><span class="hl_number">004DDC0C</span>&nbsp;&nbsp;HARD<span class="hl_char">:</span>&nbsp;_CMD&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">4DCEBB</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">5099195</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ESI&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">53AE9B</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">5484187</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_EBP&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">18DE60</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">1629792</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">203</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">515</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">96BA98</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">9878168</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S3&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">18DE6C</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">1629804</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S4&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">2371370</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">37163888</span><span class="hl_char">.</span><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br>А затем при помощи fnames.vb<br>получается лог вида<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0053AEA3</span><span class="hl_char">:</span>&nbsp;POPM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STACK<span class="hl_char">:</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">745BD9C96CDE180070133702</span></li><li class="hl_l1"><span class="hl_number">0053AEA1</span><span class="hl_char">:</span>&nbsp;PUSHI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STACK<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">745BD9C96CDE18007013370200000000</span></li><li class="hl_l0"><span class="hl_number">0053AE9C</span><span class="hl_char">:</span>&nbsp;ADDT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STACK<span class="hl_char">:</span>&nbsp;<span class="hl_number">245FBD36</span>&nbsp;<span class="hl_number">745BD9C9</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">6CDE180070133702</span></li><li class="hl_l1"><span class="hl_number">0053AE9B</span><span class="hl_char">:</span>&nbsp;POPM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STACK<span class="hl_char">:</span>&nbsp;<span class="hl_number">03020000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">98BA96006CDE180070133702</span></li><li class="hl_l0"><span class="hl_number">0053AE99</span><span class="hl_char">:</span>&nbsp;POPM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STACK<span class="hl_char">:</span>&nbsp;<span class="hl_number">98BA9600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6CDE18007013370200000000</span></li><li class="hl_l1">…</li><li class="hl_l0"><span class="hl_number">0053AD08</span><span class="hl_char">:</span>&nbsp;JUMP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STACK<span class="hl_char">:</span>&nbsp;<span class="hl_number">381F6100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">00000000745BD9C900000000</span></li><li class="hl_l1">…</li><li class="hl_l0"><span class="hl_number">004FAA40</span><span class="hl_char">:</span>&nbsp;CALLOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STACK<span class="hl_char">:</span>&nbsp;<span class="hl_number">98BA9600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">17020000354E4E0070133702</span></li>        </ol>
    </div>
</div></div>
<br>Числа в стеке в перевернутом виде как они находятся в памяти.<br>Такой метод у меня позволил одним махом вычислить в каких участках программы используется виртуализация.<br>Вспомогательные программы писались на vb.net и Си.<br>Приношу свои извинения за сумбурность изложения и быдлокод.<br><br><b>Добавлено спустя 1 минуту</b><br>Что-то не вижу аттача с файлами, еще раз прикрепляю<br><br><img src="img/attach.gif" alt=""> <a href="./files/9347_14.11.2016_EXELAB.rU.tgz">9347_14.11.2016_EXELAB.rU.tgz</a> - attach.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369426&amp;user=40168&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=14" class="addthx" data-post="369426"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3520" title="14-11-2016 07:52, ранг:573.1" target="_blank">mak</a>, <a href="action=userinfo&user=35168" title="23-11-2016 23:18, ранг:44.8" target="_blank">v00doo</a>, <a href="action=userinfo&user=41088" title="24-11-2016 03:22, ранг:15.4" target="_blank">oldman</a>, <a href="action=userinfo&user=42678" title="02-06-2018 08:17, ранг:0.0" target="_blank">AlisaDarkCoder</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2016 10:35 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#15');return false;">#15</a> </span><div align=left><br>
<b>alexcoder1</b><br>Это только верхушка айсберга, почитайте эту тему - https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906 здесь вмпрот разобран практически полностью.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=369430&amp;user=20406&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=15" class="addthx" data-post="369430"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29780" title="23-11-2016 22:59, ранг:4.6" target="_blank">djdram</a>, <a href="action=userinfo&user=40450" title="03-11-2017 00:34, ранг:-0.2" target="_blank">Qamani</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]djdram[/b]','')">djdram</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.6 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.97'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=29780">Участник</a><br><font color=blue></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 ноября 2016 02:47 &middot; Поправил: djdram <br><script type="text/javascript">QU('djdram','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=djdram" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#16');return false;">#16</a> </span><div align=left><br>
наткнулся на 64 разрядное приложение накрыто VMP<br>помниться игрался с olly и скриптом от LCF-AT а тут кинулся а olly та уже не та ) 64 разрядные не хочет... <br>судя по всему стоит проверка на отладчик, приложение консольное на C++<br>Detect-It-Easy<br>https://yadi.sk/i/mV2qr4cQzLTat<br>Отладчик<br>https://yadi.sk/i/mMQBMQGVzLTmj<br>Само приложение<br>https://yadi.sk/d/P8Tyza-NzLUmW<br>есть возможность у кого нибудь глянуть может по горячим следам кто что вспомнит как снять, или уходить в чтиво из поста выше по 64 разрядным я так понимаю пока не много инфы..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369721&amp;user=29780&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=16" class="addthx" data-post="369721"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 ноября 2016 08:16 <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#17');return false;">#17</a> </span><div align=left><br>
<I>djdram пишет:<br>Само приложение </I><br><br>29/56 детектов на вирустотале. Zcash miner накрыли вмпротом? o_O<br><br><I>djdram пишет:<br>64 разрядным я так понимаю пока не много инфы..  </I><br><br>в паблике вроде нету по декомпиляции 64 битного вмпрота, а самому что-то такое пилить - лень до <br>неприличия. Приходится работать напрямую, без снятия, как в игрушках с денувой.<br>С денувой в качестве антидебага для х64дбг помогает scylla hide, и titanhide (+ тулза для отключения <br>патчгварда).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369726&amp;user=41088&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=17" class="addthx" data-post="369726"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29780" title="24-11-2016 09:14, ранг:4.6" target="_blank">djdram</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 декабря 2016 19:42 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#18');return false;">#18</a> </span><div align=left><br>
Приведенный Djeck&#039;ом на стр. 5 в пакете VMProtect_Inline пример<br>запакованного анпакми Unpackme_vmp.exe ловит у меня в системе WinXP<br>отладчик уровня ядра и требует его выгрузить. Вопрос: а что это такое<br>и как это сделать?<br>Когда я отключил в примере обнаружение отладчика, анпакми распаковался автоматически<br>скриптом от LCF-AT и в WinXP, где распаковывался, запускается без разговоров, <br>а на Win7 выдаёт строчку с access violation, но дальше работает: идёт видео и музыка!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370126&amp;user=29754&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=18" class="addthx" data-post="370126"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 декабря 2016 19:53 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#19');return false;">#19</a> </span><div align=left><br>
<I>ksol пишет:<br>скриптом от LCF-AT и в WinXP, где распаковывался, запускается без разговоров, <br>а на Win7 выдаёт строчку с access violation </I><br>скрирь LCF-AT многого не учитывает
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=370127&amp;user=24257&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=19" class="addthx" data-post="370127"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29754" title="15-12-2016 16:15, ранг:65.2" target="_blank">ksol</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 декабря 2016 20:15 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#20');return false;">#20</a> </span><div align=left><br>
<I>DenCoder пишет:<br>скрирь LCF-AT многого не учитывает<br> </I><br>Похоже, но другого у меня нет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370131&amp;user=29754&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=20" class="addthx" data-post="370131"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2016 00:43 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#21');return false;">#21</a> </span><div align=left><br>
IMAGE FILE EXECUTION OPTIONS, либо драйвер и делайте с вашим файлом что хотите <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=370138&amp;user=24257&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=21" class="addthx" data-post="370138"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2016 19:36 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#22');return false;">#22</a> </span><div align=left><br>
Попытался поправить IAT, но всё не просто!<br>Скрипт находит ОЕР=46D008, а в конце своей работы перенастраивает программу<br>на новую ОЕР=ЕЕ13А0 в созданную им секцию. В туторе Djeck загоняет в Scylla 1-ю ОЕР.<br>Изменение в заголовке PE header адрес ЕР хотя и останавливает в OllyDbg на нужном<br>адресе, но ведёт к АВОСТу.<br>--------------------------------------<br><I>DenCoder пишет:<br>делайте с вашим файлом что хотите </I><br>Ваше сообщение требует ещё распаковки!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370151&amp;user=29754&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=22" class="addthx" data-post="370151"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Chris[/b]','')">Chris</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 26.9 (посетитель), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.36'>Активность: 0.05<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=31549">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2016 14:46 &middot; Поправил: Chris <br><script type="text/javascript">QU('Chris','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chris" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#23');return false;">#23</a> </span><div align=left><br>
<I>ksol пишет:<br>скриптом от LCF-AT и в WinXP, где распаковывался, запускается без разговоров,<br>а на Win7 выдаёт строчку с access violation </I><br>Это одна из распространённых проблем работы скрипта.<br>Сама LCF-AT на такой же вопрос отвечает так:<br><br><i class=x>&quot;so unpacked VMP files can make trouble to run them on other OS.Problems for this can be any wrong found &amp; fixed APIs (can happen if random 4 byte opcode are same as a API does use).Lets say the XP opcode of GetModuleHandle API was found somewhere then this location gets fixed by script and filled by reading and settings imports which are same on your Unpack OS if dll was also loaded with same base.If you now run it on other OS then the location gets also filled with actually system address of GetModuleHandle API which is a other address = other opcodes but if this location is really no API location and VMP does access this location then you get a problem.But this just happens rarly but could be one reason which you can keep in your mind.<br>If you the script does ask you about the OEP rebuild then do this at the OEP address or at the end of the resource section (if used) before it does jump to OEP.Remember that you have to find the right OEP address if the script didn&#039;t find it (check videos again).So you also don&#039;t need to dump or fix your target so the script does this already.<br>The last part about CPUID etc you need to check by yourself if you do test your dump on other OS / Systemconfiguration.If such checks are used then you need to find the right check locations and patch them with the datas you got at same address on your unpack OS.&quot;</i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370256&amp;user=31549&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=23" class="addthx" data-post="370256"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 декабря 2016 18:10 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#24');return false;">#24</a> </span><div align=left><br>
Новая точка ОЕР, созданная скриптом, оказывается, вполне подходит для анализа <br>таблицы IAT. Скрипт LCF-AT перегоняет IAT в созданную для этого секцию IAT_SEC_ и <br>там же устанавливает свою ОЕР.<br>Утилита ImpREC принимает эту ОЕР и раскрывает таблицу IAT.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370306&amp;user=29754&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=24" class="addthx" data-post="370306"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 января 2017 18:29 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#25');return false;">#25</a> </span><div align=left><br>
===== Найти украденные байты ====<br>LCF-AT в туторе VMProtect Ultra Unpacker рассматривает анпакми VMProtect 1.70.4 .<br>Запустив свой скрипт, анпакми выходит на инструкцию вблизи ОЕР. Скрипт сообщает,<br>что байты вблизи ОЕР украдены. Автор по стеку, и ещё по чему-то, о чём он не говорит,<br>ухитряется найти их, но как он это сделал - не показывает, лишь приводит результат.<br>Видно, он как-то восстановил их ассемблерный код - это самый главный момент!<br>А дальше более или менее понятно: компилирование, вставил в свободное место и<br>передал им управление.<br>Может кто знает и скажет какая здесь стратегия поиска?!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=371035&amp;user=29754&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=25" class="addthx" data-post="371035"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]LazyCat[/b]','')">LazyCat</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.1 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=12436">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 января 2017 00:51 <br><script type="text/javascript">QU('LazyCat','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=LazyCat" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#26');return false;">#26</a> </span><div align=left><br>
Нужна помощь !<br>Попалась на днях прога, накрытая VMпротом. Нормально сдампилась, OEP неукраден, IAT виртуализирован, но ручками прекрасно восстановился. Остались кое-какие функции виртуализированными. Попробовал натравить на это дело VMSweeper 1.5, но декомпилятор вылетает на простых инструкциях типа CMOVx, CWD, SCAS, AAD, XLAT и других <img src="img/smilies/s9.gif" alt=""><br>Может кто подскажет другой декомпилятор под этот прот и желательно под 2-ю ольку(она более удобна в работе, по-моему)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=371411&amp;user=12436&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=26" class="addthx" data-post="371411"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Jaa[/b]','')">Jaa</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 134.1 (ветеран), 246thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.52'>Активность: 0.22<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=33657">Участник</a><br><font color=blue>realist</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 января 2017 01:22 <br><script type="text/javascript">QU('Jaa','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jaa" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#27');return false;">#27</a> </span><div align=left><br>
<b>LazyCat</b><br>в паблике другого декомпилятора вм не существует
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=371413&amp;user=33657&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=27" class="addthx" data-post="371413"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=12436" title="28-01-2017 21:32, ранг:10.1" target="_blank">LazyCat</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]LazyCat[/b]','')">LazyCat</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.1 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=12436">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 января 2017 01:36 <br><script type="text/javascript">QU('LazyCat','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=LazyCat" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#28');return false;">#28</a> </span><div align=left><br>
Спасибо за оперативный ответ. Жаль, конечно, что Vamit больше не развивает свой продукт, да и LCF-AT отказался далее работать с этим протом. Ну а с прогой придется завязать, т.к. ради одной паршивой проги нет желания тратить кучу времени на написание своего декомпилятора <img src="img/smilies/s9.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=371414&amp;user=12436&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=28" class="addthx" data-post="371414"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 января 2017 05:56 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#29');return false;">#29</a> </span><div align=left><br>
<I>LazyCat пишет:<br>Vamit больше не развивает свой продукт </I><br><br>в топе по <b>VMSweeper</b> было указано, что:<br><br><I>Vamit пишет:<br>WMSweeper доведен до релиза 2.0, успех полной декомпиляции вмпрота с созданием исходного кода составляет более 90%. <br>*скип*<br>Новой версии Свипера в свободном доступе по определенным причинам не будет но если кому-то что-то потребуется декомпильнуть - обращайтесь.<br> </I><br><br><I>Vamit пишет:<br>Так, по просьбам на декомпиляцию, чтобы не тратить ни мое ни ваше время:<br>1. выкладываем только нужный файл и либы для него, если такие имееются, ссылки на полный софт мне не нужны и инсталлировать его я всё равно не буду<br>2. сообщаем ОЕП и адреса декомпилируемых фунок, искать всё это в проге я тоже не буду<br>3. оказываю помощь только в декомпиляции фунок и предоставляю их исходный код, всё остальное дело ваших рук и головы<br>4. будьте готовы на скромное вознаграждение<br>5. если не предоставлена нужная информация, то реагировать на такие запросы так же не буду  </I><br><br><I>Vamit пишет:<br>Наконец-то появилось время и реальная необходимость заняться новыми версиями вмпротекта. Начиная с версии 3.0 вмпрот имеет новую безцикловую вм. Изменения настолько серьезны что нужно писать новый анализатор вм до промкода. </I>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=371415&amp;user=2585&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=29" class="addthx" data-post="371415"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=12436" title="29-01-2017 08:25, ранг:10.1" target="_blank">LazyCat</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Haoose-GP[/b]','')">Haoose-GP</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/29223.gif" alt=""><br><span class=txtSm>Ранг: 62.3 (постоянный), 51thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.13'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=29223">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 февраля 2017 15:57 &middot; Поправил: Haoose-GP <br><script type="text/javascript">QU('Haoose-GP','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Haoose-GP" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#30');return false;">#30</a> </span><div align=left><br>
[ <i class=x>По просьбам трудящихся удалено... =(</i> ]<br><br><b>Vamit</b><br>Зачем протектор распространять в форуме протекторов? Хм...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=371599&amp;user=29223&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=30" class="addthx" data-post="371599"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3520" title="04-02-2017 14:44, ранг:576.8" target="_blank">mak</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 февраля 2017 17:03 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15982&amp;page=9#31');return false;">#31</a> </span><div align=left><br>
<b>Haoose-GP</b><br>И зачем же здесь протекторы распространять <img src="img/smilies/s9.gif" alt="">
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=371600&amp;user=20406&amp;forum_n=13&amp;topic=15982&amp;page=9&amp;anchor=31" class="addthx" data-post="371600"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=18316" title="04-02-2017 16:47, ранг:221.2" target="_blank">SReg</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=8.html">&lt;&lt;</a> <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=0.html">1</a> ... <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=8.html">9</a> . <b>10</b> . <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=10.html">11</a> . <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=11.html">12</a> . <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=12.html">13</a> . <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=13.html">14</a> . <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=14.html">15</a> . <a href="action=vthread&amp;forum=13&amp;topic=15982&amp;page=10.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> VMProtect (Туторы, скрипты, плагины, ...)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="15982">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15982" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
