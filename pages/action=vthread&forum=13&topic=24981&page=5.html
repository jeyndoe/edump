<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Статическая трассировка кода - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем привет, Изучаю x86 драйвер, он защищен с помощью vmp Случай достаточно простой, только некоторые функции мутированы (обфусцированы?), даже нет внешней упаковки Для того чтобы посмотреть обфускацию целиком, нужна трасса от и">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Статическая трассировка кода</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=4.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=4.html">5</a> . <b>6</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 декабря 2017 18:39 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#1');return false;">#1</a> </span><div align=left><br>
Всем привет,<br>Изучаю x86 драйвер, он защищен с помощью vmp<br>Случай достаточно простой, только некоторые функции мутированы (обфусцированы?), даже нет внешней упаковки<br>Для того чтобы посмотреть обфускацию целиком, нужна трасса от и до<br>Дебажить его у меня нет возможности, да и вообще хочу попробовать сделать это статически<br>Возможно идея глупая, но что если написать упрощенный процессор с обработкой нужных инструкций (операции стека, прыжки, вызовы), который бы &quot;выполнял&quot; код до тех пор пока не встретиться выход из функции<br>Правда не ясно что делать c вызовами API, stdcall мы же очищаем стек, но вот с другими соглашениями?<br>Дело даже не в проте, а вообще в целом<br>Я пыталась делать парсер конкретных команд под конкретный прот, но дело в том, что это не возможно реализовать, ибо число нелогичных приемов может быть очень большое, поэтому нужно спуститься на самый нижний уровень, для того чтобы выполнять код как сам процессор это делает<br>Возможно кто-то даст дельный совет, может кто-то уже делал подобное?<br>Так же я пыталась найти псевдо-код, как процессор выполняет команды, т.к. вмпрот любит использовать редкие команды, может у кого то есть линки?<br>Спасибо
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380866&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=1" class="addthx" data-post="380866"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 декабря 2017 22:20 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#2');return false;">#2</a> </span><div align=left><br>
<b>Boostyq</b><br><br>Нашёл через гугл <noindex><a href="http://ref.x86asm.net/coder32.html" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>Именно из за этой инфы(in/out-f/r) я когдато и использовал beadisasm. Сейчас это умеет ксед.<br><br><b>Добавлено спустя 16 минут</b><br>Покопался в архивах и нашёл пример регистровой свёртки. Там даже крины есть <img src="img/smilies/s1.gif" alt=""><br><br><img src="img/attach.gif" alt=""> <a href="./files/cdd3_24.12.2017_EXELAB.rU.tgz">cdd3_24.12.2017_EXELAB.rU.tgz</a> - Int29.rar
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381255&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=2" class="addthx" data-post="381255"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 декабря 2017 22:36 <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#3');return false;">#3</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Нашёл через гугл </I><br>Спасибо, действительно очень полезная табличка по флагам<br>Однако все равно не ясно, мб вмпрот использует, то что процы не записывают undefined<br>Хотя на его месте я бы так не делала, неизвестно, что будет на новых процах и т.п.
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381256&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=3" class="addthx" data-post="381256"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2017 09:25 <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#4');return false;">#4</a> </span><div align=left><br>
<I>VodoleY пишет:<br>надо выпросить у вамита сорцы </I><br><br>а что, есть надежда?
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381259&amp;user=4773&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=4" class="addthx" data-post="381259"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2017 09:47 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#5');return false;">#5</a> </span><div align=left><br>
<I>VodoleY пишет: либо по difexacaw делать универсал </I><br><br>Смешно, да нуб он который несколько лет здесь в каждой второй теме писал о графах, а как оказалось он в них разбирается чуть лучше чем никак и с vmprotect аналогично, был уже эпичный фейл с фимкой. <img src="img/smilies/s1.gif" alt=""><br><br><I>VodoleY пишет: т.е. надо делать свой ллвм.. т.е полноценный компилер </I><br><br>Зачем, что во что будем компилировать, тем более полноценно? LLVM не считаю каким то особо сложным проектом в котором невозможно разобраться (по нему даже книга есть), chrome сложнее, а gcc хуже по состоянию кода и количеству легаси.<br><br><I>VodoleY пишет: тот же инт в соразрабы полез.. почитал.. отвалился </I><br><br>Это может говорить лишь о двух вещах, либо о качестве проекта, либо о знаниях теории пытавшегося, поэтому и начинать нужно с теории, а не чьих то проектов, иначе даже лучшей проект ляжет мертвым кодом.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381262&amp;user=41575&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=5" class="addthx" data-post="381262"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2017 12:29 <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#6');return false;">#6</a> </span><div align=left><br>
<I>shellstorm пишет:<br>Это может говорить лишь о двух вещах, либо о качестве проекта, либо о знаниях теории пытавшегося, поэтому и начинать нужно с теории, а не чьих то проектов, иначе даже лучшей проект ляжет мертвым кодом.  </I><br>Вы абсолютно правы, все говорят, чтобы я попробовала, но с чего они вообще взяли, что я достойна &gt;.&lt;<br>Насчет теории конечно верно, но так же нужно вручную изучить вм, а уже потом куда-то прыгать<br>Вот например, обфускацию вмп я теперь понимаю лучше, пытаюсь написать автоматическое решение, а уже после можно думать о более верных вариантах с llvm или другой оптимизацией
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381266&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=6" class="addthx" data-post="381266"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=41575" title="26-12-2017 10:39, ранг:90.2" target="_blank">shellstorm</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2017 12:49 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#7');return false;">#7</a> </span><div align=left><br>
<I>plutos пишет:<br>а что, есть надежда? </I><br>Надежда есть всегда, нужно только показать свои знания, умения и желание работать над проектом <img src="img/smilies/s2.gif" alt="">
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381267&amp;user=20406&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=7" class="addthx" data-post="381267"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2017 13:31 &middot; Поправил: Bronco <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#8');return false;">#8</a> </span><div align=left><br>
<I>shellstorm пишет:<br>о качестве проекта </I><br>Проект имеет выхлоп, и весьма убедительный. <br>По разным слухам, на текущий момент, не считая авер контор (?), имеются ещё четыре(!) независимых источника с положительным результатом. <br>Все в привате, в паблик обсуждениях участия практически не принимают. Итого , за более чем 12 лет, всего пять более менее за конченых проектов, что говорит о сложности механизма обсуждаемой защиты.<br>В том что на поверхности, прежде всего х86, не полный анализ механизма, и как правило путаница в терминологии.<br>За 6 страниц топа, не считая постов Вамита, имхо, всего 2 полезных мысли:<br><I>1. вместо поиска патернов.. контролите состояние виртуальной машины </I><br><I>2. следующим этапом выделяют логические блоки, с них начинается оптимизация и доказательства лемм </I><br>Собственно так далеко с оптимизацией промежуточного кода не заходил, решал в основном разные прикладные задачи, что позволило более менее иметь представление об этому чудовище. Отсюда картина не полная, и остались вопросы:<br>1.Часто звучал термин пикод, что подразумевает наличие интерпретатора. Такого механизма не обнаружил, и вывод, что это стековая вм, правильный?<br>2.Сколько вм_регистров в реализации х64?
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381269&amp;user=3230&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=8" class="addthx" data-post="381269"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2017 13:42 &middot; Поправил: shellstorm <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#9');return false;">#9</a> </span><div align=left><br>
<I>Bronco пишет: Проект имеет выхлоп, и весьма убедительный.  </I><br><br>Я и не утверждаю, что автор мудак или школьник, но если кто то выкатит на паблик серьезный разбор протектора то тулы начнут расти аки грибы. Рядом топ с декомпилятором делфи, сама программа простая и ее напишет почти любой студент, самая сложная часть это изыскания, за что респект крипто.<br><br><I>Bronco пишет: За 6 страниц топа, не считая постов Вамита, имхо, всего 2 полезных мысли </I><br><br>Полезность штука субъективная и думаю сами понимание, что разбор vmprotect это чистая коммерция, людей которых могут не так и мало, а вот готовых выкатить что то на паблик единицы. <img src="img/smilies/s1.gif" alt=""><br>1. Стековый\регистровый конечный автомат. в BH вроде бы за 2015 год был частичный разбор прота, опкоды, архитектура и вот это все.<br>2. Хз, я кроме скромно накрытого анпакми ничего не видел под x64. Нужен либо сам прот, либо куча анпакми с вариациями опций.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381270&amp;user=41575&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=9" class="addthx" data-post="381270"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3230" title="25-12-2017 10:50, ранг:201.3" target="_blank">Bronco</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2017 13:47 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#10');return false;">#10</a> </span><div align=left><br>
<I>1.Часто звучал термин пикод, что подразумевает наличие интерпретатора. Такого механизма не обнаружил, и вывод, что это стековая вм, правильный? </I><br>Пикод есть в любом вмпроте, но это не значит что должен быть отдельный интерпретатор. До 3ей версии он был (цикл вм и таблица хендлеров), начиная с 3ей версии он стал распределенным (пикод интерпретируется в вм на лету) - цикл вм и таблица хендлеров отсутствует, но тела всех обработчиков (примитивов вм) остались.<br>Да, здесь стековая вм.<br><I>2.Сколько вм_регистров в реализации х64? </I><br>х64 не изучал, а для х32 - 16 регистров вм.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381271&amp;user=20406&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=10" class="addthx" data-post="381271"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3230" title="25-12-2017 10:49, ранг:201.3" target="_blank">Bronco</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2017 14:02 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#11');return false;">#11</a> </span><div align=left><br>
Другой разбор, куда скромнее, но ТС может будет интересно.<br><br><img src="img/attach.gif" alt=""> <a href="./files/bd25_25.12.2017_EXELAB.rU.tgz">bd25_25.12.2017_EXELAB.rU.tgz</a> - prez-vmprotect.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381272&amp;user=41575&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=11" class="addthx" data-post="381272"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40448" title="25-12-2017 11:06, ранг:25.4" target="_blank">Boostyq</a>, <a href="action=userinfo&user=4773" title="25-12-2017 23:00, ранг:282.7" target="_blank">plutos</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 389thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2017 14:02 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#12');return false;">#12</a> </span><div align=left><br>
<I>VodoleY пишет:<br> кстати.. создатель поляк.. это между прочим.. один из первых метополиморфов..  <br></I><br>Болгарин. На отладку, по слухам, ушло более года.<br>А поляки ничем никого не удивляли, почему-то.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381273&amp;user=35473&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=12" class="addthx" data-post="381273"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]SegFault[/b]','')">SegFault</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 44.8 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.95'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29820">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2017 14:11 <br><script type="text/javascript">QU('SegFault','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SegFault" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#13');return false;">#13</a> </span><div align=left><br>
А есть у когонибудь древние vmp? Хочу покопать и крелку показать, что он нуб и овощь на примере солверов и прочего сферического говна в вакууме
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381274&amp;user=29820&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=13" class="addthx" data-post="381274"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2017 14:13 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#14');return false;">#14</a> </span><div align=left><br>
<I>SegFault пишет: А есть у когонибудь древние vmp? Хочу покопать и крелку показать, что он нуб и овощь на примере солверов и прочего сферического говна в вакууме  </I><br><br>этому пациенту ничего нельзя доказать, самого прота у меня к сожалению нет, а анпакми можно взять здесь: https://github.com/0xbadc0de1/VmP_DBG
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381275&amp;user=41575&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=14" class="addthx" data-post="381275"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]2nd[/b]','')">2nd</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 39.4 (посетитель), 9thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.04'>Активность: 0.01=0.01</span><br>Статус: <a href="action=userinfo&amp;user=2094">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2017 15:02 <br><script type="text/javascript">QU('2nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=2nd" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#15');return false;">#15</a> </span><div align=left><br>
<I>SegFault пишет:<br>А есть у когонибудь древние vmp? </I><br>Достаточно древние ?<br>v0.71   _http://rgho.st/7S4zgVrJL<br>v0.73   _http://rgho.st/6l6cLXY5h
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381278&amp;user=2094&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=15" class="addthx" data-post="381278"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=6336" title="26-12-2017 08:41, ранг:637.3" target="_blank">ARCHANGEL</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 декабря 2017 01:00 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#16');return false;">#16</a> </span><div align=left><br>
<I>dosprog пишет:<br>Болгарин. На отладку, по слухам, ушло более года.<br>А поляки ничем никого не удивляли, почему-то. </I><br>у меня ушло 3 месяца<br><br><b>Добавлено спустя 4 минуты</b><br>причем если вы эту тварь смотрели.. там по очереди надо 6 прерываний в определенном порядки отключать.. вобщем гадость. еще та.. но занятная до ушаса.. я кстати до сих пор генератор псевдо случайных.. от него тоскаю... он для морфа использовался
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381334&amp;user=17319&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=16" class="addthx" data-post="381334"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 389thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 декабря 2017 15:44 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#17');return false;">#17</a> </span><div align=left><br>
<b>[offtop]</b><br>Нет, не ковырял его как следует.<br>Всё ограничилось только тем, что в начальных секторах диска поправил расширения COM и EXE, убрал крипчение новых секторов и поудалял попорченные исполняемые файлы. Какое-то время оно так и работало, компьютер-то был чужой. А потом всё переформатировал заново и всех делов, - когда все данные там зарезервировали.<br>Образ остался с тех пор - лежит, думал полностью его отдизасмить, в принципе, там на пару-тройку тысяч строк текста получилось бы - но руки так и не дошли.<br>Да и необходимости такой не было - вещь довольно занудная.<br>Так тот архив и лежит до сих пор без дела: <noindex><a href="http://old-dos.ru/dl.php?id=8474" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>.<br>.. двадцать лет, псд..<br><b>[/offtop]</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381335&amp;user=35473&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=17" class="addthx" data-post="381335"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2019 01:28 <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#18');return false;">#18</a> </span><div align=left><br>
<I>SegFault пишет:<br>Еще есть Metasm, с помощью него недавно неплохая статья вышла по деобфускации VM в ci.dll (виндовая security либа ). </I><br><br>Никто не пробовал установить эту штуку?<br>У меня почему-то при команде<br><b>hg clone https://www.cr0.org/progs/metasm/hg/ metasm <br></b><br>Вылетает ошибка HTTP error 404 Not found, The requested URL /hg/ was not found on this server.<br><br>хотя сайт вроде бы на месте, но что-то да не так.<br>Кто-нибудь может попробовать и сказать что получилось?<br>Спасибо!
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=390826&amp;user=4773&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=18" class="addthx" data-post="390826"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2019 01:52 &middot; Поправил: ntldr <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#19');return false;">#19</a> </span><div align=left><br>
Как отключить функции ci.dll, либо подменить их на свои. Простой пример универсального кода, работает от Vista SP0 до Последней 10ки. Публикую чтобы поржать как легко обходится вся эта безопасность через неясность, которой увлекается Microsoft.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#define&nbsp;in_reg<span class="hl_char">(</span>a<span class="hl_char">,</span>base<span class="hl_char">,</span>size<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">(</span>a&nbsp;<span class="hl_char">&gt;</span><span class="hl_char">=</span>&nbsp;base<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;<span class="hl_char">(</span>a&nbsp;<span class="hl_char">&lt;</span>&nbsp;base<span class="hl_char">+</span>size<span class="hl_char">)</span>&nbsp;&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">PIMAGE_SECTION_HEADER&nbsp;pe_find_section_unsafe<span class="hl_char">(</span><span class="hl_function"><b>IN</b></span>&nbsp;PVOID&nbsp;image<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;PCSTR&nbsp;name<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PIMAGE_DOS_HEADER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d_head&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>PIMAGE_DOS_HEADER<span class="hl_char">)</span>image<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PIMAGE_NT_HEADERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_head&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>PIMAGE_NT_HEADERS<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_char">(</span>PUCHAR<span class="hl_char">)</span>d_head&nbsp;<span class="hl_char">+</span>&nbsp;d_head<span class="hl_char">-</span><span class="hl_char">&gt;</span>e_lfanew<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PIMAGE_SECTION_HEADER&nbsp;p_sect&nbsp;<span class="hl_char">=</span>&nbsp;IMAGE_FIRST_SECTION<span class="hl_char">(</span>n_head<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span>USHORT&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; i &lt; n_head-&gt;FileHeader.NumberOfSections; i++, p_sect++) {</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>strcmp<span class="hl_char">(</span>p_sect<span class="hl_char">-</span><span class="hl_char">&gt;</span>Name<span class="hl_char">,</span>&nbsp;name<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span>&nbsp;return&nbsp;p_sect<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">static&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;search_ci_callbacks_in_kernel<span class="hl_char">(</span><span class="hl_function"><b>IN</b></span>&nbsp;PVOID&nbsp;KernelBase<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;PVOID&nbsp;CI_DllBase<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PIMAGE_SECTION_HEADER&nbsp;p_kernel_data&nbsp;<span class="hl_char">=</span>&nbsp;pe_find_section_unsafe<span class="hl_char">(</span>KernelBase<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;.data&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PIMAGE_SECTION_HEADER&nbsp;p_ci_page&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;pe_find_section_unsafe<span class="hl_char">(</span>CI_DllBase<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;PAGE&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>p_kernel_data&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span>&nbsp;<span class="hl_char">|</span><span class="hl_char">|</span>&nbsp;p_ci_page&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span>&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUCHAR&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span>PUCHAR<span class="hl_char">)</span>KernelBase&nbsp;<span class="hl_char">+</span>&nbsp;p_kernel_data<span class="hl_char">-</span><span class="hl_char">&gt;</span>VirtualAddress<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUCHAR&nbsp;<span class="hl_function"><b>end</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;p_kernel_data<span class="hl_char">-</span><span class="hl_char">&gt;</span>Misc<span class="hl_char">.</span>VirtualSize&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>ULONGLONG<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUCHAR&nbsp;function_ptr&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ULONG&nbsp;&nbsp;found_count&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span><span class="hl_comment">; ptr &lt; end; ptr += sizeof(ULONGLONG))</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUCHAR&nbsp;pointer&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>PUCHAR<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_function"><b>ptr</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>in_reg<span class="hl_char">(</span>pointer<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span>PUCHAR<span class="hl_char">)</span>CI_DllBase&nbsp;<span class="hl_char">+</span>&nbsp;p_ci_page<span class="hl_char">-</span><span class="hl_char">&gt;</span>VirtualAddress<span class="hl_char">,</span>&nbsp;p_ci_page<span class="hl_char">-</span><span class="hl_char">&gt;</span>SizeOfRawData<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;continue<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DbgMsg<span class="hl_char">(</span><span class="hl_quote">&quot;ptr = %p, ciCallback = %p\n&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">ptr</span><span class="hl_char">,</span>&nbsp;pointer<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br><br>Функция search_ci_callbacks_in_kernel запущенная в kernel mode распечатывает список адресов CI калбеков и указателей на них в секции данных ядра. Сделав *((PVOID*)ptr) = my_function можно заменить функции безопасности на свои, винда хавает и не хрюкает.<br><br>Количество, очерёдность, названия и назначения CI каллбеков в разных версиях винды отличаются. Дизассемблер вам в руки, смотрите начиная с экспортируемой функции CiInitialize, в которой идёт заполнение структуры каллбеков и разберётесь что где как.<br><br>PS: для большей стабильности можно добавить проверку выравнивания адресов CI функций на 16, но оно и так отработает без ложняков.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=390827&amp;user=12867&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=19" class="addthx" data-post="390827"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=4773" title="18-01-2019 23:18, ранг:392.0" target="_blank">plutos</a>, <a href="action=userinfo&user=35473" title="19-01-2019 00:09, ранг:387.5" target="_blank">dosprog</a>, <a href="action=userinfo&user=37000" title="19-01-2019 08:20, ранг:0.2" target="_blank">Orlyonok</a>, <a href="action=userinfo&user=3520" title="19-01-2019 10:12, ранг:631.9" target="_blank">mak</a>, <a href="action=userinfo&user=42819" title="19-01-2019 11:43, ранг:2.0" target="_blank">rthax</a>, <a href="action=userinfo&user=42822" title="21-01-2019 11:02, ранг:7.5" target="_blank">dezmand07</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Diabolic[/b]','')">Diabolic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.5 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.31'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=34365">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2019 15:44 <br><script type="text/javascript">QU('Diabolic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Diabolic" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#20');return false;">#20</a> </span><div align=left><br>
<b>plutos</b><br><br>На гитхаб ходили? https://github.com/jjyg/metasm/
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=390830&amp;user=34365&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=20" class="addthx" data-post="390830"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]dma[/b]','')">dma</a></b><br></div>
<img src="img/s0.gif" alt=""><br><span class=txtSm>Ранг: -12.6 (нарушитель), 11thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.59'>Активность: 0.05<span style='color:red'>&searr;</span>0.03</span><br>Статус: <a href="action=userinfo&amp;user=36364">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2019 22:33 <br><script type="text/javascript">QU('dma','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dma" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#21');return false;">#21</a> </span><div align=left><br>
<b>plutos</b>, какую хорошую тему вы затронули <img src="img/smilies/s1.gif" alt="">. Буквально недавно подумал о том, что нужно бы попробовать поработать с подобными программами. А тут оказывается все не так просто. Для обфусцированного кода, говорят, хорошая вещь. Даже Ида с ней не сравнится, потому-как не &quot;заточена&quot; под это (разве, что плугины какие-нибудь есть).<br><br>Если не трудно, напишите позже удалось вам запустить <b>Metasm</b> и какие первые впечатления?<br><br>P.S. Есть еще подобные программы и, вроде-как, не хуже Metasm, а в чем-то может даже и лучше - это <b>Miasm</b> и <b>VxStripper</b>. Может кто-нибудь работал с этими программами? Интересно было бы узнать мнение - стоит тратить время на эти программы или нет?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=390831&amp;user=36364&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=21" class="addthx" data-post="390831"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 января 2019 04:07 &middot; Поправил: plutos <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#22');return false;">#22</a> </span><div align=left><br>
<I>Diabolic пишет:<br>На гитхаб ходили? </I><br>Тут дело не в гитхаве. Metasm у меня был установлен и работал как часы на windows 7. Потом была смена user account&#039;a<br>а вместе с ней все enviromental variables были потеряны. Вот я и решил обновить Ruby, а вместе с ним и Metasm. <br>(hg pull -u) или на худой конец просто переустановить с помощью Mercurial hg clone. Но на гитхабе нет gh repository для miasma. <br><b>Поэтому я и хочу узнать, что случилось с https://www.cr0.org/progs/metasm/hg/, в этом мой вопрос.<br></b><br><I>dma пишет:<br>Если не трудно, напишите позже удалось вам запустить Metasm и какие первые впечатления?P.S. Есть еще подобные программы и, вроде-как, не хуже Metasm, а в чем-то может даже и лучше - это Miasm и VxStripper. Может кто-нибудь работал с этими программами? Интересно было бы узнать мнение - стоит тратить время на эти программы или нет? </I><br><br>Удалось, и какое-то время он у меня исправно работал, а потом перестал. (см. выше)<br> Впечатления хорошие. С установкой немного пришлось повозиться, но потом все работало. Нужно конечно читать мануалы, но они есть и толковые.<br>Чтобы убедиться что все хорошо,  пробуем <b> ruby -rmetasm -e &#039;p metasm::VERSION&#039;</b>.  Если видим версию , значит успех!<br><br>Metasm описан в книге &quot;Practical Reverse Engineering&quot; Chapter 5 &#9632; Obfuscation (на форуме была ссылка), там есть даже тесты и упражнения.<br><br><b>Great metasm tutorial</b>: <noindex><a href="http://download.tuxfamily.org/overclokblog/How%20I%20Met%20Your%20Metasm/0vercl0k_How%20I%20Met%20Your%20Metasm.pdf" rel="nofollow" target="_blank">--&gt; here&lt;--</a></noindex>.<br><br>VxStripper - не знаю, не пробовал, а Miasm легко устанавливается на Ubuntu, Kali, FreeBSD.<br><br>Время (если оно есть, конечно)тратить стоит, можно много нового узнать. Но это конечно на любителя. Вроде меня.<br><br><b>Update:<br></b><br>На всякий случай еще раз скопировал<br>select <b>metasm.rb and metasm folder</b>; copy ; goto <b>D:\Ruby24-x64\lib\ruby\2.4.0</b> ; <br>paste<br>(понятно, что D:\Ruby24-x64\lib\ruby\2.4.0 нужно заменить with the directory where you installed ruby) (win)<br><br>и все заработало!<br><br>Так что вопрос мой отпал как-то сам собою...
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=390836&amp;user=4773&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=22" class="addthx" data-post="390836"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=36364" title="20-01-2019 02:19, ранг:5.4" target="_blank">dma</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]dma[/b]','')">dma</a></b><br></div>
<img src="img/s0.gif" alt=""><br><span class=txtSm>Ранг: -12.6 (нарушитель), 11thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.59'>Активность: 0.05<span style='color:red'>&searr;</span>0.03</span><br>Статус: <a href="action=userinfo&amp;user=36364">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 января 2019 05:19 <br><script type="text/javascript">QU('dma','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dma" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#23');return false;">#23</a> </span><div align=left><br>
<b>plutos</b>, спасибо за относительно подробный ответ и внимание. Когда писал вам вопрос аж руки тряслись от страха <img src="img/smilies/s1.gif" alt="">. Думал, что или проигнорируют, либо пошлют в гугл или посоветуют искать себя в чем-нибудь другом. Привык уже к стандартным ответам одного о-о-очень известного и авторитетного человека на нашем форуме, который не любит когда его ник в одном посте упоминают больше одного раза <img src="img/smilies/s1.gif" alt="">.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=390837&amp;user=36364&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=23" class="addthx" data-post="390837"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]sefkrd[/b]','')">sefkrd</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/39556.png" alt=""><br><span class=txtSm>Ранг: 77.2 (постоянный), 73thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.88'>Активность: 0.19<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=39556">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 января 2019 06:30 <br><script type="text/javascript">QU('sefkrd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sefkrd" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#24');return false;">#24</a> </span><div align=left><br>
<I>plutos пишет:<br>пробуем ruby </I><br>Интересный язык, в brew его ковырял..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=390839&amp;user=39556&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=24" class="addthx" data-post="390839"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 января 2019 07:10 <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#25');return false;">#25</a> </span><div align=left><br>
<I>dma пишет:<br>Когда писал вам вопрос аж руки тряслись от страха  </I><br><br>Да ну, это уже лишнее! Мы что, папуасы какие-то?<br> Подавляющее большинство людей на этом форуме очень знающие, толковые и отзывчивые люди, всегда готовые помочь. Если нормальный вопрос, показывающий, что человек сам думает и ищет, то, как правило, и нормальный ответ.
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=390841&amp;user=4773&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=25" class="addthx" data-post="390841"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39556" title="20-01-2019 04:16, ранг:67.9" target="_blank">sefkrd</a>, <a href="action=userinfo&user=19629" title="21-01-2019 10:38, ранг:38.0" target="_blank">DrVB_5_6</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Alchemistry[/b]','')">Alchemistry</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 145.8 (ветеран), 190thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.05'>Активность: 0.14<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=21411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 января 2019 20:43 <br><script type="text/javascript">QU('Alchemistry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alchemistry" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#26');return false;">#26</a> </span><div align=left><br>
<I>ntldr пишет:<br>Как отключить функции ci.dll, либо подменить их на свои </I><br>Вот только это проверяется патчгардом в rs5 а может и ниже. Если ты тестил то просто не дождался подарка <img src="img/smilies/s1.gif" alt=""> алсо в 10 там есть колбек который ставится только на хбоксе, вполне возможно он в другом модуле. Ну хотя мало кто захочет похакать хбокс.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=390888&amp;user=21411&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=26" class="addthx" data-post="390888"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]bartolomeo[/b]','')">bartolomeo</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.8 (посетитель), 16thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.87'>Активность: 0.02<span style='color:green'>&nearr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=26261">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 января 2019 22:58 <br><script type="text/javascript">QU('bartolomeo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bartolomeo" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#27');return false;">#27</a> </span><div align=left><br>
<I>Boostyq пишет:<br>Так же я пыталась найти псевдо-код, как процессор выполняет команды </I><br><br><noindex><a href="http://www.club155.ru/x86cmdcpu" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex> - неплохой сайт где по каждой инструкции есть псевдокод.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=390892&amp;user=26261&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=27" class="addthx" data-post="390892"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 января 2019 23:43 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=5#28');return false;">#28</a> </span><div align=left><br>
<I>bartolomeo пишет:<br>--&gt; Link &lt;-- - неплохой сайт где по каждой инструкции есть псевдокод.  </I><br>Хе-хе, в мануале интела всего навалом<br>Но там едва ли актуальная инфа, переводить такие штуки можно с ума сойти<br>Да и время идет, у меня уже свои таблицы имеются ^^
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=390893&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=5&amp;anchor=28" class="addthx" data-post="390893"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=4.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=4.html">5</a> . <b>6</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Статическая трассировка кода</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#29" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="24981">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24981" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
