<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Обойти проверку CRC файла - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Имеется жертва, с разрабами которой многолетняя &quot;дружба&quot; типа кто - кого. Не так давно они снова показали козью морду и сменили ASProt на VMProt3. В результате разрабы празднуют победу, а крякеры провалились полностью -">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=6859'>cppasm</a>, <a target='_blank' href='?action=userinfo&amp;user=55996'>dutyfree</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Обойти проверку CRC файла</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Chris[/b]','')">Chris</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 26.9 (посетитель), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.36'>Активность: 0.05<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=31549">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 21:28 <br><script type="text/javascript">QU('Chris','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chris" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Имеется жертва, с разрабами которой многолетняя &quot;дружба&quot; типа кто - кого. Не так давно они снова показали козью морду и сменили ASProt на VMProt3. В результате разрабы празднуют победу, а крякеры провалились полностью - жаждущие, в том числе на nsane, уже задолбали: когда и чё. Выяснил, что по VMProt3 в паблике вообще НИЧЕГО нет. Показательно, что LCF-AT категорически отказалась им заниматься, а на запросы отмалчивается или шлёт куда подальше.<br>У сабжа секция кода не закриптована, и тут бы сам Бог велел сварганить инлайн патч, тем более, что по старым наработкам хорошо знаю, где и что подправить. Всё бы так, да ма-аленькая &quot;загогулина&quot; © - проверка CRC. Просмотрел всё, что есть по предыдущим версиям VMProt, - ничего не подходит. Попробовал поискать решение &quot;в лоб&quot; - не получилось: наги &quot;File corrupted! ...&quot; и BugTrap удаляются без проблем, однако за собой они тянут Process terminated, что преодолеть не удалось. Интересно, что нашёл место, где проводится сравнение хешей, но ничего сделать не смог. (Не смешно...).<br><br>Появилась идея. Надо дать возможность сабжу загрузиться в память до того момента, когда проверка хешей уже будет проведена (но ещё не начата загрузка основного кода), сделать в этом месте остановку, пропатчить файл в памяти и после этого продолжить загрузку дальше. Разработал методику поиска, в результате быстренько удалось найти несколько таких мест. В общем, в Olly всё работает прекрасно: BP &gt; патчинг &gt; F9 - и вуаля - сабж загружается без всяких NAG&#039;ов и полностью вылечен.<br><br>Дык, теперь бы реализовать это программно!<br>Все точки останова находятся в системных библиотеках или в защищённой области памяти. Ни в секции VM, ни в секции кода такие точки найти не удалось. О-очень хотелось найти такие в секции кода, но сволочной протектор не даёт там ставить ВР.<br>Скорее всего, надо попытаться сделать что-то вроде лоадера, на первый взгляд алгоритм работы его не сложный:<br>- запуск сабжа;<br>- остановка процесса загрузки в память в точке, находящейся в системной dll&#039;ke. Ориентиром может быть определённая API функция;<br>- патчинг в секции кода, при этом есть особенность: патчить надо в памяти, а не на диске;<br>- снова запуск.<br>Реально ли это изобрести? Где что смотреть и изучать?<br><br>P.S. Прошу прощение за многословие. Наболело...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372114&amp;user=31549&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=1" class="addthx" data-post="372114"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 21:49 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>Chris</b><br><br>Для некоторых задач, которые требуют модификацию кода и она должна быть скрытой используется релокация образа. Тоесть оригинальный код не тронут, но исполняется модифицированная копия этого кода по другим адресам. Тут свои нюансы есть конечно.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372115&amp;user=40990&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=2" class="addthx" data-post="372115"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 22:49 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>Chris пишет:<br>Реально ли это изобрести? Где что смотреть и изучать? </I><br>Подобно и делалось <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=1#1" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br><b>Добавлено спустя -57 минут</b><br><I>difexacaw пишет:<br>Для некоторых задач, которые требуют модификацию кода и она должна быть скрытой используется релокация образа. Тоесть оригинальный код не тронут, но исполняется модифицированная копия этого кода по другим адресам. </I><br>Тоже неплохо, но лишний гемор... И нюансов-то тут много. Если б движок для этого был готовый, а то пилить некогда
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372117&amp;user=24257&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=3" class="addthx" data-post="372117"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 22:55 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>DenCoder</b><br><br>В самом простом случае секция может скопироваться в буфер и там исполняться(так как нет релатив адресации за пределы секции x32).
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372118&amp;user=40990&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=4" class="addthx" data-post="372118"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 22:58 <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Chris пишет:<br>Надо дать возможность сабжу загрузиться в память до того момента, когда проверка хешей уже будет проведена </I><br><br>Это наверняка не прокатит, судя по денувке (64 битный вмпрот 3+), проверки CRC происходили многократно <br>(десятки тысяч раз) и рандомно участками по примерно 10-255 байт во время запуска приложения и уже после<br>прохождения винмайна, работы в меню и загрузки сохраненной игры. <br><br>Но ты не огорчайся, патчи, что тебе там надо, потом аппаратный бряк на чтение этого кода ставь, смотри кто и <br>как считает с него crc, там наверняка будет такое (пример для 64 бит):<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">|</span>&nbsp;C1&nbsp;E0&nbsp;<span class="hl_number">07</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>shl</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">7</span>&nbsp;<span class="hl_char">|</span></li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">|</span>&nbsp;C1&nbsp;E9&nbsp;<span class="hl_number">19</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>shr</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">19</span>&nbsp;<span class="hl_char">|</span></li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">|</span><span class="hl_number">32</span>&nbsp;<span class="hl_number">02</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">rdx</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;считает&nbsp;<span class="hl_quote">&quot;crc&quot;</span></li><li class="hl_l0">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br>получи правильное значение для своего участка, дальше можешь его подбрутить, подогнав &quot;свободные&quot; <br>байты. Это 1 способ. Есть ещё более забавный <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372119&amp;user=41088&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=5" class="addthx" data-post="372119"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Chris[/b]','')">Chris</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 26.9 (посетитель), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.36'>Активность: 0.05<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=31549">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 23:35 <br><script type="text/javascript">QU('Chris','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chris" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>oldman пишет:<br>Это наверняка не прокатит </I><br>Пока фокусов не наблюдал, за пределы найденных точек проверки CRC не прорывались ни разу. Правда, проверял многократно только запуски, в работе статистики мало.<br>С хешами уже повозился - это же сущий мазохизм, желание как-то пропало. По путям обхода тоже ещё есть идеи.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372124&amp;user=31549&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=6" class="addthx" data-post="372124"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 23:57 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>difexacaw пишет:<br>В самом простом случае секция может скопироваться в буфер и там исполняться </I><br>Не, под первым слоем несколько виртуальных машин, в каждой перед выходом проверка crc рандомного региона. Именно поэтому не даёт вмпрот ставить софт бряки. Адреса выходов из вм надо будет менять на нужные, а это перемалывать все вм и таблицы crc.<br><br>Можно ловить выход из вм хардбряками, но по-моему адрес выхода поксорен неким значением. Чтоб его узнать, надо в &quot;эпилог&quot;-функции, коих несколько, определять его. Всё можно, но эти решения для тс будут ой как непросты. Самым правильным тогда уж будет радикальный подход - полный девирт всех лент и убирать проверки crc. Это будет универсально. А так, тс правильно предложил способ. Его недостаток в ручном анализе только, но для одной задачи и быстрее будет, если правильно подходить. <br><br>И вообще-то, да, oldman прав, надо будет подменять crc, высчитанное на заменённом участке.<br><br><I>oldman пишет:<br>получи правильное значение для своего участка, дальше можешь его подбрутить, подогнав &quot;свободные&quot; <br>байты. Это 1 способ. Есть ещё более забавный </I><br>Лично помимо рандомных проверок встречалась ещё большая )
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372126&amp;user=24257&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=7" class="addthx" data-post="372126"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 00:08 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>DenCoder</b><br><br>Это я общую суть показал, тоесть разделение кода и даннных(их выборку, подмена данных). Если же код изменяется динамически, то как следствие необходимо апдейтить каким то образом копию кода - это событие обнаружить в начале. Если же код статик и нет релатив адресации за пределы блока, то это успешно сработает.<br><br><b>Добавлено спустя -56 минут</b><br>&gt; Можно ловить выход из вм хардбряками<br>&gt; Самым правильным тогда уж будет радикальный подход - полный девирт <br><br>Я не представляю о чём вы говорите, но это локальное решение. Общее - подмена данных. Это единственный универсальный способ(можно вернуть любые данные), тогда ничего и в памяти патчить не нужно. Но реализация не проста <noindex><a href="https://yadi.sk/i/atRcSatPuNqm4" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372127&amp;user=40990&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=8" class="addthx" data-post="372127"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 00:14 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Для рандомных проверок crc вспомнил - можно подменять значение rdtsc на одно и то же (оно там используется в качестве ГПЧ для выбора региона проверки), тогда проверок пофиксенного региона не будет . Но это ж нужно, чтоб драйвер только для этого приложения делал такие подмены и только при нахождении инструкций в определённых местах.<br><br><b>Добавлено спустя -57 минут</b><br><I>difexacaw пишет:<br>подмена данных </I><br><br>а тс нужно<br><br><I>Chris пишет:<br>- патчинг в секции кода </I><br><br><b>Добавлено спустя -53 минут</b><br><I>difexacaw пишет:<br>Я не представляю о чём вы говорит </I><br>Есть вм вмпрота. Перед завершением своей работы считается адрес выхода на какую-то функцию, после чего ксорится, ксорятся все регистры и происходит выход на нужную эпилог-функцию, где всё ксорится обратно и происходит выход на целевую функцию. Виртуальные машины работают между этими функциями, где вся логика программы, но бывает и вызываются из какой-то функции.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372129&amp;user=24257&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=9" class="addthx" data-post="372129"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 00:30 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>DenCoder</b><br><br>&gt; - патчинг в секции кода <br><br>Вот я про это и говорю, что он нужен при вашем решении <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372131&amp;user=40990&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=10" class="addthx" data-post="372131"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 00:52 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Как бы подошёл я более проще к подмене кода, накрытого вмпротом:<br>план A<br>- найти rdtsc-примитивы<br>- вбить одно возвращаемое значение, чтобы проверялся только один регион (естественно, который не трогали). Если используется больше одной вм, то для каждой своё значение будет. Если размер изменяемого кода невелик, можно просто угадать все значения с вероятностью в 100%<br>- если есть вызовы глобальных проверок crc, тут уже изучать надо. Высчитать адреса для проверяемых регионов и их crc в большой таблице можно, и подсунуть свои пошифрованные crc, но занимает время<br><br>план B<br>- тупо поставить векторную обработку, на изменённых регионах запретить чтение(можно и выполнение, тогда в обработчике будет нужный код). Но при этом подходе может добавиться тормозов к тормозам вмпрота. В тех случаях, где некритично, это можно использовать
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372132&amp;user=24257&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=11" class="addthx" data-post="372132"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 01:28 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>oldman пишет:<br>Есть ещё более забавный </I><br>на него лет 10 не обращали внимания, пусть ещё столько же....потом расскажем..<img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372134&amp;user=3230&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=12" class="addthx" data-post="372134"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Chris[/b]','')">Chris</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 26.9 (посетитель), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.36'>Активность: 0.05<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=31549">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 08:30 <br><script type="text/javascript">QU('Chris','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chris" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Можно понять гуру, коим интересно рассматривать проблему глобально, применительно к VMProt&#039;у вообще. В данном же случае мне бы хотелось практически реализовать один из возможных, как мне кажется, способов обойти проверку CRC. Скорее всего он не станет универсальным, но где-то вдруг поможет решить проблему. Это ведь тоже даёт право на жизнь, не?<br><br>Как вариант, это может быть лоадер, который:<br>- запускает приложение;<br>- мониторит процесс загрузки, ловит нужную API и процесс останавливает (фактически это полный аналог функции ВР в Olly);<br>- производит патчинг в секции кода (аналогично тому, как это делает dUP, только патчить надо в памяти, а не на диске);<br>- отпускает процесс идти дальше.<br><br>Реально ли замутить такое?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372144&amp;user=31549&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=13" class="addthx" data-post="372144"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 09:33 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>Chris</b>, если у тя под олькой так шоколадно, так и юзай сабж под ней..<img src="img/smilies/s6.gif" alt=""><br>чего тебя так плющит, друзяк бывших наказать.?<img src="img/smilies/s14.gif" alt=""><br>ну а так совет же дельный дали, даже наводку с <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html#5" rel="nofollow" target="_blank">--&gt; патерном&lt;--</a></noindex>, только вникать не хочешь, да и сабжик засветил бы, может это тоже наши друзяки.<img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372146&amp;user=3230&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=14" class="addthx" data-post="372146"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 15:48 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>Bronco пишет:<br>ну а так совет же дельный дали, даже наводку с --&gt; патерном&lt;-- </I><br>Если патченных регинов, которые проверяются, больше 4х, то хард бряков не хватит<br><br><b>Добавлено спустя</b><br><I>Chris пишет:<br>только патчить надо в памяти, а не на диске) </I><br>Никто никогда на диске и не патчил. Пропатчить можно, пользуясь хардбряками можно, если условие выше выполняется. Если нет, то план B
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372166&amp;user=24257&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=15" class="addthx" data-post="372166"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 16:05 &middot; Поправил: oldman <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>DenCoder пишет:<br>больше 4х, то хард бряков не хватит </I><br><br>хардбряки используютя только для диагностики - для определения границ просчета нужных участков и <br>правильных значений црц. Что мешает сделать несколько проходов, чтобы вычислить границы и правильное <br>значение црц нужных участков? В Думе я пропатчил несколько десятков выходов из вм, естественно<br>пришлось многократно прогонять скрипт в дебагере и т.д., время всё это занимает - ну а по другому и не будет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372170&amp;user=41088&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=16" class="addthx" data-post="372170"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 16:26 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Если патченных регинов, которые проверяются, больше 4х </I><br>подели регион сканирования на 255 байтов, вот и будет тебе кол-во участков, как рандом работает не вникал, но большую часть участков стабильно сканят. Ну а так, всё это гавно нагибается на раз_два. <br>Учитывая что любой вопрос по гавнопроту либо риторический, либо табу, либо козу круктят, паблить желания нет.
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372174&amp;user=3230&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=17" class="addthx" data-post="372174"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 16:46 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>oldman пишет:<br>В Думе я пропатчил несколько десятков выходов из вм, естественно<br>пришлось многократно прогонять скрипт в дебагере и т.д., время всё это занимает - ну а по другому и не будет.  </I><br>По-другому - план B <img src="img/smilies/s1.gif" alt=""><br><br><I>Bronco пишет:<br>подели регион сканирования на 255 байтов </I><br>Рандомные регионы маленькие, меньше 255 байт, поделишь на 255 - целое будет 0 )<br>А хард бряк на доступ к памяти вообще-то только 4 байта может охватить )<br><br><b>Добавлено спустя -56 минут</b><br>А в принципе хорошую идею подал Инде <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#4" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>Патчим в копии только то, что надо, выполняется копия. Но т.к. всё равно при выходах из вм будет переход на оригинальную секцию, то моя производная из идеи - поставить запрет на выполнении в исходной секции. Обработчик ловит эксепшен и передаёт управление назад в копию ). <b>Bronco</b>, из тебя сделать клон и немного подправить, впихнуть легенду и прописать по другому адресу, ты ж ничего не будешь знать об иногда говнистом оригинале. <img src="img/smilies/s5.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372176&amp;user=24257&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=18" class="addthx" data-post="372176"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 16:56 <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>DenCoder пишет:<br>По-другому - план B  </I><br><br>учитывая тормоза поверх вмпрота, +время на реализацию и отладку такого - не, все таки единственный выбор -<br>план А <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372177&amp;user=41088&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=19" class="addthx" data-post="372177"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 17:00 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>oldman</b>, да, тут надо выбирать между проще и тормозами.<br><br>Основные идеи нарисовали, варианты стратегий есть. Как конкретно делать - тс уже сам может собрать, систематизировать информацию и в путь
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372178&amp;user=24257&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=20" class="addthx" data-post="372178"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 17:05 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Bronco, из тебя сделать клон и немного подправить, впихнуть легенду и прописать по другому адресу, ты ж ничего не будешь знать об иногда говнистом оригинале. </I><br>Это уже клон писал, или <I>говнистый оригинал. </I>??<img src="img/smilies/s6.gif" alt=""><br>млять, переведи на доступный.<img src="img/smilies/s6.gif" alt=""><br><I>DenCoder пишет:<br>Патчим в копии только то, что надо, выполняется копия. </I><br>ну если решение рабочее, дерзай.никто же не настаивает на более простых..<img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372179&amp;user=3230&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=21" class="addthx" data-post="372179"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 17:06 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>Bronco пишет:<br>ну если решение рабочее, дерзай.никто же не настаивает на более простых.. </I><br>тс - не я )<br><br><b>Добавлено спустя 3 минуты</b><br>2 задачи были в моей практкике, совместить решения по ним - будет решение и этой задачи. Как оно будет работать, тормозно не тормозно - это уже дело испытаний. Возможно, решение надо будет совершенствовать или искать другое. Не хочу сейчас искать другие решения, может и есть, поищите ещё. Но теоретически, для плана B, поскольку проверка рандомна, то тормоза-то будут и не всегда. Для избавления вообще от тормозов план A, но он требует времени и подготовки. Для производной от идеи Инде маленький тормозок будет каждый раз при выходе из вм, если выходы из вм не патчить в копии кода.<br><br><I>oldman пишет:<br>учитывая тормоза поверх вмпрота, +время на реализацию и отладку такого - не, все таки единственный выбор -<br>план А </I><br>Количество потраченного времени на реализацию и отладку будет зависеть от опыта в подобных вещах. Похожая задача у меня была, поступил почти как в плане B, и меньше времени на это понадобилось, чем если бы искал причины, почему происходит то, что не нужно. Как у тс с опытом - не знаю. Сколько тормозов будет - неизвестно, т.к. по многим причинам нет возможности сейчас проверить это за тс на самом приложении.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372180&amp;user=24257&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=22" class="addthx" data-post="372180"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 18:34 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24575.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>DenCoder пишет:<br>если выходы из вм не патчить в копии кода.  </I><br>в теории патчить можно всё, вплоть до указателей в таблицах, или в ленте. можешь менять логику, ставить пост условия, писать свои примитивы. Вопрос во времени и гешефта.<br>На форуме был пользователь который тупо скопи_пастил 2 ветки из нейросети, и там уже сношал, после чего разочаровался в защите. <img src="img/smilies/s14.gif" alt=""><br>Возня только с длинными служебными цепочками констант для перехода по примитивам, и дубликатами покриптованных указателей(вот это был сюрприз!). Если сабж стоящий можно время потратить, если там левый гуй, с тыреным кодом из паблик сорцов, но нах это нужно.
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372184&amp;user=3230&amp;forum_n=5&amp;topic=24575.html&amp;page=0&amp;anchor=23" class="addthx" data-post="372184"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Обойти проверку CRC файла</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#24" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="24575">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24575" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
