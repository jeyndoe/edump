<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как поставить железный бряк? (НЕ в Ольге, естесвенно :] - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Речь о лодыре или инлайне: брякнуть пакованую прогу в нужном месте и пропатчить. Вопросы: 1) как вообще ставятся железные бряки (on execution)? 2) как получить управление по бряку?">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как поставить железный бряк? (НЕ в Ольге, естесвенно :]</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=16399&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=16399&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=6&amp;topic=16399&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=6&amp;topic=16399&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2010 02:56 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Речь о лодыре или инлайне: брякнуть пакованую прогу в нужном месте и пропатчить.<br>Вопросы: <br>1) как вообще ставятся железные бряки (on execution)?<br>2) как получить управление по бряку?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260566&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=1" class="addthx" data-post="260566"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2010 22:29 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
Помогу немного.<br>По контексту можно проследить, что инструкция CALL BFF667F1 будет выполняться только, если адрес в [ebx + 4] &gt;= 0x80000000 и &lt;= 0xBFFFFFFF или [[[0xBFFBBCF8]] + 0x1C] &gt; 0. Этот адрес передается этой ф-ции как 5-ый параметр для вызова.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=260989&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=2" class="addthx" data-post="260989"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2010 23:16 &middot; Поправил: 0xy <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
Вот весь стек.<br>Думаю, это поможет Archer уточнить точку входа в Ring3.<br> <br><code><br>0063FC5C  /BFF66821  ; RETURN to KERNEL32.BFF66821<br>0063FC60  |0063FD28<br>0063FC64  |0063FE20<br>0063FC68  |0063FD44<br>0063FC6C  |0063FD00<br>0063FC70  |0063FE20  ; Pointer to next SEH record<br>0063FC74  |BFF6682D  ; SE handler<br>0063FC78  |0063FE20<br>0063FC7C  |0063FD10  ; ASCII &quot;0c&quot;<br>0063FC80  \BFF7845A  ; RETURN from KERNEL32.BFF667F1 to KERNEL32.BFF7845A <br>0063FC84   0063FD28<br>0063FC88   0063FE20<br>0063FC8C   0063FD44<br>0063FC90   0063FD00<br>0063FC94   660EB126<br>0063FC98   00000000<br>0063FC9C   819134A0<br>0063FCA0   00530000<br>0063FCA4   00530000<br>0063FCA8   00530000<br>0063FCAC   00530000<br>0063FCB0   00530000<br>0063FCB4   00530000<br>0063FCB8   00530000<br>0063FCBC   00530000<br>0063FCC0   00000000<br>0063FCC4   00000000<br>0063FCC8   00000000<br>0063FCCC   00000000<br>0063FCD0   00000000<br>0063FCD4   00000001<br>0063FCD8   00000000<br>0063FCDC   00000000<br>0063FCE0   00000000<br>0063FCE4   00000000<br>0063FCE8   00000000<br>0063FCEC   00000000<br>0063FCF0   00000001<br>0063FCF4   00000000<br>0063FCF8   00000000<br>0063FCFC   00000000<br>0063FD00   00000000<br>0063FD04   00000000<br>0063FD08   819134A0<br>0063FD0C   00000000<br>0063FD10   0063FE30<br>0063FD14   FFECBAD7<br>0063FD18   0063FD44<br>0063FD1C   0063FD28<br>0063FD20   0000000D<br>0063FD24   00000000<br>0063FD28  /C0000005	_EXCEPTION_RECORD<br>0063FD2C  |00000000<br>0063FD30  |00000000<br>0063FD34  |66003599<br>0063FD38  |00000002<br>0063FD3C  \00000000<br>0063FD40   FFFFFFFF<br>0063FD44  /0001001F	_CONTEXT<br>0063FD48  |00000000<br>0063FD4C  |00000000<br>0063FD50  |00000000<br>0063FD54  |00000000<br>0063FD58  |FFFF0FF0<br>0063FD5C  |00002500<br>0063FD60  |FFFF027F<br>0063FD64  |FFFF0000<br>0063FD68  |FFFFFFFF<br>0063FD6C  |00000000<br>0063FD70  |00000000<br>0063FD74  |00000000<br>0063FD78  |FFFF0000<br>0063FD7C  |00000000<br>0063FD80  |00000000<br>0063FD84  |00000000<br>0063FD88  |00000000<br>0063FD8C  |00000000<br>0063FD90  |00000000<br>0063FD94  |00000000<br>0063FD98  |00000000<br>0063FD9C  |00000000<br>0063FDA0  |00000000<br>0063FDA4  |00000000<br>0063FDA8  |00000000<br>0063FDAC  |00000000<br>0063FDB0  |00000000<br>0063FDB4  |00000000<br>0063FDB8  |00000000<br>0063FDBC  |00000000<br>0063FDC0  |00000000<br>0063FDC4  |00000000<br>0063FDC8  |00000000<br>0063FDCC  |0000000A<br>0063FDD0  |00000000<br>0063FDD4  |0000123F<br>0063FDD8  |00000197<br>0063FDDC  |00000197<br>0063FDE0  |00000000<br>0063FDE4  |819134A0<br>0063FDE8  |00530000<br>0063FDEC  |81913500<br>0063FDF0  |819134C0<br>0063FDF4  |0063FF68<br>0063FDF8  |0063FE30<br>0063FDFC  |66003599<br>0063FE00  |0000018F<br>0063FE04  |00210A82<br>0063FE08  |0063FE20<br>0063FE0C  \00000197<br>0063FE10   00000197<br>0063FE14   00000197<br>0063FE18   00000197<br>0063FE1C   00000197<br><I>0063FE20   0063FF68  ; Pointer to next SEH record -- Стек до исключения </I><br>0063FE24   660EB126  ; SE handler<br>0063FE28   660194C0<br>0063FE2C   FFFFFFFF<br>0063FE30   0063FF78<br>0063FE34   004011BA  ; RETURN from MSVBVM60.ThunRTMain to INSTR.004011BA<br>0063FE38   004013E0<br>0063FE3C   BFF7B9E4  ; RETURN from KERNEL32.BFF642F1 to KERNEL32.BFF7B9E4<br>0063FE40   00000000<br>0063FE44   819134A0<br>0063FE48   00530000<br>0063FE4C   74736E49<br>0063FE50   58450072<br>0063FE54   FFEC0045<br>0063FE58   0063FE84<br>0063FE5C   0063FE68<br>0063FE60   00000003<br>0063FE64   00000006<br>0063FE68   80000003<br>0063FE6C   00000000<br>0063FE70   00000000<br>0063FE74   BFF66878  ; KERNEL32.DebugBreak<br>0063FE78   00000001<br>0063FE7C   00000000<br>0063FE80   C054E50A<br>0063FE84   0001001F<br>0063FE88   00000000<br>0063FE8C   00000000<br>0063FE90   00000000<br>0063FE94   00000000<br>0063FE98   FFFF0FF0<br>0063FE9C   00002500<br>0063FEA0   0000037F<br>0063FEA4   00000000<br>0063FEA8   00000000<br>0063FEAC   00000000<br>0063FEB0   00000000<br>0063FEB4   00000000<br>0063FEB8   00001F80<br>0063FEBC   00000000<br>0063FEC0   00000000<br>0063FEC4   00000000<br>0063FEC8   00000000<br>0063FECC   00000000<br>0063FED0   00000000<br>0063FED4   00000000<br>0063FED8   00000000<br>0063FEDC   00000000<br>0063FEE0   00000000<br>0063FEE4   00000000<br>0063FEE8   00000000<br>0063FEEC   00000000<br>0063FEF0   00000000<br>0063FEF4   00000000<br>0063FEF8   00000000<br>0063FEFC   00000000<br>0063FF00   00000000<br>0063FF04   00000000<br>0063FF08   00000000<br>0063FF0C   00000008<br>0063FF10   00000000<br>0063FF14   0000123F<br>0063FF18   00000197<br>0063FF1C   00000197<br>0063FF20   00000000<br>0063FF24   819786F0<br>0063FF28   00000080<br>0063FF2C   819866E0<br>0063FF30   C16E7060<br>0063FF34   00000019<br>0063FF38   0063FF6C<br>0063FF3C   81907050<br>0063FF40   8194992C<br>0063FF44   C16E7060<br>0063FF48   0063FF6C<br>0063FF4C   004011B0  ; INSTR.&lt;ModuleEntryPoint&gt;<br>0063FF50   BFF6B487  ; RETURN from KERNEL32.BFF6A250 to KERNEL32.BFF6B487<br>0063FF54   00000000<br>0063FF58   819134C0<br>0063FF5C   30E60000<br>0063FF60   0063FE40<br>0063FF64   00530000<br>0063FF68   FFFFFFFF  ; End of SEH chain<br>0063FF6C   BFFB1B20  ; SE handler<br>0063FF70   BFF69138<br>0063FF74   00000000<br>0063FF78   0063FFF4<br>0063FF7C   BFF7B896  ; RETURN from KERNEL32.BFF7B8E0 to KERNEL32.BFF7B896<br>0063FF80   819786A4<br>0063FF84   00000008<br>0063FF88   819134A0<br>0063FF8C   00000000<br>0063FF90   00000000<br>0063FF94   00000000<br>0063FF98   00000000<br>0063FF9C   00000000<br>0063FFA0   00000000<br>0063FFA4   00000000<br>0063FFA8   00000000<br>0063FFAC   00000000<br>0063FFB0   00000000<br>0063FFB4   00000000<br>0063FFB8   00000000<br>0063FFBC   00000000<br>0063FFC0   00000000<br>0063FFC4   00000000<br>0063FFC8   00000000<br>0063FFCC   00000000<br>0063FFD0   0002FFFF<br>0063FFD4   0000F263<br>0063FFD8   0063E000<br>0063FFDC   00640000<br>0063FFE0   00000000<br>0063FFE4   FFFFFFFF<br>0063FFE8   81986568<br>0063FFEC   00000000<br>0063FFF0   430F30E6<br>0063FFF4   82D66FEC<br>0063FFF8   BFF7A24F  ; RETURN to KERNEL32.BFF7A24F<br>0063FFFC   00000000<br></code>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260992&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=3" class="addthx" data-post="260992"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 июня 2010 02:03 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#4');return false;">#4</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0063FD28</span>&nbsp;<span class="hl_char">/</span>C0000005&nbsp;_EXCEPTION_RECORD&nbsp;<span class="hl_char">-</span>&nbsp;ACCESS_VIOLATION</li><li class="hl_l1"><span class="hl_number">0063FD2C</span>&nbsp;<span class="hl_char">|</span><span class="hl_number">00000000</span></li><li class="hl_l0"><span class="hl_number">0063FD30</span>&nbsp;<span class="hl_char">|</span><span class="hl_number">00000000</span></li><li class="hl_l1"><span class="hl_number">0063FD34</span>&nbsp;<span class="hl_char">|</span><span class="hl_number">66003599</span>&nbsp;<span class="hl_char">-</span>&nbsp;eip&nbsp;инструкции<span class="hl_char">,</span>&nbsp;вызвавшей&nbsp;исключение<span class="hl_char">,</span>&nbsp;модуль&nbsp;msvbvm60<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_number">0063FD38</span>&nbsp;<span class="hl_char">|</span><span class="hl_number">00000002</span></li><li class="hl_l1"><span class="hl_number">0063FD3C</span>&nbsp;<span class="hl_char">\</span><span class="hl_number">00000000</span></li><li class="hl_l0"><span class="hl_number">0063FD40</span>&nbsp;FFFFFFFF</li>        </ol>
    </div>
</div></div>
<br><br>по адресу 63FD28 код исключения 0xС0000005 - ACCESS_VIOLATION<br><br>регистры на момент исключения<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0063FDE0</span>&nbsp;<span class="hl_char">|</span><span class="hl_number">00000000</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1"><span class="hl_number">0063FDE4</span>&nbsp;<span class="hl_char">|</span><span class="hl_number">819134A0</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l0"><span class="hl_number">0063FDE8</span>&nbsp;<span class="hl_char">|</span><span class="hl_number">00530000</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_number">0063FDEC</span>&nbsp;<span class="hl_char">|</span><span class="hl_number">81913500</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_number">0063FDF0</span>&nbsp;<span class="hl_char">|</span><span class="hl_number">819134C0</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_number">0063FDF4</span>&nbsp;<span class="hl_char">|</span><span class="hl_number">0063FF68</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_number">0063FDF8</span>&nbsp;<span class="hl_char">|</span><span class="hl_number">0063FE30</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_number">0063FE04</span>&nbsp;<span class="hl_char">|</span><span class="hl_number">00210A82</span>&nbsp;<span class="hl_char">-</span>&nbsp;eflags</li><li class="hl_l1"><span class="hl_number">0063FE08</span>&nbsp;<span class="hl_char">|</span><span class="hl_number">0063FE20</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_registr">esp</span></li>        </ol>
    </div>
</div></div>
<br><br>Адрес инструкции похоже внутри функции ThunRTMain, вызванной по адресу выше точки возврата 4011BA.<br><br>На точку входа косвенно указывает <br><br>0063FD14 FFECBAD7 - адрес возврата в ядро<br>0063FD18 0063FD44 - указатель на EXCEPTION_RECORD<br>0063FD1C 0063FD28- указатель на CONTEXT<br>0063FD20 0000000D - номер ExceptionCallback функции из таблицы<br>0063FD24 00000000<br><br>Если выше подняться, то можно заметить 819134A0, что очень похоже на FUNCTION_THUNK, которых много в Win98 SE )). При следующем запуске винды очень вероятно там получить другой адрес. Выше этого адреса всего на несколько байт, думаю и стоит искать точку входа. Принцип обработки callback-функций в 98 на ring3 очень похож на Nt...<br><br>Там должно быть что-то вроде<br>mov eax, CONST<br>jmp dword ptr [eax]<br><br>кажется немного ошибаюсь в последнем... а выложи kernel32 от win98.<br><br>насколько помню, там kliff.vxd (в переводе - клещ) эти фанки пишет. Если можно, то и его тоже, вспомню немного старую винь <img src="img/smilies/s3.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=260998&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=4" class="addthx" data-post="260998"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 июня 2010 07:06 &middot; Поправил: 0xy <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<I>kliff.vxd</I><br>Нету у меня такого.  <br><br><I>0063FD14 FFECBAD7 - адрес возврата в ядро</I><br>По логике--да. Но этот адрес из процесса не виден. А значит, скорее всего, не виден и адрес вызова.<br><br>Но вызывает ядро СРАЗУ BFF78344. Верно? <br><br><img src="img/attach.gif" alt=""> <a href="./files/c6a4_24.06.2010_CRACKLAB.rU.tgz">c6a4_24.06.2010_CRACKLAB.rU.tgz</a> - KERNEL32.RAR
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=261003&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=5" class="addthx" data-post="261003"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 июня 2010 08:28 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
Есть очень интересный кусок<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF7869C&nbsp;<span class="hl_number">148</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_58<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0C0000005h</span>&nbsp;<span class="hl_comment">; jumptable BFF78620 case 13 - 0xD</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF786A3&nbsp;<span class="hl_number">148</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_48<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">2</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF786AA&nbsp;<span class="hl_number">148</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_44<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF786B1&nbsp;<span class="hl_number">148</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_40<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FFFFFFFFh</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF786B8&nbsp;<span class="hl_number">148</span>&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_BFF7870F</li>        </ol>
    </div>
</div></div>
<br><br>Если предположить, что именно здесь заполняется структура EXCEPTION_RECORD, то дальше, по индукции совместно с логикой <img src="img/smilies/s2.gif" alt=""> - перед вызовом колбека BFF78344 вызывается сначала колбек BFF78583, который переводит номер исключения 0xD в 0xC0000005 и принимает решение, как дальше поступить.<br><br>На это также указывает<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF78724&nbsp;<span class="hl_number">148</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">-</span><span class="hl_number">14h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF78727&nbsp;<span class="hl_number">148</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span><span class="hl_number">20h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF7872A&nbsp;<span class="hl_number">148</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_0<span class="hl_char">]</span><span class="hl_comment">; код исключения 0xD</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF7872D&nbsp;<span class="hl_number">148</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_8<span class="hl_char">]</span><span class="hl_comment">; pContext</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF78730&nbsp;<span class="hl_number">148</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_5C<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF78733&nbsp;<span class="hl_number">148</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_60<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF78736&nbsp;<span class="hl_number">148</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF78738&nbsp;<span class="hl_number">14C</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_6C<span class="hl_char">]</span><span class="hl_comment">; AddrFrom</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF7873B&nbsp;<span class="hl_number">14C</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">14h</span><span class="hl_comment">; length</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF7873D&nbsp;<span class="hl_number">150</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_64<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>edi</b></span>&nbsp;<span class="hl_char">-</span>&nbsp;pExceptionRecord</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF78740&nbsp;<span class="hl_number">150</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>ebx</b></span><span class="hl_comment">; AddrTo</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF78741&nbsp;<span class="hl_number">154</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_68<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>edx</b></span><span class="hl_comment">; pContext</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF78744&nbsp;<span class="hl_number">154</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_6C<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FFECBAD7h</span><span class="hl_comment">; совсем не адрес возврата</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF7874B&nbsp;<span class="hl_number">154</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF7874C&nbsp;<span class="hl_number">158</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_BFFBB846<span class="hl_comment">; ядерный CopyMem через VxD</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF78751&nbsp;<span class="hl_number">158</span>&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">10h</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF78754&nbsp;<span class="hl_number">148</span>&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF78756&nbsp;<span class="hl_number">148</span>&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_BFF787</li>        </ol>
    </div>
</div></div>
<br><br>Далее BFF78344 заносится в некую структуру по смещению 0x24. На эту структуру указывает esi, адрес берется из второго параметра (первый - номер исключения). Ну а вот вызывается уже из ядра как минимум второй... Значит более ранняя точка входа - BFF78583.<br><br>А с адресом возврата в ядро промашка вышла, вообще-то сегмент стека вместе с уазателем переключаются каждый раз при входе в ядро/выходе из ядра.<br><br>Кстати FREQASM занимает адреса от 0xBFF61000 до 0xBFF69000. Так что я бы поставил бряк на 0xBFF78583. Для STATUS_SINGLE_STEP(#DB) код исключения 1 и для STATUS_BREAKPOINT(#BP) - 3. Вперед!!!... <img src="img/smilies/s2.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=261005&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=6" class="addthx" data-post="261005"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 июня 2010 16:29 &middot; Поправил: 0xy <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<I>я бы поставил бряк на 0xBFF78583</I><br>Такой бряк намертво подвешивает систему! <img src="img/smilies/s2.gif" alt=""><br><br>Вообще, секции системных либ в 9x имеют ОСОБЫЙ СТАТУС. Изначально они вообще ReadOnly и не по зубам VirtulaProtect! Но здесь на помощь приходит шаманская функция #4 <img src="img/smilies/s3.gif" alt=""> После этого секции ВРОДЕ БЫ становятся ГЛОБАЛЬНЫМИ RW-регионами. Но возникает масса неприятных нюансов:<br>1) патчи нередко пропадают! (особенно в конце секции FREQASM); при этом 2-я Ольга ругается &quot;Error flush cache!&quot;;<br>2) секции (или отдельные страницы) могут вдруг снова стать ReadOnly;<br>3) бряки (даже железные) здесь не всегда обрабатываются корректно: к примеру, бряк по адресу <I>BFF6681E |. FF55 18 CALL DWORD PTR SS:[EBP+18] ; Call SEH</I> не перехватывается Ольгой (? <img src="img/smilies/s10.gif" alt=""> ) и приводит к переполнению стека (вероятно, в результате рекурсивных попыток обработать его этим же кодом). <br><br>Т.е. есть проблема: где же разместить код хука? <br>В функции BFF667F1 (Call (Call SEH)) патчи вроде живут нормально, но там нет места <img src="img/smilies/s9.gif" alt=""> А все попытки выпрыгнуть из нее, даже в относительно стабильные регионы, почему-то терпят фиаско.<br><br>PS<br>А есть ли возможность самому создать ГЛОБАЛЬНЫЙ регион?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=261049&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=7" class="addthx" data-post="261049"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 июня 2010 16:32 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
&gt; Такой бряк намертво подвешивает систему!<br>9x это мёртвая обогая ось, которая давно никем не юзается. NT это абсолютно иная архитектура. Иди Рихтера читай.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=261050&amp;user=17964&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=8" class="addthx" data-post="261050"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 июня 2010 19:28 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
Факт пропадания патчей пока поставлен под сомнение. Стабильный регион найден. Исследования продолжаются <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=261061&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=9" class="addthx" data-post="261061"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 июня 2010 09:14 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
<b>патчи нередко пропадают!</b><br>Помню, у меня 98 SE стояла, с 32 мб озу. При работе WinRar ось часто выпадала с ошибками в kernel32. Дело было в том, что FUNCTION_THUNKS по адресам 0x800XXXXX куда-то терялись. Т.е. было похоже на ошибку подкачки. Добавил еще 128 мб, такие ошибки перестали иметь место... Возможно, в 98-ой, чтобы быстрей ее выпустить и отделаться от нее, решили одну из проблем перезаписью секций прям из либ...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=261073&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=10" class="addthx" data-post="261073"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2010 22:41 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
Прочитал посты сверху, но так и не понял, какого нужно лезть в системные библиотеки? По идее, тс хочет поставить аппаратники и перехватить исключения без цикла отладки. А после этого нужно изменить код приложения, тогда почему бы не перехватить в idt int3 и не модифицировать код прямо из ядра?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=261234&amp;user=6336&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=11" class="addthx" data-post="261234"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 июля 2010 00:40 &middot; Поправил: 0xy <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
<b>ARCHANGEL</b><br><I>почему бы не перехватить в idt int3 и не модифицировать код прямо из ядра? </I><br>Потому, что ядро для меня--темный лес <img src="img/smilies/s4.gif" alt=""><br><br>К тому же, мой метод, теоретически, универсален для всех версий Винды. Хотя на практике возможен гемор с дизассемблированием комманд, затираемых хуком. Благо, для линейки 9x этого удалось избежать: в Millenium и 95osr2 код оказался идентичным <img src="img/smilies/s1.gif" alt=""> <br><br><b>Просьба глянуть, кому не лень, как это место выглядит в виндах линейки NT:</b><br><br><code><br> &#036; BA 2D68F6BF MOV EDX,BFF6682D  ;ExecuteHandlerForException<br> . EB 05 JMP SHORT BFF667FD<br> /&#036; BA 5268F6BF MOV EDX,BFF66852 ;ExecutehandlerForUnwind<br> |&gt; 55 PUSH EBP<br> |. 8BEC MOV EBP,ESP<br> |. FF75 0C PUSH DWORD PTR SS:[EBP+C]<br> |. 52 PUSH EDX<br> |. 64:FF35 00000&gt;PUSH DWORD PTR FS:[0]<br> |. 64:8925 00000&gt;MOV DWORD PTR FS:[0],ESP<br> |. FF75 14 PUSH DWORD PTR SS:[EBP+14]<br> |. FF75 10 PUSH DWORD PTR SS:[EBP+10]<br> |. FF75 0C PUSH DWORD PTR SS:[EBP+C]<br><I> |. FF75 08 PUSH DWORD PTR SS:[EBP+8]<br> |. FF55 18 CALL DWORD PTR SS:[EBP+18] ; Call SEH</I><br> |. 83C4 10 ADD ESP,10<br> |. 64:8F05 00000&gt;POP DWORD PTR FS:[0]<br> |. C9 LEAVE<br> \. C3 RET<br></code>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=261289&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=12" class="addthx" data-post="261289"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 июля 2010 03:31 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<b>0xy</b><br><br>Ну а что такого?<br><br>у <b>ARCHANGEL</b> кстати еще вариант, если не устраивает вариант хука. sidt под 98 свободно выполняется в отличие от NT. Но дальше это все дело экспериментов - т.к. под 98 на уровне ядра мало кто пишет... (боюсь там нельзя поставить юзермодный адрес обработчика, это и kernel32 запалит)<br><br>Исторически 98-ой по архитектуре предшествовала 95. А вперед только Me и всё!!! 9x законно изжила себя, хотя это могло быть и намного раньше...<br>Есть огромные разницы между 9x и NT - <br>1) Ядро в 98 занимает верхнюю четверть 32-битного адресного пространства, NT - половину<br>2) Ядро в 98 открыто на юзермоде, на NT - нет<br>3) По наблюдениям и по сочетании первых двух 9x хоть как-то пытается контролировать верхнюю половину, в то время как на NT более мощные механизмы (конечно не без дыр <img src="img/smilies/s1.gif" alt=""> ).<br><br>Из-за, кстати, названия там (в 9x) модуля, многими считавшимся основным, kernel32 (32-бит ядро), да еще и с базой 0xBFF60000 (0x80000000 &lt;= Address &lt;= 0xFFFFFFFF) , по крайней мере, некоторые этот модуль относили уже к ядру, хотя я это считал ошибкой. kernel32 был не больше чем посредником, коий на нт сейчас - ntdll, к которому обращается и kernel32, и usser32, и advapi32, но с разницой, гораздо ощутимей.<br><br>Для этого топика, пожалуй, достаточно теории с историей.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=261291&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=13" class="addthx" data-post="261291"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]HiEndsoft[/b]','')">HiEndsoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 237.0 (наставник), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.74'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13651">Участник</a><br><font color=blue>sysenter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 июля 2010 03:44 <br><script type="text/javascript">QU('HiEndsoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HiEndsoft" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
98-я неплохая окошечная оболочка &quot;над железом&quot; когда-то была.
<br><br><font size="1"><i>-----<br>продавец резиновых утёнков</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=261293&amp;user=13651&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=14" class="addthx" data-post="261293"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 июля 2010 08:18 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
Кто это сказал, что sidt не выполняется на НТ? Нормально там всё выполняется, только чо ты с этим адресом будешь делать из ринг3, непонятно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=261295&amp;user=1556&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=15" class="addthx" data-post="261295"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 июля 2010 16:14 &middot; Поправил: 0xy <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
Вы б глянули код, который я просил...<br><br>PS<br>Обратил внимание, что GetProcAddress в 9x не находит ординалы (по крайней мере, ординалы kernel). Так и должно быть?<br><br>PPS<br>Нсчет IDT: это оно?<br><code>800AE000  10 92 28 00 00 8E 00 C0 20 92 28 00 00 8E 00 C0  ’(..Ћ.А ’(..Ћ.А<br>800AE010  5C C6 28 00 00 8E 00 C0 30 92 28 00 00 EE 00 C0  \Ж(..Ћ.А0’(..о.А<br>800AE020  40 92 28 00 00 EE 00 C0 50 92 28 00 00 EE 00 C0  @’(..о.АP’(..о.А<br>800AE030  60 92 28 00 00 8E 00 C0 70 92 28 00 00 8E 00 C0  `’(..Ћ.Аp’(..Ћ.А<br>800AE040  98 92 28 00 00 8E 00 C0 80 92 28 00 00 8E 00 C0  ?’(..Ћ.АЂ’(..Ћ.А<br>800AE050  A0 92 28 00 00 8E 00 C0 B0 92 28 00 00 8E 00 C0   ’(..Ћ.А°’(..Ћ.А<br>800AE060  B8 92 28 00 00 8E 00 C0 C0 92 28 00 00 8E 00 C0  ё’(..Ћ.АА’(..Ћ.А<br>800AE070  C8 92 28 00 00 8E 00 C0 8C 92 28 00 00 8E 00 C0  И’(..Ћ.АЊ’(..Ћ.А<br>800AE080  6A 03 3B 00 00 E7 00 00 A4 C6 28 00 00 8E 00 C0  j;..з..¤Ж(..Ћ.А<br>800AE090  AC C6 28 00 00 8E 00 C0 28 03 3B 00 00 E7 00 00  ¬Ж(..Ћ.А(;..з..<br>800AE0A0  BC C6 28 00 00 8E 00 C0 76 03 3B 00 00 E7 00 00  јЖ(..Ћ.Аv;..з..<br>800AE0B0  CC C6 28 00 00 8E 00 C0 D4 C6 28 00 00 8E 00 C0  МЖ(..Ћ.АФЖ(..Ћ.А<br>800AE0C0  DC C6 28 00 00 8E 00 C0 E4 C6 28 00 00 8E 00 C0  ЬЖ(..Ћ.АдЖ(..Ћ.А<br>800AE0D0  EC C6 28 00 00 8E 00 C0 F4 C6 28 00 00 8E 00 C0  мЖ(..Ћ.АфЖ(..Ћ.А<br>800AE0E0  2C 03 3B 00 00 E7 00 00 04 C7 28 00 00 8E 00 C0  ,;..з..З(..Ћ.А<br>800AE0F0  00 00 A3 00 00 E7 00 00 14 C7 28 00 00 8E 00 C0  ..Ј..з..З(..Ћ.А<br>800AE100  1C C7 28 00 00 8E 00 C0 32 85 6F 01 00 E7 00 00  З(..Ћ.А2…o.з..<br>800AE110  2C C7 28 00 00 8E 00 C0 34 C7 28 00 00 8E 00 C0  ,З(..Ћ.А4З(..Ћ.А<br>800AE120  9A 03 3B 00 00 E7 00 00 B2 03 3B 00 00 E7 00 00  љ;..з..І;..з..<br>800AE130  B4 03 3B 00 00 E7 00 00 54 C7 28 00 00 8E 00 C0  ґ;..з..TЗ(..Ћ.А<br>800AE140  5C C7 28 00 00 8E 00 C0 64 C7 28 00 00 8E 00 C0  \З(..Ћ.АdЗ(..Ћ.А<br>800AE150  6C C7 28 00 00 8E 00 C0 74 C7 28 00 00 8E 00 C0  lЗ(..Ћ.АtЗ(..Ћ.А<br>800AE160  7C C7 28 00 00 8E 00 C0 84 C7 28 00 00 8E 00 C0  |З(..Ћ.А„З(..Ћ.А<br>800AE170  8C C7 28 00 00 8E 00 C0 55 C0 47 03 00 E7 00 00  ЊЗ(..Ћ.АUАG.з..<br>800AE180  5C 9C 28 00 00 EE 00 C0 31 89 6F 01 00 E7 00 00  \њ(..о.А1‰o.з..<br>800AE190  AC C7 28 00 00 8E 00 C0 78 03 3B 00 00 E7 00 00  ¬З(..Ћ.Аx;..з..<br>800AE1A0  D5 08 F7 2D 00 E7 00 00 D5 08 F7 2D 00 E7 00 00  Хч-.з..Хч-.з..<br>800AE1B0  D5 08 F7 2D 00 E7 00 00 D5 08 F7 2D 00 E7 00 00  Хч-.з..Хч-.з..<br>800AE1C0  D5 08 F7 2D 00 E7 00 00 D5 08 F7 2D 00 E7 00 00  Хч-.з..Хч-.з..<br>800AE1D0  D5 08 F7 2D 00 E7 00 00 D5 08 F7 2D 00 E7 00 00  Хч-.з..Хч-.з..<br>800AE1E0  41 08 F7 2D 00 E7 00 00 6E 08 F7 2D 00 E7 00 00  Aч-.з..nч-.з..<br>800AE1F0  68 93 6F 01 00 E7 00 00 14 C8 28 00 00 EE 00 C0  h“o.з..И(..о.А<br>800AE200  1C C8 28 00 00 8E 00 C0 24 C8 28 00 00 8E 00 C0  И(..Ћ.А&#036;И(..Ћ.А<br>800AE210  2C C8 28 00 00 EE 00 C0 34 C8 28 00 00 8E 00 C0  ,И(..о.А4И(..Ћ.А<br>800AE220  3C C8 28 00 00 8E 00 C0 44 C8 28 00 00 8E 00 C0  &lt;И(..Ћ.АDИ(..Ћ.А<br>800AE230  4C C8 28 00 00 8E 00 C0 54 C8 28 00 00 8E 00 C0  LИ(..Ћ.АTИ(..Ћ.А<br>800AE240  5C C8 28 00 00 8E 00 C0 64 C8 28 00 00 8E 00 C0  \И(..Ћ.АdИ(..Ћ.А<br>800AE250  6C C8 28 00 00 8E 00 C0 74 C8 28 00 00 8E 00 C0  lИ(..Ћ.АtИ(..Ћ.А<br>800AE260  B0 07 E8 00 00 8E 00 FF 84 C8 28 00 00 8E 00 C0  °и..Ћ.я„И(..Ћ.А<br>800AE270  50 0E E8 00 00 8E 00 FF 30 0E E8 00 00 8E 00 FF  Pи..Ћ.я0и..Ћ.я<br>800AE280  C0 8F 28 00 00 8E 00 C0 D0 8F 28 00 00 8E 00 C0  АЏ(..Ћ.АРЏ(..Ћ.А<br>800AE290  E0 8F 28 00 00 8E 00 C0 F0 8F 28 00 00 8E 00 C0  аЏ(..Ћ.АрЏ(..Ћ.А<br>800AE2A0  00 90 28 00 00 8E 00 C0 10 90 28 00 00 8E 00 C0  .ђ(..Ћ.Ађ(..Ћ.А<br>800AE2B0  20 90 28 00 00 8E 00 C0 30 90 28 00 00 8E 00 C0   ђ(..Ћ.А0ђ(..Ћ.А<br>800AE2C0  40 90 28 00 00 8E 00 C0 50 90 28 00 00 8E 00 C0  @ђ(..Ћ.АPђ(..Ћ.А<br>800AE2D0  60 90 28 00 00 8E 00 C0 70 90 28 00 00 8E 00 C0  `ђ(..Ћ.Аpђ(..Ћ.А<br>800AE2E0  80 90 28 00 00 8E 00 C0 90 90 28 00 00 8E 00 C0  Ђђ(..Ћ.Ађђ(..Ћ.А<br>800AE2F0  A0 90 28 00 00 8E 00 C0 B0 90 28 00 00 8E 00 C0   ђ(..Ћ.А°ђ(..Ћ.А<br>800AE300  2E 93 00 00 6F 01 FF FC BA 0A 00 00 6F 01 FF FC  .“..oяьє...oяь<br>800AE310  50 93 00 00 6F 01 FF FC C4 0A 00 00 6F 01 FF FC  P“..oяьД...oяь<br>800AE320  56 93 00 00 6F 01 FF FC 0A 00 00 00 3B 00 FF FC  V“..oяь....;.яь<br>800AE330  5C 93 00 00 6F 01 FF FC 62 93 00 00 6F 01 FF FC  \“..oяьb“..oяь<br>800AE340  10 00 00 00 3B 00 FF FC 44 00 00 00 7F 02 FF FC  ...;.яьD...яь<br>800AE350  14 00 00 00 3B 00 FF FC 16 00 00 00 3B 00 FF FC  ...;.яь...;.яь<br>800AE360  18 00 00 00 3B 00 FF FC 1A 00 00 00 3B 00 FF FC  ...;.яь...;.яь<br>800AE370  1C 00 00 00 3B 00 FF FC 1E 00 00 00 3B 00 FF FC  ...;.яь...;.яь<br>800AE380  6A 03 00 00 3B 00 FF FE 22 00 00 00 3B 00 FF FE  j..;.яю&quot;...;.яю<br>800AE390  24 00 00 00 3B 00 FF FE 28 03 00 00 3B 00 FF FE  &#036;...;.яю(..;.яю<br>800AE3A0  28 00 00 00 3B 00 FF FE 76 03 00 00 3B 00 FF FE  (...;.яюv..;.яю<br>800AE3B0  2C 00 00 00 3B 00 FF FE 2E 00 00 00 3B 00 FF FE  ,...;.яю....;.яю<br>800AE3C0  30 00 00 00 3B 00 FF FE 32 00 00 00 3B 00 FF FE  0...;.яю2...;.яю<br>800AE3D0  34 00 00 00 3B 00 FF FE 36 00 00 00 3B 00 FF FE  4...;.яю6...;.яю<br>800AE3E0  2C 03 00 00 3B 00 FF FE 3A 00 00 00 3B 00 FF FE  ,..;.яю:...;.яю<br>800AE3F0  00 00 00 00 A3 00 FF FE 3E 00 00 00 3B 00 FF FE  ....Ј.яю&gt;...;.яю<br>800AE400  40 00 00 00 3B 00 FF FE 32 85 00 00 6F 01 FF FE  @...;.яю2…..oяю<br>800AE410  44 00 00 00 3B 00 FF FE 46 00 00 00 3B 00 FF FE  D...;.яюF...;.яю<br>800AE420  9A 03 00 00 3B 00 FF FE B2 03 00 00 3B 00 FF FE  љ..;.яюІ..;.яю<br>800AE430  B4 03 00 00 3B 00 FF FE 4E 00 00 00 3B 00 FF FE  ґ..;.яюN...;.яю<br>800AE440  50 00 00 00 3B 00 FF FE 52 00 00 00 3B 00 FF FE  P...;.яюR...;.яю<br>800AE450  54 00 00 00 3B 00 FF FE 56 00 00 00 3B 00 FF FE  T...;.яюV...;.яю<br>800AE460  58 00 00 00 3B 00 FF FE 5A 00 00 00 3B 00 FF FE  X...;.яюZ...;.яю<br>800AE470  1C 02 00 00 3B 00 FF FE 55 C0 00 00 47 03 FF FE  ..;.яюUА..Gяю<br>800AE480  60 00 00 00 3B 00 FF FE 31 89 00 00 6F 01 FF FE  `...;.яю1‰..oяю<br>800AE490  64 00 00 00 3B 00 FF FE 78 03 00 00 3B 00 FF FE  d...;.яюx..;.яю<br>800AE4A0  D5 08 00 00 F7 2D FF FE D5 08 00 00 F7 2D FF FE  Х..ч-яюХ..ч-яю<br>800AE4B0  D5 08 00 00 F7 2D FF FE D5 08 00 00 F7 2D FF FE  Х..ч-яюХ..ч-яю<br>800AE4C0  D5 08 00 00 F7 2D FF FE D5 08 00 00 F7 2D FF FE  Х..ч-яюХ..ч-яю<br>800AE4D0  D5 08 00 00 F7 2D FF FE D5 08 00 00 F7 2D FF FE  Х..ч-яюХ..ч-яю<br>800AE4E0  41 08 00 00 F7 2D FF FE 6E 08 00 00 F7 2D FF FE  A..ч-яюn..ч-яю<br>800AE4F0  68 93 00 00 6F 01 FF FE 7E 00 00 00 3B 00 FF FE  h“..oяю~...;.яю<br>800AE500  80 00 00 00 3B 00 FF FE 1A 02 00 00 3B 00 FF FE  Ђ...;.яю..;.яю<br>800AE510  84 00 00 00 3B 00 FF FE 86 00 00 00 3B 00 FF FE  „...;.яю†...;.яю<br>800AE520  88 00 00 00 3B 00 FF FE 8A 00 00 00 3B 00 FF FE  €...;.яюЉ...;.яю<br>800AE530  1A 02 00 00 3B 00 FF FE 8E 00 00 00 3B 00 FF FE  ..;.яюЋ...;.яю<br>800AE540  90 00 00 00 3B 00 FF FE 92 00 00 00 3B 00 FF FE  ђ...;.яю’...;.яю<br>800AE550  94 00 00 00 3B 00 FF FE 38 03 00 00 3B 00 FF FE  ”...;.яю8..;.яю<br>800AE560  98 00 00 00 3B 00 FF FE 9A 00 00 00 3B 00 FF FE  ?...;.яюљ...;.яю<br>800AE570  9C 00 00 00 3B 00 FF FE 9E 00 00 00 3B 00 FF FE  њ...;.яюћ...;.яю<br>800AE580  A0 00 00 00 3B 00 FF FE A2 00 00 00 3B 00 FF FE   ...;.яюў...;.яю<br>800AE590  A4 00 00 00 3B 00 FF FE A6 00 00 00 3B 00 FF FE  ¤...;.яю¦...;.яю<br>800AE5A0  A8 00 00 00 3B 00 FF FE AA 00 00 00 3B 00 FF FE  Ё...;.яюЄ...;.яю<br>800AE5B0  AC 00 00 00 3B 00 FF FE AE 00 00 00 3B 00 FF FE  ¬...;.яю®...;.яю<br>800AE5C0  B0 00 00 00 3B 00 FF FE B2 00 00 00 3B 00 FF FE  °...;.яюІ...;.яю<br>800AE5D0  B4 00 00 00 3B 00 FF FE B6 00 00 00 3B 00 FF FE  ґ...;.яю¶...;.яю<br>800AE5E0  B8 00 00 00 3B 00 FF FE BA 00 00 00 3B 00 FF FE  ё...;.яює...;.яю<br>800AE5F0  BC 00 00 00 3B 00 FF FE BE 00 00 00 3B 00 FF FE  ј...;.яюѕ...;.яю<br>800AE600  C0 00 00 00 3B 00 FF FE C2 00 00 00 3B 00 FF FE  А...;.яюВ...;.яю<br>800AE610  C4 00 00 00 3B 00 FF FE C6 00 00 00 3B 00 FF FE  Д...;.яюЖ...;.яю<br>800AE620  C8 00 00 00 3B 00 FF FE CA 00 00 00 3B 00 FF FE  И...;.яюК...;.яю<br>800AE630  CC 00 00 00 3B 00 FF FE AA 03 00 00 3B 00 FF FE  М...;.яюЄ..;.яю<br>800AE640  D0 00 00 00 3B 00 FF FE D2 00 00 00 3B 00 FF FE  Р...;.яюТ...;.яю<br>800AE650  D4 00 00 00 3B 00 FF FE D6 00 00 00 3B 00 FF FE  Ф...;.яюЦ...;.яю<br>800AE660  D8 00 00 00 3B 00 FF FE DA 00 00 00 3B 00 FF FE  Ш...;.яюЪ...;.яю<br>800AE670  DC 00 00 00 3B 00 FF FE DE 00 00 00 3B 00 FF FE  Ь...;.яюЮ...;.яю<br>800AE680  E0 00 00 00 3B 00 FF FC E2 00 00 00 3B 00 FF FC  а...;.яьв...;.яь<br>800AE690  E4 00 00 00 3B 00 FF FC E6 00 00 00 3B 00 FF FC  д...;.яьж...;.яь<br>800AE6A0  E8 00 00 00 3B 00 FF FC 6E 93 00 00 6F 01 FF FC  и...;.яьn“..oяь<br>800AE6B0  EC 00 00 00 3B 00 FF FC EE 00 00 00 3B 00 FF FC  м...;.яьо...;.яь<br>800AE6C0  F0 00 00 00 3B 00 FF FE F2 00 00 00 3B 00 FF FE  р...;.яют...;.яю<br>800AE6D0  F4 00 00 00 3B 00 FF FE F6 00 00 00 3B 00 FF FE  ф...;.яюц...;.яю<br>800AE6E0  F8 00 00 00 3B 00 FF FE FA 00 00 00 3B 00 FF FE  ш...;.яюъ...;.яю<br>800AE6F0  FC 00 00 00 3B 00 FF FE FE 00 00 00 3B 00 FF FE  ь...;.яюю...;.яю<br>800AE700  00 01 00 00 3B 00 FF FE 02 01 00 00 3B 00 FF FE  ...;.яю..;.яю<br>800AE710  04 01 00 00 3B 00 FF FE 06 01 00 00 3B 00 FF FE  ..;.яю..;.яю<br>800AE720  08 01 00 00 3B 00 FF FE 0A 01 00 00 3B 00 FF FE  ..;.яю...;.яю<br>800AE730  0C 01 00 00 3B 00 FF FE 0E 01 00 00 3B 00 FF FE  ...;.яю..;.яю<br>800AE740  10 01 00 00 3B 00 FF FE 12 01 00 00 3B 00 FF FE  ..;.яю..;.яю<br>800AE750  14 01 00 00 3B 00 FF FE 16 01 00 00 3B 00 FF FE  ..;.яю..;.яю<br>800AE760  18 01 00 00 3B 00 FF FE 1A 01 00 00 3B 00 FF FE  ..;.яю..;.яю<br>800AE770  1C 01 00 00 3B 00 FF FE 1E 01 00 00 3B 00 FF FE  ..;.яю..;.яю<br>800AE780  20 01 00 00 3B 00 FF FE 22 01 00 00 3B 00 FF FE   ..;.яю&quot;..;.яю<br>800AE790  24 01 00 00 3B 00 FF FE 26 01 00 00 3B 00 FF FE  &#036;..;.яю&amp;..;.яю<br>800AE7A0  28 01 00 00 3B 00 FF FE 2A 01 00 00 3B 00 FF FE  (..;.яю*..;.яю<br>800AE7B0  2C 01 00 00 3B 00 FF FE 2E 01 00 00 3B 00 FF FE  ,..;.яю...;.яю<br>800AE7C0  30 01 00 00 3B 00 FF FE 32 01 00 00 3B 00 FF FE  0..;.яю2..;.яю<br>800AE7D0  34 01 00 00 3B 00 FF FE 36 01 00 00 3B 00 FF FE  4..;.яю6..;.яю<br>800AE7E0  38 01 00 00 3B 00 FF FE 3A 01 00 00 3B 00 FF FE  8..;.яю:..;.яю<br>800AE7F0  3C 01 00 00 3B 00 FF FE 3E 01 00 00 3B 00 FF FE  &lt;..;.яю&gt;..;.яю<br>800AE800  40 01 00 00 3B 00 FF FE 42 01 00 00 3B 00 FF FE  @..;.яюB..;.яю<br>800AE810  44 01 00 00 3B 00 FF FE 46 01 00 00 3B 00 FF FE  D..;.яюF..;.яю<br>800AE820  48 01 00 00 3B 00 FF FE 4A 01 00 00 3B 00 FF FE  H..;.яюJ..;.яю<br></code>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=261316&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=16" class="addthx" data-post="261316"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 июля 2010 16:34 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
<code>800AE830  4C 01 00 00 3B 00 FF FE 4E 01 00 00 3B 00 FF FE  L..;.яюN..;.яю<br>800AE840  50 01 00 00 3B 00 FF FE 52 01 00 00 3B 00 FF FE  P..;.яюR..;.яю<br>800AE850  54 01 00 00 3B 00 FF FE 56 01 00 00 3B 00 FF FE  T..;.яюV..;.яю<br>800AE860  58 01 00 00 3B 00 FF FE 5A 01 00 00 3B 00 FF FE  X..;.яюZ..;.яю<br>800AE870  5C 01 00 00 3B 00 FF FE 5E 01 00 00 3B 00 FF FE  \..;.яю^..;.яю<br>800AE880  60 01 00 00 3B 00 FF FE 62 01 00 00 3B 00 FF FE  `..;.яюb..;.яю<br>800AE890  64 01 00 00 3B 00 FF FE 66 01 00 00 3B 00 FF FE  d..;.яюf..;.яю<br>800AE8A0  68 01 00 00 3B 00 FF FE 6A 01 00 00 3B 00 FF FE  h..;.яюj..;.яю<br>800AE8B0  6C 01 00 00 3B 00 FF FE 6E 01 00 00 3B 00 FF FE  l..;.яюn..;.яю<br>800AE8C0  70 01 00 00 3B 00 FF FE 72 01 00 00 3B 00 FF FE  p..;.яюr..;.яю<br>800AE8D0  74 01 00 00 3B 00 FF FE 76 01 00 00 3B 00 FF FE  t..;.яюv..;.яю<br>800AE8E0  78 01 00 00 3B 00 FF FE 7A 01 00 00 3B 00 FF FE  x..;.яюz..;.яю<br>800AE8F0  7C 01 00 00 3B 00 FF FE 7E 01 00 00 3B 00 FF FE  |..;.яю~..;.яю<br>800AE900  80 01 00 00 3B 00 FF FE 82 01 00 00 3B 00 FF FE  Ђ..;.яю‚..;.яю<br>800AE910  84 01 00 00 3B 00 FF FE 86 01 00 00 3B 00 FF FE  „..;.яю†..;.яю<br>800AE920  88 01 00 00 3B 00 FF FE 8A 01 00 00 3B 00 FF FE  €..;.яюЉ..;.яю<br>800AE930  8C 01 00 00 3B 00 FF FE 8E 01 00 00 3B 00 FF FE  Њ..;.яюЋ..;.яю<br>800AE940  90 01 00 00 3B 00 FF FE 92 01 00 00 3B 00 FF FE  ђ..;.яю’..;.яю<br>800AE950  94 01 00 00 3B 00 FF FE 96 01 00 00 3B 00 FF FE  ”..;.яю–..;.яю<br>800AE960  98 01 00 00 3B 00 FF FE 9A 01 00 00 3B 00 FF FE  ?..;.яюљ..;.яю<br>800AE970  9C 01 00 00 3B 00 FF FE 9E 01 00 00 3B 00 FF FE  њ..;.яюћ..;.яю<br>800AE980  A0 01 00 00 3B 00 FF FE A2 01 00 00 3B 00 FF FE   ..;.яюў..;.яю<br>800AE990  A4 01 00 00 3B 00 FF FE A6 01 00 00 3B 00 FF FE  ¤..;.яю¦..;.яю<br>800AE9A0  A8 01 00 00 3B 00 FF FE AA 01 00 00 3B 00 FF FE  Ё..;.яюЄ..;.яю<br>800AE9B0  AC 01 00 00 3B 00 FF FE AE 01 00 00 3B 00 FF FE  ¬..;.яю®..;.яю<br>800AE9C0  B0 01 00 00 3B 00 FF FE B2 01 00 00 3B 00 FF FE  °..;.яюІ..;.яю<br>800AE9D0  B4 01 00 00 3B 00 FF FE B6 01 00 00 3B 00 FF FE  ґ..;.яю¶..;.яю<br>800AE9E0  B8 01 00 00 3B 00 FF FE BA 01 00 00 3B 00 FF FE  ё..;.яює..;.яю<br>800AE9F0  BC 01 00 00 3B 00 FF FE BE 01 00 00 3B 00 FF FE  ј..;.яюѕ..;.яю<br>800AEA00  C0 01 00 00 3B 00 FF FE C2 01 00 00 3B 00 FF FE  А..;.яюВ..;.яю<br>800AEA10  C4 01 00 00 3B 00 FF FE C6 01 00 00 3B 00 FF FE  Д..;.яюЖ..;.яю<br>800AEA20  C8 01 00 00 3B 00 FF FE CA 01 00 00 3B 00 FF FE  И..;.яюК..;.яю<br>800AEA30  CC 01 00 00 3B 00 FF FE CE 01 00 00 3B 00 FF FE  М..;.яюО..;.яю<br>800AEA40  D0 01 00 00 3B 00 FF FE D2 01 00 00 3B 00 FF FE  Р..;.яюТ..;.яю<br>800AEA50  D4 01 00 00 3B 00 FF FE D6 01 00 00 3B 00 FF FE  Ф..;.яюЦ..;.яю<br>800AEA60  D8 01 00 00 3B 00 FF FE DA 01 00 00 3B 00 FF FE  Ш..;.яюЪ..;.яю<br>800AEA70  DC 01 00 00 3B 00 FF FE DE 01 00 00 3B 00 FF FE  Ь..;.яюЮ..;.яю<br>800AEA80  E0 01 00 00 3B 00 FF FE E2 01 00 00 3B 00 FF FE  а..;.яюв..;.яю<br>800AEA90  E4 01 00 00 3B 00 FF FE E6 01 00 00 3B 00 FF FE  д..;.яюж..;.яю<br>800AEAA0  E8 01 00 00 3B 00 FF FE EA 01 00 00 3B 00 FF FE  и..;.яюк..;.яю<br>800AEAB0  EC 01 00 00 3B 00 FF FE EE 01 00 00 3B 00 FF FE  м..;.яюо..;.яю<br>800AEAC0  F0 01 00 00 3B 00 FF FE F2 01 00 00 3B 00 FF FE  р..;.яют..;.яю<br>800AEAD0  F4 01 00 00 3B 00 FF FE F6 01 00 00 3B 00 FF FE  ф..;.яюц..;.яю<br>800AEAE0  F8 01 00 00 3B 00 FF FE FA 01 00 00 3B 00 FF FE  ш..;.яюъ..;.яю<br>800AEAF0  FC 01 00 00 3B 00 FF FE FE 01 00 00 3B 00 FF FE  ь..;.яюю..;.яю<br>800AEB00  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................<br>800AEB10  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................<br></code>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=261320&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=17" class="addthx" data-post="261320"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июля 2010 08:41 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
<b>Кто это сказал, что sidt не выполняется на НТ?</b><br><br>Я имел ввиду это <b>только чо ты с этим адресом будешь делать из ринг3</b>. Хотя можно физическую память открыть...<br><br>Прошу прощения за неточность, только не бейте :D<br><br><b>0xy</b><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">800AE000</span>&nbsp;<span class="hl_number">10</span>&nbsp;<span class="hl_number">92</span>&nbsp;<span class="hl_number">28</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">8E</span>&nbsp;<span class="hl_number">00</span>&nbsp;C0&nbsp;<span class="hl_number">20</span>&nbsp;<span class="hl_number">92</span>&nbsp;<span class="hl_number">28</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">8E</span>&nbsp;<span class="hl_number">00</span>&nbsp;C0&nbsp;</li><li class="hl_l1"><span class="hl_number">800AE010</span>&nbsp;<span class="hl_number">5C</span>&nbsp;C6&nbsp;<span class="hl_number">28</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">8E</span>&nbsp;<span class="hl_number">00</span>&nbsp;C0&nbsp;<span class="hl_number">30</span>&nbsp;<span class="hl_number">92</span>&nbsp;<span class="hl_number">28</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;EE&nbsp;<span class="hl_number">00</span>&nbsp;C0</li>        </ol>
    </div>
</div></div>
<br><br>отсюда int1 - 0028:C0009220. int3 - 0028:C0009230<br><br>Судя по промежуткам между адресами обработчиков, там должны быть джампы, выровнены по 16 бит...<br><br>Код аналогичный, только в ntdll:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C903282</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExecuteHandler2@20&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;<span class="hl_comment">; CODE XREF: .text:7C903275p</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C903282</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C903282</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_0<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">8</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C903282</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_4<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">0Ch</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C903282</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_8<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">10h</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C903282</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_C<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">14h</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C903282</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_10<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">18h</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C903282</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C903282</span>&nbsp;<span class="hl_number">000</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C903283</span>&nbsp;<span class="hl_number">004</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C903285</span>&nbsp;<span class="hl_number">004</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_4<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C903288</span>&nbsp;<span class="hl_number">008</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C903289</span>&nbsp;<span class="hl_number">00C</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;large&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C903290</span>&nbsp;<span class="hl_number">010</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;large&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C903297</span>&nbsp;<span class="hl_number">010</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_C<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C90329A</span>&nbsp;<span class="hl_number">014</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_8<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C90329D</span>&nbsp;<span class="hl_number">018</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_4<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C9032A0</span>&nbsp;<span class="hl_number">01C</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_0<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C9032A3</span>&nbsp;<span class="hl_number">020</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_10<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C9032A6</span>&nbsp;<span class="hl_number">020</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C9032A8</span>&nbsp;<span class="hl_number">008</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;large&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C9032AF</span>&nbsp;<span class="hl_number">008</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;large&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C9032B6</span>&nbsp;<span class="hl_number">004</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C9032B8</span>&nbsp;<span class="hl_number">004</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C9032B9</span>&nbsp;<span class="hl_number">000</span>&nbsp;<span class="hl_function"><b>retn</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">14h</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">7C9032B9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExecuteHandler2@20&nbsp;<span class="hl_function">endp</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=261329&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=18" class="addthx" data-post="261329"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июля 2010 10:53 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
<b>DenCoder</b><br>&gt; только чо ты с этим адресом будешь делать из ринг3.<br>На сколько помню в 9x доступ к IDT открыт из U-mode, впрочем разницы нет если не малварь пишите. Из ядра всё доступно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=261331&amp;user=17964&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=19" class="addthx" data-post="261331"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июля 2010 18:44 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
<b>DenCoder</b><br>Из какой конкертно винды этот код? И есть ли возможность посмотреть в других версиях NT (желательно в 4-й и 7-й)?<br><br>PS<br>А отличия таки есть: call [ebp+18]-&gt;mov ecx,[ebp+18]; call ecx : <img src="img/smilies/s4.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=261347&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=20" class="addthx" data-post="261347"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июля 2010 19:15 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
XP SP3 с патчами. Сам вызов сех-хэндлера несущественно отличается на всех платформах. А вот проверок перед этим больше, чем в 98...<br><br><b>0xy пишет:<br>А отличия таки есть: call [ebp+18]-&gt;mov ecx,[ebp+18]; call ecx</b><br>Вот еще на такие мелочи внимание обращать... А в ExecuteHandler2 попадаем из почти аналогичной ExecuteHandler, ну и что теперь?
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=261348&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=21" class="addthx" data-post="261348"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июля 2010 19:23 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
<b>0xy</b><br>Что вы делаете не понятно. Причём здесь дескрипторные таблицы, ядро и пр. <img src="img/smilies/s11.gif" alt=""><br>Вам нужно прогрузить в контексте целевого потока отладочные регистры. Это можно сделать вручную(NtSetContextThread, loc. NtContinue), либо через механизм исключений(он локальный).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=261349&amp;user=17964&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=22" class="addthx" data-post="261349"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июля 2010 21:56 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
<b>Clerk</b>, NtSetContextThread там нет, есть KERNEL32_9 с функцией 0x2A0015 (на VxDCall похоже).<br><br>О некоторых целях тс вроже было уже в 1-ой части: <a href="http://www.exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#14" target="_new">http://www.exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#14</a><br><br>Только вот почему не получилось подсунуть свой обработчик?... И что в результате должно получиться? А то такой дискуссией к концу года всю винду переберем <img src="img/smilies/s5.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=261352&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=23" class="addthx" data-post="261352"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июля 2010 23:50 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#24');return false;">#24</a> </span><div align=left><br>
<I>Причём здесь дескрипторные таблицы, ядро и пр</I><br>Пока ни причем, ибо я пошел путем перехвата Call SEH. Но инфа полезная.<br><br><I>Только вот почему не получилось подсунуть свой обработчик?</I><br>Да уже получилось. Оказалось, что глобальный регион &quot;без капризов&quot; успешно создает VirtualAlloc <img src="img/smilies/s1.gif" alt=""><br><br><b>DenCoder</b><br><I>есть KERNEL32_9 с функцией 0x2A0015 </I><br>Шаман! <img src="img/smilies/s1.gif" alt=""> Можешь подкинуть чуток курева на тему функций #9?<br>PS<br>Походу вопрос. Это нормально, что его (#9) не находит GetProcAddress?<br><br><I>Вот еще на такие мелочи внимание обращать...А в ExecuteHandler2 попадаем из почти аналогичной ExecuteHandler, ну и что теперь? </I> <br>Мне все равно, откуда попадаем. Важно лишь знать комманды процедуры &quot;Call SEH&quot;, которые затрет мой джамп, дабы не перерезать комманду пополам.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=261355&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=24" class="addthx" data-post="261355"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июля 2010 00:04 <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#25');return false;">#25</a> </span><div align=left><br>
<b>0xy</b><br>www.exelab.ru/f/action=vthread&amp;forum=6&amp;topic=13920
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=261356&amp;user=2777&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=25" class="addthx" data-post="261356"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июля 2010 06:44 &middot; Поправил: Clerk <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#26');return false;">#26</a> </span><div align=left><br>
<b>DenCoder</b><br>Ну апи соответствующая должна быть.<br>&gt; Важно лишь знать комманды процедуры &quot;Call SEH&quot;<br>Дизасм длин используйте. Вобще почему не поставите нормальную ось с NT ядром ?<br>-<br>Кстате я так понимаю что пользовательские отладчики в 9x не работают ?<br>Если поставить брейк в одном процессе на kernel32, то остальные отвалятся с #BP ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=261361&amp;user=17964&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=26" class="addthx" data-post="261361"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июля 2010 12:10 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#27');return false;">#27</a> </span><div align=left><br>
<b>Clerk<br>Если поставить брейк в одном процессе на kernel32, то остальные отвалятся с #BP ?</b><br>Нет, остальные не отвалятся. Я помню, что не во всей kernel32, но в какой-то части бряки вообще в ней не работают.<br><br><b>0xy<br>Можешь подкинуть чуток курева на тему функций #9?</b><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;Для&nbsp;SetThreadContext</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF85236&nbsp;<span class="hl_number">010</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_4<span class="hl_char">]</span>&nbsp;<span class="hl_char">-</span>&nbsp;указатель&nbsp;на&nbsp;CONTEXT</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF85239&nbsp;<span class="hl_number">014</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>ecx</b></span>&nbsp;<span class="hl_char">-</span>&nbsp;преобразованный&nbsp;дескриптор&nbsp;потока&nbsp;<span class="hl_char">(</span>в&nbsp;алгоритме&nbsp;ну&nbsp;ногу&nbsp;сломишь<span class="hl_char">)</span></li><li class="hl_l1">хендл&nbsp;ринг3&nbsp;преобразуется&nbsp;&nbsp;в&nbsp;хендл&nbsp;ринг0<span class="hl_char">,</span>&nbsp;похоже</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF8523A&nbsp;<span class="hl_number">018</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">2A0015h</span>&nbsp;<span class="hl_char">-</span>&nbsp;функция&nbsp;ядра<span class="hl_char">,</span>&nbsp;<span class="hl_number">2A</span>&nbsp;<span class="hl_char">-</span>&nbsp;какой<span class="hl_char">-</span>то&nbsp;VxD<span class="hl_char">-</span>модуль<span class="hl_char">,</span>&nbsp;<span class="hl_number">15</span>&nbsp;<span class="hl_char">-</span>&nbsp;функция</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>BFF8523F&nbsp;<span class="hl_number">01C</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;KERNEL32_9</li>        </ol>
    </div>
</div></div>
<br><br>KERNEL32_1...KERNEL32_9 имеют один и тот же адрес, и передают управление через<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;fword&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">cs</span><span class="hl_char">:</span>byte_BFFBB734</li>        </ol>
    </div>
</div></div>
<br>4 байта адрес, 2 байта селектор. В eax - номер функции, аналогично как в ntdll. Интересовался давно, что там за адрес, запомнил только, что по нему int 30h. Дальше исследования ядра win98 поставили меня тогда в тупик, потому как не дошел до места передачи управления в другой VxD, наверное слишком увлекся другими ветками кодами с вводом/выводом.<br><br>2A001Dh - как ядровый RtlEnterCriticalSection<br>2A001Ch - как ядровый RtlLeaveCriticalSection<br>только не уверен... может еще переключение режимов...<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Walking&nbsp;VxD&nbsp;chain&nbsp;shows&nbsp;that&nbsp;these&nbsp;are&nbsp;the&nbsp;VxDs&nbsp;that&nbsp;provide</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Win32&nbsp;services</li><li class="hl_l0"><span style="word-break: break-all">#define&nbsp;VMM_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x0001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">41</span>&nbsp;services</li><li class="hl_l1"><span style="word-break: break-all">#define&nbsp;REBOOT_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x0009&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">2</span></li><li class="hl_l0"><span style="word-break: break-all">#define&nbsp;VNETBIOS_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x0014&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">2</span></li><li class="hl_l1"><span style="word-break: break-all">#define&nbsp;VWIN32_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x002A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">79</span></li><li class="hl_l0"><span style="word-break: break-all">#define&nbsp;VCOMM_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x002B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">27</span></li><li class="hl_l1"><span style="word-break: break-all">#define&nbsp;VCOND_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x0038&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">53</span>&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;Virtual&nbsp;CON&nbsp;<span class="hl_char">(</span>Console<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;two&nbsp;important&nbsp;VWIN32&nbsp;services</li><li class="hl_l0">#define&nbsp;VWIN32_INT21_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x2A0010</li><li class="hl_l1">#define&nbsp;VWIN32_INT31_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x2A0029</li><li class="hl_l0">#define&nbsp;DosCall<span class="hl_char">(</span><span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">VxDCall</span><span class="hl_char">(</span>VWIN32_INT21_CALL<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_registr">eax</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_registr">ecx</span><span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">#define&nbsp;DPMICall<span class="hl_char">(</span><span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">VxDCall</span><span class="hl_char">(</span>VWIN32_INT31_CALL<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_registr">eax</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_registr">ecx</span><span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;found&nbsp;these&nbsp;by&nbsp;examining&nbsp;ADVAPI32<span class="hl_char">.</span>DLL&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;REGSERV<span class="hl_char">.</span>EXE</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;REGSERV<span class="hl_char">.</span>EXE&nbsp;calls&nbsp;these&nbsp;directly&nbsp;for&nbsp;remote&nbsp;registry&nbsp;services</li><li class="hl_l1"><span style="word-break: break-all">#define&nbsp;RegOpenKeyEx_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x10011</span></li><li class="hl_l0"><span style="word-break: break-all">#define&nbsp;RegCreatKeyA_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x10012</span></li><li class="hl_l1"><span style="word-break: break-all">#define&nbsp;RegCloseKey_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x10013</span></li><li class="hl_l0"><span style="word-break: break-all">#define&nbsp;RegDeleteKey_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x10014</span></li><li class="hl_l1"><span style="word-break: break-all">#define&nbsp;RegSetValueA_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x10015</span></li><li class="hl_l0"><span style="word-break: break-all">#define&nbsp;RegDeleteValueA_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x10016</span></li><li class="hl_l1"><span style="word-break: break-all">#define&nbsp;RegQueryValueA_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x10017</span></li><li class="hl_l0"><span style="word-break: break-all">#define&nbsp;RegEnumKeyA_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x10018</span></li><li class="hl_l1"><span style="word-break: break-all">#define&nbsp;RegQueryValueEx_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x1001A</span></li><li class="hl_l0"><span style="word-break: break-all">#define&nbsp;RegSetValueExA_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x1001B</span></li><li class="hl_l1"><span style="word-break: break-all">#define&nbsp;RegFlushKey_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x1001C</span></li><li class="hl_l0"><span style="word-break: break-all">#define&nbsp;RegLoadKeyA_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x10021</span></li><li class="hl_l1"><span style="word-break: break-all">#define&nbsp;RegUnloadKeyA_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x10022</span></li><li class="hl_l0"><span style="word-break: break-all">#define&nbsp;RegSaveKeyA_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x10023</span></li><li class="hl_l1">#define&nbsp;RegRemapPreDefKey_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x10024</li><li class="hl_l0">#define&nbsp;RegQueryMultipleValuesA_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x10026</li><li class="hl_l1"><span style="word-break: break-all">#define&nbsp;RegReplaceKeyA_CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x10027</span></li>        </ol>
    </div>
</div></div>
<br><br>Вот здесь vx.netlux.org/lib/static/vdat/tumisc71.htm нашел более полнее.<br><br><b>Это нормально, что его (#9) не находит GetProcAddress?</b><br>Неа, ненормально. Должна находиться. Глянул немного GetProcAddress - поиск функи по ординалу там предусмотрен. Надеюсь не строку #9 передаешь? :D
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=261369&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=27" class="addthx" data-post="261369"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июля 2010 21:49 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#28');return false;">#28</a> </span><div align=left><br>
Ида знает все VxDCall&#039;ы, если ввести в ней 0xCD, 0x20, xx xx yy yy (int 20h). int 30h похоже тоже самое, только вызов из юзермода и что за сервис - в eax.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=261386&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=28" class="addthx" data-post="261386"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июля 2010 23:09 &middot; Поправил: 0xy <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#29');return false;">#29</a> </span><div align=left><br>
<b>Clerk</b><br><I>Кстате я так понимаю что пользовательские отладчики в 9x не работают ?</I><br>Работают, но с учетом этой оговорки:<br><I>Если поставить брейк в одном процессе на kernel32, то остальные отвалятся с #BP</I><br>Тут часто (но не всегда!) выручают железные бряки.<br><br><b>DenCoder</b><br><I>Я помню, что не во всей kernel32, но в какой-то части бряки вообще в ней не работают.</I><br>Работают везде, но не везде нормально перехватываются отладчиком. <br><br><I>.text:BFF8523A 018 push    2A0015h - функция ядра, 2A - какой-то VxD-модуль, 15 - функция</I><br><b>А существует какой-нить справочник по этим функциям?</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=261388&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=29" class="addthx" data-post="261388"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июля 2010 00:27 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#30');return false;">#30</a> </span><div align=left><br>
<I>Глянул немного GetProcAddress - поиск функи по ординалу там предусмотрен.</I><br>Значит процедура у меня сглючивает. <br><code><br>main  00402674                    PUSH 8                                  [0063FE38]=BFF7B9B7         ESP=0063FE38<br>main  00402676                    PUSH BFF60000                           [0063FE34]=81C70F58         ESP=0063FE34<br>main  0040267B                    CALL GetProcAddress                                                 ESP=0063FE30<br>main  GetProcAddress              PUSH EDI                                [0063FE2C]=BFF7B5B4         ESP=0063FE2C<br>main  BFF66D81                    PUSH 22                                 [0063FE28]=00000197         ESP=0063FE28<br>main  BFF66D83                    SUB EDX,EDX                                                         EDX=00000000<br>main  BFF66D85                    PUSH BFF923B3                           [0063FE24]=00000197         ESP=0063FE24<br>main  BFF66D8A                    PUSH DWORD PTR FS:[EDX]                 [81C71124]=0063FF68         ESP=0063FE20<br>main  BFF66D8D                    MOV FS:[EDX],ESP                        [81C71124]=0063FF68<br>main  BFF66D90                    MOV EDI,SS:[Procname]                   [0063FE38]=00000008         EDI=00000008<br>main  BFF66D94                    CMP EDI,10000<br>main  BFF66D9A                    JB SHORT BFF66DA3<br>main  BFF66DA3                    POP DWORD PTR FS:[EDX]                  [81C71124]=0063FF68         ESP=0063FE24<br>main  BFF66DA6                    ADD ESP,8                                                           ESP=0063FE2C<br>main  BFF66DA9                    POP EDI                                 [0063FE2C]=00000000         ESP=0063FE30, EDI=00000000<br>main  BFF66DAA                    JMP BFF704E4<br>main  BFF704E4                    PUSH EBX                                [0063FE2C]=00000000         ESP=0063FE2C<br>main  BFF704E5                    MOV EAX,DS:[BFFBBCF4]                   [BFFBBCF4]=C002E624         EAX=C002E624<br>main  BFF704EA                    PUSH ESI                                [0063FE28]=00000022         ESP=0063FE28<br>main  BFF704EB                    PUSH EDI                                [0063FE24]=BFF923B3         ESP=0063FE24<br>main  BFF704EC                    XOR ESI,ESI                                                         ESI=00000000<br>main  BFF704EE                    MOV EDI,DS:[EAX]                        [C002E624]=81C70EF8         EDI=81C70EF8<br>main  BFF704F0                    LEA EAX,[EDI+60]                        Address=81C70F58            EAX=81C70F58<br>main  BFF704F3                    PUSH EAX                                [0063FE20]=0063FF68         ESP=0063FE20<br>main  BFF704F4                    CALL #97                                                            ESP=0063FE1C<br>main  #97                         POP ECX                                 [0063FE1C]=BFF704F9         ECX=BFF704F9, ESP=0063FE20<br>main  BFF6418D                    POP EDX                                 [0063FE20]=81C70F58         EDX=81C70F58, ESP=0063FE24<br>main  BFF6418E                    PUSH ECX                                [0063FE20]=81C70F58         ESP=0063FE20<br>main  BFF6418F                    CMP DWORD PTR DS:[BFFBBCFC],1           [BFFBBCFC]=2<br>main  BFF64196                    JL SHORT BFF641AD<br>main  BFF64198                    MOV EAX,DS:[BFFBBCF8]                   [BFFBBCF8]=C002E628         EAX=C002E628<br>main  BFF6419D                    MOV EAX,DS:[EAX]                        [C002E628]=E4906D70         EAX=E4906D70<br><I>      BFF6419F                    INC DWORD [EAX+1C]	                    [E4906D8C]=1</I></code><br>Последний inс ВЫПОЛНЯЕТСЯ (переменная увеличивается), но при этом, видимо, возникает какое-то исключение, и дальнейшая трассировка валит процесс с кодом -1.<br>Возможно, что сбой возникает не здесь, а чуть дальше, но из #97 мы точно не возвращаемся.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=261391&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=30" class="addthx" data-post="261391"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июля 2010 12:24 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=1#31');return false;">#31</a> </span><div align=left><br>
#97 - это вход в какой-то режим. Я думал, что это критическая секция... трассировку лучше продолжить после #98.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=261408&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=1&amp;anchor=31" class="addthx" data-post="261408"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=16399&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=16399&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=6&amp;topic=16399&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=6&amp;topic=16399&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как поставить железный бряк? (НЕ в Ольге, естесвенно :]</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="16399">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=16399" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
