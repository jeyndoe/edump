<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>RTTI ошибка при инжектировании своего кода. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="При инжектировании своего кода посредством новой dll возникает проблема c RTTI. Исполнение прерывается на определенном адресе, вылетает по RTTI exception. То же самое происходит, если запускать этот ехе в Олли дебагере, даже при">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41144'>Adler</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> RTTI ошибка при инжектировании своего кода.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Dim77[/b]','')">Dim77</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.68'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30627">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2012 11:24 <br><script type="text/javascript">QU('Dim77','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dim77" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
При инжектировании своего кода посредством новой dll  возникает проблема c RTTI. Исполнение прерывается на определенном адресе, вылетает по RTTI exception. То же самое происходит, если запускать этот ехе в  Олли дебагере, даже при отсутствии инжектированного кода. В VS 2010 все запускается нормально (exception все еще возникает, но правильно обрабатывается VS). Как это обойти, ибо в таком варианте программа с инжектированным кодом не работает. Перекомпиляция инжектированной dll с включенной RTTI не помогает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=305921&amp;user=30627&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=1" class="addthx" data-post="305921"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2012 12:01 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Например, взять и разобраться, откуда оно вылетает и почему, не?<br>Или хотя бы выложить хоть что-нибудь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=305923&amp;user=1556&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=2" class="addthx" data-post="305923"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2012 12:09 <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>Dim77</b><br>кг/ам. вариант - привести код инжекта, минимум
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=305924&amp;user=8830&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=3" class="addthx" data-post="305924"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2012 13:19 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>ajax пишет:<br>привести код инжекта, минимум </I><br>нет смысла.  У него там exe файл кидается исключениями, а он еще туда чего-то инжектить пытается. Сначала надо отдельно выяснить чего исключения летят, а потом инжектить.
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=305927&amp;user=10168&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=4" class="addthx" data-post="305927"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Dim77[/b]','')">Dim77</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.68'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30627">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2012 15:29 &middot; Поправил: Dim77 <br><script type="text/javascript">QU('Dim77','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dim77" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Hexxx пишет:<br>нет смысла. У него там exe файл кидается исключениями </I><br><br>Так оно и есть. При инжекте возникает такое же поведение, как при просматривании этого ехе в дебагере. Т.е. исключения не обрабатываются.  <br><br><I>Hexxx пишет:<br>Сначала надо отдельно выяснить чего исключения летят </I> Как это сделать? Я знаю адреса по которым вылетают исключения, по крайней мере в одном случае ругается на RTTI: Access violation - no RTTI data. <br><br>Вот адрес с которого программа соскакивает на exception: <br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">004021E6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;g_aInterfaceText_&nbsp;<span class="hl_comment">; &quot;  Interface text...&quot;</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">004021EB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_61A06F</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">004021F0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_D<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">004021F4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_40221A</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">004021F6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">004021F9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">3Ch</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">004021FC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">004021FE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_61B715</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00402203</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; int</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00402204</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00402206</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_61B65C</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0040220B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Dir</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0040220C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;off_78E954&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; __int16</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00402212</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_61C2EB</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00402217</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_D<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">al</span></li>        </ol>
    </div>
</div></div>
<br><br>Вылетает при вызове sub_61C2EB с аргументами - имя директории и имя файла. Файл - TApp.dbf. Все это происходит при инициализации текста интерфейса. Подобные инициализации для других компонентов типа фонтов например проходят нормально.<br><br>Короче говоря, exception возникает от того, что этот файл не может быть открыт. Это странно, ибо скомпилированная программа прекрасно его открывает. Почему он под Олли не может быть открыт - непонятно. Никаких специальных привилегий на этот файл, Everyone - Full access. Причем другие файлы программа открывает нормально.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=305934&amp;user=30627&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=5" class="addthx" data-post="305934"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2012 22:50 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>Dim77 пишет:<br>Access violation - no RTTI data </I><br>Соответственно в коде экзешника используется dynamic_cast, но в настройках компилятора отключено RTTI. Это ваш бинарь?
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=305970&amp;user=10168&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=6" class="addthx" data-post="305970"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Dim77[/b]','')">Dim77</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.68'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30627">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2012 00:53 <br><script type="text/javascript">QU('Dim77','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dim77" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Нет, оригинальный бинарь не мой. У меня его исходников нет, отсюда необходимость в инжекте. <br><br><I>Hexxx пишет:<br>Соответственно в коде экзешника используется dynamic_cast, но в настройках компилятора отключено RTTI. </I><br>Это не очень понятно. Т.е. про dynamic_cast мне известно, но ехе уже скомпилировано, так что о каких настройках идет речь? Настройках Олли в случае с дебагером - ибо даже дебаг под Олли оригинального экзешника вызывает это исключение?<br><br>Не очень также понятно, как RTTI связан с тем, что исключение вызывается, когда програма не может открыть dbf файл. В dbf забиты ресурсы. <br><br>В таком случае все мои файлы для инжекта тоже должны быть скомпилированы используя RTTI? <br><br>У меня 3 файла для инжекта: ехе - очень простой, вызывающий DetourCreateProcessWithDll.<br>Dll для инжекта. <br>А также detoured.dll <br><br>Первые два я перекомпилил с включенным RTTI - не помогло. <br>Последний - нужно найти исходники и тоже скомпилить, я его подцепил в инете.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=305975&amp;user=30627&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=7" class="addthx" data-post="305975"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2012 20:30 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Dim77 пишет:<br>Нет, оригинальный бинарь не мой </I><br><br>Ну раз так, значит в программе изначально баг. Приложение само кидает исключение и само же его обрабатывает. VS знает что конкретно такие исключения нужно отдать программе на обработку. Olly видимо про это не знает поэтому останавливает работу приложения. Т.е. это вопрос к настройкам Ollydbg. Я без понятия как там это делается, потому что не пользуюсь. В IDA например есть настройки для исключений, можно указать какой код нужно обработать отладчику, а какой отдать приложению. <br><br>Но это только по вопросу &quot;почему в олли не работает&quot;. Про инжектирование нужны подробности как именно оно глючит.
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=306007&amp;user=10168&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=8" class="addthx" data-post="306007"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=30627" title="27-05-2012 17:11, ранг:5.9" target="_blank">Dim77</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Dim77[/b]','')">Dim77</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.68'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30627">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2012 01:05 &middot; Поправил: Dim77 <br><script type="text/javascript">QU('Dim77','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dim77" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>Hexxx пишет:<br> Про инжектирование нужны подробности как именно оно глючит. </I><br>Программа вылетает, при подсоединении дебагера видно, что вылет происходит по адресу: 61B028, т.е. при попытке выйти из очень длинной процедуры инициализации различных параметров программы. Ниже код последних шагов. <br>Вылетает на Leave с ошибкой Unhandled Exception at address 0x0061B028: 0x00000005. Access Violation reading location 0x00000000. <br><br>Регистры:<br>EAX = 00383480 EBX = 00383034 ECX = 0038304D EDX = 00008000 ESI = 0022F844 EDI = 006F3534 EIP = 0061B028 ESP = 0022F838 EBP = 00000000 EFL = 00010246 <br><br>Есть подозрение, что EBP должно содержать адрес вызывающей функции, но это значение почему-то оказывается равным 0. Как понять, что там на самом деле должно быть не очень ясно, разве что VS присоединиться к оригинальному процессу... Но, даже если это будет понятно, важнее понять, почему там этого адреса не оказывается, если вообще мое предположение верно. <br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0061B017</span>&nbsp;loc_61B017<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:0061AFF0j</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0061B017</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">1Ch</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0061B01B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0061B01D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0061B01E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0061B01F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0061B020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;large&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0061B027</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0061B028</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">leave</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0061B029</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>retn</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">4</span></li>        </ol>
    </div>
</div></div>
<br><br>Полный код функции приаттачен.<br><br><img src="img/attach.gif" alt=""> <a href="./files/98dd_26.05.2012_EXELAB.rU.tgz">98dd_26.05.2012_EXELAB.rU.tgz</a> - SubError.txt
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306022&amp;user=30627&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=9" class="addthx" data-post="306022"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2012 01:33 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
сам екзе не хученый работает? значит варианты<br>- в проге защите от дебагера(1%)<br>- кривая хук функция(90%)<br>- хз(9%)<br><br>выкладывай наверное екзе+хук<br>что бы не гадать на ромашках
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306024&amp;user=15381&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=10" class="addthx" data-post="306024"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2012 03:12 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>Dim77 пишет:<br>Есть подозрение, что EBP должно содержать адрес вызывающей функции </I><br><I>Dim77 пишет:<br>.text:0061B028    leave </I><br>Из <b>EBP</b> в <b>ЕSP</b> копирутся то значение которое было до вызова процедуры(выравнивается стек),<br><I>Dim77 пишет:<br>text:0061B01F   pop     ebp </I><br>вот здесь и дёт ошибка,в стеке нарушина последовательность и в <b>EBP</b> ложится хрен знает что,но нето что нужно <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=306025&amp;user=17432&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=11" class="addthx" data-post="306025"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Dim77[/b]','')">Dim77</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.68'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30627">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2012 13:51 &middot; Поправил: Dim77 <br><script type="text/javascript">QU('Dim77','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dim77" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>reversecode пишет:<br>выкладывай наверное екзе+хук<br>что бы не гадать на ромашках  </I><br><br>Выложил: <br><br>1. <noindex><a href="http://www.multiupload.co.uk/5W84OL9A6W" rel="nofollow" target="_blank">--&gt;Оригинальный Ехе + ini &lt;--</a></noindex><br>2. <noindex><a href="http://www.multiupload.co.uk/6X1ZY2PKWP" rel="nofollow" target="_blank">--&gt;Hook - exe (инжектор) + моя dll + detored.dll &lt;--</a></noindex> Эти файлы должны быть там же где и оригинальный ехе<br>3. <noindex><a href="http://www.multiupload.co.uk/Z7K8REGOPJ" rel="nofollow" target="_blank">--&gt; Файлы инициализации &lt;--</a></noindex>Возможно и без них можно дойти до того места, где происходит ошибка...<br><br><I>ClockMan пишет:<br>,в стеке нарушина последовательность и в EBP ложится хрен знает что </I><br>Как это происходит пока не вижу. <br><br>На всякий случай код хука: <br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;noCD2<span class="hl_char">.</span>cpp&nbsp;<span class="hl_char">:</span>&nbsp;Defines&nbsp;the&nbsp;exported&nbsp;functions&nbsp;for&nbsp;the&nbsp;DLL&nbsp;application<span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span></li><li class="hl_l0">#include&nbsp;<span class="hl_quote">&quot;stdafx.h&quot;</span></li><li class="hl_l1">#include&nbsp;<span class="hl_char">&lt;</span>windows<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l0">#include&nbsp;<span class="hl_char">&lt;</span>stdlib<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l1">#include&nbsp;<span class="hl_char">&lt;</span>string<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l0">#include&nbsp;<span class="hl_char">&lt;</span>detours<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">typedef&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;<span class="hl_char">(</span>WINAPI&nbsp;<span class="hl_char">*</span>pFunc<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">HINSTANCE&nbsp;hInstance<span class="hl_comment">;</span></li><li class="hl_l1">#define&nbsp;BUF_LEN&nbsp;<span class="hl_number">128</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">#pragma&nbsp;<span class="hl_function">comment</span><span class="hl_char">(</span>lib<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;detours.lib&quot;</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">extern&nbsp;<span class="hl_quote">&quot;C&quot;</span>&nbsp;__declspec<span class="hl_char">(</span>dllexport<span class="hl_char">)</span>&nbsp;bool&nbsp;proc_51F36F<span class="hl_char">(</span><span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span>Str2<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span>driveletter<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;static&nbsp;<span class="hl_function"><b>CHAR</b></span>&nbsp;FileSystemNameBuffer<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;static&nbsp;<span class="hl_function"><b>CHAR</b></span>&nbsp;Str1<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;static&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;FileSystemFlags<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;static&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;VolumeSerialNumber<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;static&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;MaximumComponentLength<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;static&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;RootPathName<span class="hl_char">[</span><span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;static&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;FileName<span class="hl_char">[</span>MAX_PATH<span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">GetModuleFileNameA<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;FileName<span class="hl_char">,</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>FileName<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">_splitpath<span class="hl_char">(</span>FileName<span class="hl_char">,</span>RootPathName<span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">strcat<span class="hl_char">(</span>RootPathName<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;\&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">*</span>driveletter<span class="hl_char">=</span>RootPathName<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">(</span>GetVolumeInformationA<span class="hl_char">(</span>RootPathName<span class="hl_char">,</span><span class="hl_char">&amp;</span>Str1<span class="hl_char">,</span>BUF_LEN<span class="hl_char">,</span><span class="hl_char">&amp;</span>VolumeSerialNumber<span class="hl_char">,</span><span class="hl_char">&amp;</span>MaximumComponentLength<span class="hl_char">,</span><span class="hl_char">&amp;</span>FileSystemFlags<span class="hl_char">,</span><span class="hl_char">&amp;</span>FileSystemNameBuffer<span class="hl_char">,</span>BUF_LEN<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;LError&nbsp;<span class="hl_char">=</span>&nbsp;GetLastError<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">return&nbsp;<span class="hl_char">(</span><span class="hl_char">*</span>driveletter&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_quote">'\0'</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">pFunc&nbsp;FuncToDetour&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>pFunc<span class="hl_char">)</span><span class="hl_char">(</span>0x0051F36F<span class="hl_char">)</span><span class="hl_comment">; //Set it at address to detour in</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>the&nbsp;process</li><li class="hl_l1"><span class="hl_function"><b>INT</b></span>&nbsp;APIENTRY&nbsp;DllMain<span class="hl_char">(</span>HMODULE&nbsp;hDLL<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;Reason<span class="hl_char">,</span>&nbsp;LPVOID&nbsp;Reserved<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;switch<span class="hl_char">(</span>Reason<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;DLL_PROCESS_ATTACH<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DisableThreadLibraryCalls<span class="hl_char">(</span>hDLL<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DetourTransactionBegin<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DetourUpdateThread<span class="hl_char">(</span>GetCurrentThread<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DetourAttach<span class="hl_char">(</span><span class="hl_char">&amp;</span><span class="hl_char">(</span>PVOID<span class="hl_char">&amp;</span><span class="hl_char">)</span>FuncToDetour<span class="hl_char">,</span>&nbsp;proc_51F36F<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DetourTransactionCommit<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>break</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;DLL_PROCESS_DETACH<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DetourTransactionBegin<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DetourUpdateThread<span class="hl_char">(</span>GetCurrentThread<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DetourDetach<span class="hl_char">(</span><span class="hl_char">&amp;</span><span class="hl_char">(</span>PVOID<span class="hl_char">&amp;</span><span class="hl_char">)</span>FuncToDetour<span class="hl_char">,</span>&nbsp;&nbsp;proc_51F36F<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DetourTransactionCommit<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>break</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;DLL_THREAD_ATTACH<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;DLL_THREAD_DETACH<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>break</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>TRUE</b></span><span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=306040&amp;user=30627&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=12" class="addthx" data-post="306040"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2012 14:11 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
ясное дело<br>в оригинальном exe stdcall конвершинал<br>а в вашей хученой cdecl<br>вот стек и ломается
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306041&amp;user=15381&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=13" class="addthx" data-post="306041"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=30627" title="27-05-2012 12:06, ранг:5.9" target="_blank">Dim77</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Dim77[/b]','')">Dim77</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.68'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30627">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2012 16:40 &middot; Поправил: Dim77 <br><script type="text/javascript">QU('Dim77','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dim77" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>reversecode пишет:<br>в оригинальном exe stdcall конвершинал<br>а в вашей хученой cdecl<br>вот стек и ломается  </I><br>Заработало. Спасибо. Это было круто <img src="img/smilies/s1.gif" alt=""> Это мой первый NoCD. Чувствую прилив эндорфинов <img src="img/smilies/s1.gif" alt=""><br><br>ЗЫ С исключениями в Олли еще предстоит разобраться ибо цель была добавить еще свой код к этому ехе. No CD - это была &quot;проба пера&quot;...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306046&amp;user=30627&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=14" class="addthx" data-post="306046"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2012 20:37 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>Dim77 пишет:<br>No CD - это была &quot;проба пера&quot; </I><br>Дожили, перья жрут...
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=306065&amp;user=10168&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=15" class="addthx" data-post="306065"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Dim77[/b]','')">Dim77</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.68'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30627">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2012 01:38 &middot; Поправил: Dim77 <br><script type="text/javascript">QU('Dim77','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dim77" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Выяснил в чем проблема с запуском программы под Олли - не может загрузить D3DIM700.dll. Дал Everyone все права на эту длл. Не помогло. Вылетает по исключению. Думаю, что если дать Everyone все права на system32, то заработает, но как-то стремно. Есть еще какие-либо варианты?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306575&amp;user=30627&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=16" class="addthx" data-post="306575"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2012 03:13 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>Dim77</b><br>ну попробуй кинуть эту длл в папку с программой и уже на неё дать права<br>хотя странно это всё..<br><br>а может dllInit возвращает 0?<br>поставь в ольке:<br>Make first pause at -&gt; System Breakpoint<br>и флаг Break on new module (DLL)<br>и попробуй дойти до точки входа в эту длл<br><br><b>Dim77 пишет:<br>Вылетает по исключению</b><br>а код-то какой?<img src="img/smilies/s11.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306577&amp;user=26242&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=17" class="addthx" data-post="306577"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=30627" title="07-06-2012 10:46, ранг:6.3" target="_blank">Dim77</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Dim77[/b]','')">Dim77</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.68'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30627">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2012 14:17 &middot; Поправил: Dim77 <br><script type="text/javascript">QU('Dim77','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dim77" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19932.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>а код-то какой? </I><br><br>При вылете попадает на обработку исключений: <br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">CPU&nbsp;Disasm</li><li class="hl_l1"><span style="word-break: break-all">Address&nbsp;&nbsp;&nbsp;Hex&nbsp;dump&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Command&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Comments</span></li><li class="hl_l0"><span class="hl_number">0A93B395</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">66</span><span class="hl_char">:</span><span class="hl_number">8B50</span>&nbsp;<span class="hl_number">0E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">DX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">+</span><span class="hl_number">0E</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">0A93B399</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">66</span><span class="hl_char">:</span><span class="hl_number">8BCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">CX</span><span class="hl_char">,</span><span class="hl_registr">DX</span></li><li class="hl_l0"><span class="hl_number">0A93B39C</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">66</span><span class="hl_char">:</span><span class="hl_number">81E1</span>&nbsp;F8FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>AND</b></span>&nbsp;<span class="hl_registr">CX</span><span class="hl_char">,</span>FFF8</li><li class="hl_l1"><span class="hl_number">0A93B3A1</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">66</span><span class="hl_char">:</span><span class="hl_number">81F9</span>&nbsp;D0CA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">CX</span><span class="hl_char">,</span><span class="hl_number">0CAD0</span></li><li class="hl_l0"><span class="hl_number">0A93B3A6</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">75</span>&nbsp;<span class="hl_number">29</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JNE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">0A93B3D1</span></li><li class="hl_l1"><span class="hl_number">0A93B3A8</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">80E2</span>&nbsp;<span class="hl_number">07</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>AND</b></span>&nbsp;<span class="hl_registr">DL</span><span class="hl_char">,</span><span class="hl_number">07</span></li><li class="hl_l0"><span class="hl_number">0A93B3AB</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">80FA</span>&nbsp;<span class="hl_number">05</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">DL</span><span class="hl_char">,</span><span class="hl_number">5</span></li><li class="hl_l1"><span class="hl_number">0A93B3AE</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">73</span>&nbsp;<span class="hl_number">21</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JNB</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">0A93B3D1</span></li><li class="hl_l0"><span class="hl_number">0A93B3B0</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">0A93B3B2</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">66</span><span class="hl_char">:</span><span class="hl_number">8178</span>&nbsp;<span class="hl_number">20</span>&nbsp;ADBE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">+</span><span class="hl_number">20</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0BEAD</span></li><li class="hl_l0"><span class="hl_number">0A93B3B8</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">75</span>&nbsp;<span class="hl_number">17</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JNE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">0A93B3D1</span></li><li class="hl_l1"><span class="hl_number">0A93B3BA</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;B8&nbsp;<span class="hl_number">01000000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">0A93B3BF</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;C745&nbsp;FC&nbsp;FFFFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_char">-</span><span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_number">0A93B3C6</span>&nbsp;&nbsp;<span class="hl_char">\</span><span class="hl_char">.</span>&nbsp;&nbsp;EB&nbsp;<span class="hl_number">12</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">0A93B3DA</span></li><li class="hl_l0"><span class="hl_number">0A93B3C8</span>&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">.</span>&nbsp;&nbsp;B8&nbsp;<span class="hl_number">01000000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_number">0A93B3CD</span>&nbsp;&nbsp;<span class="hl_char">\</span><span class="hl_char">.</span><span style="word-break: break-all">&nbsp;&nbsp;C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">RETN</span></li><li class="hl_l0"><span class="hl_number">0A93B3CE</span>&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B65</span>&nbsp;E8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">18</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">0A93B3D1</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">&gt;</span>&nbsp;&nbsp;C745&nbsp;FC&nbsp;FFFFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_char">-</span><span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">0A93B3D8</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">33C0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">0A93B3DA</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">&gt;</span>&nbsp;&nbsp;<span class="hl_number">8B4D</span>&nbsp;F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">0A93B3DD</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">5F</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l1"><span class="hl_number">0A93B3DE</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">64</span><span class="hl_char">:</span><span class="hl_number">890D</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">FS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ECX</span></li><li class="hl_l0"><span class="hl_number">0A93B3E5</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">5E</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_number">0A93B3E6</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">5B</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">0A93B3E7</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8BE5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_registr">EBP</span></li><li class="hl_l1"><span class="hl_number">0A93B3E9</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">5D</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EBP</span></li><li class="hl_l0"><span class="hl_number">0A93B3EA</span>&nbsp;&nbsp;<span class="hl_char">\</span><span class="hl_char">.</span><span style="word-break: break-all">&nbsp;&nbsp;C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">RETN</span></li><li class="hl_l1">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br>Вылетает на вызове EBX (см код ниже). В EBX в этот момент адрес: 0025004С. Другие dll, в том числе системные, нормально грузит. Этот код из модуля snxhk. <br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">CPU&nbsp;Disasm</li><li class="hl_l1"><span style="word-break: break-all">Address&nbsp;&nbsp;&nbsp;Hex&nbsp;dump&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Command&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Comments</span></li><li class="hl_l0"><span class="hl_number">754C8671</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB74424</span>&nbsp;<span class="hl_number">1C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">1C</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">754C8676</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B5424</span>&nbsp;<span class="hl_number">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">20</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">754C867A</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span><span style="word-break: break-all">&nbsp;&nbsp;D1E8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>SHR</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_number">754C867C</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">33C9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_registr">ECX</span></li><li class="hl_l0"><span class="hl_number">754C867E</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">66</span><span class="hl_char">:</span><span class="hl_number">890C42</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">*</span><span class="hl_number">2</span><span class="hl_char">+</span><span class="hl_registr">EDX</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">CX</span></li><li class="hl_l1"><span class="hl_number">754C8682</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">83C4</span>&nbsp;<span class="hl_number">0C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">0C</span></li><li class="hl_l0"><span class="hl_number">754C8685</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8D4424</span>&nbsp;<span class="hl_number">10</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">10</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">754C8689</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">394C24</span>&nbsp;<span class="hl_number">14</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">14</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ECX</span></li><li class="hl_l0"><span class="hl_number">754C868D</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span><span class="hl_char">-</span>&nbsp;<span class="hl_number">75</span>&nbsp;<span class="hl_number">02</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JNE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">754C8691</span></li><li class="hl_l1"><span class="hl_number">754C868F</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">&gt;</span>&nbsp;&nbsp;<span class="hl_number">8BC6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">ESI</span></li><li class="hl_l0"><span class="hl_number">754C8691</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">&gt;</span>&nbsp;&nbsp;<span class="hl_number">8B7D</span>&nbsp;<span class="hl_number">14</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">+</span><span class="hl_number">14</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">754C8694</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B4D</span>&nbsp;<span class="hl_number">08</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">754C8697</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">57</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l1"><span class="hl_number">754C8698</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">50</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">754C8699</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B45</span>&nbsp;<span class="hl_number">0C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">+</span><span class="hl_number">0C</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">754C869C</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">50</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">754C869D</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">51</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ECX</span></li><li class="hl_l1"><span class="hl_number">754C869E</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span><span style="word-break: break-all">&nbsp;&nbsp;FFD3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_registr">EBX</span></li>        </ol>
    </div>
</div></div>
<br><br><br><I>-=AkaBOSS=- пишет:<br>и попробуй дойти до точки входа в эту длл </I><br>Хм, нужно попробовать, заметил, что после передачи исключения программе длл загружается, но исключения продолжают регулярно выскакивать. Какая-то фигня с использованием DirectX библиотек похоже...<br><br>Заработало кое-как. Постоянно останавливается по exception, но если передать управление приложению, то через 3-5 циклов проходит дальше...<br><br>Пока работает на этапе инициализации данных. Посмотрим, как будет дальше ибо по-моему программа не любит, когда ее ставят на паузу и потом снимают. При этом передача управления программе не происходит. Но пока это не особенно важно. Тему закрываю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306586&amp;user=30627&amp;forum_n=5&amp;topic=19932.html&amp;page=0&amp;anchor=18" class="addthx" data-post="306586"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> RTTI ошибка при инжектировании своего кода.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19932" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
