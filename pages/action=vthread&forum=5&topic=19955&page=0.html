<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>сертификаты в браузере. как автоматически выбрать нужный и зайти на сайт? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="при заходе на определенный сайт появляется список сертификатов, выбирая нужный заходишь под тем логином. насколько я знаю в php есть такая возможность как дописать параметры к ссылке браузера типа:">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> сертификаты в браузере. как автоматически выбрать нужный и зайти на сайт?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 мая 2012 12:12 <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19955.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
при заходе на определенный сайт появляется список сертификатов, выбирая нужный заходишь под тем логином. насколько я знаю в php есть такая возможность как дописать параметры к ссылке браузера типа:<br>ввв.мыл.ру/login=vasya?password=123<br>и таким образом можно избежать процедуру авторизации на главной страничке сайта. можно ли подобным образом автоматически выбирать сертификат заходя на определенную ссылку? типа:<br>https://ввв.сайт.ру/sertificat=test.p12<br><br>есть вариант производить поиск по хенделу окна, потом находить все дочерние по пути до окна с выбором сертификатов, а после выбирать посредством SendMessage и LVM_SETITEMSTATE... но я никак не могу заставить выбирать какой-либо сертификат в этом окошке, а во вторых - браузеры бывают разные, соответственно и названия окошек, по которым производить поиск будут разные - хоть одно окно не найдет - все, система уже не пашет. потом сам список сертификатов не соответствует порядку в программе. то есть это придется еще читать название сертификата и сравнивать его название.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306243&amp;user=19941&amp;forum_n=5&amp;topic=19955.html&amp;page=0&amp;anchor=1" class="addthx" data-post="306243"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]drone[/b]','')">drone</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 85.4 (постоянный), 51thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.79'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30304">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 мая 2012 17:24 <br><script type="text/javascript">QU('drone','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=drone" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19955.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
работа с сертификатами происходит еще до контакта с веб-сервером, очевидно сертификат вы выбираете в etoken&#039;e и пишите нехорошую программу для кражи денег? мои домыслы
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306334&amp;user=30304&amp;forum_n=5&amp;topic=19955.html&amp;page=0&amp;anchor=2" class="addthx" data-post="306334"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 мая 2012 18:12 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19955.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>SeregaZ</b><br>Дописывание параметров запроса - это стандарт HTTP и к пхп не имеет никакого отношения. Параметры будут обработаны скриптом только в том случае если он работает с _GET запросами, если он явно обрабатывает только _POST запросы он их вообще не увидит.<br>С сертификатами вообще другая песня и их выбор происходит еще до контакта с контентом сайта, на этапе хендшейка. Работать с сертификатами мимо пользователя - зло.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=306338&amp;user=11966&amp;forum_n=5&amp;topic=19955.html&amp;page=0&amp;anchor=3" class="addthx" data-post="306338"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июня 2012 09:04 &middot; Поправил: SeregaZ <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19955.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
вас тут послушать жить вобще нельзя - жизнь это зло... пришлось делать метод через ж... путем winapi. пока дошел до момента нахождения окон выбора сертификата в эксплорере и гуглхроме, и уже есть чтение названий сертификатов из этого окна, и есть даже определение какой именно выделен. осталось добавить выделение нужного пункта и нажатия &quot;ок&quot;.<br><br>насчет кражи денег - это сайт сдачи налоговой отчетности. при заходе на него, вылазит окошко с выбором установленных сертификатов. оно понятно если фирма всего одна, а если фирм 10-20? и названия фирм там не пишет, а пишет РНН - 12 непонятных цифр. увязать в своей голове 10 двенадцатицифровых значений с определенной фирмой трудновато <img src="img/smilies/s1.gif" alt=""> <br><br>вот моя програмка сидит в трее, тыркаем - открывается меню, в нем список этих самых фирм, но только в виде названий, а не рнн. за каждым названием будет закреплен рнн и при выборе определенной фирмы открывается браузер хром или эксплорер, заходит на тот сайт и выбирает соответствующий выбранной фирме рнн, и жмет вход.<br><br>опционально думаю может быть то цифровое название рнн менять на текстовое - название фирмы прям в том поле... неизвестно правда как там потом будет происходить вход... не повредится ли чего <img src="img/smilies/s1.gif" alt=""><br><br><br><br><br><br>ну и раз пошла такая пьянка еще вопрос: налоговая изначально выдает ключик в виде файла.bin плюс 3-4 папки с файлами, а для входа на тот сайт его еще необходимо соответствующим образом сконвертировать - форма на сайте это делает используя java. типы сертификатов и сами сертификаты для меня китайская грамота... как узнать как именно происходит конвертация? этот java апплет отсылает ключ на сервер (формат gost) и получает оттуда (формат rsa.p12), или же сам апплет, локально, без пересылки производит конвертирование? я к чему веду - было бы здорово научить мою программу производить это конвертирование. почему думаю что может быть эта операция производится локально - так как есть вторая система для сдачи отчетности - отдельный клиент. так вот он делает аналогичный сертификат, но несколько иной нежели браузерный но тоже p12 - вот он производит конвертацию локально.<br><br><br><br><br>третий вопрос: есть сертификат RSA.p12 - чтобы его зарегистрировать достаточно тыркнуть на нем, запустится мастер импорта сертификатов, и далее далее далее и сертификат в итоге зарегистрирован. суть проблемы - при нахождении на компьютере специальной программы тумар (какое-то там дополнительное шифрование и абракадабра с сертификатами - используется обычно в интернет банкиках), подобное стандартное регистрирование RSA.p12 + далее далее далее - не работает. приходится выбирать вручную физическое расположение сертификата: Личные-Реестр (при тумаре там в этом Личные две папки - Реестр и Тумар - вот она и путается куда сувать новый сертификат). это все была преамбула - теперь собственно вопрос: есть ли какие консольные команды для регистрации этого RSA.p12? типа &quot;RSA.p12 /silent /path=Личные\Реестр&quot; чтобы он установился без ручного выбора того пути. бухгалтерши обычно бестолковые... и сами не могут это сделать <img src="img/smilies/s1.gif" alt=""><br><br>Certmgr.exe ( http://msdn.microsoft.com/en-us/library/e78byta0(v=vs.80).aspx ) не предлагать. там требуется нет фреймворк. у них его может не быть. хотя я бы согласился бы на портейбл версию Certmgr.exe <img src="img/smilies/s1.gif" alt=""><br><br>вот подойдет! <noindex><a href="http://wiki.7405405.ru/index.php/%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D0%B2_%D0%A3%D0%B4%D0%BE%D1%81%D1%82%D0%BE%D0%B2%D0%B5%D1%80%D1%8F%D1%8E%D1%89%D0%B5%D0%B3%D0%BE_%D1%86%D0%B5%D0%BD%D1%82%D1%80%D0%B0" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex> но как и чем и где сделан ехе файл...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306409&amp;user=19941&amp;forum_n=5&amp;topic=19955.html&amp;page=0&amp;anchor=4" class="addthx" data-post="306409"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июня 2012 14:32 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19955.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>SeregaZ</b><br>Может просто при наведении мыши на элемент списка показывать хинт с названием лица, вместо того чтоб самому подменять пользователя? И бухгалтеру понятно будет и тебе мороки меньше.<br>По поводу импорта сертификатов - посмотри WinAPI - там несложно и самому написать импортер.<br>Что касается конвертирования, вопрос нужно изучать глубжее. По умолчанию виндовс, скорей всего, ничего не знает ни о ГОСТ, ни о формате хранилища в bin. Результат в р12 - это уже стандартный формат, но как они ГОСТ в РСА переделывают - загадка.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=306427&amp;user=11966&amp;forum_n=5&amp;topic=19955.html&amp;page=0&amp;anchor=5" class="addthx" data-post="306427"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]drone[/b]','')">drone</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 85.4 (постоянный), 51thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.79'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30304">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июня 2012 15:00 <br><script type="text/javascript">QU('drone','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=drone" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19955.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Очевидно что у вас не чистый ssl/tls, а какое-то заново изобретенное колесо в виде надстроек или чего-то такого, раз сертификаты спрашивают после подключения к веб-серверу. Про самостоятельную конвертацию сертификатов без реверса аплета можно забыть. P12 сертификат в моем понимании это склееный публичный и приватный ключи клиента, чтобы из сгенерить нужно знать приватный ключ сервера, а его вам никто не даст (мне так кажется почему-то <img src="img/smilies/s1.gif" alt=""> )<br><br>Установка DER сертификата:<br>CertOpenStore - CertAddCertificateContextToStore - CertCloseStore<br><br>Вот тут есть хороший кодес:<br>http://www.wasm.ru/forum/viewtopic.php?id=39961
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306428&amp;user=30304&amp;forum_n=5&amp;topic=19955.html&amp;page=0&amp;anchor=6" class="addthx" data-post="306428"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 июня 2012 07:20 &middot; Поправил: SeregaZ <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19955.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
а теперь как для ребёнка <img src="img/smilies/s1.gif" alt=""><br><br>при регистрации через стандартный - Мастер импорта сертификатов - выбирается путь, куда сертификат будет сохранен (Личные\Реестр), читается содержимое RSA.p12, соответствующим образом распаковывается и сохраняется в C:\Documents and Settings\Администратор\Application Data\Microsoft\SystemCertificates\My\Certificates под именем типа 9930806CDBCD9E2C993B3A7D8A8FABCADFD88898<br><br>теперь как это повторить? CertOpenStore и CertCloseStore исходя из названия открывает и закрывает хранилище. какое такое хранилище? тот мой файл RSA.p12 или же открывает то место в виндовсе, где все сертификаты хранятся?<br><br><noindex><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa382037(v=vs.85).aspx" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex> вот тут подробный С++ пример. я, к сожалению, далек от технического английского и все что там написано для меня китайская грамота. нужны русские комментарии и пояснения <img src="img/smilies/s1.gif" alt=""><br><br>скопировал фрагмент с того сайта, все на буржуйском. напишу перевод, и сразу вопросы по параметрам.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Open&nbsp;the&nbsp;My&nbsp;system&nbsp;store&nbsp;using&nbsp;CertOpenStore<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function">if</span><span class="hl_char">(</span>hSystemStore&nbsp;<span class="hl_char">=</span>&nbsp;CertOpenStore<span class="hl_char">(</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERT_STORE_PROV_SYSTEM<span class="hl_char">,</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;System&nbsp;store&nbsp;will&nbsp;be&nbsp;a&nbsp;</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;virtual&nbsp;store</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;я&nbsp;так&nbsp;понял&nbsp;тут&nbsp;определяется&nbsp;тип<span class="hl_char">,</span>&nbsp;что<span class="hl_char">-</span>то&nbsp;вроде&nbsp;куда&nbsp;мы&nbsp;сохраняем<span class="hl_char">.</span>&nbsp;</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;в&nbsp;файл&nbsp;или&nbsp;в&nbsp;память</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;и&nbsp;мне&nbsp;походу&nbsp;надо&nbsp;CERT_STORE_PROV_PHYSICAL</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;в&nbsp;этом&nbsp;случае&nbsp;он&nbsp;даст&nbsp;указать&nbsp;путь&nbsp;со&nbsp;слешем</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Encoding&nbsp;type&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;needed&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;with&nbsp;<span class="hl_function"><b>this</b></span>&nbsp;PROV</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Accept&nbsp;the&nbsp;default&nbsp;HCRYPTPROV</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERT_SYSTEM_STORE_CURRENT_USER<span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Set&nbsp;the&nbsp;system&nbsp;store&nbsp;location&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;the</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;registry</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Выбор&nbsp;куда&nbsp;мы&nbsp;сохраняем<span class="hl_char">.</span>&nbsp;но&nbsp;это&nbsp;не&nbsp;путь<span class="hl_char">.</span>&nbsp;где&nbsp;Личные<span class="hl_char">\</span>Реестр&nbsp;указывается<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_quote">L&quot;MY&quot;</span><span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Could&nbsp;have&nbsp;used&nbsp;other&nbsp;predefined&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;system&nbsp;stores</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;including&nbsp;Trust<span class="hl_char">,</span>&nbsp;CA<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;Root</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;вот&nbsp;тут&nbsp;больше&nbsp;похоже&nbsp;на&nbsp;путь<span class="hl_char">,</span>&nbsp;но&nbsp;мне&nbsp;надо&nbsp;</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;в&nbsp;английском&nbsp;варианте&nbsp;Личные<span class="hl_char">\</span>Реестр&nbsp;что<span class="hl_char">-</span>то&nbsp;типа&nbsp;Personal<span class="hl_char">\</span>Registry</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;нашел&nbsp;список&nbsp;возможных&nbsp;вариантов&nbsp;выходит&nbsp;или&nbsp;MY<span class="hl_char">\</span><span class="hl_char">.</span>Default&nbsp;или&nbsp;UserDS<span class="hl_char">\</span><span class="hl_char">.</span>UserCertificate</li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;Opened the MY system store. \n&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1"><span class="hl_function">else</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;MyHandleError<span class="hl_char">(</span>&nbsp;<span class="hl_quote">&quot;Could not open the MY system store.&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li>        </ol>
    </div>
</div></div>
<br><br>***<br><br>по CertAddCertificateContextToStore там только один пример, и судя по коменту он не подходит. &quot;добавляет сертификат из Моего хранилища в новое хранилище в памяти&quot;. мне по идее надо что-то типа &quot;читает сертификат из файла и добавляет его в Мое хранилище, или в системное хранилище... куда он должен то...&quot;<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>Add</b></span>&nbsp;the&nbsp;certificate&nbsp;from&nbsp;the&nbsp;My&nbsp;store&nbsp;to&nbsp;the&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;memory&nbsp;store<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function">if</span><span class="hl_char">(</span>CertAddCertificateContextToStore<span class="hl_char">(</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hMemoryStore<span class="hl_char">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Store&nbsp;handle</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;куда&nbsp;мы&nbsp;сохраняем<span class="hl_char">.</span>&nbsp;тут&nbsp;вроде&nbsp;в&nbsp;память<span class="hl_char">,</span>&nbsp;а&nbsp;надо&nbsp;видимо&nbsp;hSystemStore&nbsp;<span class="hl_char">-</span>&nbsp;в&nbsp;систему</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pDesiredCert<span class="hl_char">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Pointer&nbsp;to&nbsp;a&nbsp;certificate</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;тут&nbsp;по&nbsp;идее&nbsp;должен&nbsp;быть&nbsp;путь&nbsp;до&nbsp;файла&nbsp;с&nbsp;сертификатом</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERT_STORE_ADD_USE_EXISTING<span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;а&nbsp;вот&nbsp;USE_EXISTING&nbsp;мне&nbsp;видимо&nbsp;не&nbsp;подойдет&nbsp;<span class="hl_char">-</span>&nbsp;использовать&nbsp;существующий</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;мне&nbsp;надо&nbsp;что<span class="hl_char">-</span>то&nbsp;типа&nbsp;CERT_STORE_ADD_CREATE_NEW&nbsp;<span class="hl_char">-</span>&nbsp;создать&nbsp;новый</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;Certificate added to the memory store. \n&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0"><span class="hl_function">else</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;MyHandleError<span class="hl_char">(</span><span class="hl_quote">&quot;Could not add the certificate &quot;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_quote">&quot;to the memory store.&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li>        </ol>
    </div>
</div></div>
<br><br>***<br><br>по закрытию CertCloseStore все понятно.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function">if</span><span class="hl_char">(</span>hSystemStore<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;CertCloseStore<span class="hl_char">(</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hSystemStore<span class="hl_char">,</span>&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERT_CLOSE_STORE_CHECK_FLAG<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>в свойствах уже установленного ключа написано:<br>Версия V3<br>Алгоритм подписи sha1RSA<br>Открытый ключ RSA (512 Bits)<br>Алгоритм отпечатка sha1<br><br>что необходимо в коде поправить, чтобы все правильно понималось? в смысле всякие непонятные кодировки и прочее...<br><br>***<br><br>и из того примера один непонятный момент... <b>blob.pbData = (BYTE*)pfx;</b> что это такое, и как подобное получить? у меня не с++...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306488&amp;user=19941&amp;forum_n=5&amp;topic=19955.html&amp;page=0&amp;anchor=7" class="addthx" data-post="306488"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> сертификаты в браузере. как автоматически выбрать нужный и зайти на сайт?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#8" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="19955">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19955" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
