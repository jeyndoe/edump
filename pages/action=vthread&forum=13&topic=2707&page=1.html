<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Распаковка AsProtect &gt;1.23 - от А до Я. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Эта тема по распаковке AsProtect&#039;a последних версий, для надругательств выбрана программа: AlfaClock 1.82 сайт программы: www.alfasoftweb.com/rus/ прямая ссылка: www.alfasoftweb.com/rus/AlfaClock_rus.exe В этот раздел можно">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка AsProtect &gt;1.23 - от А до Я.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]nice[/b]','')">nice</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 384.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29">Участник</a><br><font color=blue>www.int3.net</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 августа 2005 11:56 &middot; Поправил: nice <br><script type="text/javascript">QU('nice','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nice" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Эта тема по распаковке AsProtect&#039;a последних версий, для надругательств выбрана программа: AlfaClock 1.82
<br>сайт программы: www.alfasoftweb.com/rus/
<br>прямая ссылка: www.alfasoftweb.com/rus/AlfaClock_rus.exe
<br>
<br>В этот раздел можно постить всё что касается защиты в этой программе, а также скрипты для распаковки, утилиты для снятия, ссылки на статьи.
<br>
<br>За флейм будем наказывать!
<br>
<br>Нашел ОЕР <b>inferno_mteam</b>
<br>004C5444 55 PUSH EBP
<br>004C5445 8BEC MOV EBP,ESP
<br>004C5447 83C4 C0 ADD ESP,-40
<br>004C544A 53 PUSH EBX
<br>004C544B 33C0 XOR EAX,EAX
<br>004C544D 8945 D4 MOV DWORD PTR SS:[EBP-2C],EAX
<br>004C5450 8945 D0 MOV DWORD PTR SS:[EBP-30],EAX
<br>В Ольке можно быстро попасть на ОЕР сл. образом, открываем программу, жмем Ctrl+G (перейти на строку) вбиваем туда ОЕР=04С5444, правой кнопкой мыши: Breakpoint-&gt;Hardware, on execution
<br>после чего отключаем все Exceptions: menu-&gt;Options-&gt;Exceptions и ставим все галочки, .теперь нажите F9 и вы на ОЕР
<br><br><font size="1"><i>-----<br>Подписи - ЗЛО! Нужно убирать!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=33131&amp;user=29&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=1" class="addthx" data-post="33131"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 11:50 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
Простите Какую прогу паспаковываем? Попробуйте так.
<br>Проход до ОЕР: Для определения виртуального ОЕР всё делаем аналогично предыдущей версии аспра. После срабатывания бряка на секции CODE ОЕР по  адресу ESP-8. Далее лучше всего  рестарт D addrOEP в окне дампа. Когда, после очередного исключения ОЕР будет распаковано, то необходимо сразу 	       переходить на него ипроизводить дальнейшие действия. Эти деиствия остановят счётчик.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35205&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=2" class="addthx" data-post="35205"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]inferno_mteam[/b]','')">inferno_mteam</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 28.6 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.41'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1268">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 11:58 <br><script type="text/javascript">QU('inferno_mteam','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=inferno_mteam" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<b>nice</b>
<br>Для аспра 2.х можно дампить прямо на OEP, если она распологается в выделенной аспром памяти.
<br>Про xor байт на OEP не вкурил <img src="img/smilies/s1.gif" alt="">
<br>Насчет обнаружения места в ехе, где раньше лежала EP: не уверен вообще что это возможно, хотя для некоторых из run-time функций для дельфи прог эти самые функции вернуть назад можно, ибо куски из них остаются в exe, а остальная часть выкусывается аспром.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35207&amp;user=1268&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=3" class="addthx" data-post="35207"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 13:06 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
Это основная ветка. Видоизменяет два аспрокелла. 6 раз обращается к поге используя часть подпрограмм. Здесь и надо дампить, т. к прога распакована и аспрокелы не видоизменены. Затем в дампе восстановливать спёртые байты. И прикручивать их к последней секции проги. Но это очень долго. Надо искать как обмануть. Импорт восстанавливается аналогично.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35210&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=4" class="addthx" data-post="35210"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 13:32 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<i>SergSh пишет:
<br>Видоизменяет два аспрокелла. 6 раз обращается к поге используя часть подпрограмм. </i>
<br>Извини, но что-то я не понял твою терминологию.
<br><i>SergSh пишет:
<br>Здесь и надо дампит </i>. А где здесь? Есть начало спертых байт - в выделенной области, есть переход
<br>на секцию кода (1-я команда). Между ними - обращение к VM и выход и нее. Так где?
<br>Кстати, ты дампером-плагином OllyDbg не пользуешься?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35213&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=5" class="addthx" data-post="35213"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]nice[/b]','')">nice</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 384.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29">Участник</a><br><font color=blue>www.int3.net</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 13:49 <br><script type="text/javascript">QU('nice','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nice" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
<b>tar4</b>
<br>Дампить имможно, а вот импорт лучше ИмпрРеком прикручивать
<br><br><font size="1"><i>-----<br>Подписи - ЗЛО! Нужно убирать!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35216&amp;user=29&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=6" class="addthx" data-post="35216"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]sanniassin[/b]','')">sanniassin</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 31.0 (посетитель), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=42">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2005 00:35 <br><script type="text/javascript">QU('sanniassin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sanniassin" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<i>inferno_mteam пишет:
<br>Насчет обнаружения места в ехе, где раньше лежала EP: не уверен вообще что это возможно </i>
<br>
<br>Да запросто (если я правильно понял вопрос) <img src="img/smilies/s1.gif" alt=""> просто поищи в секции кода jmp stolen_OEP_start
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35265&amp;user=42&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=7" class="addthx" data-post="35265"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2005 09:46 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<i>nice пишет:
<br>nice </i>
<br>А может этот топик объединить с топиком &quot;Сокрытие OEP в аспре 2.1&quot; и заняться указанной в нем прогой?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35280&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=8" class="addthx" data-post="35280"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]inferno_mteam[/b]','')">inferno_mteam</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 28.6 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.41'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1268">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2005 10:23 <br><script type="text/javascript">QU('inferno_mteam','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=inferno_mteam" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<i>sanniassin пишет:
<br>просто поищи в секции кода jmp stolen_OEP_start </i>
<br>Что то я не очень понял, что такое stolen_OEP_start.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35281&amp;user=1268&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=9" class="addthx" data-post="35281"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]assassin[/b]','')">assassin</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 21.3 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.52'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1073">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2005 14:53 <br><script type="text/javascript">QU('assassin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=assassin" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
<b>tar4</b>
<br>лучше, как уже предлагалось, поисследовать IconLover
<br><a href="http://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2830
" target="_new">http://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2830
</a><br>во первых там не только &#039;сокрытие ОЕП&#039;, но есть VM, и AIP(вроде),  вобщем аспр2 во всей красе)
<br>во вторых эта реальная прога, а не анпакми, и в третьих мне надо ее заломать ))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35294&amp;user=1073&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=10" class="addthx" data-post="35294"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2005 19:54 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
А что, если в самом начале спёртых байт прямо на ОЕП прогу сдампить и сдампить все регионы выделенной памяти (через ПЕТулз, дамп регион), а потом все эти секции прицепить к ехе, способ крайне долгий и геморный, но может сработает? Ну и импорт потом конечно прикрутить. И прога распакованная, патчить вроде можно и должно работать в теории, хотя и геморно делать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35341&amp;user=1556&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=11" class="addthx" data-post="35341"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Mario555[/b]','')">Mario555</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/15.jpg" alt=""><br><span class=txtSm>Ранг: 332.0 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15">Участник</a><br><font color=blue>•Pr0tEcToRs KiLLeR•</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2005 20:35 <br><script type="text/javascript">QU('Mario555','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mario555" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
<i>Archer пишет:
<br>рямо на ОЕП прогу сдампить и сдампить все регионы выделенной памяти </i>
<br>баян ))) 
<br>в стриппере это уже _очень_ давно реализовано и вручную без проблем делалось, правда некрасиво это... для автоунпакера ещё нормально, а для ручной распаковки некрасиво.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35345&amp;user=15&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=12" class="addthx" data-post="35345"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2005 21:12 &middot; Поправил: Archer <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<b>Mario555</b>
<br>Да блин, хоть бы работало! Ну предложи получше способ. Я готов ехе хоть в 50 метров получить, лишь бы запахало на ура. Всё равно только для себя ковыряю.
<br>Не, в смысле, я понимаю, что это хреново, но так даже ИАТ не надо будет восстанавливать. А патчить прогу вполне можно. Ламерский способ и долгий и нудный, но работать должно нормально.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35348&amp;user=1556&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=13" class="addthx" data-post="35348"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]sanniassin[/b]','')">sanniassin</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 31.0 (посетитель), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=42">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2005 03:46 <br><script type="text/javascript">QU('sanniassin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sanniassin" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
<i>inferno_mteam пишет:
<br>Что то я не очень понял, что такое stolen_OEP_start. </i>
<br>адрес начала спёртого с OEP кода
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35367&amp;user=42&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=14" class="addthx" data-post="35367"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]sanniassin[/b]','')">sanniassin</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 31.0 (посетитель), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=42">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2005 03:49 &middot; Поправил: sanniassin <br><script type="text/javascript">QU('sanniassin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sanniassin" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
<i>Mario555 пишет:
<br>в стриппере это уже _очень_ давно реализовано и вручную без проблем делалось, правда некрасиво это... для автоунпакера ещё нормально, а для ручной распаковки некрасиво. </i>
<br>В стриппере 2.13 это уже fixed <img src="img/smilies/s1.gif" alt=""> там VM удаляется, удаляются мусорные джампы и все спёртые куски лепятся в 1 секцию с нормальным RVA
<br><i>Mario555 пишет:
<br>для автоунпакера ещё нормально, а для ручной распаковки некрасиво. </i>
<br>Зато даже в аспре 2.2 катит метод, я там 20 метров дампил сразу и всё заработало (тока проверку на PID процесса пофиксить) <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35368&amp;user=42&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=15" class="addthx" data-post="35368"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2005 09:09 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
<i>sanniassin пишет:
<br> я там 20 метров дампил сразу </i>
<br>По-моему это не очень удобный способ. В следующей версии аспра этих секций будет более сотни и что тогда?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35375&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=16" class="addthx" data-post="35375"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2005 17:29 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
<b>tar4</b>
<br>Ну вот тогда и будем думать. <img src="img/smilies/s1.gif" alt=""> Других идей всё равно пока больше нет, ну кроме просмотра каждой команды руками и выбора нужных и ненужных.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35508&amp;user=1556&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=17" class="addthx" data-post="35508"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 сентября 2005 14:21 &middot; Поправил: SergSh <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
Как не пытался я его обмануть, плюнул. На счёт спёртых байт мне кажется здесь этот термин не совсем подходит, т.к. речь идёт о эмеляции основной ветки. Поэтому я решил попробовать написать её. Пока мне это удаётся. Значит как обычно делаем проход, остановились на секции кода, восстановили импорт, сделали дамп ОЕР происали любое (проктически), прикрутили импорт к дампу. Напоминаю, что VOEP находится по адресу ESP-8.Теперь в последней секции аспра будем писать основную ветку. Примерно так:
<br>/*7B1000*/  PUSH EBP
<br>/*7B1001*/  MOV EBP,ESP
<br>/*7B1003*/  ADD ESP,-10
<br>/*7B1006*/  PUSH EBX
<br>/*7B1007*/  PUSH ESI
<br>/*7B1008*/  PUSH EDI
<br>/*7B1009*/  XOR EAX,EAX
<br>/*7B100B*/  MOV DWORD PTR SS:[EBP-10],EAX
<br>/*7B100E*/  MOV EAX,ddd_.006B64E8 число циклов у меня получилось 10А
<br>/*7B1013*/  CALL ddd_.007059AC
<br>Обратите внимание на ddd_.006B64E8 по этому адресу должно находится колличество циклов
<br>CALL EAX.
<br>CALL ddd_.007059AC выглядит так:
<br>/*7059AC*/  PUSH EAX
<br>/*7059AD*/  PUSH 0
<br>/*7059AF*/  CALL &lt;JMP.&amp;kernel32.GetModuleHandleA&gt;
<br>/*7059B4*/  MOV EDX,ddd_.006B7108
<br>/*7059B9*/  PUSH EDX
<br>/*7059BA*/  MOV DWORD PTR DS:[6D34DC],EAX
<br>/*7059BF*/  NOP
<br>/*7059C0*/  MOV DWORD PTR DS:[EDX+4],EAX
<br>/*7059C3*/  MOV DWORD PTR DS:[EDX+8],0
<br>/*7059CA*/  MOV DWORD PTR DS:[EDX+C],0
<br>/*7059D1*/  CALL ddd_.0070595A
<br>/*7059D6*/  POP EDX
<br>/*7059D7*/  POP EAX
<br>/*7059D8*/  CALL ddd_.0070289E
<br>/*7059DD*/  RETN
<br>CALL ddd_.0070595A выглядит так:
<br>/*70595A*/  PUSH EBX
<br>/*70595B*/  ADD ESP,-108
<br>/*705961*/  PUSH 105
<br>/*705966*/  LEA EAX,DWORD PTR SS:[ESP+4]
<br>/*70596A*/  PUSH EAX
<br>/*70596B*/  MOV EAX,DWORD PTR DS:[6D34DC]
<br>/*705970*/  PUSH EAX
<br>/*705971*/  CALL &lt;JMP.&amp;kernel32.GetModuleFileNameA&gt;
<br>/*705976*/  MOV EAX,ESP
<br>/*705978*/  CALL ddd_.00405DF8
<br>/*70597D*/  MOV EBX,EAX
<br>/*70597F*/  MOV DWORD PTR DS:[6B7118],EBX
<br>/*705985*/  TEST EBX,EBX
<br>/*705987*/  JNZ SHORT ddd_.00705993
<br>/*705989*/  MOV EAX,DWORD PTR DS:[6B710C]
<br>/*70598E*/  MOV DWORD PTR DS:[6B7118],EAX
<br>/*705993*/  MOV EAX,ddd_.006B7108
<br>/*705998*/  CALL ddd_.00406110
<br>/*70599D*/  ADD ESP,108
<br>/*7059A3*/  POP EBX
<br>/*7059A4*/  RETN
<br>CALL ddd_.0070289E выглядит так:
<br>/*70289E*/  MOV DWORD PTR DS:[6D34AC],EAX
<br>/*7028A3*/  XOR EAX,EAX
<br>/*7028A5*/  NOP
<br>/*7028A6*/  MOV DWORD PTR DS:[6D34B0],EAX
<br>/*7028AB*/  NOP
<br>/*7028AC*/  MOV DWORD PTR DS:[6D34B4],EDX
<br>/*7028B2*/  MOV EAX,DWORD PTR DS:[EDX+4]
<br>/*7028B5*/  MOV DWORD PTR DS:[6D3020],EAX
<br>/*7028BA*/  NOP
<br>/*7028BB*/  CALL ddd_.00403AD0
<br>/*7028C0*/  MOV BYTE PTR DS:[6D3028],0
<br>/*7028C7*/  CALL ddd_.00403B78
<br>/*7028CC*/  RETN
<br>Обратите внимание на CALL ddd_.00403B78 я его маленько изменил, т.к. в оригинале его выполнение идёт в вазных участках памяти. У меня он выглядит так:
<br>/*403B78*/  PUSH EBP
<br>/*403B79*/  MOV EBP,ESP
<br>/*403B7B*/  PUSH EBX
<br>/*403B7C*/  PUSH ESI
<br>/*403B7D*/  PUSH EDI
<br>/*403B7E*/  MOV EAX,DWORD PTR DS:[6D34AC]
<br>/*403B83*/  TEST EAX,EAX
<br>/*403B85*/  JE SHORT ddd_.00403BD2
<br>/*403B87*/  MOV ESI,DWORD PTR DS:[EAX]
<br>/*403B89*/  XOR EBX,EBX
<br>/*403B8B*/  MOV EDI,DWORD PTR DS:[EAX+4] Здесь адрес начала таблицы EAX и ниже вся таблица.
<br>/*403B8E*/  XOR EDX,EDX
<br>/*403B90*/  PUSH EBP
<br>/*403B91*/  PUSH ddd_.00403BBE
<br>/*403B96*/  PUSH DWORD PTR FS:[EDX]
<br>/*403B99*/  MOV DWORD PTR FS:[EDX],ESP
<br>/*403B9C*/  CMP ESI,EBX
<br>/*403B9E*/  JLE SHORT ddd_.00403BB4
<br>/*403BA0*/  MOV EAX,DWORD PTR DS:[EDI+EBX*4]
<br>/*403BA3*/  INC EBX
<br>/*403BA4*/  MOV DWORD PTR DS:[6D34B0],EBX
<br>/*403BAA*/  TEST EAX,EAX
<br>/*403BAC*/  JE SHORT ddd_.00403BB0
<br>/*403BAE*/  CALL EAX
<br>/*403BB0*/  CMP ESI,EBX
<br>/*403BB2*/  JG SHORT ddd_.00403BA0
<br>/*403BB4*/  XOR EAX,EAX
<br>/*403BB6*/  POP EDX
<br>/*403BB7*/  POP ECX
<br>/*403BB8*/  POP ECX
<br>/*403BB9*/  MOV DWORD PTR FS:[EAX],EDX
<br>/*403BBC*/  JMP SHORT ddd_.00403BD2
<br>/*403BBE*/  JMP ddd_.004035E4
<br>/*403BC3*/  CALL ddd_.00403B18
<br>/*403BC8*/  CALL ddd_.004038EC
<br>/*403BCD*/  CALL ddd_.00403940
<br>/*403BD2*/  POP EDI
<br>/*403BD3*/  POP ESI
<br>/*403BD4*/  POP EBX
<br>/*403BD5*/  POP EBP
<br>/*403BD6*/  RETN
<br>Приведу таблицу CALL EAX:
<br>006B6910  24 73 40 00 C0 70 40 00  &#036;s@.Аp@.
<br>006B6918  50 85 40 00 50 82 40 00  P…@.P‚@.
<br>006B6920  04 EF 40 00 B8 4E 42 00  п@.ёNB.
<br>006B6928  B4 EF 40 00 64 F0 40 00  ґп@.dр@.
<br>006B6930  2C 47 42 00 1C F5 40 00  ,GB.х@.
<br>006B6938  58 FE 40 00 10 A4 41 00  Xю@.¤A.
<br>006B6940  34 3B 42 00 74 46 44 00  4;B.tFD.
<br>006B6948  F8 4E 42 00 E8 3E 42 00  шNB.и&gt;B.
<br>006B6950  18 A8 44 00 AC 17 44 00  ЁD.¬D.
<br>006B6958  DC 29 44 00 CC 0C 43 00  Ь)D.М.C.
<br>006B6960  4C 16 43 00 28 20 43 00  LC.( C.
<br>006B6968  14 61 42 00 78 51 42 00  aB.xQB.
<br>006B6970  E0 5D 42 00 20 51 42 00  а]B. QB.
<br>006B6978  B0 71 45 00 F0 72 45 00  °qE.рrE.
<br>006B6980  B8 72 45 00 60 72 45 00  ёrE.`rE.
<br>006B6988  28 72 45 00 28 73 45 00  (rE.(sE.
<br>006B6990  88 73 45 00 7C C4 45 00  €sE.|ДE.
<br>006B6998  44 C4 45 00 E0 FA 45 00  DДE.аъE.
<br>006B69A0  34 2B 46 00 E0 35 46 00  4+F.а5F.
<br>006B69A8  A4 4A 46 00 90 6C 46 00  ¤JF.ђlF.
<br>006B69B0  B0 6E 46 00 78 75 46 00  °nF.xuF.
<br>006B69B8  B0 75 46 00 48 76 46 00  °uF.HvF.
<br>006B69C0  D4 1F 48 00 0C 20 48 00  ФH.. H.
<br>006B69C8  C4 2A 48 00 90 7D 48 00  Д*H.ђ}H.
<br>006B69D0  A0 81 48 00 BC 82 48 00   ЃH.ј‚H.
<br>006B69D8  64 8A 48 00 7C 9A 48 00  dЉH.|љH.
<br>006B69E0  DC 9A 48 00 EC BA 48 00  ЬљH.мєH.
<br>006B69E8  48 C2 48 00 EC 97 49 00  HВH.м—I.
<br>006B69F0  F8 AB 49 00 30 AC 49 00  ш«I.0¬I.
<br>006B69F8  68 AC 49 00 B8 AC 49 00  h¬I.ё¬I.
<br>006B6A00  50 E4 4A 00 30 E5 4A 00  PдJ.0еJ.
<br>006B6A08  8C E7 4A 00 84 0E 4B 00  ЊзJ.„K.
<br>006B6A10  60 3B 4B 00 94 65 4B 00  `;K.”eK.
<br>006B6A18  18 DD 4B 00 6C 0C 4C 00  ЭK.l.L.
<br>006B6A20  F0 2A 4C 00 04 2E 4C 00  р*L..L.
<br>006B6A28  84 47 4C 00 A8 4A 4C 00  „GL.ЁJL.
<br>006B6A30  38 58 4C 00 70 7D 4C 00  8XL.p}L.
<br>006B6A38  24 86 4C 00 50 96 4C 00  &#036;†L.P–L.
<br>006B6A40  08 97 4C 00 B4 A2 4C 00  —L.ґўL.
<br>006B6A48  58 BD 4C 00 90 BD 4C 00  XЅL.ђЅL.
<br>006B6A50  94 1D 4D 00 4C 1E 4D 00  ”M.LM.
<br>006B6A58  00 81 4D 00 A0 81 4D 00  .ЃM. ЃM.
<br>006B6A60  30 79 4E 00 60 AF 4E 00  0yN.`ЇN.
<br>006B6A68  1C 18 4F 00 9C 2A 4F 00  O.њ*O.
<br>006B6A70  A4 33 4F 00 1C 3C 4F 00  ¤3O.&lt;O.
<br>006B6A78  F4 49 4F 00 1C 98 4F 00  фIO.?O.
<br>006B6A80  6C DD 50 00 20 FC 50 00  lЭP. ьP.
<br>006B6A88  28 FF 50 00 E0 28 51 00  (яP.а(Q.
<br>006B6A90  40 3E 51 00 58 45 51 00  @&gt;Q.XEQ.
<br>006B6A98  28 79 51 00 B8 89 51 00  (yQ.ё‰Q.
<br>006B6AA0  2C 8A 51 00 0C CA 51 00  ,ЉQ..КQ.
<br>006B6AA8  9C CD 51 00 F0 E4 51 00  њНQ.рдQ.
<br>006B6AB0  94 10 52 00 30 11 52 00  ”R.0R.
<br>006B6AB8  CC 36 52 00 5C 99 52 00  М6R.&#92;™R.
<br>006B6AC0  5C 3B 52 00 04 0C 63 00  &#92;;R..c.
<br>006B6AC8  54 63 6B 00 C4 4D 52 00  Tck.ДMR.
<br>006B6AD0  04 62 52 00 EC 6F 52 00  bR.мoR.
<br>006B6AD8  9C 79 52 00 18 9A 52 00  њyR.љR.
<br>006B6AE0  90 A4 52 00 BC B1 52 00  ђ¤R.ј±R.
<br>006B6AE8  04 5A 6B 00 BC 28 6B 00  Zk.ј(k.
<br>006B6AF0  58 7D 52 00 F8 21 6B 00  X}R.ш!k.
<br>006B6AF8  F8 83 52 00 A4 87 52 00  шѓR.¤‡R.
<br>006B6B00  64 8F 52 00 A4 95 52 00  dЏR.¤•R.
<br>006B6B08  30 0A 6B 00 AC C4 52 00  0.k.¬ДR.
<br>006B6B10  10 C7 52 00 38 D6 52 00  ЗR.8ЦR.
<br>006B6B18  38 DC 52 00 88 DC 52 00  8ЬR.€ЬR.
<br>006B6B20  68 EA 52 00 9C F7 52 00  hкR.њчR.
<br>006B6B28  B0 DE 6A 00 EC FB 52 00  °Юj.мыR.
<br>006B6B30  A4 97 5E 00 6C 97 5E 00  ¤—^.l—^.
<br>006B6B38  0C 14 53 00 B8 22 53 00  .S.ё&quot;S.
<br>006B6B40  10 93 56 00 D4 F5 56 00  “V.ФхV.
<br>006B6B48  30 F7 56 00 AC 5C 53 00  0чV.¬&#92;S.
<br>006B6B50  34 BD 54 00 D4 8A 56 00  4ЅT.ФЉV.
<br>006B6B58  48 EA 5C 00 18 07 53 00  Hк&#92;.S.
<br>006B6B60  04 A8 57 00 00 36 53 00  ЁW..6S.
<br>006B6B68  C4 4B 53 00 00 32 55 00  ДKS..2U.
<br>006B6B70  90 32 55 00 24 FC 52 00  ђ2U.&#036;ьR.
<br>006B6B78  E4 36 55 00 DC 9C 55 00  д6U.ЬњU.
<br>006B6B80  0C 8B 56 00 78 92 56 00  .‹V.x’V.
<br>006B6B88  28 9F 55 00 50 04 56 00  (џU.PV.
<br>006B6B90  88 04 56 00 B0 92 56 00  €V.°’V.
<br>006B6B98  8C EA 5C 00 C4 EA 5C 00  Њк&#92;.Дк&#92;.
<br>006B6BA0  FC EA 5C 00 34 EB 5C 00  ьк&#92;.4л&#92;.
<br>006B6BA8  F8 19 5E 00 00 82 58 00  ш^..‚X.
<br>006B6BB0  94 FE 58 00 04 22 59 00  ”юX.&quot;Y.
<br>006B6BB8  3C 22 59 00 74 22 59 00  &lt;&quot;Y.t&quot;Y.
<br>006B6BC0  A0 2D 5B 00 10 39 5B 00   -[.9[.
<br>006B6BC8  DC 41 5B 00 14 42 5B 00  ЬA[.B[.
<br>006B6BD0  7C 09 5C 00 88 E7 5C 00  |.&#92;.€з&#92;.
<br>006B6BD8  44 89 60 00 7C 87 60 00  D‰`.|‡`.
<br>006B6BE0  98 CF 5F 00 44 9D 5E 00  ?П_.Dќ^.
<br>006B6BE8  8C 8F 60 00 98 D9 69 00  ЊЏ`.?Щi.
<br>006B6BF0  D0 D9 69 00 B8 45 6A 00  РЩi.ёEj.
<br>006B6BF8  40 54 6A 00 B4 54 6A 00  @Tj.ґTj.
<br>006B6C00  8C 82 63 00 A8 64 6A 00  Њ‚c.Ёdj.
<br>006B6C08  6C CF 69 00 C8 B1 60 00  lПi.И±`.
<br>006B6C10  00 B2 60 00 38 B2 60 00  .І`.8І`.
<br>006B6C18  70 B2 60 00 A8 B2 60 00  pІ`.ЁІ`.
<br>006B6C20  38 F3 60 00 78 F3 60 00  8у`.xу`.
<br>006B6C28  78 84 61 00 E4 91 61 00  x„a.д‘a.
<br>006B6C30  64 94 61 00 14 31 62 00  d”a.1b.
<br>006B6C38  A8 94 61 00 D0 95 61 00  Ё”a.Р•a.
<br>006B6C40  98 95 61 00 C0 3A 62 00  ?•a.А:b.
<br>006B6C48  64 2F 62 00 28 95 61 00  d/b.(•a.
<br>006B6C50  CC EF 61 00 08 21 62 00  Мпa.!b.
<br>006B6C58  60 95 61 00 D4 9C 61 00  `•a.Фњa.
<br>006B6C60  14 E2 61 00 64 3B 62 00  вa.d;b.
<br>006B6C68  44 5E 62 00 E4 62 62 00  D^b.дbb.
<br>006B6C70  30 66 62 00 50 CC 69 00  0fb.PМi.
<br>006B6C78  4C 69 62 00 B4 84 69 00  Lib.ґ„i.
<br>006B6C80  8C 6B 62 00 38 86 62 00  Њkb.8†b.
<br>006B6C88  78 86 62 00 C8 A3 62 00  x†b.ИЈb.
<br>006B6C90  EC D0 62 00 14 E6 62 00  мРb.жb.
<br>006B6C98  24 F2 62 00 00 FC 62 00  &#036;тb..ьb.
<br>006B6CA0  34 0F 63 00 34 1C 63 00  4c.4c.
<br>006B6CA8  68 23 63 00 50 34 63 00  h#c.P4c.
<br>006B6CB0  FC 43 63 00 08 53 63 00  ьCc.Sc.
<br>006B6CB8  C0 58 63 00 50 5B 63 00  АXc.P[c.
<br>006B6CC0  C0 63 63 00 A0 6E 63 00  Аcc. nc.
<br>006B6CC8  34 74 63 00 44 7C 63 00  4tc.D|c.
<br>006B6CD0  B8 80 63 00 A4 CB 63 00  ёЂc.¤Лc.
<br>006B6CD8  18 E9 63 00 20 EB 63 00  йc. лc.
<br>006B6CE0  E0 F5 63 00 F8 F8 63 00  ахc.шшc.
<br>006B6CE8  A4 FD 63 00 C4 08 64 00  ¤эc.Дd.
<br>006B6CF0  60 0F 64 00 64 33 64 00  `d.d3d.
<br>006B6CF8  64 3B 64 00 78 3F 64 00  d;d.x?d.
<br>006B6D00  4C 47 64 00 E4 56 64 00  LGd.дVd.
<br>006B6D08  14 5A 64 00 E0 6E 64 00  Zd.аnd.
<br>006B6D10  0C 1A 65 00 80 1A 65 00  .e.Ђe.
<br>006B6D18  C8 C4 65 00 7C B1 66 00  ИДe.|±f.
<br>006B6D20  90 D8 67 00 7C DB 67 00  ђШg.|Ыg.
<br>006B6D28  5C DE 67 00 98 E3 67 00  &#92;Юg.?гg.
<br>006B6D30  30 8D 68 00 68 95 68 00  0Ќh.h•h.
<br>о
<br>Теперь пороверим. CALL EAX падает в двух местах. В одном JMP 180000, а в другом PUSH 1111000. В оригинале дойдём до этих мест и всё, что там делается скопируем в нашу секцию с импортом.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35604&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=18" class="addthx" data-post="35604"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 сентября 2005 00:47 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
<i>SergSh пишет:
<br> На счёт спёртых байт мне кажется здесь этот термин не совсем подходит, т.к. речь идёт о эмуляции основной ветки. </i>
<br>Пожалуй, я с тобой соглашусь. Я то же пришел к примерно такому же мнению. Но я пока не знаю, по какому пути пойти. Кстати нашел англоязычную статью про распаковку 2-го астра, правда там нет VM, но
<br>есть любопытные идеи по поводу обнаружения эмулируемых аспром апи-функций. И применен инлайн-патч. Провда я так и не понял, как его автор использовал. Ведь аспр зачищает свободные участки и проверяет CRC, а приведенный unpack  виснет.
<br>Кстати, а в твоем приведенном выше ответе, что за прога? По тексту не совсем ясно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35695&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=19" class="addthx" data-post="35695"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 сентября 2005 06:14 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
<b>tar4</b>
<br>Уж не J0hnWh0 ли его писал? У него анпак виснет. <img src="img/smilies/s1.gif" alt=""> Если да, то я инлайнил, основываясь на туторах от него и Алекса. Кстати говоря, заинлайнил на ура. <img src="img/smilies/s1.gif" alt=""> Аспр был вроде со всеми защитами. Если что, пиши в личку, хотя могу и тут пофлудить. <img src="img/smilies/s1.gif" alt=""> CRC частей не мешает инлайнить никак, а файла образ патчиться перед крк, инлайник вышел примерно на 1-1.5 экрана в Оле.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35704&amp;user=1556&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=20" class="addthx" data-post="35704"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2005 09:01 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
Вроде заработала. Делал Так:
<br>1. Делаем проход как обвычно. После останова на секции кода смотрим ESP-8, там VEOP. Переходим на VEOP и запоминаем команды которые там находятся. Перепускаем прогу. В окне
<br>дампа пишим D addr VOEP и Shift+9 пока не увидим распакованные команды с VEOP. Далее переходим на адрес 00401000 делаем поиск келов, восстанавливаем импорт и сниваем дамр.
<br>2. Т.к. протектор должен работать с разными прграммами, то можносделать вывод, что начало 
<br>программ у всех будет одинаковое мне понравилось преведённое выше. Остановимся подробнее
<br>на восстановлении CALL EAX. Делаем обыкновенный проход, жмём  Shift+9 пока не дайдём до 403В78 ниже видем  CALL EAX, кстати пока идём видим какие подпрограммы должны присутствовать в нашем коде. С  403В78 трассируем по F7. Заходим в CALL EAX трассируем по F7. Трассируем пока не увидим код типА:
<br>L000:
<br>  SUB ESI,DWORD PTR DS:[ECX]
<br>  JMP L003
<br>  ???
<br>L003:
<br>  LEA ECX,DWORD PTR DS:[ECX+EBP+3]
<br>  SUB ECX,EBP
<br>  CMP ECX,EBX
<br>  JB L000
<br>Это уловка аспра самосканирующий код, bc ставить нельзя, поэтому ставим бряк на доступ
<br>SBB EBX,F1105286
<br>и после его сработки трассируем по F7 пока в ECX не станет адрес следующей команды. После этого смело F2 на адрес  SBB EBX,F1105286 бряк сработал, убрали его. Трассируем по F7 пока 
<br>не увидим код:
<br>  POP ESI
<br>  ADD EBX,EDI
<br>  POP EBX
<br>  ADD EBP,DWORD PTR DS:[EDI+10]
<br>  CALL EBP - здесь идёт выполнение интересующих нас келов
<br>  PUSH DWORD PTR SS:[ESP+20]
<br>  LEA EBP,DWORD PTR DS:[EDI+EAX]
<br>Чтобы не восстанавливать их в ручную напишем маленький скрипт:
<br>var temp
<br>var startscan 
<br>var d 
<br>var prg 
<br>mov d,0
<br>mov prg,0
<br>mov temp,7B1000 //сюда будем писать восстанавливаемые келы 
<br>r:
<br>mov startscan, 12000F3 // мой адрес CALL EBP 
<br>bphws startscan, &quot;x&quot; //Установили брейкпоинт на CALL EBP 
<br>run 
<br>bphwc startscan //Убрали брейкпоинт с CALL EBP
<br>add d,1
<br>cmp d,3
<br>jae r
<br>mov prg,eax
<br>cmp prg,11E0860 //Это адрес последнего последнего закодированного кела 
<br>je rr
<br>mov [temp],ebp
<br>add temp,4
<br>mov d,0
<br>jmp r
<br>rr:
<br>ret 
<br>Приметивно, но работает. Прога запустится и поадресу 7B1000 будет восстановленнфя таблица
<br>CALL EAX, которая приведено выше. Копируем таблицу и вставляем в наш дамп. Колличество циклов можно подсчитать. Далее трассируем CALL EAX, прога упадёт пару раз это все восстановите сами. Прога упадет на функии по адресу 407664-её затёр ImportREC восстановите её. Далее:
<br>/*7B1018*/  XOR EAX,EAX
<br>/*7B101A*/  MOV DWORD PTR SS:[ESP+8],Dumped_.00403A34
<br>/*7B1022*/  CALL Dumped_.006B54E4
<br>/*7B1027*/  CALL Dumped_.006B6394
<br>По адресам 6b5f0b и 6b5fe6 происходит проверка контрольной суммы. Просто поставте своё значение. Всё прга работае. Концовку допишете сами.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35757&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=21" class="addthx" data-post="35757"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 сентября 2005 07:04 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
[i]SergSh пишет:
<br>/*7B1009*/ XOR EAX,EAX 
<br>/*7B100B*/ MOV DWORD PTR SS:[EBP-10],EAX  и так далее
<br>Я не все понял из твоего описания.
<br>Ты откуда взял этот код? Или просто написал стандартное начало проги? Половину из этого я нашел, а половину нет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35951&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=22" class="addthx" data-post="35951"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 сентября 2005 21:31 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
Т.к. протектор должен работать с разными прграммами, то можно сделать вывод, что начало 
<br>программ у всех будет одинаковое мне понравилось преведённое выше. А если быть точным, я взял его с
<br>NotesHolder.exe.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=36032&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=23" class="addthx" data-post="36032"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2005 03:05 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#24');return false;">#24</a> </span><div align=left><br>
Попробовал поиграться с распакованной пргой, а она падает. Вижу, что это связано с GetTickCount, но пока ничего не выходит. Если не подает так минюшка моргает. Кто-нибудь знает, как этого избежать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=36048&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=24" class="addthx" data-post="36048"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2005 02:56 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#25');return false;">#25</a> </span><div align=left><br>
Так и не разобрался, но исё равно победил. Просто занопил call по адресу 68A8B4. Концовку долго думать не стал:
<br>/*7B102C*/  CALL Dumped_.0040913C
<br>/*7B1031*/  CALL Dumped_.006B64C0
<br>/*7B1036*/  PUSH EAX
<br>/*7B1037*/  CALL DWORD PTR DS:[&lt;&amp;kernel32.ExitProcess&gt;]
<br>Всё работает. Может кто-нибудь ещё предложит подобную прогу, для закрепления изученного материала.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=36184&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=25" class="addthx" data-post="36184"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2005 06:43 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#26');return false;">#26</a> </span><div align=left><br>
<i>SergSh пишет:
<br>Так и не разобрался, но исё равно победил </i>
<br>Пошел по твоему описанию этой проги. Ну, вообще, там очень много подводных камней. 
<br>Прошел всю таблицу CALL EAX. И остановился на адресе
<br>006B5045   8B15 28216D00    MOV EDX,[DWORD DS:6D2128]          ;  в EDX пишется 006D1CFC
<br>006B504B   8B12             MOV EDX,[DWORD DS:EDX]             ;  [edx] =01173A29 - нет в дампе
<br>006B504D   E8 06F0D4FF      CALL d_oleaut.00404058             ;  там падает
<br>Копировать всю секцию 01170000 в дамп не хочется, а в чем причина - пока разобраться не могу.
<br>Ты как прошел это место.
<br>И насчет закрепления материала.
<br>Я выше по тексту, в этом топике указывал прогу - www.webfile.ru/513652. Там самое необходимое, 
<br>в минимальной конфигурации. Тот же аспр, та же VM. Тем более, мне она нужна. Давай ее. Я все равно собираюсь с ней разбираться. Если ссылка уже не действует, я обновлю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=36214&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=26" class="addthx" data-post="36214"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2005 08:43 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#27');return false;">#27</a> </span><div align=left><br>
Это потому, что ты не с того места дампил, смотри пункт 1.
<br>Но это можно поправить, дойди до момента когда VOE сформировалось и посмотри, что в 006D1CFC там будет то, что тебе нужно. Скопируй их и байты выше, где FFFFFFFFFFF, тем самым обнулится счётчик дней. И вставь всё это в свой дамп.
<br>Ссылка битая, файл удалён.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=36226&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=27" class="addthx" data-post="36226"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2005 20:16 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#28');return false;">#28</a> </span><div align=left><br>
Я обновил ссылку webfile.ru/534538
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=36279&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=28" class="addthx" data-post="36279"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 сентября 2005 06:04 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#29');return false;">#29</a> </span><div align=left><br>
<i>SergSh пишет:
<br>Просто занопил call по адресу 68A8B4. Концовку долго думать не стал: 
<br>/*7B102C*/ CALL Dumped_.0040913C </i>
<br>Вообщем,я почти до конца дошел, но концовка так и не получилось. Где-то, перед  самым открытием 2-го окна.
<br>По этому адресу 68A8B4 нет у меня CALL.
<br>Не могу закончить выполнение функции /*7B1027*/ CALL Dumped_.006B6394.
<br>В системной библиотеке вызывается Int 2E  и на ней падает. А в оригинале появляется 2-е окно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=36334&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=29" class="addthx" data-post="36334"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 сентября 2005 08:59 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#30');return false;">#30</a> </span><div align=left><br>
Ничего подобного не видел. Дай адресок по ближе к теме, т.к CALL Dumped_.006B6394 и есть сама программа. Проверку контрольной суммы исправил?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=36343&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=30" class="addthx" data-post="36343"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 сентября 2005 20:36 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=1#31');return false;">#31</a> </span><div align=left><br>
VОЕР после прохода в ESP+4c. Прога Microsoft Visual C++ 6.0. IAT целая. Обкод для восстановления функций IAT сегодня FF15.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=36384&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=1&amp;anchor=31" class="addthx" data-post="36384"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка AsProtect &gt;1.23 - от А до Я.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="2707">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=2707" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
