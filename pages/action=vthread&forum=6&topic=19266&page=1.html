<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Обработка memory (и не только) break&#039;ов с помощью VEH - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT=" Как я себе это представляю: 1. Прога ставит бряки и внедряет либу в процесс-жертву 2. Либа устанавливает VEH 3. Когда возникает исключение, прога должна каким-то образом получить от внедренной DLL-ки EXCEPTION_RECORD с кодом">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55953'>laslo</a>, <a target='_blank' href='?action=userinfo&amp;user=1288'>UniSoft</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Обработка memory (и не только) break&#039;ов с помощью VEH</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=19266&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=19266&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=6&amp;topic=19266&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=6&amp;topic=19266&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]GoldenJoe[/b]','')">GoldenJoe</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.66'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=30679">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 ноября 2011 21:43 &middot; Поправил: GoldenJoe <br><script type="text/javascript">QU('GoldenJoe','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GoldenJoe" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
<img src="img/smilies/s1.gif" alt=""><br>Как я себе это представляю:<br>1. Прога ставит бряки и внедряет либу в процесс-жертву<br>2. Либа устанавливает VEH<br>3. Когда возникает исключение, прога должна каким-то образом получить от внедренной DLL-ки EXCEPTION_RECORD с кодом исключения и прочей инфой. Прога должна проверить, а наш ли это бряк (а, может, совсем даже не бряк <img src="img/smilies/s1.gif" alt=""> ) и неведомым образом сообщить внедренной либе, что делать дальше (CONTINUE_SEARCH или CONTINUE_EXECUTION вернуть, например).<br><br>По первым двум пунктам вопросов нет. С 3 пунктом посложнее. Есть именованный FileMapping да event-ы, есть сокеты. А КРАСИВЫХ решений, я так понимаю, нет?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295526&amp;user=30679&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=1" class="addthx" data-post="295526"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 12:02 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
<I>bowrouco пишет:<br>Гдеже ответ то ?  </I><br>Так я в бане был. Да и вообще с тобой общаться неприятно, как до конкретики доходит ты дурака включаешь и сливаешься.<br><br><I>bowrouco пишет:<br>Ну например при вызове сискола с TF возникает задержка, гдето в полтора раза медленее. </I><br>Это только в твоих гавнотехнологиях подходит, в коммерческой (да есть такое слово) защите нельзя использовать шаманство с замерами, если они только не составляют несколько секунд, да и то...<br><br><I>bowrouco пишет:<br>Или например баг приводящий к дедлоку(генерация любого исключения, кроме #DB с TF) позволяет определить TF. </I><br>На старых виндах и под некоторыми VM это не так, поэтому так же относится к разряду твоих гавнотехнологий.<br><br><I>bowrouco пишет:<br>Вот есчо пример - ...</I><br>Дальше пошло нереализуемое в юзермоде гавно.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295882&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=2" class="addthx" data-post="295882"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 12:18 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>&gt; На старых виндах и под некоторыми VM это не так, поэтому так же относится к разряду твоих гавнотехнологий.<br><br>Это никак с VM не сязано. Сие во всей линейке NT, это вызывает некоторые проблемы часто.<br><br>&gt; Дальше пошло нереализуемое в юзермоде гавно. <br><br>100% рабочий код:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">RPL_MASK&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_number">11B</span>&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">cx</span><span class="hl_char">,</span>RPL_MASK&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr"><b>gs</b></span>&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_registr"><b>eax</b></span>&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">gs</span><span class="hl_char">,</span><span class="hl_registr"><b>cx</b></span>&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span><span class="hl_registr"><b>gs</b></span>&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">gs</span><span class="hl_char">,</span><span class="hl_registr"><b>cx</b></span>&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">dx</span><span class="hl_char">,</span><span class="hl_registr"><b>gs</b></span>&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">gs</span><span class="hl_char">,</span><span class="hl_registr"><b>cx</b></span>&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">cx</span><span class="hl_char">,</span><span class="hl_registr"><b>gs</b></span>&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span><span class="hl_registr"><b>cx</b></span>&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span><span class="hl_registr"><b>dx</b></span>&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>setz</b></span>&nbsp;<span class="hl_registr"><b>al</b></span>&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">gs</span></li>        </ol>
    </div>
</div></div>
<br><br>Не зависящий вообще от оси. Результат работы будет один и тотже что в линусе, что в нт. Вы не можите ничего на это ответить, единственный ваш аргумент - говно ибо придумал инде.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295886&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=3" class="addthx" data-post="295886"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 12:56 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
И где здесь генерация исключения? В примере достаточно временно перейти на int3, что всё равно нужно делать для ss сегмента и pushfd/popfd инструкций.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295895&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=4" class="addthx" data-post="295895"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 13:17 &middot; Поправил: bowrouco <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>Нет тут исключений. Если хотите исключение - макро PKITRAP. Я просто этим примером дал вам понять что вы не правы. А вновь за своё - не годно, ибо нет фолта <img src="img/smilies/s15.gif" alt=""><br><br>&gt; что всё равно нужно делать для ss сегмента и pushfd/popfd инструкций.<br><br>Поясните, не понятно. куда перейти и причём сегмент стека ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295902&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=5" class="addthx" data-post="295902"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]0x90h[/b]','')">0x90h</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.48'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=27614">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 13:51 &middot; Поправил: 0x90h <br><script type="text/javascript">QU('0x90h','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0x90h" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
На правах оффтопа чайника:<br><b>bowrouco</b><br>Это определение LDT? vbox, аппаратная виртуализация intel (по дефолту), не работает. vmware 7, аналогично, но с шаманством. а 100% метод определить ВМ есть?<br><br><b>PE_Kill</b><br>Если все это происходит от tf в обработчике сепшина, не проще-ли сразу манипулировать/эмулировать контекстом выполнение &quot;нежелательных&quot; инструкций?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295905&amp;user=27614&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=6" class="addthx" data-post="295905"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 14:07 &middot; Поправил: bowrouco <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<b>0x90h</b><br><br>&gt; Это определение LDT?<br><br>Нет, причём виртуализация к трейсу. Код выше основан на особенности камня, исполняя iret или retf при смене кпл камень обнуляет рпл поле для нудевых селекторов за ненадобностью. А трейс сопровождается генерацией трапа и возвратом из ядра через iret со сменой кпл.<br><br>&gt; Если все это происходит от tf в обработчике сепшина, не проще-ли сразу манипулировать/эмулировать контекстом выполнение &quot;нежелательных&quot; инструкций?<br><br>Это вас запутает. Увидев этот код:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;IRET_FRAME&nbsp;struct</li><li class="hl_l1">&nbsp;rEip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PVOID&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;rSegCs&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;rEFlags&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;IRET_FRAME&nbsp;<span class="hl_function">ends</span></li><li class="hl_l1">&nbsp;PIRET_FRAME&nbsp;typedef&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;IRET_FRAME</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;<span class="hl_comment">; +</span></li><li class="hl_l0">&nbsp;<span class="hl_comment">; Для предотвращения трассировки диспетчера изза T-бага в ядре, откатываем трап.</span></li><li class="hl_l1">&nbsp;<span class="hl_comment">; Это макро определяет адрес трапа, при котором его нужно пропустить сбросив TF.</span></li><li class="hl_l0">&nbsp;<span class="hl_comment">; Возвращает:</span></li><li class="hl_l1">&nbsp;<span class="hl_comment">; Eax - адрес второй инструкции диспетчера исключений.</span></li><li class="hl_l0">&nbsp;<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;<span class="hl_char">%</span>PKITRAP&nbsp;<span class="hl_function">macro</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>Local</b></span>&nbsp;kitrap_safe</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;<span class="hl_comment">; Адрес трапа будет возвращаться в этот фрейм.</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>Call</b></span>&nbsp;@f</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;kitrap_safe</li><li class="hl_l1">&nbsp;@@<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>Call</b></span>&nbsp;@f</li><li class="hl_l1">&nbsp;<span class="hl_comment">; SEH()</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">3</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;EXCEPTION_RECORD<span class="hl_char">.</span>ExceptionCode<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span>STATUS_SINGLE_STEP</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>CONTEXT<span class="hl_char">.</span>regEip<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; IRET-frame.</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>assume</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">:</span>PIRET_FRAME</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function"><b>if</b></span>&nbsp;Zero<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">]</span><span class="hl_char">.</span>rEip</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>ecx</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function">else</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">]</span><span class="hl_char">.</span>rEip</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function">endif</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>btr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">]</span><span class="hl_char">.</span>rEFlags<span class="hl_char">,</span><span class="hl_number">8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; !EFLAGS_TF</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>retn</b></span>&nbsp;<span class="hl_number">4</span><span class="hl_char">*</span><span class="hl_number">4</span></li><li class="hl_l1">&nbsp;@@<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;<span class="hl_comment">; TEB.Tib.ExceptionList</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">esp</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;EFLAGS_TF&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;EFLAGS_IF&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;EFLAGS_MASK</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">popfd</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">cli</span></li><li class="hl_l1">&nbsp;kitrap_safe<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;<span class="hl_function">endm</span></li>        </ol>
    </div>
</div></div>
<br>Вы сразу и не поймёте что он делает и как сие обойти. А так да, можно конечно потыкать напрямую контексты. Кстате можно использовать пятиэтажный вызов теневых колбеков, в этом случае из юзермода невозможно будет трейсить код - контекстом манипулирует ядро и он не доступен из юзермода. Но реализация немного сложнее.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295909&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=7" class="addthx" data-post="295909"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 14:48 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
Блин Клерк, я как будто с глухим разговариваю. Ты писал, что <br><br><I>bowrouco пишет:<br>Или например баг приводящий к дедлоку(генерация любого исключения, кроме #DB с TF) позволяет определить TF. </I><br><br>На что я ответил:<br><I>PE_Kill пишет:<br>Это только в твоих гавнотехнологиях подходит, в коммерческой (да есть такое слово) защите нельзя использовать шаманство с замерами, если они только не составляют несколько секунд, да и то...<br> </I><br><br>На что ты отписал и запостил код:<br><I>bowrouco пишет:<br>Это никак с VM не сязано. Сие во всей линейке NT, это вызывает некоторые проблемы часто. </I><br><br>Я утверждаю, что пример с дидлоками на разных виндах и ВМ работает по разному, если ты так уверен в своей правоте можем заключить пари, скажем на 1к бачинских.<br><br><I>bowrouco пишет:<br>Поясните, не понятно. куда перейти и причём сегмент стека ?  </I><br>Для ламерофф поясняю, манипуляции с ss типа pop ss невозможно трассировать через трап, нужно использовать брейкпоинты.<br><br><I>bowrouco пишет:<br>Это вас запутает. Увидев этот код: </I><br>Это никого не запутает, т.к. все убедились, что ты генеришь только гавнокод, сталобыть разбираться в нем нет смысла.<br><br><I>0x90h пишет:<br>а 100% метод определить ВМ есть? </I><br>У меня есть, определяет любую ВМ типа VmWare, VBox, etc, но не бесплатно.<br><br><I>0x90h пишет:<br>Если все это происходит от tf в обработчике сепшина, не проще-ли сразу манипулировать/эмулировать контекстом выполнение &quot;нежелательных&quot; инструкций?<br> </I><br>Так можно и проще, это я для гавно-клерка отвечал.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295914&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=8" class="addthx" data-post="295914"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 15:08 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>&gt; Я утверждаю, что пример с дидлоками на разных виндах и ВМ работает по разному<br><br>Это не зависит от вм. Если она нормально обрабатывает трапы, тоесть при срабатывании ловушки корректно сохраняет флажки в стеке. У вари с этим нет проблем. Кстати изза хитроумной её реализации и код выше(с селекторами) на ней хорошо исполняется. Про пари с вами бессмысленно спорить - всегда найдётся какаянибудь кривая вм.<br><br>&gt; разбираться в нем нет смысла.<br><br>Это не ответ. За всех не отвечайте, хотя бы только за себя. А гавном кидать в меня бессмысленно. Кстате если про шадов сказать, то весь ваш опыт окажется не достаточным для понимания как такой детект исполняется, ибо шадов это довольно сложный механизм, по большей части ядерный.<br><br>&gt; У меня есть, определяет любую ВМ типа VmWare, VBox, etc, но не бесплатно.<br><br>Взять порт(железо) прочитать какойнибудь или мср заюзать. Спасибо, можно не благодарить <img src="img/smilies/s6.gif" alt=""><br><br>&gt; гавно-клерка<br><br>Обоснуйте почему это так. Полностью рабочий код. Для закрытия бага, если вы это не юзали и чтото в юзермоде трейсили, то получается это ваш код говно, ибо он повесит поток при возникновении любого фолта.<br><br>&gt; манипуляции с ss типа pop ss невозможно трассировать через трап, нужно использовать брейкпоинты.<br><br>Это хорошо что вы вкурсе про загрузку ss, в манах это писано чёрным по белому. Вот только отношения это не имеет к #3.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295920&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=9" class="addthx" data-post="295920"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 15:31 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
<I>bowrouco пишет:<br>Про пари с вами бессмысленно спорить - всегда найдётся какаянибудь кривая вм.<br> </I><br>Ну ясно снова соскок. Хех, тут ничего не поделаешь, как обычно.<br><br><I>bowrouco пишет:<br>Взять порт(железо) прочитать какойнибудь или мср заюзать. Спасибо, можно не благодарить </I><br>Бред, какой порт, какой мср? Типа все ВМ дают прочитать какой то порт? Проспись. У меня есть десяток строк на масме, которые детектят ЛЮБУЮ вм, причем не по всяким там ненормальным адресам, офсетам, сигнатурам, портам,... и не привязан к какой либо ВМ.<br><br><I>bowrouco пишет:<br>Полностью рабочий код. </I><br>На моей Win7 x64 не работает, система не дает освободить память образа. Т.е. это даже не хардкод, это система безопасности, поэтому сказать - ПОЛНОСТЬЮ рабочий код, признать себя ламером.<br><br><I>bowrouco пишет:<br>Это хорошо что вы вкурсе про загрузку ss, в манах это писано чёрным по белому. </I><br>Только вот ты почему то не в курсе, раз спрашивал у меня. Эх илита, таже выкрутиться не смог.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295924&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=10" class="addthx" data-post="295924"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 16:08 <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
когда же вам обоим это надоест <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295929&amp;user=10534&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=11" class="addthx" data-post="295929"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 16:13 &middot; Поправил: bowrouco <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>&gt; Бред, какой порт, какой мср?<br><br>Да любой подходящий. Ну CMOS например я не знаю, это нужно выбрать подходящий. Варя элементарно так детектится, даже через мср, прочие вм я не юзаю.<br><br>&gt; У меня есть десяток строк на масме, которые детектят ЛЮБУЮ вм<br><br>Я не отрицаю, возможно.<br><br>&gt; На моей Win7 x64 не работает<br><br>Вы не в той архитектуре запускается, на вайне оно тоже наверно не будет работать. Для начала это 32-х битный код, вы же знаете, зачем претворяться дураком.<br><br>&gt; Только вот ты почему то не в курсе, раз спрашивал у меня.<br><br>Я не спрашивал, привёл в пример код, а вы на него какойто бред ответили про Ss и Int3.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295931&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=12" class="addthx" data-post="295931"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Alchemistry[/b]','')">Alchemistry</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 145.8 (ветеран), 191thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.05'>Активность: 0.14<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=21411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 16:29 <br><script type="text/javascript">QU('Alchemistry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alchemistry" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<I>bowrouco пишет:<br>Вы не в той архитектуре запускается, на вайне оно тоже наверно не будет работать. Для начала это 32-х битный код, вы же знаете, зачем претворяться дураком. </I><br><br>Такое понятие как вот это код только для х86, а это для х64 не должно вообще быть. Грамотно написанный код не требует допилов при компиляции под другую архитектуру как в данном случае х64. В моем случае я просто переключу профиль в студии на х64 и получу готовый, рабочий х64 бинарник. А тебе придется все переписывать заново. Где профит? Это какая-то садомаза для людей с кучей свободного времени.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295935&amp;user=21411&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=13" class="addthx" data-post="295935"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 16:31 &middot; Поправил: bowrouco <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
<b>Alchemistry</b><br><br>&gt; А тебе придется все переписывать заново.<br><br>Да, мне придётся переписывать на 64, это же не скрипт, а асм. У меня куча свободного времени, почти всё время я свободный. И пишу на асме потомучто мне это <u>нравится</u>, а не для того чтобы сделать какойто портабельный продукт и далее его продавать. Если нужно будет такое, я заюзаю скрипт.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295936&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=14" class="addthx" data-post="295936"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 17:04 &middot; Поправил: PE_Kill <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
<I>bowrouco пишет:<br>Да любой подходящий. Ну CMOS например я не знаю, это нужно выбрать подходящий. Варя элементарно так детектится, даже через мср, прочие вм я не юзаю. </I><br>Ну-ну, давай очень интересно, как ты считаешь в ринг3 через мср и 100% скажешь что это ВМ, не VmWare, а именно любая ВМ. Не шаришь не пиши.<br><br><I>bowrouco пишет:<br>Вы не в той архитектуре запускается, на вайне оно тоже наверно не будет работать. Для начала это 32-х битный код, вы же знаете, зачем претворяться дураком.<br> </I><br>Илита должна знать, что x32 запускается на x64 в режиме эмуляции и все x32 программы работают в этом режиме, кроме твоих поделок, так что дураком здесь прикидываешься ты, как и всегда впрочем. Ну а если уж прям для натив x32 исключительно хардкод, то на win2000 тоже не запускается, хотя это самый что ни на есть натив x32, давай говори, что win2k гавно, илита ее не юзает.<br><br><I>bowrouco пишет:<br>Я не спрашивал, привёл в пример код, а вы на него какойто бред ответили про Ss и Int3.  </I><br><I>PE_Kill пишет:<br> В примере достаточно временно перейти на int3, что всё равно нужно делать для ss сегмента и pushfd/popfd инструкций.<br> </I><br><I>bowrouco пишет:<br>Поясните, не понятно. куда перейти и причём сегмент стека ?  </I><br>Когда говорят про трап и ss других ассоциаций просто быть не может, не надо прикидываться дураком.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295949&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=15" class="addthx" data-post="295949"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 17:11 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>В юзермоде нет прав для I/O, это только в младших версиях доступно. Я имел ввиду из под ядра. Универсального способа обнаружить любую вм я не знаю, есть некоторые основанные на багах. Хорошо что вы знаете, что есчо не факт, хотя мне както всёравно.<br><br>&gt; win2000 тоже не запускается<br><br>Там вроде должны быть апи в импорте, ExitProcess() вроде как. Я его никогда в семплы не вставляю, хотя знаю что нужно.<br><br>&gt; что x32 запускается на x64 в режиме эмуляции<br><br>Стоит заметить что в режиме кривой эмуляции. Выше я уже писал.<br><br>&gt; Когда говорят про трап и ss других ассоциаций просто быть не может, не надо прикидывать дураком. <br><br>Вы ответили это про код со сбросом RPL:<br><br>&gt; И где здесь генерация исключения? В примере достаточно временно перейти на int3..<br><br>Тоесть каким оно боком относится не понятно. Да и смысл фразы я так и не понял.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295950&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=16" class="addthx" data-post="295950"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 17:26 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
<I>bowrouco пишет:<br>Там вроде должны быть апи в импорте, ExitProcess() вроде как. </I><br>Ну илите то не знать, что экспортируемого VEH в win2k нет, причем тут импорт. Да еще и ExitProcess- это вообще жесть.<br><br><I>bowrouco пишет:<br>Стоит заметить что в режиме кривой эмуляции. Выше я уже писал. </I><br>Только почему то кривая эмуляция отрабатывает для всех приложений кроме ваших, ну да если ваше не эмулится то эмуль кривой, надо было догадаться.<br><br><I>bowrouco пишет:<br>Тоесть каким оно боком относится не понятно. Да и смысл фразы я так и не понял.  </I><br>Ну тут попрактиковаться нужно, одной теории тут недостаточно.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295955&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=17" class="addthx" data-post="295955"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 17:33 &middot; Поправил: bowrouco <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>Про VEH я знаю, забыл правдо. Шим например в XP делает выбор - определяет версию и если она младшая, то ставит UEF вместо VEH. Я это никогда не использую, ибо нет смысла. Некоторые пишут код рабочим даже на 98.<br><br>&gt; ExitProcess- это вообще жесть.<br><br>В одной из младших версия приложение не запускалось, если в импорте небыло этой апи.<br><br>&gt; Ну тут попрактиковаться нужно, одной теории тут недостаточно. <br><br>Можно писать всё подряд, как это инфы делают. Теория теорией, но всёже обьясните, интересно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295956&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=18" class="addthx" data-post="295956"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 17:40 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
<I>bowrouco пишет:<br>Теория теорией, но всёже обьясните, интересно.  </I><br>Нет, вы не достойны, т.к. илита и мне до вас далеко.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295958&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=19" class="addthx" data-post="295958"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 17:43 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>Бред потому что код выше ss не перезагружает, вот и всё.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295960&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=20" class="addthx" data-post="295960"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 17:49 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
<I>bowrouco пишет:<br>Бред потому что код выше ss не перезагружает, вот и всё.  </I><br>Ну так там ss и нет, или ты сам не видишь, что пишешь?<br><br>Так и быть расшифрую. Твой код нужно трассировать брейкпоинтами, как и манипуляции с ss и eflags, причем последнее нужно делать 100%, поэтому и для твоего кода не проблема реализовать трассировщик. Не знаю как еще понятнее.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295963&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=21" class="addthx" data-post="295963"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 17:56 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>Ну теперь понятно. Сразу нельзя было нормально ответить.. Вообще то я рассматривал обычную трассировку, та которая #DB через TF. Инты в коде и другие инструкции фолт генерящие не совсем корректно называть трассировкой. Можно вообще копировать код поблочно и исполнять в буфере, либо пойти дальше и эмулировать, как это олли делает. Всёже это будет не трейс. Код выше определяет трассровку обычную, через TF и хард брейк тоже задетектит. А на счёт точек останова через инты - я создал тему про патчи, где подробно показал как с этим можно в юзермоде бороться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295966&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=22" class="addthx" data-post="295966"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 17:59 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
Так мы на этой странице и обсуждали как прятать TF, короче как обычно увел всё на другое. Оля как раз и ставит бряки, где TF может спалиться/пролететь.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295967&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=23" class="addthx" data-post="295967"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 18:02 &middot; Поправил: bowrouco <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#24');return false;">#24</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>Обсуждали TF, а вы перешли на патчи снова - инты. Используя RE проекцию запись в память станет невозможна. Олли с этим не справляется. На скрине F8.<br><br><img src="img/attach.gif" alt=""> <a href="./files/2b81_19.11.2011_EXELAB.rU.tgz">2b81_19.11.2011_EXELAB.rU.tgz</a> - 1.png
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295968&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=24" class="addthx" data-post="295968"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Alchemistry[/b]','')">Alchemistry</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 145.8 (ветеран), 191thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.05'>Активность: 0.14<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=21411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 18:13 <br><script type="text/javascript">QU('Alchemistry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alchemistry" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#25');return false;">#25</a> </span><div align=left><br>
<I>bowrouco пишет:<br>&gt; win2000 тоже не запускается<br><br>Там вроде должны быть апи в импорте, ExitProcess() вроде как. Я его никогда в семплы не вставляю, хотя знаю что нужно. </I><br><br>Странно что илита об этом не знает. В Windows NT4.0/2000 есть ошибка в реализации CreateProcess, приходится таскать kernel32.dll
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295969&amp;user=21411&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=25" class="addthx" data-post="295969"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 18:14 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#26');return false;">#26</a> </span><div align=left><br>
<b>Alchemistry</b><br><br>Я не помню всего, если вы хотите меня на чёмто словить - я не машина и тоже могу ошибаться и забывать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295970&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=26" class="addthx" data-post="295970"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 18:46 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#27');return false;">#27</a> </span><div align=left><br>
Клерк не робот? Не знал.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295975&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=27" class="addthx" data-post="295975"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 19:26 <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#28');return false;">#28</a> </span><div align=left><br>
2PE_Kill<br>&quot;У меня есть десяток строк на масме,которые детектят ЛЮБУЮ вм...&quot; при отключенном кэше это нереально. при включенном детектится любая вм в 3 строчки. но это из существующих. теоретически эмуляция кэша тоже возможна, только накладно. Думаю ты преувеличиваешь возможности своего кода. Хотя... Раз детект 100% стабильно, тебе ведь ничто не мешает выложить кодес? Если что-то мешает - значит детект не 100%, а рассчитан на недостатки эмуляции.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295979&amp;user=22831&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=28" class="addthx" data-post="295979"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 19:32 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#29');return false;">#29</a> </span><div align=left><br>
<b>spinz</b><br>Выше <b>PE_Kill</b> написал:<br><br><i class=x>У меня есть, определяет любую ВМ типа VmWare, VBox, etc, но не бесплатно.</i><br><br>Платите бабосы. Как там было: &quot;Любой каприз...&quot; (с) <b>PE_Kill</b>.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295980&amp;user=6336&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=29" class="addthx" data-post="295980"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 19:53 &middot; Поправил: spinz <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#30');return false;">#30</a> </span><div align=left><br>
Епта, я вам выложу несколько строчек забесплатно. Которые детектят любые из существующих вм, хоть хардовые, хоть как борщ софтовые.  Хотя может пекилл заплатит чтобы я не выкладвал? <img src="img/smilies/s6.gif" alt=""><br>Забыл. В ядре.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295982&amp;user=22831&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=30" class="addthx" data-post="295982"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2011 20:05 &middot; Поправил: PE_Kill <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=1#31');return false;">#31</a> </span><div align=left><br>
<I>spinz пишет:<br>Забыл. В ядре.  </I><br>С этого и надо было начинать, я в ядро не лезу. Так что выкладывай, мне пох.<br><br><I>spinz пишет:<br>Раз детект 100% стабильно, тебе ведь ничто не мешает выложить кодес? </I><br>На понт детей лови, мне пох.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295984&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=1&amp;anchor=31" class="addthx" data-post="295984"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=19266&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=19266&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=6&amp;topic=19266&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=6&amp;topic=19266&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Обработка memory (и не только) break&#039;ов с помощью VEH</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="19266">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19266" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
