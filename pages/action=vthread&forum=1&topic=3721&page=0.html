<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Автоматическое применение структур в IDA - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="После дизассемблирования программы есть такие стоки:      mov   edx, [ebp+var_40]    mov   edx, [edx+8]    Call   ... при этом я знаю, что var_40 - это ни что иное, как объект TList, для которого я создаю структуру по смещению 8">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41556'>subword</a>, <a target='_blank' href='?action=userinfo&amp;user=55853'>rtsgreg1989</a>, <a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Автоматическое применение структур в IDA</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=1&amp;topic=3721&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=1&amp;topic=3721&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]qvant[/b]','')">qvant</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.5'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3478">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2006 17:33 <br><script type="text/javascript">QU('qvant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=qvant" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
После дизассемблирования программы есть такие стоки:
<br><code>   
<br>       mov     edx, [ebp+var_40]
<br>       mov     edx, [edx+8]
<br>       Call      ...
<br></code>
<br>при этом я знаю, что var_40 - это ни что иное, как объект TList, для которого я создаю структуру по смещению 8 байт которой хранится количество элементов. 
<br>Вопрос: как один раз обозначить, что [ebp-var_40] - это адрес моей структуры, и все относительные ссылки автоматически заменить на что-то типа mov edx,[edx+pTList.Count]?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=50317&amp;user=3478&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=1" class="addthx" data-post="50317"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 января 2006 00:43 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Да, хороший вопрос, жаль ни кто не хочет отвечать. По моему тут ИДУ не очень любят. Больше предпочитают Олю. <img src="img/smilies/s2.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=50560&amp;user=702&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=2" class="addthx" data-post="50560"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 января 2006 00:54 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>qvant</b>
<br>Ну а навести мышь на var_40 и сделать Rename не катит разве?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=50561&amp;user=24&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=3" class="addthx" data-post="50561"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]TOG[/b]','')">TOG</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/2440.jpg" alt=""><br><span class=txtSm>Ранг: 84.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.89'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2440">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 января 2006 07:41 <br><script type="text/javascript">QU('TOG','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TOG" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Да, если попросить Иду применять различные сигнатуры, то иногда такого эффекта добиться можно, но не факт.
<br>Для того, чтобы Ида автоматически не применяла никаких сигнатур, во время открытия файла, отмени чекбокс &quot;Analysis Enabled&quot;. А потом сам выбирай из списка сигнатуры и применяй. (Open signatures window)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=50583&amp;user=2440&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=4" class="addthx" data-post="50583"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]qvant[/b]','')">qvant</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.5'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3478">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 января 2006 10:58 <br><script type="text/javascript">QU('qvant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=qvant" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Ara пишет:
<br>Ну а навести мышь на var_40 и сделать Rename не катит разве? </I>
<br>
<br>Речь не об этом.. Смотри, есть код:
<br><code>
<br>mov edx, [ebp+var_40] 
<br>mov eax, [edx+8] 
<br>Call ...
<br></code>
<br>Первая строка помещает в edx указатель на мою структуру. Структуру, которую я сам создал в ИДА, выглядит она приблизительно так:
<br>
<br>pTList       struc ; (sizeof=0x10)
<br>field_0         dd ?
<br>field_4         dd ?
<br>Count          dd ?
<br>field_C         dd ?
<br>pTList       ends
<br>
<br>Вторая строка, т.е. mov eax,[edx+8] помещает значение поля Count моей структуры в eax. 
<br>var_40 я понятное дело переименую во что-то типа TList, но хочется показать иде, что в edx указатель на мою структуру и соответственно все обращения типа [edx+8]  - это ни что иное, как обращение к полям моей структуры. Т.е. хочется добиться замены [edx+8] на pTList.Count причем не ручного а автоматического.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=50595&amp;user=3478&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=5" class="addthx" data-post="50595"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 января 2006 13:14 <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Лично я делаю так:
<br>
<br>static Struct_TList()
<br>{
<br>auto	sHandle, sHandle_TObject;
<br>auto	error;
<br>auto	STRUCTURE_NAME;
<br>
<br>auto ID, Address;
<br>auto EnumName;
<br>	// &#207;&#240;&#238;&#241;&#236;&#238;&#242;&#240; &#241;&#242;&#240;&#243;&#234;&#242;&#243; &#237;&#224; &#237;&#224;&#235;&#232;&#247;&#232;&#229; TObject, &#229;&#241;&#235;&#232; &#237;&#229;&#242; &#242;&#238; &#241;&#238;&#231;&#228;&#224;&#242;&#252;
<br>	sHandle_TObject = GetStrucIdByName(&quot;TObject_obj&quot;);
<br>	if(sHandle_TObject == -1)
<br>	{	sHandle_TObject = Struct_TObject();	}
<br>
<br>	STRUCTURE_NAME = &quot;TList_obj&quot;;
<br>	sHandle = AddStrucEx(-1, STRUCTURE_NAME, 0);
<br>	if(sHandle == -1)
<br>	{	sHandle = GetStrucIdByName(STRUCTURE_NAME);
<br>		if(sHandle == -1)
<br>		{	WarningMessage(&quot;Unable to create the &quot; + STRUCTURE_NAME + &quot; structure!&#92;n&quot;);
<br>			return -1;	}
<br>		return sHandle;		}
<br>		
<br>//	AddStrucMember(sHandle, &quot;pVTBL&quot;,		0x00, FF_DWRD, -1, 4);
<br>	AddStrucMember(sHandle, &quot;pVTBL&quot;,		0x00, FF_DWRD + FF_0OFF, -1, 4);
<br>	AddStrucMember(sHandle, &quot;Items&quot;,		0x04, FF_DWRD + FF_0OFF, -1, 4);
<br>	AddStrucMember(sHandle, &quot;Count&quot;,		0x08, FF_DWRD, -1, 4);
<br>	AddStrucMember(sHandle, &quot;Capacity&quot;,		0x0C, FF_DWRD, -1, 4);
<br>	
<br>	EnumName=&quot;EnumTList&quot;;
<br>	ID=AddEnum(0, EnumName, 0);
<br>	if (ID != -1)
<br>	{	Address=0x00; AddConstEx(ID, &quot;TList_Grow&quot;, Address, -1);
<br>		Address=0x04; AddConstEx(ID, &quot;TList_4&quot;, Address, -1);
<br>		Address=0x08; AddConstEx(ID, &quot;TList_8&quot;, Address, -1);
<br>		Address=0x0C; AddConstEx(ID, &quot;TList_10&quot;, Address, -1);	}
<br>
<br>	return sHandle;
<br>}
<br>
<br>затем просто выбираю из Sumbolic constant
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=50757&amp;user=1705&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=6" class="addthx" data-post="50757"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 января 2006 13:15 <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Вот мой оригинал (он много неполный...)
<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/e5ea_DelphiAnalis.idc.zip">e5ea_DelphiAnalis.idc.zip</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=50759&amp;user=1705&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=7" class="addthx" data-post="50759"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 января 2006 13:16 <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Если кто доработает буду благодарен!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=50761&amp;user=1705&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=8" class="addthx" data-post="50761"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 января 2006 13:18 <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Для полного комплекта мои скрипты для делфи (чтото периписал, чтото сам)<br><br><img src="img/attach.gif" alt=""> <a href="./files/b38b_IDAidc.zip.zip">b38b_IDAidc.zip.zip</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=50762&amp;user=1705&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=9" class="addthx" data-post="50762"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 января 2006 13:46 <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Кстати кажется работает и с Borland C++
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52150&amp;user=1705&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=10" class="addthx" data-post="52150"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]YoriCH[/b]','')">YoriCH</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3349.gif" alt=""><br><span class=txtSm>Ранг: 108.4 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.54'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3349">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 апреля 2006 21:05 <br><script type="text/javascript">QU('YoriCH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=YoriCH" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>TretS</b>
<br>Спасибо за твои скрипты. Действительно их применений облегчает понимание текста в IDA 
<br>У меня такой вопрос. Мне встречались некоторые программы на Delphi (точно на нем), но скрипт на них не отрабатывал. Нельзя ли их доработать или в чем проблема?
<br><br><font size="1"><i>-----<br>Есть вопросы ко мне? В личку!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=60461&amp;user=3349&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=11" class="addthx" data-post="60461"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 апреля 2006 22:48 <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>YoriCH</b>
<br>Возможно в DelphiAnalis необходимо изменить имя сегмента кода ---
<br>	StartAdr=SegByBase(SegByName(&quot;CODE&quot;));
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60486&amp;user=1705&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=12" class="addthx" data-post="60486"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]YoriCH[/b]','')">YoriCH</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3349.gif" alt=""><br><span class=txtSm>Ранг: 108.4 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.54'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3349">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2006 06:06 <br><script type="text/javascript">QU('YoriCH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=YoriCH" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>TretS</b>
<br>То есть я понимаю возможны варианты. А как точно тогда определить имя сегмента кода?
<br>Как я понимаю в этом случае имя желательно считывать из файла?
<br><br><font size="1"><i>-----<br>Есть вопросы ко мне? В личку!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=60504&amp;user=3349&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=13" class="addthx" data-post="60504"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]YoriCH[/b]','')">YoriCH</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3349.gif" alt=""><br><span class=txtSm>Ранг: 108.4 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.54'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3349">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2006 09:09 <br><script type="text/javascript">QU('YoriCH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=YoriCH" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>TretS</b>
<br>Да кстати проверил, действительно изменив имя секции в скрипте можно добиться срабатывания, но хотелось бы автоматического распознования секции.
<br><br><font size="1"><i>-----<br>Есть вопросы ко мне? В личку!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=60517&amp;user=3349&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=14" class="addthx" data-post="60517"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2006 10:39 <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>YoriCH</b>
<br>Писалось давно, замучила работа.
<br>Пробывал по ЕР но работало не на всех распакованных файлах
<br>Появится свободное время займусь поплотней. Извени.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60522&amp;user=1705&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=15" class="addthx" data-post="60522"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]YoriCH[/b]','')">YoriCH</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3349.gif" alt=""><br><span class=txtSm>Ранг: 108.4 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.54'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3349">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2006 12:12 <br><script type="text/javascript">QU('YoriCH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=YoriCH" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>TretS</b>
<br>А как тогда считываются названия сегментов в скриптах для IDA?
<br>Можно попробовать считать и установить первый сегмент.
<br><br><font size="1"><i>-----<br>Есть вопросы ко мне? В личку!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=60531&amp;user=3349&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=16" class="addthx" data-post="60531"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2006 15:50 <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>YoriCH</b>
<br>Определим адрес ??? принадлежащий первому сегменту:
<br>
<br>long    SegStart        (long ea);      // returns start of the segment
<br>                                        // BADADDR if bad address passed
<br> получаем стартовый адресс сегмента.
<br>
<br>Хорошо бы знать как в ИДЕ вызвать перечисление всех сегментов или анализом загаловка файла вытащить 
<br>порядок сегментов, но это много муторней, т.к. придется вручную анализировать все остальное (есть скрипт
<br>он анализирует заголовок и полько процедуру ЕР).
<br>
<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/dcac_IDA_PE_idc.rar.zip">dcac_IDA_PE_idc.rar.zip</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60558&amp;user=1705&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=17" class="addthx" data-post="60558"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2006 15:52 &middot; Поправил: TretS <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Хотя посмотрев помощь 4.9 нашел
<br>
<br>// Get first segment
<br>// returns: linear address of the start of the first segment
<br>// BADADDR - no segments are defined
<br>
<br>
<br> 
<br>long    FirstSeg        ();             // returns start of the first
<br>                                        // segment, BADADDR - no segments
<br>
<br>можно попробовать!!!
<br>
<br>подробнее завтра посмотрю на работе
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60560&amp;user=1705&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=18" class="addthx" data-post="60560"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]YoriCH[/b]','')">YoriCH</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3349.gif" alt=""><br><span class=txtSm>Ранг: 108.4 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.54'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3349">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2006 17:21 <br><script type="text/javascript">QU('YoriCH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=YoriCH" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>TretS</b>
<br><I>Хотя посмотрев помощь 4.9 нашел </I>
<br>Это только для 4.9?
<br>А для 4.8 как?
<br><br><font size="1"><i>-----<br>Есть вопросы ко мне? В личку!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=60577&amp;user=3349&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=19" class="addthx" data-post="60577"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 апреля 2006 00:02 <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>YoriCH</b>
<br>Просто дома стоит только 4.9, завтра на работе посмотрю 4.8, 4.7
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60636&amp;user=1705&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=20" class="addthx" data-post="60636"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]YoriCH[/b]','')">YoriCH</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3349.gif" alt=""><br><span class=txtSm>Ранг: 108.4 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.54'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3349">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 апреля 2006 00:11 <br><script type="text/javascript">QU('YoriCH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=YoriCH" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>TretS</b>
<br>кстати, он формирует структуры данных для каждой Form. Я имею ввиду типа 
<br>
<br>TForm1_Button3   = 388h
<br>TForm1_Label1    = 394h
<br>TForm1_Label2    = 3A4h
<br>TForm1_Label8    = 3A8h
<br>
<br>Но в самой программе они автоматически не встают. Их приходиться выставлять самостоятельно.
<br>Это было так задумано или просто не ставилась цель все автоматизировать?
<br>Сорри, если я слишком навязчиво по нему спрашиваю, просто идея очень хорошая и в первой редакции неплохо вышло, но хотелось бы автоматом многие вещи, чтобы не выставлять их. <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Есть вопросы ко мне? В личку!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=60637&amp;user=3349&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=21" class="addthx" data-post="60637"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 апреля 2006 13:10 <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>YoriCH</b>
<br>
<br>для 4.8 работает
<br>
<br>Попробуй поискать книгу Касперски: ОБРАЗ МЫШЛЕНИЯ – ДИЗАССЕМБЛЕР
<br>IDA Pro - описывает функции для ИДЫ
<br>
<br>Задумывалось как проба для написания плагина, но что-то дальше пока не идет ;)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60721&amp;user=1705&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=22" class="addthx" data-post="60721"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]YoriCH[/b]','')">YoriCH</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3349.gif" alt=""><br><span class=txtSm>Ранг: 108.4 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.54'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3349">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 апреля 2006 18:30 <br><script type="text/javascript">QU('YoriCH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=YoriCH" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<b>TretS</b>
<br>Ты прав для определения первого сегмента работает
<br>   StartAdr=FirstSeg();
<br>Заменив его делаем срабатывание (по крайней мере у меня так) везде.
<br>Со вторым еще сам смотрю. Читаю книгу, что ты посоветовал.
<br><br><font size="1"><i>-----<br>Есть вопросы ко мне? В личку!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=60779&amp;user=3349&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=23" class="addthx" data-post="60779"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 апреля 2006 21:18 <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>YoriCH</b>
<br>
<br>По поводу автоматической расстановки имен - это действительно (соответствует задумке автора)
<br>только на уровне пользовательского кода. Чем глубже в RTL тем все абстрактней. Поэтому
<br>по моему главная трудность в определении границы пользовательского кода. Компоненты вероятно
<br>попадают в определение пользовательского кода.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60839&amp;user=1705&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=24" class="addthx" data-post="60839"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]YoriCH[/b]','')">YoriCH</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3349.gif" alt=""><br><span class=txtSm>Ранг: 108.4 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.54'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3349">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 апреля 2006 22:07 <br><script type="text/javascript">QU('YoriCH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=YoriCH" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>TretS</b>
<br>Однако только увидел проблему. У проги код разбросан по разным сегментам, так он обрабатывает только один. <img src="img/smilies/s4.gif" alt="">
<br>Прочитал, то что советовал <img src="img/smilies/s1.gif" alt="">
<br>И немного изменив. вроде добился, чтобы по всем сегментам искал.
<br>
<br>Но я думаю, это еще не все надо посмотреть вариант с прямым назначением имен из структуры данных, как я описывал выше.
<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/92e4_03.04.2006_CRACKLAB.rU.tgz">92e4_03.04.2006_CRACKLAB.rU.tgz</a>
<br><br><font size="1"><i>-----<br>Есть вопросы ко мне? В личку!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=60854&amp;user=3349&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=25" class="addthx" data-post="60854"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 апреля 2006 09:38 <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<b>YoriCH</b>
<br>
<br>Вот еслибы суметь в режиме отладчика считать в скрипт значение регистров, то
<br>можно было бы автоматизировать расстановку в пределах процедуры.
<br>Но помоему нельзя узнать значение регистра.
<br>
<br>По поводу скрипта да действительно удобней, не надо указывать имя сегмента руками в тексте скрипта<img src="img/smilies/s3.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60917&amp;user=1705&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=26" class="addthx" data-post="60917"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]infern0[/b]','')">infern0</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 апреля 2006 09:47 <br><script type="text/javascript">QU('infern0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=infern0" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<I>TretS пишет:
<br>режиме отладчика считать в скрипт значение регистров </I>
<br>плагин надо написать и все получится
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60920&amp;user=36&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=27" class="addthx" data-post="60920"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 апреля 2006 10:55 <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>infern0</b>
<br>
<br>Про плагин речь шла выше как идеал, а это подготовка к написанию, так сказать выработка стратегии
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60943&amp;user=1705&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=28" class="addthx" data-post="60943"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]YoriCH[/b]','')">YoriCH</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3349.gif" alt=""><br><span class=txtSm>Ранг: 108.4 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.54'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3349">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 апреля 2006 17:39 <br><script type="text/javascript">QU('YoriCH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=YoriCH" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<b>TretS</b>
<br><b>infern0</b>
<br>А не применяя плагин значит нельзя будет?
<br>Ведь структуры то делаются, почему нельзя их присобачить внутри каждой формы (используя, то что там многое однотипно)?
<br><br><font size="1"><i>-----<br>Есть вопросы ко мне? В личку!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=61002&amp;user=3349&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=29" class="addthx" data-post="61002"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]TretS[/b]','')">TretS</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.21'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1705">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 апреля 2006 19:52 &middot; Поправил: TretS <br><script type="text/javascript">QU('TretS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TretS" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3721&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<b>YoriCH</b>
<br>
<br>Как обяснить ИДЕ в статике экземпляр какого класса передается в функцию?
<br>
<br>Также скрипты не позволяют создавать рекрусию.
<br>
<br>Кстати Structures и Enums хорошо применять и в встроенном отладчике.
<br>
<br>Еще для расширения кругозора нужно посмотреть исходники DeDe (где взять не помню, размер ок 2М)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=61014&amp;user=1705&amp;forum_n=1&amp;topic=3721&amp;page=0&amp;anchor=30" class="addthx" data-post="61014"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=1&amp;topic=3721&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=1&amp;topic=3721&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Автоматическое применение структур в IDA</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="3721">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=3721" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
