<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>TDI. Высоконагруженный ядерный сервер - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Пишу ядерный сервак с возможностью одновременного приёма 1000+ клиентов. Скажу сразу, что я нуб, нуб и ещё раз нуб тут, но кое в чём разобрался. Представляю примерную схему, но многие вещи пока толково объяснить не могу. Всех">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> TDI. Высоконагруженный ядерный сервер</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 04:18 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Пишу ядерный сервак с возможностью одновременного приёма 1000+ клиентов. Скажу сразу, что я нуб, нуб и ещё раз нуб тут, но кое в чём разобрался. Представляю примерную схему, но многие вещи пока толково объяснить не могу. Всех объектов ещё не знаю, чтобы выбирать самостоятельно и разумно. А выбрать нужно способ приёма/передачи данных на установленном соединении.<br><br>Поскольку нужно уметь принимать огромное число клиентов одновременно, а обработка одного может занимать до нескольких секунд, то цикл приёма/передачи сразу вслед за акцептом не катит. Обработка должна быть вынесена отдельно, чтобы у другого клиента не сработал таймаут коннекта. APC также не подходит.<br><br>Каждую в отдельный поток вынести  - вряд ли система будет стабильно работать с тысячью систем тредов. И пока реализовал на Work Item&#039;ах. <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>pSocket&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pSocket&nbsp;</span><span class="hl_char">=</span>&nbsp;CreateNewSocket<span class="hl_char">(</span>pAddr<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;</span><span class="hl_char">=</span>&nbsp;OpenConnection<span class="hl_char">(</span><span class="hl_char">&amp;</span>pSocket<span class="hl_char">-</span><span class="hl_char">&gt;</span>RemHandle<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>pSocket<span class="hl_char">-</span><span class="hl_char">&gt;</span>pRemAddressFileObject<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>TDI_ASSOCIATE_ADDRESS</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IO_STATUS_BLOCK&nbsp;IoStatusBlock</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PIRP&nbsp;pIrp<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KEVENT&nbsp;Event<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeInitializeEvent<span class="hl_char">(</span><span class="hl_char">&amp;</span>Event<span class="hl_char">,</span>&nbsp;NotificationEvent<span class="hl_char">,</span>&nbsp;<span class="hl_function">FALSE</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pIrp&nbsp;<span class="hl_char">=</span>&nbsp;TdiBuildInternalDeviceControlIrp<span class="hl_char">(</span>TDI_ASSOCIATE_ADDRESS<span class="hl_char">,</span>&nbsp;pAddr<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDeviceObject<span class="hl_char">,</span>&nbsp;pSocket<span class="hl_char">-</span><span class="hl_char">&gt;</span>pRemAddressFileObject<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>Event<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>IoStatusBlock<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TdiBuildAssociateAddress<span class="hl_char">(</span>pIrp<span class="hl_char">,</span>&nbsp;pAddr<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDeviceObject<span class="hl_char">,</span>&nbsp;pSocket<span class="hl_char">-</span><span class="hl_char">&gt;</span>pRemAddressFileObject<span class="hl_char">,</span>&nbsp;TDICompletionRoutine<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>Event<span class="hl_char">,</span>&nbsp;pAddr<span class="hl_char">-</span><span class="hl_char">&gt;</span>AddressHandle<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span><span class="hl_char">(</span>status&nbsp;<span class="hl_char">=</span>&nbsp;IoCallDriver<span class="hl_char">(</span>pAddr<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDeviceObject<span class="hl_char">,</span>&nbsp;pIrp<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;STATUS_PENDING<span class="hl_char">)</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeWaitForSingleObject</span><span class="hl_char">(</span><span class="hl_char">&amp;</span>Event<span class="hl_char">,</span>&nbsp;Executive<span class="hl_char">,</span>&nbsp;KernelMode<span class="hl_char">,</span>&nbsp;<span class="hl_function">FALSE</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>IoStatusBlock<span class="hl_char">.</span>Status&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;STATUS_SUCCESS<span class="hl_char">)</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pSocket</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>State&nbsp;<span class="hl_char">|</span><span class="hl_char">=</span>&nbsp;SOCKET_STATE_ASSOCIATED<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>TDI_LISTEN</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pIrp&nbsp;<span class="hl_char">=</span>&nbsp;TdiBuildInternalDeviceControlIrp<span class="hl_char">(</span>TDI_LISTEN<span class="hl_char">,</span>&nbsp;pAddr<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDeviceObject<span class="hl_char">,</span>&nbsp;pSocket<span class="hl_char">-</span><span class="hl_char">&gt;</span>pRemAddressFileObject<span class="hl_char">,</span>&nbsp;pAddr<span class="hl_char">-</span><span class="hl_char">&gt;</span>pWorkEvent<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>IoStatusBlock<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TdiBuildListen<span class="hl_char">(</span>pIrp<span class="hl_char">,</span>&nbsp;pAddr<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDeviceObject<span class="hl_char">,</span>&nbsp;pSocket<span class="hl_char">-</span><span class="hl_char">&gt;</span>pRemAddressFileObject<span class="hl_char">,</span>&nbsp;ListenCompletion<span class="hl_char">,</span>&nbsp;pSocket<span class="hl_char">,</span>&nbsp;TDI_QUERY_ACCEPT<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>RequestConnInfo<span class="hl_char">,</span>&nbsp;pSocket<span class="hl_char">-</span><span class="hl_char">&gt;</span>pRemoteAddress<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;<span class="hl_char">=</span>&nbsp;IoCallDriver<span class="hl_char">(</span>pAddr<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDeviceObject<span class="hl_char">,</span>&nbsp;pIrp<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;<span class="hl_char">=</span>&nbsp;KeWaitForMultipleObjects<span class="hl_char">(</span><span class="hl_number">2</span><span class="hl_char">,</span>&nbsp;Objects<span class="hl_char">,</span>&nbsp;WaitAny<span class="hl_char">,</span>&nbsp;Executive<span class="hl_char">,</span>&nbsp;KernelMode<span class="hl_char">,</span>&nbsp;<span class="hl_function">FALSE</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>status&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;STATUS_WAIT_0<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeClearEvent</span><span class="hl_char">(</span>pAddr<span class="hl_char">-</span><span class="hl_char">&gt;</span>pWorkEvent<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">if</span><span class="hl_char">(</span>IoStatusBlock<span class="hl_char">.</span>Status&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;STATUS_SUCCESS<span class="hl_char">)</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeInitializeEvent</span><span class="hl_char">(</span><span class="hl_char">&amp;</span>Event<span class="hl_char">,</span>&nbsp;NotificationEvent<span class="hl_char">,</span>&nbsp;<span class="hl_function">FALSE</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pIrp&nbsp;</span><span class="hl_char">=</span>&nbsp;TdiBuildInternalDeviceControlIrp<span class="hl_char">(</span>TDI_ACCEPT<span class="hl_char">,</span>&nbsp;pAddr<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDeviceObject<span class="hl_char">,</span>&nbsp;pSocket<span class="hl_char">-</span><span class="hl_char">&gt;</span>pRemAddressFileObject<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>Event<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>IoStatusBlock<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TdiBuildAccept</span><span class="hl_char">(</span>pIrp<span class="hl_char">,</span>&nbsp;pAddr<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDeviceObject<span class="hl_char">,</span>&nbsp;pSocket<span class="hl_char">-</span><span class="hl_char">&gt;</span>pRemAddressFileObject<span class="hl_char">,</span>&nbsp;AcceptCompletion<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>Event<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">if</span><span class="hl_char">(</span><span class="hl_char">(</span>status&nbsp;<span class="hl_char">=</span>&nbsp;IoCallDriver<span class="hl_char">(</span>pAddr<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDeviceObject<span class="hl_char">,</span>&nbsp;pIrp<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;STATUS_PENDING<span class="hl_char">)</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeWaitForSingleObject</span><span class="hl_char">(</span><span class="hl_char">&amp;</span>Event<span class="hl_char">,</span>&nbsp;Executive<span class="hl_char">,</span>&nbsp;KernelMode<span class="hl_char">,</span>&nbsp;<span class="hl_function">FALSE</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>Поскольку&nbsp;обработка<span class="hl_char">(</span>приём<span class="hl_char">,</span>&nbsp;обработка&nbsp;и&nbsp;отправка&nbsp;данных&nbsp;клиенту<span class="hl_char">,</span>&nbsp;соединение&nbsp;с&nbsp;целевым&nbsp;узлом<span class="hl_char">,</span>&nbsp;приём<span class="hl_char">/</span>отправка&nbsp;данных<span class="hl_char">)</span>&nbsp;может&nbsp;занимать</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;до&nbsp;нескольких&nbsp;секунд<span class="hl_char">,</span>&nbsp;то&nbsp;целесообразно&nbsp;её&nbsp;вынести&nbsp;в&nbsp;отдельную&nbsp;процедуру</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IoQueueWorkItem</span><span class="hl_char">(</span>pSocket<span class="hl_char">-</span><span class="hl_char">&gt;</span>pWorkItem<span class="hl_char">,</span>&nbsp;SocketWorkItem<span class="hl_char">,</span>&nbsp;DelayedWorkQueue<span class="hl_char">,</span>&nbsp;pSocket<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pSocket&nbsp;</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li>        </ol>
    </div>
</div></div>
<br><br>Проверить полностью на тысячу коннектов сейчас не могу, это будет в финале. Сделать правильный выбор нужно сейчас. И уже сейчас что-то не очень нравится это способ на Work Item. Есть ещё идея создать отдельный рабочий тред, и посылать в него команды с параметрами на обработку, но как-то сложновато... Есть ли ещё другие способы?
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334116&amp;user=24257&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=1" class="addthx" data-post="334116"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 04:26 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<noindex><a href="https://www.google.ru/search?client=opera&amp;q=multi+client+server+c%2B%2B+code&amp;sourceid=opera&amp;ie=UTF-8&amp;oe=UTF-8" rel="nofollow" target="_blank">--&gt; multi client server c++ code &lt;--</a></noindex>
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334118&amp;user=17432&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=2" class="addthx" data-post="334118"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 04:29 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
конечно есть, async+nonblock io+boost+IOCP ~=&gt; делаешь свой ректор<br>и не надо систему грузить ненужными трейдами которые ничего током делать не будут<br>треиды выиграют только если у тебя будет более менее чем 16 процессорная система
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334119&amp;user=15381&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=3" class="addthx" data-post="334119"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 04:40 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>ClockMan</b><br>Вот не поверишь, но готовые дрова на TDI так часто выкладывают в сеть, что нашёл 1 рабочий и 2 куска из привата гугла, но всё там не по той схеме <img src="img/smilies/s1.gif" alt=""><br>В книгах о руткитах тоже только знакомят. Собственно, я с xakepa и начал<br><br><b>reversecode</b><br>Упрямство велит сделать самому <img src="img/smilies/s5.gif" alt=""> P.S. А да - и на TDI!!!
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334123&amp;user=24257&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=4" class="addthx" data-post="334123"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 04:42 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
ну так и делай сам, я только не пойму каким там местом драйвер <img src="img/smilies/s5.gif" alt=""><br>наверное сысоев в nginx и не знает что ему нужен tdi драйвер, напиши ему ))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334124&amp;user=15381&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=5" class="addthx" data-post="334124"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 04:45 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Да есть причины, x64 c rsdn.ru, например мог бы назвать )<br><noindex><a href="http://x64blog.name/1306875949" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334126&amp;user=24257&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=6" class="addthx" data-post="334126"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 04:48 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
ааа, ну так бы и сказал сразу что мелварь-дос нет пишешь<br>я то думал что то полезное..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334127&amp;user=15381&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=7" class="addthx" data-post="334127"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 04:54 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Да не малварь ) Что ж сразу если дров - то малварь? Вон Инде SIDE забабахал - кошерно, но запускать до сих пор побаиваюсь<img src="img/smilies/s5.gif" alt=""> Кстати, Инде, наверняка смог бы помочь тут )<br>Хотя странно тоже в ядре работает - TCPView от Руссиновича не видит его состояния соединений - ни LISTEN, ни ESTABLISHED. Да и сами соединения не видит, хотя коннекты есть. Почти руткит )
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334128&amp;user=24257&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=8" class="addthx" data-post="334128"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 04:58 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
если не мелварь, то дрова не нужны<br>винда прекрасно сама все делает с юзер мода<br><br>блог тараски в бекапах поищи, он много про сетевую систему писал<br>а инде здесь профан
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334129&amp;user=15381&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=9" class="addthx" data-post="334129"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 05:02 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>reversecode пишет:<br>если не мелварь, то дрова не нужны </I><br>от ты не прав! По производительности куда выше. Ну да ладно )<br><br><I>reversecode пишет:<br>а инде здесь профан </I><br>Про его сетевую деятельность неизвестно, но помочь в выборе колбэков он смог бы!<br>ARCHANGEL, наверняка, поделился бы дельным советом. Вполне возможно, кто из новых (или редких) участников имеет ценное мнение...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334132&amp;user=24257&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=10" class="addthx" data-post="334132"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 05:06 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>DenCoder пишет:<br>от ты не прав! По производительности куда выше. Ну да ладно ) </I><br>осталось понять что это за чудо задание которое будет выплевывать и выгребать такие огромные куски данных что сорм покажется просто маленькой букашкой ))<br>не хилые видимо у хомячков для внедрение мелвари интернет каналы и сетевые карты с оптикой сразу к м9
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334133&amp;user=15381&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=11" class="addthx" data-post="334133"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 08:40 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Да не малварь ) </I><br><br>если ТЗ для малвари, то малварь. Или тебе работодатель сказал, что не малварь?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334139&amp;user=2585&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=12" class="addthx" data-post="334139"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 09:19 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Ядерный сервак - это отличный бсодогенератор. Не изобретайте велосипед, обычный IOCP + правильные настройки сетевого стека, и будет держать столько клиентов, на сколько хватит канала и ресурсов CPU для выполнения прикладного протокола. Ядерные ухищрения могут понадобиться если вам в реалтайме обрабатывать 10gbit+ канал, но тогда я бы начал с перехода на другую ОС.<br><br>З.Ы. если очень хочется непременно ядерный сервер, то на WSK проще, быстрее и актуальнее. TDI это теперь legacy обертка.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334140&amp;user=12867&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=13" class="addthx" data-post="334140"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 09:36 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Во-первых, не уловил, зачем в ядро лезть для сервера. Узким местом здесь явно будет не юзер-мод/кернел-мод. И про бсоды уже сказали.<br>Во-вторых, пишешь для уже сдохшей архитектуры. <I>The TDI feature is deprecated and will be removed in future versions of Microsoft Windows. Depending on how you use TDI, use either the Winsock Kernel (WSK) or Windows Filtering Platform (WFP).</I>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334141&amp;user=1556&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=14" class="addthx" data-post="334141"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 14:43 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>Archer</b><br>Ну неверная же информация. Это они планировали его в конец закрыть. Но, однако, не получилось, пришлось оставить для совместимости. И на всех Windows, включая Windows 8, он существует. )<br><br><I>ntldr пишет:<br>если очень хочется непременно ядерный сервер, то на WSK проще, быстрее и актуальнее. TDI это теперь legacy обертка. </I><br>Согласен, но подхожу исторически в хронологическом порядке <img src="img/smilies/s1.gif" alt=""> У меня редкие бсоды, всё можно проработать...<br>Конструктива не будет?<br><br><I>Gideon Vi пишет:<br>если ТЗ для малвари, то малварь </I><br>Всё верно. А если человек судит предвзято, то он мнителен, верно? <img src="img/smilies/s2.gif" alt=""><br><br><b>UPD</b><br>http.sys для IIS - тоже малварь?<br>Скажу честно, что первым делом спросил у заказчика, для чего ему это. Он ответил, что хочет попробовать SOCKS 5 на уровне ядра. Сам по себе SOCKS ничего общего с малварью не имеет! Сильно переубеждать его не стал, тем более что сбылась мечта идиота - наконец-то, что-нибудь ядерное напишу, а то только реверсить надоело. Есть мнение, что у спеца в этом вопросе займёт на задачу каких-то 3 дня. Я сомневаюсь в этом, но сказал, что у меня в любом случае выйдет в 2-3 раза дольше, чем у спеца. Как человек дальновидящий, нарисовал возможные проблемы, предложил Winsock Kernel или WFP. Остались всё же пока на TDI.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334154&amp;user=24257&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=15" class="addthx" data-post="334154"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 15:23 &middot; Поправил: Gideon Vi <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>DenCoder пишет:<br>А если человек судит предвзято, то он мнителен, верно? </I><br><br>Верно. Но выживают только параноики <img src="img/smilies/s3.gif" alt=""><br>По факту, ты не привел ни одного <b>конструктивного </b> довода, кроме &quot;хочу&quot;.<br><br><I>DenCoder пишет:<br>http.sys для IIS - тоже малварь? </I><br><br>из-за специфичности задачи у тебя получилось привести всего один пример, да и тот реализован в таком виде не от большого ума.<br><br><I>DenCoder пишет:<br>Скажу честно, что первым делом спросил у заказчика, для чего ему это. Он ответил, что хочет попробовать SOCKS 5 на уровне ядра. </I><br><br>ну ок, но по моему ты снова <noindex><a href="https://ssl.exelab.ru/f/action=vthread&amp;forum=2&amp;topic=21868" rel="nofollow" target="_blank">лезешь</a></noindex> в какой-то блудняк.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334155&amp;user=2585&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=16" class="addthx" data-post="334155"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 15:29 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Довод один - так надо, а не &quot;хочу&quot;. Ответ на интересующий вопрос выше в правке поста.<br><br>P.S. Вот честно, так и знал, что не стоит сюда писать. Вместо того, чтобы кодить, постоянно ждёшь, что что-то предложат, да ещё и выбираешь адекватные ответы, чтоб не забанили. А ответов не по делу, провоцирующих ответов много  - пользы ноль. Видимо не на тот сайт зашёл, наверное, придётся регаться на rsdn или wasm... Но посмотрю ещё. Если дадут, конечно. Если это PS не послужит поводом для закрытия топика (что практикуется часто, я заметил).
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334156&amp;user=24257&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=17" class="addthx" data-post="334156"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]sendersu[/b]','')">sendersu</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 512.7 (<b>!</b>), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.56'>Активность: 0.27<span style='color:red'>&searr;</span>0.03</span><br>Статус: <a href="action=userinfo&amp;user=14629">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 16:25 &middot; Поправил: sendersu <br><script type="text/javascript">QU('sendersu','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sendersu" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
от себя добавлю что наиболее шустрое решение будет на IOCP (на виндах)<br><br>http://www.slideshare.net/sm9kr/iocp-vs-epoll-perfor<br><br>для ознакомления<br><span style="word-break: break-all">https://skydrive.live.com/?cid=4f23a64a0ca2474e&amp;sc=documents&amp;move=4F23A64A0CA2474E!1270&amp;sid=4F23A64A0CA2474E!1235&amp;iscopy=0&amp;id=4F23A64A0CA2474E%211271#
</span><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334158&amp;user=14629&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=18" class="addthx" data-post="334158"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 16:26 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
а смысл там регатся? хотя конечно виднее<br>но на rsdn можно создать тему и анонимно, в некоторые темы можно и анонимно отвечать<br>на васм... ну с таким же успехом мог бы написать напрямую x64, <br>интересного мог бы сказать tarasco, и его блог который он удалил и сам пропал<br><br>идти на поводу у заказчика даже если у него много денег это путь вникуда<br>умей правильно выбирать методы решения задач и убеждать в этом заказчика<br><br>по факту ты сам то знаешь много подходов в асинхронной обработок кроме ворк итемов и апс?<br>все они оберкти итд которые исполняются на тех же уровнях<br>можно чего то придумать и влезть на уровень ниже, прогнув многозадачность и заставив ос заниматся ненужной работой<br><br>обработка скорости запросов и принятие аксепт при больних потоках упирается в другой потолок а не в ядреное принятие решения
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334159&amp;user=15381&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=19" class="addthx" data-post="334159"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24257" title="23-06-2015 10:52, ранг:218.3" target="_blank">DenCoder</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 16:53 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Конструктива не будет? </I><br>Ок, будет. Я так понял, нужны общие советы &quot;как сделать&quot;, а не готовый код? Если нужен код, в интернете нагугливается не одна реализация TDI сокетов. Еще можно глянуть исходники зевса и краба, там есть подобное.<br><br><I>а обработка одного может занимать до нескольких секунд, то цикл приёма/передачи сразу вслед за акцептом не катит</I><br>Если у вас сокс, не требуется никакой обработки вообще. Вам не нужно никаких циклов, просто в комплешене одного события, запускаем другое.<br><br>Тут будут такие моменты:<br>Обращаем внимание на IRQL, комплешены часто вызываются на DISPATCH_LEVEL, а запускать IRP нужно на PASSIVE_LEVEL. Если IRQL позволяет, запускаем новый IRP сразу, не позволяет - ставим воркитем.<br>Обязательно проверять остаток ядерного стека через IoGetRemainingStackSize, иначе можно словить превышение уровня вложенности и срыв стека. Если стека становится мало - следующее действие переносится в воркитем.<br>Сокс - это много исходящих соединений, здесь вы упретесь сначала в системные настройки TCP/IP, а затем в количество TCP портов. Нужно прописать следующие настройки реестра:<br>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\Tcpip\Parameters<br>MaxUserPort = 65535<br>TcpTimedWaitDelay = 10<br>Это минимум нужный для Win7+, для старых виндов придется прописать еще пачку параметров, уже забыл каких, и применить патч для разлочивания TcpMaxHalfOpen. С этими настройками у вас получится максимум 64к исходящих. Если нужно больше - на сервере должно быть несколько ip адресов, и ваш код должен уметь разбрасывать исходящие соединения между ними.<br>При правильном кодинге и правильных настройках, производительность вашего прокси будет зависить в основном от сетевой карты, весьма хороши серверные сетевухи Intel. Впрочем, потоки до 100мбит переварит любая, на 1gbit при большом PPS всё упрется в управление прерываниями, на 10gbit нужен тщательный системный подход к выбору всего железа и его настроек, узким местом может стать что угодно.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334161&amp;user=12867&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=20" class="addthx" data-post="334161"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24257" title="24-11-2013 00:22, ранг:168.6" target="_blank">DenCoder</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 17:17 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>sendersu</b><br>IOCP - это User mode DeviceIoControl -&gt; ntoskrnl.exe -&gt; afd.sys -&gt; tdi.sys -&gt; tcpip.sys. Да, 4-5 лет где-то назад видел табличку сравнения различных подходов к реализации сервера. IOCP выдержал стресс-тест с около 50К подключениями, если мне не изменяет память, в то время как на select&#039;ах не держалось толком даже 100. Но напрямую через tdi и tcpip мы исключаем сразу 3 звена.<br><br><I>reversecode пишет:<br>ну с таким же успехом мог бы написать напрямую x64 </I><br>Я представляю картину ) Одно время мне надоедали с запретом скриншота... поэтому пойму, если он меня пошлёт )<br><br><I>reversecode пишет:<br>по факту ты сам то знаешь много подходов в асинхронной обработок кроме ворк итемов и апс? </I><br>да если б знал, здесь не спрашивал. Проблема в том, что не знаю как правильно спросить у гугла. callbacks? asynchronous operations? Даже если <noindex><a href="https://www.google.ru/?gws_rd=cr&amp;ei=UqeQUui9KovS4QSoo4CoAw#newwindow=1&amp;q=driver+callbacks+asynchronous+operations+site:microsoft.com" rel="nofollow" target="_blank">--&gt; так &lt;--</a></noindex>, релевантности не видно<br><br><I>reversecode пишет:<br>можно чего то придумать и влезть на уровень ниже, прогнув многозадачность и заставив ос заниматся ненужной работой </I><br>да, это ещё одна причина, почему задал вопрос здесь. Важен больше исследовательский подход, чем с точки зрения опыта<br><br>А нужного Тараско найти не могу...<br><br><I>ntldr пишет:<br>Я так понял, нужны общие советы &quot;как сделать&quot;, а не готовый код? </I><br>Да, именно. Когда вижу готовый код, как правило он не всё равно весь не подходит по каким-то причинам. Даже копипастить отдельные части не имеет смысла. Понимаю принцип, реализую по своему.<br><br>P.S. Кому не поставил спасибки, исчерпал лимит на сегодня. Поставлю потом.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334168&amp;user=24257&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=21" class="addthx" data-post="334168"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 17:26 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
ну погугли еще раз как строятся высоко нагруженые сервера на 100к )) никто ж не мешает?<br><br>на васме блог тараски помоему в архиве выкладывали<br>по васм и рсдн он гуглится как пользователь, но уже сто лет не появляется<br>он хорошо подсказывал многим по сетеой части винды<br><br>сокс сервер без авторизации, безсмысленнен, а при авторизации неимеет смысла его пихать в ядро<br>разве что еще и авторизацию с пользовательской базов пароль логин ты запихнешь<br><br>заказчик видмо омериканец<br>а смысл в сокс проксике это очевидно tor <img src="img/smilies/s5.gif" alt=""><br>дальнешее направление было ясно еще с первого поста<br><br>гугл<br>tarasco site:wasm.ru<br>tarasco site:rsdn.ru<br>но перечитывая его посты врядли польза будет<br>а в блоге уже не помню что было, но внутренне устройство net вроде хорошо рассматривалось,многим в рунете нравилось, насколько я помню<br><br><I>DenCoder пишет:<br>да, это ещё одна причина, почему задал вопрос здесь. Важен больше исследовательский подход, чем с точки зрения опыта </I><br>давай еще раз позовем мастера гойя и его грибы
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334169&amp;user=15381&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=22" class="addthx" data-post="334169"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24257" title="24-11-2013 15:02, ранг:169.6" target="_blank">DenCoder</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 17:42 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>reversecode пишет:<br>давай еще раз позовем мастера гойя и его грибы </I><br><img src="img/smilies/s5.gif" alt=""> Где ты, о, великий?<br><br><I>ntldr пишет:<br>Обязательно проверять остаток ядерного стека через IoGetRemainingStackSize, иначе можно словить превышение уровня вложенности и срыв стека. Если стека становится мало - следующее действие переносится в воркитем. </I><br>То есть рекурсивно? С возможностью переноса последующих рекурсий в другой тред? Если предположить, что на одну CP может потребоваться до 4К стека, 50К клиентов будут жрать 200 МБ памяти только в стеке. Не много ли? Сколько ни замечал - CP выполняется в контексте того же треда. Или может при некоторых условиях выполниться в другом? Вот стоит 2 CP на каких-то IRP в том же треде, пусть один минор TDI_LISTEN, второй - TDI_RECEIVE. Сработало второе событие, обработка занимает 5 мсек, через 1 мсек сработало первое. Вызовется ли первая CP во время работы второй?<br>... Хотя это дело экспериментов. Но как-то странно - из-за обсуждения у меня растёт лень... <img src="img/smilies/s1.gif" alt=""> В целом спасибо, <b>ntldr</b>, развеяли страхи. <img src="img/smilies/s1.gif" alt=""> Но я немного изменю алгоритм, не буду перегружать стек. Я видел подобную реализацию, в одном комплишене посылается другой IRP. Но мне почему-то это кажется не совсем и не всегда правильным, на мсдн вроде как убеждают, что в комплишенах должно быть минимум обработки.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334170&amp;user=24257&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=23" class="addthx" data-post="334170"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 18:28 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
4К стека, окстись! В ядре его 64к, и не один ты его используешь! Структуры описывающие контекст клиентов и буфера ввода/вывода должны быть в lookaside list&#039;ах на paged pool&#039;е. Я имел ввиду что если произошла буферизация, CP может вызываться в твоем потоке, до возврата из IoCallDriver. Если в таком CP сразу ставить следующее событие, можно исчерпать стек. Общепринятая практика в таком случае, проверять IRQL и лимит стека, и если нужно - выносить следующую операцию в workitem.<br><br><b>Сколько ни замечал - CP выполняется в контексте того же треда. Или может при некоторых условиях выполниться в другом?</b><br>На такое завязываться, ммм, как это помягче сказать... Completion routine может вызываться в DPC, там вообще некорректно говорить о треде. Забудь про треде, считай что CP может вызываться абсолютно где угодно.<br><br><I>DenCoder пишет:<br>Вызовется ли первая CP во время работы второй?  </I><br>DPC может вызваться когда угодно и прервать что угодно с более низким IRQL. Это не должно тебя волновать, делай код работающий корректно в любом случае.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334171&amp;user=12867&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=24" class="addthx" data-post="334171"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 18:53 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>ntldr</b><br>Благодарю! <img src="img/smilies/s1.gif" alt=""><br><br>Да, не так легко переучиться после юзермода. В 2004 году была потенциальная возможность дрова научиться писать, да старенький нач. АСУТП метрополитена не согласился с моей кандидатурой.<br><br><I>Gideon Vi пишет:<br>ну ок, но по моему ты снова лезешь в какой-то блудняк. </I><br>Шире смотреть: вся наша жизнь - блудняк! Шансы попасть в блудняк как и шансы падения метеорита. Тем не менее он упал под Челябинском. Кто не знает, в сентябре упал ещё один, в Африке, было 3 последовательных взрыва... Тот блудняк, на который ты ссылаешься - по моей же собственной глупости, несмотря на то, что что-то подобное предвидел... А в целом я солидарен с <b>ntldr</b>: Человека легко использовать и подставить!
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=334175&amp;user=24257&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=25" class="addthx" data-post="334175"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 ноября 2013 02:48 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22353.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
&gt; 4К стека, окстись! В ядре его 64к, и не один ты его используешь!<br><br>По дефолту 3 страницы под стек отводится. Только когда тред становится гуевым стек расшаривается.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334225&amp;user=33727&amp;forum_n=5&amp;topic=22353.html&amp;page=0&amp;anchor=26" class="addthx" data-post="334225"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> TDI. Высоконагруженный ядерный сервер</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#27" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="22353">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22353" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
