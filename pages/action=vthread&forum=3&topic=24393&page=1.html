<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Дизасм. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здрасте. Необходим быстрый, очень быстрый дизассемблер x86. Должен уметь определить длину инструкции и размер адресуемой памяти(eg: inc dword [eax] -&gt; 4байта). Есть множество всяких разных, но обычно они весьма толстые, либо">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a>, <a target='_blank' href='?action=userinfo&amp;user=33192'>morgot</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Дизасм.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=24393&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=24393&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=3&amp;topic=24393&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=3&amp;topic=24393&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=3&amp;topic=24393&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2016 12:21 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Здрасте.<br><br>Необходим быстрый, очень быстрый дизассемблер x86. Должен уметь определить длину инструкции и размер адресуемой памяти(eg: inc dword [eax] -&gt; 4байта).<br><br>Есть множество всяких разных, но обычно они весьма толстые, либо не поддерживают определение размера данных. Свой делать пока нет времени.<br><br>Нужен если не с этой фичей, то хотя бы дизасм длин. Тот который я юзаю не профайл.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368790&amp;user=40990&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=1" class="addthx" data-post="368790"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 октября 2016 19:03 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
<b>difexacaw</b><br>Помнится, что у меня тоже когда-то была задача внедрения своего кода в код приложения. Самое простое решение - это создать новую секцию, копировать туда код нужных функций с вставленным своим, а в нужной функции вставлять джамп на модифицированную. Всё бы ничего, но двиг делал, забыв сначала про <b>фиксапы</b>, что их тоже надо по мере необходимости добавлять в таблицу релоков, а местами и изменять, если функция начинается сразу с подобной mov eax, [address]. Обнаружил эту необходимость позже для dll, и переделывал. Интересно - Вы это учли? )<br><br><b>Добавлено спустя 6 минут</b><br>Просто в Вашем <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24378&amp;page=0#23" rel="nofollow" target="_blank">алго</a></noindex> этого не нашёл )
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368873&amp;user=24257&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=2" class="addthx" data-post="368873"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 октября 2016 19:17 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<b>DenCoder</b><br><br>Вы путаете разницу между патчем в памяти и патчем модуля, последнее есть инфект и для него нужно обрабатывать фиксапы.<br><br><b>Добавлено спустя 27 минут</b><br>Потестил дизасм длин хьюва(Dila), кривая поделка.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368875&amp;user=40990&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=3" class="addthx" data-post="368875"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]VodoleYka[/b]','')">VodoleYka</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.7'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=41528">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 11:47 <br><script type="text/javascript">QU('VodoleYka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleYka" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
<b>difexacaw</b><br>http://z0mbie.daemonlab.org/ <br>посмотри там <br>XDE v1.02 -- extended length disassembler<br>LDE-32 v1.04 -- Length-Disassembler Engine, ~29k<br>а вообще я повторюсь.. надо вирусные топики рыть.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368896&amp;user=41528&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=4" class="addthx" data-post="368896"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 14:16 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<b>VodoleYka</b><br><br>Зомби двиг очень давно тестился он кривой.<br><br>Интересно посмотреть описанный двиг Borov&#039;a, но не получилось его найти, никто про него не знает.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368900&amp;user=40990&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=5" class="addthx" data-post="368900"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Medsft[/b]','')">Medsft</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 330.4 (мудрец), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.83'>Активность: 0.16<span style='color:green'>&nearr;</span>0.17</span><br>Статус: <a href="action=userinfo&amp;user=332">Участник</a><br><font color=blue>ILSpector Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 15:04 <br><script type="text/javascript">QU('Medsft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Medsft" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
а msrem`а двиг пробовали?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368902&amp;user=332&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=6" class="addthx" data-post="368902"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 15:06 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<b>Medsft</b><br><br>Скорее всего да, но это очень древнее и оно всё бажное.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368903&amp;user=40990&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=7" class="addthx" data-post="368903"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 15:19 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
Mediana? https://sourceforge.net/projects/mediana/
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368904&amp;user=1556&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=8" class="addthx" data-post="368904"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 15:29 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<b>Archer</b><br><br>Сложный интерфейс и сишка, нету чем собирать. Но это мотор человека с васма, он его долго пилил, так что в целом сомнительный функционал в плане стабильности.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368905&amp;user=40990&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=9" class="addthx" data-post="368905"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 19:39 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
Я бы мог поделиться своим двигом - он изначально делался с выборкой опкодов для декодирования по известному красно-чёному дереву, метод value_compare класса map перегружен:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">struct&nbsp;MASKED_DWORD</li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwValue<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwMask<span class="hl_comment">;</span></li><li class="hl_l0">}<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">template<span class="hl_char">&lt;</span>class&nbsp;_Ty<span class="hl_char">&gt;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;MaskedLess</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>public</b></span>&nbsp;binary_function<span class="hl_char">&lt;</span>_Ty<span class="hl_char">,</span>&nbsp;_Ty<span class="hl_char">,</span>&nbsp;bool<span class="hl_char">&gt;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;operator<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_function"><b>const</b></span>&nbsp;_Ty<span class="hl_char">&amp;</span>&nbsp;_Left<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>const</b></span>&nbsp;_Ty<span class="hl_char">&amp;</span>&nbsp;_Right<span class="hl_char">)</span>&nbsp;<span class="hl_function">const</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;bResult</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>WORD</b></span>&nbsp;lmw<span class="hl_char">,</span>&nbsp;rmw<span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lmw&nbsp;</span><span class="hl_char">=</span>&nbsp;_Left<span class="hl_char">.</span>dwValue<span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rmw&nbsp;</span><span class="hl_char">=</span>&nbsp;_Right<span class="hl_char">.</span>dwValue<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">if</span><span class="hl_char">(</span>_Left<span class="hl_char">.</span>dwMask&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span><span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;lmw&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">=</span>&nbsp;_Right<span class="hl_char">.</span>dwMask<span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>else</b></span>&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>_Right<span class="hl_char">.</span>dwMask&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span><span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;rmw&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">=</span>&nbsp;_Left<span class="hl_char">.</span>dwMask<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bResult&nbsp;</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>lmw&nbsp;<span class="hl_char">&amp;</span>&nbsp;0xFF<span class="hl_char">)</span>&nbsp;<span class="hl_char">&lt;</span>&nbsp;<span class="hl_char">(</span>rmw&nbsp;<span class="hl_char">&amp;</span>&nbsp;0xFF<span class="hl_char">)</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">|</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">(</span>lmw&nbsp;<span class="hl_char">&amp;</span>&nbsp;0xFF<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>rmw&nbsp;<span class="hl_char">&amp;</span>&nbsp;0xFF<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">(</span>lmw&nbsp;<span class="hl_char">&amp;</span>&nbsp;0xFF00<span class="hl_char">)</span>&nbsp;<span class="hl_char">&lt;</span>&nbsp;<span class="hl_char">(</span>rmw&nbsp;<span class="hl_char">&amp;</span>&nbsp;0xFF00<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;bResult</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">typedef&nbsp;map<span class="hl_char">&lt;</span>MASKED_DWORD<span class="hl_char">,</span>&nbsp;CMD_PRIMITIVE<span class="hl_char">,</span>&nbsp;MaskedLess<span class="hl_char">&lt;</span>MASKED_DWORD<span class="hl_char">&gt;</span><span class="hl_char">&gt;</span>&nbsp;MASKED_MAP<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>Но Вы, излеченый мой друг, будете охать и ахать, зачем я само декодирование смешал вместе с выводом текста <img src="img/smilies/s5.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368910&amp;user=24257&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=10" class="addthx" data-post="368910"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 19:59 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
<b>DenCoder</b><br><br>В общем от дизасма нужно следующее(размер данных никакой не даёт, только тяжёлые типо Bea). Он должен определить длину инструкции(и число префиксов желательно, что бы повторный раз их не считать) и наличие адресации - MRM/SIB.<br><br>Я потестил dizahex, там тоже не всё ровно, во первых не раскодируется simd. Так же не возвращается число префиксов и не ясно по лимитам на длину инструкции - если она овер 15 байт, то дизасм возвращает абы что. Посему это нужно пофиксить. Так как нужно самому раскодировать MRM/SIB, что бы привести адресацию к линейной(проиндексировать pushad фрейм), то какие то манипуляции дизасмом с ней излишне, нужно только наличие MRM и смещение на неё, а есчо точнее, так как смещение всегда постоянно для 3-х таблиц опкодов, то нужен только факт наличия мрм. В других приложениях наличие мрм определялось по факту выборки данных(ловушка), но тут статик декодирование и посему нужно юзать таблицы опкодов. В принципе можно их просто описать тремя маленькими битмапами, это будет эффективнее всего, но нужно определять длину инструкции всё равно.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368912&amp;user=40990&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=11" class="addthx" data-post="368912"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 20:06 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
Ну у меня как-то так<br><br><I>difexacaw пишет:<br>и наличие адресации - MRM/SIB </I><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>Export</li><li class="hl_l1">IMAGE_HANDLE&nbsp;__stdcall&nbsp;LoadFileImage<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;sFilePath<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;__stdcall&nbsp;UnloadFileImage<span class="hl_char">(</span>IMAGE_HANDLE&nbsp;ihImage<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">IMAGE_HANDLE&nbsp;__stdcall&nbsp;CreateImage<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;sFilePath<span class="hl_char">,</span>&nbsp;<span class="hl_function">BYTE</span><span class="hl_char">*</span>&nbsp;pMem<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwFileSize<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>DWORD</b></span>&nbsp;__stdcall&nbsp;TestAsciiString<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;s<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;iMaxLength&nbsp;<span class="hl_char">=</span>&nbsp;0x100<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;__stdcall&nbsp;TestUnicodeString<span class="hl_char">(</span>wchar_t<span class="hl_char">*</span>&nbsp;ws<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;iMaxLength&nbsp;<span class="hl_char">=</span>&nbsp;0x100<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;__stdcall&nbsp;GetCodeSectionEnd<span class="hl_char">(</span>FILE_IMAGE<span class="hl_char">*</span>&nbsp;pImage<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;iNum&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;__stdcall&nbsp;SetCodeSectionEnd<span class="hl_char">(</span>FILE_IMAGE<span class="hl_char">*</span>&nbsp;pImage<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwSectionEnd<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;iNum&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;__stdcall&nbsp;ShiftSections<span class="hl_char">(</span>IMAGE_HANDLE&nbsp;ihImage<span class="hl_char">,</span>&nbsp;IMAGE_SECTION_HEADER<span class="hl_char">*</span>&nbsp;psh<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwSectionSizeDisp<span class="hl_char">,</span>&nbsp;QWORD&nbsp;dwPageDisp<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>DWORD</b></span>&nbsp;__stdcall&nbsp;CreateNewSection<span class="hl_char">(</span>FILE_IMAGE<span class="hl_char">*</span>&nbsp;pImage<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;__stdcall&nbsp;RequestSizeOfCodeSection<span class="hl_char">(</span>FILE_IMAGE<span class="hl_char">*</span>&nbsp;pImage<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwSize<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;__stdcall&nbsp;CreateNewPage<span class="hl_char">(</span>FILE_IMAGE<span class="hl_char">*</span>&nbsp;pImage<span class="hl_char">,</span>&nbsp;QWORD&nbsp;dwAddress<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwSize<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">ADDED_PAGE<span class="hl_char">*</span>&nbsp;__stdcall&nbsp;FindPage<span class="hl_char">(</span>FILE_IMAGE<span class="hl_char">*</span>&nbsp;pImage<span class="hl_char">,</span>&nbsp;QWORD&nbsp;dwAddress<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;__stdcall&nbsp;GetSectionCharacteristics<span class="hl_char">(</span>FILE_IMAGE<span class="hl_char">*</span>&nbsp;pImage<span class="hl_char">,</span>&nbsp;QWORD&nbsp;dwAddress<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;__stdcall&nbsp;AnalyzeImage<span class="hl_char">(</span>IMAGE_HANDLE&nbsp;ihImage<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;__stdcall&nbsp;AnalyzeBlock<span class="hl_char">(</span>FILE_IMAGE<span class="hl_char">*</span>&nbsp;pImage<span class="hl_char">,</span>&nbsp;QWORD&nbsp;StartAddress<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwType<span class="hl_char">,</span>&nbsp;<span class="hl_function">void</span><span class="hl_char">*</span>&nbsp;pObject&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;__stdcall&nbsp;IsAPIFunc<span class="hl_char">(</span><span class="hl_function"><b>DWORD</b></span>&nbsp;dwMemAddress<span class="hl_char">,</span>&nbsp;<span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;sLibName<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;__stdcall&nbsp;GetSib<span class="hl_char">(</span>CMD_PRIMITIVE<span class="hl_char">*</span>&nbsp;ppr<span class="hl_char">,</span>&nbsp;INSTRUCTION<span class="hl_char">*</span>&nbsp;pCmd<span class="hl_char">,</span>&nbsp;QWORD&nbsp;dwAddress<span class="hl_char">,</span>&nbsp;SIB32<span class="hl_char">*</span>&nbsp;pSib<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>DWORD</b></span>&nbsp;__stdcall&nbsp;GetImmOperandSize<span class="hl_char">(</span>CMD_PRIMITIVE<span class="hl_char">*</span>&nbsp;ppr<span class="hl_char">,</span>&nbsp;INSTRUCTION<span class="hl_char">*</span>&nbsp;cmd<span class="hl_char">,</span>&nbsp;QWORD&nbsp;dwAddress<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;iOperandNum<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">bool&nbsp;__stdcall&nbsp;IsPrefixExist<span class="hl_char">(</span><span class="hl_function">BYTE</span><span class="hl_char">*</span>&nbsp;Bytes<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwLen<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;Prefix<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>BYTE</b></span>&nbsp;__stdcall&nbsp;GetRex<span class="hl_char">(</span><span class="hl_function">BYTE</span><span class="hl_char">*</span>&nbsp;Bytes<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwLen<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;__stdcall&nbsp;GetRegMask<span class="hl_char">(</span>INSTRUCTION<span class="hl_char">*</span>&nbsp;pCmd<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;OperandNum<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;__stdcall&nbsp;SetBlockRegMask<span class="hl_char">(</span>INSTRUCTION_BLOCK<span class="hl_char">*</span>&nbsp;pCmdBlock<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">ULONG&nbsp;__stdcall&nbsp;GetChanges<span class="hl_char">(</span>INSTRUCTION<span class="hl_char">*</span>&nbsp;pCmd<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;r32<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;__stdcall&nbsp;Recalculate<span class="hl_char">(</span>FUNCTION_BLOCK<span class="hl_char">*</span>&nbsp;pFuncBlock<span class="hl_char">,</span>&nbsp;INSTRUCTION_BLOCK<span class="hl_char">*</span>&nbsp;pCmdBlock<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwDelta<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>DWORD</b></span>&nbsp;__stdcall&nbsp;CalculateAddress<span class="hl_char">(</span>INSTRUCTION_BLOCK<span class="hl_char">*</span>&nbsp;pCmdBlock<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwReg<span class="hl_char">,</span>&nbsp;VALUE_DESC<span class="hl_char">*</span>&nbsp;pValue<span class="hl_char">,</span>&nbsp;QWORD&nbsp;dwStartAddress<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;__stdcall&nbsp;FindRegAddresses<span class="hl_char">(</span>FUNCTION_BLOCK<span class="hl_char">*</span>&nbsp;pFuncBlock<span class="hl_char">,</span>&nbsp;INSTRUCTION_BLOCK<span class="hl_char">*</span>&nbsp;pCmdBlock<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwReg<span class="hl_char">,</span>&nbsp;QWORD&nbsp;dwStartAddress&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;__stdcall&nbsp;FormatInstruction<span class="hl_char">(</span>QWORD&nbsp;Address<span class="hl_char">,</span>&nbsp;CMD_PRIMITIVE<span class="hl_char">*</span>&nbsp;pr<span class="hl_char">,</span>&nbsp;INSTRUCTION<span class="hl_char">*</span>&nbsp;cmd<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;s<span class="hl_char">[</span>0x100<span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>int</b></span>&nbsp;__stdcall&nbsp;FormatSIB<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;s<span class="hl_char">,</span>&nbsp;SIB32<span class="hl_char">*</span>&nbsp;pSib<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>int</b></span>&nbsp;__stdcall&nbsp;FormatPrefix<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;s<span class="hl_char">,</span>&nbsp;INSTRUCTION<span class="hl_char">*</span>&nbsp;pCmd<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>int</b></span>&nbsp;__stdcall&nbsp;FormatPrefix2<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;s<span class="hl_char">,</span>&nbsp;INSTRUCTION<span class="hl_char">*</span>&nbsp;pCmd<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>с неограниченным детектом префиксов
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368913&amp;user=24257&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=12" class="addthx" data-post="368913"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 20:09 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<b>DenCoder</b><br><br>Опишите плз подробно как там нужный функционал обрабатывается, длина и MRM.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368914&amp;user=40990&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=13" class="addthx" data-post="368914"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]redlord[/b]','')">redlord</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 33.4 (посетитель), 24thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.71'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2889">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 21:22 &middot; Поправил: redlord <br><script type="text/javascript">QU('redlord','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=redlord" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
intel xed<br>__https://software.intel.com/protected-download/267266/560870
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368918&amp;user=2889&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=14" class="addthx" data-post="368918"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 21:28 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
<b>redlord</b><br><br>Посмотрю спс(рипнуть из пина ?).<br><br>Пока получилось в таком виде.<br><br><img src="img/attach.gif" alt=""> <a href="./files/4f5a_27.10.2016_EXELAB.rU.tgz">4f5a_27.10.2016_EXELAB.rU.tgz</a> - Dasm.rar
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368919&amp;user=40990&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=15" class="addthx" data-post="368919"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2016 06:44 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
А вот интересно, с чем связана необходимость такой уж скорости работы, что приходится всякие урезанные примочки использовать?<br>Или размер? - тоже сомнительно. Полная реализация табличного дизассемблера 16/32 (DOS COM), по  опыту, имеет размер 15 килобайт.<br>Собирался когда-то сделать базонезависимую 32-бит его версию, да так и собираюсь до сих пор.<br>Алгоритм такого дизасма неплохо реализован в QVIEW.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368924&amp;user=35473&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=16" class="addthx" data-post="368924"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2016 11:00 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
<b>dosprog</b><br><br>На раскодировку запилен трассировщик, профайл определяет непосредственно дизасм длин. В идеале хочется достигнуть скорости лишь в несколько раз меньше, чем прямое исполнение, думаю это возможно. Табличная раскодировка в принципе идеальна, но вы можите привести пример её ?<br>Толку от вашего бинаря нету. Тот же xed известен давно, но его порт под свои задачи весьма сложен, с него dumpbin генерит 50М лога, а на изучение интерфейсов нужно времени не намного меньше, чем на запил своего мотора с нуля.<br><br>Трассировка через этот способ крэшила хром, эта апликуха трейсилась целиком. А крэшилось оно из за активного юзания симд набора, да и есчо с дельтаоффсетами(броузер вроде же не малварь). А если дизасм такое не умеет, то на данный момент он нафиг не нужен.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368929&amp;user=40990&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=17" class="addthx" data-post="368929"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2016 11:12 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
<b>difexacaw</b> нахрена трассировка.. это ж вообще ад! я вам в очередной раз рекомендую просмотреть тему про вирусню.. там вариаций было немеренно + оптимизированных.. <br>допустим.. чтоб повысить скокрость.. и сократить обьем кода.. народ искал сигнатуры определенных инструкций.. типа call jmp far .. и туда вливался.. полный дизасм длин, так же не так уж много занимает.. (это из серии.. ради одного колоска заводить целый комбаин) посмотрите код старых вирусов.. они в сорцах типа onehalf там достаточно все по феншую делалось. посмотрите как вирус по коду раскидывал куски метаполиморфного кода,  в те времена, люди еще заботились о качестве кода<br>ЗЫ <br>если у вас задача вливаться в рандомное место кода.. то прийдется строить карту процедур из сегмента кода.. а это уже достаточно сложный анализатор.. ито.. он идеальный не получится
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368930&amp;user=17319&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=18" class="addthx" data-post="368930"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2016 11:17 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
<b>VodoleY</b><br><br>&gt; я вам в очередной раз рекомендую просмотреть тему про вирусню..<br><br>Наверно вы не понимаете кому это советуете <img src="img/smilies/s1.gif" alt=""><br><br>Есть задача и найдено самое эффективное решение. Остались нюансы, требующие оптимизации, как сабж.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368931&amp;user=40990&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=19" class="addthx" data-post="368931"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2016 11:59 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
<b>difexacaw</b> задавайте правильные вопросы.. получайте правильные ответы. трассировка необходима ток в одном случае.. если вы хотите разрезельвить прыжки типа call eax.. и опять же... тут решения 2.. либо статическая либо динамическая эмуляция кода.. но подозреваю что вам так глубоко не интересно<br>ЗЫ я не буду уже углблятся.. в то что уже описано Крисом.. что это можно спец командами проца ловить.. но это уже привязка к железу и архитектуре. Есть метода таких себе хардварных бряков, на уровне проца
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368934&amp;user=17319&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=20" class="addthx" data-post="368934"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2016 17:29 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
<b>VodoleY</b><br><br>Какие хардверные остановы, я говорю про взятие под быструю отладку всего приложения или его части(процедуры или модуля). К примеру поиск в приложении ссылки на строку или отлов cupid, захват графом части кода етц - это задачи автоматики, dbi. Эмуляция не может дать профайл, только прямое исполнение. Те же к примеру точки останова в таком случае сводятся к установке маркера в кэш инструкций и нотифи при выборке из кэша.<br>Это активно юзается для множества задач, смотрите пример <noindex><a href="https://yadi.sk/i/atRcSatPuNqm4" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368944&amp;user=40990&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=21" class="addthx" data-post="368944"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]neshta[/b]','')">neshta</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.79'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41390">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2016 18:09 <br><script type="text/javascript">QU('neshta','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neshta" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
<I>difexacaw пишет: Для этого необходимо её пересобрать полностью - описать графом и сбилдеть в буфер.  </I><br><br>Как это работает я знаю. <img src="img/smilies/s1.gif" alt=""><br>Из скриптов что то стандартное собрать на c\c++ не проблема, собрать asm код\граф тоже не проблема, но проблема собрать драйвер с необходимым функционалом. Долго объснять, в данном случае речь о физической памяти, в общем забейте.<br><br>Ps. По поводу дизасма, то самый быстрый вариант это таблицы, быстрее в принципе ничего нет, а если скорости мало, то можно распараллелить в GPU. Выше писали о дизасме на фолтах, сгенерте с помощью него валидные таблицы или возьмете готовые (в сете полно и даже от intel есть), вряд ли вам нужно запихивать двиг в чужое приложение, следовательно плевать сколько памяти сожрут таблицы, в целом задача не отличима от подсчета хешей, табличные варианты быстрее, запилить функцию декодер, там кода на строчек 50-100, ибо готовое либо плюет на скорость или же убого в своей реализации и точности.<br><br><b>Добавлено спустя 2 минуты</b><br><I>VodoleY пишет: задавайте правильные вопросы.. получайте правильные ответы. трассировка необходима ток в одном случае </I><br><br>Да ладно, эмуляция, рекомпиляция, на малвари свет клином не сошелся, большая часть задач работает в обе стороны, ибо защита мало отличима от малвари.<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368949&amp;user=41390&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=22" class="addthx" data-post="368949"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40990" title="28-10-2016 15:26, ранг:18.9" target="_blank">difexacaw</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2016 18:17 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
<b>neshta</b><br><br>&gt;  проблема собрать драйвер с необходимым функционалом.<br><br>Мотор выше не привязан к моду, без разницы кернел или юзер, оберните сехом для безопасного доступа к коду.<br><br>&gt; Выше писали о дизасме на фолтах, сгенерте с помощью него валидные таблицы или возьмете готовые <br><br>Тот мотор(RLDE) использовал хардверную выборку данных и накопление длины при прекращении срабатывания ловушки. Это тормозной метод(для данной задачи, для статик годится), но он необходим для оценки любого прочего мотора, иначе как тестить ?<br><br>Табличная раскодировка. Необходимо описать три таблицы опкодов битмапой, где наличие MRM показано маркером и раскодировать MRM для определения её размера. Так же в этих картах понадобятся биты размера инструкций(помимо MRM). В принципе простая задача. Но нужно время на её запил, я к этому вернусь после решения приемлемым способом основной задачи.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368953&amp;user=40990&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=23" class="addthx" data-post="368953"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]neshta[/b]','')">neshta</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.79'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41390">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2016 18:35 &middot; Поправил: neshta <br><script type="text/javascript">QU('neshta','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neshta" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#24');return false;">#24</a> </span><div align=left><br>
<I>difexacaw пишет: Это тормозной метод(для данной задачи, для статик годится), но он необходим для оценки любого прочего мотора, иначе как тестить ? </I><br><br>Я знаю, как это работает, так тестировали еще на древних камнях, то бишь до intel.<br>Но иначе не собрать валидные таблицы, двиг то используется в своем движке, пох на эти несчастные крохи памяти, важна ведь скорость выполнения, одновременно не бывает хорошо.<br>Взять например расчет хеша, алго точно так же делятся на память и скорость, одно дело, когда нужно влезть в узкие рамки памяти и совсем другое когда нужно получить скорость чуть ниже аппаратного выполнения.<br><I>difexacaw пишет: Мотор выше не привязан к моду </I><br><br>Так он и отсутствует, нет бинарной реализации, а устанавливать wdk для сборки проблематично, ибо в паре мест сломает экосистему, поднимать vm тоже проблематично по некоторым факторам. Собрать буфер и пробросить указатель не проблема, хотя это можно сделать с движка, проблема именно в компиляции, огрызком драйвер не собрать, а огрызок довольно долго патчил под современный компиль, чтобы его ломать, но в тоже время им драйвер не собрать, починю другой комп и уже на нем соберу. <img src="img/smilies/s1.gif" alt=""><br><br>Ps. Здесь проскакивала mediana, неюзабельная, медленная хрень, довелось тестировать. Ко всему прочему автор отказался от поддержки, дескать посоны сурсы есть, разбирайтесь сами. udis86 тоже советовали, избыточен и довольно медленный, вариант llvm и тот лучше, хотя толст.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368955&amp;user=41390&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=24" class="addthx" data-post="368955"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 октября 2016 09:43 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#25');return false;">#25</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Какие хардверные остановы, я говорю про взятие под быструю отладку всего приложения или его части </I><br>это вы наверно не правильно меня поняли.. У Криса есть статья, взлом через покрытие кода. Там как раз рассматривались внутренние хардварные бряки, которые есть у некоторых интелов. можно ставить хардварные бряки на инструкции, которые ломают линейность кода. (call jmp ret jxx). Это самый быстрый способ построения графа кода. Бряки на прерываниях int 3 int 1 жутко тормазные.<br>PS я вобщем просто хотел упомянуть, что есть такая метода. Но там нужен драйвер. Эти инструкции есть не во всех процах, поэтому эта метода не прижилась. НО быстрее врядли можно будет чтото соорудить. (я про скорость работы) по факту, это наномиты на хардварном уровне
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368975&amp;user=17319&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=25" class="addthx" data-post="368975"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 октября 2016 09:55 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#26');return false;">#26</a> </span><div align=left><br>
<b>VodoleY</b><br><br>Нет, вы не понимаете. Любое срабатывание ловушки передаёт управление в ядро, где выполняется предварительна обработка и системные фиксы событий(трап процессинг) и возврат в юзер на диспетчер фолтов, из которого в свою очередь выполняется обратный вызов сервиса(NtContinue) для рестарта, возврата управления. Вся эта цепочка столь медленна, что не юзабельна для полного трейса апликухи, всё виснет.<br>Само событие переключения мода - передача управления в ядро и обратно, это крайне тяжёлая по профайлу операция, из за трансляций и валидаций(железячные фичи).<br><br>&gt; быстрее врядли можно будет чтото соорудить.<br><br>Прямое исполнение в буфере даёт профайл. Для элементарных операций эффективнее эмуляция, но в целом только это(прямое исполнение) единственно годный способ, учитывая всё.<br><br><b>Добавлено спустя 17 минут</b><br>Приведу вам профайл юзаемого ранее трассировщика(динамическая эмуляция, DYE):<br><br>За единицу принят тайминг прямого исполнения кода.<br><br>Хардверная(TF) трассировка через VEH: замедление в ~140 раз.<br>Хардверная трассировка без возврата в ядро(без перезагрузки контекста NtContinue): 80.<br>Динамическа эмуляция(с крайне тормозным ядром): 10.<br>Под отладочным портом замедление невероятно, это сотни тысяч раз.<br><br>Со всеми оптимизациями(дизасм длин, кэш инструкций и прочее) я уверен что можно достичь профайла лишь в несколько раз ниже прямого исполнения, в таком случае это получается совершенное решение, так как замедление работы приложения фактически будет отсутствовать.<br><br><b>Добавлено спустя 13 часов 2 минуты</b><br>Потестил xed, он медленее в ~9 раз dizahex&#039;a.<br><br><b>Добавлено спустя 13 часов 19 минут</b><br>Семпл.<br><br><img src="img/attach.gif" alt=""> <a href="./files/f947_30.10.2016_EXELAB.rU.tgz">f947_30.10.2016_EXELAB.rU.tgz</a> - xed.rar
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368976&amp;user=40990&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=26" class="addthx" data-post="368976"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]sen[/b]','')">sen</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 39.6 (посетитель), 21thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.26'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1582">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 октября 2016 04:16 <br><script type="text/javascript">QU('sen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sen" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#27');return false;">#27</a> </span><div align=left><br>
<b>difexacaw</b><br>в чем конкретная кривизна ?<br><br>и нет, никакого отношения дила к хиеву не имеет, от слова совсем
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369032&amp;user=1582&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=27" class="addthx" data-post="369032"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 октября 2016 04:18 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#28');return false;">#28</a> </span><div align=left><br>
<b>sen</b><br><br>Не проходил тесты на рандом буфере.<br>Может это не с хьюва дизасм, но на его сайте.<br>Пока лучше dizahex&#039;a ничего не нашлось.<br><br><b>Добавлено спустя 4 минуты</b><br>Есть при тестах один нюанс, инструкция может быть не корректна, такое событие нужно вручную отфильтровать при тестах, но есть иной путь. Можно сгенерить десятки тысяч инструкций автоматикой(системный код) и натравить на них тестируемый мотор.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=369033&amp;user=40990&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=28" class="addthx" data-post="369033"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]sen[/b]','')">sen</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 39.6 (посетитель), 21thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.26'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1582">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 04:08 <br><script type="text/javascript">QU('sen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sen" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#29');return false;">#29</a> </span><div align=left><br>
<b>difexacaw</b><br>просто пальцем покажи что не так - я исправлю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369075&amp;user=1582&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=29" class="addthx" data-post="369075"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=41518" title="01-11-2016 03:53, ранг:0.0" target="_blank">parfetka</a>, <a href="action=userinfo&user=2585" title="01-11-2016 06:17, ранг:1004.0" target="_blank">Gideon Vi</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 07:18 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#30');return false;">#30</a> </span><div align=left><br>
<img src="img/smilies/s5.gif" alt=""> Та он ужэ забыл<br><br><br><I>difexacaw пишет:<br>Тогда во первых соберите это норм компилем, ну что бы не было пустых пространств и прочего треша.  </I><br><br>) Слышишь, чудик, хорош уже глупости городить.  Ты где там &quot;пустые пространства&quot; увидел, а?<br>)) Какой нахер &quot;нормальный конпиль&quot; - ты чо вообще<br>) Оно бы и хер бы  с твоими глупостями, если б ты при этом на других людей языком лязгать не пытался.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369080&amp;user=35473&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=30" class="addthx" data-post="369080"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40990" title="01-11-2016 17:41, ранг:20.7" target="_blank">difexacaw</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 18:38 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24393&amp;page=1#31');return false;">#31</a> </span><div align=left><br>
<b>sen</b><br><br>Если исправить можите, то у вас есть сурц и значит вы автор. Тогда во первых соберите это норм компилем, ну что бы не было пустых пространств и прочего треша. Ну а я в свою очередь соберу тулз для теста таких моторов.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=369113&amp;user=40990&amp;forum_n=3&amp;topic=24393&amp;page=1&amp;anchor=31" class="addthx" data-post="369113"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=24393&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=24393&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=3&amp;topic=24393&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=3&amp;topic=24393&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=3&amp;topic=24393&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Дизасм.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24393" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
