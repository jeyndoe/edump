<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Распаковка AsProtect на примерах - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте! Очень прошу, помогите найти или выдайте пжалста из запасов прогу Advanced Archive Password Recovery v.3.00 кто может, очень хочется научиться распаковке, а проги нормальной нет. Далее повтор моего вчерашнего">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=42623'>site-pro</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a>, <a target='_blank' href='?action=userinfo&amp;user=35066'>artyavmu</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка AsProtect на примерах</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=9.html">&lt;&lt;</a> <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=0.html">1</a> ... <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=9.html">10</a> . <b>11</b> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=11.html">12</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=12.html">13</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=11.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2007 12:10 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте! Очень прошу, помогите найти или выдайте пжалста из запасов прогу Advanced Archive Password Recovery v.3.00 кто может, очень хочется научиться распаковке, а проги нормальной нет. Далее повтор моего вчерашнего письма(лежит в чужой теме, найти можно в поиске введите: Распаковка ASProtecta - моё сообщение самое свежее)<br>----------------------------------------------------------------------  ------------------------------------------------------------------<br>Здравствуйте. Понимаю, что лезу немного не туда, но обсуждения статьи &quot;Распаковка нового ASProtect на примере Advanced Archive Password Recovery v.3.00&quot; автора SergSh на форуме и в поисковике вроде бы не видно(может статья просто древняя), а тут вроде бы тоже у ASR-ра 2-я версия. Суть проблемы:<br><br>1 Сам по вашим статьям научился распаковывать ASProtect 1.22-1.23 ,1.23 RC4, 1.24(проги типа Electra, Куриная месть.Первая разборка, скринсейвер и т.д. с затиранием репой краденого начала проги и без).<br><br>2 Нужно двигаться дальше и тут с удивлением обнаруживаю, что статей по распаковке версий 1.3-2.0 нет вааще(может я в шары долблюсь, незнаю). Плиз, если можно, то ссылку на подобную статью, а то руководство как починить велосипед есть(1.21-1.22), как починить мопед-есть(1.23 RC4), как починить боинг747 и космический челнок-есть(2.0x-2.12xx и выше). А вот как отремонтировать просто машину нет.<br><br>3 Из всех имеющихся статей более всего понятно было у SergSh в &quot;Распаковка нового ASProtect на примере Advanced Archive Password Recovery v.3.00&quot;, но тут такой казус. Проискав в инете подопытную прогу версии 3.0 нашел две ссылки, скачал, инсталятор обещал версия 3.0 (как в статье),- в итоге версия 3.01, чем забиты все ссылки на эту прогу в инете и PEID говорит не ASProtect 1.2-1.3 registered(2.0x по словам SergSh),а ASProtect 2.1x SKE. Ну ладно:<br><br>а)34раз Shift+F9 ставим бряк на ближайший переход внизу, ещё раз Shift+F9, снимаем бряк,ставим на Alt+M на секцию кода(401000), но не снова Shift+F9, как в статье, а trace into(а то EOP будет на две команды ниже и затруться два Push-а). Останавливаемся на EOP 42A910. Ctrl+A и всё видится чинно и благородно.<br><br>б)Читаем статейку дальше и пробуем запустить его скрипт(в папку его,в Script , в Олю, в виде txt предварительно). И оля повисает пробовал подождать 1,5 часа думал это скрипт так долго на более свежей версии ASp-ра трудится(хрен то там:s14. Запущено как положено без бряков и с OEP после trace into и я в plugin-&gt;IsDebuggerPresent -&gt;Hide, с полным игнором исключений.<br><br>в) Руками по его совету IAT пока не пробовал, всё так пока трудно для понимания и непривычно и завтра на работу а уже 2ночи. Граждане, слезно молю дайте ссылку на настоящий Advanced Archive Password Recovery v.3.00, а то шатл починить не могу пока, дайте хоть чертежи к боингу. А если почти серьезно, то научиться распаковывать ASPr до второй версии включительно руками хочется так, что аж эти руки зудят.<br><br>P.S. Не пинайте сильно за дурацкие просьбы самого маленького. Это первый выход в свет. Начал реверсить 18.12.06 с нуля. Реверсил даже в новогоднюю ночь. Для меня это очень важно(научиться распаковывать)!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=115630&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=1" class="addthx" data-post="115630"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 августа 2007 22:25 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#2');return false;">#2</a> </span><div align=left><br>
Привет всем. Пока порадовать почти нечем. Была идея загрузить этот файл с вынесенной таблицей импорта в китайский скрипт, а затем подсмотреть как он будет разбираться с необходимостью такого количества свободного места и куда втискает таблицу, однако китаец прогу тоже не осилил. Пишет ещё что неизвестная версия 1.32-2х, хотя Вера говорила 2-2.3.<br>Повозившись ещё с кодом, я начинаю подумывать, а не поступить ли по известной пословице:&quot;Если гора не идет к Магомеду, то Магомед ищет динамит.&quot;<br>Завтра попробую переписать всю секцию с таким подозрительным импортом в первую секцию Аспра, вплотную примыкающую к концу проги(благо размер её офигенный 103000, а мне нужно то всего С000, тоесть раз в 20 меньше). В этой секции пару тысяч сначала и несколько сотен в конце какого то кода. Если пустит обязательно там расположусь с комфортом. Затем поменяю все переменные в скрипте так как если бы это была последняя секция проги, а в заключении скрипта поменяю PE-заголовок и тем самым припаяю новую секцию. Я надеюсь дампер его схавает. Я правда не знаю, но думаю, что он PE читает и оттуда берет всю информацию о дампе.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150457&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=2" class="addthx" data-post="150457"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]vnekrilov[/b]','')">vnekrilov</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 329.6 (мудрец), 192thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.08'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=5173">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 12:56 <br><script type="text/javascript">QU('vnekrilov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vnekrilov" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#3');return false;">#3</a> </span><div align=left><br>
Для всех читателей этого топика. Сегодня CrackL@b на <a href="http://www.exelab.ru/rar/dl/CRACKLAB.rU_76.rar" target="_new">http://www.exelab.ru/rar/dl/CRACKLAB.rU_76.rar</a><br>выложил мою статью по распаковке Asprotect v2.2 SKE. В ней я постарался раскрыть кое-какие вопросы, которые могут быть полезны для юзеров, занимающихся распаковкой Asprotect.<br>Буду признателен за замечания, предложения и пожелания.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151731&amp;user=5173&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=3" class="addthx" data-post="151731"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]kaiZer[/b]','')">kaiZer</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 161.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6835">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 14:12 <br><script type="text/javascript">QU('kaiZer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kaiZer" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#4');return false;">#4</a> </span><div align=left><br>
<b>vnekrilov</b><br>Респект и уважуха!<br>Как всегда крутая и полезная статья!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151745&amp;user=6835&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=4" class="addthx" data-post="151745"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2007 23:21 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#5');return false;">#5</a> </span><div align=left><br>
<b>vnekrilov</b> респект, как всегда молодчина! <img src="img/smilies/s2.gif" alt=""><br>Именно этого я и хотел,- чтобы топик постепенно становился центром восстановления пробелов знаний в распаковке Аспров. <img src="img/smilies/s1.gif" alt=""><br><br>Несколько уточнений :<br><br>Поскольку сейчас все начнут изучать статью, то вот ссылка на рассматриваемую там прогу<br>_http://gridinsoft.com/download.php?chmeditor (что то по ссылке которая в статье я ее не нашел, мож в шары долблюсь)<br><br>Всё таки, по последним данным версия прота навешанного на прогу  1.35 build 04.25 Release (что совсем не умаляет достоинств автора статьи, да и самой статьи)об этом говорит новая, но видимо перспективная прога ASPrINFO v 1.4, берущая данные версии Аспра из самого навешанного прота(не по сигнатурам). Вот перекрёстная ссылка на скачивание последних версий.<br>_http://tlg.1gb.ru/board/showtopic=549&amp;pid=1777&amp;st=0&#entry1777<br>Ах да ссылка на ветку, где обсуждается новая тулза:<br>_http://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9415<br><br>Саму статью прочитал частично, из достоинств сразу бросается в глаза доступность языка которым она написана. Более подробно посмотрю завтра.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151855&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=5" class="addthx" data-post="151855"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 августа 2007 22:26 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#6');return false;">#6</a> </span><div align=left><br>
Привет всем! Применив вот такой незамысловатый код в скрипте я нарастил число секций на одну,общий размер образа, размеры последней секции проги (в заголовке всё это в заголовке) и затем добавил в описание секций, описание самой аспровой секции (виртуальный адрес 00390000, её собственный размер 103000 и попробовал две характеристики F00000E0 //F0000060, имя ей не давал). Дамп, то ещё можно Lord_PE снять(он видит и новую секцию, и новые размеры, и все характеристики), Оллидамп не видит изменений в заголовке и не дампирует.<br><br>nachalo_sec:  <br>  mov eip,00400000<br>  find eip,#5045#    //находим PE-заголовок<br>  cmp &#036;RESULT,0<br>  je no_PE<br>  mov addr_PE,&#036;RESULT<br>  mov temp2,addr_PE + 6<br>  mov temp3,[temp2]<br>  mov [temp2],temp3 + 1   //меняем число секций<br>  mov temp2,addr_PE + 50<br>  mov temp3, sec_end + sec_IAT_size<br>  sub temp3, 00400000<br>  mov [temp2], temp3    //меняем размер образа<br>  GMEMI prog_end -1000,MEMORYBASE<br>  mov temp5,sec_end - &#036;RESULT<br>  mov temp4, &#036;RESULT - 00400000//<br>  find addr_PE, temp4 <br>  mov temp2,&#036;RESULT<br>  cmp temp4,FFFF<br>  jb small_size<br>  cmp temp4,FFFFFF<br>  jb norm_size<br>  sub temp2,2<br>  jmp small_size<br>norm_size:<br>  sub temp2,1  <br>small_size: <br>  //mov [temp2],temp4  //<br>  sub temp2, 4<br>  mov [temp2], temp5 //новый размер бывшей последней секции(была 1000, стала 10000 вплоть до Аспр секции)<br>  add temp2, 28<br>  mov [temp2], sec_IAT_size //размер новой последней секции(как и была у Аспра 103000)<br>  add temp2, 4<br>  mov temp3, sec_end - 00400000<br>  mov [temp2], temp3  // виртуальный адрес новой последней секции.<br>  add temp2, 18<br>  mov [temp2], F00000E0 //F0000060  характеристики новой последней секции взятой у Аспра<br>  jmp chistka<br>no_PE:  <br>  eval &quot;Не могу найти PE-заголовок! Это не PE-файл.&quot;<br>  msg &#036;RESULT<br>  jmp @halt<br><br>Но вот главная <img src="img/smilies/s16.gif" alt=""> - это попытаться восстановить импорт в импректе. Он как упёртый показывает старый размер образа 281000 вместо 393000 (281000- старые, F000-нарастили бывшую последнюю секцию, 103000-сама последняя бывшая Аспровая секция, а нынче наша последняя секция). Поэтому даже если принудить импрект распознать импорт, загнать OEP и всё такое, он начисто отказывается цеплять импорт к дампу полученному лордом.<br><br>Пробовал перед этим не трогать нашу бывшую последнюю секцию, а только вносить изменения касающиеся Аспр секции. Дамп прокатывал у оллидампа, импрект восстанавливал и цеплял к дампу импорт, вместо последней секции размером 103000 по адресу 690000, получаем какого то микроба 1000 по адресу 681000(тоесть после окончания проги на 681000 ещё на штуку секция) при этом у дампа в заголовке красуются все требуемые размеры(хрень какая то :s10<img src="img/smilies/s1.gif" alt=""><br>Я понимаю, что выравнивание на 1000 стоит, ну дак я во втором варианте продлил последнюю секцию проги на F000 прям до начала Аспровой и аспровая оформлена как последняя родная.<br><br>Почему Lord_PE дамп на ура снимает, а Оллидамп нет. Аналогично почему Импрект не читает новые данные из PE-заголовка и где он берёт старые если скрипт уже поменял все в PE-секции.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=152217&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=6" class="addthx" data-post="152217"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 августа 2007 15:04 &middot; Поправил: Maximus <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#7');return false;">#7</a> </span><div align=left><br>
<b>Small_S</b> ImpRec заголовок берет с диска, и у импрека есть соответствующая галка в настройках ;)<br>Use PE Header From Disk
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=152309&amp;user=2775&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=7" class="addthx" data-post="152309"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 августа 2007 03:55 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#8');return false;">#8</a> </span><div align=left><br>
<b>Maximus</b> спс, вот что значит невнимательность. Однако после проведенных превращений секции есть, т.е. в Оле я файл открываю, смотрю, а в новой (бывшей Аспр-секции) нули, вместо того, что там было. Ладно сейчас нет пока времени, ещё посмотрю позже. Наверно всё таки лорд почему то не дампит эту секцию, а только повинуясь PE-заголовку выделяет место с нулями(хотя фулл дамп должен быть).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=152425&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=8" class="addthx" data-post="152425"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 августа 2007 04:11 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#9');return false;">#9</a> </span><div align=left><br>
Привет всем. Наконец вчера выпало немного времени посмотреть что там с дампом(просто смотрел в винхексе дампы до и после импректа). Оказалось, что действительно, лорд плохо снимал дамп приобретенных секций. Как только все манипуляции по снятию фуллдампа были проведены в PETools 1.5 я сразу увидел содержимое аспр-секции в дампе, как до, так и после импректа.<br>Но ещё пока рано радоваться ибо секция аспра только на чтение, как будет время по мучаю её в скрипте чтоб открылась на запись.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=152701&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=9" class="addthx" data-post="152701"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Amok[/b]','')">Amok</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.2'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4595">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 августа 2007 17:29 <br><script type="text/javascript">QU('Amok','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Amok" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#10');return false;">#10</a> </span><div align=left><br>
<I>Small_S пишет:<br>mov eip,00400000<br>find eip,#5045# //находим PE-заголовок  </I><br><br>Все ИМХО. <b>Small_S</b> твой скрипт будет работать токо если ImageBase равен 00 40 00 00. Загрузи в ольку виндусовский блокнот и попробуй найти РЕ-заголовок своим скриптом.<br>Кусок из скрипта PE_Kill&#039;а.<br>//================================================<br>// Получаем ImageBase брутом, т.к. оля иногда не <br>// хочет дать его нормальным способом<br>//================================================<br> mov addr,eip<br> and addr,FFFFF000<br> add addr,1000<br>@get_base:<br> sub addr,1000<br> mov temp,[addr]<br> and temp,0000FFFF<br> cmp temp,00005A4D<br> jne @get_base
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=152791&amp;user=4595&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=10" class="addthx" data-post="152791"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 августа 2007 18:02 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#11');return false;">#11</a> </span><div align=left><br>
<b>Amok</b> ну конечно, можно и так. Потом универсализирую. Сейчас меня больше интересует где Аспр хранит данные о своих выделенных участках памяти? Ведь должен же у него быть аналог PE-заголовка(что то подобное), где размещаются данные о размерах, доступах на чтение или запись.<br><br>Добавил: я правда ещё сам не искал, а что то сегодня на работе подумалось,- а взять ещё в OEP-фаиндере(скрипте) найти место, что отвечает за свойства секций, да там ее открыть на запись, да и не мучаться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=152806&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=11" class="addthx" data-post="152806"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2007 14:59 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#12');return false;">#12</a> </span><div align=left><br>
Привет всем. Вчера появилось немного времени и я попытался продолжить работу по переносу таблицы IAT хрен знает откуда в большую крайнюю секцию аспра. Вот тут приходиться вернуться к рассматривавшемуся ранее вопросу. А именно VirtualProtect (по крайней мере на этом выделенном участке памяти)не работает. По порядку.<br><br>1. Прописал в скрипте поиск этой секции(на некоторых прогах и машинах она не примыкает вплотную к проге). Это к делу относится мало.<br><br>2. Итак имеем на асме вставку:<br>00400D00====PUSH 0BF0100 //эта секция заведомо открыта поэтому олд и пишу сюда<br>00400D05====PUSH 4<br>00400D07====PUSH EBX<br>00400D08====PUSH EAX<br>00400D09====CALL kernel32.VirtualProtect<br>00400D0E====NOP<br>00400D0F====NOP<br>00400D10====ADD BYTE PTR DS:[EAX],AL<br><br>В стеке по достижению кела имеем нормальную структуру этой апи<br>0012FF64   00760000  |Address = 00760000<br>0012FF68   00103000  |Size = 103000 (1060864.)<br>0012FF6C   00000004  |NewProtect = PAGE_READWRITE<br>0012FF70   00BF0100  \pOldProtect = 00BF0100<br><br>Идём по F7 в процедуру:<br>7C801AD0 &gt;  8BFF                    MOV EDI,EDI<br>7C801AD2    55                      PUSH EBP<br>7C801AD3    8BEC                    MOV EBP,ESP<br>7C801AD5    FF75 14                 PUSH DWORD PTR SS:[EBP+14]<br>7C801AD8    FF75 10                 PUSH DWORD PTR SS:[EBP+10]<br>7C801ADB    FF75 0C                 PUSH DWORD PTR SS:[EBP+C]<br>7C801ADE    FF75 08                 PUSH DWORD PTR SS:[EBP+8]<br>7C801AE1    6A FF                   PUSH -1<br>7C801AE3    E8 75FFFFFF             CALL kernel32.VirtualProtectEx<br>7C801AE8    5D                      POP EBP<br>7C801AE9    C2 1000                 RETN 10<br><br>В стеке она формирует структуру похожую на предыдущую:<br>0012FF48   FFFFFFFF  |hProcess = FFFFFFFF<br>0012FF4C   00760000  |Address = 00760000<br>0012FF50   00103000  |Size = 103000 (1060864.)<br>0012FF54   00000004  |NewProtect = PAGE_READWRITE<br>0012FF58   00BF0100  \pOldProtect = 00BF0100<br>и ныряет в CALL kernel32.VirtualProtectEx<br><br>там нырок в ntdll.ZwProtectVirtualMemory<br>в нём <br>7C90DEB6 &gt;  B8 89000000             MOV EAX,89<br>7C90DEBB    BA 0003FE7F             MOV EDX,7FFE0300<br>7C90DEC0    FF12                    CALL DWORD PTR DS:[EDX]<br>7C90DEC2    C2 1400                 RETN 14<br><br>нырок в ntdll.KiFastSystemCall<br>а там вообще в нулевое кольцо<br>7C90EB8B =  8BD4  =                  MOV EDX,ESP<br>7C90EB8D =  0F34  =                  SYSENTER<br>7C90EB8F =  90    =                  NOP<br>7C90EB90 =  90    =                  NOP<br>7C90EB91 =  90    =                  NOP<br>7C90EB92 =  90    =                  NOP<br>7C90EB93 =  90    =                  NOP<br>7C90EB94 =  C3    =                  RETN<br><br>далее вызываются ещё<br>CALL &lt;JMP.&amp;ntdll.RtlFlushSecureMemoryCache&gt;<br>и много ещё какой то жути, итог печален eax возвращает 0(должно быть не ноль)<br>Причём олд(старые настройки или что то вместо них) в указанном месте пишутся: <br><br>00BF0100  80000004  ..Ђ<br>00BF0104  00000000  ....<br>00BF0108  00000000  ....<br><br>в заключении карта памяти после проги:<br>Address=00690000  Size=00003000 (12288.)  Type=Map  00041020  Access=R E  Initial access=R E<br>Address=00750000  Size=00002000 (8192.)   Type=Map  00041020  Access=R E  Initial access=R E<br>Address=00760000  Size=00103000 (1060864.)Type=Map  00041002  Access=R    Initial access=R<br>последняя секция как раз та, что нам нужна для записи.<br><br>Из всего вышенаписанного возникает очень волнующий меня вопрос,- <b>есть ли что нить круче VirtualProtect-а?</b> Какая нить Апи, которая открывает доступ даже в этом случае(ведь какая то зараза понаписала в этом участке памяти кило полтора вначале и ближе к концу примерно столько же, значит можно). Или чего? Слишком много хочу? Что за этим прийдётся учиться лезть в ноль кольцо?<br><br>И ещё этот участок висит в памяти с самого начала(тоесть оля как подгрузила прогу в себя так он уже там). Есть у Оли возможность посмотреть что происходит с момента  нажатия кнопки открыть до остановки на EP? Или только  смотреть одну ольку другой?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=154721&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=12" class="addthx" data-post="154721"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]NIKOLA[/b]','')">NIKOLA</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/247.jpg" alt=""><br><span class=txtSm>Ранг: 500.6 (<b>!</b>), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.87'>Активность: 0.26<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=247">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2007 18:12 <br><script type="text/javascript">QU('NIKOLA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NIKOLA" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#13');return false;">#13</a> </span><div align=left><br>
<b>Small_S</b><br><br>А почему-бы не создать новую секцию?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=154762&amp;user=247&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=13" class="addthx" data-post="154762"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2007 20:50 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#14');return false;">#14</a> </span><div align=left><br>
<b>NIKOLA</b> тогда несколько встречных вопросов. <br><br><b>Вариант первый </b>предлагаемый тобой. Вот карта памяти хвоста проги и начала участка выделенных регионов памяти.<br>Address=00680000 Size=0000D000 (53248.) .adata Type=Imag 01001002  Access=R  Initial access=RWE<br>Address=00690000 Size=00003000 (12288.)            Type=Map 00041020 Access=R E Initial access=R E<br>Address=00750000 Size=00002000 (8192.)              Type=Map 00041020 Access=R E Initial access=R E<br>Address=00760000 Size=00103000 (1060864.)        Type=Map 00041002 Access=R Initial access=R <br><br>В проге выравнивание 1000, в регионах 10000. Нам нужно прицепить существующую, создать новую или продлить последнюю существующую на С000(именно такой размер у участка выделенной памяти куда перемещён весь IAT). Хотелось бы ещё тысяч 10000 дополнительно чтобы гарантированно помещался результат работы любого скрипта над любой VM(тоесть хотя скрипт работает с импортом, но и о VM сразу позаботиться- максимальная автоматизация будущих действий).<br>Может я ошибаюсь и несу чушь,но за последней секцией проги, что по адресу 680000(размер D000) может уместиться секция не более 690000-68D000= 3000h. Добавлять большую секцию, если я верно понял получится только в хрен знает какие высокие адреса. Вот аспр же вроде добавляет участки выделенки по всё более высоким адресам в хвост(наблюдал как по 1000h участков всё больше и больше и адреса всё выше и выше). Вроде не видел чтобы он отодвигал старые участки в более высокий адрес и вставлял на их место новые. Сразу два вопроса по этому варианту:<br><br>a) Ну добавить в пе-заголовке новую секцию  из скрипта пара пустяков(см выше), а вот как из скрипта или из асм-вставки заставить Олю перечитать PE и самое главное отобразить в карте памяти новую секцию? (я пока не умею и описания не встречал).<br>б) Как поведут себя те секции аспра, которые мы таким созданием новой секции станем затирать(те что дышат в хвост проге)?<br>Может это всё просто и кто то даже посмеётся над двумя этими вопросами, но я не профи и только учусь низкоуровневому кодингу.<br><br><b>Вариант второй</b> в начале у меня была  мысль просто добавить из скрипта размер последней секции проги. Но в этом варианте всё также и снова читаем вопросы а) и б)<br><br><b>Вариант три</b>, то что я сейчас пытаюсь сделать,- изменить атрибуты нужной мне уже готовой секции аспра записать туда всё, что осталось от IAT, восстановить её в этой секции, изменить по проге вызовы IAT, на новое место, ну и дампить вместе с чужой секцией и новыми данными в PE(это я уже умею см выше). В последующем использовать кучу места там где потребуется работа над VM.<br><br>Причём, дело уже не в этой проге(она просто удобный полигон для работы над импортом - импорт в выделенке, OEP без VM, всё видно, классический двиг от PE-kill-а не берёт, китаец тоже, распакованный вариант есть на случай буксования). Меня раздражает мысль, что я пока не умею делать со своими и чужими секциями, всё что нужно мне, а не Биллу или Жене.  <img src="img/smilies/s10.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=154812&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=14" class="addthx" data-post="154812"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]NIKOLA[/b]','')">NIKOLA</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/247.jpg" alt=""><br><span class=txtSm>Ранг: 500.6 (<b>!</b>), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.87'>Активность: 0.26<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=247">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2007 21:52 &middot; Поправил: NIKOLA <br><script type="text/javascript">QU('NIKOLA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NIKOLA" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#15');return false;">#15</a> </span><div align=left><br>
<b>Small_S</b><br><br>По поводу VirtualProtect, почему у тебя не получается, смотри, параметры у тебя в VirtualProtectEx:<br>hProcess = FFFFFFFF<br>тобиш олькин, а тебе нужен хэндл отлаживаемого процесса.<br><br>Попробуй на прямую через VirtualProtectEx, у казав конкретный хэндл.<br><br>BOOL VirtualProtectEx(<br><br>    HANDLE hProcess,	// handle of process <br>    LPVOID lpAddress,	// address of region of committed pages <br>    DWORD dwSize,	// size of region <br>    DWORD flNewProtect,	// desired access protection <br>    PDWORD lpflOldProtect 	// address of variable to get old protection  <br>   );<br><br>Так, на всякий случай.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=154823&amp;user=247&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=15" class="addthx" data-post="154823"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 августа 2007 09:59 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#16');return false;">#16</a> </span><div align=left><br>
Спс за дельный совет, я честно говоря, думал, что хендл будет браться автоматически поскольку код<br>вызывается из тела проги. Вечером буду пробовать когда с работы приду. Кста, не знаешь как зовется Апи возвращающая хендл текущего процесса( по<br>аналогии с &quot;Функция GetCurrentDirectory получает текущую директорию для текущего процесса.&quot;) Это из <br>одной статьи. Я сейчас на работе и с собой только русские небольшие справочники(по 500-800 фунок)<br><br>Там только более менее близкая :<br>GetProcessHeap возвращает идентификатор кучи вызывающего процесса<br>Handle := HeapAlloc (GetProcessHeap(), 0, dwBytes);<br><br>Но это видимо не то, что мне нужно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=154896&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=16" class="addthx" data-post="154896"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 августа 2007 11:49 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#17');return false;">#17</a> </span><div align=left><br>
<I>Small_S пишет:<br> Кста, не знаешь как зовется Апи возвращающая хендл текущего процесса </I><br><br>GetCurrentProcess <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=154915&amp;user=72&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=17" class="addthx" data-post="154915"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 августа 2007 15:18 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#18');return false;">#18</a> </span><div align=left><br>
<b>Hellspawn</b> спс, м-да туплю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=154951&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=18" class="addthx" data-post="154951"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 августа 2007 20:25 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#19');return false;">#19</a> </span><div align=left><br>
К сожалению GetCurrentProcess  возвращает олькин хендл, т.е. FFFFFFFF. Млинн, я уже все апишки, что упоминаются на странице с GetCurrentProcess  в дельфовой справке по мелкософту перепробовал, а именно:<br><br>DuplicateHandle -дает в EAX вообще ноль, <br><br>GetCurrentProcessId - выдает Id проги 450, а у оли  70(я это увидел в импректе там в скобках пишется) тоесть ID разделяет правильно у текущего процесса, но по иду VirtualProtectEx работать не будет.<br><br>GetCurrentThread - выдает FFFFFFFE, но и это также не то.<br><br>Хелп!  <b>Как взять хендл процесса из под Ольки чтобы она своим не перекрывала?</b> <img src="img/smilies/s14.gif" alt=""> <img src="img/smilies/s15.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=154998&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=19" class="addthx" data-post="154998"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 августа 2007 20:31 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#20');return false;">#20</a> </span><div align=left><br>
<I>Small_S пишет:<br>GetCurrentProcess возвращает олькин хендл, т.е. FFFFFFFF </I><br><br>не много не так))) он возвращает хендл текущего процесса, а так как твой скрипт работает от плагина<br>для ольги, то соотв. процесс будет тоже ольгин... Вроде так -_-<br><br>дальше, ид ты получил, открой процесс и всё OpenProcess(...) - где один из параметров ид <img src="img/smilies/s1.gif" alt=""><br>функа вернёт хендл...
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=154999&amp;user=72&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=20" class="addthx" data-post="154999"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 августа 2007 20:55 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#21');return false;">#21</a> </span><div align=left><br>
<b>Hellspawn</b> респектище, на одних только твоих ответах в этом топе уже наверное несколько суток времени съэкономил.<br><br>Ещё одно маленькое уточнение:<br><br>HANDLE OpenProcess(<br><br>    DWORD dwDesiredAccess,	// access flag &lt;--------------------------- тут 11 флагов хотелось бы уточнить<br>    BOOL bInheritHandle,	// handle inheritance flag<b>&lt;----------------------- тут единица или ноль  можно его наследовать или нет, тоже понятно</b> <br>    DWORD dwProcessId 	// process identifier <b>&lt;------------------------- про ид понятно</b><br>   );<br><br>DWORD dwDesiredAccess - мне будет нужен, как я понял флаг <b>PROCESS_VM_OPERATION</b> <br>Так как написано:<br>Enables using the process handle in the VirtualProtectEx and WriteProcessMemory functions to modify the virtual memory of the process.<br><br>- это какая цифра будет в даблворде?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155004&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=21" class="addthx" data-post="155004"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 августа 2007 21:43 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#22');return false;">#22</a> </span><div align=left><br>
<i class=x>  PROCESS_TERMINATE         = &#036;0001;<br>  PROCESS_CREATE_THREAD     = &#036;0002;<br>  PROCESS_VM_OPERATION      = &#036;0008;<br>  PROCESS_VM_READ           = &#036;0010;<br>  PROCESS_VM_WRITE          = &#036;0020;<br>  PROCESS_DUP_HANDLE        = &#036;0040;<br>  PROCESS_CREATE_PROCESS    = &#036;0080;<br>  PROCESS_SET_QUOTA         = &#036;0100;<br>  PROCESS_SET_INFORMATION   = &#036;0200;<br>  PROCESS_QUERY_INFORMATION = &#036;0400;</i><br><br>на всяк...<br><br>BOOL bInheritHandle - тут false <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=155018&amp;user=72&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=22" class="addthx" data-post="155018"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2007 18:56 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#23');return false;">#23</a> </span><div align=left><br>
Привет всем. <b>Hellspawn</b> ещё раз спс за константы. Привожу ниже код асм вставки. Всё стало канать почти везде, но VirtualProtect почемуто не берет участки выделенной памяти имеющие атрибуты Map. Ну всё остальное хоть где оно, меняет(пробовал в теле проги, выше проги, ниже проги).<br><br>CALL kernel32.GetCurrentProcessId<br>PUSH EAX<br>PUSH 0<br>PUSH 8<br>CALL kernel32.OpenProcess<br>PUSH 7A0100------------------------- <b>токо начало и размер в ebx и ecx, соответственно надо задавать после</b> <br>PUSH 4---------------------------------<b>бряка здесь иначе OpenProcess засунет в ecx какую нибудь лабуду и кина</b><br>PUSH ECX----------------------------- <b>не будет у VirtualProtectEx-а.</b><br>PUSH EBX<br>PUSH EAX<br>CALL kernel32.VirtualProtectEx<br>NOP<br>NOP<br>ADD BYTE PTR DS:[EAX],AL<br><br><b>Чем можно менять эти атрибуты секций(я имею в виду какой АПИ) с Map, на скажем, Imag?</b><br><br><b>Ну или чем кроме VirtualProtectEx меняют атрибуты файла даже несмотря на то, что он Map?</b><br><br>Тот участок, что мне нужен как раз на несчастье Map.  <img src="img/smilies/s15.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155249&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=23" class="addthx" data-post="155249"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 сентября 2007 16:23 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#24');return false;">#24</a> </span><div align=left><br>
Всем привет. Участок выделенной памяти Map  никак не поддается. Я искал все утро какую нить статью на Wasme на предмет всё таки либо заставить Map-секцию сменить атрибуты, либо как с Map сделать неMap и потом уже менять, единственное, что увидел &quot;Инжект как метод обхода фаерволлов, жив или мертв? /28.04.06/&quot;<br>А там как писать с потока в другой поток приводится последовательность,-&quot;Считается, что с этого момента инжект как метод обхода фаерволлов перестал существовать, так как уже недостаточно было сделать <b>OpenProcess/WriteProcessMemory/CreateRemoteThread</b>.&quot;<br><br>Дак вот WriteProcessMemory тоже надо чтобы куда пишут уже была открыта возможность писать(если я верно перевёл из борландовой справки по Апи) &quot;иначе функциональные сбои&quot;.<br><br>Так знает кто нить способ, ну хоть самый хитромудрый? Может есть какой то способ сделать из Map - неMap или вписать в неё данные, или сменить атрибут защиты???<br><br>Добавил: предлагайте даже самую жуть, если простых способов нет. Нужно будет лезти в 0-кольцо, буду учиться. Назовите хотя бы последовательность Апишек 3-его кольца или 0-го которые должны пройти чтобы добиться смены прав доступа в Map-е или самого Мар на не-Мар.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155371&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=24" class="addthx" data-post="155371"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]NIKOLA[/b]','')">NIKOLA</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/247.jpg" alt=""><br><span class=txtSm>Ранг: 500.6 (<b>!</b>), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.87'>Активность: 0.26<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=247">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 сентября 2007 16:35 <br><script type="text/javascript">QU('NIKOLA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NIKOLA" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#25');return false;">#25</a> </span><div align=left><br>
А чего ты привязался к этой секции?<br>Создай новую и делай что хочеш или это принципиально.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155373&amp;user=247&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=25" class="addthx" data-post="155373"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 сентября 2007 17:16 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#26');return false;">#26</a> </span><div align=left><br>
<b>NIKOLA</b> тут два момента психологический и интелектуальный.<br><br>Меня всегда раздражало когда, механизм, код или другой человек(не имеет значения) не даёт мне сделать очевидную для меня  и рациональную вещь. Есть почти пустая, примыкающая к проге, да ещё и огромная секция, почему это нельзя записать туда импорт вынесенный целиком хрен знает куда. И вторая часть психологического момента,- если уж меня это заинтересовало, то надо докопаться как это можно сделать(ибо если научиться писать в Map, то проблем со свободным местом и размещением чего то не будет совсем никогда).<br><br>Второй момент недостаточные знания, я не знаю, но ты прав надо попробовать, пустит меня система создать свою секцию в хвосте проги, затерев таким образом несколько аспровых секций или нет?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155379&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=26" class="addthx" data-post="155379"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 сентября 2007 21:57 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#27');return false;">#27</a> </span><div align=left><br>
<b>NIKOLA</b>, ты прав, и не думал, что это так легко. Прошу прощения за упрямство. Единственное, что мне понадобилось найти кроме VirtualAlloc-а(я имею виду подробности в справке о параметрах) так это функцию UnmapViewOfFile(в ней ваще только один параметр- база мар - файла). В первом же испытательном коде не &quot;поддающийся никому&quot; мар как хреном сбрило, без проблем возникла новая секция в хвосте проги(на его месте) с максимальным доступом и в заключении, код записал туда даблворд единиц. Вот простое испытание:<br><br> PUSH 690000<br> CALL kernel32.UnmapViewOfFile<br> PUSH 40<br> PUSH 3000<br> PUSH 20000<br> PUSH 690000<br> CALL kernel32.VirtualAlloc<br> MOV DWORD PTR DS:[EAX],11111111<br> ADD BYTE PTR DS:[EAX],AL
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155585&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=27" class="addthx" data-post="155585"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]vnekrilov[/b]','')">vnekrilov</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 329.6 (мудрец), 192thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.08'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=5173">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2007 14:37 <br><script type="text/javascript">QU('vnekrilov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vnekrilov" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#28');return false;">#28</a> </span><div align=left><br>
Сегодня на webfile.ru/1522533 я выложил статью по распаковке ASProtect v1.35 build 06.26. К моему сожалению, я не смог ее залить на сайт CRACKL@B (все время идет обрыв соединения), и Ara пообещал ее перезалить на CRACKL@B. Статья, в качестве приложения, содержит подопытную программу, которую предложил Gideon Vi, набор скриптов, дампы программы, и дампы VM, INIT и IAT.<br>Буду признателен за критику, пожелания и замечания.<br>Готовлю статью по распаковке ASProtect v2.3 SKE build 06.26 Beta.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=156516&amp;user=5173&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=28" class="addthx" data-post="156516"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Spirit[/b]','')">Spirit</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1419.gif" alt=""><br><span class=txtSm>Ранг: 271.6 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.35'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1419">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2007 14:40 <br><script type="text/javascript">QU('Spirit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Spirit" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#29');return false;">#29</a> </span><div align=left><br>
<b>vnekrilov</b><br>Критика номер раз:<br>Обидно, что каеццо со скодостью 0,02кб/сек.<br><br>ифолдер решает.
<br><br><font size="1"><i>-----<br>iNTERNATiONAL CoDE CReW</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=156518&amp;user=1419&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=29" class="addthx" data-post="156518"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2007 18:27 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#30');return false;">#30</a> </span><div align=left><br>
<I>Spirit пишет:<br>ифолдер решает. </I><br><br>ifolder.ru/3301738
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=156565&amp;user=72&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=30" class="addthx" data-post="156565"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]Smon[/b]','')">Smon</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 500.5 (<b>!</b>), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.33'>Активность: 0.23<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2007 19:12 <br><script type="text/javascript">QU('Smon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Smon" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=10#31');return false;">#31</a> </span><div align=left><br>
<b>vnekrilov</b><br>3000h это не 3000 байт - это раз, во вторых - VirtualAlloc невозможно использовать для определения адресов, в третьих - 00950000h - это не область вм, это размешанный полиморфом\метаморфом буфер, в котором есть вызовы вм 00B30000h с эмуляцией инструкций типа jmp,call,jcc,cmp+jcc.<br>ЗЫ: смотрел навскидку, может еще что пропустил, хз <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>&quotПусть видят, что мы не шутим. Стволы для понта, ножи для дела&quot Lock, Stock &amp Two Smoking Barrels</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=156572&amp;user=1449&amp;forum_n=3&amp;topic=7466&amp;page=10&amp;anchor=31" class="addthx" data-post="156572"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=9.html">&lt;&lt;</a> <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=0.html">1</a> ... <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=9.html">10</a> . <b>11</b> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=11.html">12</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=12.html">13</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=11.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка AsProtect на примерах</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="3">
<input type="hidden" name="topic" value="7466">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=7466" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
