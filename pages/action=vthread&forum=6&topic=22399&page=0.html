<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>либа для сплайсинга в ядре - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем привет я у вас новенький прошу любить и жаловать значит в юзер моде я юзаю libMinHook как готовое решение для сплайсинга она сама все делает и даже фиксит адреса если перемещает команды в трамплин с относительной адресацией">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> либа для сплайсинга в ядре</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]87nd85[/b]','')">87nd85</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.58'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=36386">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2013 09:28 <br><script type="text/javascript">QU('87nd85','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=87nd85" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Всем привет<br><br>я у вас новенький прошу любить и жаловать<br><br>значит в юзер моде я юзаю libMinHook как готовое решение для сплайсинга она сама все делает и даже<br>фиксит адреса если перемещает команды в трамплин с относительной адресацией ниже пример как я её использую<br><br>мой вопрос таков а есть ли готовое решение наподобие libMinHook только для сплайсинга в ядре ?<br><br>спасибо<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;</li><li class="hl_l1">#include&nbsp;<span class="hl_char">&lt;</span>boost<span class="hl_char">/</span>algorithm<span class="hl_char">/</span>string<span class="hl_char">/</span>regex<span class="hl_char">.</span>hpp<span class="hl_char">&gt;</span></li><li class="hl_l0">#include&nbsp;<span class="hl_quote">&quot;minhook.h&quot;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">#if&nbsp;defined&nbsp;_M_X64</li><li class="hl_l1">#pragma&nbsp;<span class="hl_function">comment</span><span class="hl_char">(</span>lib<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;libMinHook.x64.lib&quot;</span><span class="hl_char">)</span></li><li class="hl_l0">#elif&nbsp;defined&nbsp;_M_IX86</li><li class="hl_l1">#pragma&nbsp;<span class="hl_function">comment</span><span class="hl_char">(</span>lib<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;libMinHook.x86.lib&quot;</span><span class="hl_char">)</span></li><li class="hl_l0">#endif</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">FILE&nbsp;<span class="hl_char">*</span>fout<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">typedef&nbsp;NTSTATUS&nbsp;WINAPI&nbsp;NtDeviceIoControlFile_t<span class="hl_char">(</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;HANDLE&nbsp;FileHandle<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;HANDLE&nbsp;Event<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;PVOID&nbsp;ApcRoutine<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;PVOID&nbsp;ApcContext<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_Out_&nbsp;&nbsp;PVOID&nbsp;IoStatusBlock<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;ULONG&nbsp;IoControlCode<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;PVOID&nbsp;InputBuffer<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;ULONG&nbsp;InputBufferLength<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_Out_&nbsp;&nbsp;PVOID&nbsp;OutputBuffer<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;ULONG&nbsp;OutputBufferLength</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">NtDeviceIoControlFile_t<span class="hl_char">*</span>&nbsp;fpNtDeviceIoControlFile<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">#define&nbsp;AFD_RECV&nbsp;0x12017</li><li class="hl_l1">#define&nbsp;AFD_SEND&nbsp;0x1201f</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">#define&nbsp;NT_SUCCESS<span class="hl_char">(</span>Status<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_char">(</span>NTSTATUS<span class="hl_char">)</span><span class="hl_char">(</span>Status<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">&gt;</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">struct&nbsp;AFD_WSABUF</li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;len<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCH&nbsp;buf<span class="hl_comment">;</span></li><li class="hl_l1">}<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">struct&nbsp;AFD_INFO</li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AFD_WSABUF<span class="hl_char">*</span>&nbsp;BufferArray<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;BufferCount<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;AfdFlags<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;TdiFlags<span class="hl_comment">;</span></li><li class="hl_l1">}<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;WriteData<span class="hl_char">(</span>PCCH&nbsp;Buffer<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;Len<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">std</span><span class="hl_char">:</span><span class="hl_char">:</span>string&nbsp;<span class="hl_function">str</span><span class="hl_char">(</span>Buffer<span class="hl_char">,</span>&nbsp;Len<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">std</span><span class="hl_char">:</span><span class="hl_char">:</span>vector<span class="hl_char">&lt;</span><span class="hl_function">std</span><span class="hl_char">:</span><span class="hl_char">:</span>string<span class="hl_char">&gt;</span>&nbsp;scripts<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boost<span class="hl_char">:</span><span class="hl_char">:</span>regex&nbsp;regex<span class="hl_char">(</span><span class="hl_quote">&quot;&lt;script&gt;[^&lt;]+&lt;/script&gt;&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boost<span class="hl_char">:</span><span class="hl_char">:</span>find_all_regex<span class="hl_char">(</span>scripts<span class="hl_char">,</span>&nbsp;<span class="hl_function">str</span><span class="hl_char">,</span>&nbsp;regex<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>scripts<span class="hl_char">.</span>empty<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;each<span class="hl_char">(</span>auto&nbsp;script&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;scripts<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fprintf</span><span class="hl_char">(</span>fout<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;%s\n&quot;</span><span class="hl_char">,</span>&nbsp;script<span class="hl_char">.</span>c_str<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">; </span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fflush</span><span class="hl_char">(</span>fout<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">NTSTATUS&nbsp;WINAPI&nbsp;Hook_NtDeviceIoControlFile<span class="hl_char">(</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;HANDLE&nbsp;FileHandle<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;HANDLE&nbsp;Event<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;PVOID&nbsp;ApcRoutine<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;PVOID&nbsp;ApcContext<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_Out_&nbsp;&nbsp;PVOID&nbsp;IoStatusBlock<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;ULONG&nbsp;IoControlCode<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;PVOID&nbsp;InputBuffer<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;ULONG&nbsp;InputBufferLength<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_Out_&nbsp;&nbsp;PVOID&nbsp;OutputBuffer<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;ULONG&nbsp;OutputBufferLength</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>IoControlCode&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;AFD_RECV<span class="hl_char">)</span>&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AFD_INFO<span class="hl_char">*</span>&nbsp;AfdInfo&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>AFD_INFO<span class="hl_char">*</span><span class="hl_char">)</span>InputBuffer<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__try</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memset</span><span class="hl_char">(</span>AfdInfo<span class="hl_char">-</span><span class="hl_char">&gt;</span>BufferArray<span class="hl_char">-</span><span class="hl_char">&gt;</span>buf<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;AfdInfo<span class="hl_char">-</span><span class="hl_char">&gt;</span>BufferArray<span class="hl_char">-</span><span class="hl_char">&gt;</span>len<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__except<span class="hl_char">(</span>EXCEPTION_EXECUTE_HANDLER<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTSTATUS&nbsp;Status&nbsp;<span class="hl_char">=</span>&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fpNtDeviceIoControlFile<span class="hl_char">(</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileHandle<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Event<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ApcRoutine<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ApcContext<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IoStatusBlock<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IoControlCode<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputBuffer<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputBufferLength<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OutputBuffer<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OutputBufferLength</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>NT_SUCCESS<span class="hl_char">(</span>Status<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>IoControlCode&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;AFD_SEND&nbsp;<span class="hl_char">|</span><span class="hl_char">|</span>&nbsp;IoControlCode&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;AFD_RECV<span class="hl_char">)</span>&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AFD_INFO</span><span class="hl_char">*</span>&nbsp;AfdInfo&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>AFD_INFO<span class="hl_char">*</span><span class="hl_char">)</span>InputBuffer<span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCCH&nbsp;Buffer&nbsp;</span><span class="hl_char">=</span>&nbsp;AfdInfo<span class="hl_char">-</span><span class="hl_char">&gt;</span>BufferArray<span class="hl_char">-</span><span class="hl_char">&gt;</span>buf<span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>DWORD</b></span>&nbsp;Len&nbsp;<span class="hl_char">=</span>&nbsp;AfdInfo<span class="hl_char">-</span><span class="hl_char">&gt;</span>BufferArray<span class="hl_char">-</span><span class="hl_char">&gt;</span>len<span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WriteData</span><span class="hl_char">(</span>Buffer<span class="hl_char">,</span>&nbsp;Len<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Status<span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">extern&nbsp;<span class="hl_quote">&quot;C&quot;</span>&nbsp;__declspec<span class="hl_char">(</span>dllexport<span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;<span class="hl_function">lock</span><span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;{}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">BOOL&nbsp;CALLBACK&nbsp;DllMain<span class="hl_char">(</span>HINSTANCE<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;res<span class="hl_char">,</span>&nbsp;LPVOID<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>DLL_PROCESS_ATTACH&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;res<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fout&nbsp;<span class="hl_char">=</span>&nbsp;fopen<span class="hl_char">(</span><span class="hl_quote">&quot;c:/garbage.txt&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;a+&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MH_Initialize<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HMODULE&nbsp;mod&nbsp;<span class="hl_char">=</span>&nbsp;GetModuleHandle<span class="hl_char">(</span><span class="hl_quote">&quot;ntdll&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;GetProcAddress<span class="hl_char">(</span>mod<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;NtDeviceIoControlFile&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MH_CreateHook<span class="hl_char">(</span><span class="hl_function">ptr</span><span class="hl_char">,</span>&nbsp;Hook_NtDeviceIoControlFile<span class="hl_char">,</span>&nbsp;</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reinterpret_cast</span><span class="hl_char">&lt;</span><span class="hl_function">void</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">&gt;</span><span class="hl_char">(</span><span class="hl_char">&amp;</span>fpNtDeviceIoControlFile<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MH_EnableHook<span class="hl_char">(</span><span class="hl_function">ptr</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>true</b></span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=335069&amp;user=36386&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=1" class="addthx" data-post="335069"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2013 10:37 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Забудь про сплайсинг в х64 ядре, там патчгард. Да и зачем там вообще сплайсинг понадобился?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335071&amp;user=1556&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=2" class="addthx" data-post="335071"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]87nd85[/b]','')">87nd85</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.58'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=36386">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2013 11:31 &middot; Поправил: 87nd85 <br><script type="text/javascript">QU('87nd85','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=87nd85" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>Archer пишет:<br>Забудь про сплайсинг в х64 ядре, там патчгард. Да и зачем там вообще сплайсинг понадобился?  </I><br><br>просто у меня в юзермоде стоит хук на NtDeviceIoControlFile который ловит AFD_SEND и AFD_RECV для одной программки<br><br>в коде берется первый буфер и его длинна хотя предположительно их может быть несколько<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">PCCH&nbsp;Buffer&nbsp;<span class="hl_char">=</span>&nbsp;AfdInfo<span class="hl_char">-</span><span class="hl_char">&gt;</span>BufferArray<span class="hl_char">-</span><span class="hl_char">&gt;</span>buf<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>DWORD</b></span>&nbsp;Len&nbsp;<span class="hl_char">=</span>&nbsp;AfdInfo<span class="hl_char">-</span><span class="hl_char">&gt;</span>BufferArray<span class="hl_char">-</span><span class="hl_char">&gt;</span>len<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>хотел хукнуть в драйвере дабы посмотреть в рамках всей системы передается ли несколько буферов и где указывается размер сколько реально вернулось байт для каждого буфера... вот не понятно как узнать размер для AFD_RECV ? ведь как я понимаю там указан размер отданных для заполнения буферов а как узнать размер реально отданных байт для каждого буфера ? сейчас в коде что я привел в первом посте для AFD_RECV перед передачей вызова системе я просто обнуляю буфер и то это срабатывает только потому что я логирую некий текст... а если к примеру бинарные данные то где указано сколько вернулось ? или этот параметр len в структуре он in/out ? тоесть на выходе содержит сколько байт вернулось реально ? <br><br>да и вообще в личных целях обучения у меня ось 32 битная иногда хочется что нить хукнуть в ядре посмотреть в рамках всей системы за чем то... хотелось бы аналог libminhook для простого сплайсинга только в ядре
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335073&amp;user=36386&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=3" class="addthx" data-post="335073"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2013 11:34 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
На x86 он тоже не нужен, сст же массив векторов. Хотя их модификация тоже патч, они в кодосекции, а значит вредоносно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335074&amp;user=33727&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=4" class="addthx" data-post="335074"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2013 11:59 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Если это делать нормально, делай драйвер-фильтр. Если на 1 раз на х86 и только посмотреть, патчи сдт. Про параметры-мсдн в зубы. Никакой сплайсинг в ядре тут не нужен.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335075&amp;user=1556&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=5" class="addthx" data-post="335075"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=8830" title="12-12-2013 08:12, ранг:187.4" target="_blank">ajax</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]87nd85[/b]','')">87nd85</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.58'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=36386">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2013 13:04 &middot; Поправил: 87nd85 <br><script type="text/javascript">QU('87nd85','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=87nd85" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
я вас понял<br><br>но мне все равно хочется иметь инструмент для сплайсинга в ядре наподобие libminhook есть такой на примете ?<br><br>можно попробовать libminhook для ядра переточить благо опен сорс либа...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335078&amp;user=36386&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=6" class="addthx" data-post="335078"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2013 01:32 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>87nd85</b><br><br>Можите пример привести зачем что то сплайсить ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335114&amp;user=33727&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=7" class="addthx" data-post="335114"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2013 01:55 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>87nd85 пишет: есть такой на примете </I><br>Как вариант <noindex><a href="http://easyhook.codeplex.com/" rel="nofollow" target="_blank">EasyHook</a></noindex><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">EasyHook&nbsp;starts&nbsp;where&nbsp;Microsoft&nbsp;Detours&nbsp;<span class="hl_function">ends</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_function"><b>This</b></span>&nbsp;project&nbsp;supports&nbsp;extending&nbsp;<span class="hl_char">(</span>hooking<span class="hl_char">)</span>&nbsp;unmanaged&nbsp;<span class="hl_function"><b>code</b></span>&nbsp;<span class="hl_char">(</span>APIs<span class="hl_char">)</span>&nbsp;with&nbsp;pure&nbsp;managed&nbsp;ones<span class="hl_char">,</span>&nbsp;from&nbsp;within&nbsp;a&nbsp;fully&nbsp;managed&nbsp;environment&nbsp;like&nbsp;C#&nbsp;using&nbsp;Windows&nbsp;<span class="hl_number">2000</span>&nbsp;SP4&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;later<span class="hl_char">,</span>&nbsp;including&nbsp;Windows&nbsp;XP&nbsp;x64<span class="hl_char">,</span>&nbsp;Windows&nbsp;Vista&nbsp;x64&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;Windows&nbsp;Server&nbsp;<span class="hl_number">2008</span>&nbsp;x64<span class="hl_char">.</span>&nbsp;Also&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_number">64</span><span class="hl_char">-</span>bit&nbsp;kernel&nbsp;mode&nbsp;hooking&nbsp;is&nbsp;supported&nbsp;as&nbsp;well&nbsp;as&nbsp;an&nbsp;unmanaged&nbsp;user<span class="hl_char">-</span><span style="word-break: break-all">mode&nbsp;API&nbsp;which&nbsp;allows&nbsp;you&nbsp;to&nbsp;hook&nbsp;targets&nbsp;without&nbsp;requiring&nbsp;a&nbsp;NET&nbsp;Framework&nbsp;on&nbsp;the&nbsp;customers&nbsp;PC</span><span class="hl_char">.</span><span style="word-break: break-all">&nbsp;An&nbsp;experimental&nbsp;stealth&nbsp;injection&nbsp;hides&nbsp;hooking&nbsp;from&nbsp;most&nbsp;of&nbsp;the&nbsp;current&nbsp;AV&nbsp;software</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=335115&amp;user=6&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=8" class="addthx" data-post="335115"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2013 02:10 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0448BD3FFh</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; call ebx [VirtualFree()]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">05C8B0C24h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; mov eax, [esp + 12]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0E3FF1024h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; mov ebx, [esp + 16]</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; jmp ebx [exit thread]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_comment">; save params for VirtualFree(Inject-&gt;RemoteEntryPoint, 0, MEM_RELEASE);</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>esi</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">64</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; VirtualFree()</span></li>        </ol>
    </div>
</div></div>
<br><br>На говнокод смахивает..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335117&amp;user=33727&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=9" class="addthx" data-post="335117"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2013 02:18 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>Dr0p пишет: На говнокод смахивает..  </I><br>Чел спрашивал ( если достаточно развита телепатия ) библиотеку для перехватов, но замкнуло на сплайсинге, качество это уже второе, работает и хрен с ней, да и аверы<br>[url=https://www.virustotal.com/ru/file/5687f14a793392c07bdabea77190f0d66726ac1546a3f1b3d0f60946b97ff818/analysis/1386886212/<br>]--&gt; Link &lt;--[/url] для нужд ТС сойдет, учитывая упоминание minhook.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335118&amp;user=6&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=10" class="addthx" data-post="335118"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2013 02:39 &middot; Поправил: Dr0p <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>F_a_u_s_t</b><br><br><noindex><a href="http://easyhook.codeplex.com/SourceControl/latest#branches/release-2.7/DriverShared/LocalHook/install.c" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>Оно если и работает, то с огромной вероятностью крэша - код тупо перетирается без поправок контекста. Если поток свопнулся то получится синька. А это будет по любому в активном коде. Для такой модификации нужно останавливать ось. Блокировать шедулер не поможет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335119&amp;user=33727&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=11" class="addthx" data-post="335119"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2013 03:54 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Автор до сих пор внятно не объяснил, зачем ему сплайсинг. Толку что-то советовать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335120&amp;user=2585&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=12" class="addthx" data-post="335120"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]87nd85[/b]','')">87nd85</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.58'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=36386">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2013 04:01 <br><script type="text/javascript">QU('87nd85','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=87nd85" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>Dr0p пишет:<br>Можите пример привести зачем что то сплайсить ?  </I><br><br>да просто иногда интересно что то похукать посмотреть... в данном случае хотел похукать NtDeviceIoControlFile для исследования её работы на предмет перехвата AFD_SEND AFD_RECV запросов
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335121&amp;user=36386&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=13" class="addthx" data-post="335121"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]87nd85[/b]','')">87nd85</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.58'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=36386">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2013 04:07 <br><script type="text/javascript">QU('87nd85','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=87nd85" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>F_a_u_s_t пишет:<br>Как вариант EasyHook </I><br><br>завтра попробую её заюзать для сплайсинга в ядре
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335122&amp;user=36386&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=14" class="addthx" data-post="335122"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2013 04:25 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>87nd85</b><br><br>Все сервисы(Nt-апи) описаны в 2-х массивах. Модифицируется ссылка там. Зачем их патчить.<br><br>Впрочем я ваши извращенья давно хорошо знаю по лабу <img src="img/smilies/s3.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335123&amp;user=33727&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=15" class="addthx" data-post="335123"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Oott[/b]','')">Oott</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/14476.jpg" alt=""><br><span class=txtSm>Ранг: 106.9 (ветеран), 27thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.59'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=14476">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2013 17:01 <br><script type="text/javascript">QU('Oott','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Oott" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Системный программист, мальчик молодой, Все хотят засплайсить код с тобой. Ах, если бы ты знал женскую тоску По хуку твоему..  <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335128&amp;user=14476&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=16" class="addthx" data-post="335128"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=33727" title="13-12-2013 13:07, ранг:65.7" target="_blank">Dr0p</a>, <a href="action=userinfo&user=33622" title="13-12-2013 13:12, ранг:6.0" target="_blank">dant3</a>, <a href="action=userinfo&user=26773" title="13-12-2013 13:20, ранг:7.5" target="_blank">Dynamic</a>, <a href="action=userinfo&user=2760" title="13-12-2013 13:39, ранг:164.8" target="_blank">[wl]</a>, <a href="action=userinfo&user=3136" title="13-12-2013 15:05, ранг:265.1" target="_blank">Veliant</a>, <a href="action=userinfo&user=34465" title="13-12-2013 15:14, ранг:23.9" target="_blank">Alinator3500</a>, <a href="action=userinfo&user=1883" title="13-12-2013 18:01, ранг:132.1" target="_blank">Kindly</a>, <a href="action=userinfo&user=31142" title="01-05-2014 07:39, ранг:37.0" target="_blank">sivorog</a>, <a href="action=userinfo&user=36083" title="02-05-2014 10:37, ранг:44.1" target="_blank">MickeyBlueEyes</a>, <a href="action=userinfo&user=37865" title="08-06-2016 13:15, ранг:0.5" target="_blank">egyp7</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2013 22:55 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>Dr0p пишет: Оно если и работает, то с огромной вероятностью крэша </I><br>Возможно недавняя бага или качал библиотеку от другого разработчика, ветка не одна.<br>В любом случае <strike>извращенцу </strike> ТС, проще будет пофиксить багу чем писать с нуля.<br><I>87nd85 пишет: есть ли готовое решение наподобие libMinHook </I><br>Собственно ответ, а остальное уже проблемы ТС.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335138&amp;user=6&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=17" class="addthx" data-post="335138"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 декабря 2013 03:02 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>F_a_u_s_t</b><br><br>Какая есчо бага, там мусора куча, сделанного по тому же принципу:<br><br><noindex><a href="http://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22396#16" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335145&amp;user=33727&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=18" class="addthx" data-post="335145"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]87nd85[/b]','')">87nd85</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.58'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=36386">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 декабря 2013 11:30 &middot; Поправил: 87nd85 <br><script type="text/javascript">QU('87nd85','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=87nd85" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
да ладно вам... вот когда я стану (если стану) таким же матерым как и вы у меня тоже взгляды и интересы поменяются а сейчас мне по большому счету пофиг правильно ли я хукаю или нет мне главное сделать хук и наблюдать передаваемые параметры <img src="img/smilies/s1.gif" alt="">)<br><br>да и вообще я могу быть как ужасным занудой и педантом так и раздолбаем так что я не придаю особого значения правильности технологии мне важнее цель в данный момент ;))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335152&amp;user=36386&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=19" class="addthx" data-post="335152"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 декабря 2013 03:10 &middot; Поправил: Dr0p <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>87nd85</b><br><br>Ну так чтобы сделать, надо начать.<br><br>Во первых понадобится процессы и потоки енумить. Нужно найти PsGetNextProcess() и PsGetNextProcessThread(). Хотя возможно сгодится SystemProcessInformation, но не уверен, там проблемы могут быть типо дедлоков.<br><br>Нужно на время модификации все процессоры остановить. KeFreezeExecution/KeThawExecution().<br><br>1. Описываем страницу через мдл и мапим. Либо сбрасываем WP.<br>2. Останавливаем ось. KeFreezeExecution().<br>3. Енумим все потоки(PsGetNextProcessThread()), проверяем вхождение Ip каждого потока в модифицируемый код. Если входит, то поточная маршрутизация - фиксим Ip на буфер.<br>4. Патчим код.<br>5. KeThawExecution().<br><br>Но сразу скажу что мне эта затея не нравится, впрочем как и метод выше. Хотя бы просто потому, что осевой код налету так просто не изменить. Придётся брать костыли.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=335178&amp;user=33727&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=20" class="addthx" data-post="335178"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]TheNozza[/b]','')">TheNozza</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.32'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24722">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2014 03:06 &middot; Поправил: TheNozza <br><script type="text/javascript">QU('TheNozza','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TheNozza" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>На говнокод смахивает.. </b><br>Шутишь, тут в топике вообще нормального кода нет)))<br>fout = fopen(&quot;c:/garbage.txt&quot;, &quot;a+&quot;);<br>Таким почерком обладают школьники и студенты младших курсов, которым ещё не поставили кодстайл.<br>В промышленном коде на первом ревью такие выходки забанят))))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=341248&amp;user=24722&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=21" class="addthx" data-post="341248"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]TryAga1n[/b]','')">TryAga1n</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 262.5 (наставник), 337thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.45'>Активность: 0.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=31275">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2014 07:03 <br><script type="text/javascript">QU('TryAga1n','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TryAga1n" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Кто этого наркомана из бана выпустил?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=341250&amp;user=31275&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=22" class="addthx" data-post="341250"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=18316" title="01-05-2014 03:44, ранг:164.9" target="_blank">SReg</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2014 07:55 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<b>TryAga1n</b> прошло 4.5 месяца.. со времен последнего поста.. состав видимо был знатный.. раз так долго держал...
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=341252&amp;user=17319&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=23" class="addthx" data-post="341252"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2014 09:28 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22399.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
Закрыт старый топик.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=341254&amp;user=1556&amp;forum_n=6&amp;topic=22399.html&amp;page=0&amp;anchor=24" class="addthx" data-post="341254"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> либа для сплайсинга в ядре</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22399" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
