<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Распаковка AsProtect на примерах - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте! Очень прошу, помогите найти или выдайте пжалста из запасов прогу Advanced Archive Password Recovery v.3.00 кто может, очень хочется научиться распаковке, а проги нормальной нет. Далее повтор моего вчерашнего">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=42623'>site-pro</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a>, <a target='_blank' href='?action=userinfo&amp;user=35066'>artyavmu</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка AsProtect на примерах</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=7.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=7.html">8</a> . <b>9</b> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=11.html">12</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=12.html">13</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=9.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2007 12:10 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте! Очень прошу, помогите найти или выдайте пжалста из запасов прогу Advanced Archive Password Recovery v.3.00 кто может, очень хочется научиться распаковке, а проги нормальной нет. Далее повтор моего вчерашнего письма(лежит в чужой теме, найти можно в поиске введите: Распаковка ASProtecta - моё сообщение самое свежее)<br>----------------------------------------------------------------------  ------------------------------------------------------------------<br>Здравствуйте. Понимаю, что лезу немного не туда, но обсуждения статьи &quot;Распаковка нового ASProtect на примере Advanced Archive Password Recovery v.3.00&quot; автора SergSh на форуме и в поисковике вроде бы не видно(может статья просто древняя), а тут вроде бы тоже у ASR-ра 2-я версия. Суть проблемы:<br><br>1 Сам по вашим статьям научился распаковывать ASProtect 1.22-1.23 ,1.23 RC4, 1.24(проги типа Electra, Куриная месть.Первая разборка, скринсейвер и т.д. с затиранием репой краденого начала проги и без).<br><br>2 Нужно двигаться дальше и тут с удивлением обнаруживаю, что статей по распаковке версий 1.3-2.0 нет вааще(может я в шары долблюсь, незнаю). Плиз, если можно, то ссылку на подобную статью, а то руководство как починить велосипед есть(1.21-1.22), как починить мопед-есть(1.23 RC4), как починить боинг747 и космический челнок-есть(2.0x-2.12xx и выше). А вот как отремонтировать просто машину нет.<br><br>3 Из всех имеющихся статей более всего понятно было у SergSh в &quot;Распаковка нового ASProtect на примере Advanced Archive Password Recovery v.3.00&quot;, но тут такой казус. Проискав в инете подопытную прогу версии 3.0 нашел две ссылки, скачал, инсталятор обещал версия 3.0 (как в статье),- в итоге версия 3.01, чем забиты все ссылки на эту прогу в инете и PEID говорит не ASProtect 1.2-1.3 registered(2.0x по словам SergSh),а ASProtect 2.1x SKE. Ну ладно:<br><br>а)34раз Shift+F9 ставим бряк на ближайший переход внизу, ещё раз Shift+F9, снимаем бряк,ставим на Alt+M на секцию кода(401000), но не снова Shift+F9, как в статье, а trace into(а то EOP будет на две команды ниже и затруться два Push-а). Останавливаемся на EOP 42A910. Ctrl+A и всё видится чинно и благородно.<br><br>б)Читаем статейку дальше и пробуем запустить его скрипт(в папку его,в Script , в Олю, в виде txt предварительно). И оля повисает пробовал подождать 1,5 часа думал это скрипт так долго на более свежей версии ASp-ра трудится(хрен то там:s14. Запущено как положено без бряков и с OEP после trace into и я в plugin-&gt;IsDebuggerPresent -&gt;Hide, с полным игнором исключений.<br><br>в) Руками по его совету IAT пока не пробовал, всё так пока трудно для понимания и непривычно и завтра на работу а уже 2ночи. Граждане, слезно молю дайте ссылку на настоящий Advanced Archive Password Recovery v.3.00, а то шатл починить не могу пока, дайте хоть чертежи к боингу. А если почти серьезно, то научиться распаковывать ASPr до второй версии включительно руками хочется так, что аж эти руки зудят.<br><br>P.S. Не пинайте сильно за дурацкие просьбы самого маленького. Это первый выход в свет. Начал реверсить 18.12.06 с нуля. Реверсил даже в новогоднюю ночь. Для меня это очень важно(научиться распаковывать)!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=115630&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=1" class="addthx" data-post="115630"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2007 22:37 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#2');return false;">#2</a> </span><div align=left><br>
может?<br><br><i class=x>BOOL IsBadCodePtr(<br>    FARPROC lpfn 	// address of function  <br>   )<br><b>Return Values</b><br><br>If the calling process has read access to the specified memory, the return value is zero.<br>If the calling process does not have read access to the specified memory, the return value is nonzero.<br></i><br><br>и ещё завязывай ты с этими скриптами...<br>кодь тулзу <img src="img/smilies/s1.gif" alt=""> куда ценнее будит и толку больше!
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=140284&amp;user=72&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=2" class="addthx" data-post="140284"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2007 23:00 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#3');return false;">#3</a> </span><div align=left><br>
<b>Hellspawn</b>, приветствую.<br>Это ты на сях, я так понимаю функцию <b>IsBadCodePtr</b> вызываешь. Счас переведу, что написал.<br>Огромное фенкс.<br><br>Вот странное дело. То меня все скрипты писать сватали(вся 1и 2 стр этого топика такими указаниями пестрит). Токо я во вкус вошёл. Это что мода чтоли?<img src="img/smilies/s1.gif" alt=""><br><br>А если серьёзно, то мне тогда надо выключится на несколько недель и с нуля си учить. Я немного знаю асм, немного паскаль и делфи, но си пока что как макаке граната.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=140289&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=3" class="addthx" data-post="140289"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2007 23:04 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#4');return false;">#4</a> </span><div align=left><br>
хехе, это просто выдержка из хелпа...<br>если знаешь паскаль, могу тебе свой отладочный двиг подбросить <img src="img/smilies/s1.gif" alt=""><br>или вообще помочь, чтобы ты просто алго реализовывал своё дальше...<br><br>з.ы. скрипты это как небольшая помощь, когда лень писать тулзу,<br>но когда скрипт становиться большим, то это же изврат <img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=140290&amp;user=72&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=4" class="addthx" data-post="140290"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2007 23:11 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#5');return false;">#5</a> </span><div align=left><br>
<b>Hellspawn</b> если не жаль подбрось, буду только благодарен.<br>Ну конечно я паскаль не так как ты знаю, но в знакомом языке хоть разобраться можно более менее быстро.<br>А скрипт этот, я уже просто закусил удила, неохота останавливаться недожав.<img src="img/smilies/s5.gif" alt=""><br>НУ и вовсе он ещё не большой, побольше 300строк.<img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=140291&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=5" class="addthx" data-post="140291"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2007 23:34 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#6');return false;">#6</a> </span><div align=left><br>
Паскаль живучий,как &quot;Великий и Могучий&quot;...))))))<br>А вот скрипт,оно попроще будет,даже если за 500 строк перевалит.<br>Хотя тулзу ваять,гораздо интересней...))))))
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=140297&amp;user=3230&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=6" class="addthx" data-post="140297"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2007 13:42 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#7');return false;">#7</a> </span><div align=left><br>
<I>Small_S пишет:<br>Вот странное дело. То меня все скрипты писать сватали(вся 1и 2 стр этого топика такими указаниями пестрит). Токо я во вкус вошёл. Это что мода чтоли? </I><br>Э-э! это кто тебе советовал скрипты…<br>Лично я тебе советовал учить PE формат и учиться кодить даже ссылку по теме постил на прогу<br>Там выложили два отличных варианта, и вообще возьми, перечитай еще раз весь топик! Прежде чем писать такое…<br>Ты увидел китайский скрипт и стал очередным наркоманом, лучше прислушайся, что тебе советуют PE_Kill и Hellspawn, и не спорь!<br>Лучше всего начни изучать Delphi, его тебе хватит на все случаи в жизни, написаны миллионы компонентов, сырков, асм вставки, книг(e-book) и т. д., вообщем всех плюсов не перечислить, асм нужен только для индивидуального подхода к некоторым вещам такого как, например хак… возьми сорсы Rebaser by Dr. Golova и CADT by Ms-Rem их стиль написания прог ничем не отличается от чистоты асм тулуз, а кое-где даже лучше!!!
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=140380&amp;user=4551&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=7" class="addthx" data-post="140380"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июня 2007 23:08 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#8');return false;">#8</a> </span><div align=left><br>
Привет всем День и вечер к сожалению пропал для кодинга на работе была буханка) еле перебираю по клаве.<br><b>Demon666</b> вбщето фраза была в шутку, видишь смайлик? хлтя в каждой шутке, доля истены(ну советовало несколько человек, частью в личке частью в топике). Я не любитель выяснять отношения и поэтому не буду постить имена и фразы. А отвечу в том же духе, что и когда(когда принимал советы по скриптотописательству).<br><b>Всему, своё время.</b>Так и вертится на языке время, бросать камни и время собирать, время любить и время ненавидеть, и заходит солнцеи восходит всё возвращается на круги своя брр чо то меня по эклизиасту понесло, пеорепил <br>Я же не говорю, что никогда нее буду писать буду но попозже завтра отраббот и я этот скрипт искусаю просто отже через 3часа на работу и так весь одел как будем работаь
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=140446&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=8" class="addthx" data-post="140446"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 июня 2007 00:44 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#9');return false;">#9</a> </span><div align=left><br>
<b>Small_S</b><br>Да причем тут это, просто где-то есть топик здесь на форуме, так вот там кто-то написал скрипт по обработке <br>call`ов (я уже сейчас точно не помню), я его помню посмотрел так там внутри какой-то целый дизасм-движок был (жесть конечно!), но вот там его спросили что и как делать – он написал ложишься спать и за ночь он там че-то находит…<br>так вот ты сейчас понял, что такое скрипты и они тебя не устраивают… ты начал задавать вопросы при этом выделяя их жирным шрифтом…<br>ИМХО – от ответов был бы полный ноль пользы такой же, как и сами вопросы, поэтому тебе и начали советовать именно так – учись кодить!, тогда уже и спрашивай про АПИ-функи…<br>А да насчет анализа, у Оли есть в SDK функи которые могут помочь осуществить то что тебе надо, короче ты начал спрашивать про то что никакого отношения к скриптам не имеет, но ты пытаешься это как-то через жо(Пии…) совместить…
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=140458&amp;user=4551&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=9" class="addthx" data-post="140458"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июня 2007 23:02 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#10');return false;">#10</a> </span><div align=left><br>
Привет всем. Хотя уже притомился,изложу вкратце последние новости с фронта<img src="img/smilies/s1.gif" alt=""><br><br>Добил я чистильщика и определителя начала-конца. Работает(причём ещё как). М-да асм это сила. Врятли кто нибудь на этом форуме успеет моргнуть быстрее чем асм вставка прочёсывает секцию в 3000h байт и одновременно находит корректно начало-конец таблицы IAT. Я в первый раз сдуру думал по секундомеру засечь, так чуть со стула не упал(какой там, десятые или сотые доли секунды, у меня прескотт разогнанный до 3,5 Мгц, гиг памяти)  <b>Отдельный респект Hellspawn за достоверную и скорую информацию!</b><br><br>Правда я использовал не kernel32.IsBadCodePtr, а kernel32.IsBadReadPtr(эта процедура вложена в приведённую <b>Hellspawn</b>). Она определяет возможность чтения по адресу на определённое пользователем количество байт. Исходные данные суются в стек(сначала число байт, затем адрес) и погнали, ноль если прочитали, не ноль если не можем или можем, но не по всем байтам.<br><br>Завтра запощу скрипт со всеми последними изменениями. На моё счастье PE_kill разрешил размещение модернизированных скриптов в этом топике. Сейчас приведу лишь саму вставку:<br><br>00400E00-----------PUSH 0<br>00400E02-----------PUSH 0<br>00400E04-----------CMP DWORD PTR DS:[EBX],ECX<br>00400E06-----------JB SHORT ARCHPR.00400E4C<br>00400E08-----------CMP DWORD PTR DS:[EBX],7FFE1000<br>00400E0E-----------JA SHORT ARCHPR.00400E4C<br>00400E10-----------CMP DWORD PTR DS:[EBX],EDX<br>00400E12-----------JB SHORT ARCHPR.00400E52<br>00400E14-----------CMP DWORD PTR DS:[EBX],5B260000<br>00400E1A-----------JB SHORT ARCHPR.00400E52       //ЗДЕСЬ МЕНЯЕМ НА 52(БЫЛО 4С)НЕ ТРЁТ НИЖЕ ГРАНИЦЫ<br>00400E1C-----------PUSH EBX                                    //БИБЛИОТЕК<br>00400E1D-----------MOV EBX,DWORD PTR DS:[EBX]<br>00400E1F-----------SUB EBX,4<br>00400E22-----------PUSHAD<br>00400E23-----------PUSH 4<br>00400E25-----------PUSH EBX<br>00400E26-----------CALL kernel32.IsBadReadPtr<br>00400E2B-----------CMP EAX,0<br>00400E2E-----------JE SHORT ARCHPR.00400E32<br>00400E30-----------JMP SHORT ARCHPR.00400E4A<br>00400E32-----------POPAD<br>00400E33-----------CMP DWORD PTR DS:[EBX],90909090<br>00400E39-----------JE SHORT ARCHPR.00400E5B<br>00400E3B-----------CMP DWORD PTR DS:[EBX],CCCCCCCC<br>00400E41-----------JE SHORT ARCHPR.00400E5B<br>00400E43-----------CMP DWORD PTR DS:[EBX],-1<b>&lt;--------- //Это прийдётся убирать</b>(бывает, что похоже на <br>00400E46-----------JE SHORT ARCHPR.00400E5B            //использование АПИ но не сначала, но видно ощибся)<br>00400E48-----------JMP SHORT ARCHPR.00400E4B<br>00400E4A-----------POPAD<br>00400E4B-----------POP EBX<br>00400E4C-----------MOV DWORD PTR DS:[EBX],0<br>00400E52-----------CMP EBX,EAX<br>00400E54-----------JE SHORT ARCHPR.00400E70<br>00400E56-----------ADD EBX,4<br>00400E59-----------JMP SHORT ARCHPR.00400E04<br>00400E5B-----------POP EBX<br>00400E5C-----------CMP DWORD PTR DS:[ESP],0<br>00400E61-----------JNZ SHORT ARCHPR.00400E69<br>00400E63-----------MOV DWORD PTR DS:[ESP],EBX<br>00400E67-----------JMP SHORT ARCHPR.00400E52<br>00400E69-----------MOV DWORD PTR DS:[ESP+4],EBX<br>00400E6E-----------JMP SHORT ARCHPR.00400E52<br>00400E70-----------POP EAX<br>00400E71-----------POP EDX<br>00400E72-----------ADD BYTE PTR DS:[EAX],AL<br><br>И ещё один момент при использовании модернизированного скрипта прийдётся всключать обработку исключительных ситуаций в кернеле(одна галка).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=140769&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=10" class="addthx" data-post="140769"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 июня 2007 23:38 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#11');return false;">#11</a> </span><div align=left><br>
Привет всем. Как и обещал в аттаче первая модефикация скрипта PE_kill-а. Конечно она ещё очень не совершенна, но на тех файлах, на основе которых она создавалась работает. Я испытал её на иконловере следующим образом. Взял свой же распакованный файл в одной оле, взял не распакованный файл и прогнал его через скрипт в другой оле. Затем сделал бинарную копию всей секции где находится таблица импорта и перешёл в распакованую версию проги. Там забил нулями всю секцию с импортом и затем сделал бинарную вставку из буфера обмена, после чего сохранил файл. После удачного запуска получившегося файла я понял что данный эксперимент показал мне:<br><br>а) что скрипт справился с основной защитой импорта на которую и был расчитан,<br>б) можно смело оставить вариант с полной зачисткой секции(чистятся адреса ниже 00400000, выше системных библиотек, не существующие адреса в диапазоне системных бибилиотек, а также адреса между концом проги и нижними краем системных библиотек).<br><br>Дело в том, что вчера мне показалось, что я всё таки что то убираю лишнее и я отрубал стирание диапазона между концом файла и нижней границей системных библиотек. Проверил работу и на Адвенседе, но там какая то мистика: раньше я распаковывал его на ура ошибочной версией этого же скрипта(см. выше там где я ещё не учитывал разные сигнатуры вызовов), теперь всё время ошибается в одном месте и тот на котором раньше на ура и новый(ну это всего одна функа).<br>Проверял ещё на крякмисах 2.11, но распакованных версий нет, а возится неохота. Одно можно сказать точно во всех случаях безошибочно определяет границы IAT перед запуском основной части скрипта и вроде нет ошибок с определением фунок и типа перехода.<br><br>Только сегодня днём мне попалась программа- клавиатурный шпион под аспром 1.36  6.26 билда правда(не 2.1х с которыми я возился) где я обнаружил то, о чём говорил <b>tar4</b>, а именно после основной защиты импорта о которой было в статьях SergSh и PE_kill-а идёт как раз такая. Функи, по одной забираются каждая в свою область выделенной памяти и чаще всего через одну область(где начало кода функи)во вторую такую же выделенную где либо конец функи(то есть она забрана полностью) или вызов последней части в виде какой то точки в этой апи в кернеле. Кроме того есть варианты когда во второй области нашпигован самомодефицирующийся код. Однако и на этой проге без ошибок определяются границы IAT и основная защита импорта обезвреживается также без ощибок(говорю так поскольку дораспаковал то о чём писано в этом абзаце вручную это порядка 10-ти таких вот замороченных вызовов).<br><br>Дальнейшую работу буду делить на три части.<br>1) разработка асм вставки, которая будет разгребать украденные индивидуально функции. Благо места гарантированного теперь у нас хоть отбавляй, из всех прог ни у одной не попалось таблицы импорта больше 1000байт в окончательном варианте, а секции отводимые под IAT по 3000-4000 байт, откуда имеем без всякого страха минимум 1500-2000байт на асм кодинг.<br>2) при получении плохих известий про работу с основной частью защиты импорта буду добавлять сигнатуры, учитывающие новшества.<br>3) начну потихоньку вникать, как делаются те операции(в виде делфи или асм кода), которые обычно любезно берет на себя плагин ODBgScript. Тут море неизвестного. В перспективе не плохо попытаться создать удобный инструмент, имеющий промежуточное назначение между стрипером и скриптом, тоесть при уверенности распаковка на автомате, при проблеммах начинаем вникать и делать коррективы и чтоб всё видно.<br><br>P.S. Был бы крайне признателен, если бы любой помог в виде сообщения: у меня такая то прога под Аспром 2.хх и распакованный(ничем не пожатый файл), при желании могу залить. Ну или сами берёте скрипт и повторяете манипуляции как я описал с иконловером. Ну конечно эксперимент будет чистым если как у адвенседа или иконловера импорт будет защищён только основной защитой, иначе прийдётся смотреть где падаем(тоесть портачится скрипт или просто <b>индивидуальная защита</b> фунок есть- я это так обзываю).<br><br><img src="img/attach.gif" alt=""> <a href="./files/7755_11.06.2007_CRACKLAB.rU.tgz">7755_11.06.2007_CRACKLAB.rU.tgz</a> - IAT_rec_modern1p.osc
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=140952&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=11" class="addthx" data-post="140952"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2007 04:28 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#12');return false;">#12</a> </span><div align=left><br>
<I>Small_S пишет:<br>у меня такая то прога под Аспром 2.хх </I><br>А не легче бы тебе было написать короткую тестовую прогу (лучше на асме) и потом паковать ее самому с различными опциями ломаным аспром версии 2.х (например, версии 2.3. и билд 06.26)?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141126&amp;user=1631&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=12" class="addthx" data-post="141126"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2007 06:19 &middot; Поправил: PE_Kill <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#13');return false;">#13</a> </span><div align=left><br>
<I>Small_S пишет:<br>ндивидуальная защита фунок есть- я это так обзываю </I><br>Ыыы, это как раз первая старая защита импорта. Standard Import Protection называется, а то с чем ты воюешь называется Advanced Import Protection,<br><br>Делал бы хук на заполнение IAT. У меня скрипт, который восстанавливал Advanced Import Protection+Standard Import Protection+Virtual Machine after Calling API+Borland Init Table Protection занимал всего 1700 строк. При этом почти не юзал асм и делал всё сам, просто запускаешь и через 5 минут прога стоит на ОЕП и весь импорт пофиксен, а в логе начало и конец IAT.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=141132&amp;user=3232&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=13" class="addthx" data-post="141132"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2007 10:11 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#14');return false;">#14</a> </span><div align=left><br>
<b>PE_Kill</b> спсб за просвещение.<br>Я наверноем попробую сделать так вечером. Хотя пока не представляю как в разных версиях потом искать место в командной аспровой секции где это заполнение проводится. Там сигнатура похожая в разных версиях чтоли?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141152&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=14" class="addthx" data-post="141152"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2007 10:56 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#15');return false;">#15</a> </span><div align=left><br>
Да, одна и та же. Аспр давно уже не обновлялся. Только в интерпритатор ВМ пару лишних инструкций добавляют и всё.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=141157&amp;user=3232&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=15" class="addthx" data-post="141157"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2007 14:38 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#16');return false;">#16</a> </span><div align=left><br>
<b>tar4</b> кстати о птицах. Не помню откуда, но заливал Аспр 2.2 (помоему приду с работы скажу точнее) с кейгеном. Так вот что то как я этим кейгеном ни генерировал ключи, аспру, что слону дробина он даже не открывается(пишет пароль неправильный). В общем я напишу тебе в личку. Ну а <b>не легче ли</b>, думаю нет, потому, что  асм-прога, ну или там делфи-прога будут иметь одни варианты, да ещё для 2.3 версии, а есть ещё С/C++, какой то C watcom(с которым я столкнулся в адвенседе)и хрен его знает сколько ещё того, что я не видел в плане разных компиляторов и версий аспра над ними. Я же пробую сделать скрипт для восстановления импорта автоматическим, если не для всех, то хотя бы для большого числа прог.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141191&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=16" class="addthx" data-post="141191"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2007 10:24 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#17');return false;">#17</a> </span><div align=left><br>
Пока времени последить за заполнением секции импорта не было, но я зато нашёл среди кучи скриптов нормальный OEP-фаиндер для проги под 1.35 билд 4.25 or 6.26. А то руками вроде доходил до OEP но там нет исключений и этот фаиндер помог сделать некоторые выводы. Тех мест где были украдены по старому с Standard Import Protection уже не было(тоесть движок PE_kill-а с нормально восстановил) просто видимо я был на OEP не совсем в тот момент когда нужно.<br>Но главное я обнаружил место где не определилась GetProcAddress и сделал важный вывод, что нельзя всё таки тереть слепо между нижним краем системных библ и верхним краем проги. И ещё очень интересное для меня место обнаружил,- похоже я нашёл в командном аспровом файле место где идёт защита фунок. По крайней мере в старых версиях это видимо самое оно. Там типа своя таблица импорта, и ещё строковые структуры(тоесть названия библ и фунок в строковом формате). Всё это попробую отыскать в других версиях аспра повыше и подумаю как это можно использовать.<br><b>См. аттач</b><br><br>&lt;img src=&quot;img/attach.gif&quot;&gt; &lt;SCRIPT type=text/javascript&gt;dfl(&quot;files/&quot;,&quot;79ee_14.06.2007_CRACKLAB.rU.tgz&quot;);&lt; /SCRIPT&gt; - изу чение старой защиты.txt
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141301&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=17" class="addthx" data-post="141301"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2007 15:31 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#18');return false;">#18</a> </span><div align=left><br>
И снова прошу информационной помощи. Нужно имя функи аналога LoadLibraryA, только для выделенных участков памяти. Поясняю.<br>LoadLibraryA как пишет в своей статье PE_kill, подгружает, а если она подгружена определяет базу(регистр EAX) системной библиотеки и строковое имя функи (в EDX).<br><br>Мне же хотелось бы знать имя функи которая по заданному адресу определяет базу выделенного участка памяти(не dll прошу заметить). Просто родилась одна идея на работе прям, но LoadLibraryA наверное не подходит для такой цели. Что она будет в EDI выводить если там в выделенке вообще пусто или какой то бред(думаю матюгнёт и сделает исключение).<br><br>Наверное есть какая нибудь специализированная функа?<br><b>Hellspawn</b> может знаешь такую???<img src="img/smilies/s15.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141381&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=18" class="addthx" data-post="141381"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2007 15:40 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#19');return false;">#19</a> </span><div align=left><br>
а походу нет такой, тебе придётся перечислить все регионы памяти, потом<br>брать нужный тебя адрес и смотреть в какую область он попадает <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=141383&amp;user=72&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=19" class="addthx" data-post="141383"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2007 15:45 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#20');return false;">#20</a> </span><div align=left><br>
<b>Hellspawn</b> спасиб. Жаль конечно. Алго я уже придумал с той что проверяет на доступ к чтению, но гиморно и медленно по сравнению со специальной, утешает что асм и так быстр как ракета. Ты личку не читал 2 -3 дня назад?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141384&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=20" class="addthx" data-post="141384"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2007 05:25 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#21');return false;">#21</a> </span><div align=left><br>
<I>Small_S пишет:<br>которая по заданному адресу определяет базу выделенного участка памяти( </I><br>Что ты имеешь ввиду под &quot;базой...&quot;? Адрес начала и конца участка памяти, предварительно выделенного через VirtualAlloc?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141456&amp;user=1631&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=21" class="addthx" data-post="141456"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2007 06:49 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#22');return false;">#22</a> </span><div align=left><br>
<b>tar4</b> во во меня эти величины интересуют, так как в асме(вставке) нужно будет быстро и без гимора взять начала и концы всех выделенных участков загнать эти значения либо в стек, либо в место где они гарантированно не мешают и уже оттуда брать и сверять каждый адрес из мусора с ними принадлежит ли он  какому либо участку выделенной АСпром памяти или нет. Этот реверанс в скрипте будет посвящен специально версиям 1.35 и до 2.х так как у тех что выше я не замечал в IAT среди мусора обращений к участкам выделенным Аспром, а вот в проге под 1.35 нашел позавчера. Причём важное GetProc Address два раза вызывается через переходник и скрипт пока в том виде как он был исходный или как сейчас это не восстанавливает.<br>Я знаю как это реализовать на kernel32.IsBadReadPtr , но это будет гиморно и не очень красиво, думал есть спец функа системная.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141463&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=22" class="addthx" data-post="141463"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2007 08:01 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#23');return false;">#23</a> </span><div align=left><br>
<I>Small_S пишет:<br>взять начала и концы всех выделенных участков </I><br>А почему бы тебе не использовать стандартные функции плугина (OllyScript). Там,  есть несколько подходящих функций (gmi, gmemi...)  и насколько я помню в подобной ситуации, я использовал одну из них.<br><I>Small_S пишет:<br>специально версиям 1.35 и до 2.х  </I><br>вообще-то, это две разные &quot;ветки&quot; одного дерева. v.135 - сложнее.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141468&amp;user=1631&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=23" class="addthx" data-post="141468"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2007 08:08 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#24');return false;">#24</a> </span><div align=left><br>
<b>Small_S</b><br>Как вариант-хукай функцию выделения памяти и записывай начало, конец.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141470&amp;user=1556&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=24" class="addthx" data-post="141470"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2007 09:45 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#25');return false;">#25</a> </span><div align=left><br>
<b>tar4</b>на <b>(gmi, gmemi...)и насколько я помню в подобной ситуации, я использовал одну из них.</b><br>и я использовал в OEP фаиндере, только медленно это и неорганично будет посреди действий асм кода.<br><br><b>Archer</b> они уже к тому времени выделены, а если на стадии выделения, то вообще проще как говорит PE_kill сразу хукать IAT. Правда этим я ещё не занимался.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141478&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=25" class="addthx" data-post="141478"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2007 10:08 &middot; Поправил: tar4 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#26');return false;">#26</a> </span><div align=left><br>
<I>Small_S пишет:<br>неорганично будет посреди действий асм кода.  </I><br>Посреди кода, конечно, нельзя. Но, как вариант, можно в начале все прочитать и занести в какую-нибудь таблицу. А потом, по мере необходимости, брать данные из таблицы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141481&amp;user=1631&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=26" class="addthx" data-post="141481"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2007 11:27 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#27');return false;">#27</a> </span><div align=left><br>
<b>tar4</b> конечно можно, но хотелось всё сделать вместе. Сейчас привёз книгу по асму под вин, как отработаю буду читать про что где в PE-заголовке. Вот черт, как бы всё таки открыть из Асм-кода возможность записи прям в секции заголовка?<br><b>Так мне никто и не ответил на этот вопрос.</b><br><br>Исправил.<br><b>tar4</b> видел говоришь, тогда вечером попробую найти.<br><b>А ещё бы ссылку может кто видел?</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141494&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=27" class="addthx" data-post="141494"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2007 12:19 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#28');return false;">#28</a> </span><div align=left><br>
<I>Small_S пишет:<br>возможность записи прям в секции заголовка </I><br>Так ты сходи на wasm.ru. По-моему, я видел там подобную тему.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141506&amp;user=1631&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=28" class="addthx" data-post="141506"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2007 21:58 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#29');return false;">#29</a> </span><div align=left><br>
Ну нашёл кое что по изменению PE- заголовка и секций статья на зывается:<br><br><b>Путеводитель по написанию вирусов под Win32</b><br><br>В третьей главе описывается сам PE-заголовок, а в четвёртой  <b>4. Ring-3, программирование на уровне пользователя</b> описывается пример вируса который находит пять файлов в системной директории и заражает их.<br><br>Написано то подробно и если почитать пару дней или позакидывать народ на краклабе вопросами, то всё станет ясно, но уже предварительно вижу пару неприятных моментов<br><br>1) Ему то хорошо, он открывает файл с нуля функцией CreateFileA, получает хенд файла потом куча всяких действий и используя этот хенл маппирует его(тоже ещё читать про это надо я самоучка и в такие дебри ещё не лез). <b>Так у меня файл уже открыт(не буду же я открывать открытый файл) и как получить хендл без CreateFileA?</b><br><br>Ну вроде вижу такое место в его статье<br>Infection:<br>        lea     esi,[ebp+WFD_szFileName]------; Получаем имя заpажаемого  файла<br>        push    80h<br>        push    esi<br>        call    [ebp+_SetFileAttributesA]--------; Стиpаем его аттpибуты <br>        call    OpenFile -----------------------------; Откpываем его<br>        inc     eax -----------------------------------; Если EAX = -1, пpоизошла<br>        jz      CantOpen----------------------------; ошибка<br>        dec     eax<br>        mov     dword ptr [ebp+FileHandle],eax<br><br> ;-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·- ·-·-·;<br> ; Пеpове, что мы делаем, это стиpаем аттpибуты файла и устанавливаем их    ;<br> ; pавными стандаpтным. Это осуществляется с помощью функции                      ;<br> ; SetFileAttributes. Вот кpаткое объяснение данной функции:                              ;<br> ;                                                                                                                                 ;<br> ; Функция SetFileAttributes устанавливает аттpибуты файла.                              ;<br> ;                                                                                                                                 ;<br> ; BOOL SetFileAttributes(                                                                                           ;<br> ;   LPCTSTR lpFileName, // адpес имени файла                               ;<br> ;   DWORD dwFileAttributes      // адpес устанавливаемых аттpибутов        ;<br> ;  );                                                                      ;<br> ;                                                                          ;<br> ; Паpаметpы                                                                ;<br> ; ---------                                                                ;<br> ;                                                                          ;<br> ; ¦ lpFileName: указывает на стpоку, задающую имя файла, чьи аттpибуты     ;<br> ;   устанавливаются.                                                       ;<br> ;                                                                          ;<br> ; ¦ dwFileAttributes: задает аттpибуты файла, котоpые должны быть          ;<br> ;   установлены. Этот паpаметp долже быть комбинацией значений, котоpые    ;<br> ;   можно найти в соответствующем заголовочном файле. Как бы то ни было,   ;<br> ;   стандаpтным значением является FILE_ATTRIBUTE_NORMAL.                  ;<br> ;                                                                          ;<br> ; Возвpащаемые значения                                                    ;<br> ; ---------------------                                                    ;<br> ;                                                                          ;<br> ; ¦ Если вызов функции пpошел успешно, возвpащаемое значение не pавно      ;<br> ;   нулю.                                                                  ;<br> ;                                                                          ;<br> ; ¦ Если вызов функции не удался, возвpащаемое значение pавно нулю. Чтобы  ;<br> ;   получить дополнительную инфоpмацию об ошибке, вызовите GetLastError.   ;<br> ;                                                                          ;<br> ; <b>После установки новых аттpибутов мы откpываем файл и, если не пpоизошло  ;<br> ; ошибки, хэндл файла сохpаняется в соотвествующей пеpеменной.        </b>     ;<br> ;-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·-·- ·-·-·;<br><br>Ну в последних строках снова открываем(так он и не закрывался) и сохраняется хендл, потом следующее действие как раз меппирование где этот хендл нужен.<br><br>2) Момент где то по тексту было сейчас быстро не найду, что если там какие то защитные атрибуты были установлены при открытии, то пока не закроешь хрен изменишь.<br>Ещё завтра почитаю, но пока такие вот навороты. <br><b>Пока  предварительный вопрос чем хендл получают ничего не открывая и не закрывая?</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141601&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=29" class="addthx" data-post="141601"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2007 21:48 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#30');return false;">#30</a> </span><div align=left><br>
Привет всем, полдня рылся в своих книгах про асм, немного читал статьи с WASM-а, но так ничего более приближенного к тому чего мне нужно не нашёл. В общем предстоят продолжительные эксперименты с попытками изменить атрибуты &quot;налету&quot; ещё надо знать как ищется нужный процесс(и соответственно его хендл без закрытий открытий), ведь как то импрект скажем, выводит список процессов к которым надо аттачиться для правки импорта, значит можно как то узнать хотя бы все процессы.<br><br>Поняв что резина эта очень долгая, решил всё таки заделать поиск областей выделенной памяти и хранение их адресов и размеров(для каждой найденной) используя стек. А потом оттудаже и будем сверять с мусорными адресами. Гиморно, но приходится. В заголовке писать из асма пока не умею, в секции таблицы IAT на момент когда будет работать эта часть кода, ещё не будет нулей и кроме мусора могут быть ценные адреса, можно было конечно организовать поиск 100-150dword нулей по секции кода или данных, но не охота. В общем делаю через стек, пусть даже Аспр развернёт 50 выделеных участков всё равно не беда(по два даблворда на каждую =100).<br><br>Кстати стек наверное быстрее проводит операции чем скажем записать-считать из такой то секции(хотя и там и там память) или я ошибаюсь?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141730&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=30" class="addthx" data-post="141730"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2007 04:35 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=8#31');return false;">#31</a> </span><div align=left><br>
<I>Small_S пишет:<br>рылся в своих книгах про асм, немного читал статьи с WASM </I><br>Наверное, я не точно выразился. Зная, что опыта в асме у тебя мало, я имел ввиду найти на форуме топик про работу с РЕ-заголовком, а не читать все статься подряд, тем более по вирусологии. Попробуй напиши в поисковике васма слово &quot;заголовок&quot;. Правда, вылезет куча лишнего, но все же... там можно что-то найти.<br><I>Small_S пишет:<br>быстрее проводит операции чем скажем записать-считать из такой то секции </I><br>Мне кажется, не следует себе пока голову еще и этим, вопросы оптимизации оставь на потом.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141919&amp;user=1631&amp;forum_n=3&amp;topic=7466&amp;page=8&amp;anchor=31" class="addthx" data-post="141919"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=7.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=7.html">8</a> . <b>9</b> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=11.html">12</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=12.html">13</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=9.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка AsProtect на примерах</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="3">
<input type="hidden" name="topic" value="7466">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=7466" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
