<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>как отследить откуда &quot;вызвалась&quot; процедура - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="вопрос в том что олли не показывает откуда вызвалась  0044FE58 / 55       PUSH EBP 0044FE59 |. 8BEC      MOV EBP,ESP 0044FE5B |. 83C4 E0    ADD ESP,-20 0044FE5E |. 53       PUSH EBX 0044FE5F |. 56       PUSH ESI 0044FE60 |. 33D2 ">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=5602'>ut2004</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> как отследить откуда &quot;вызвалась&quot; процедура</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Feldsher[/b]','')">Feldsher</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.44'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=9617">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2007 23:39 <br><script type="text/javascript">QU('Feldsher','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Feldsher" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7950.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
вопрос в том что олли не показывает откуда вызвалась <br><code><br><b>0044FE58  /  55             PUSH EBP</b><br>0044FE59  |. 8BEC           MOV EBP,ESP<br>0044FE5B  |. 83C4 E0        ADD ESP,-20<br>0044FE5E  |. 53             PUSH EBX<br>0044FE5F  |. 56             PUSH ESI<br>0044FE60  |. 33D2           XOR EDX,EDX<br>0044FE62  |. 8955 E0        MOV DWORD PTR SS:[EBP-20],EDX<br>0044FE65  |. 8945 FC        MOV DWORD PTR SS:[EBP-4],EAX<br>0044FE68  |. BB D8275500    MOV EBX,DNIPRO~2.005527D8<br>0044FE6D  |. 33C0           XOR EAX,EAX<br>0044FE6F  |. 55             PUSH EBP<br>0044FE70  |. 68 E8004500    PUSH DNIPRO~2.004500E8<br>0044FE75  |. 64:FF30        PUSH DWORD PTR FS:[EAX]<br>0044FE78  |. 64:8920        MOV DWORD PTR FS:[EAX],ESP<br>0044FE7B  |. E8 2433FEFF    CALL DNIPRO~2.004331A4<br>0044FE80  |. 8B45 FC        MOV EAX,DWORD PTR SS:[EBP-4]<br>0044FE83  |. 8078 47 00     CMP BYTE PTR DS:[EAX+47],0<br>0044FE87  |. 75 24          JNZ SHORT DNIPRO~2.0044FEAD<br>0044FE89  |. 8B45 FC        MOV EAX,DWORD PTR SS:[EBP-4]<br>0044FE8C  |. 8B10           MOV EDX,DWORD PTR DS:[EAX]<br>0044FE8E  |. FF52 4C        CALL DWORD PTR DS:[EDX+4C]<br>0044FE91  |. 84C0           TEST AL,AL<br>0044FE93  |. 74 18          JE SHORT DNIPRO~2.0044FEAD<br>0044FE95  |. 8B45 FC        MOV EAX,DWORD PTR SS:[EBP-4]<br>0044FE98  |. F680 CC020000 &gt;TEST BYTE PTR DS:[EAX+2CC],8<br>0044FE9F  |. 75 0C          JNZ SHORT DNIPRO~2.0044FEAD<br>0044FEA1  |. 8B45 FC        MOV EAX,DWORD PTR SS:[EBP-4]<br>0044FEA4  |. 80B8 17020000 &gt;CMP BYTE PTR DS:[EAX+217],1<br>0044FEAB  |. 75 21          JNZ SHORT DNIPRO~2.0044FECE<br>0044FEAD  |&gt; 8D55 E0        LEA EDX,DWORD PTR SS:[EBP-20]<br>0044FEB0  |. A1 E4185500    MOV EAX,DWORD PTR DS:[5518E4]<br>0044FEB5  |. E8 526DFBFF    CALL DNIPRO~2.00406C0C<br>0044FEBA  |. 8B4D E0        MOV ECX,DWORD PTR SS:[EBP-20]<br>0044FEBD  |. B2 01          MOV DL,1<br>0044FEBF  |. A1 F80A4100    MOV EAX,DWORD PTR DS:[410AF8]<br>0044FEC4  |. E8 57D1FBFF    CALL DNIPRO~2.0040D020<br>0044FEC9  |. E8 AE3BFBFF    CALL DNIPRO~2.00403A7C<br>0044FECE  |&gt; E8 2D83FBFF    CALL &lt;JMP.&amp;user32.GetCapture&gt;            ; [GetCapture<br>0044FED3  |. 85C0           TEST EAX,EAX<br>0044FED5     74 11          JE SHORT DNIPRO~2.0044FEE8<br>0044FED7  |. 6A 00          PUSH 0                                   ; /lParam = 0<br>0044FED9  |. 6A 00          PUSH 0                                   ; |wParam = 0<br>0044FEDB  |. 6A 1F          PUSH 1F                                  ; |Message = WM_CANCELMODE<br>0044FEDD  |. E8 1E83FBFF    CALL &lt;JMP.&amp;user32.GetCapture&gt;            ; |[GetCapture<br>0044FEE2  |. 50             PUSH EAX                                 ; |hWnd<br>0044FEE3  |. E8 1086FBFF    CALL &lt;JMP.&amp;user32.SendMessageA&gt;          ; SendMessageA<br>0044FEE8  |&gt; E8 CB85FBFF    CALL &lt;JMP.&amp;user32.ReleaseCapture&gt;        ; [ReleaseCapture<br>0044FEED  |. 8B45 FC        MOV EAX,DWORD PTR SS:[EBP-4]<br>0044FEF0  |. 8088 CC020000 &gt;OR BYTE PTR DS:[EAX+2CC],8<br>0044FEF7  |. E8 FC82FBFF    CALL &lt;JMP.&amp;user32.GetActiveWindow&gt;       ; [GetActiveWindow<br>0044FEFC  |. 8945 E4        MOV DWORD PTR SS:[EBP-1C],EAX<br>0044FEFF  |. A1 20FA5400    MOV EAX,DWORD PTR DS:[54FA20]<br>0044FF04  |. 8945 F0        MOV DWORD PTR SS:[EBP-10],EAX<br>0044FF07  |. A1 DC275500    MOV EAX,DWORD PTR DS:[5527DC]<br>0044FF0C  |. 8B48 6C        MOV ECX,DWORD PTR DS:[EAX+6C]<br>0044FF0F  |. A1 DC275500    MOV EAX,DWORD PTR DS:[5527DC]<br>0044FF14  |. 8B40 70        MOV EAX,DWORD PTR DS:[EAX+70]<br>0044FF17  |. 33D2           XOR EDX,EDX<br>0044FF19  |. E8 2629FCFF    CALL DNIPRO~2.00412844<br>0044FF1E  |. A1 DC275500    MOV EAX,DWORD PTR DS:[5527DC]<br>0044FF23  |. 8B55 FC        MOV EDX,DWORD PTR SS:[EBP-4]<br>0044FF26  |. 8950 6C        MOV DWORD PTR DS:[EAX+6C],EDX<br>0044FF29  |. A1 DC275500    MOV EAX,DWORD PTR DS:[5527DC]<br>0044FF2E  |. 66:8B40 38     MOV AX,WORD PTR DS:[EAX+38]<br>0044FF32  |. 66:8945 EE     MOV WORD PTR SS:[EBP-12],AX<br>0044FF36  |. 33D2           XOR EDX,EDX<br>0044FF38  |. A1 DC275500    MOV EAX,DWORD PTR DS:[5527DC]<br>0044FF3D  |. E8 0E180000    CALL DNIPRO~2.00451750<br>0044FF42  |. A1 DC275500    MOV EAX,DWORD PTR DS:[5527DC]<br>0044FF47  |. 8B40 3C        MOV EAX,DWORD PTR DS:[EAX+3C]<br>0044FF4A  |. 8945 E8        MOV DWORD PTR SS:[EBP-18],EAX<br>0044FF4D  |. 33C0           XOR EAX,EAX<br>0044FF4F  |. E8 B8A4FFFF    CALL DNIPRO~2.0044A40C<br>0044FF54  |. 8945 F4        MOV DWORD PTR SS:[EBP-C],EAX<br>0044FF57  |. 33D2           XOR EDX,EDX<br>0044FF59  |. 55             PUSH EBP<br>0044FF5A  |. 68 C8004500    PUSH DNIPRO~2.004500C8<br>0044FF5F  |. 64:FF32        PUSH DWORD PTR FS:[EDX]<br>0044FF62  |. 64:8922        MOV DWORD PTR FS:[EDX],ESP<br>0044FF65  |. 8B45 FC        MOV EAX,DWORD PTR SS:[EBP-4]<br>0044FF68  |. E8 3BFEFFFF    CALL DNIPRO~2.0044FDA8<br>0044FF6D  |. 33D2           XOR EDX,EDX<br>0044FF6F  |. 55             PUSH EBP<br>0044FF70  |. 68 27004500    PUSH DNIPRO~2.00450027<br>0044FF75  |. 64:FF32        PUSH DWORD PTR FS:[EDX]<br>0044FF78  |. 64:8922        MOV DWORD PTR FS:[EDX],ESP<br>0044FF7B  |. 6A 00          PUSH 0<br>0044FF7D  |. 6A 00          PUSH 0<br>0044FF7F  |. 68 00B00000    PUSH 0B000<br>0044FF84  |. 8B45 FC        MOV EAX,DWORD PTR SS:[EBP-4]<br>0044FF87  |. E8 B4AAFEFF    CALL DNIPRO~2.0043AA40<br>0044FF8C  |. 50             PUSH EAX                                 ; |hWnd<br>0044FF8D  |. E8 6685FBFF    CALL &lt;JMP.&amp;user32.SendMessageA&gt;          ; SendMessageA<br>0044FF92  |. 8B45 FC        MOV EAX,DWORD PTR SS:[EBP-4]<br>0044FF95  |. 33D2           XOR EDX,EDX<br>0044FF97  |. 8990 34020000  MOV DWORD PTR DS:[EAX+234],EDX<br>0044FF9D  |&gt; 8B03           /MOV EAX,DWORD PTR DS:[EBX]<br>0044FF9F  |. E8 AC330000    |CALL DNIPRO~2.00453350<br>0044FFA4  |. 8B03           |MOV EAX,DWORD PTR DS:[EBX]<br>0044FFA6  |. 80B8 8C000000 &gt;|CMP BYTE PTR DS:[EAX+8C],0<br>0044FFAD  |. 74 0F          |JE SHORT DNIPRO~2.0044FFBE<br>0044FFAF  |. 8B45 FC        |MOV EAX,DWORD PTR SS:[EBP-4]<br>0044FFB2  |. C780 34020000 &gt;|MOV DWORD PTR DS:[EAX+234],2<br>0044FFBC  |. EB 14          |JMP SHORT DNIPRO~2.0044FFD2<br>0044FFBE  |&gt; 8B45 FC        |MOV EAX,DWORD PTR SS:[EBP-4]<br>0044FFC1  |. 83B8 34020000 &gt;|CMP DWORD PTR DS:[EAX+234],0<br>0044FFC8  |. 74 08          |JE SHORT DNIPRO~2.0044FFD2<br>0044FFCA  |. 8B45 FC        |MOV EAX,DWORD PTR SS:[EBP-4]<br>0044FFCD  |. E8 26FDFFFF    |CALL DNIPRO~2.0044FCF8<br>0044FFD2  |&gt; 8B45 FC        |MOV EAX,DWORD PTR SS:[EBP-4]<br>0044FFD5  |. 8B80 34020000  |MOV EAX,DWORD PTR DS:[EAX+234]<br>0044FFDB  |. 85C0           |TEST EAX,EAX<br>0044FFDD  |.^74 BE          JE SHORT DNIPRO~2.0044FF9D<br>0044FFDF  |. 8945 F8        MOV DWORD PTR SS:[EBP-8],EAX<br>0044FFE2  |. 6A 00          PUSH 0<br>0044FFE4  |. 6A 00          PUSH 0<br>0044FFE6  |. 68 01B00000    PUSH 0B001<br>0044FFEB  |. 8B45 FC        MOV EAX,DWORD PTR SS:[EBP-4]<br>0044FFEE  |. E8 4DAAFEFF    CALL DNIPRO~2.0043AA40<br>0044FFF3  |. 50             PUSH EAX                                 ; |hWnd<br>0044FFF4  |. E8 FF84FBFF    CALL &lt;JMP.&amp;user32.SendMessageA&gt;          ; SendMessageA<br>0044FFF9  |. 8B45 FC        MOV EAX,DWORD PTR SS:[EBP-4]<br>0044FFFC  |. E8 3FAAFEFF    CALL DNIPRO~2.0043AA40<br>00450001  |. 8BD8           MOV EBX,EAX<br>00450003  |. E8 F081FBFF    CALL &lt;JMP.&amp;user32.GetActiveWindow&gt;       ; [GetActiveWindow<br>00450008  |. 3BD8           CMP EBX,EAX<br>0045000A  |. 74 05          JE SHORT DNIPRO~2.00450011<br>0045000C  |. 33C0           XOR EAX,EAX<br>0045000E  |. 8945 E4        MOV DWORD PTR SS:[EBP-1C],EAX<br>00450011  |&gt; 33C0           XOR EAX,EAX<br>00450013  |. 5A             POP EDX<br>00450014  |. 59             POP ECX<br>00450015  |. 59             POP ECX<br>00450016  |. 64:8910        MOV DWORD PTR FS:[EAX],EDX<br>00450019  |. 68 2E004500    PUSH DNIPRO~2.0045002E<br>0045001E  |&gt; 8B45 FC        MOV EAX,DWORD PTR SS:[EBP-4]<br>00450021  |. E8 7AFDFFFF    CALL DNIPRO~2.0044FDA0<br>00450026  . C3             RETN<br></code><br><br>жму ctrl-r на выделеной строчке<br><br><code><br>00448FDC   DD DNIPRO~2.0044FE58<br>004492C0   DD DNIPRO~2.0044FE58<br>00449F58   DD DNIPRO~2.0044FE58<br>0044FE58   PUSH EBP                                  (Initial CPU selection)<br>00464D74   DD DNIPRO~2.0044FE58<br>004684F8   DD DNIPRO~2.0044FE58<br>004AF054   DD DNIPRO~2.0044FE58<br>004FE51C   DD DNIPRO~2.0044FE58<br>00523404   DD DNIPRO~2.0044FE58<br>00524D08   DD DNIPRO~2.0044FE58<br>0052515C   DD DNIPRO~2.0044FE58<br>0052C804   DD DNIPRO~2.0044FE58<br>0052CD20   DD DNIPRO~2.0044FE58<br>005381DC   DD DNIPRO~2.0044FE58<br>0053B054   DD DNIPRO~2.0044FE58<br>00540900   DD DNIPRO~2.0044FE58<br>00540BB0   DD DNIPRO~2.0044FE58<br>0054CFCC   DD DNIPRO~2.0044FE58<br></code><br><br>а там нету CALL-ов, как в таком случае можно отследить <b>ОТКУДА</b> вызвалась процедура
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123473&amp;user=9617&amp;forum_n=5&amp;topic=7950.html&amp;page=0&amp;anchor=1" class="addthx" data-post="123473"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]HoBleen[/b]','')">HoBleen</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/5110.jpg" alt=""><br><span class=txtSm>Ранг: 240.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.09'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5110">Участник</a><br><font color=blue>Author of ACKiller </font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2007 23:51 <br><script type="text/javascript">QU('HoBleen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HoBleen" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7950.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>Feldsher пишет:<br>ОТКУДА вызвалась процедура </I><br>Смотришь в стек.<br><br>Адрес может и не быть известен для дизассемблера, если, например, метод виртуальный - цепочка вызовов не известна до времени вызова. Но в этом-то и преимущество <b>отладчика</b>, что можно внаглую подсмотреть адрес <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123476&amp;user=5110&amp;forum_n=5&amp;topic=7950.html&amp;page=0&amp;anchor=2" class="addthx" data-post="123476"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Executioner[/b]','')">Executioner</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/7616.gif" alt=""><br><span class=txtSm>Ранг: 120.9 (ветеран), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.68'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7616">Участник</a><br><font color=blue>Programmer and reverser</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2007 23:55 &middot; Поправил: Executioner <br><script type="text/javascript">QU('Executioner','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Executioner" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7950.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
можно еще попробовать пройти до RET, нажать F8 (для выхода из процедуры) и посмотреть, что было инструкцией выше <img src="img/smilies/s15.gif" alt="">
<br><br><font size="1"><i>-----<br>Уважайте других и пишите грамотно.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=123477&amp;user=7616&amp;forum_n=5&amp;topic=7950.html&amp;page=0&amp;anchor=3" class="addthx" data-post="123477"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 февраля 2007 01:09 <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7950.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Бывает такая ситуация в защите:<br>Вызывающий чистит стек делает jmp на некую функцию, но тогда из этой процедуры уже не будет возврата.<br>В крайнем случае, можно трейсом отследить.
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=123487&amp;user=410&amp;forum_n=5&amp;topic=7950.html&amp;page=0&amp;anchor=4" class="addthx" data-post="123487"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]HoBleen[/b]','')">HoBleen</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/5110.jpg" alt=""><br><span class=txtSm>Ранг: 240.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.09'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5110">Участник</a><br><font color=blue>Author of ACKiller </font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 февраля 2007 01:25 <br><script type="text/javascript">QU('HoBleen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HoBleen" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7950.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>Bitfry</b><br>Ну в данном случае понятно, что это функция с возвратом:<br><br><I>Feldsher пишет:<br>044FE58 / 55 PUSH EBP <br>0044FE59 |. 8BEC MOV EBP,ESP <br>0044FE5B |. 83C4 E0 ADD ESP,-20 </I><br>Видно, что это построено компилятором, а не вручную, а компилер, думаю, не будет сохранять старое ebp, если оно никому не нужно. Ну и безвозвратных ф-й у известных языков я что-то не припомню..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123492&amp;user=5110&amp;forum_n=5&amp;topic=7950.html&amp;page=0&amp;anchor=5" class="addthx" data-post="123492"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 февраля 2007 08:59 <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7950.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>HoBleen</I>, скорее всего для данной ситуации ответ ты уже дал:<br><I>Смотришь в стек.</I><br>Но для повышения квалификации я добавил, как ещё может быть.<br><br><I>HoBleen пишет:<br>Видно, что это построено компилятором, а не вручную, а компилер, думаю, не будет сохранять старое ebp, если оно никому не нужно. Ну и безвозвратных ф-й у известных языков я что-то не припомню.. </I><br>В любую из процедур можно вбахать ExitProcess или ExitThread или jmp на систему или ret после чистки стека и т.п.<br>ИМХО сложностей с этим не возникнет даже на бейсике =)... Хотя врать не буду, сам только на Асме пишу.
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=123522&amp;user=410&amp;forum_n=5&amp;topic=7950.html&amp;page=0&amp;anchor=6" class="addthx" data-post="123522"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]HoBleen[/b]','')">HoBleen</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/5110.jpg" alt=""><br><span class=txtSm>Ранг: 240.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.09'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5110">Участник</a><br><font color=blue>Author of ACKiller </font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 февраля 2007 09:28 <br><script type="text/javascript">QU('HoBleen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HoBleen" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7950.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>Bitfry пишет:<br>В любую из процедур можно вбахать ExitProcess или ExitThread или jmp на систему или ret после чистки стека и т.п. </I><br>Компилер полюбому сохранит адрес возврата в стеке =&gt; его можно будет узнать даже если ты оттуда потом ускачешь на самовпиханных jmp&#039;ах.<br><br>Такое может быть в протах, где вначале после колла идет мусор, а в колле адрес возврата подменяется на настоящий код.<br><br>ЗЫ Просто я говорил про данный случай, а так конечно да)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123527&amp;user=5110&amp;forum_n=5&amp;topic=7950.html&amp;page=0&amp;anchor=7" class="addthx" data-post="123527"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b][EXE]_cutor[/b]','')">[EXE]_cutor</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/1506.jpg" alt=""><br><span class=txtSm>Ранг: 115.8 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.29'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1506">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 февраля 2007 11:01 <br><script type="text/javascript">QU('[EXE]_cutor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[EXE]_cutor" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7950.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Feldsher пишет:<br>а там нету CALL-ов </I><br>сталкивался недавно с подобным в СИ&#039;шной проге<br><br>встаешь на любую строчку (005381DC DD DNIPRO~2.0044FE58 ) и еще раз ctrl+R и видишь свои CALL&#039;ы.<br>по крайней мере у меня прокатывало.
<br><br><font size="1"><i>-----<br>Ни одно доброе дело не должно остаться безнаказанным !!!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=123539&amp;user=1506&amp;forum_n=5&amp;topic=7950.html&amp;page=0&amp;anchor=8" class="addthx" data-post="123539"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2007 00:14 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7950.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>[EXE]_cutor пишет:<br>встаешь на любую строчку (005381DC DD DNIPRO~2.0044FE58 ) </I><br> Наличие много раз продублированных адресов подозрительно - компилятор прооптимизировал бы, наверное.  Не исключено, что все-таки прот, который навесил на каждый вызов мусор, а адрес спрятал.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123589&amp;user=4072&amp;forum_n=5&amp;topic=7950.html&amp;page=0&amp;anchor=9" class="addthx" data-post="123589"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2007 04:42 &middot; Поправил: Bitfry <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7950.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>HoBleen пишет:<br>Компилер полюбому сохранит адрес возврата в стеке =&gt; его можно будет узнать даже если ты оттуда потом ускачешь на самовпиханных jmp&#039;ах.  </I><br><br>Чисто теоретически.<br>Представь себе, что перед вызовом кода, который представлен здесь, в исходнике стоит что-то вроде этого:<br>asm<br>mov ECX,ESP<br>sub ECX,[начальное состояние стека]<br>@@loop<br>  mov DWORD PTR [ESP],0<br>  ADD ESP,-4<br>  ADD ECX,-4<br>  jnz @@loop<br>jmp _0044FE58<br>end;<br>(это грубо, но суть должна быть ясна)<br><br>А здесь для отвода глаз (и возможно финализации) твориться куча всякой ерунды и потом где-нибудь в 0043AA40 просто jmp ExitProcess.
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=123677&amp;user=410&amp;forum_n=5&amp;topic=7950.html&amp;page=0&amp;anchor=10" class="addthx" data-post="123677"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2007 07:56 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7950.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>Bitfry пишет:<br>jmp _0044FE58  </I><br><I>Bitfry пишет:<br>Чисто теоретически.  </I><br> Только теоретически. Там <I> DD DNIPRO~2.0044FE58  </I> , нет никаких JMP<br> Поэтому скорее, там   <br>  MOV   EAX, dword prt [00448FDC]<br>  CALL  EAX<br> Либо там прот, который &quot;замазал&quot; CALL  в  DD. Надо ждать автора <img src="img/smilies/s8.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123917&amp;user=4072&amp;forum_n=5&amp;topic=7950.html&amp;page=0&amp;anchor=11" class="addthx" data-post="123917"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> как отследить откуда &quot;вызвалась&quot; процедура</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#12" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="7950">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=7950" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
