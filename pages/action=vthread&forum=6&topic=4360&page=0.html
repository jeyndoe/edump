<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как програмно залогинится в XP ? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Как програмно залогинится ? ситуция такая: На экране &quot;нажмите Alt+Ct..&quot; Необходимо войти с заданным логином-паролем по команде из сети предпологается написать для этого сужбу слушаящую некоторый порт на предмет команды">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=39467'>hgdagon</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как програмно залогинится в XP ?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]xf1700[/b]','')">xf1700</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.3'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=4194">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2006 11:13 <br><script type="text/javascript">QU('xf1700','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xf1700" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Как програмно залогинится ?
<br>
<br>ситуция такая:
<br>
<br>На экране &quot;нажмите Alt+Ct..&quot;
<br>Необходимо войти с заданным логином-паролем по команде из сети
<br>предпологается написать для этого сужбу слушаящую некоторый порт на предмет команды
<br>
<br>с целью быстрого запуска некоторых прог (типа флеша) а 30 компах в сети
<br>
<br>Система Windows XP 
<br>
<br>Главный вопрос:
<br>Как програмно залогинится ? 
<br>не &quot;можно ли?&quot; а &quot;как?&quot;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=59276&amp;user=4194&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=1" class="addthx" data-post="59276"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]agentru[/b]','')">agentru</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 71.6 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.28'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1532">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2006 11:18 <br><script type="text/javascript">QU('agentru','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=agentru" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>xf1700</b>
<br>
<br>На делфимастере статейка была.
<br>Там подробненько описываеться.
<br>
<br>www.delphimaster.ru
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=59277&amp;user=1532&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=2" class="addthx" data-post="59277"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Vedrus[/b]','')">Vedrus</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 60.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.56'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3318">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2006 14:02 <br><script type="text/javascript">QU('Vedrus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vedrus" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
У меня была другая проблема: как под XP программно выключиться <img src="img/smilies/s1.gif" alt="">. Я решил её эмулируя нажатие клавиш из обычной программы. В твоём случае тоже можно эмулировать нажатия клавиш, но только через службу. В аттаче лежит статья, как пользоваться API-функциями эмулирующими нажатие.<br><br><img src="img/attach.gif" alt=""> <a href="./files/773a_Article.zip.zip">773a_Article.zip.zip</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=59297&amp;user=3318&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=3" class="addthx" data-post="59297"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Viktoro[/b]','')">Viktoro</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/592.jpg" alt=""><br><span class=txtSm>Ранг: 116.9 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.71'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=592">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2006 15:34 <br><script type="text/javascript">QU('Viktoro','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Viktoro" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
ищи описание msgina.dll и будет тебе счастие...
<br><br><font size="1"><i>-----<br>Nothing just happens. You choose it to happen.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=59306&amp;user=592&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=4" class="addthx" data-post="59306"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]xf1700[/b]','')">xf1700</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.3'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=4194">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2006 15:53 <br><script type="text/javascript">QU('xf1700','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xf1700" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
2<b>agentru</b>
<br> можно уточнить название, ключевые слова?
<br>
<br>2<b>Vedrus</b> и <b>Viktoro</b>
<br> спасибо, попробуем
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=59307&amp;user=4194&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=5" class="addthx" data-post="59307"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]NullSession[/b]','')">NullSession</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 62.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3600">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2006 16:31 <br><script type="text/javascript">QU('NullSession','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NullSession" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
WlxLoggedOutSAS, WlxLoggedInSAS и т.д. всё это в msgina.dll
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=59506&amp;user=3600&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=6" class="addthx" data-post="59506"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]agentru[/b]','')">agentru</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 71.6 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.28'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1532">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2006 20:06 <br><script type="text/javascript">QU('agentru','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=agentru" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>xf1700 пишет:
<br>можно уточнить название, ключевые слова?  </I>
<br>
<br>По поиску забей: переключение юзеров в ХР.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=59548&amp;user=1532&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=7" class="addthx" data-post="59548"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Shidla[/b]','')">Shidla</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/2984.gif" alt=""><br><span class=txtSm>Ранг: 60.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2984">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 марта 2006 21:05 <br><script type="text/javascript">QU('Shidla','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Shidla" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Чувак! Убери пароль админа на *** и наслаждайся его учётной записью!!! <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=59794&amp;user=2984&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=8" class="addthx" data-post="59794"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]xf1700[/b]','')">xf1700</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.3'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=4194">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 марта 2006 14:03 &middot; Поправил: xf1700 <br><script type="text/javascript">QU('xf1700','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xf1700" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>Shidla</b>
<br>Чувак! я сам админ<img src="img/smilies/s6.gif" alt="">
<br>и мне нужно именно то, что я описал выше
<br>
<br><I>Vedrus пишет:
<br> эмулировать нажатия клавиш, но только через службу. </I>
<br>пока что этот метод не действует(
<br>и инфы по нему не нашел, а он был бы лучше всего..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60179&amp;user=4194&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=9" class="addthx" data-post="60179"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Vedrus[/b]','')">Vedrus</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 60.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.56'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3318">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 марта 2006 14:16 &middot; Поправил: Vedrus <br><script type="text/javascript">QU('Vedrus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vedrus" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>xf1700</b>, в чем проблема? Из сервиса апи эмуляции нажатия клавиш не работают? Пробовал с ними поэксперементировать не из под сервиса, а из под обычной программы?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60182&amp;user=3318&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=10" class="addthx" data-post="60182"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]xf1700[/b]','')">xf1700</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.3'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=4194">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 марта 2006 14:28 <br><script type="text/javascript">QU('xf1700','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xf1700" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Однако, инфа всплывает:
<br>
<br>bugtraq.ru/library/programming/keylogging.html
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60185&amp;user=4194&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=11" class="addthx" data-post="60185"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]rmf[/b]','')">rmf</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.5 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.18'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1764">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 марта 2006 14:49 &middot; Поправил: rmf <br><script type="text/javascript">QU('rmf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rmf" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Тебе dll&#039;ку надо создать, которую нужно прописать в 
<br>HKEY_LOCAL_MACHINE&#92;SOFTWARE&#92;Microsoft&#92;Windows NT&#92;CurrentVersion&#92;Winlogon&#92;Notify
<br>
<br>Подробнее смотри в MSDN,  ну и использовать ф-ции из msgina.dll
<br>
<br>Если чё, пиши в icq если не поймешь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60194&amp;user=1764&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=12" class="addthx" data-post="60194"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]t3stament01[/b]','')">t3stament01</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 32.4 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.87'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2512">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 марта 2006 15:24 <br><script type="text/javascript">QU('t3stament01','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=t3stament01" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>Vedrus пишет:
<br> Из сервиса апи эмуляции нажатия клавиш не работают </I>
<br>Какие еще нажатия клавиш...
<br>Берешь свой сервис и прописываешь username и password в текстовые поля командой SetWindowText а затем посылаешь WM_COMMAND на кнопку OK
<br>Проблема лишь в том что тебе надо прошпионить окна чтобы потом найти их через FindWindow
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60203&amp;user=2512&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=13" class="addthx" data-post="60203"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]xf1700[/b]','')">xf1700</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.3'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=4194">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 марта 2006 22:19 <br><script type="text/javascript">QU('xf1700','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xf1700" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>Vedrus пишет:
<br>xf1700, в чем проблема? Из сервиса апи эмуляции нажатия клавиш не работают? Пробовал с ними поэксперементировать не из под сервиса, а из под обычной программы? </I>
<br>Например: программа вызывает keybd_event раз в 2 секунды -
<br>печатает букву А в любых полях ввода, кроме полей логина &#92; пароля
<br>однако, beep раз в 2 сек слышно в любом случае
<br>сервис, с той же функцией, работает так же.
<br>
<br>По видимому, это просто так не прокатит.
<br>
<br><I>rmf пишет:
<br>Тебе dll&#039;ку надо создать, которую нужно прописать в 
<br>HKEY_LOCAL_MACHINE&#92;SOFTWARE&#92;Microsoft&#92;Windows NT&#92;CurrentVersion&#92;Winlogon&#92;Notify </I>
<br>по причине недостаточной прямоты моих рук, это, думаю, может выдать BSOD
<br>в самый интересный момент, а таких моментов у нас предостаточно...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60309&amp;user=4194&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=14" class="addthx" data-post="60309"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]rmf[/b]','')">rmf</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.5 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.18'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1764">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 марта 2006 23:22 <br><script type="text/javascript">QU('rmf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rmf" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>xf1700</b>, сколько я не эксперементировал - BSOD&#039;a не видел! Надо просто в код dll&#039;ки 3 cтрочки добавить, чтобы всё работало! строчки найди в MSDN по поиску &quot;HKEY_LOCAL_MACHINE&#92;SOFTWARE&#92;Microsoft&#92;Windows NT&#92;CurrentVersion&#92;Winlogon&#92;Notify&quot;
<br>
<br>Всё подробно описано
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60323&amp;user=1764&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=15" class="addthx" data-post="60323"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Vedrus[/b]','')">Vedrus</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 60.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.56'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3318">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 апреля 2006 04:16 &middot; Поправил: Vedrus <br><script type="text/javascript">QU('Vedrus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vedrus" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>xf1700 пишет:
<br> программа вызывает keybd_event раз в 2 секунды - 
<br>печатает букву А в любых полях ввода, кроме полей логина &#92; пароля </I>
<br>А фокус на поле ввода установлен? Ты пробовал сам нажимать ту последовательность клавиш, которую проге скармливаешь? А то может ты просто не в том окне. Тогда надо x раз имитировать нажатие Tab.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60359&amp;user=3318&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=16" class="addthx" data-post="60359"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]t3stament01[/b]','')">t3stament01</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 32.4 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.87'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2512">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 апреля 2006 12:28 <br><script type="text/javascript">QU('t3stament01','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=t3stament01" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Зачем эмулировать нажатия клавишь, когда всеми окнами легко можно манипульровать через WM сообщения. Это гораздо надежнее...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60403&amp;user=2512&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=17" class="addthx" data-post="60403"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Vedrus[/b]','')">Vedrus</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 60.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.56'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3318">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 апреля 2006 12:57 <br><script type="text/javascript">QU('Vedrus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vedrus" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>t3stament01</b> WM_XXX надёжнее,  а эмуляция проще (в смысле не требует особых знаний Win32 API). Чем пользоваться каждый волен.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60413&amp;user=3318&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=18" class="addthx" data-post="60413"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]NullSession[/b]','')">NullSession</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 62.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3600">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2006 10:30 <br><script type="text/javascript">QU('NullSession','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NullSession" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>Vedrus</b>
<br>Как их эмулировать?
<br>Я только через WM_XXX знаю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60520&amp;user=3600&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=19" class="addthx" data-post="60520"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]NullSession[/b]','')">NullSession</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 62.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3600">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2006 10:34 <br><script type="text/javascript">QU('NullSession','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NullSession" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
В состоянии &quot;Нет залогиненого пользователя&quot; Winlogon ожидает прихода SAS (secure attention sequence=защищенная последовательность активации) либо от пользователя, нажавшего CTRL-ALT-DEL, либо от GINA DLL (она может генерировать свои SAS, отличные от стандартных, и оповещать Winlogon при помощи функции WlxSasNotify). В случае возникновения SAS Winlogon вызывает в GINA функцию WlxLoggedOutSAS. GINA, обработав данное событие, может либо перевести Winlogon в состояние &quot;Есть залогиненный пользователь. Станция разблокирована&quot;, либо оставить его в текущем состоянии. 
<br>
<br>При возникновении SAS в состоянии &quot;Есть залогиненный пользователь. Станция разблокирована&quot; Winlogon вызывает функцию WlxLoggedOnSAS, после чего он может быть переведен в состояние &quot;Нет залогиненого пользователя&quot; или в состояние &quot;Есть залогиненный пользователь. Станция заблокирована&quot;, либо оставлен в текущем состоянии. 
<br>WlxSasNotify
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60521&amp;user=3600&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=20" class="addthx" data-post="60521"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Vedrus[/b]','')">Vedrus</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 60.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.56'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3318">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2006 14:49 &middot; Поправил: Vedrus <br><script type="text/javascript">QU('Vedrus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vedrus" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>NullSession</b>, смотри аттач моего первого поста. Там пример. Хотя функции, которые там используются скорее всего всё-равно обращаются к WM_XXX.
<br>
<br>Слушай, а ты где нарыл эту инфу? В MSDN конечно я это видел, но может есть что-нибудь на русском. Было бы интересно разобраться. Можешь дать ссылку(и) или приаттачить?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60549&amp;user=3318&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=21" class="addthx" data-post="60549"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]xf1700[/b]','')">xf1700</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.3'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=4194">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2006 15:07 <br><script type="text/javascript">QU('xf1700','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xf1700" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
www.rsdn.ru/article/baseserv/extgina.xml
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60552&amp;user=4194&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=22" class="addthx" data-post="60552"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]xf1700[/b]','')">xf1700</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.3'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=4194">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2006 15:10 <br><script type="text/javascript">QU('xf1700','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xf1700" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
The <b>keybd_event</b> function synthesizes a keystroke. The system can use such a synthesized keystroke to generate a WM_KEYUP or WM_KEYDOWN message. The keyboard driver&#039;s interrupt handler calls the keybd_event function.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60554&amp;user=4194&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=23" class="addthx" data-post="60554"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]NullSession[/b]','')">NullSession</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 62.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3600">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 апреля 2006 16:32 <br><script type="text/javascript">QU('NullSession','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NullSession" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>2 Vedrus</b>
<br>Ссылку запостил <b>xf1700</b>. Вроде бы та самая. Вообще как бы rsdn рулит. Он не так много денег (трафика) жрёт и информацию полезную на русском выдаёт, если только она на нём есть.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=60566&amp;user=3600&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=24" class="addthx" data-post="60566"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]xf1700[/b]','')">xf1700</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.3'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=4194">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 апреля 2006 17:57 <br><script type="text/javascript">QU('xf1700','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xf1700" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>xf1700 пишет:
<br>bugtraq.ru/library/programming/keylogging.html </I>
<br>
<br><code>//Подключаемся к оконной станции
<br>  hWS = OpenWindowStation(&quot;Winsta0&quot;, FALSE, GENERIC_ALL);
<br>  SetProcessWindowStation(hWS);
<br>
<br>  //Подключаемся к рабочему столу
<br>  hDT = OpenDesktop(&quot;Winlogon&quot;, 0, FALSE, GENERIC_ALL);
<br>  SetThreadDesktop(hDT);</code>
<br>
<br>попытка сделать сервис, подобный описаннаму, пока что не удается
<br>getLastError выдает  &quot;Ресурс занят&quot; 
<br> на  шаге  SetThreadDesktop(hDT);
<br>(пишем на delphi7)
<br>в чем может быть дело?
<br>
<br>И
<br>Сервис, вызывающий Beep раз в 3сек не запускается или не бипАет после перезагрузки пк, но до того как кто либо загогинился..
<br>в чем может быть дело?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=61377&amp;user=4194&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=25" class="addthx" data-post="61377"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]xf1700[/b]','')">xf1700</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.3'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=4194">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2006 19:08 <br><script type="text/javascript">QU('xf1700','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xf1700" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
Решил сделать по простому, записать значения ключей ниже и вызвать ребут.
<br>
<br>HKEY_LOCAL_MACHINE&#92;Software&#92;Microsoft&#92;Windows NT&#92;CurrentVersion&#92;WinLogon
<br>DefaultUserName
<br>DefaultPassword
<br>DefaultDomainName
<br>AutoAdminLogon
<br>
<br>Отлично работает)
<br>Но, интересуют другие способы.....
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=63689&amp;user=4194&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=26" class="addthx" data-post="63689"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]NullSession[/b]','')">NullSession</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 62.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3600">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 апреля 2006 14:01 <br><script type="text/javascript">QU('NullSession','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NullSession" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=4360.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
Без переписывания msgina.dll это сложно. Как вариант: внутрь своей dll поместить код, который проверяет, не поступила ли команда по сети, и если поступит, вручную вызвать WlxLoggedOutSAS.
<br>P.s. тебе ведь надо всего лишь быстро запустить прогу - тогда вызывай CreateProcessAsUser, а код внутри службы помещай, она будет порт слушать и ничего извращенского - остановил службу - отключил эту возможность, включил на автозапуск - на тебе удалённое выполнение.
<br>Вот только проблема - а что если пошлют команду не сервера, а с другого компа, можно ведь будет под правами админа юзверям поработать. И это недостаток всех методов.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=63862&amp;user=3600&amp;forum_n=6&amp;topic=4360.html&amp;page=0&amp;anchor=27" class="addthx" data-post="63862"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как програмно залогинится в XP ?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#28" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="4360">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=4360" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
