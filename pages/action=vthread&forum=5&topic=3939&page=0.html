<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как в стек втолкнуть 1 байт? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Как в стек втолкнуть 1 байт? Например есть var1 db 5 Masm ругается и на такое: push var1,  и на такое: mov al, var1 push al Я так понял, что в стек можно толкать только Word. Как можно втолкнуть байт?  Извните если не по теме,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как в стек втолкнуть 1 байт?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Spitfire[/b]','')">Spitfire</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.51'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3428">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2006 13:36 <br><script type="text/javascript">QU('Spitfire','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Spitfire" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Как в стек втолкнуть 1 байт?
<br>Например есть 
<br>var1 db 5
<br>
<br>Masm ругается и на такое:
<br>
<br>push var1, 
<br>
<br>и на такое:
<br>mov al, var1
<br>push al
<br>
<br>Я так понял, что в стек можно толкать только Word.
<br>Как можно втолкнуть байт? 
<br>
<br>Извните если не по теме, просто не знаю где сппросить, Wasm.ru не работает
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=53374&amp;user=3428&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=1" class="addthx" data-post="53374"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]al_begin[/b]','')">al_begin</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3613">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2006 14:19 <br><script type="text/javascript">QU('al_begin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=al_begin" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
В любом учебнике по ассемблеру <b>...при записи в стек 8-битных значений для них все равно выделяется слово или двойное слово (в зависимости от use16 или use32)... </b>
<br>  <I>push var1</I> - попытка записать в стек оффсет переменной var1, а не самой ее.
<br>
<br><I>mov al, var1 
<br>push al  </I>
<br>
<br>а на такое не только компилятор, но и Блокнот скоро ругаться будет...
<br>Поиском по форуму ссылки на учебники по ассемблеру...только бы не забанили (да и меня заодно за оффтоп...)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=53389&amp;user=3613&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=2" class="addthx" data-post="53389"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2006 15:17 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
.data
<br>var1 dw 5
<br>
<br>.code
<br>lea eax, var1 
<br>push word ptr [eax]
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=53395&amp;user=1379&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=3" class="addthx" data-post="53395"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]al_begin[/b]','')">al_begin</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3613">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 февраля 2006 09:50 <br><script type="text/javascript">QU('al_begin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=al_begin" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
О-о-псс, пора имне повторять изученное по ассемблеру, потому что мне кажется, что <I> push word ptr [eax] </I> затолкнет в стек только первые 4 байта из переменной var1...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=53503&amp;user=3613&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=4" class="addthx" data-post="53503"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Spitfire[/b]','')">Spitfire</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.51'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3428">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 февраля 2006 13:58 <br><script type="text/javascript">QU('Spitfire','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Spitfire" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Jupiter
<br>lea eax, var1  ; загружаем в Eax эффективный адрес переменной var1
<br>push word ptr [eax]; push в стэк eax, меняя атрибут типа (только не понял почему не Byte ptr[eax], ведь у нас и так Var1 типа Word)
<br>
<br>а почему нельзя push offset var1?
<br>
<br>Но проблема немного не в том.
<br>
<br>____________________________________________________
<br>var1 | var2 | var3| var4| var5 | var6 | var7 | var8
<br>____________________________________________________
<br>db   | db   | dw  | dw  | dw   | dw   | db   | db
<br>
<br>
<br>Нужно через стек поменять 
<br> 
<br>____________________________________________________
<br>var7 | var1 | var4| var6| var3 | var5 | var8 | var2
<br>____________________________________________________
<br>
<br>
<br>Я думаю примерно так:
<br>	push offset var1
<br>	push offset var2
<br>	push offset var3
<br>	push offset var4
<br>	push offset var5
<br>	push offset var6
<br>	push offset var7
<br>	push offset var8
<br>
<br>	pop var7
<br>	pop var1
<br>	pop var4
<br>	pop var6
<br>	pop var3
<br>	pop var5
<br>	pop var8
<br>	pop var2
<br>
<br>Или нет?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=53535&amp;user=3428&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=5" class="addthx" data-post="53535"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]arnix[/b]','')">arnix</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 210.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 февраля 2006 00:35 <br><script type="text/javascript">QU('arnix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=arnix" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>Spitfire пишет:
<br>Как в стек втолкнуть 1 байт? 
<br>Например есть 
<br>var1 db 5 
<br>
<br>Masm ругается и на такое: 
<br>
<br>push var1, 
<br>
<br>и на такое: 
<br>mov al, var1 
<br>push al 
<br>
<br>Я так понял, что в стек можно толкать только Word. </I>
<br>
<br>Можешь делать так (вместа push al): (синтакс: фасм)
<br><code>
<br>dec esp
<br>mov byte [esp],al</code>
<br>
<br>Потом вместа pop al:
<br><code>
<br>mov al, byte [esp]
<br>inc esp</code>
<br>
<br>Но пользы от этого я не вижу. После &quot;псевдо&quot; push al не вздумай делать нормальный pop chto_to, пока не сделаешь &quot;псевдо&quot;  pop al, думаю ясно почему...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=53591&amp;user=26&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=6" class="addthx" data-post="53591"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 февраля 2006 09:06 &middot; Поправил: Bitfry <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Всех бы нах забанил <img src="img/smilies/s1.gif" alt="">
<br>
<br><I>al_begin пишет:
<br>push var1 - попытка записать в стек оффсет переменной var1, а не самой ее.</I>
<br>Ты видишь здесь директиву offset?
<br>Синтаксис MASM&#039;a предполагает: 
<br>&quot;[var1]&quot; то же самое что &quot;var1&quot;
<br>
<br>Такая нестрогость путает всех новичков. Я бы посоветовал всегда брать в скобки, тем более что &quot;эталонный&quot; синтаксис другого варианта и не даёт. Если нужен указатель – &quot;var1&quot;, если значение – &quot;[var1]&quot;.
<br>
<br><I>al_begin пишет:
<br>В любом учебнике по ассемблеру ...при записи в стек 8-битных значений для них все равно выделяется слово или двойное слово (в зависимости от use16 или use32)...  </I>
<br>Только нужно сказать, речь идёт про компилятор MASM&#039;a а не про Ассемблер.
<br>Не парте себе мозги, взгляните на возможные инструкции процессора.
<br>
<br><I>arnix пишет:
<br>Можешь делать так (вместа push al): (синтакс: фасм)
<br>dec esp
<br>mov byte [esp],al
<br>Потом вместа pop al:
<br>mov al, byte [esp]
<br>inc esp
<br>Но пользы от этого я не вижу. После &quot;псевдо&quot; push al не вздумай делать нормальный pop chto_to, пока не сделаешь &quot;псевдо&quot; pop al, думаю ясно почему... </I>
<br>Бред. Причём тут стек? <img src="img/smilies/s1.gif" alt="">
<br>
<br><I>Spitfire пишет:
<br>а почему нельзя push offset var1?  </I>
<br>Можно, но ты получишь в стеке указатель на переменную, а не её значение.
<br>
<br>Так теперь к сути.
<br>
<br>Стек это всего лишь область памяти на вершину которой указывает ESP/SP (32bit/16bit)
<br>Работу со стеком поддерживают некоторые команд процессора.
<br>А они предполагают несколько правил таких как...
<br>
<br>1. Стек растёт от старшего адреса к младшему.
<br>2. Эти команды могут обработать только 16 бит или 32 бита.
<br>
<br>Кроме того, операционная система тоже требует своих правил при работе со стеком.
<br>В Windows лучше не делать dec ESP. Процессор это позволяет, но при вызове API-функции, которая уходит в ring0 (а это большинство функций), будет бяка. Таким образом, самое разумное это учитывать правило:
<br>в Win32 стек должен быть кратен 32.
<br>
<br>Про возможности процессора.
<br>
<br>В 32 битном режиме адресации и операндов можно сделать так:
<br><code>50h       push EAX
<br>66:50h  push AX</code>
<br>
<br>Если режим 16 битный, то будет наоборот:
<br>
<br><code>50h       push AX
<br>66:50h  push EAX</code>
<br>
<br>Если перед опкодом стоит байт 66h, то эта команда использует префикс размера операнда.
<br>В форточках можно дважды запихнуть в стек 16-битное значение, и всё будет как надо, главное чтоб было кратно 32.
<br>
<br>Ещё раз: push, pop, call, ret и т.д. могут работать только с word или dword.
<br>В Win32 по умолчанию это будет dword.
<br>
<br>Вывод.
<br>Если нужно поменять значения переменных в форточной проге, делаем это так:
<br>(смотри атач, musor из архива удалить, файлы меньше 20 кило не цепляются)
<br>
<br>Хотя из твоих расстановок не очень понятно, что ты собственно хочешь =).
<br>
<br>ЗЫ Всем читать(!):
<br>bitfry.narod.ru
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=53619&amp;user=410&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=7" class="addthx" data-post="53619"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 февраля 2006 09:42 <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Пример:<br><br><img src="img/attach.gif" alt=""> <a href="./files/7ea2_stack_example.rar.zip">7ea2_stack_example.rar.zip</a>
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=53620&amp;user=410&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=8" class="addthx" data-post="53620"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Spitfire[/b]','')">Spitfire</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.51'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3428">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 февраля 2006 13:10 <br><script type="text/javascript">QU('Spitfire','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Spitfire" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Всем большое спасибо!<img src="img/smilies/s1.gif" alt="">
<br>И последний вопрос:
<br>Почему не работае movzx ax,byte ptr [var1]? (просто под Dos надо написать)
<br>Error A2105: Expected: instruction or directive
<br>
<br>Ведь в качестве первого операнда Movzx может использоваться 16 или 32 разрядный регистр? 
<br>И еще
<br><I>Bitfry пишет:
<br>Если режим 16 битный, то будет наоборот: 
<br>
<br>50h push AX 
<br>66:50h push EAX  </I>
<br>Это как? В 16-битном режиме вроде нет eax
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=53641&amp;user=3428&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=9" class="addthx" data-post="53641"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]arnix[/b]','')">arnix</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 210.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 февраля 2006 13:45 <br><script type="text/javascript">QU('arnix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=arnix" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>Bitfry пишет:
<br>
<br>arnix пишет: 
<br>Можешь делать так (вместа push al): (синтакс: фасм) 
<br>dec esp 
<br>mov byte [esp],al 
<br>Потом вместа pop al: 
<br>mov al, byte [esp] 
<br>inc esp 
<br>Но пользы от этого я не вижу. После &quot;псевдо&quot; push al не вздумай делать нормальный pop chto_to, пока не сделаешь &quot;псевдо&quot; pop al, думаю ясно почему... 
<br>
<br>Бред. Причём тут стек? </I>
<br>
<br>Как это причем тут стэк? Или ты скажешь что не знаешь для чего предназначен регистр ESP ?? <img src="img/smilies/s1.gif" alt="">
<br>push eax (втолкнули в стэк значение регистра EAX)
<br>
<br>Тоже самое можно сделать так:
<br>
<br>sub esp,4
<br>mov dword [esp], eax
<br>
<br>Или я не прав по-твоему?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=53644&amp;user=26&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=10" class="addthx" data-post="53644"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 февраля 2006 18:22 &middot; Поправил: Bitfry <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>arnix пишет:
<br>Как это причем тут стэк? Или ты скажешь что не знаешь для чего предназначен регистр ESP ??</I>
<br>Давай думать вместе.
<br>Вообще благодаря чего существует стек?
<br>Ответ: исключительно благодаря нескольких команд процессора (push, pushad, pop, popad, call, ret... Может чего забыл).
<br>Ведь не было бы этих команд и стек &quot;перестал бы существовать&quot;.
<br>В свою очередь эти команды для выполнения используют сегментный регистр стека (SS) и регистр указателя вершины стека ESP/SP. 
<br>Согласен?
<br>Но с другой стороны, ESP – это один из регистров общего назначения (РОН).
<br>Так вот каждый РОН имеет двойной смысл. Их можно использовать по прямому назначению (аккумулятор, база, счётчик... индекс), а можно как &quot;переменные&quot; для собственных нужд (хранить там результаты вычислений или указатели).
<br>
<br>Моё представление такое: твой <b>первый</b> пример это использование регистра ESP как указатель на область памяти и всё.
<br>(А вот последний пример можно рассматривать двояко <img src="img/smilies/s1.gif" alt=""> )
<br>Ты ведь не можешь использовать команды для работы со стеком, чтоб достать один байт?
<br>Ещё раз повторю, стека нет без команд процессора для работы с ним.
<br>Можно творить всё, что душе угодно с  памятью и РОН, но если мы не придерживаемся правил работы со стеком, это просто область памяти и просто регистр общего назначения ESP.
<br>Конечно, это не так важно, но лучше сразу в голове навести порядок, дальше проще будет.
<br>
<br>
<br><I>Spitfire пишет:
<br>И последний вопрос:
<br>Почему не работае movzx ax,byte ptr [var1]? (просто под Dos надо написать)
<br>Error A2105: Expected: instruction or directive
<br>
<br>Ведь в качестве первого операнда Movzx может использоваться 16 или 32 разрядный регистр?</I>
<br>Правильно, поэтому должно работать.
<br>Возможно, ты забыл &quot;сказать&quot;, что мы пишем прогу для процессора 80386 и выше.
<br>Или нужно на двойке показывать? <img src="img/smilies/s1.gif" alt="">
<br>Деректива MASM &quot;.386&quot;... Ещё раз повторяю – читай мои статьи!
<br>
<br>А вот &quot;movzx ax, word ptr [var1]&quot; и недолжно работать <img src="img/smilies/s1.gif" alt="">.
<br>Короче, пример для DOS:
<br><img src="img/attach.gif" alt=""> <a href="./files/19cb_dsex.asm.zip">19cb_dsex.asm.zip</a>
<br>
<br><I>Spitfire пишет:
<br>И еще...
<br>50h push AX
<br>66:50h push EAX
<br>Это как? В 16-битном режиме вроде нет eax </I>
<br>Кто тебе такое сказал? 
<br>На 16-бинтой двойке – да, а на тройке уже есть E-регистры, так что мешает их использовать?
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=53675&amp;user=410&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=11" class="addthx" data-post="53675"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]arnix[/b]','')">arnix</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 210.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 февраля 2006 23:45 &middot; Поправил: arnix <br><script type="text/javascript">QU('arnix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=arnix" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>Bitfry пишет:
<br>Давай думать вместе. </I>
<br>
<br>Давай <img src="img/smilies/s1.gif" alt="">
<br>
<br><I>Bitfry пишет:
<br>Моё представление такое: твой первый пример это использование регистра ESP как указатель на область памяти и всё. </I>
<br>
<br>А стэк и есть область памяти, на который указывает регистр ESP.
<br>
<br><I>Bitfry пишет:
<br>Ты ведь не можешь использовать команды для работы со стеком, чтоб достать один байт? </I>
<br>
<br>Если ты имеешь ввиду push/pop, то да, не могу
<br>
<br><I>Bitfry пишет:
<br>Ещё раз повторю, стека нет без команд процессора для работы с ним. </I>
<br>
<br>Вот, я не согласен <img src="img/smilies/s1.gif" alt=""> Я могу написать программу на асме, которая не испоьзует команды push, pop, call, ret но прекрасно работает (вызывает системные функции и.т.д.). Конечно это будет не удобно и вместо одной команды я должен буду писАть несколько, но что важно - работа со стэком возможна без этих команд, Тойсть они (эти команды) просто удобное средство для работы с областью памяти, на которую указывает регистр ESP (хотя согласен, стэк можно так называть с некоторами оговорками). Меняем значение ESP, например так, mov esp, 400100, и можем испоьзоваьт эти &quot;удобные команды для работы со стэком&quot; для работы с памятью в области 400100:
<br>
<br>Вместа: (фасм)
<br>mov dword [400100],eax
<br>mov eax, dword [400200]
<br>
<br>Так:
<br>mov ebp,esp
<br>mov esp,400100+4 ; нужно иметь право тут писАть, иначе - exception
<br>push eax
<br>mov esp,400200
<br>pop eax
<br>mov esp,ebp
<br>
<br>Конечно наверно нет смысла так &quot;извращаться&quot; в реальной программе <img src="img/smilies/s1.gif" alt=""> (хотя может и иметь, если протектор пишешь <img src="img/smilies/s1.gif" alt="">)
<br>
<br><I>Bitfry пишет:
<br>Можно творить всё, что душе угодно с памятью и РОН, но если мы не придерживаемся правил работы со стеком, это просто область памяти и просто регистр общего назначения ESP. </I>
<br>
<br>Правила? Покажи где они написаны <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=53696&amp;user=26&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=12" class="addthx" data-post="53696"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 февраля 2006 08:51 <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Дальнейший спор не имеет смысла. Думаю ты всё давно сам понял. <img src="img/smilies/s2.gif" alt=""> Да, я согласен, всё можно рассматривать с разных сторон, всё двояко (минимум =).
<br><I>arnix пишет:
<br>Я могу написать программу на асме, которая не испоьзует команды push, pop, call, ret но прекрасно работает (вызывает системные функции и.т.д.) </I>
<br>...
<br><I>arnix пишет:
<br>Правила? Покажи где они написаны </I>
<br>Напиши такую программу, не используя те правила (кратность 32, рост от старшего адреса к младшему...).
<br>
<br>Если бы <b>совсем</b> не было команд работы со стеком, никакого стека не было бы. Даже уговор программистов использовать область памяти для передачи параметров оказался бы наверняка другим, и это был бы не стек. 
<br>Ну, отвлеките чуть-чуть голову от практики, подумайте абстрактно!
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=53715&amp;user=410&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=13" class="addthx" data-post="53715"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]al_begin[/b]','')">al_begin</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3613">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2006 18:03 <br><script type="text/javascript">QU('al_begin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=al_begin" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
...они сошлися: лёд и пламень...
<br>
<br>Выдержки из мануалов Intel (25366517.pdf, 25366617.pdf...)
<br>
<br>Words, doublewords, and quadwords do not need to be aligned in memory on natural boundaries. The natural boundaries for words, double words, and quadwords are even-numbered addresses, addresses evenly divisible by four, and addresses evenly divisible by eight, respectively. However, to improve the performance of programs, data structures (especially stacks) should be aligned on natural boundaries whenever possible. The reason for this is that the processor requires two memory accesses to make an unaligned memory access; aligned accesses require only one memory access. A word or doubleword operand that crosses a 4-byte boundary or a quadword operand that crosses an 8-byte boundary is considered unaligned and requires two
<br>separate memory bus cycles for access.
<br>
<br>Слова, двойные слова, и четверные слова не обязаны быть выровнены в памяти на естественных границах. Естественные границы для слов, двойных слов и четверных слов, если пронумеровать адреса, это адреса, равномерно делимые на четыре и адреса, равномерно делимые на восемь, соответственно. Однако, чтобы улучшить работу программ, структуры данных (особенно стеки) должны быть выровнены на естественных границах всякий раз, когда возможно. Причина для этого - то, что процессор требует два обращения к памяти, чтобы сделать невыровненный доступ к памяти; выровненный доступ требует только одного доступа к памяти. Слово или операнд двойного слова, который пересекает 4-байтовую границу или операнд четверного слова, который пересекает 8-байтовую границу, рассматриваются невыровненными и требуют двух отдельных циклов шины памяти для доступа.
<br>
<br>A program or operating system/executive can set up many stacks. For example, in multitasking systems, each task can be given its own stack. The number of stacks in a system is limited by the maximum number of segments and the available physical memory. 
<br>When a system sets up many stacks, only one stack—the current stack—is available at a time. The current stack is the one contained in the segment referenced by the SS register.
<br>
<br>Программа или операционная система / исполнитель могут устанавливать много стеков. Например, в многозадачных системах, каждой задаче можно давать ее собственный стек. Количество стеков в системе ограничено максимальным количеством  сегментов и доступной физической памятью. 
<br>Когда система устанавливает много стеков, только один стек - текущий стек - является доступным единовременно. Текущий стек - содержащийся в сегменте, упомянутом регистром SS.
<br>
<br>To set a stack and establish it as the current stack, the program or operating system/executive
<br>must do the following:
<br>1. Establish a stack segment.
<br>2. Load the segment selector for the stack segment into the SS register using a MOV, POP, or
<br>LSS instruction.
<br>3. Load the stack pointer for the stack into the ESP register using a MOV, POP, or LSS
<br>instruction. The LSS instruction can be used to load the SS and ESP registers in one
<br>operation.
<br>
<br>Чтобы установить стек и установить его как текущий стек, программа или операционная система / исполнитель /должны делать следующее:
<br>1. Установить сегмент стека.
<br>2. Загрузить селектор сегмента в регистр SS, используя MOV, POP, или команду LSS.
<br>3. Загрузить указатель стека в регистр ESP, используя MOV, POP или команду LSS. Команда LSS может использоваться, чтобы загрузить SS и регистр ESP за одну операцию.
<br>
<br>The processor does not check stack pointer alignment. It is the responsibility of the programs...
<br>Процессор не проверяет выравнивание указателя стека. Это - ответственность программ...
<br>
<br>перевод мой так, что за ошибки не пинайте.
<br>
<br>Выходит,  все что сказал <I>arnix</I>, неопровержимо...
<br>
<br>Но я соглашусь с <I>Bitfry</I>, потому что он модератор, а заодно всех призываю пожаловаться на Солодовникова в Intel, за то что он, гад, использует стек не по правилам, мало того, что не выравнивает, но еще и выполняет в нем код и даже модифицирует его. Так что втолкнем ему 1 байт в <img src="img/smilies/s16.gif" alt="">...
<br>
<br>PS. простите за флейм, настроение праздничное...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=54993&amp;user=3613&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=14" class="addthx" data-post="54993"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2006 07:19 <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>al_begin пишет:
<br>Выходит, все что сказал arnix, неопровержимо...  </I>
<br>Пожалуй, я почти соглашусь. <img src="img/smilies/s15.gif" alt="">
<br>
<br><I>al_begin пишет:
<br>Но я соглашусь с Bitfry, потому что он модератор</I>
<br><img src="img/smilies/s5.gif" alt=""> Плюсик автору в уме <img src="img/smilies/s6.gif" alt="">
<br>
<br><I>al_begin пишет:
<br>а заодно всех призываю пожаловаться на Солодовникова в Intel, за то что он, гад, использует стек не по правилам, мало того, что не выравнивает, но еще и выполняет в нем код и даже модифицирует его</I>
<br>
<br>Хм... Видимо всё-таки я не ясно выразил своё мнение.
<br>ИМХО стек и правила его использования неразделимы. 
<br>Если мы изгиляемся над областью памяти под ESP, то это уже не работа со стеком. Тут вопрос динамики восприятия. В один момент это данные, в другой – код, с одной точки зрения это стек, с другой – переменная.
<br>Мне кажется, если в голове представлять, что всё творящееся под ESP – это только работа со стеком, будет слишком сложно переваривать происходящее в запротекченых участках.
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=55049&amp;user=410&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=15" class="addthx" data-post="55049"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]al_begin[/b]','')">al_begin</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.46'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3613">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 февраля 2006 12:08 <br><script type="text/javascript">QU('al_begin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=al_begin" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>Bitfry пишет:
<br>...будет слишком сложно переваривать происходящее... </I>
<br>А никто и не говорил, что в сказку попадем...
<br>
<br>Воспользовавшись индульгенцией <I> ...Плюсик ... в уме... </I>, буду &quot;добивать (ся признания правоты <I>arnix</I>-а)&quot;... 
<br>
<br><I>Bitfry пишет:
<br>...Вообще благодаря чего существует стек? 
<br>Ответ: исключительно благодаря нескольких команд процессора (push, pushad, pop, popad, call, ret... Может чего забыл). 
<br>Ведь не было бы этих команд и стек &quot;перестал бы существовать&quot;...
<br>Согласен? </I>
<br>
<br>НЕТ!
<br>
<br>Здесь классическая подмена курицы и яйца:
<br>
<br>Именно благодаря идее СТЕКА, родившейся в умах программистов-теоретиков и появились вышеназванные команды процессора, реализованные инженерами, но никак не наоборот. И появились с целью облегчить написание программ (ну и уменьшить затраты времени на их выполнение), использующих методики СТЕКА.
<br>Причем, если вспомнить историю, СТЕК использовался, в основном как временное хранилище регистров и адресов возврата из подпрограмм, и уже затем стал использоваться как область передачи локальных переменных для т.н. &quot;высокоуровневых языков программирования&quot;. В качестве доказательства: о чем говорит введение в состав набора инструкций процессоров x86 команд ENTER и LEAVE, SYSENTER и SYSEXIT, а в 64-битных еще и SYSCALL и SYSRET. О том, что именно инженеры идут на поводу у програмистов и добавляют новые команды по разработанным последними методикам программирования. Вы же предлагаете пойти на поводу у инженеров, используя &quot;правила&quot;, навязанные ими на данном технологическом этапе. ИМХО на этом развитие может остановится и мы получим &quot;хороших и правильных программистов&quot;, которые будут использовать так горячо любимый многими китайскими программистами в составе команды Microsoft метод &quot;Copy - Paste&quot;,  благо оперативная память сейчас дешевеет...
<br>ИМХО только нетривиально мыслящий реверсер может добиться результатов в крэкинге...
<br>
<br>Вообще этот топик ушел не в тему: вопрос был как в стек втолкнуть байт, а не нахрена ему это нужно... ответ, даже с исходниками он уже получил, поэтому приношу извинения за невольно нанесенные обиды и во избежание дальнейшего флейма предлагаю топик закрыть (да простит меня Вспыльчивый Челевек - <I> Spitfire</I> ...)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=55318&amp;user=3613&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=16" class="addthx" data-post="55318"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2006 09:23 &middot; Поправил: Bitfry <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>al_begin</b>
<br>Мысли здоровые и я полностью согласен. Убедил.
<br>
<br><I>al_begin пишет:
<br>поэтому приношу извинения за невольно нанесенные обиды и во избежание дальнейшего флейма предлагаю топик закрыть </I>
<br>Да ну брось ты! Я здесь вообще вот из-за таких тем и обитаю, а их, кстати, не так уж много.
<br>
<br><b>arnix</b>
<br>Извини, беру свои слова обратно, ты прав: можно воспринимать твой первый пример как работу со стеком, если уточнить, что это широкое практическое понимание стека.
<br>
<br>Итак, делаю выводы.
<br>1.	Стек родился в умах теоретиков как промежуточное хранилище изначально неопределённого количества значений.
<br>2.	Практики сформулировали основное правило &quot;первым вошел – последним вышел&quot;.
<br>3.	Инженеры Intel &quot;заковали&quot; стек регистрами SS:ESP и оптимизацией команд (для собственных нужд).
<br>4.	Программисты из MicroSoft (для собственных нужд) довели работу со стеком до того, о чём я писал выше (32 бита иначе – кирдык).
<br>
<br>Каждый волен для себя выбирать, на каком из уровней он будет &quot;жить&quot;. Но нужно учитывать, что более ранний уровень не имеет преимуществ следующих за ним.
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=55824&amp;user=410&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=17" class="addthx" data-post="55824"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]SeDoYHg[/b]','')">SeDoYHg</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 79.6 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17">Участник</a><br><font color=blue>алХимик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2006 10:54 <br><script type="text/javascript">QU('SeDoYHg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeDoYHg" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Bitfry
<br>
<br>Ты меня пугаешь...  Свои ложные мысли выдаешь за неприложную истину, и еще на других товарищей наезжаешь, которые верные ответы дают.  Если ты чего-то не знаешь, это не значит, что этого не сущесвует.  Регистры ESP и  EBP всегда использовались для произвольно (в широком смысле этого слова) доступа с стеку, причем не потому, что так придумали древние хэкеры, а потому что это заложено в архитектуре. 
<br>
<br><I>Bitfry пишет:
<br>В Win32 по умолчанию это будет dword. </I>
<br>
<br>Причем тут Виндовз? Какой укажешь такой и будет ассемблировать, это зависит от настроек асемблера (use16 или use32). Правда смысла в 16-битном коде в работе с Виндовз нет, как и в другой аналогичной ОСи, но это другой разговор. 
<br>
<br>ЗЫ может последняя фраза немного кривая, но думаю смысл понятен.
<br><br><font size="1"><i>-----<br>Все говорят что мы вместе. Но не многие знают в каком.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=55830&amp;user=17&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=18" class="addthx" data-post="55830"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2006 06:43 <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>SeDoYHg пишет:
<br>Ты меня пугаешь... </I>
<br>Не бойся, я просто учусь чуть медленней чем думал <img src="img/smilies/s15.gif" alt="">... И потом я же признал свою ошибку.
<br>
<br><I>SeDoYHg пишет:
<br>может последняя фраза немного кривая, но думаю смысл понятен. </I>
<br>В том то и дело, хочется написать как можно доходчивей, а от этого получаются ошибки.
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=55930&amp;user=410&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=19" class="addthx" data-post="55930"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]SeDoYHg[/b]','')">SeDoYHg</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 79.6 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17">Участник</a><br><font color=blue>алХимик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2006 08:18 <br><script type="text/javascript">QU('SeDoYHg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeDoYHg" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=3939.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>Bitfry пишет:
<br>Не бойся, я просто учусь чуть медленней чем думал </I>
<br>
<br>Это свойственно людям за 20 8), я такой же пень =)). Главное не уподабляться товарищу Крысу, нахватавшись по верхам, писать книги.
<br>
<br> <I>Bitfry пишет:
<br> хочется написать как можно доходчивей </I>
<br>Я бы сказал, ты стараешься делать обощения - это тебя и подводит.
<br>
<br>ЗЫ
<br><br><font size="1"><i>-----<br>Все говорят что мы вместе. Но не многие знают в каком.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=55938&amp;user=17&amp;forum_n=5&amp;topic=3939.html&amp;page=0&amp;anchor=20" class="addthx" data-post="55938"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как в стек втолкнуть 1 байт?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#21" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="3939">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=3939" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
