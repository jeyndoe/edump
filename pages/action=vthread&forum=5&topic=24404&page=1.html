<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Тулза для изменения строк в PE-файлах - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Приветствую. Мне потребовалось написать тулзу, которая будет изменять указанную пользователем строку в PE-файлах (.exe, .dll). Казалось бы, что может быть проще -- берём любой hex-редактор по вкусу, находим необходимую строку и">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Тулза для изменения строк в PE-файлах</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=5&amp;topic=24404&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=5&amp;topic=24404&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2016 12:48 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Приветствую.<br><br>Мне потребовалось написать тулзу, которая будет изменять указанную пользователем строку в PE-файлах (.exe, .dll).<br><br>Казалось бы, что может быть проще -- берём любой hex-редактор по вкусу, находим необходимую строку и лёгким движением руки видоизменяем её так, как требуется.<br>Проблема заключается в том, что строку необходимо *дополнять*, а для этого нам уже вполне может не хватить отведённого под неё изначально размера (разумеется, имеется ввиду место между окончанием нашей строки и началом следующих данных).<br><br>В качестве подопытного я взял утилиту nslookup.exe из официального дистрибутива Windows 8 (на всякий случай прикрепил её к данному сообщению).<br>Для примера я решил &quot;дополнить&quot; строку &quot;Non-existent domain&quot;, выводяющуюся при попытке resolve&#039;а несуществующего домена:<br><br>Default Server:  UnKnown<br>Address:  192.168.1.1<br><br>&gt; test<br>Server:  UnKnown<br>Address:  192.168.1.1<br><br>*** UnKnown can&#039;t find test: Non-existent domain<br><br>Открываем XVI32, ищем строку, находим её по &quot;физическому&quot; адресу 0x1A48 (это, вроде, raw address называется, поправьте меня, если я не прав). Здорово, значит, она действительно хранится в самом PE-файле, а не во внешних файлах ресурсов.<br><br>Вопроса два:<br>- Что делать дальше? Можно, наверное, найти все ссылки на эту строку и заменить их на другой адрес, по которому мы расположим &quot;увеличенную&quot; версию данной строки (заранее пробежавшись по PE-файлу и обнаружив незанятое место в виде NOP&#039;ов или 0x00). Вот только как искать эти ссылки?<br>- Почему указанная мной строка, если верить выхлопу PE Tools, хранится в секции .data? Она очень похожа на константную строку, почему же она тогда находится не в .rdata?<br><br>Может, есть готовое решение для подобной задачи, кстати?<br><br>Заранее благодарю.<br><br><img src="img/attach.gif" alt=""> <a href="./files/1c12_01.11.2016_EXELAB.rU.tgz">1c12_01.11.2016_EXELAB.rU.tgz</a> - nslookup.exe
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369087&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=1" class="addthx" data-post="369087"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 05:42 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
<b>neshta</b><br><br>На счёт хрома да, удивительно как легитимное приложение может использовать дельтаоффсеты.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=369133&amp;user=40990&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=2" class="addthx" data-post="369133"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]neshta[/b]','')">neshta</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.79'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41390">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 05:47 <br><script type="text/javascript">QU('neshta','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neshta" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<I>difexacaw пишет: На счёт хрома да, удивительно как легитимное приложение может использовать дельтаоффсеты </I><br><br>Студийный компиль такое выдает. В целом же, на приложении сложнее notepad особо нечего ловить, ибо уже толсто и без ручного управления ничего не сделать, собственно поэтому ida жива, невозможно автоматически отделить код от данных, все ветвления тоже автоматом не пробежать, крашить будет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369134&amp;user=41390&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=3" class="addthx" data-post="369134"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 05:51 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
<b>neshta</b><br><br>В общем так и есть, те же лимиты массивов сложно найти иногда не зная логику работы. Для заглушек вообще узнать что это код, а не данные не реал. Дельтасмещения это особый случай, если после загрузки ссылки есть не раскодируемое в статике ветвление, то любой анализер станет.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=369135&amp;user=40990&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=4" class="addthx" data-post="369135"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]neshta[/b]','')">neshta</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.79'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41390">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 05:57 <br><script type="text/javascript">QU('neshta','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neshta" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<I>difexacaw пишет: В общем так и есть, те же лимиты массивов сложно найти иногда не зная логику работы. Для заглушек вообще узнать что это код, а не данные не реал. Дельтасмещения это особый случай, если после загрузки ссылки есть не раскодируемое в статике ветвление, то любой анализер станет. </I><br><br>Причем сама архитектура камня с памятью не располагают к подобному анализу и стало быть фундаментальная проблема. <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369137&amp;user=41390&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=5" class="addthx" data-post="369137"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 06:00 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
<b>neshta</b><br><br>Архитектура позволяет исполнять, запретив чтение из сегмента. Тогда всё будет кодом в этом сегменте и имея все начала ветвей(входы) в принципе можно корректно выполнять анализ. Но это не совместимо с компиляторами и не используется.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=369138&amp;user=40990&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=6" class="addthx" data-post="369138"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]neshta[/b]','')">neshta</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.79'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41390">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 06:04 <br><script type="text/javascript">QU('neshta','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neshta" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<I>difexacaw пишет: Тогда всё будет кодом в этом сегменте и имея все начала ветвей(входы) в принципе можно корректно выполнять анализ. </I><br><br>указатели все равно останутся, а с ними и расстрел памяти. <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369139&amp;user=41390&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=7" class="addthx" data-post="369139"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 10:11 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Сказал ведь, если нет релока </I><br>Что-то я запутался...<br><br>Смотрите.<br>Допустим, у меня есть DLL. В ней есть строка &quot;foo&quot; (ASCIZ), находящаяся по file offset&#039;у 0x000C2A0C. Переведём file offset в VA и RVA при помощи CFF Explorer:<br><br><img src="http://i.imgur.com/1dum0HI.png" border="0" align="" alt=""><br><br>Теперь поищем ссылки на данную строку в секции .text. Находятся две (по коду примерно так и должно быть), и обе из них обращаются к &quot;foo&quot; по VA (т.е. с учётом preferred Image Base). Расположены эти обращения по RVA 0x000149BE и 0x00014B73.<br><br>Насколько я понимаю, если бы обращение к строке происходило по RVA, то никаких релоков не потребовалось бы (мы же не зависим от Image Base, указанного в Optional Header PE-файла).<br>Однако в случае с VA (по которым, судя по предыдущим ответам в топике, и будет в основном происходить обращение к данным из секций .data / .rdata в бинарнике) линковщик должен был упомянуть этот адрес в Relocations Table. Следовательно, в моём случае это будет практически всегда.<br><br>Вот только что именно линковщик должен поместить в Relocations Table? RVA, по которым находятся упоминания о VA? Т.е. в указанном мной примере 0x000149BE и 0x00014B73?<br><br>Читал <noindex><a href="https://msdn.microsoft.com/en-us/library/ms809762.aspx" rel="nofollow" target="_blank">статью</a></noindex> с описанием формата на MSDN, но там всё как-то очень пространно сказано было -- &quot;просто добавляет разницу между preferred Image Base и реальным Image Base к необходимым адресам&quot;.<br><br>Можете пояснить, пожалуйста?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369151&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=8" class="addthx" data-post="369151"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 10:56 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<b>b0r3d0m</b> если вы меняете строку.. одни данные на другие.. (желательно не меня размера строки) то вас виртуальный адрес волновать не должен, виртуальный адрес.. это чисто теоретически.. куда будет спроэцирована ДЛЛ после загрузки. но с виндой.. высше ХР.. эта хрень уже не актуальна. винда сама может засунуть вашу ДЛЛ куда пожелает. Поэтому... строку вы попробуйте менять.. и грузить длл, если будут креши, сравните ваш файл с оригиналом, может вы криво патчите. <br>ЗЫ. возможно вы еще столкнетесь с проблемой подписи файла, если будете патчить дрова или системные либы
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=369152&amp;user=17319&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=9" class="addthx" data-post="369152"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 11:12 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
<b>VodoleY</b>, менять размер строки, к сожалению, придётся, об этом я и говорил в первом сообщении.<br><br>Проблем с подписями конкретно в моём случае быть не должно, т.к. будет патчиться только определённый набор софта, находящийся под моим контролем. Но всё равно спасибо, что указали на этот момент.<br><br>==============================<br><br>Мне вот что интересно. Что именно содержится в Relocations Table? RVA тех мест, где происходит обращение к тем или иным VA? Если так, то здорово -- получается, мне в любом случае трогать эту таблицу не придётся. Я ведь меняю лишь адрес, по которому находится обновлённая строка, а не расположение самого кода, который с этим адресом работает. Я прав?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369153&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=10" class="addthx" data-post="369153"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 18:31 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
<b>b0r3d0m</b><br><br>&gt; RVA тех мест, где происходит обращение к тем или иным VA?<br><br>Нет. Фиксап корректирует ссылку. Ссылка может быть как в данных, так и в самом коде, инструкция может содержать в себе ссылку. Из за релокации модуля эти ссылки необходимо скорректировать. Загрузчик парсит таблицу релокаций и фиксит ссылки, вне зависимости от того, в коде они или в данных. В релоках описаны только смещения ссылок(RVA).<br>По формату релоков - он прост, но там используется небольшая оптимизация - обьеденение в блоки етц, что в общем не существенно.<br><br><b>Добавлено спустя 2 минуты</b><br><b>VodoleY</b><br><br>&gt; (желательно не меня размера строки) то вас виртуальный адрес волновать не должен<br><br>Перечитайте задачу, блок расширяется, перетерая данные за ним соотвественно.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=369167&amp;user=40990&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=11" class="addthx" data-post="369167"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 18:36 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Ссылка может быть как в данных, так и в самом коде </I><br>Это понятно.<br><br><I>difexacaw пишет:<br>Из за релокации модуля эти ссылки необходимо скорректировать </I><br>Это тоже понятно. Для этого, собственно, Relocations Table и была придумана.<br><br><I>difexacaw пишет:<br>Загрузчик парсит таблицу релокаций и фиксит ссылки, вне зависимости от того, в коде они или в данных </I><br>Это тоже понятно, ему-то пофигу, где они находятся.<br><br><I>difexacaw пишет:<br>В релоках описаны только смещения ссылок(RVA) </I><br>Вот, на этот вопрос я и искал ответ. Вот <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#8" rel="nofollow" target="_blank">здесь</a></noindex>, получается, я правильно пример расписал, да?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369168&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=12" class="addthx" data-post="369168"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 19:13 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<b>b0r3d0m</b><br><br>Обычно я отвечаю всегда, но как то тот ваш вопрос пропустил.<br><br>На сколько понимаю вы запутались в VA vs RVA. VA это реальная для железа(процессора) величина, с ними он работает. RVA же не имеет никакого отношения к VA. RVA это смещение в проекции от начала. Соответственно расположение какой то части модуля постоянно относительно его начала, это и есть RVA. Реальный адрес формируется элементарно как VA начала модуля и смещение - RVA.<br>Есть есчо файловое смещение, оно существует для загрузчика, так как физически память гранулярна(страничная), то нельзя выполнить аллокацию памяти произвольного размера. Соответственно если две секции имеют разные права доступа(два региона в памяти), но коррелируют с физическим размером минимального региона, то единственное решение - выделить для каждого региона свой физический блок(страницу). Но из за выравнивания будет бесполезно использоваться память(утекать) в таком случае. Таким образом в модуле храняться секции с исходным размером, при отображении в память модуля секции выравниваются на гранулярность памяти. Файловое смещение отображается на RVA с учтом гранулярности.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=369169&amp;user=40990&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=13" class="addthx" data-post="369169"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 19:20 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
<I>difexacaw пишет:<br>На сколько понимаю вы запутались в VA vs RVA </I><br>Да нет, вроде не запутался <img src="img/smilies/s1.gif" alt=""><br>Вы, возможно, неправильно поняли мой вопрос.<br><br>Если совсем коротко.<br><br>Предположим, у нас есть PE-файл со строкой &quot;foo&quot;, хранящейся в секции .data по RVA == 0xAABBCCDD.<br><br>В секции .text имеется обращение к данной строке, которое находится по RVA == 0x11223344.<br><br>Что в таком случае будет храниться в Relocations Table? 0x11223344 без упоминания об адресе самой строки (0xAABBCCDD), верно?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369170&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=14" class="addthx" data-post="369170"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 19:29 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
<b>b0r3d0m</b><br><br>Обращение к строке&quot; это вы имеете ввиду ссылку. Тоесть адрес строки расположен по адресу 0x11223344. Фиксап же для этой ссылки будет содержать её RVA = 0x11223344 - ImageBase.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=369171&amp;user=40990&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=15" class="addthx" data-post="369171"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=37421" title="02-11-2016 16:58, ранг:9.3" target="_blank">b0r3d0m</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 19:58 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Обращение к строке&quot; это вы имеете ввиду ссылку </I><br>Да. &quot;Ссылка&quot; просто как-то слишком абстрактно звучит <img src="img/smilies/s1.gif" alt=""><br><br><I>difexacaw пишет:<br>Тоесть адрес строки расположен по адресу 0x11223344 </I><br>Да.<br><br><I>difexacaw пишет:<br>Фиксап же для этой ссылки будет содержать её RVA = 0x11223344 - ImageBase </I><br>Спасибо, понял.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369172&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=16" class="addthx" data-post="369172"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 20:12 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>Что в таком случае будет храниться в Relocations Table? 0x11223344 без упоминания об адресе самой строки (0xAABBCCDD), верно?<br> </I><br>Да. Но нет.<br>Каждый  элемент таблицы имеет размер 16-бит. Что они означают, надо посмотреть в документации - в вашем  же случае лучше не заморачиваться, а считать, что адрес адреса строки будет найден и значение по этому адресу адреса строки будет скорректировано системой в соответствии с новым базовым адресом модуля.<br><br><br><I>.......................................................................................................<br>Предположим, у нас есть PE-файл со строкой &quot;foo&quot;, хранящейся в секции .data по RVA == 0xAABBCCDD.<br>В секции .text имеется обращение к данной строке, которое находится по RVA == 0x11223344.<br>.......................................................................................................... </I><br><I>difexacaw пишет:<br>Фиксап же для этой ссылки будет содержать её RVA = 0x11223344 - ImageBase.<br> </I><br>Напиши, пожалуйста, что такое VA, а что такое RVA.<br>И какая между ними связь.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369175&amp;user=35473&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=17" class="addthx" data-post="369175"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=37421" title="02-11-2016 19:55, ранг:9.5" target="_blank">b0r3d0m</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2016 22:55 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
<I>dosprog пишет:<br>Каждый элемент таблицы имеет размер 16-бит </I><br>Спасибо, не знал.<br>Действительно, конечный адрес, по которому необходимо будет сделать релок, вычисляется из двух 16-битных значений (если быть более точным, то из одного 16-битного значения и 14 младших бит другого).<br><br><I>dosprog пишет:<br>Что они означают, надо посмотреть в документации </I><br>Уже посмотрел и поэкспериментировал на минимальном примере. Ещё раз спасибо.<br><br><I>dosprog пишет:<br>Напиши, пожалуйста, что такое VA, а что такое RVA </I><br>Я так и не понял, это мне вопрос или всё же <b>difexacaw</b>?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369186&amp;user=37421&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=18" class="addthx" data-post="369186"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 ноября 2016 01:12 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
<b>dosprog</b><br><br>&gt; Напиши, пожалуйста, что такое VA, а что такое RVA.<br><br>Я же уже обьяснил понятно. А формат таблиц - не существенная деталь, тс с ним сам разобрался. Нужно было понимать что указатель в памяти есть ссылка, так же я говорил что используется оптимизация таблиц.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=369188&amp;user=40990&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=19" class="addthx" data-post="369188"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 ноября 2016 07:29 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24404&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>Я так и не понял, это мне вопрос или всё же difexacaw?<br> </I><br>) Не тебе. <br>) Тот чуваг пишит удевитильные вещи. А в перерывах обзывает собеседников хуесосами.<br><br>Так пускай объяснит свою очередную хню.<br><br><b>--Добавлено--</b><br> )) Ну во. Объяснил. А ты говоришь - RelocationTable. Куда там нахер.. <br>(см. как колбасит чувака, следующий пост, - пока не потёрли).<br><br><b>--Добавлено--</b><br>Эхх, потёрли..<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369192&amp;user=35473&amp;forum_n=5&amp;topic=24404&amp;page=1&amp;anchor=20" class="addthx" data-post="369192"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=5&amp;topic=24404&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=5&amp;topic=24404&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Тулза для изменения строк в PE-файлах</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#21" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="24404">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24404" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
