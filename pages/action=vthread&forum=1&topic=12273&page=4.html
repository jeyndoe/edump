<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Антиотладочные приемы - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="На днях откопал свою писульку про антиотладку. В свое время собирал всякий материал, в основном английский, переводил и собирал во одну доку. Вот решил выложить, чтобы попинали. Может кому-то из чайников вроде меня пригодится.">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Антиотладочные приемы</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=1&amp;topic=12273&amp;page=3.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=1&amp;topic=12273&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=1&amp;topic=12273&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=1&amp;topic=12273&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=1&amp;topic=12273&amp;page=3.html">4</a> . <b>5</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Sturgeon[/b]','')">Sturgeon</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 105.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.56'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3305">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июля 2008 12:07 &middot; Поправил: Sturgeon <br><script type="text/javascript">QU('Sturgeon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sturgeon" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#1');return false;">#1</a> </span><div align=left><br>
На днях откопал свою писульку про антиотладку. В свое время собирал всякий материал, в основном английский, переводил и собирал во одну доку. Вот решил выложить, чтобы попинали.<br>Может кому-то из чайников вроде меня пригодится. Хотя, конечно, хочется, чтобы кто-то из опытных реверсеров посмотрел и указал на ошибки, неточности перевода и т.д.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=194804&amp;user=3305&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=1" class="addthx" data-post="194804"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 января 2009 01:16 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#2');return false;">#2</a> </span><div align=left><br>
<b>progopis</b>, чо-то я не прохавал где тут антиотладка?<br><br>Антиотладка это если бы они два раза замерили, вычли и получили число неравное 0. А у тебя тут цикл, до тех пор пока не пройдет одна милисекунда.
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=216082&amp;user=10168&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=2" class="addthx" data-post="216082"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 января 2009 01:31 &middot; Поправил: progopis <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#3');return false;">#3</a> </span><div align=left><br>
Если ты не понял в чём антиотладка объясню. Когда нет отладчика пройдёт, как ты верно заметил, одна миллисекунда и код пойдёт выполняться дальше. Когда он есть И (!!!) стоит анти-антиотладочный плагин типа HideDebugger.dll (прикрученный к IDA через Stealth), значение всегда будет 0 - получаем бесконечный цикл. Да, я согласен, если бы не было Stealth&#039;а - то всё было бы ок. Но тогда отладчик легко спалить другими методами антиотладки. <i class=x>И тут меня осенило и я выключил флаг GetTickCount в IDA Stealth - теперь всё ок</i>. А код который там был могу запостить здесь, чтобы разработчик защиты понял, что за него уже взялись <img src="img/smilies/s6.gif" alt=""> :<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">_Rex_UNPK_dll<span class="hl_char">:</span><span class="hl_number">009A1C7D</span>&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_0_9AE104<span class="hl_char">,</span>&nbsp;0</li><li class="hl_l1">_Rex_UNPK_dll<span class="hl_char">:</span><span class="hl_number">009A1C84</span>&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_50<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;edx</li><li class="hl_l0">_Rex_UNPK_dll<span class="hl_char">:</span><span class="hl_number">009A1C87</span>&nbsp;&nbsp;<span class="hl_function"><b>jnz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_0_9A1CA0</li><li class="hl_l1">_Rex_UNPK_dll<span class="hl_char">:</span><span class="hl_number">009A1C89</span>&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;loc_0_9ADB62</li><li class="hl_l0">_Rex_UNPK_dll<span class="hl_char">:</span><span class="hl_number">009A1C8E</span>&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_0_9AE104<span class="hl_char">,</span>&nbsp;eax</li><li class="hl_l1">_Rex_UNPK_dll<span class="hl_char">:</span>009A1C93</li><li class="hl_l0">_Rex_UNPK_dll<span class="hl_char">:</span><span class="hl_number">009A1C93</span>&nbsp;&nbsp;loc_0_9A1C93<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: sub_0_9A1C50+4Ej</span></li><li class="hl_l1">_Rex_UNPK_dll<span class="hl_char">:</span><span class="hl_number">009A1C93</span>&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;loc_0_9ADB62</li><li class="hl_l0">_Rex_UNPK_dll<span class="hl_char">:</span><span class="hl_number">009A1C98</span>&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_0_9AE104</li><li class="hl_l1">_Rex_UNPK_dll<span class="hl_char">:</span><span class="hl_number">009A1C9E</span>&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_0_9A1C93</li><li class="hl_l0">_Rex_UNPK_dll<span class="hl_char">:</span>009A1CA0</li>        </ol>
    </div>
</div></div>
<br>P.S. Мораль: с  учётом всего выше сказанного, можно с уверенностью сказать, что защиту писал крекер.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=216083&amp;user=2449&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=3" class="addthx" data-post="216083"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 января 2009 01:39 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#4');return false;">#4</a> </span><div align=left><br>
А мы тут телепаты...
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=216084&amp;user=10168&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=4" class="addthx" data-post="216084"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 января 2009 01:50 &middot; Поправил: progopis <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#5');return false;">#5</a> </span><div align=left><br>
<I>Hexxx пишет:<br>А мы тут телепаты... </I><br><br>Этот jnz (0x9A1C87) на сказанное мной в правленном выше посте не влияет.<br><br>P.S. Если твоя логика не привела тебя к моему выводу, то это проблема не телепатии, а твоя личная. Я это говорю без агрессии, не пытаюсь тебя обидеть. Но, тем не менее, ты не прав.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=216085&amp;user=2449&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=5" class="addthx" data-post="216085"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]vnekrilov[/b]','')">vnekrilov</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 329.6 (мудрец), 192thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.08'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=5173">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 января 2009 09:24 <br><script type="text/javascript">QU('vnekrilov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vnekrilov" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#6');return false;">#6</a> </span><div align=left><br>
На сайте www.tuts4you.com/request.php?2544 появилась первая часть статьи  Peter Ferrie &quot;Anti-Unpacker Tricks 2 - Part 1&quot;. Желающие могут скачать и ознакомиться с нею.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=216106&amp;user=5173&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=6" class="addthx" data-post="216106"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 января 2009 10:33 &middot; Поправил: progopis <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#7');return false;">#7</a> </span><div align=left><br>
<b>vnekrilov</b><br>Спасибо за материал. Забавно, про MeltICE уже молчат. Вроде как и не метод уже. Зато &quot;MeltICE для Syser&quot; есть. Код для поимки трассировки особенно порадовал, не стандартно. Хотя на сколько я знаю для Syser&#039;а пофиг на эти методы - он единственный известный мне отладчик (не считая эмулирующих) который не боится флаг трассировки.<br><br>Статья интересная, но особо нового в ней пока не было. Будем ждать следующие части.<br><br>Вообще есть вопрос: кто-нибудь делал сравнительную таблицу по обнаружению отладчиков различными методами? У меня такая таблица есть, но сделана она с помощью проекта AntiSoftICE, который не обладает достаточным кол-вом приёмов обнаружения. Как SoftICE не палится при проходе call XXXXXX при трассировке до сих пор не понял.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=216111&amp;user=2449&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=7" class="addthx" data-post="216111"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 января 2009 17:34 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#8');return false;">#8</a> </span><div align=left><br>
<I>progopis пишет:<br>P.S. Если твоя логика не привела тебя к моему выводу, то это проблема не телепатии, а твоя личная. Я это говорю без агрессии, не пытаюсь тебя обидеть. Но, тем не менее, ты не прав. </I><br><br>Проблема телепатии в том что человек постит маленький кусок кода, а подразумевает больший. Я это говорю без агрессии, не пытаюсь тебя обидеть. Но, тем не менее, ты не прав. :-P
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=216354&amp;user=10168&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=8" class="addthx" data-post="216354"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 января 2009 17:52 <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#9');return false;">#9</a> </span><div align=left><br>
<I>Hexxx пишет:<br>бесконечный цикл длиной 1 милисекунда.</I><br><br>Ты меня за идиота держишь?<br><br><I>Hexxx пишет:<br>человек постит маленький кусок кода, а подразумевает больший</I><br>Прочитай мой пост внима-а-ательно! Я ничего не подразумевал. В следующий раз специально для тебя отпущу всю программу, ок?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=216357&amp;user=2449&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=9" class="addthx" data-post="216357"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 января 2009 17:53 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#10');return false;">#10</a> </span><div align=left><br>
<I>progopis пишет:<br>с учётом всего выше сказанного, можно с уверенностью сказать, что защиту писал крекер. Возможно кто-нибудь вроде AHTeam. </I><br><img src="img/smilies/s1.gif" alt=""> ткни пальцем в любой прот котрый запускется на одной из десяти машин типа NSEProtect, LARP и т.д ..<br>и  можно с уверенностью сказать, что защиту писал крекер, бездумно нафаршировав антиотладкой
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=216358&amp;user=293&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=10" class="addthx" data-post="216358"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 января 2009 17:56 <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#11');return false;">#11</a> </span><div align=left><br>
<b>pavka</b><br>Да это вообще был странный код, поэтому была такая фраза. Я сначала думал, что защиту писали для этой проги отдельно. Оказалось, что это код Refox XI+.<br><br>Обратите внимание на _Rex_UNPK_dll - видимо Refox Unpacker...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=216359&amp;user=2449&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=11" class="addthx" data-post="216359"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 января 2009 23:45 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#12');return false;">#12</a> </span><div align=left><br>
<b>pavka</b><br>LARP вроде бы без проблем запускается. Антидебаг злой, конечно, но про бездумность Лены слышу впервые.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=216419&amp;user=6336&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=12" class="addthx" data-post="216419"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]vnekrilov[/b]','')">vnekrilov</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 329.6 (мудрец), 192thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.08'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=5173">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 января 2009 06:45 &middot; Поправил: vnekrilov <br><script type="text/javascript">QU('vnekrilov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vnekrilov" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#13');return false;">#13</a> </span><div align=left><br>
Я что-то не нашел топика по Java, а также не имея желания создавать новый топик, решил выложить информацию на этом топике. По ссылке http://ricardonarvaja.info/WEB/CURSO%20NUEVO/TEORIAS%20NUMERADAS/1001-   1100/1089-Covert_Java_-_Techniques_For_Decompiling__Patching__And_Reve rse_Engineering__2004_.pdf.7z <span style="word-break: break-all">http://ricardonarvaja.info/WEB/CURSO%20NUEVO/TEORIAS%20NUMERADAS/1001-1100/1089-Covert_Java_-_Techniques_For_Decompiling__Patching__And_Reverse_Engineering__2004_.pdf.7z</span>  можно скачать прекрасную книгу Алекса Калиновски &quot;Covert Java: Techniques for Decompiling, Patching, and Reverse Engineering&quot; (на английском языке). Вдруг кому-то понадобится эта информация.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=216621&amp;user=5173&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=13" class="addthx" data-post="216621"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 января 2009 13:59 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#14');return false;">#14</a> </span><div align=left><br>
bbs.cracktool.com/viewthread.php?tid=31681&amp;extra=page%3D1<br>shoooo the anti-od1.1 analysis (also posted a profit here, ha ha UB) <br>I would like to talk about my understanding of the process of it (I was a big rookie, a master joke Mo dual ah): <br>OD loading anti-od1.1, results not to the point of entry OD was FUCK, the guess is the question of importation of table. <br>Loadpe Canal opened, the importation of Table View, point L to see the back of a lot of Ntdll line (excited). <br>Name: 0x000040A8 ( &quot;ntdll <br><br>Point H Open 40A8 Department to look at the back a lot of 0D0A, 0D0A is a carriage return line meant to lead a lot of 00 after the end of 0D0A. Here I thought it was a simple system to recognize the 0D0A, OD did not know the cause of the error. Then put aside. It was issued today to see the analysis of the post, given the results of shoooo solutions that only the symptoms, here I thought I had the wrong idea. <br>Guess it does not appear alone do not work. <br><br>loadpe open again, I 0D0A changed the whole 3333 is ntdl333333333333. . . The results of running the same program, it appears that the input table entry system useless when filled with IAT, the obvious in the input table, the system did not how to fill it? Had no choice but to point Ntdll the importation of table entry carefully read, point H from OriginalFirstThunk, FirstThunk order to see. Finally found the problem FirstThunk, as long as FirstThunk Department (anti-od1.1ntdll is 409C) the value of value is 0, this table entry is not filled. I 409C Department arbitrarily changed the value of value of non-0, Ai Iijima not up on the run (unless ntdll, ZwSetInformationProcess into the end of 00). I also tried the values behind Kernel32.dllFirstThunk value, as long as the first not to 0, normally filled. <br>Here the problem of uncertainty, shoooo use FirstThunk construct a useless form of input, as long as the value of Office FirstThunk value to 0, the input form of the name and function can be obtained, when the system is running anyway, no matter. But our OD on the point of death, it will read the names from this chaos, if the malicious structure names, the consequences are very serious. <br><br>OK, we do under our OD patch it first FirstThunk Department to determine the value to 0 on no matter the time of the next table. <br><br>Wordy for a long time, huh, huh. A copy of OD, with the goal open OD copy OD process, F9, object program loading antiod, <br>004A4EE5 3A5B 17 cmp bl, byte ptr ds: [ebx +17] Department has gone wrong under the Department 4A4ED8 off reload procedures, once again loading antiod note abnormal off the last of the return value, 45DAED <br>Too long to see this function, I posted under the main code <br>0045D0E6&gt; / 6A 03 push 3 <br>0045D0E8. | 6A 14 push 14 <br>0045D0EA. | 8B45 CC mov eax, dword ptr [ebp-34] <br>0045D0ED. | 0345 BC add eax, dword ptr [ebp-44] <br>0045D0F0. | 0345 FC add eax, dword ptr [ebp-4] <br>0045D0F3. | 50 push eax <br>0045D0F4. | 8D95 30F9FFFF lea edx, dword ptr [ebp-6D0] <br>0045D0FA. | 52 push edx <br>0045D0FB. | E8 0C420000 call _Readmemory / / / / here to read a IMAGE_IMPORT_DESCRIPTOR <br>0045D100. | 83C4 10 add esp, 10 <br>0045D103. | 85C0 test eax, eax <br>0045D105. | 75 0C jnz short 0045D113 <br>0045D107. | C745 F4 02000&gt; mov dword ptr [ebp-C], 2 <br>0045D10E. | E9 1C050000 jmp 0045D62F <br>0045D113&gt; | 83BD 3CF9FFFF&gt; cmp dword ptr [ebp-6C4], 0 <br>0045D11A. | 0F84 0F050000 je 0045D62F <br>0045D120. | 6A 03 push 3 <br>0045D122. | 68 04020000 push 204 <br>0045D127. | 8B4D CC mov ecx, dword ptr [ebp-34] <br>0045D12A. | 038D 3CF9FFFF add ecx, dword ptr [ebp-6C4] <br>0045D130. | 51 push ecx / / / NameRVA <br>0045D131. | 8D85 78FDFFFF lea eax, dword ptr [ebp-288] <br>0045D137. | 50 push eax <br>0045D138. | E8 CF410000 call _Readmemory / / Reading Name of <br>0045D13D. | 83C4 10 add esp, 10 <br>0045D140. | 85C0 test eax, eax <br>0045D142. | 75 4E jnz short 0045D192 <br><br>We need to finish IMAGE_IMPORT_DESCRIPTOR also not read when the Name of the patch to determine FirstThunk <br>0045D11A Department patch on. I began looking for a piece of code segment 0 string, the result changed from preservation, depressing! I would add a section of their own VA: 1AA000 <br>45D11A Department changed <br>0045D11A .- E9 E1CE1400 jmp 005AA000 <br>0045D11F 90 nop <br>Department 5AA000 code to write: <br>005AA000 - 0F84 2936EBFF je 0045D62F <br>005AA006 60 pushad <br>005AA007 6A 00 push 0 <br>005AA009 6A 04 push 4 <br>005AA00B 8B4D CC mov ecx, dword ptr [ebp-34] <br>005AA00E 038D 40F9FFFF add ecx, dword ptr [ebp-6C0] <br>005AA014 68 50A05A00 push 005AA050 <br>005AA019 51 push ecx ///// FirstThunk value 409C <br>005AA01A A1 685A4D00 mov eax, dword ptr [4D5A68] <br>005AA01F 50 push eax <br>005AA020 E8 4951F0FF call &lt;jmp.&amp;KERNEL32.ReadProcessMemory&gt; <br>005AA025 A1 50A05A00 mov eax, dword ptr [5AA050] <br>005AA02A 85C0 test eax, eax <br>005AA02C 61 popad <br>005AA02D - 0F85 ED30EBFF jnz 0045D120 / / / not to 0 to continue the implementation of <br>005AA033 - E9 DC35EBFF jmp 0045D614 / / / to 0 to add size, have already read, read the next IMAGE_IMPORT_DESCRIPTOR <br>005AA038 90 nop <br><br>Then save it. Use this modified OllyICE.exe to try to open antiod No problem, something else to load the procedure did not make mistakes. <br><br><br>Halo how to commentary illegal ah? Summed up under this BUG: <br>System to load the process of filling IAT is: first to determine the IAT array FirstThunk point, if for not filling the empty structure, and then judge OriginalFirstThunk, there used OriginalFirstThunk point to calculate the address of INT filled FirstThunk point load time IAT.OD input table did not determine the first step, resulting in invalid time I enter the table attached to the revised OllyICE.exe
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=217124&amp;user=293&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=14" class="addthx" data-post="217124"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 января 2009 20:22 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#15');return false;">#15</a> </span><div align=left><br>
причину он понял правильно, но методом научного тыка, а ныдо было глянуть как ведёт себя загрузчик <img src="img/smilies/s1.gif" alt=""><br>и в патче можно лишний раз не дёргать ReadProcessMemory.<br><br>да, именно import bug.
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=217163&amp;user=72&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=15" class="addthx" data-post="217163"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 января 2009 20:50 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#16');return false;">#16</a> </span><div align=left><br>
Я правильно понял, эта таже бага что юзается в NoobyProtect SE 1.1.6.0 ?
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=217166&amp;user=2981&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=16" class="addthx" data-post="217166"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]dermatolog[/b]','')">dermatolog</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/1404.png" alt=""><br><span class=txtSm>Ранг: 116.6 (ветеран), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.36'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1404">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 января 2009 07:10 <br><script type="text/javascript">QU('dermatolog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dermatolog" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#17');return false;">#17</a> </span><div align=left><br>
<I>Flint пишет:<br>Я правильно понял, эта таже бага что юзается в NoobyProtect SE 1.1.6.0 ?  </I><br>Да. Багу опубликовал shoooo, а потом её кетайцы растащили по своим протекторам <img src="img/smilies/s1.gif" alt="">)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=217215&amp;user=1404&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=17" class="addthx" data-post="217215"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 января 2009 10:39 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#18');return false;">#18</a> </span><div align=left><br>
<b>dermatolog</b><br>Думаю, в недалёком будущем не только китайцы перенесут её на свои ВМпроты<img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=217223&amp;user=6336&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=18" class="addthx" data-post="217223"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 февраля 2009 04:48 &middot; Поправил: ClockMan <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#19');return false;">#19</a> </span><div align=left><br>
На тутси выложели новые статьи про антиотладку --&gt; Anti-Unpacking Tricks 2 - Part 2 &lt;-- http://www.tuts4you.com/download.php?view.2630
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=221332&amp;user=17432&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=19" class="addthx" data-post="221332"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 марта 2009 03:34 &middot; Поправил: Clerk <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12273&amp;page=4#20');return false;">#20</a> </span><div align=left><br>
Заметил интересную особенность. Если под олей освободить файловую проецию, то по возврату из сервиса взводится <b>TF</b>(по возврату в ядре из <b>NtUnmapViewOfSection</b> содержит <b>TRAP_FRAME</b> взведённый <b>TF</b>), вероятно при обработке нотификации о выгрузке модуля оля устанавливает <b>TF</b> в контексте потока, не смотрел, впрочем кому интересно тот расковыряет. Пример:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>invoke</b></span>&nbsp;LoadLibrary<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;DllName</li><li class="hl_l1"><span class="hl_function"><b>invoke</b></span>&nbsp;ZwUnmapViewOfSection<span class="hl_char">,</span>&nbsp;NtCurrentProcess<span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li>        </ol>
    </div>
</div></div>
<br>Модель вызова сервиса подчиняется определённым правилам, соответственно изза взведённого <b>TF</b> под отладчиком <b>Edx = -1</b>, не зависимо от трассировки.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=226040&amp;user=17964&amp;forum_n=1&amp;topic=12273&amp;page=4&amp;anchor=20" class="addthx" data-post="226040"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=1&amp;topic=12273&amp;page=3.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=1&amp;topic=12273&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=1&amp;topic=12273&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=1&amp;topic=12273&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=1&amp;topic=12273&amp;page=3.html">4</a> . <b>5</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Антиотладочные приемы</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#21" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="12273">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=12273" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
