<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>ASProtect ручная распаковка - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Драсте all, вот первая в жизни попытка ручками распаковать прогу: notepad.gridinsoft.com После прочитывания пачки tutorials делал вот что: 1) PiD говорит что это asprotect 1.23 2) Olly ловит кучу исключений, последнее из которых">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a> (+9 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> ASProtect ручная распаковка</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2005 06:49 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=3174.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Драсте all,
<br>
<br>вот первая в жизни попытка ручками распаковать прогу: notepad.gridinsoft.com После прочитывания пачки tutorials делал вот что:
<br>
<br>1) PiD говорит что это asprotect 1.23
<br>
<br>2) Olly ловит кучу исключений, последнее из которых на 0xDAA76A где видим вот что:
<br>
<br>00DAA76A mov  dword ptr ds:[eax],44D9AD1F
<br>00DAA770 mov  byte ptr ds:[10FDFEFA],al
<br>00DAA775 lods byte ptr ds:[esi]
<br>00DAA776 pop  dword ptr fs:[0]
<br>00DAA77C add  esp,4
<br>00DAA77F lea  eax,dword ptr ds:[ecx+edx*2+7]
<br>00DAA783 pop  eax
<br>00DAA784 mov  eax,dword ptr ds:[DB9804]
<br>00DAA789 mov  eax,dword ptr ds:[eax]
<br>00DAA78B mov  ebp,dword ptr ds:[eax+1C]
<br>..........................
<br>
<br>3) этот блок отличается от описаного во всех tutorials....
<br>4) поставил breakpoint на 0xDAA77C   
<br>5) по достижении 0xDAA77C убрал этот breakpoint и добавил &quot;memory breakpoin on access&quot; на главную 
<br>
<br>секцию (start=0x410000, size=0x317000)
<br>6) попал в 0x7175f8 который похож на OEP
<br>7) чуть позже исполняется 0x4076e4 что точно есть дельфийский код
<br>
<br>Ну а теперь вопросы:
<br>a) 0xDAA76A это кусок asprotect-a? Что он делает?
<br>b) 0x7175f8 вроде самый первый application code. Это и есть origianl entry point? И его надо прописать в PE header-e&amp;
<br>c) зациклил, сделал dump LordPE, а как исправлять imports? ImpRec/Revirgin просто так на работают...
<br>
<br>Спасибо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=40773&amp;user=1737&amp;forum_n=13&amp;topic=3174.html&amp;page=0&amp;anchor=1" class="addthx" data-post="40773"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]alex111[/b]','')">alex111</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 53.0 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.65'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=746">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2005 08:23 <br><script type="text/javascript">QU('alex111','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=alex111" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=3174.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<a href="http://www.exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2707" target="_new">http://www.exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2707</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=40776&amp;user=746&amp;forum_n=13&amp;topic=3174.html&amp;page=0&amp;anchor=2" class="addthx" data-post="40776"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2005 05:50 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=3174.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>s0larian пишет:
<br>6) попал в 0x7175f8 который похож на OEP </I>
<br>Чем похож, какой- код? Как правило, прога начинается с push ebp или эмуляции этой команды.
<br><I>s0larian пишет:
<br>a) 0xDAA76A это кусок asprotect-a? Что он делает? </I>
<br>Это код аспра. Конечно можно разбираться построчно в этом коде - но зачем?
<br><I>s0larian пишет:
<br> 0x7175f8 вроде самый первый application code. Это и есть origianl entry point? </I>
<br>Не обязательно. Как можно ответить не видя кода проги?
<br><I>s0larian пишет:
<br>c) зациклил, сделал dump LordPE, а как исправлять imports </I>
<br>Если в Олли - то не надо циклить. Что касается импорта, то смотри по форуму, как его восстанавливать в аспре. Писать слишком много.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=40882&amp;user=1631&amp;forum_n=13&amp;topic=3174.html&amp;page=0&amp;anchor=3" class="addthx" data-post="40882"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2005 08:38 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=3174.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>tar4 пишет:
<br>Чем похож, какой- код? Как правило, прога начинается с push ebp или эмуляции этой команды.  </I>
<br>007175F8 push    ebp
<br>007175F9 mov     ebp, esp
<br>007175FB mov     ecx, 5
<br>00717600 push    0
<br>00717602 push    0
<br>00717604 dec     ecx
<br>00717605 jnz     short loc_717600
<br>00717607 push    ebx
<br>00717608 mov     eax, offset dword_7168B8
<br>0071760D call    sub_4076E4
<br>00717612 xor     eax, eax
<br>00717614 push    ebp
<br>00717615 push    offset loc_717772
<br>0071761A push    dword ptr fs:[eax]
<br>0071761D mov     fs:[eax], esp
<br>00717620 mov     eax, ds:dword_724204
<br>00717625 mov     eax, [eax]
<br>00717627 call    sub_493A64
<br>0071762C call    sub_402C44
<br>00717631 dec     eax
<br>00717632 jnz     loc_717706
<br>00717638 lea     edx, [ebp+var_14]
<br>0071763B mov     eax, 1
<br>00717640 call    sub_402CA4
<br>00717645 mov     eax, [ebp+var_14]
<br>00717648 mov     edx, offset aUninstallgridi ; &quot;/uninstallgridinsoft&quot;
<br>...........
<br>
<br>Функция начинает разбирать command line arguments - логично. Похоже на entry point. Единственное что странно так это адрес. Остальные функции находятся в начале секции: sub_4076E4, sub_402C44....
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=40888&amp;user=1737&amp;forum_n=13&amp;topic=3174.html&amp;page=0&amp;anchor=4" class="addthx" data-post="40888"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Smon[/b]','')">Smon</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 500.5 (<b>!</b>), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.33'>Активность: 0.23<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2005 11:03 <br><script type="text/javascript">QU('Smon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Smon" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=3174.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>s0larian</b>
<br>Я смотрел последнюю версию с сайта - 
<br>0071916C   PUSH EBP
<br>0071916D   MOV EBP,ESP
<br>0071916F   MOV ECX,5
<br>00719174   PUSH 0
<br>00719176   PUSH 0
<br>00719178   DEC ECX
<br>00719179   JNZ SHORT gsnote3.00719174
<br>0071917B   PUSH EBX
<br>0071917C   MOV EAX,gsnote3.00718424
<br>00719181   CALL gsnote3.00407704
<br>00719186   XOR EAX,EAX
<br>00719188   PUSH EBP
<br>00719189   PUSH gsnote3.007192E6
<br>0071918E   PUSH DWORD PTR FS:[EAX]
<br>00719191   MOV DWORD PTR FS:[EAX],ESP
<br>00719194   MOV EAX,DWORD PTR DS:[726204]
<br>00719199   MOV EAX,DWORD PTR DS:[EAX]
<br>0071919B   CALL gsnote3.00493A2C
<br>007191A0   CALL gsnote3.00402C44
<br>007191A5   DEC EAX
<br>007191A6   JNZ gsnote3.0071927A
<br>007191AC   LEA EDX,DWORD PTR SS:[EBP-14]
<br>007191AF   MOV EAX,1
<br>007191B4   CALL gsnote3.00402CA4
<br>007191B9   MOV EAX,DWORD PTR SS:[EBP-14]
<br>007191BC   MOV EDX,gsnote3.007192FC                 ; ASCII &quot;/uninstallgridinsoft&quot;
<br>
<br>Это оеп, причем не защищен. Каллы аспра - CALL 01030000
<br>Секция кода имеет длину 00319000h,следовательно 00401000+00319000h = 0071A000 - т.е. OEP лежит в секции кода, всё верно. Судя по адресу последнего экспепшена имеешь дело с аспром версии 1.33 build 03.07 <img src="img/smilies/s3.gif" alt="">
<br><br><font size="1"><i>-----<br>&quotПусть видят, что мы не шутим. Стволы для понта, ножи для дела&quot Lock, Stock &amp Two Smoking Barrels</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=40895&amp;user=1449&amp;forum_n=13&amp;topic=3174.html&amp;page=0&amp;anchor=5" class="addthx" data-post="40895"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Z0oMiK[/b]','')">Z0oMiK</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2299.gif" alt=""><br><span class=txtSm>Ранг: 299.6 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.95'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2299">Участник</a><br><font color=blue>Armadillo Killer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2005 12:09 <br><script type="text/javascript">QU('Z0oMiK','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Z0oMiK" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=3174.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Smon</b> хм я почему то тут встал <img src="img/smilies/s13.gif" alt="">
<br>007174C8    55              PUSH EBP
<br>007174C9    8BEC            MOV EBP,ESP
<br>007174CB    83C4 F0         ADD ESP,-10
<br>007174CE    53              PUSH EBX
<br>007174CF    56              PUSH ESI
<br>007174D0    57              PUSH EDI
<br>007174D1    33C9            XOR ECX,ECX
<br>007174D3    894D F0         MOV DWORD PTR SS:[EBP-10],ECX
<br>007174D6    8955 F8         MOV DWORD PTR SS:[EBP-8],EDX
<br>007174D9    8945 FC         MOV DWORD PTR SS:[EBP-4],EAX
<br>007174DC    8B45 F8         MOV EAX,DWORD PTR SS:[EBP-8]
<br>007174DF    E8 90DECEFF     CALL gsnote3.00405374
<br>007174E4    33C0            XOR EAX,EAX
<br>007174E6    55              PUSH EBP
<br>007174E7    68 54757100     PUSH gsnote3.00717554
<br>007174EC    64:FF30         PUSH DWORD PTR FS:[EAX]
<br>007174EF    64:8920         MOV DWORD PTR FS:[EAX],ESP
<br>007174F2    C745 F4 FFFFFFF&gt;MOV DWORD PTR SS:[EBP-C],-1
<br>007174F9    8B45 FC         MOV EAX,DWORD PTR SS:[EBP-4]
<br>007174FC    8B40 08         MOV EAX,DWORD PTR DS:[EAX+8]
<br>007174FF    8B10            MOV EDX,DWORD PTR DS:[EAX]
<br>00717501    FF52 14         CALL DWORD PTR DS:[EDX+14]
<br>00717504    8BF0            MOV ESI,EAX
<br>00717506    4E              DEC ESI
<br>00717507    85F6            TEST ESI,ESI
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=40901&amp;user=2299&amp;forum_n=13&amp;topic=3174.html&amp;page=0&amp;anchor=6" class="addthx" data-post="40901"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Smon[/b]','')">Smon</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 500.5 (<b>!</b>), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.33'>Активность: 0.23<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2005 12:35 <br><script type="text/javascript">QU('Smon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Smon" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=3174.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>Z0oMiK</b>
<br>Эт ты удачно встал <img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>&quotПусть видят, что мы не шутим. Стволы для понта, ножи для дела&quot Lock, Stock &amp Two Smoking Barrels</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=40905&amp;user=1449&amp;forum_n=13&amp;topic=3174.html&amp;page=0&amp;anchor=7" class="addthx" data-post="40905"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 ноября 2005 01:47 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=3174.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Ага, с OEP разобралить. А что это за мусор:
<br>
<br>00407B7C call    near ptr 1430004h
<br>
<br>или вот
<br>
<br>00407B84 call    near ptr 1370004h
<br>
<br>ASProtect API? Эту чушь придётся отрезать и отлаживать.... Кто-нить знает что вообще ASProtect предоставляет? Точнее что прога от него ожидает? ;)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=41047&amp;user=1737&amp;forum_n=13&amp;topic=3174.html&amp;page=0&amp;anchor=8" class="addthx" data-post="41047"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 ноября 2005 03:56 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=3174.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
вот ещё мусор:
<br>00401360 -FF25 B0D27300    jmp     dword ptr ds:[73D2B0]            ; kernel32.CreateFileA
<br>
<br>Olly делает symbol lookup по указателям - лепота. Картина проясняется.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=41053&amp;user=1737&amp;forum_n=13&amp;topic=3174.html&amp;page=0&amp;anchor=9" class="addthx" data-post="41053"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 ноября 2005 04:37 &middot; Поправил: s0larian <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=3174.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Хмм..... По идее, каждый переход такого типа находится в мелкой библиотечной функции, которая делает переход по адресу из import table. То есть, в
<br>      jmp dword ptr ds:[73D2B0]
<br>73D2B0 это указатель который находится в IAT. Так?
<br>
<br>Если так, то теперь мне надо понять где этот IAT начинается, где заканчивается. В памяти есть секция по адресу 73D000 размером 0x4000, в которой находятся эти указатели. Елки, а что делать дальше?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=41055&amp;user=1737&amp;forum_n=13&amp;topic=3174.html&amp;page=0&amp;anchor=10" class="addthx" data-post="41055"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 ноября 2005 07:29 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=3174.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
ОК, смотрю в Olly на этот IAT:
<br>0073D1F4  7C91188A  ntdll.RtlDeleteCriticalSection
<br>0073D1F8  7C9010ED  ntdll.RtlLeaveCriticalSection
<br>0073D1FC  7C901005  ntdll.RtlEnterCriticalSection
<br>0073D200  7C809FA1  kernel32.InitializeCriticalSection
<br>0073D204  7C809B14  kernel32.VirtualFree
<br>0073D208  7C809A81  kernel32.VirtualAlloc
<br>0073D20C  7C80995D  kernel32.LocalFree
<br>0073D210  7C8099BD  kernel32.LocalAlloc
<br>0073D214  7C8092AC  kernel32.GetTickCount
<br>0073D218  1E5A5B73
<br>0073D21C  7C8114AB  kernel32.GetVersion
<br>0073D220  2374811B
<br>0073D224  7C809794  kernel32.InterlockedDecrement
<br>...............
<br>попадаются пробелы без имён функций с какими-то кривыми адресами...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=41056&amp;user=1737&amp;forum_n=13&amp;topic=3174.html&amp;page=0&amp;anchor=11" class="addthx" data-post="41056"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]gloom[/b]','')">gloom</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 192.3 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11">Участник</a><br><font color=blue>stoned machine-gunner</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 ноября 2005 11:36 <br><script type="text/javascript">QU('gloom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=gloom" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=3174.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>s0larian</b>
<br><a href="http://www.exelab.ru/art/arc4.php" target="_new">http://www.exelab.ru/art/arc4.php</a>
<br><br><font size="1"><i>-----<br>once you have tried it, you will never want anything else</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=41058&amp;user=11&amp;forum_n=13&amp;topic=3174.html&amp;page=0&amp;anchor=12" class="addthx" data-post="41058"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> ASProtect ручная распаковка</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=3174" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
