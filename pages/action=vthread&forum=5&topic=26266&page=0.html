<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как поменять одну строчку кода в python .exe? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Есть программа на python .exe собранная через PyInstaller. Ну я ее распаковал успешно с помощью pyinstxtractor.py. Потом успешно декомилировал байт-код файлов .pyc с помощью uncompyle6 и получил на выходе .py. Поменял">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=55997'>bezumchik</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как поменять одну строчку кода в python .exe?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]van9petryk[/b]','')">van9petryk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 0.49'>Активность: 0.03=0.03</span><br>Статус: <a href="action=userinfo&amp;user=52628">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 января 2020 12:14 <br><script type="text/javascript">QU('van9petryk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=van9petryk" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26266.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Есть программа на python .exe собранная через PyInstaller. Ну я ее распаковал успешно с помощью pyinstxtractor.py. Потом успешно декомилировал байт-код файлов .pyc с помощью uncompyle6 и получил на выходе .py. Поменял интересующий код, запустил, открылось окошко, можно переключатся между вкладками, но когда запускаю одну из функций программы, которая создает новый процесс, то спустя некоторое время этот процесс завершается с кодом 9 (причем каждый раз в разном месте). Никаких исключений или ошибок. Просто код 9.<br>Может я чего то не доставил... Есть какие то другие способы собрать? Ну например вытащить только один интересующий файл из архива PYZ поменять код, запихнуть обратно и потом уже собирать используя этот файл PYZ.<br>Мне бы какой то мануал, а то в интернете только разборку нашел, а обратную сборку нет...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=401683&amp;user=52628&amp;forum_n=5&amp;topic=26266.html&amp;page=0&amp;anchor=1" class="addthx" data-post="401683"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]AE[/b]','')">AE</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.8 (новичок), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 0.82'>Активность: 0.17=0.17</span><br>Статус: <a href="action=userinfo&amp;user=51133">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 января 2020 13:59 &middot; Поправил: AE <br><script type="text/javascript">QU('AE','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AE" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26266.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Мягко говоря, Питон - это не моё, но по моему в Гугле навалом всего по сборке в ЕХЕ-шник...<br>Я бы попробовал, для начала, просто разобрать-собрать (ничего не изменяя), посмотреть как этот процесс пойдет, будут ли ошибки, мб декомпиль &quot;как везде&quot;...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=401685&amp;user=51133&amp;forum_n=5&amp;topic=26266.html&amp;page=0&amp;anchor=2" class="addthx" data-post="401685"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]van9petryk[/b]','')">van9petryk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 0.49'>Активность: 0.03=0.03</span><br>Статус: <a href="action=userinfo&amp;user=52628">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 января 2020 16:05 <br><script type="text/javascript">QU('van9petryk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=van9petryk" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26266.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Как раз таки разобрать-собрать, чтобы все работало и является основной проблемой. Еще посмотрел, думал файл hosts подправить, но там не получится. Программа использует RSA: генерирует произвольную строку из 16ти символов, шифрует ее вместе с данными, отправляет на сервер. Ответ же шифрует с помощью AES и этой строки. Клиент уже, имея строку, расшифровывает ответ. Думал узнать эту случайную строку, но так как RSA я не вижу это возможным, открытая экспонента 65537.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=401690&amp;user=52628&amp;forum_n=5&amp;topic=26266.html&amp;page=0&amp;anchor=3" class="addthx" data-post="401690"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]_MBK_[/b]','')">_MBK_</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 63.5 (постоянный), 35thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.61'>Активность: 0.29<span style='color:green'>&nearr;</span>0.96</span><br>Статус: <a href="action=userinfo&amp;user=41701">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 января 2020 18:26 <br><script type="text/javascript">QU('_MBK_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=_MBK_" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26266.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
А прямо байткод патчить если? Там же вроде il или я ошибаюсь?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=401692&amp;user=41701&amp;forum_n=5&amp;topic=26266.html&amp;page=0&amp;anchor=4" class="addthx" data-post="401692"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 января 2020 20:16 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26266.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>van9petryk пишет:<br>Думал узнать эту случайную строку, но так как RSA я не вижу это возможным </I><br><br><I>van9petryk пишет:<br>генерирует произвольную строку из 16ти символов, шифрует ее вместе с данными, отправляет на сервер. </I><br><br>Найди, где генерится строка.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=401696&amp;user=24257&amp;forum_n=5&amp;topic=26266.html&amp;page=0&amp;anchor=5" class="addthx" data-post="401696"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 января 2020 23:24 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26266.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Если верить гуглу, exit code 9 - process killed by system, because out of memory for execute python script.  Т.е. явные мелкие неприятности со сборкой.<br> <I>van9petryk пишет:<br>Ну например вытащить только один интересующий файл из архива PYZ поменять код, запихнуть обратно и потом уже собирать используя этот файл PYZ. </I><br>Из того, что видел, полагаю оно так и должно работать - в файлах исходного кода указываются зависимости, которые автоматом в .exe прилинковываются. Питоновская дллка в импорте, только как интерпретатор этого винегрета внутри нужна.<br><br><I>van9petryk пишет:<br>Программа использует RSA </I><br>Так вопрос - просто зарегать прогу или узнать, какие секретные данные от сервера приходят?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=401698&amp;user=26651&amp;forum_n=5&amp;topic=26266.html&amp;page=0&amp;anchor=6" class="addthx" data-post="401698"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]van9petryk[/b]','')">van9petryk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 0.49'>Активность: 0.03=0.03</span><br>Статус: <a href="action=userinfo&amp;user=52628">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 января 2020 19:35 <br><script type="text/javascript">QU('van9petryk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=van9petryk" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26266.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>_MBK_</b>сейчас копаю в этом направлении.<br>Достал из .exe интересующий .pyc файл с помощью pyi-archive_viewer (это такая дополнительная утилита от самих разработчиков упаковщика PyInstaller для просмотра содержимого архива .exe или архива .pyz который лежит в этом .exe).<br>Ну .pyc был сжат с помощью DEFLATE (это PyInstaller сжимает каждый файл, посмотрел в исходниках, но в новой версии все поменялось, они собирают файлы в архив .pyz не сжатыми, а сжимают весь архив .pyz). Но мне повезло (наверно), использовалась более старая версия, поэтому сжатый .pyc с легкостью превратил в несжатый (то есть декомпрессии всего архива .pyz не понадобилась).<br><br>А теперь смотрю, как пропатчить этот файл .pyc, чтобы True изменить на False.  [url=Вот тут]https://nedbatchelder.com/blog/200804/the_structure_of_pyc_files.html[/url] есть информация по структуре файла .pyc. Пока что сижу читаю.<br>Из вариантов еще декомпиляция в исходный код, правка, и компиляция обратно в .pyc. Правда, скорей всего изменится длина, и его уже запихнуть обратно будет не так просто.<br><br><b>Добавлено спустя 2 минуты</b><br><b>DenCoder</b>Ну в исходном коде .py я вижу где она генерируется.И что дальше? Или вы имели ввиду найти в отладчике x64dbg?<br><br><b>Добавлено спустя 10 минут</b><br><b>ELF_7719116</b> по-моему это -9 = out of memory, а у меня просто 9. Смотрел exit code WinApi, то там 9 = The storage control block address is invalid.<br><br>Зарегать прогу. Но регистрация идет через сервер. Так что наверное проще как то обойти проверку лицензии. Я вижу это возможным только путем изменения значения одной переменных, или изменение строчки кода в котором проверяется значение этой переменной.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=401781&amp;user=52628&amp;forum_n=5&amp;topic=26266.html&amp;page=0&amp;anchor=7" class="addthx" data-post="401781"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]_MBK_[/b]','')">_MBK_</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 63.5 (постоянный), 35thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.61'>Активность: 0.29<span style='color:green'>&nearr;</span>0.96</span><br>Статус: <a href="action=userinfo&amp;user=41701">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 января 2020 19:46 <br><script type="text/javascript">QU('_MBK_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=_MBK_" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26266.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
А нет не il<br>Но все равно первая ссылка по Гуглу https://habr.com/ru/post/140356/
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=401786&amp;user=41701&amp;forum_n=5&amp;topic=26266.html&amp;page=0&amp;anchor=8" class="addthx" data-post="401786"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 января 2020 22:57 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26266.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>van9petryk пишет:<br>как то обойти проверку лицензии. </I><br>Как альтернативный вариант - подправить загружаемый через импорт python-интерпретатор, чтобы интерпретировать pyc-код в &quot;правильном&quot; ключе. Если править исходный код и обратно перекомпилить, то тогда уж всю проверку регистрации логично вырезать вообще. <br><I>van9petryk пишет:<br>регистрация идет через сервер. </I><br>Собственно, известно, с чем именно сверяется ответ от сервака?? <br><br>Обычно, такой фигней, как python exe (bat exe и тд) страдают читы и малвара. Навскидку не вспомнить, какой обычный софт таким способом писали или регали.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=401807&amp;user=26651&amp;forum_n=5&amp;topic=26266.html&amp;page=0&amp;anchor=9" class="addthx" data-post="401807"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]van9petryk[/b]','')">van9petryk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 0.49'>Активность: 0.03=0.03</span><br>Статус: <a href="action=userinfo&amp;user=52628">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2020 01:18 <br><script type="text/javascript">QU('van9petryk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=van9petryk" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26266.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>_MBK_</b>да,я уже разобрался, и успешно модифицировал. Только теперь после сжатия с помощью DEFLATE файл получатся на 3 байта меньше. Буду пытаться повторить некоторые инструкции, или добавить какой то мусор, чтобы добиться такого же количества байт.<br><br><b>Добавлено спустя 1 час 41 минуту</b><br>Повторить или добавить не получилось, сразу получал invalid marshaled object. Там есть структура (поле), в которой хранится информация, к какой строке эта часть байт-кода принадлежит. Так что если добавить что-то, то все начинает ехать. Так что все-таки декомпилировал .pyc, добавил мусор в .py, и таким образом методом тыка получил нужное кол-во байт после DEFLATE. Заменил полученными данными оригинальный файл в архиве .pyz.<br>Все запустилось, но та же проблема, поработает немного и вылетает дочерний процес. Я хз, кривая програма или что.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=401827&amp;user=52628&amp;forum_n=5&amp;topic=26266.html&amp;page=0&amp;anchor=10" class="addthx" data-post="401827"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]_MBK_[/b]','')">_MBK_</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 63.5 (постоянный), 35thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.61'>Активность: 0.29<span style='color:green'>&nearr;</span>0.96</span><br>Статус: <a href="action=userinfo&amp;user=41701">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2020 07:50 <br><script type="text/javascript">QU('_MBK_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=_MBK_" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26266.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Все равно не совсем пойму. Вы чуть выше писали что вам таки удалось сжатый архив превратить в несжатый. После этого (без модификации) программа работает нормально или тоже вылетает?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=401844&amp;user=41701&amp;forum_n=5&amp;topic=26266.html&amp;page=0&amp;anchor=11" class="addthx" data-post="401844"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]van9petryk[/b]','')">van9petryk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 0.49'>Активность: 0.03=0.03</span><br>Статус: <a href="action=userinfo&amp;user=52628">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2020 14:55 &middot; Поправил: van9petryk <br><script type="text/javascript">QU('van9petryk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=van9petryk" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26266.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>_MBK_</b>Смотрите. Там такая структура .exe<br>1 struct<br>2 some_file.pyc<br>3 some_file.pyc<br>4 PYZ<br><br>Вот этот архив PYZ он не сжатый, но сами файлы внутри него сжаты DEFLATE&#039;ом (в новых версиях PyInstaller наоборот файлы внутри не сжаты, но сжат сам архив - у меня старая версия, то есть архив не сжатый, сжаты файлы)<br><br>На <noindex><a href="https://pyinstaller.readthedocs.io/en/stable/advanced-topics.html#zlibarchive" rel="nofollow" target="_blank">странице документации</a></noindex> он описан как ZLibArchive.<br><br>Ну вот, я вытащил оттуда интересующий .pyc. Он был сжат DEFLATE. Я его <br>1. распаковал<br>2. декомпилировал<br>3. изменил то что интересовало<br>4. собрал в .pyc обратно<br>5. и сжал DEFLATE.<br><br>Но так как размер после сжатия DEFLATE уже был другим, пришлось добавлять мусор. Ну я вернулся обратно к этапу 3 и кроме модификации начал добавлять мусор и повторять 4-5 чтобы размер был таким же, как у изначального вытащенного с архива PYZ файла.<br><br>Добился. После этого, нашел в hex редакторе блок который соответствовал оригинальному файлу, и заменил этот блок модифицированным файлом.<br><br>После этого программа работает так же, как и работала после способа описанного в 1м посте - вылетает спустя некоторого времени после запуска одной из функций.<br><br><b>Добавлено спустя 11 минут</b><br><b>ELF_7719116</b><br>С чем сверяется ответ? Не совсем понял.<br>1. Генерируется случайная строка из 16 символов.<br>2. Берутся данные + строка -&gt; сжимаются -&gt; шифруются с помощью RSA -&gt; отправляются на сервер.<br>3. Сервер, с помощью private key дешифрует и распаковывает<br>4. Сервер шифрует ответ AESом. В качестве ключа выступает случайная строка полученная от клиента.<br>5. Клиент получает ответ и дешифрует его с помощью случайной строки.<br>6. Дешифрованный ответ либо строка &#039;done&#039;, либо строка &#039;invalid&#039;, либо еще какой то другой, если это не касается лицензии.<br><br><b>Добавлено спустя 15 минут</b><br><b>ELF_7719116</b><br><I>ELF_7719116 пишет:<br>подправить загружаемый через импорт python-интерпретатор, чтобы интерпретировать pyc-код в &quot;правильном&quot; ключе </I><br>Не совсем пойму, что вы имеете ввиду (какой код в каком ключе?)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=401855&amp;user=52628&amp;forum_n=5&amp;topic=26266.html&amp;page=0&amp;anchor=12" class="addthx" data-post="401855"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]_MBK_[/b]','')">_MBK_</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 63.5 (постоянный), 35thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.61'>Активность: 0.29<span style='color:green'>&nearr;</span>0.96</span><br>Статус: <a href="action=userinfo&amp;user=41701">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 января 2020 16:26 <br><script type="text/javascript">QU('_MBK_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=_MBK_" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26266.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Такой эффект может иметь три обьяснения 1) некорректная сборка 2) хитрый контроль целостности 3) вы чего то недоглядели в алгоритме и нельзя просто так взять и заменить false на true <br>Чтобы как то сузить круг поисков попробуйте тупо распаковать-запаковать архив обратно безо всякой правки - он идентичный получмтся с исходным? Если нет, добавить до необходимого размера мусора и попытаться запустить. Так будет отметен хотя бы третий вариант
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=401861&amp;user=41701&amp;forum_n=5&amp;topic=26266.html&amp;page=0&amp;anchor=13" class="addthx" data-post="401861"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как поменять одну строчку кода в python .exe?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=26266" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
