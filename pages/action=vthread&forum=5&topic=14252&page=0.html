<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>ASProtect 2.11 - восстановление IAT - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Есть софтина, которую очень хотелось бы поюзать - OrangeCD 6.3.1. Ссылка Кряка к ней нет, точнее, нет к этой версии. Да и тот, что есть к предыдущей, работает криво. Хотел пореверсить ее, но вот беда: запакована ASProtect.">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> ASProtect 2.11 - восстановление IAT</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]angelofdistress[/b]','')">angelofdistress</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=20775">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2009 10:27 &middot; Поправил: angelofdistress <br><script type="text/javascript">QU('angelofdistress','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=angelofdistress" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Есть софтина, которую очень хотелось бы поюзать - OrangeCD 6.3.1. <noindex><a href="http://www.firetongue.com/orgcdfull.exe" rel="nofollow" target="_blank">Ссылка</a></noindex> Кряка к ней нет, точнее, нет к этой версии. Да и тот, что есть к предыдущей, работает криво. Хотел пореверсить ее, но вот беда: запакована ASProtect. <br>ASPrINF 1.6 говорит, что версия ASProtect 2.11 build 03.13. Вроде как распаковалась стриппером 2.13b9. При запуске ругнулась на ординал в ocdapi.dll, в связи с чем я решил, что надо бы поправить IAT. Я не особо силен еще в деле анпакинга, поэтому не уверен, что сделал дальше все правильно. Запустил нераспакованную софтину, приаттачил к процессу ImpRec 1.6, он мне нашел таблицу импортов. Там были инвалиды, но я их восстановил по инфе, которую мне выдавал стриппер при анпаке. Зафиксил дамп. Дамп не запустился. Стал смотреть его Оллей: EIP стабильно сбрасывается в ноль, на что Олля и ругается.<br>Соответственно, хочу задать вопросы: что происходит, что я делаю неправильно? Буду признателен, если кто-нибудь распакует эту сволочь, и, если не сложно, кинет хотя бы кратенькие шаги распаковки.<br><br>UPD: Возможно я вообще изначально накосячил и стриппер неправильно распаковал. Скрипт от Volx не понял как заюзать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229253&amp;user=20775&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=1" class="addthx" data-post="229253"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2009 10:37 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>angelofdistress пишет:<br>Я не особо силен еще в деле анпакинга </I><br>Не спорю <img src="img/smilies/s3.gif" alt="">, а вообще на форуме уже есть тема по аспру, почитай <a href="http://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=11596" target="_blank">--&gt; тут &lt;--</a>, или пойди <a href="http://exelab.ru/rar/" target="_blank">--&gt; сюда &lt;--</a>, там тоже достаточно статей, ну если сам не справишься, тада тебе в запросы на взлом.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229256&amp;user=16624&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=2" class="addthx" data-post="229256"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2009 10:38 &middot; Поправил: daFix <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>angelofdistress</b><br>Видать в проге идёт вызов API, указатель на который ты затёр. Тоесть получчается примерно следующее:<br>JMP DWORD PTR DS:[хххххххх], где по смещению хххххххх лежат нули. Тоесть выполняется буквально следующая команда:<br>JMP 00000000<br>Соответственно это и вызывает ошибку. А вообще тут пока ничего точно нельзя сказать без дампа
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=229257&amp;user=2777&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=3" class="addthx" data-post="229257"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Konstantin[/b]','')">Konstantin</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.9 (посетитель), 33thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.03'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12248">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2009 11:45 <br><script type="text/javascript">QU('Konstantin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Konstantin" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>Скрипт от Volx не понял как заюзать.</I><br>Скрипт сам делает дамп проги с названием de_имя проги. Вот к этому дампу нужно прикрутить импорт, инфу для imprec-а скрипт пишет в окно лога ольки.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229266&amp;user=12248&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=4" class="addthx" data-post="229266"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]angelofdistress[/b]','')">angelofdistress</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=20775">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2009 12:40 &middot; Поправил: angelofdistress <br><script type="text/javascript">QU('angelofdistress','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=angelofdistress" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>Konstantin</b><br>Получилось создать дамп скриптом. Восстановил импорт ImpRec&#039;ом. Прога не запускается.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229272&amp;user=20775&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=5" class="addthx" data-post="229272"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2009 13:14 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>angelofdistress пишет:<br>Получилось создать дамп скриптом. Восстановил импорт ImpRec&#039;ом. Прога не запускается.</I><br><br>не ленись БОЛЬШЕ инфы давать!
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=229274&amp;user=1379&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=6" class="addthx" data-post="229274"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Konstantin[/b]','')">Konstantin</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.9 (посетитель), 33thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.03'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12248">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2009 14:07 &middot; Поправил: Konstantin <br><script type="text/javascript">QU('Konstantin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Konstantin" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>angelofdistress</b><br>Нормально скрипт распаковывает. Прежде чем прикручивать импорт в импреке нужно нажать <b>show Invalid</b>, а потом удалить выделеный не распознаный импорт, т. к. эти функции - апи аспра. Скрипт их сам пофиксил.<br>Распакованный файл rapidshare.com/files/223949540/dadbapp.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229280&amp;user=12248&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=7" class="addthx" data-post="229280"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]angelofdistress[/b]','')">angelofdistress</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=20775">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2009 15:20 <br><script type="text/javascript">QU('angelofdistress','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=angelofdistress" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>Konstantin</b><br>Хммм... Оригинально! Спасибо за распаковку. А каким скриптом распаковано? Мой 1.15E от Volx на выходе дал метровый файл. Да еще, видимо, моя ошибка была в том, что я вместо того, чтобы удалить инвалидные записи, их правил.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229285&amp;user=20775&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=8" class="addthx" data-post="229285"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Konstantin[/b]','')">Konstantin</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.9 (посетитель), 33thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.03'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12248">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2009 15:42 <br><script type="text/javascript">QU('Konstantin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Konstantin" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>А каким скриптом распаковано?</I><br>У меня этот же скрипт.<br><I>на выходе дал метровый файл</I><br>я конечно же файл оптимизировал, отрезал не нужные секции и т. д. поэтому мой меньше
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229286&amp;user=12248&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=9" class="addthx" data-post="229286"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]angelofdistress[/b]','')">angelofdistress</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=20775">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2009 15:55 &middot; Поправил: angelofdistress <br><script type="text/javascript">QU('angelofdistress','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=angelofdistress" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>Konstantin</b><br>Все равно, как об стенку. Распаковываю скриптом, запускаю оригинальный файл, открываю этот процесс в ImpRec, ввожу OEP, RVA и Size на основе данных, которые скрипт записал в лог. Нажимаю GetImports, удаляю инвалидные записи. Все остальные настройки оставляю по дефолту. Нажимаю Fix Dump, выбираю распакованный скриптом файл. И он ни фига не запускается. Просто тишина и все. В чем проблема-то может быть? Если то же самое сделать с файлом, распакованным стриппером, то Unhandled Exception. В ImpRec стоит галка на Add new section. <br><br>ImpRec в лог пишет: New section added successfully. RVA:000E100 SIZE:00002000 Image Import Descriptor size:F0 Total length:12A4<br><br>Скрипт у всех. по идее, работает одинаково. Значит косячить я могу только в восстановлении импорта. Ну и лишние секции я не знаю, какие удалять.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229288&amp;user=20775&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=10" class="addthx" data-post="229288"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Konstantin[/b]','')">Konstantin</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.9 (посетитель), 33thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.03'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12248">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2009 16:09 <br><script type="text/javascript">QU('Konstantin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Konstantin" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
вот такие у меня настройки импрека<br><img src="http://myphoto.nnov.ru/img/68f3e9fcf7ec5fdfefbc53a58f4f1227.jpg" border="0" align="" alt=""><br>так удаляем не распознаный импорт<br><img src="http://myphoto.nnov.ru/img/ffea12094ffc4c5ea7428d9c5213979d.jpg" border="0" align="" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229292&amp;user=12248&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=11" class="addthx" data-post="229292"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Konstantin[/b]','')">Konstantin</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.9 (посетитель), 33thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.03'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12248">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2009 16:23 &middot; Поправил: Konstantin <br><script type="text/javascript">QU('Konstantin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Konstantin" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
ЭЭЭЭЭЭЭ, только сейчас заметил:<br><I>Распаковываю скриптом, запускаю оригинальный</I><br>Распаковал скриптом, а зачем файл оригиналный запускать после? Когда скрипт в оле отработал ты будеш находиться на OEP проги. Стоя на OEP в оле аттачся сразу импреком к запущеному под отладчиком процессу. Там скрипт испорченный импорт пофиксил как надо.<br><I>Ну и лишние секции я не знаю, какие удалять.</I><br>Нужен тебе этот гимор по оптимизации если нет опыта? Просто так ты лишние секции не удалишь. Их надо удалять до прикручивания импорта, так же необходимо восстанавить ресурсы в одну секцию, т. к. часть ресуров украдено аспром в свои секции.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229296&amp;user=12248&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=12" class="addthx" data-post="229296"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2009 17:52 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Не понимаю я людей, которые начинают спрашивать, что не так в распакованном файле. Ну сравни с упакованным да погляди, что не так. А если при этом не выкладывают ещё и свой дамп-это вообще абзац, экстрасенсы в отпуске.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229306&amp;user=1556&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=13" class="addthx" data-post="229306"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]cRAcKEr[/b]','')">cRAcKEr</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.41'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19879">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 апреля 2009 11:29 <br><script type="text/javascript">QU('cRAcKEr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cRAcKEr" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>angelofdistress пишет:<br>Значит косячить я могу только в восстановлении импорта </I><br>Не косяк в дампе. Сними дамп OllyDump без Rebuild Import или с помощью PeTools, востанови импорт и все заработает!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229352&amp;user=19879&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=14" class="addthx" data-post="229352"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]vnekrilov[/b]','')">vnekrilov</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 329.6 (мудрец), 192thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.08'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=5173">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2009 09:26 &middot; Поправил: vnekrilov <br><script type="text/javascript">QU('vnekrilov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vnekrilov" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>angelofdistress</b><br><br>Посмотри на мои статьи по распаковке Asprotect в топике <a href="http://www.exelab.ru/f/action=vthread&amp;topic=11596&amp;forum=1&amp;page=-1" target="_new">http://www.exelab.ru/f/action=vthread&amp;topic=11596&amp;forum=1&amp; page=-1</a><br>Я постарался довольно подробно описать процесс распаковки программ, упакованных этим пакером, и приложил комплект скриптов, который помогает в распаковке программ. Думаю, что это будет для тебя полезным.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229684&amp;user=5173&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=15" class="addthx" data-post="229684"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 апреля 2009 18:41 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14252.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>angelofdistress</b> <img src="img/smilies/s1.gif" alt=""> а чего сайт то в дауне ? ... не качает ничего.
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=229867&amp;user=3520&amp;forum_n=5&amp;topic=14252.html&amp;page=0&amp;anchor=16" class="addthx" data-post="229867"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> ASProtect 2.11 - восстановление IAT</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#17" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="14252">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=14252" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
