<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Sentinel Pro + IDR + IDA -&gt; Помогите найти обработчик кнопки. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Уважаемые друзья, прошу помощи в поиске обработчика кнопки. Задача -&gt; разобрать алгоритм калкулятора crc. Есть приложение которое использовало Sentinel Pro, рабочая флешка есть. Для просмотра кода решил сдампить и поправить">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=6859'>cppasm</a>, <a target='_blank' href='?action=userinfo&amp;user=55996'>dutyfree</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Sentinel Pro + IDR + IDA -&gt; Помогите найти обработчик кнопки.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]cryptX[/b]','')">cryptX</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.9 (посетитель), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17986">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 декабря 2016 17:10 &middot; Поправил: cryptX <br><script type="text/javascript">QU('cryptX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cryptX" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24470.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Уважаемые друзья, прошу помощи в поиске обработчика кнопки.<br><br>Задача -&gt; разобрать алгоритм калкулятора crc.<br><br>Есть приложение которое использовало Sentinel Pro, рабочая флешка есть. Для просмотра кода решил сдампить и поправить импорт через Scylla, кажется получилось - оказалось прога написано на делфи, загонял под IDR, нашел нужную форму и имя кнопочки (bncheck) которая собственно использует нужный алгоритм:<br><img src="https://i.imgsafe.org/80963608a8.png" border="0" align="" alt=""><br><br>сгенерировал файл IDC и открыл в IDA. Теперь собственно главный вопрос -&gt; по надписью кнопки не могу найти обработчик кнопки:<br><br><img src="https://i.imgsafe.org/809b571fdb.png" border="0" align="" alt=""><br><br>-----<br>Теперь вопросы <img src="img/smilies/s1.gif" alt=""><br><br>0) Хотелось бы узнать Sentinel Pro может помешать разбору алгоритма ? Или дамп достаточен для разбора ?<br>(п.с -&gt; дамп не запускается)<br><br>1) Где искать обработчик и как ?<br><br>2) Когда нажимаю на правую кнопку по адрессу ИДА вылетает с ошибкой:<br><img src="https://i.imgsafe.org/809d2c119a.png" border="0" align="" alt=""><br><br>Как боротся с этим багом ? Есть у кого лечение. (У меня вин 7 32 бита, IDA 6.8)<br><br>Заранее спасибо!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369971&amp;user=17986&amp;forum_n=5&amp;topic=24470.html&amp;page=0&amp;anchor=1" class="addthx" data-post="369971"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 декабря 2016 18:35 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24470.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>cryptX пишет:<br>) Когда нажимаю на правую кнопку по адрессу ИДА вылетает с ошибкой: </I><br><br><noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=15481&amp;page=33#3" rel="nofollow" target="_blank">--&gt; See here &lt;--</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369975&amp;user=35473&amp;forum_n=5&amp;topic=24470.html&amp;page=0&amp;anchor=2" class="addthx" data-post="369975"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=17986" title="07-12-2016 18:57, ранг:29.9" target="_blank">cryptX</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]rmn[/b]','')">rmn</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 158.4 (ветеран), 123thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.28'>Активность: 0.14<span style='color:green'>&nearr;</span>0.49</span><br>Статус: <a href="action=userinfo&amp;user=1533">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 декабря 2016 19:39 <br><script type="text/javascript">QU('rmn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rmn" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24470.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>cryptX</b><br>Тебе в idr не форму искать нужно, а класс с таким же именем. Там и адрес обработчика OnClick будет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369977&amp;user=1533&amp;forum_n=5&amp;topic=24470.html&amp;page=0&amp;anchor=3" class="addthx" data-post="369977"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]cryptX[/b]','')">cryptX</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.9 (посетитель), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17986">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 декабря 2016 23:46 <br><script type="text/javascript">QU('cryptX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cryptX" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24470.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>rmn</b><br>В idr/ida нашел адрес типa(класса) с таким же именем (TfmExportWawi),  но в ClassViewer(F7) такого класса нету...<br><img src="https://i.imgsafe.org/8651a0bbc0.png" border="0" align="" alt=""><br><br>+ по найденому адресу в идр (Units(F2)) нечего нету кроме самого имени:<br><br><img src="https://i.imgsafe.org/8668abea3b.png" border="0" align="" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369978&amp;user=17986&amp;forum_n=5&amp;topic=24470.html&amp;page=0&amp;anchor=4" class="addthx" data-post="369978"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]sendersu[/b]','')">sendersu</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 512.7 (<b>!</b>), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.56'>Активность: 0.27<span style='color:red'>&searr;</span>0.03</span><br>Статус: <a href="action=userinfo&amp;user=14629">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 декабря 2016 21:09 <br><script type="text/javascript">QU('sendersu','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sendersu" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24470.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
еще 1 метод как дойти к обработчику - <br><br><img src="img/attach.gif" alt=""> <a href="./files/dba2_08.12.2016_EXELAB.rU.tgz">dba2_08.12.2016_EXELAB.rU.tgz</a> - Screenshot_70.png
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369990&amp;user=14629&amp;forum_n=5&amp;topic=24470.html&amp;page=0&amp;anchor=5" class="addthx" data-post="369990"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=17986" title="10-12-2016 21:05, ранг:30.8" target="_blank">cryptX</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]cryptX[/b]','')">cryptX</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.9 (посетитель), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17986">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 декабря 2016 09:36 <br><script type="text/javascript">QU('cryptX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cryptX" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24470.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>sendersu</b><br>Знал про этот метод, но кажется там динамически прицепляет обработчик ?! - <br><img src="https://i.imgsafe.org/a41c4b9265.png" border="0" align="" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369999&amp;user=17986&amp;forum_n=5&amp;topic=24470.html&amp;page=0&amp;anchor=6" class="addthx" data-post="369999"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]sendersu[/b]','')">sendersu</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 512.7 (<b>!</b>), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.56'>Активность: 0.27<span style='color:red'>&searr;</span>0.03</span><br>Статус: <a href="action=userinfo&amp;user=14629">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 декабря 2016 10:20 <br><script type="text/javascript">QU('sendersu','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sendersu" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24470.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
странно! ибо обработчик прописан и Visual Form Renderer  его прочитал и добавил в менюшку (значит он создан на фазе дизайна)<br><br>еще такой наводящий вопрос - дождались ли конца анализа входного файла?<br>после 100% анализа попробуйте еще раз зайти в обработичк етим методом
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370000&amp;user=14629&amp;forum_n=5&amp;topic=24470.html&amp;page=0&amp;anchor=7" class="addthx" data-post="370000"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]cryptX[/b]','')">cryptX</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.9 (посетитель), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17986">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 декабря 2016 10:48 &middot; Поправил: cryptX <br><script type="text/javascript">QU('cryptX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cryptX" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24470.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>sendersu</b><br>Да, дождался.<br>Пробовал еще раз - тот же результат.<br>--------------------------------------------------------------<br>Тема закрыта, нашел нужную процедуру (процедура использовало TStreamReader, поставил бряки на TStreamReader.Create и я в процедуре обработчика), спасибо всем!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370001&amp;user=17986&amp;forum_n=5&amp;topic=24470.html&amp;page=0&amp;anchor=8" class="addthx" data-post="370001"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Sentinel Pro + IDR + IDA -&gt; Помогите найти обработчик кнопки.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24470" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
