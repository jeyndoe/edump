<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Затирание переменных, объявленных в куче - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Добрый день. Проблема следующая - иногда при вызове библиотечных функций (MessageBox, ShowMessage и тд), а также - при динамическом выделении памяти (new, delete), затираются значения в структурах и массивах, также, объявленных в">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Затирание переменных, объявленных в куче</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Wagos[/b]','')">Wagos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.9'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32706">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 13:25 &middot; Поправил: Wagos <br><script type="text/javascript">QU('Wagos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wagos" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Добрый день.<br>Проблема следующая - иногда при вызове библиотечных функций (MessageBox, ShowMessage и тд), а также - при динамическом выделении памяти (new, delete), затираются значения в структурах и массивах, также, объявленных в куче. Код не выкладываю, т. к. проект здоровый и затирание данных образуется в местах, никак не связанных друг с другом. Т. е. вызывается функция, в которой присутствуют вышеуказанные вызовы и после выполнения, к примеру, вызова TStringList* strList = new TStringList(); могут рандомно измениться значения в другой ранее объявленной структуре. Оперативной памяти с запасом. У кого-нибудь возникали подобные проблемы?<br>Среда разработки: Embarcadero C++ Builder XE2.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338422&amp;user=32706&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=1" class="addthx" data-post="338422"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 13:27 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Отследить момент затирания мы получим затирающий код <img src="img/smilies/s8.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338424&amp;user=33727&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=2" class="addthx" data-post="338424"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Wagos[/b]','')">Wagos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.9'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32706">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 13:30 <br><script type="text/javascript">QU('Wagos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wagos" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>Dr0p</b>, Момент затирания - в функции выделения памяти. Не понятно, почему она выделяет память в уже выделенной области. Думаю, что-то с настройками компилятора. Хотя, пока не знаю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338425&amp;user=32706&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=3" class="addthx" data-post="338425"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 13:32 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
вам нужен отладчик использованой памяти<br><noindex><a href="http://stackoverflow.com/questions/413477/is-there-a-good-valgrind-substitute-for-windows" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br>выбирайте любой
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338426&amp;user=15381&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=4" class="addthx" data-post="338426"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=32706" title="19-02-2014 09:38, ранг:10.4" target="_blank">Wagos</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Wagos[/b]','')">Wagos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.9'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32706">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 13:38 <br><script type="text/javascript">QU('Wagos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wagos" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>reversecode</b>, Спасибо, посмотрим, что получится.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338427&amp;user=32706&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=5" class="addthx" data-post="338427"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 14:45 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Wagos</b> могу сказать точно. в делфи/билдере очень большие проблемы с динамическим выделением памяти, часто все сыпится.. либо переписывайте код на статик переменные.. либо следите за стеком.. либо юзайте др. либу FastMM вроде.. типа альтернатива<br>то... что происходит с динамическими переменными.. вообще шоу.. типа попробуйте сделать в цикле SetLength переменной .. массиву.. раз 50... с рандомным значением.. и прозреете
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=338432&amp;user=17319&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=6" class="addthx" data-post="338432"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=32706" title="19-02-2014 12:09, ранг:10.4" target="_blank">Wagos</a>, <a href="action=userinfo&user=35473" title="19-02-2014 16:59, ранг:49.8" target="_blank">dosprog</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Wagos[/b]','')">Wagos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.9'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32706">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 15:53 &middot; Поправил: Wagos <br><script type="text/javascript">QU('Wagos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wagos" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>VodoleY</b>, Спасибо, а со стеком что? Динамическая память-же выделяется вне стека
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338437&amp;user=32706&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=7" class="addthx" data-post="338437"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 16:15 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>Dr0p</b><br><br>Какие аргументы в функции, видимо указатель кривой ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338438&amp;user=33727&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=8" class="addthx" data-post="338438"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 16:19 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>Wagos</b> ну давай логически.. MessageBox, ShowMessage  в конце концов АПИ вызывают.. еслиб проблемы были в них.. сыпалась бы винда. если сыпяться они, значит не правильно кним параметры приходят.. самая первая проблема.. это гдето у тебя идет нескомпенсированный стек.. и этим функам приходит на вход мусор.
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=338439&amp;user=17319&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=9" class="addthx" data-post="338439"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Wagos[/b]','')">Wagos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.9'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32706">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 16:24 &middot; Поправил: Wagos <br><script type="text/javascript">QU('Wagos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wagos" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>Dr0p</b>, Самое забавное, что после удаления нескольких вызовов функций, проблемы исчезли (инструкции по выделению памяти работают корректно).<br>Кстати, забыл, сказать - до этого была ещё одна проблема. Данные в динамической памяти менялись даже после простого вызова функции. В отладчике было видно, что после выполнения call&#039;a (помещения в стек адреса возврата), шустро менялись некоторые переменные в структуре. Чем это объяснить, я не знаю.<br><br><b>VodoleY</b>, Это да, но функции корректно отрабатывают. Иначе бы я имел эксепшен, я думаю (в большинстве случаев).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338441&amp;user=32706&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=10" class="addthx" data-post="338441"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 17:21 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>Wagos пишет:<br>Иначе бы я имел эксепшен, я думаю (в большинстве случаев).  </I><br>конкретно на этих функах редко
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=338447&amp;user=17319&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=11" class="addthx" data-post="338447"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 18:14 &middot; Поправил: F_a_u_s_t <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Гейзенбаги довольно частое явление, падает в одном месте, ошибка совершенно в другом.<br>Пользуйтесь логирами, что то типа eurekalog и какой нибудь утилитой для детекта утечек памяти.<br>Скорее всего дело в инвалидных параметрах и стек\указатель летит к еб@ням.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338455&amp;user=6&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=12" class="addthx" data-post="338455"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=32706" title="19-02-2014 16:07, ранг:11.4" target="_blank">Wagos</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]vden[/b]','')">vden</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 112.9 (ветеран), 186thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.22'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=28841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 19:39 &middot; Поправил: vden <br><script type="text/javascript">QU('vden','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vden" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>Wagos пишет:<br> Момент затирания - в функции выделения памяти. Не понятно, почему она выделяет память в уже выделенной области. </I><br>Скорее всего выделяет память правильно, а старая область уже освобождена. Указатель, естественно, неправильный. Лучше использовать FreeAndNil (обнулять указатель после освобождения класса), тогда будет легче найти обращение к NULL.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338463&amp;user=28841&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=13" class="addthx" data-post="338463"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Wagos[/b]','')">Wagos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.9'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32706">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 20:06 <br><script type="text/javascript">QU('Wagos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wagos" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>F_a_u_s_t</b>, Спасибо!<br><b>vden</b>, Дело в том, что старая - не освобождена, а содержит данные, которыми нужно оперировать. При  динамическом выделении часть этой области памяти заполняется мусором, что приводит к краху приложения.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338465&amp;user=32706&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=14" class="addthx" data-post="338465"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 21:22 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>Wagos</b>,<br>MessageBox() ничего не пишет, поэтому, думаю,  не в самих аргументах дело.<br>Попробуйте убрать всякую оптимизацию при компиляции, попробуйте другую версию того же компилятора...<br><br>Правда, есть у меня старинная программка, так та глючит после компиляции на всей линейке MSVC 2..6, если не указать определённые опции компиляции (подбиралось втыком). Глючит при входе в одну из процедур. Я нашёл это место в .EXE - там явный <b>косяк компилятора</b>. <br>Проявлялется похожим образом, как у вас.<br><br>До сих пор у меня в <b>makefile</b> лежит пояснение: <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#&nbsp;GOOD<span class="hl_char">!</span><span class="hl_function"><b>CODE</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_quote">&quot;-Od&quot;</span><span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">#&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">#&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l1">#&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">]</span><span class="hl_char">[</span><span class="hl_number">8</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">#&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l1">#&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">*</span><span class="hl_number">4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">#&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ecx</span><span class="hl_char">]</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">*</span><span class="hl_number">2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">#&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_number">00049CC20</span><span class="hl_char">]</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">*</span><span class="hl_number">8</span>&nbsp;<span class="hl_comment">;OK!    </span></li><li class="hl_l0">#</li><li class="hl_l1">#</li><li class="hl_l0">#&nbsp;BAD<span class="hl_char">!</span><span class="hl_function"><b>CODE</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span><span class="hl_quote">&quot;-Ox&quot;</span><span class="hl_char">)</span></li><li class="hl_l1">#&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l0">#&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_registr"><b>ecx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;BAD!!! Must be EAX,EAX !!!</span></li><li class="hl_l1">#&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">cl</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">]</span><span class="hl_char">[</span><span class="hl_number">8</span><span class="hl_char">]</span></li><li class="hl_l0">#&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span><span class="hl_registr">cl</span></li><li class="hl_l1">#&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ecx</span><span class="hl_char">]</span><span class="hl_char">[</span><span class="hl_registr">ecx</span><span class="hl_char">]</span><span class="hl_char">*</span><span class="hl_number">4</span></li><li class="hl_l0">#&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">]</span><span class="hl_char">*</span><span class="hl_number">2</span></li><li class="hl_l1">#&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_number">000471C20</span><span class="hl_char">]</span><span class="hl_char">[</span><span class="hl_registr">ecx</span><span class="hl_char">]</span><span class="hl_char">*</span><span class="hl_number">8</span>&nbsp;<span class="hl_comment">;BAD!!!!!!!!!</span></li><li class="hl_l0">#</li><li class="hl_l1">#&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l0">#&nbsp;Use&nbsp;<span class="hl_quote">&quot;-O1&quot;</span>&nbsp;<span class="hl_function"><b>option</b></span>&nbsp;<span class="hl_char">(</span>optimize&nbsp;for&nbsp;size&nbsp;only<span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
Так что, бывает всяко...<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338468&amp;user=35473&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=15" class="addthx" data-post="338468"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=32706" title="20-02-2014 13:14, ранг:12.4" target="_blank">Wagos</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 21:56 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>dosprog пишет: так та глючит после компиляции на всей линейке MSVC 2..6 </I><br><br>Отладка студийных приложений и отладка делфи\билдер сильно отличается, во втором все проще из за информативности самого компилятора.<br>Лично мне для отладки таких багов хватает EurekaLog и AQtime, остальную мелочь показывает сам компиль.<br>В какой то версии студии был баг с разбором свитча, часть выкидывалось, нормально работало только с выключенным оптимизатором.<br>Хотя такие баги компиля редкость, зачастую ошибки алгоритмические, если в цикле приходится выделять и освобождать память, то стоит пересмотреть алгоритм, так ли это обязательно, поскольку довольно дорогая операция и довольно легко сделать баги.<br>У многих патологическое пристрастие экономить на спичках, при этом не замечая бревен.<br>Часто вижу вопрос - какой выбрать алгоритм хеширования, что бы избежать коллизий ( хэши для файлов ), пилять, какая тут разница, если подсчет хэша ничто по сравнению с чтением файла в память.<br>Это к тому, что иногда полезно пересмотреть алгоритмы, а не подпирать костылями из дефайнов и хаков.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338470&amp;user=6&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=16" class="addthx" data-post="338470"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 22:03 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>F_a_u_s_t</b>,<br>Билдер вообще меня доводил до исступления своими багами. Там их половина из-за ilink.exe.<br>Поэтому лежит у меня BC 5.1 (<b>не 5.2!</b>) . А билдера нету вовсе.<br>MSVC корректнее в разы работает, как трактор. Но бывают и там чудеса (как в примере выше). <br>Согласен, что зачастую помогает исправление <b>или изменение</b> алгоритма. <br>Всё это хорошо работает, если нет глюков при компиляции/трансляции. А у меня уже патологическая боязнь их.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338472&amp;user=35473&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=17" class="addthx" data-post="338472"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2014 22:09 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>dosprog пишет: Билдер вообще меня доводил до исступления своими багами.  </I><br><br>Старого билдера уже нет, сейчас clang с хаками для vcl, которые по прежнему с багами, которые никто не правит, кроме комьюнити.<br>Политика борланда\кодегира\эмбарко мне чем то напоминает политику Ильфака, с той лишь разницей, что в жопу не посылают прямым текстом, баглисты годами весят в неизменном виде и по большей части правятся компоненто писателями ( если VCL ), а так, появляются новые фичи, но толку с поддержки iOS если компилятор говно и приложение не пройдет ревью, фич много, а работает все через жопу, хороший пример хорошей идеи с хреновой реализацией. <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338473&amp;user=6&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=18" class="addthx" data-post="338473"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Wagos[/b]','')">Wagos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.9'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32706">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2014 07:30 &middot; Поправил: Wagos <br><script type="text/javascript">QU('Wagos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wagos" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Установка FastMM результата не дала. CodeGuard молчит. Попробую что-нибудь увидеть с помощью Eurekalog (пока не получается включить опцию &quot;утечки памяти&quot;, но решение есть). Ещё есть мысль использовать __fastcall&#039;ы - попробую - отпишусь.<br>Любопытства ради посмотрел через PEiD версию компилятора. &quot;Borland C++ 1999&quot;. Может, конечно, подмена сигнатур, но иногда действительно кажется, что компилятор не обновлялся 15 лет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338484&amp;user=32706&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=19" class="addthx" data-post="338484"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2014 08:14 &middot; Поправил: F_a_u_s_t <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>Wagos пишет: Eurekalog (пока не получается включить опцию &quot;утечки памяти&quot;, но решение есть). </I><br>Статья <noindex><a href="http://www.gunsmoker.ru/2009/05/blog-post_24.html" rel="nofollow" target="_blank">Ищем утечки памяти</a></noindex>.<br><br><I>Wagos пишет: Любопытства ради посмотрел через PEiD версию компилятора. &quot;Borland C++ 1999&quot;.  </I><br>Сигнатура кривая, компилятор обновлялся, но кодогенератор это не особо затронуло, а в самом же компиляторе обновлений много, в первую очередь это поддержка стандарта, хотя сам компилятор старый, на базе Clang только x64 версия.<br>Пруф: хоть бы свежим GCC собрали, версия 4.2 древняя, как говно мамонта.<br><noindex><a href="http://fastpic.ru/" rel="nofollow" target="_blank"> <img src="http://i59.fastpic.ru/big/2014/0220/1d/3f8570f9c94b4adbaf95912d7a8cce1d.jpg" border="0" align="" alt=""></a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338485&amp;user=6&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=20" class="addthx" data-post="338485"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Wagos[/b]','')">Wagos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.9'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32706">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 февраля 2014 19:15 &middot; Поправил: Wagos <br><script type="text/javascript">QU('Wagos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wagos" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>F_a_u_s_t</b>, Спасибо за статью. Хорошая. Пока решил проблему уменьшением количества функций - скоро проект сдавать. Если ещё что-нибудь надумаю, напишу здесь.<br><br>Цикл вызова функций (Класс TStringList): Create -&gt; NewInstance -&gt; GetMem -&gt; FastGetMem (Функция FMM. Здесь, видимо, получается разрешение на использование ранее выделенной памяти) -&gt; InitInstance (Окончательно забивается моя память всякой не нужной мне х@@нёй с помощью инструкции rep stosd).<br><br>Ещё раз проштудировал код. Затираемый элемент находится в массиве структур, выделенный с помощью malloc и дальнейшим realloc (Векторы ненавижу, а для расширения массива не хотелось производить махинации с new - delete). Возможно, проблема в том, что данная память не заблокирована Виндой.<br><br>Ещё одно наблюдение. При выделении памяти в конструкторе класса, все идет нормально. Если выделять память в методе данного класса, начинается волшебство.<br><br>Увеличение размера кучи и стека - также не дало эффекта. Любит менеджер памяти выделять память в моей структуре.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338588&amp;user=32706&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=21" class="addthx" data-post="338588"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Wagos[/b]','')">Wagos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 17.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.9'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32706">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2014 23:05 <br><script type="text/javascript">QU('Wagos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wagos" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22603.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Ребята, проблема решена! Решением является выделение памяти в глобальной куче с помощью функций GlobalAlloc, GlobalLock, GlobalReAlloc и GlobalFree. В этом случае все работает корректно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=338661&amp;user=32706&amp;forum_n=6&amp;topic=22603.html&amp;page=0&amp;anchor=22" class="addthx" data-post="338661"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Затирание переменных, объявленных в куче</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#23" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="22603">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22603" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
