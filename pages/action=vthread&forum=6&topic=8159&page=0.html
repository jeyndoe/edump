<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>MouseClick на item в ListView - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="есть контрол SysListView32. как послать месседж MouseClick айтему с определенным индексом в этом контролле? можно не по индексу, но главное чтобы послать месседж конкретному айтему. другими словами как эмулировать клик мышкой по">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=39467'>hgdagon</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> MouseClick на item в ListView</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]egorovshura[/b]','')">egorovshura</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 122.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.43'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1227">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 01:08 <br><script type="text/javascript">QU('egorovshura','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=egorovshura" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
есть контрол SysListView32. как послать месседж MouseClick айтему с определенным индексом в этом контролле? можно не по индексу, но главное чтобы послать месседж конкретному айтему.<br>другими словами как эмулировать клик мышкой по айтему в лист вью?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127098&amp;user=1227&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=1" class="addthx" data-post="127098"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Icelot[/b]','')">Icelot</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/10492.jpg" alt=""><br><span class=txtSm>Ранг: 85.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10492">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 09:35 <br><script type="text/javascript">QU('Icelot','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Icelot" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Можно вычислить положение итема и сделать так:<br>//переместили:<br>mouse_event(mouseeventf_absolute or mouseeventf_move, X, Y, 0, 0);<br>//надавили:<br>mouse_event(mouseeventf_absolute or mouseeventf_leftdown, X, Y, 0, 0);<br>//отпустили<br>mouse_event(mouseeventf_absolute or mouseeventf_leftup, X, Y, 0, 0);<br>Но это если поприкалываться хочешь <img src="img/smilies/s1.gif" alt=""> И если окно активно. Я ведь так понял ты не в своем приложении нажатие эмулировать собираешься.<br>А так, надо получить хендл итема и отправить ему смску ))) с текстом WM_LBUTTONDOWN помоему..
<br><br><font size="1"><i>-----<br> radio uno in ibisa ...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=127122&amp;user=10492&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=2" class="addthx" data-post="127122"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]egorovshura[/b]','')">egorovshura</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 122.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.43'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1227">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 10:47 <br><script type="text/javascript">QU('egorovshura','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=egorovshura" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
точно не в своем хочу. в том то и проблема, что непонятно как получить хендл итема. хендл лист вью - пожалуйста, а хендл итема не знаю как. да и твой вариант не сработает, если итем будет находиться вне видимости, то есть нужно сначала проскроллить. но я точно заню, что можно послать событие именно определенному итему. видел прогу которая так делает. только вот посмотреть как именно она это делает дюже сложно
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127129&amp;user=1227&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=3" class="addthx" data-post="127129"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Icelot[/b]','')">Icelot</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/10492.jpg" alt=""><br><span class=txtSm>Ранг: 85.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10492">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 11:00 <br><script type="text/javascript">QU('Icelot','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Icelot" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
hParent    := FindWindow    (PChar(&#039;WinClass&#039;),PChar(&#039;WinName&#039;));<br> hListView := FindWindowEx(hParent, 0, PChar(&#039;TListView&#039;), nil);<br> hItem       :=  FindWindowEx( hListView, 0, PChar(&#039;TListItems&#039;), nil{или текст из итема - х.з.});<br>Не знаю будет ли работать - просто предположение.
<br><br><font size="1"><i>-----<br> radio uno in ibisa ...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=127131&amp;user=10492&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=4" class="addthx" data-post="127131"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]egorovshura[/b]','')">egorovshura</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 122.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.43'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1227">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 11:11 <br><script type="text/javascript">QU('egorovshura','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=egorovshura" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
я так понимаю что итем в листе не является окном. сейчас проверить просто не могу этот код. дома вечерком посмотрю, но думаю все таки что это не сработает, там скорее всего событие надо слать именно лист вью
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127135&amp;user=1227&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=5" class="addthx" data-post="127135"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Icelot[/b]','')">Icelot</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/10492.jpg" alt=""><br><span class=txtSm>Ранг: 85.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10492">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 11:25 <br><script type="text/javascript">QU('Icelot','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Icelot" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>egorovshura пишет:<br>но думаю все таки что это не сработает </I><br>мне тож так кажется..<br><I>egorovshura пишет:<br>там скорее всего событие надо слать именно лист вью </I><br>По этому поводу не знаю.. Я даже придумать такого события не могу =)
<br><br><font size="1"><i>-----<br> radio uno in ibisa ...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=127139&amp;user=10492&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=6" class="addthx" data-post="127139"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Gelios[/b]','')">Gelios</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 39.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=156">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 11:29 <br><script type="text/javascript">QU('Gelios','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gelios" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
имхо у лист-айтемов нет хендлов. работа с ними осуществляется непосредственно через сам listview
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127140&amp;user=156&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=7" class="addthx" data-post="127140"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Icelot[/b]','')">Icelot</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/10492.jpg" alt=""><br><span class=txtSm>Ранг: 85.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10492">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 11:33 &middot; Поправил: Icelot <br><script type="text/javascript">QU('Icelot','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Icelot" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Gelios пишет:<br>имхо у лист-айтемов нет хендлов </I><br>нету нету<br><I>Gelios пишет:<br>работа с ними осуществляется непосредственно через сам listview </I><br>А как именно?<br>Я думаю надо посылать сообщение WM_LBUTTONDOWN самому листу, но с определенными координатами..
<br><br><font size="1"><i>-----<br> radio uno in ibisa ...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=127142&amp;user=10492&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=8" class="addthx" data-post="127142"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Icelot[/b]','')">Icelot</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/10492.jpg" alt=""><br><span class=txtSm>Ранг: 85.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10492">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 12:02 <br><script type="text/javascript">QU('Icelot','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Icelot" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
вот:<br>BOOL ListView_GetItemPosition(<br><br>    HWND hwnd, 	<br>    int i, 	<br>    POINT FAR *ppt	<br>   );<br>или смской:<br>LVM_GETITEMPOSITION  <br>wParam = (WPARAM) (int) i; <br>lParam = (LPARAM) (POINT FAR *) ppt;
<br><br><font size="1"><i>-----<br> radio uno in ibisa ...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=127148&amp;user=10492&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=9" class="addthx" data-post="127148"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]egorovshura[/b]','')">egorovshura</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 122.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.43'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1227">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 12:16 <br><script type="text/javascript">QU('egorovshura','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=egorovshura" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>Icelot</b><br>не получится, если нужно проскролить, для того чтобы итем оказался в видимой обласи
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127151&amp;user=1227&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=10" class="addthx" data-post="127151"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]drunk_master[/b]','')">drunk_master</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.2 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.4'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9998">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 12:23 <br><script type="text/javascript">QU('drunk_master','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=drunk_master" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
скорее всего координаты надо мониторить, а вот еще дебильный вариант:<br>LRESULT SendMessage(<br><br>    HWND hWnd,	// handle of destination window<br>    UINT Msg,	// message to send<br>    WPARAM wParam,	// first message parameter<br>    LPARAM lParam 	// second message parameter<br>   );	<br> <br><br>Parameters<br><br>hWnd<br><br>Identifies the window whose window procedure will receive the message. If this parameter is HWND_BROADCAST, the message is sent to All top-level windows in the system, including disabled or invisible unowned windows, overlapped windows, and pop-up windows; but the message is not sent to child windows.<br><br>;############################################
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127153&amp;user=9998&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=11" class="addthx" data-post="127153"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Icelot[/b]','')">Icelot</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/10492.jpg" alt=""><br><span class=txtSm>Ранг: 85.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10492">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 12:55 <br><script type="text/javascript">QU('Icelot','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Icelot" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>egorovshura пишет:<br>не получится, если нужно проскролить, для того чтобы итем оказался в видимой обласи </I><br>это сложнее =) Если придумаешь напиши пожалуйста - хотелось бы глянуть..
<br><br><font size="1"><i>-----<br> radio uno in ibisa ...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=127159&amp;user=10492&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=12" class="addthx" data-post="127159"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]AlCr0[/b]','')">AlCr0</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9696">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 13:57 <br><script type="text/javascript">QU('AlCr0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlCr0" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
А что из себя итемы представляют?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127163&amp;user=9696&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=13" class="addthx" data-post="127163"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 14:09 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>egorovshura пишет:<br>видел прогу которая так делает. только вот посмотреть как именно она это делает дюже сложно </I><br><br>А ты натрави какой нибудь MS Spy++ на ту прогу или на сам листвьюв и посмотри что и куда шлётся...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127165&amp;user=702&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=14" class="addthx" data-post="127165"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Icelot[/b]','')">Icelot</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/10492.jpg" alt=""><br><span class=txtSm>Ранг: 85.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10492">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 14:14 <br><script type="text/javascript">QU('Icelot','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Icelot" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>ToBad пишет:<br>А ты натрави какой нибудь MS Spy++ на ту прогу или на сам листвьюв и посмотри что и куда шлётся... </I><br>Или дай ссылку!
<br><br><font size="1"><i>-----<br> radio uno in ibisa ...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=127167&amp;user=10492&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=15" class="addthx" data-post="127167"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]egorovshura[/b]','')">egorovshura</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 122.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.43'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1227">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 15:03 <br><script type="text/javascript">QU('egorovshura','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=egorovshura" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>ToBad</b><br>пробовал, но там лист вью очень часто обновляется куча второстепенной инфы - хрен найдешь. пытался сделать свое приложение с листвью, вроде начал на дельфе делать, но потом вспомнил, что дельфа стандартные win компоненты не пользует, а сама все рисует. начал на MFC делать, да так и не доделал. не дружу я с ним. плюнул и тут спросил
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127187&amp;user=1227&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=16" class="addthx" data-post="127187"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]AlCr0[/b]','')">AlCr0</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9696">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 16:43 <br><script type="text/javascript">QU('AlCr0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlCr0" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>egorovshura</b><br>Действительно. Что за прога? Что такое эти итемы? если они в твоей программе не являются окнами (набор данных, которые самим SysListView32 просто отображаются) - как ты ИМ сообщения хочешь отправить?<br>Конкретнее. <br><br>Или - &quot;Ссылку в студию!!&quot; <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127208&amp;user=9696&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=17" class="addthx" data-post="127208"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]rep0A[/b]','')">rep0A</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 88.0 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.53'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1036">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 17:45 <br><script type="text/javascript">QU('rep0A','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rep0A" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
NMHDR nmhdr;<br>nmhdr.code = NM_CLICK;<br>SendMessage(hWndOfSysView, WM_NOTIFY, idCtrl, &amp;nmhdr);
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127215&amp;user=1036&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=18" class="addthx" data-post="127215"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 марта 2007 23:53 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>Icelot пишет:<br>Или дай ссылку! </I><br><br>Тут много всего, хотя самого MSSpy+ нету. Если нужен конкретно он, скинь своё мыло в личку.<br>h..p://www.wasm.ru/toollist.php?list=4
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127284&amp;user=702&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=19" class="addthx" data-post="127284"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]egorovshura[/b]','')">egorovshura</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 122.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.43'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1227">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 марта 2007 02:25 <br><script type="text/javascript">QU('egorovshura','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=egorovshura" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>rep0A пишет:<br>NMHDR nmhdr; <br>nmhdr.code = NM_CLICK; <br>SendMessage(hWndOfSysView, WM_NOTIFY, idCtrl, &amp;nmhdr); </I><br><br>Че то нифига не работает. А ты пробовал сам или просто предположение?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127294&amp;user=1227&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=20" class="addthx" data-post="127294"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]rep0A[/b]','')">rep0A</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 88.0 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.53'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1036">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 марта 2007 18:05 <br><script type="text/javascript">QU('rep0A','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rep0A" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>egorovshura</b><br>предположение. а ты что в idCtrl указываешь? idCtrl не порядковый номмер итема (как узнать зная порядковый номмер не знаю -&gt; msdn).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127403&amp;user=1036&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=21" class="addthx" data-post="127403"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]egorovshura[/b]','')">egorovshura</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 122.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.43'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1227">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 марта 2007 19:07 <br><script type="text/javascript">QU('egorovshura','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=egorovshura" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>rep0A</b><br>idCtrl  на самом деле ID ListView. Просто когда событие обрабатывается приложение может как я понял получить и WindowHandle и WIndowID. А номер итема в структуре передаваемой в качестве параметра события указывается
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127413&amp;user=1227&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=22" class="addthx" data-post="127413"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]-=The Bone=-[/b]','')">-=The Bone=-</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.35'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=10355">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 марта 2007 21:49 <br><script type="text/javascript">QU('-=The Bone=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=The Bone=-" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Ага, и этот номер (если нет свойства sort) - порядковый (начинаются, наверное, с 0, по аналогии с ListBox). Попробуй просто посчитать порядковый номер итема (либо посмотри в дебагере, какой у итема получается номер создания) и послать по этому номеру сначало ListView_SetItemState с параметром LV_ITEM-&gt;state=LVIS_SELECTED а потом WM_CHAR(enter)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127445&amp;user=10355&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=23" class="addthx" data-post="127445"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]rep0A[/b]','')">rep0A</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 88.0 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.53'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1036">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 марта 2007 22:15 <br><script type="text/javascript">QU('rep0A','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rep0A" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
Специально сделал листбокс и посмотрел: во всех итемах idCtrl 190, чтото не очень похоже на номер, темболее порядковый.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127452&amp;user=1036&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=24" class="addthx" data-post="127452"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 марта 2007 02:33 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
Меня эта тема тоже волнует ))) есть урок на Масме 9 там лист вью где при клике мессадж бокс вылетает ))) щас посмотрю сам ...я тож начал смотреть а тут на те ...уже тема есть
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=127471&amp;user=3520&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=25" class="addthx" data-post="127471"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]-=The Bone=-[/b]','')">-=The Bone=-</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.35'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=10355">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2007 21:20 &middot; Поправил: -=The Bone=- <br><script type="text/javascript">QU('-=The Bone=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=The Bone=-" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>To All</I><br>Из win32sdk:<br><br><i class=x>The application fills in an LV_ITEM structure and adds a list view item by using the LVM_INSERTITEM message.</i><br><i class=x>The LV_ITEM structure defines a list view item or subitem. The <b>iItem</b> member is the zero-based index of the item. The iSubItem member is the one-based index of a subitem or zero if the structure contains information about an item.</i><br>Что означает, <b>rep0A</b>, попробуй в цикл for заполнять LV_ITEM и делать LVM_INSERTITEM<br><br>Кстати, в примере в SDK делают именно так.<br><br>Т. е. надо ловить создание конкретного итема и запоминать его iItem, и уже от него плясать
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127746&amp;user=10355&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=26" class="addthx" data-post="127746"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]rep0A[/b]','')">rep0A</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 88.0 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.53'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1036">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2007 23:23 <br><script type="text/javascript">QU('rep0A','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rep0A" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
вот тоже почитал msdn и увидел одну интересную вещь:<br>For a list-view control, send structure NMITEMACTIVATE.<br><br>значит надо слать сообщение  гдето так:<br><br>NMITEMACTIVATE nmia;<br>nmia.hdr.code = NM_CLICK;<br>nmia.iItem = iItem; //порядковый номер айтема<br>SendMessage(hWnd, WM_NOTIFY, idCtrl, &amp;nmia);<br><br><b>-=The Bone=-</b><br>так и делал, но idCtrl != iItem.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127757&amp;user=1036&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=27" class="addthx" data-post="127757"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]rmn[/b]','')">rmn</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 158.4 (ветеран), 123thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.28'>Активность: 0.14<span style='color:green'>&nearr;</span>0.49</span><br>Статус: <a href="action=userinfo&amp;user=1533">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 марта 2007 10:34 <br><script type="text/javascript">QU('rmn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rmn" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
WM_NOTIFY посылается самим listview родительскому окну, а не наоборот.<br><br>По сабжу: <br>сначала отправляем listview сообщение LVM_ENSUREVISIBLE, он проскроллит итемы так, чтобы нужный нам стал видимым. <br>Потом отправляем LVM_GETITEMRECT, чтобы получить границы конкретного итема.<br>После этого помещаем курсор над итемом (SetCursorPos) и отправляем listview сообщения WM_LBUTTONDOWN/WM_LBUTTONUP.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127799&amp;user=1533&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=28" class="addthx" data-post="127799"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]egorovshura[/b]','')">egorovshura</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 122.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.43'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1227">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 марта 2007 11:39 <br><script type="text/javascript">QU('egorovshura','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=egorovshura" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<b>rmn</b><br>Вот это работает. Спасибки!<br><br>интересно, а с нотифайями вообще возможно что-то сделать
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127803&amp;user=1227&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=29" class="addthx" data-post="127803"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Icelot[/b]','')">Icelot</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/10492.jpg" alt=""><br><span class=txtSm>Ранг: 85.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10492">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 марта 2007 13:00 <br><script type="text/javascript">QU('Icelot','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Icelot" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8159.html&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<I>rmn пишет:<br>После этого помещаем курсор над итемом (SetCursorPos) и отправляем listview сообщения WM_LBUTTONDOWN/WM_LBUTTONUP. </I><br>Зачем тревожить курсор, если можно WM_LBUTTONхххх с определенными координатами.
<br><br><font size="1"><i>-----<br> radio uno in ibisa ...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=127810&amp;user=10492&amp;forum_n=6&amp;topic=8159.html&amp;page=0&amp;anchor=30" class="addthx" data-post="127810"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> MouseClick на item в ListView</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="8159">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=8159" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
