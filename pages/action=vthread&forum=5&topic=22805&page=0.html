<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Не могу выполнить свой код во время выбора имени для сохраняемого файла в &quot;notepad.exe&quot; - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Приветствую. Задача -- выполнить свой код во время выбора имени для сохраняемого файла в &quot;notepad.exe&quot;. Диалоговое окно, которое за это отвечает, вызывается при помощи WinAPI-функции GetSaveFileName. Что ж, открываю">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Не могу выполнить свой код во время выбора имени для сохраняемого файла в &quot;notepad.exe&quot;</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2014 14:25 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22805.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Приветствую.<br><br>Задача -- выполнить свой код во время выбора имени для сохраняемого файла в &quot;notepad.exe&quot;. Диалоговое окно, которое за это отвечает, вызывается при помощи WinAPI-функции GetSaveFileName. Что ж, открываю OllyDbg v2.01 -&gt; нажимаю Ctrl-N -&gt; ищу в списке импортированных функций GetSaveFileNameW -&gt; Ctrl-R -&gt; ставлю бряк на единственном месте, в котором происходит обращение к данной функции -&gt; нажимаю F9 -&gt; нажимаю Ctrl-S в запустившемся процессе, ввожу имя файла и нажимаю &quot;Enter&quot; -&gt; бряк не срабатывает.<br><br>В чём дело? Что я могу делать не так?<br><br>Исполняемый файл &quot;notepad.exe&quot; брал из Windows Server 2012 R2 Datacenter, лежал в директории &quot;C:\Windows\SysWOW64&quot;.<br><br>Заранее благодарю за возможные ответы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342139&amp;user=37421&amp;forum_n=5&amp;topic=22805.html&amp;page=0&amp;anchor=1" class="addthx" data-post="342139"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2014 14:44 <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22805.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>b0r3d0m</b><br>поставьте бряки не на переходники, а на сами функции GetSaveFileNameA/W и изучайте адреса возврата<br>если не сработало - хотя бы приложите подопытный файл. не у всех здесь под рукой  имеется <I>Windows Server 2012 R2 Datacenter</I>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342141&amp;user=26242&amp;forum_n=5&amp;topic=22805.html&amp;page=0&amp;anchor=2" class="addthx" data-post="342141"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=37421" title="26-05-2014 17:16, ранг:1.2" target="_blank">b0r3d0m</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2014 15:03 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22805.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>поставьте бряки не на переходники, а на сами функции GetSaveFileNameA/W и изучайте адреса возврата </I><br>Попробовал -- то же самое.<br><br><I>-=AkaBOSS=- пишет:<br>если не сработало - хотя бы приложите подопытный файл </I><br>Прикладываю.<br><br><img src="img/attach.gif" alt=""> <a href="./files/a2ad_25.05.2014_EXELAB.rU.tgz">a2ad_25.05.2014_EXELAB.rU.tgz</a> - notepad.exe
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342142&amp;user=37421&amp;forum_n=5&amp;topic=22805.html&amp;page=0&amp;anchor=3" class="addthx" data-post="342142"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2014 19:25 &middot; Поправил: ELF_7719116 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22805.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>Задача -- выполнить свой код во время выбора имени для сохраняемого файла в &quot;notepad.exe&quot;. </I><br>Сама по себе, какая-то странная задача. Впрочем, дело Ваше.<br><I>b0r3d0m пишет:<br>Исполняемый файл &quot;notepad.exe&quot; брал из Windows Server 2012 R2 Datacenter </I><br>Не знаю, как там в 2k12, а в блокноте на 2k3 server <i class=x>GetSaveFileNameW</i> нормально ловится. По крайней мере можно поставить бряк на <i class=x>CreateFileW</i> и наверняка получить результат.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342148&amp;user=26651&amp;forum_n=5&amp;topic=22805.html&amp;page=0&amp;anchor=4" class="addthx" data-post="342148"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=37421" title="26-05-2014 17:16, ранг:1.2" target="_blank">b0r3d0m</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2014 19:37 &middot; Поправил: b0r3d0m <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22805.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>Сама по себе, какая-то странная задача. Впрочем, дело Ваше </I><br>Конечная задача, разумеется, не такая, но для её решения надо разобраться хотя бы с этим.<br><br><I>ELF_7719116 пишет:<br>Не знаю, как там в 2k12, а в блокноте на 2k3 server GetSaveFileNameW нормально ловится </I><br>Странно. Нет, я не спорю, что 99%, что туплю я, а не OllyDbg, но всё равно.<br><br><I>ELF_7719116 пишет:<br>По крайней мере можно поставить бряк на CreateFileW и наверняка получить результат </I><br>Ну, CreateFileW я не проверял, но GetSaveFileNameW упорно не получается поймать.<br><br>А Вы не могли бы посмотреть файл, который я приложил к своему предыдущему сообщению, пожалуйста? Ничего туда не вшивал, при желании могу выложить результаты сканирования на virustotal и virusscan.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342150&amp;user=37421&amp;forum_n=5&amp;topic=22805.html&amp;page=0&amp;anchor=5" class="addthx" data-post="342150"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2014 19:53 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22805.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>Ну, CreateFileW я не проверял </I><br>ну дык, проверьте.<br><I>b0r3d0m пишет:<br>А Вы не могли бы посмотреть файл </I><br>например мне, чтоб запустить exe&#039;шник с 2k12 на 2k3 - нужно нехило извратиться с недостающими WinAPI (FindNLSString и тд). <br>зы: Неужели принципиально, чтоб ексешник был 2k12, возьмите XP или 2k3 и пачьте - блокнот он и в Африке блокнот.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342152&amp;user=26651&amp;forum_n=5&amp;topic=22805.html&amp;page=0&amp;anchor=6" class="addthx" data-post="342152"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=35741" title="26-05-2014 11:59, ранг:0.2" target="_blank">_FUCKER_</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2014 21:16 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22805.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>зы: Неужели принципиально, чтоб ексешник был 2k12, возьмите XP или 2k3 и пачьте - блокнот он и в Африке блокнот.  </I><br>Думаю, что так и сделаю, но вопрос-то всё равно останется -- это я что-то делаю не так или наткнулся на какое-то неочевидное поведение отладчика?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342155&amp;user=37421&amp;forum_n=5&amp;topic=22805.html&amp;page=0&amp;anchor=7" class="addthx" data-post="342155"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2014 21:20 <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22805.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>b0r3d0m</b><br>очень похоже на то, что API тут вообще не используется, а вызов диалога идёт через COM<br>{C0B4E2F3-BA21-4773-8DBA-335EC946EB8B}  File Save Dialog<br>попробуйте проверить дебаггером адрес 4127D2. после вызова должно появиться искомое окно
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342156&amp;user=26242&amp;forum_n=5&amp;topic=22805.html&amp;page=0&amp;anchor=8" class="addthx" data-post="342156"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2014 21:25 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22805.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>очень похоже на то, что API тут вообще не используется, а вызов диалога идёт через COM </I><br>А как Вы это поняли, если не секрет?<br><br><I>-=AkaBOSS=- пишет:<br>попробуйте проверить дебаггером адрес 4127D2 </I><br>OllyDbg v2.01 говорит, что такого адреса нет (Ctrl-G -&gt; 4127D2).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342157&amp;user=37421&amp;forum_n=5&amp;topic=22805.html&amp;page=0&amp;anchor=9" class="addthx" data-post="342157"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2014 21:33 <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22805.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>А как Вы это поняли, если не секрет </I><br>сталкивался уже с такими непонятными диалогами пару раз<br>прогуглил GUID и нашёл его в модуле<br><br><I>b0r3d0m пишет:<br>адреса нет (Ctrl-G -&gt; 4127D2).  </I><br>вероятно, модуль загрузился по другому адресу.<br>нужный адрес = rva 127D2 + базовый адрес загрузки модуля
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342158&amp;user=26242&amp;forum_n=5&amp;topic=22805.html&amp;page=0&amp;anchor=10" class="addthx" data-post="342158"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]_FUCKER_[/b]','')">_FUCKER_</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 19.2 (новичок), 12thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.84'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=35741">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2014 16:03 <br><script type="text/javascript">QU('_FUCKER_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=_FUCKER_" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22805.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Ни на Win8.1x64, ни на XP.SP3.x32 запустить цель не удалось. Там явная херня с экзешником. Мог-бы хоть выбрать ту цель, которая у всех работать будет
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342190&amp;user=35741&amp;forum_n=5&amp;topic=22805.html&amp;page=0&amp;anchor=11" class="addthx" data-post="342190"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2014 17:22 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22805.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>_FUCKER_ пишет:<br>ни на XP.SP3.x32 запустить цель не удалось. </I><br>На XP оно принципиально не стартанет, ибо оригинальная <b>SubSustemVersion</b> = 6.2 <br><I>_FUCKER_ пишет:<br>Там явная херня с экзешником </I><br>Вроде <b>SizeofImage</b> надо поправить (я в PeTools пересчитал), вероятно файло автор уже выложил после проведенной экзекуции.<br><br>Но я, в любом случае, не понимаю, зачем тс нужен <i class=x>GetSaveFileNameW</i> и после него еще и код выполнить (разве что, вместо <i class=x>.txt</i>, чтоб блокнот сохранял <i class=x>.exe</i> файлы с исполняемым кодом, что как-бы намекает). Тем более <br><I>b0r3d0m пишет:<br>OllyDbg v2.01 говорит, что такого адреса нет (Ctrl-G -&gt; 4127D2). </I><br>не может найти, где у него образ в памяти(впрочем, для тех кто до сих пор не знает - Alt+M).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342193&amp;user=26651&amp;forum_n=5&amp;topic=22805.html&amp;page=0&amp;anchor=12" class="addthx" data-post="342193"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2014 17:49 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22805.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>_FUCKER_</b>, <b>ELF_7719116</b><br>да не напрягайтесь вы, ТС уже узнал то, что хотел<br>у него просто нет привычки закрывать за собой тему<br>равно как и объяснять, за каким чёртом он делает то что делает - см. его предыдущую тему про run dialog<br><br><I>ELF_7719116 пишет:<br>вероятно файло автор уже выложил после проведенной экзекуции. </I><br>файл похож на оригинальный - <noindex><a href="https://www.virustotal.com/ru/file/0561eae447aa7a36ed3822a3950bbbfacf68c4227513f90269a8be01f35d4c80/analysis/" rel="nofollow" target="_blank">я прогнал его MD5 через вирустотал</a></noindex>:<br>First submission 2013-09-26 20:36:34 UTC (8 месяцев назад)<br>Last submission 2014-05-18 14:15:38 UTC (1 неделя назад) <br><br>файл с таким хэшем уже сканили, и не раз
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342194&amp;user=26242&amp;forum_n=5&amp;topic=22805.html&amp;page=0&amp;anchor=13" class="addthx" data-post="342194"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2014 21:15 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22805.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>сталкивался уже с такими непонятными диалогами пару раз<br>прогуглил GUID и нашёл его в модуле </I><br>Ясно, спасибо.<br><br><I>-=AkaBOSS=- пишет:<br>вероятно, модуль загрузился по другому адресу.<br>нужный адрес = rva 127D2 + базовый адрес загрузки модуля  </I><br>Понятно, буду смотреть.<br><br><I>_FUCKER_ пишет:<br>Там явная херня с экзешником </I><br>Не знаю, что именно Вы под этим подразумеваете, но выложенный исполняемый файл был без каких-либо изменений, все эксперименты я провожу над копиями.<br><br><I>-=AkaBOSS=- пишет:<br>у него просто нет привычки закрывать за собой тему </I><br>Просто пока ещё не проверил на практике. Думаю, вопросы ещё найдутся.<br><br><I>-=AkaBOSS=- пишет:<br>равно как и объяснять, за каким чёртом он делает то что делает </I><br>Ответил в ПМ.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342204&amp;user=37421&amp;forum_n=5&amp;topic=22805.html&amp;page=0&amp;anchor=14" class="addthx" data-post="342204"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Не могу выполнить свой код во время выбора имени для сохраняемого файла в &quot;notepad.exe&quot;</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#15" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="22805">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22805" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
