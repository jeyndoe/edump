<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Распаковка файлов из контейнеров SFFS - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="upd: Новый адрес Релизы ---------------------------------- Утилита для распаковки файлов из контейнеров SFFS В принципе все то же самое что сделали Reloaded и Olenevod хз-когда но теперь в GUI  Как это работет: - перетаскиваем">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a>, <a target='_blank' href='?action=userinfo&amp;user=33192'>morgot</a>, <a target='_blank' href='?action=userinfo&amp;user=54646'>sashalogout</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка файлов из контейнеров SFFS</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=22923&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=22923&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=3&amp;topic=22923&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=3&amp;topic=22923&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]vden[/b]','')">vden</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 112.9 (ветеран), 186thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.22'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=28841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 июня 2014 14:42 &middot; Поправил: vden <br><script type="text/javascript">QU('vden','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vden" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
upd:<br><noindex><a href="https://github.com/vdisasm/SFFS-Unpacker" rel="nofollow" target="_blank">Новый адрес</a></noindex><br><noindex><a href="https://github.com/vdisasm/SFFS-Unpacker/releases" rel="nofollow" target="_blank">Релизы</a></noindex><br><br>----------------------------------<br><br><noindex><a href="http://rghost.ru/private/56675461/c803358d09349d69cd470ee3c108f8f8" rel="nofollow" target="_blank">Утилита для распаковки файлов из контейнеров SFFS</a></noindex><br><br>В принципе все то же самое что сделали Reloaded и Olenevod хз-когда но теперь в GUI <img src="img/smilies/s1.gif" alt=""><br><br>Как это работет:<br><br>- перетаскиваем файл с ресурсами (*.dat) в окно<br><br>- вводим ПРАВИЛЬНЫЙ APPKEY (иначе расшифровка не пройдет, и может быть крэш)<br>  APPKEY можно получить снифером (есть на форуме)<br><br>- получаем хэши для каждого файла в контейнере<br>  без имен файлов содержимое файлов расшифровать не выйдет<br>  имена можно достать сниффером который есть на этом форуме, но он сработает только для латиницы<br>  в идеале нужен сниффер для 2-байтного юникода (UTF-16LE)<br><br>- жмем F5 и вводим имена файлов<br>  найденные имена добавляются в список и убираются из поля для ввода<br>  проект можно сохранять и добавлять имена позже<br><br>- на файле, для которого известно имя, щелкаем 2 раза, файл извлекается и открывается содержащая его папка<br><br>Основано на доках Reloaded. Главное отличие - код не рипался, потому что это Blowfish где каждый<br>блок хорится на позицию в файле.<br><br>Связанные материалы:<br><noindex><a href="http://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=0#24" rel="nofollow" target="_blank">Набор: драйвер для перехвата APPKEY и имен файлов (только латинские) от MasterSoft</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343908&amp;user=28841&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=1" class="addthx" data-post="343908"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=2585" title="30-06-2014 10:49, ранг:904.4" target="_blank">Gideon Vi</a>, <a href="action=userinfo&user=27422" title="30-06-2014 11:10, ранг:-7.7" target="_blank">unknownproject</a>, <a href="action=userinfo&user=26846" title="30-06-2014 11:36, ранг:18.4" target="_blank">kampaster</a>, <a href="action=userinfo&user=26651" title="30-06-2014 11:46, ранг:171.1" target="_blank">ELF_7719116</a>, <a href="action=userinfo&user=4093" title="30-06-2014 11:52, ранг:125.4" target="_blank">verdizela</a>, <a href="action=userinfo&user=3136" title="30-06-2014 11:58, ранг:284.1" target="_blank">Veliant</a>, <a href="action=userinfo&user=21408" title="30-06-2014 12:59, ранг:71.5" target="_blank">BAHEK</a>, <a href="action=userinfo&user=4618" title="30-06-2014 14:13, ранг:213.5" target="_blank">Nightshade</a>, <a href="action=userinfo&user=31142" title="30-06-2014 15:10, ранг:40.2" target="_blank">sivorog</a>, <a href="action=userinfo&user=1931" title="30-06-2014 15:48, ранг:578.4" target="_blank">4kusNick</a>, <a href="action=userinfo&user=6946" title="30-06-2014 16:00, ранг:665.4" target="_blank">Isaev</a>, <a href="action=userinfo&user=24946" title="30-06-2014 21:14, ранг:129.0" target="_blank">DimitarSerg</a>, <a href="action=userinfo&user=28512" title="30-06-2014 21:39, ранг:50.4" target="_blank">-Sanchez-</a>, <a href="action=userinfo&user=4109" title="01-07-2014 11:19, ранг:3.2" target="_blank">MarcElBichon</a>, <a href="action=userinfo&user=31325" title="03-07-2014 21:45, ранг:4.3" target="_blank">zNob</a>, <a href="action=userinfo&user=16624" title="02-06-2017 00:06, ранг:281.2" target="_blank">MasterSoft</a>, <a href="action=userinfo&user=35168" title="07-02-2020 17:40, ранг:78.0" target="_blank">v00doo</a>, <a href="action=userinfo&user=1928" title="28-06-2020 00:11, ранг:6.4" target="_blank">Jim DiGriz</a></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 08:54 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
Драйвер-фильтр на ФС там, насколько помню.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343993&amp;user=1556&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=2" class="addthx" data-post="343993"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 11:22 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
Есть 2 реализации СФФС. Одна драйвер фильтр. И там обычный CreateFile. Вторая бездрайверная. Там функи открытия, чтения и СетФайлПоинтер в protect.dll. И файлы открываются именно этими функами.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343994&amp;user=4618&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=3" class="addthx" data-post="343994"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=26651" title="01-07-2014 09:18, ранг:171.7" target="_blank">ELF_7719116</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 13:24 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
<b>Nightshade</b><br>ок, с этим понятно. Но я клоню немного к другому - из топиков выше, если правильно понимаю, есть проблема: от имен файлов в контейнере остались одни хэши. Обращения к этим файлам, по идее, же должны остаться в образе? Что мешает сопоставить вызов с именем файла - и его положение в контейнере? т.е. пойти другим путем, не используя брут: эдак заснифить имена?!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343996&amp;user=26651&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=4" class="addthx" data-post="343996"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 13:33 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
Эльф, если ты почитаешь предыдущую страницу, то найдешь сниффер имен файлов. (Правда только англ имен). Как ты думаешь, для чего его писали?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343997&amp;user=4618&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=5" class="addthx" data-post="343997"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 13:36 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>эдак заснифить имена?!  </I><br>Предлагаешь крякера в геймера переделать, было такое, что ресурс использовался только на предпоследнем уровне.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343999&amp;user=5291&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=6" class="addthx" data-post="343999"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 13:45 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<b>Nightshade</b><br><i class=x>...имен файлов (только латинские) от MasterSoft </i> - все, я прозрел<img src="img/smilies/s5.gif" alt=""><br><I>Vovan666 пишет:<br>Предлагаешь крякера в геймера переделать... </I><br>нет, геймеров сейчас и так целая армия. можно даже наоборот - создать тему в каком нить игровом комьюнити-сайте, <strike>с просьбой помочь пиратам</strike>, почувствовать себя крекером: желающие установят се сниффер, а после пришлют результаты. мож звучит банально, однако не стоит забывать, что желающих убить разрабов старфорса или хотя бы поднасрать им, в нашей стране предостаточно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=344000&amp;user=26651&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=7" class="addthx" data-post="344000"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]kampaster[/b]','')">kampaster</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.3 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 14:09 &middot; Поправил: kampaster <br><script type="text/javascript">QU('kampaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kampaster" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<b>ELF_7719116</b> это было туго<img src="img/smilies/s5.gif" alt=""><br>В том и проблема, можно отснифать имена, а можно и брутить.<br>Брутить мало реально, как писал выше.<br>Но, бывают редкие случаи когда очень даже реально и проще чем отснифать.<br>А чтобы отснифать имена - так это нужно всё игру пере пройти + доп квестики, скрытые уровни и т.п<br>В общем тоже муторно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=344002&amp;user=26846&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=8" class="addthx" data-post="344002"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 14:47 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
Для таких целей писали &quot;декодер на лету&quot;. Крепится длл с вшитым аппкеем. При попытке открыть несуществующий на диске файл, идет попытка извлечь его из контейнера. Если все удачно, открываем извлеченный файл. Такой декодер уже выкладывал Zorn в соседней ветке. <br>И не надо никаких драйверов, снифферов. Не надо проходить игру.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=344004&amp;user=4618&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=9" class="addthx" data-post="344004"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]kampaster[/b]','')">kampaster</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.3 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 15:19 &middot; Поправил: kampaster <br><script type="text/javascript">QU('kampaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kampaster" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
<I>Nightshade пишет:<br>Для таких целей писали &quot;декодер на лету&quot;. Крепится длл с вшитым аппкеем. </I><br>А разве перед этим не нужно стар снимать?<br><I>Nightshade пишет:<br>При попытке открыть несуществующий на диске файл, идет попытка извлечь его из контейнера. Если все удачно, открываем извлеченный файл. Такой декодер уже выкладывал Zorn в соседней ветке.  </I><br>1 фиг нужно будет проходить всю игру и ловить обращения к файлам.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=344005&amp;user=26846&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=10" class="addthx" data-post="344005"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 15:48 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
<I>Nightshade пишет:<br>И не надо никаких драйверов, снифферов. Не надо проходить игру. </I><br>Разве? Не все ли равно где снифать в ядре или в ring3? Все равно проходить игру придется.<br><br><I>kampaster пишет:<br>А разве перед этим не нужно стар снимать?  </I><br>Стару пофиг на смену entrypoint на другой адрес у protect.dll, и наличие чужих dll в памяти.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=344006&amp;user=3136&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=11" class="addthx" data-post="344006"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 15:58 &middot; Поправил: Nightshade <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
<b>Veliant</b> Читай полностью пост. Ты походу 1 фразу прочел.<br>Игру проходить не придется. На последнем уровне к примеру доизвлекутся новые файлы и все. Можно вообще написать перехват некоторых апи и расшифровывать содержимое файлов из контейнера.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=344007&amp;user=4618&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=12" class="addthx" data-post="344007"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 16:30 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>желающих убить разрабов старфорса или хотя бы поднасрать им, в нашей стране предостаточно </I><br><br>я уже не назову год, когда выходила последняя игра под старфорсом. К стати, если откинуть параноидальную третью версию, то четвертая, ни говоря уже о пятой, были в разы юзер-френдли, чем тот же стим. Их по крайней мере можно было активировать вообще без интернета и не запускать этот монструозный стим-клиент при каждом запуске игры.<br><br><I>Nightshade пишет:<br>При попытке открыть несуществующий на диске файл, идет попытка извлечь его из контейнера...Не надо проходить игру</I><br><br>я может туплю, но мне не понять, как спасает этот метод от шифрования файла, который требуется в середине/конце игры.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=344009&amp;user=2585&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=13" class="addthx" data-post="344009"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 16:36 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
<I>Gideon Vi пишет:<br>как спасает этот метод от шифрования файла, который требуется в середине/конце игры</I><br>Когда потребуется, тогда и будет расшифрован дополнительной длл, которая прицеплена к распакованному файлу, на момент начала игры тебе все расшифрованные файлы и не нужны.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=344010&amp;user=1556&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=14" class="addthx" data-post="344010"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 17:18 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
<b>Archer</b>, а, имеется ввиду распространение в таком виде конечному пользователю. Тоже выход, но антивирусы могут не оценить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=344015&amp;user=2585&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=15" class="addthx" data-post="344015"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]vden[/b]','')">vden</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 112.9 (ветеран), 186thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.22'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=28841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 17:46 &middot; Поправил: vden <br><script type="text/javascript">QU('vden','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vden" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
<noindex><a href="http://rghost.ru/private/56675461/c803358d09349d69cd470ee3c108f8f8" rel="nofollow" target="_blank">Обновил ссылку в шапке</a></noindex><br><br>- извлечение всех файлов<br>- применение атрибутов к файлам<br>- примениние времени создания, модификации к файлам<br>- правильная обработка FILE_ATTRIBUTE_DIRECTORY (просто создание папки)<br>- если файл уже есть и размер совпадает, то он пропускается<br>- можно отменить извлечение Esc<br><br><noindex><a href="https://ssl.exelab.ru/svn/sffsunp/" rel="nofollow" target="_blank">Сам проект</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=344017&amp;user=28841&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=16" class="addthx" data-post="344017"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=2585" title="01-07-2014 13:49, ранг:904.7" target="_blank">Gideon Vi</a>, <a href="action=userinfo&user=26846" title="01-07-2014 13:58, ранг:19.3" target="_blank">kampaster</a>, <a href="action=userinfo&user=1931" title="01-07-2014 17:12, ранг:578.4" target="_blank">4kusNick</a>, <a href="action=userinfo&user=18316" title="01-07-2014 18:32, ранг:171.8" target="_blank">SReg</a>, <a href="action=userinfo&user=4618" title="02-07-2014 03:43, ранг:214.4" target="_blank">Nightshade</a>, <a href="action=userinfo&user=6946" title="02-07-2014 06:02, ранг:666.6" target="_blank">Isaev</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]kampaster[/b]','')">kampaster</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.3 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.68'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2014 18:13 <br><script type="text/javascript">QU('kampaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kampaster" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
<b>vden</b><br>Спасибо!<br>Extract All работает корректно<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=344021&amp;user=26846&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=17" class="addthx" data-post="344021"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 июля 2014 19:34 &middot; Поправил: Nightshade <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
Что у тебя за делфя такая?<br>У меня не понимает, что такое FileName.ToUpper к примеру.<br>Я конечно могу переписать на стандартные функи. Но интересно же...<br>------------<br>У меня ХЕ3. Походу надо обновится.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=344060&amp;user=4618&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=18" class="addthx" data-post="344060"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]vden[/b]','')">vden</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 112.9 (ветеран), 186thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.22'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=28841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 июля 2014 19:51 &middot; Поправил: vden <br><script type="text/javascript">QU('vden','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vden" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
XE6. ToUpper это часть type helper&#039;a TStringHelper, появилась не так давно. Type helper это структура которая инжектится в другую структуру, сначала её сделали чтобы править свои же баги, а теперь это фича <img src="img/smilies/s1.gif" alt=""><br><br><noindex><a href="http://docwiki.embarcadero.com/RADStudio/XE6/en/Class_and_Record_Helpers_(Delphi)" rel="nofollow" target="_blank">официальный док</a></noindex><br><br>Еще я перегрузил оператор Implicit для неявного преобразования TAppKey в строку и строку в TAppKey.<br><br>Других больших несовместимостей с предыдущими версиями кажется нет.<br><br>Еще важно чтобы в том месте где считается md5 от имени файла, строка с именем была 2-байтовая, UnicodeString. В 2009 и старше строка и так UnicodeString.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=344061&amp;user=28841&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=19" class="addthx" data-post="344061"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]unknownproject[/b]','')">unknownproject</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.1 (постоянный), 247thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.52'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=27422">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 июля 2014 15:27 <br><script type="text/javascript">QU('unknownproject','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unknownproject" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
Уже страшно подумать, какой по размеру будет эксе на выходе в среде XE6<img src="img/smilies/s13.gif" alt="">Там хоть убирай, не убирай ненужные компоненты - толку нет.
<br><br><font size="1"><i>-----<br>TEST YOUR MIGHT</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=344081&amp;user=27422&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=20" class="addthx" data-post="344081"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31142" title="03-07-2014 15:24, ранг:40.5" target="_blank">sivorog</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 июля 2014 16:40 <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
ну да, размер тулзы для стара имеет очень большое значение <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=344083&amp;user=10534&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=21" class="addthx" data-post="344083"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=6336" title="03-07-2014 13:27, ранг:576.7" target="_blank">ARCHANGEL</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 августа 2014 09:51 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
<I>Vovan666 пишет:<br>там кажется для каждой игры нужно брутить таблицу хэшей, а как и из чего...  </I><br>может быть по аналогии с SecuROM PA - из приватного ключа составляется таблица в 4112 байт? <img src="img/smilies/s1.gif" alt=""><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>int</b></span>&nbsp;__thiscall&nbsp;DES_Private<span class="hl_char">(</span><span class="hl_function"><b>void</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_function">this</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;a2<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;a3<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;a4<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;a5<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;result<span class="hl_comment">; // eax@1</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v6<span class="hl_comment">; // ebx@2</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;v7<span class="hl_comment">; // [sp+0h] [bp-94h]@1</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v8<span class="hl_comment">; // [sp+80h] [bp-14h]@3</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v9<span class="hl_comment">; // [sp+84h] [bp-10h]@3</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v10<span class="hl_comment">; // [sp+88h] [bp-Ch]@3</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v11<span class="hl_comment">; // [sp+8Ch] [bp-8h]@3</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v12<span class="hl_comment">; // [sp+90h] [bp-4h]@1</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v13<span class="hl_comment">; // [sp+9Ch] [bp+8h]@2</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v14<span class="hl_comment">; // [sp+A4h] [bp+10h]@2</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;DES_Odd_Parity<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_function"><b>this</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>v7<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;result&nbsp;<span class="hl_char">=</span>&nbsp;a3<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v12&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;a3&nbsp;<span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;v6&nbsp;<span class="hl_char">=</span>&nbsp;a2<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;v13&nbsp;<span class="hl_char">=</span>&nbsp;a3<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;v14&nbsp;<span class="hl_char">=</span>&nbsp;a4&nbsp;<span class="hl_char">-</span>&nbsp;v6<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;do</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v10&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v11&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v8&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v9&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;v13&nbsp;<span class="hl_char">&lt;</span>&nbsp;<span class="hl_number">8</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy<span class="hl_char">(</span><span class="hl_char">&amp;</span>v10<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>const</b></span>&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>v6<span class="hl_char">,</span>&nbsp;a3&nbsp;<span class="hl_char">-</span>&nbsp;v12<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v10&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>v6<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v11&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>v6&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DES<span class="hl_char">(</span><span class="hl_char">&amp;</span>v10<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>v8<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>v7<span class="hl_char">,</span>&nbsp;a5<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v12&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">8</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v13&nbsp;<span class="hl_char">-</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">8</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>v14&nbsp;<span class="hl_char">+</span>&nbsp;v6<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;v8<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>v14&nbsp;<span class="hl_char">+</span>&nbsp;v6&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;v9<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;<span class="hl_char">=</span>&nbsp;v12<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v6&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">8</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;v12&nbsp;<span class="hl_char">&lt;</span>&nbsp;a3&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;return&nbsp;result<span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=345716&amp;user=26651&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=22" class="addthx" data-post="345716"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]unknownproject[/b]','')">unknownproject</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.1 (постоянный), 247thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.52'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=27422">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 августа 2014 10:17 &middot; Поправил: unknownproject <br><script type="text/javascript">QU('unknownproject','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unknownproject" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
Провел анализ.Взял несколько своих лицензионных игр, накрытых старфорс + качнул пару демок и сделал вывод, как же менялась чудесная файловая система старфорс.<br>1.Модифицированный zip архив со смещенным заголовком и другим мусором.<br><b>Целевой пример: Демоверсия игры Shade - 2004 год.<br>Файл: data00.res.<br>Версия старфорс: 3.4.47.1</b><br>2a.Далее уже появился SFFS, т.е. старфорс уже стал юзать свою файловую систему для защиты некоторых игр от несанкционированного доступа, при чем файлы шифровались по отдельности.<br><b>Целевой пример: Dungeon Lords Золотое Издание - 2005 год. <br>Файлы: compass.dat, root.dat.<br>Версия старфорс: 3.7.16.0</b><br>2b.Сего было мало для них и они решили все-таки зашифровать некоторую часть данных в одном файле с сохранением иерархии.<br><b>Целевой пример: Knights of The Temple 2 - 2006 год/Волкодав - Путь воина - 2006 год.<br>Файл: KOTT2.dat/resource0.dat.<br>Версии старфорс: 3.6.10.7/4.50.7.3</b>
<br><br><font size="1"><i>-----<br>TEST YOUR MIGHT</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=345717&amp;user=27422&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=23" class="addthx" data-post="345717"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 августа 2014 12:57 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#24');return false;">#24</a> </span><div align=left><br>
В Dungeon Lords Золотое Издание есть огромный архив с озвучкой там куча файлов. Там не шифруются файлы по отдельности. (Для этой игры я переписывал генерик анпакер Zornа)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345719&amp;user=4618&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=24" class="addthx" data-post="345719"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]unknownproject[/b]','')">unknownproject</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.1 (постоянный), 247thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.52'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=27422">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 августа 2014 14:10 &middot; Поправил: unknownproject <br><script type="text/javascript">QU('unknownproject','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unknownproject" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#25');return false;">#25</a> </span><div align=left><br>
<I>Nightshade пишет:<br>Там не шифруются файлы по отдельности. </I><br>Вероятно я не так выразился.Да, озвучка там в <b>speech.dat</b>, но контейнер ведь не один.Именно это я имел ввиду.Саму игру я анпакнул с помощью демки золотого издания.Файловую структуру восстанавливать не сложно.
<br><br><font size="1"><i>-----<br>TEST YOUR MIGHT</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=345721&amp;user=27422&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=25" class="addthx" data-post="345721"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 августа 2014 23:55 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#26');return false;">#26</a> </span><div align=left><br>
<I>unknownproject пишет:<br>Вероятно я не так выразился.Да, озвучка там в speech.dat, но контейнер ведь не один.Именно это я имел ввиду.Саму игру я анпакнул с помощью демки золотого издания.Файловую структуру восстанавливать не сложно.  </I><br>Епт. Сколько издатель захочет, столько и делает контейнеров. Это только от его желания зависит.<br>Далее<br>Мне очень интересно как ты восстанавливал структуру файлов ака имена в архиве.<br>Я тебе один сИкрет расскажу. Конкретно в этой игре туча скриптов для диалогов. И куча скриптов с событиями. Например если произошло событие нападения, проиграть звук такой-то. И если ты выбрал вторую строку в диалоге проиграть звук 2*ххх+имя файла. Отсюда, чтобы вытащить там все файлы, надо перелопатить все скрипты и все возможные ветки выполнения скриптов.<br>А теперь расскажи мне на ночь, как ты все это лопатил.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345814&amp;user=4618&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=26" class="addthx" data-post="345814"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31275" title="25-08-2014 04:38, ранг:85.3" target="_blank">TryAga1n</a>, <a href="action=userinfo&user=31142" title="25-08-2014 09:58, ранг:42.5" target="_blank">sivorog</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]PASAf[/b]','')">PASAf</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.6 (новичок), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.02'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=21541">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 мая 2017 16:03 &middot; Поправил: PASAf <br><script type="text/javascript">QU('PASAf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PASAf" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#27');return false;">#27</a> </span><div align=left><br>
Попробовал распаковщик на 2-х версиях StarForce (3.7.12 и 4.70) - находит по 100 с лишним хешей, на одном файл 400+ мб, на другом 11 мб, после извлечения известных имен (отловленных снифером, 1-3 файла), извлеченные файлы меньше контейнера на 10 кб.<br><br>Вопрос - могут ли быть оставшиеся хеши ложными? Или там правда в 10 кб ещё 100 файлов?<br><br>P.S. Жертвы - игры.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376134&amp;user=21541&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=27" class="addthx" data-post="376134"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]PASAf[/b]','')">PASAf</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.6 (новичок), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.02'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=21541">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2017 06:07 <br><script type="text/javascript">QU('PASAf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PASAf" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#28');return false;">#28</a> </span><div align=left><br>
В общем сам полу-отвечу на свой вопрос.<br>2 игры разные. С вышеупомянутыми версиями старфорса. Прошёл полностью с включенным снифером + забил все имена из зарубежных (без старфорса) релизов.<br>Итог: в обеих играх SFFS Unpacker нашёл 101+N имён файлов, где N - кол-во реальных (распакованных/отловленных снифером/присутствовавших в релизах без старфорса) файлов.<br><br>P.S. SFFS Unpacker с SVN, Delphi XE6
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376315&amp;user=21541&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=28" class="addthx" data-post="376315"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Psalmopoeus Pulcher[/b]','')">Psalmopoeus Pulcher</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.8 (посетитель), 23thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18297">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2017 09:07 &middot; Поправил: Psalmopoeus Pulcher <br><script type="text/javascript">QU('Psalmopoeus Pulcher','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Psalmopoeus Pulcher" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#29');return false;">#29</a> </span><div align=left><br>
<b>PASAf</b>,<br>таки да, прот скрывает реальное кол-во файлов в контейнере, но допускать это нужно с некоторой долей вероятности, ориентируясь на суммарный размер извлеченных файлов. Так что, если <I>с включенным снифером + забил все имена из зарубежных</I>, то ход мыслей правильный и ты все сделал верно.<br><br><b>Upd.</b> Можно пойти немножечко дальше - взять сорцы анпакера и самому пробежаться по контейнеру, собрать размеры всех полей, в т.ч. хешей, хидеров и реальных файлов, и сравнить с размером контейнера. <u>Возможно</u> это как то поможет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376317&amp;user=18297&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=29" class="addthx" data-post="376317"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 мая 2017 15:48 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#30');return false;">#30</a> </span><div align=left><br>
По просьбам трудящихся, обновил. Не знал куда запостить, чтоб не апать древние топики. Пусть будет здесь.<br><br><b>SFSniffer v3</b><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Больше&nbsp;никаких&nbsp;плясок&nbsp;с&nbsp;DebugView<span class="hl_char">,</span>&nbsp;теперь&nbsp;есть&nbsp;гуй<span class="hl_char">.</span></li><li class="hl_l1">Добавилась&nbsp;возможность&nbsp;выбрать&nbsp;нужный&nbsp;драйвер&nbsp;StarForce<span class="hl_char">.</span></li><li class="hl_l0">Таки&nbsp;юникод&nbsp;тоже&nbsp;теперь&nbsp;поддерживается<span class="hl_char">.</span></li><li class="hl_l1">А&nbsp;ещё&nbsp;там&nbsp;есть&nbsp;пиздатая&nbsp;кнопка&nbsp;донат<span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br><br><img src="http://savepic.ru/14176105.png" border="0" align="" alt=""><br><br>P.S.: Тестил на Windows 7 SP1 x86<br><br><img src="img/attach.gif" alt=""> <a href="./files/b0b0_31.05.2017_EXELAB.rU.tgz">b0b0_31.05.2017_EXELAB.rU.tgz</a> - SFSniffer_v3.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376449&amp;user=16624&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=30" class="addthx" data-post="376449"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=17432" title="31-05-2017 13:02, ранг:453.9" target="_blank">ClockMan</a>, <a href="action=userinfo&user=31325" title="31-05-2017 14:46, ранг:12.1" target="_blank">zNob</a>, <a href="action=userinfo&user=28512" title="31-05-2017 17:10, ранг:56.4" target="_blank">-Sanchez-</a>, <a href="action=userinfo&user=2777" title="31-05-2017 17:59, ранг:504.3" target="_blank">daFix</a>, <a href="action=userinfo&user=21541" title="03-06-2017 13:51, ранг:11.0" target="_blank">PASAf</a>, <a href="action=userinfo&user=21426" title="03-06-2017 19:18, ранг:58.6" target="_blank">Dart Raiden</a>, <a href="action=userinfo&user=33351" title="06-06-2017 15:19, ранг:0.4" target="_blank">grubian</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]PASAf[/b]','')">PASAf</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.6 (новичок), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.02'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=21541">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 июня 2017 16:51 &middot; Поправил: PASAf <br><script type="text/javascript">QU('PASAf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PASAf" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22923&amp;page=1#31');return false;">#31</a> </span><div align=left><br>
<b>MasterSoft</b><br>Проверил на вышеупомянутых игрушках (StarForce 3.7.12 и 4.70 на Windows XP) - аппкей словило верный.<br>Благодарю за труд.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376555&amp;user=21541&amp;forum_n=3&amp;topic=22923&amp;page=1&amp;anchor=31" class="addthx" data-post="376555"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=16624" title="04-06-2017 16:42, ранг:281.2" target="_blank">MasterSoft</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=22923&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=22923&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=3&amp;topic=22923&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=3&amp;topic=22923&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка файлов из контейнеров SFFS</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="3">
<input type="hidden" name="topic" value="22923">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22923" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
