<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>[ R.Narvaja, estet, MARcoDEN ] Распаковка Армадилло с IAT Elimination (часть 3) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Обсуждение статьи Распаковка Армадилло с IAT Elimination (часть 3)">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/art.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=16&sortBy=0&page=0.html"><b>Обсуждение статей</b></a> <b class=bulletHead>&#8212;&#8250;</b> [ R.Narvaja, estet, MARcoDEN ] Распаковка Армадилло с IAT Elimination (часть 3)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=16&amp;topic=17291&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=16&amp;topic=17291&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Bad_guy[/b]','')">Bad_guy</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/7.gif" alt=""><br><span class=txtSm>Ранг: 536.4 (<b>!</b>), 171thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.66<span style='color:red'>&searr;</span>0.13</span><br>Статус: <a href="action=userinfo&amp;user=7">Администратор</a><br><font color=blue>Создатель CRACKL@B</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2010 00:12 <br><script type="text/javascript">QU('Bad_guy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bad_guy" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Обсуждение статьи <a href="http://exelab.ru/art/?action=view&amp;id=277" target="_blank">Распаковка Армадилло с IAT Elimination (часть 3)</a>
<br><br><font size="1"><i>-----<br>Всем не угодишь</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=270801&amp;user=7&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=1" class="addthx" data-post="270801"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]kola1357[/b]','')">kola1357</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 14.4 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.09'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29325">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июня 2014 23:30 <br><script type="text/javascript">QU('kola1357','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kola1357" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Распаковываю программу, пакованную армой, дошел до 3 части, но застрял на поиске записи значений апи функций в таблицу. В самом начале статьи Рикардо ставит бряк на запись на адрес хранения адреса апи функции, перезапускает программу и у него срабатывает бряк, но адрес начала таблицы постоянно меняется. И у меня из-за этого бряк не срабатывает. А как можно изменить адрес таблицы ? Я нашел этот адрес, у меня этот адрес всегда 12d3f4. Я пробовал ставить бряк на запись по этому адресу, но очень много раз он изменяется, перед тем как таблица начнется заполняться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343536&amp;user=29325&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=2" class="addthx" data-post="343536"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2014 04:31 <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>kola1357</b><br>поставь WinXP себе на ВМ и дебаж. <br>хватить е..ать мозги мемберам, почему адреса другие и изменяются
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343542&amp;user=18316&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=3" class="addthx" data-post="343542"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Rainbow[/b]','')">Rainbow</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/13190.jpg" alt=""><br><span class=txtSm>Ранг: 110.8 (ветеран), 104thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.83'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=13190">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2014 05:01 <br><script type="text/javascript">QU('Rainbow','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rainbow" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>SReg пишет:<br>kola1357<br>поставь WinXP себе на ВМ и дебаж. <br>хватить е..ать мозги мемберам, почему адреса другие и изменяются </I><br><br>Че-то у меня подозрения, что товарищ даже не знает что такое стек.... Крайне прескорбно..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343543&amp;user=13190&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=4" class="addthx" data-post="343543"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]kola1357[/b]','')">kola1357</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 14.4 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.09'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29325">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2014 11:43 &middot; Поправил: kola1357 <br><script type="text/javascript">QU('kola1357','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kola1357" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Rainbow пишет:<br>Че-то у меня подозрения, что товарищ даже не знает что такое стек.... Крайне прескорбно..  </I><br>Хах мне даже смешно стало от таких подколов.<br><br><b>Добавлено спустя 8 минут</b><br><I>SReg пишет:<br>поставь WinXP себе на ВМ и дебаж.  </I><br>Я люблю работать на вин 7, а хп винда старая. Но заметьте что адрес, в котором хранится указатель на таблицу не меняется. А создается это значение рандомом и сохраняется в этот адрес 12d3f4. Только обращений на перезапись к этому адресу слишком много, пока он начнет использоваться для таблицы. Поэтому я решил написать скрипт небольшой, который будет писать в лог адрес команды остановки и значение этого адреса, а как только прервемся на адресе заполнения таблицы, то скрипт тормозим.<br><br>loop:<br>run<br>cmp eip,2254f // это адрес заполнения таблицы, если мы тут, то тормозим скрипт.<br>jne st<br>ret<br><br>st:<br>log eip<br>mov s,[12d3f4]<br>log s<br>jmp loop<br><br>После этого смотрим в логе адрес последней команды, на которой оказалась последняя перезапись указателя.<br><br>У меня получился адрес 00хх2B79, а базовый адрес все время меняется после перезапуска, но это я отловил, через VirtualAlloc, она возвращает адрес базовый при создании страницы.<br><br><b>Добавлено спустя 12 минут</b><br><I>SReg пишет:<br>поставь WinXP себе </I><br>Я не думаю, что это будет решение данной проблемы. Как вы видели в моем предыдущем посте, я писал, что страничка, в который код заполнения таблицы, создается динамически, при помощи VirtualAlloc, так чем тут хп поможет, эта функция выделяет память случайным образом. И на хп будет давать разные адреса вовзврата в eax.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343546&amp;user=29325&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=5" class="addthx" data-post="343546"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2014 12:06 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>kola1357</b> там апи в 3 этапа распаковывается..(с рандомом кстате) + 2 таблицы импорта.. одна загаженная, 2ая реальная. сделайте нормальный дампер и разбирайте в статике говнидло. + вам еще с со сплайсами прийдется повозиться.. они не сложноые.. но гимора добавляют<br>З.Ы, рандом.. там для перемешивание фунок .. между собой.. рекомендую сразу делать в ПРАВИЛЬНОМ порядке.. чтоб не путаться
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=343547&amp;user=17319&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=6" class="addthx" data-post="343547"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]kola1357[/b]','')">kola1357</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 14.4 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.09'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29325">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2014 12:40 <br><script type="text/javascript">QU('kola1357','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kola1357" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>VodoleY пишет:<br>ам апи в 3 этапа распаковывается..(с рандомом кстате) + 2 таблицы импорта </I><br>Да кажется так. Сначала я ставил бряк на байты в call [], которые идут после FF 15, попал на заполнения липовой таблицы, указатель который направлен в секции пакера, после этого я обнаружил где хранится указатель, потом как выше писал, сделал скрипт и поймал последний момент перезаписи указателя, там я его специально поменял, чтобы он указывал в секцию data программы. Также в этом месте я поставил бряк на запись в таблицу по новому указателю и поймал процедуру, которая производит заполнение. Там сравнил заполнение хороших и плохих адресов и нашел магик джамп, который решает и занопил его, таблица вся заполнилась хорошими адресами, программа правда вылетела после этого дела. Она тот адрес после заполнения переписывает там команды и видимо либо спалила изменения в коде, либо она расчитывает новое значения по старому и естественно сбилась. Поэтому тут тоже написал скрипт короткий, который просто флаг меняет на этом джампе.<br><br>Про сплайсы пока не дошел, но уже посмотрел, это вроде антидампы ? Только название другое придумали ? Увидел в секции кода много джампов, ведущих в секцию пакера.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343549&amp;user=29325&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=7" class="addthx" data-post="343549"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2014 12:46 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>kola1357 пишет:<br>Про сплайсы пока не дошел, но уже посмотрел, это вроде антидампы ?  </I><br>сплайс. это кусок кода.. стыренного .. загаженного.. и перенесенного в др. место. расчищается 6-тью сигнами. ИНТ делал кусок для иды. и есть полу готовое решение тут на форуме. ищи
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=343550&amp;user=17319&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=8" class="addthx" data-post="343550"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2014 16:44 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>VodoleY</b><br>Ну вообще у меня и для наномитов скрипты есть. Сейчас посмотрел свои труды, немного удивился от количества написанного кода. Мне обычно лень что-то такое делать. Но топикстартер хочет по Нарвахе распаковывать. Это наверняка лучше, чем мои скрипты разбирать построчно. Там конечно есть комментарии, но все равно без теории это все тяжело.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343554&amp;user=2449&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=9" class="addthx" data-post="343554"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Alinator3500[/b]','')">Alinator3500</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 46.8 (посетитель), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.28'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=34465">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2014 18:53 <br><script type="text/javascript">QU('Alinator3500','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alinator3500" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>OFFTOP</b><br><i class=x>Прочитал про XP, сам на ней сижу.<br>Но возник вопрос, неужели никто ничего не сделал что бы выключить ASLR для всех процессов в более новых редакциях Windows.<br><br>В книге внутреннее устройство Windows 7 (6-е издание) страница 443, этап запуска процесса &quot;Этап 3.А настройка процесса EPROCESS&quot;, пункт 9, тут про решение запуска ASLR.<br><br>А вот тут выключение этой технологии в Windows 7 и 8.1<br>http://digital-forensics.sans.org/blog/2014/02/17/malware-analysis-and-aslr-on-windows-8-1</i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343563&amp;user=34465&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=10" class="addthx" data-post="343563"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2014 19:24 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>Alinator3500 пишет:<br>Но возник вопрос, неужели никто ничего не сделал что бы выключить ASLR для всех процессов в более новых редакциях Windows. </I><br><br><b>Enhanced Mitigation Experience Toolkit</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343564&amp;user=2585&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=11" class="addthx" data-post="343564"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Alinator3500[/b]','')">Alinator3500</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 46.8 (посетитель), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.28'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=34465">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2014 19:31 <br><script type="text/javascript">QU('Alinator3500','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alinator3500" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Если пройти по ссылке, то Enhanced Mitigation Experience Toolkit там и указан в случае Win7.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343565&amp;user=34465&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=12" class="addthx" data-post="343565"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]kola1357[/b]','')">kola1357</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 14.4 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.09'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29325">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2014 22:13 <br><script type="text/javascript">QU('kola1357','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kola1357" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>Alinator3500 пишет:<br>неужели никто ничего не сделал что бы выключить ASLR для всех процессов </I><br>Я экспериментировал с этой программкой EMET как-то, после отключения ASLR некоторые программы отказались запускаться.<br><br>Да и чем это поможет ? Арма выделяет себе секцию памяти через VirtualAlloc, результат всегда будет случайным, потому что она в параметр адрес ставит NULL, то есть память будет выделена там, где решит ОС. Эта функция возвращает базовый адрес памяти.<br><br><b>Добавлено спустя 4 минуты</b><br><I>VodoleY пишет:<br>сплайс. это кусок кода.. стыренного .. загаженного.. и перенесенного в др. место. </I><br>Сплайс оригинально починил. Значит после не скольких приходов в оеп заметил, что анти-дамп каждый раз указывает в разные секции. То есть опять прот как-то получает случайное число. Поставил бряк на апи Time, из ее ответа рассчитывается адрес секции, а потом опять VirtualAlloc арма вызывает. Ну и тут я просто подменил в EAX адрес секции, записал туда адрес одной из секций армы, благо их оказалось много, а так как после распаковки они использоваться не будут, значит мы не затрем так важный код программы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343571&amp;user=29325&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=13" class="addthx" data-post="343571"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2014 22:20 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>kola1357 пишет:<br>записал туда адрес одной из секций армы </I><br>Ну на самом деле это пол работы. В идеале их надо чистить и вставлять на место.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343573&amp;user=2449&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=14" class="addthx" data-post="343573"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]kola1357[/b]','')">kola1357</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 14.4 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.09'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29325">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2014 22:53 &middot; Поправил: kola1357 <br><script type="text/javascript">QU('kola1357','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kola1357" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>int пишет:<br>В идеале их надо чистить и вставлять на место.  </I><br>Согласен, это самое красивое решение. Но во взломе главное, чтобы прога работала. Но мне также интересно есть ли в арме решение, чтобы арма не делала анти-дампы. Руками чистить там много работы, нужно скрипт писать, если в арме нет решения с магик прыжком. Только вот вставить на родное место может быть проблема с нехваткой байт, то есть придется копировать всю секцию кода в другую чистую и там уже формировать код.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343574&amp;user=29325&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=15" class="addthx" data-post="343574"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]kola1357[/b]','')">kola1357</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 14.4 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.09'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29325">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июня 2014 19:44 <br><script type="text/javascript">QU('kola1357','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kola1357" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
На вин хп попробовал поотлаживать прогу.  Вот у меня VirtualAlloc на хп возвращает в той программе постоянно один и тот же адрес, поэтому там действительно базовый адрес команды почти никогда не меняется после перезапуска. Но заметил такое, что когда я ставлю бряк на эту апи, то адреса начинают возвращаться разные, а когда бряк не ставлю, то почти все время один и тот же адрес. <br><br>Вот мне интересно почему так на хп происходит, что VirtualAlloc возвращает одно и тоже почти всегда, но при установке бряка на него, возвращает разные значения ? Как это можно объяснить, что хп выделяет память программе по одному и тому же адресу после перезапуска ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343601&amp;user=29325&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=16" class="addthx" data-post="343601"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июня 2014 21:04 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>kola1357 пишет:<br>Руками чистить там много работы, нужно скрипт писать </I><br>Есть такое дело) Если работаешь в OllyDbg просто делаешь дамп этой области памяти и не паришься с приделыванием в секцию программы. Запоминаешь адрес. Потом IDA открываешь свой не рабочий дамп и применяешь скрипт, который я написал. Нет смысла повторять чью то уже проделанную работу. За одно может ошибки найдете - пишите, исправлю.<br><br><I>kola1357 пишет:<br>Но мне также интересно есть ли в арме решение, чтобы арма не делала анти-дампы </I><br>Анти-дампы это маркерное решение. Т.е. разработчик ставит маркеры внутри своих функций. Затем арма ворует код и пихает в свои недры. Потом идет процесс обфускации и сохранение обфускированного кода внутри вырезанных блоков и плюс в отдельную выделяемую область памяти. Т.е. на самом деле в защищенной программе нет оригинального кода без обфускации. Стало быть никаких волшебных патчей тут не придумаешь. Так что или дамп или чистить. Чистить легко. Обфускация шаблонная.<br><br><img src="img/attach.gif" alt=""> <a href="./files/5d3f_23.06.2014_EXELAB.rU.tgz">5d3f_23.06.2014_EXELAB.rU.tgz</a> - splice_cleaner.idc
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343602&amp;user=2449&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=17" class="addthx" data-post="343602"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29325" title="23-06-2014 17:12, ранг:17.7" target="_blank">kola1357</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июня 2014 21:21 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Эммм, мне одному кажется, что из защиты там маркеры только на наномиты (не считая секьюр секций), а сплайсы работают без маркеров?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343603&amp;user=1556&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=18" class="addthx" data-post="343603"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июня 2014 21:53 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>Archer</b><br>Может быть ты и прав. Маркерами похоже только наномиты и шифрование. Я уже не помню. А вообще я разбирал в 3-ей арме весь процесс упаковки. Там как раз можно спалить багу с генератором случайных чисел, что позволяет распаковать без ключа на старых версиях (на новых не изучалось).<br><br>Кстати маркеры стали причиной тому, что я автоматизировал процесс удаления наномитов. Сбоев не давал ни разу. Обычный скрипт для IDA который находит маркеры (а они всегда парами) и используя анализатор IDA разгребает все переходы между двумя маркерами.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343605&amp;user=2449&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=19" class="addthx" data-post="343605"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июня 2014 21:55 &middot; Поправил: SReg <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
Тоже думаю что без маркеров, т.к. попадались проги где сплайсов было порядка 10к переходов. <br>з.ы. Запиливал давно даже тузлу, которая чистит код и переносит на родное место, но потом как выяснилось, в украденом коде есть инструкции типа mov r32,r32 и это был оригинальный код(видел правда только  mov edi,edi), и если не перенести эти пару байт то оригинальный код испортится... вообщем забил.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343606&amp;user=18316&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=20" class="addthx" data-post="343606"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июня 2014 21:58 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>SReg пишет:<br>и если не перенести эти пару байт то оригинальный код испортится... вообщем забил </I><br>Мне тоже что-то про это говорил <b>Vodoley</b>. У него вроде был случай push eax/pop eax. Программа на Delphi. Сам такое не встречал. В любом случае я проверяю длину и в логе выводится, если не удалось вставить на место из-за ошибки длины вставляемого блока. А пару ошибок можно и руками исправить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343607&amp;user=2449&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=21" class="addthx" data-post="343607"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]kola1357[/b]','')">kola1357</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 14.4 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.09'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29325">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июня 2014 22:01 <br><script type="text/javascript">QU('kola1357','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kola1357" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>int пишет:<br>Т.е. на самом деле в защищенной программе нет оригинального кода без обфускации.  </I><br>Да, я тоже предполагал что оригинального варианта изначально нет, да и логично, что разработчики так сделали.<br><br>Кстати а по поведению VirtualAlloc есть какик-нибудь мнения ? Тестировал прогу, пакованную армой версии 4.42, в которой иат испорчена протом. Протектор при заполнении таблицы иат создает секцию памяти себе через VirtualAlloc, но вот на хп эта функция почти всегда возвращала на тестах один и тот же адрес, а на 7 было множество вариантов. <br><br>Почему так происходит ? У меня предположение, что на хп система запоминает память, которую использовала прога и после перезапуска эти куски памяти и отдает. Как вы думаете, так ли это ?<br><br>И еще на хп при тесте этой же проги, я пробовал ставить бряк на VirtualAlloc и функция начинала возвращать разные адреса. Как можно это поведение программы объяснить ? Я полагаю, что прога обнаруживает обычный бряк и начинает намеренно выделять память в другом регионе, чтобы запутать взломщика. <br>Хотя почему бы просто не прервать выполнение, если она обнаружила бряк ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343608&amp;user=29325&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=22" class="addthx" data-post="343608"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2014 09:08 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Из-за ASLR так происходит. Никакие адреса хп не запоминает. Выделение происходит исходя из карты памяти. Видимо, бряк меняет карту памяти, создавая приватную для процесса страницу, а не шареную. Можешь попробовать ставить ХВ бряк. И никто там никого не пытается запутать. Увы и ах, но винда и софт не крутятся только вокруг взломщика, одна заботливо за него запоминая, а вторая коварно портя адреса памяти. Если так интересно-бери и сорцы винды читай/отлаживай ядро, чем в 33 топика уже вопрос про эту память постить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343612&amp;user=1556&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=23" class="addthx" data-post="343612"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2014 13:30 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>kola1357 пишет:<br>Я экспериментировал с этой программкой EMET как-то, после отключения ASLR некоторые программы отказались запускаться. </I><br><br>пример, пожалуйста.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343617&amp;user=2585&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=24" class="addthx" data-post="343617"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=33253" title="24-06-2014 10:34, ранг:18.0" target="_blank">Abraham</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]kola1357[/b]','')">kola1357</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 14.4 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.09'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29325">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2014 14:34 &middot; Поправил: kola1357 <br><script type="text/javascript">QU('kola1357','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kola1357" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>Gideon Vi пишет:<br>пример, пожалуйста.  </I><br>Эксперимент проводил с этой программкой UnPackMe_Armadillo4.42.a с сайта tuts4you.<br>http://rusfolder.com/41055963 Вот она, залил.<br>Значит, в программе EMET снимал галочку про использование ASLR, но после этого она не хочет запускаться, вылетает. <br><br><I>Archer пишет:<br>Из-за ASLR так происходит. </I><br>Хорошо, допустим, но как на 7 заставить программу без ASLR работать ? Отключить удалось, а вот работать не хочет. Да и еще Process Explorer показывает, что прога не использует ASLR http://floomby.ru/s2/eWupxd<br><br><I>Archer пишет:<br>Можешь попробовать ставить ХВ бряк. </I><br>Да действительно процесорные бряки не влияют на выделение.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343619&amp;user=29325&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=25" class="addthx" data-post="343619"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2014 16:56 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
Что-то тему про арму захламили своими ASLR. В чем проблема похучить VirtualAlloc и явный адрес туда поставить? Это все причем скриптом можно автоматизировать. А что касается 7-ры и новых ОС, то это дикое извращение снимать проты старые на новых ОС. Проты гадят везде где только можно, и 90% защит вообще не работают на последующих ОС. Виртуальную машину в зубы и вперед, грабить караваны.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343622&amp;user=2449&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=26" class="addthx" data-post="343622"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=33727" title="24-06-2014 14:11, ранг:81.1" target="_blank">Dr0p</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Alinator3500[/b]','')">Alinator3500</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 46.8 (посетитель), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.28'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=34465">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2014 17:01 <br><script type="text/javascript">QU('Alinator3500','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alinator3500" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
to <b>Gideon Vi</b><br>EMET как много в этом слове.<br>* Available and applicable only to 32-bit processes<br>** EMET supports Windows 7, Windows 8, Windows 8.1 и т.д.<br>Я на Win 8.1 ставил 4.0 стабильный билд (сейчас 4.1 доступна), а теперь вынужден сидеть на 5.0 Technical Preview.<br>На 4.0 иногда сайты с HTTPS не открывались в малопопулярных браузерах (другие для другого, все 32 битные), и выключал проверку и включал по дефолту, читал мануал по совместимости. Браузер мог вообще не запускаться, висит в процессах без GUI. Обновление Windows не работало, не пускало в шары локалки, youtube не разворачивал видео на пол экрана. (при удаленном с EMET 4.0 было тоже самое).<br>На 5.0 вроде норм уже как месяца 3-4, при удалении его старые настройки активны только доступа к ним нет, присосался короче :D<br>Или у меня руки кривые и я не смог правильно нажать 2 кнопки для установки, или она конфликтует с другим софтом в моем окружении. Разбираться лень, пущай* висит защищает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343623&amp;user=34465&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=27" class="addthx" data-post="343623"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2014 17:11 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<I>kola1357 пишет:<br>Эксперимент проводил с этой программкой UnPackMe_Armadillo4.42.a с сайта tuts4you. </I><br><br>win7 x64 c aslr - вылет. Можно пример настоящего софта, а не чьего-то левого унпакми?<br><br><b>Alinator3500</b>, я не знаю, что там с 8,1.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343624&amp;user=2585&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=28" class="addthx" data-post="343624"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2014 18:21 &middot; Поправил: Dr0p <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
&gt; в программе EMET снимал галочку про использование ASLR<br><br>&gt; Хорошо, допустим, но как на 7 заставить программу без ASLR работать ?<br><br>Это вы не про тот ASLR думаете, у вас трабл с ядерным, а вы ставя галки управляете софтверным <img src="img/smilies/s15.gif" alt=""><br><br>Чтоб прога работала без рандомизации адресов вам нужно изменить ядерный менеджер памяти. Есть есчо вариант использовать сегментацию, но это можно тока на x86 заюзать. Хотя за вас врятле это кто кодить будет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343625&amp;user=33727&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=29" class="addthx" data-post="343625"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]kola1357[/b]','')">kola1357</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 14.4 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.09'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29325">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2014 18:40 <br><script type="text/javascript">QU('kola1357','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kola1357" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=16&amp;topic=17291&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<I>int пишет:<br>В чем проблема похучить VirtualAlloc и явный адрес туда поставить? </I><br>Да тут нет проблемы, просто на хп получается об этом не нужно думать, вот и на 7 так хочется сделать.<br><I>int пишет:<br>Виртуальную машину в зубы и вперед </I><br>Да я как раз и сижу на виртуалке Wmware c win xp sp2.<br><I>Gideon Vi пишет:<br>Можно пример настоящего софта </I><br>Софта любого или пакованного именно армой ? Если любой, то вот к примеру у меня программа Floomby, process explorer показывает, что она использует ASLR.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=343627&amp;user=29325&amp;forum_n=16&amp;topic=17291&amp;page=0&amp;anchor=30" class="addthx" data-post="343627"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=16&amp;topic=17291&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=16&amp;topic=17291&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/art.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=16&sortBy=0&page=0.html"><b>Обсуждение статей</b></a> <b class=bulletHead>&#8212;&#8250;</b> [ R.Narvaja, estet, MARcoDEN ] Распаковка Армадилло с IAT Elimination (часть 3)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="16">
<input type="hidden" name="topic" value="17291">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=17291" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
