<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Вопросы по CRC32. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Нашел исходник функции на С++, но хотел бы на паскале или асме.  И ещё что странно: CRC по этому исходнику и по DAMN Hash калькулятору разные! Т.е. разные результаты. Это правильный алгоритм? и почему массив на 512 элементов? Их">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=3756'>==DJ==[ZLO]</a>, <a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вопросы по CRC32.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]AlexZ[/b]','')">AlexZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 203.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.22<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=175">Участник</a><br><font color=blue>UPX Killer -d</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2005 04:10 <br><script type="text/javascript">QU('AlexZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexZ" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=1346.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Нашел исходник функции на С++, но хотел бы на паскале или асме. 
<br>
<br>И ещё что странно: CRC по этому исходнику и по DAMN Hash калькулятору разные! Т.е. разные результаты. Это правильный алгоритм? и почему массив на 512 элементов? Их же 256?
<br>
<br>Попробую переписать это дело на паскаль.. в С++ мои знания практически нулевые, но, попробую.
<br>
<br>Сишные сорцы ниже:
<br><br><font size="1"><i>-----<br>Я медленно снимаю с неё UPX... *FF_User*</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=14753&amp;user=175&amp;forum_n=1&amp;topic=1346.html&amp;page=0&amp;anchor=1" class="addthx" data-post="14753"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]AlexZ[/b]','')">AlexZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 203.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.22<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=175">Участник</a><br><font color=blue>UPX Killer -d</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2005 04:12 <br><script type="text/javascript">QU('AlexZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexZ" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=1346.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
CRC32.CPP:
<pre>
#include&quot;crc32.h&quot; 

unsigned long  CRC32Table[512] = 
   {0x00000000, 0x77073096, 0xEE0E612C, 0x990951BA, 
    0x076DC419, 0x706AF48F, 0xE963A535, 0x9E6495A3, 
    0x0EDB8832, 0x79DCB8A4, 0xE0D5E91E, 0x97D2D988, 
    0x09B64C2B, 0x7EB17CBD, 0xE7B82D07, 0x90BF1D91, 
    0x1DB71064, 0x6AB020F2, 0xF3B97148, 0x84BE41DE, 
    0x1ADAD47D, 0x6DDDE4EB, 0xF4D4B551, 0x83D385C7, 
    0x136C9856, 0x646BA8C0, 0xFD62F97A, 0x8A65C9EC, 
    0x14015C4F, 0x63066CD9, 0xFA0F3D63, 0x8D080DF5, 
    0x3B6E20C8, 0x4C69105E, 0xD56041E4, 0xA2677172, 
    0x3C03E4D1, 0x4B04D447, 0xD20D85FD, 0xA50AB56B, 
    0x35B5A8FA, 0x42B2986C, 0xDBBBC9D6, 0xACBCF940, 
    0x32D86CE3, 0x45DF5C75, 0xDCD60DCF, 0xABD13D59, 
    0x26D930AC, 0x51DE003A, 0xC8D75180, 0xBFD06116, 
    0x21B4F4B5, 0x56B3C423, 0xCFBA9599, 0xB8BDA50F, 
    0x2802B89E, 0x5F058808, 0xC60CD9B2, 0xB10BE924, 
    0x2F6F7C87, 0x58684C11, 0xC1611DAB, 0xB6662D3D, 


    0x76DC4190, 0x01DB7106, 0x98D220BC, 0xEFD5102A, 
    0x71B18589, 0x06B6B51F, 0x9FBFE4A5, 0xE8B8D433, 
    0x7807C9A2, 0x0F00F934, 0x9609A88E, 0xE10E9818, 
    0x7F6A0DBB, 0x086D3D2D, 0x91646C97, 0xE6635C01, 
    0x6B6B51F4, 0x1C6C6162, 0x856530D8, 0xF262004E, 
    0x6C0695ED, 0x1B01A57B, 0x8208F4C1, 0xF50FC457, 
    0x65B0D9C6, 0x12B7E950, 0x8BBEB8EA, 0xFCB9887C, 
    0x62DD1DDF, 0x15DA2D49, 0x8CD37CF3, 0xFBD44C65, 
    0x4DB26158, 0x3AB551CE, 0xA3BC0074, 0xD4BB30E2, 
    0x4ADFA541, 0x3DD895D7, 0xA4D1C46D, 0xD3D6F4FB, 
    0x4369E96A, 0x346ED9FC, 0xAD678846, 0xDA60B8D0, 
    0x44042D73, 0x33031DE5, 0xAA0A4C5F, 0xDD0D7CC9, 
    0x5005713C, 0x270241AA, 0xBE0B1010, 0xC90C2086, 
    0x5768B525, 0x206F85B3, 0xB966D409, 0xCE61E49F, 
    0x5EDEF90E, 0x29D9C998, 0xB0D09822, 0xC7D7A8B4, 
    0x59B33D17, 0x2EB40D81, 0xB7BD5C3B, 0xC0BA6CAD, 


    0xEDB88320, 0x9ABFB3B6, 0x03B6E20C, 0x74B1D29A, 
    0xEAD54739, 0x9DD277AF, 0x04DB2615, 0x73DC1683, 
    0xE3630B12, 0x94643B84, 0x0D6D6A3E, 0x7A6A5AA8, 
    0xE40ECF0B, 0x9309FF9D, 0x0A00AE27, 0x7D079EB1, 
    0xF00F9344, 0x8708A3D2, 0x1E01F268, 0x6906C2FE, 
    0xF762575D, 0x806567CB, 0x196C3671, 0x6E6B06E7, 
    0xFED41B76, 0x89D32BE0, 0x10DA7A5A, 0x67DD4ACC, 
    0xF9B9DF6F, 0x8EBEEFF9, 0x17B7BE43, 0x60B08ED5, 
    0xD6D6A3E8, 0xA1D1937E, 0x38D8C2C4, 0x4FDFF252, 
    0xD1BB67F1, 0xA6BC5767, 0x3FB506DD, 0x48B2364B, 
    0xD80D2BDA, 0xAF0A1B4C, 0x36034AF6, 0x41047A60, 
    0xDF60EFC3, 0xA867DF55, 0x316E8EEF, 0x4669BE79, 
    0xCB61B38C, 0xBC66831A, 0x256FD2A0, 0x5268E236, 
    0xCC0C7795, 0xBB0B4703, 0x220216B9, 0x5505262F, 
    0xC5BA3BBE, 0xB2BD0B28, 0x2BB45A92, 0x5CB36A04, 
    0xC2D7FFA7, 0xB5D0CF31, 0x2CD99E8B, 0x5BDEAE1D, 


    0x9B64C2B0, 0xEC63F226, 0x756AA39C, 0x026D930A, 
    0x9C0906A9, 0xEB0E363F, 0x72076785, 0x05005713, 
    0x95BF4A82, 0xE2B87A14, 0x7BB12BAE, 0x0CB61B38, 
    0x92D28E9B, 0xE5D5BE0D, 0x7CDCEFB7, 0x0BDBDF21, 
    0x86D3D2D4, 0xF1D4E242, 0x68DDB3F8, 0x1FDA836E, 
    0x81BE16CD, 0xF6B9265B, 0x6FB077E1, 0x18B74777, 
    0x88085AE6, 0xFF0F6A70, 0x66063BCA, 0x11010B5C, 
    0x8F659EFF, 0xF862AE69, 0x616BFFD3, 0x166CCF45, 
    0xA00AE278, 0xD70DD2EE, 0x4E048354, 0x3903B3C2, 
    0xA7672661, 0xD06016F7, 0x4969474D, 0x3E6E77DB, 
    0xAED16A4A, 0xD9D65ADC, 0x40DF0B66, 0x37D83BF0, 
    0xA9BCAE53, 0xDEBB9EC5, 0x47B2CF7F, 0x30B5FFE9, 
    0xBDBDF21C, 0xCABAC28A, 0x53B39330, 0x24B4A3A6, 
    0xBAD03605, 0xCDD70693, 0x54DE5729, 0x23D967BF, 
    0xB3667A2E, 0xC4614AB8, 0x5D681B02, 0x2A6F2B94, 
    0xB40BBE37, 0xC30C8EA1, 0x5A05DF1B, 0x2D02EF8D}; 


Это я дописал функцию вывода:
void main(){
	char *MyString = &quot;M&quot;;

	cout&lt;&lt;CalcCRC32(MyString);
	while(!kbhit());
}

unsigned long CalcCRC32 (char * buf) 
{ 
  unsigned long CRC32=0xFFFFFFFF,tt; 
  for(int i=0;buf[i] != 0; i++){tt = buf[i]; 
     CRC32 = (CRC32 &gt;&gt; 8) ^ CRC32Table[tt ^ (CRC32 &amp; 0x000000FF)];  } 
  return(CRC32); 
}  ;
 
</pre>
CRC32.h:
<pre>
#ifndef __INCL__ 
#define __INCL__ 
  #include&lt;stdlib.h&gt; 
  #include&lt;stdio.h&gt; 
  #include&lt;string.h&gt; 
  #include&lt;conio.h&gt;
  #include&lt;iostream.h&gt;
#endif 

#ifndef _CRC32LIB_ 

#define _CRC32LIB_ 1 

extern unsigned long  CRC32Table[512] ; 

unsigned long CalcCRC32 (char *buf); 


#endif
</pre>
<br><br><font size="1"><i>-----<br>Я медленно снимаю с неё UPX... *FF_User*</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=14754&amp;user=175&amp;forum_n=1&amp;topic=1346.html&amp;page=0&amp;anchor=2" class="addthx" data-post="14754"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2005 04:54 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=1346.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<pre>unit ChkSumm;

interface

const
 CRC32INIT = &#036;FFFFFFFF;
{----------------------------------------------------------------}
{    Buffer - массив байтов, для которого подсчитывается CRC     }
{    CRC    - начальное значение CRC                             }
{    Count  - длина буфера                                       }
{----------------------------------------------------------------}
function CalculateBufferCRC32( CRC   : Cardinal;                           const Buffer; Count : Cardinal ) : Cardinal;
register;
{----------------------------------------------------------------}
{  Расчет 32-битовой CRC, алгоритм аналогичен применяемому в     }
{ архиваторах ZIP, ARJ. При этом начальное значение CRC должно   }
{ быть равно CRC32INIT, а после окончания подсчета окончательная }
{ CRC вычисляется по формуле :                                   }
{           CRC := CRC xor CRC32INIT;                            }
{ Hапример :                                                     }
{  var                                                           }
{   Buffer : array[1..8192] of Char;                             }
{   CRC    : Cardinal;                                           }
{   Count  : Cardinal;                                           }
{  .......                                                       }
{   CRC := CRC32INIT;                                            }
{   repeat                                                       }
{    BlockRead(F, Buffer, SizeOf( Buffer ), Count);              }
{    CRC := CalculateBufferCRC32( CRC, Buffer, Count );          }
{   until Eof(F);                                                }
{   CRC := CRC xor CRC32INIT;                                    }
{  .......                                                       }
{----------------------------------------------------------------}
implementation

const
CRC32Table : array[0..255] of Cardinal = (
 &#036;00000000, &#036;77073096, &#036;EE0E612C, &#036;990951BA, &#036;076DC419, &#036;706AF48F,
&#036;E963A535,
 &#036;9E6495A3, &#036;0EDB8832, &#036;79DCB8A4, &#036;E0D5E91E, &#036;97D2D988, &#036;09B64C2B,
&#036;7EB17CBD,
 &#036;E7B82D07, &#036;90BF1D91, &#036;1DB71064, &#036;6AB020F2, &#036;F3B97148, &#036;84BE41DE,
&#036;1ADAD47D,
 &#036;6DDDE4EB, &#036;F4D4B551, &#036;83D385C7, &#036;136C9856, &#036;646BA8C0, &#036;FD62F97A,
&#036;8A65C9EC,
 &#036;14015C4F, &#036;63066CD9, &#036;FA0F3D63, &#036;8D080DF5, &#036;3B6E20C8, &#036;4C69105E,
&#036;D56041E4,
 &#036;A2677172, &#036;3C03E4D1, &#036;4B04D447, &#036;D20D85FD, &#036;A50AB56B, &#036;35B5A8FA,
&#036;42B2986C,
 &#036;DBBBC9D6, &#036;ACBCF940, &#036;32D86CE3, &#036;45DF5C75, &#036;DCD60DCF, &#036;ABD13D59,
&#036;26D930AC,
 &#036;51DE003A, &#036;C8D75180, &#036;BFD06116, &#036;21B4F4B5, &#036;56B3C423, &#036;CFBA9599,
&#036;B8BDA50F,
 &#036;2802B89E, &#036;5F058808, &#036;C60CD9B2, &#036;B10BE924, &#036;2F6F7C87, &#036;58684C11,
&#036;C1611DAB,
 &#036;B6662D3D, &#036;76DC4190, &#036;01DB7106, &#036;98D220BC, &#036;EFD5102A, &#036;71B18589,
&#036;06B6B51F,
 &#036;9FBFE4A5, &#036;E8B8D433, &#036;7807C9A2, &#036;0F00F934, &#036;9609A88E, &#036;E10E9818,
&#036;7F6A0DBB,
 &#036;086D3D2D, &#036;91646C97, &#036;E6635C01, &#036;6B6B51F4, &#036;1C6C6162, &#036;856530D8,
&#036;F262004E,
 &#036;6C0695ED, &#036;1B01A57B, &#036;8208F4C1, &#036;F50FC457, &#036;65B0D9C6, &#036;12B7E950,
&#036;8BBEB8EA,
 &#036;FCB9887C, &#036;62DD1DDF, &#036;15DA2D49, &#036;8CD37CF3, &#036;FBD44C65, &#036;4DB26158,
&#036;3AB551CE,
 &#036;A3BC0074, &#036;D4BB30E2, &#036;4ADFA541, &#036;3DD895D7, &#036;A4D1C46D, &#036;D3D6F4FB,
&#036;4369E96A,
 &#036;346ED9FC, &#036;AD678846, &#036;DA60B8D0, &#036;44042D73, &#036;33031DE5, &#036;AA0A4C5F,
&#036;DD0D7CC9,
 &#036;5005713C, &#036;270241AA, &#036;BE0B1010, &#036;C90C2086, &#036;5768B525, &#036;206F85B3,
&#036;B966D409,
 &#036;CE61E49F, &#036;5EDEF90E, &#036;29D9C998, &#036;B0D09822, &#036;C7D7A8B4, &#036;59B33D17,
&#036;2EB40D81,
 &#036;B7BD5C3B, &#036;C0BA6CAD, &#036;EDB88320, &#036;9ABFB3B6, &#036;03B6E20C, &#036;74B1D29A,
&#036;EAD54739,
 &#036;9DD277AF, &#036;04DB2615, &#036;73DC1683, &#036;E3630B12, &#036;94643B84, &#036;0D6D6A3E,
&#036;7A6A5AA8,
 &#036;E40ECF0B, &#036;9309FF9D, &#036;0A00AE27, &#036;7D079EB1, &#036;F00F9344, &#036;8708A3D2,
&#036;1E01F268,
 &#036;6906C2FE, &#036;F762575D, &#036;806567CB, &#036;196C3671, &#036;6E6B06E7, &#036;FED41B76,
&#036;89D32BE0,
 &#036;10DA7A5A, &#036;67DD4ACC, &#036;F9B9DF6F, &#036;8EBEEFF9, &#036;17B7BE43, &#036;60B08ED5,
&#036;D6D6A3E8,
 &#036;A1D1937E, &#036;38D8C2C4, &#036;4FDFF252, &#036;D1BB67F1, &#036;A6BC5767, &#036;3FB506DD,
&#036;48B2364B,
 &#036;D80D2BDA, &#036;AF0A1B4C, &#036;36034AF6, &#036;41047A60, &#036;DF60EFC3, &#036;A867DF55,
&#036;316E8EEF,
 &#036;4669BE79, &#036;CB61B38C, &#036;BC66831A, &#036;256FD2A0, &#036;5268E236, &#036;CC0C7795,
&#036;BB0B4703,
 &#036;220216B9, &#036;5505262F, &#036;C5BA3BBE, &#036;B2BD0B28, &#036;2BB45A92, &#036;5CB36A04,
&#036;C2D7FFA7,
 &#036;B5D0CF31, &#036;2CD99E8B, &#036;5BDEAE1D, &#036;9B64C2B0, &#036;EC63F226, &#036;756AA39C,
&#036;026D930A,
 &#036;9C0906A9, &#036;EB0E363F, &#036;72076785, &#036;05005713, &#036;95BF4A82, &#036;E2B87A14,
&#036;7BB12BAE,
 &#036;0CB61B38, &#036;92D28E9B, &#036;E5D5BE0D, &#036;7CDCEFB7, &#036;0BDBDF21, &#036;86D3D2D4,
&#036;F1D4E242,
 &#036;68DDB3F8, &#036;1FDA836E, &#036;81BE16CD, &#036;F6B9265B, &#036;6FB077E1, &#036;18B74777,
&#036;88085AE6,
 &#036;FF0F6A70, &#036;66063BCA, &#036;11010B5C, &#036;8F659EFF, &#036;F862AE69, &#036;616BFFD3,
&#036;166CCF45,
 &#036;A00AE278, &#036;D70DD2EE, &#036;4E048354, &#036;3903B3C2, &#036;A7672661, &#036;D06016F7,
&#036;4969474D,
 &#036;3E6E77DB, &#036;AED16A4A, &#036;D9D65ADC, &#036;40DF0B66, &#036;37D83BF0, &#036;A9BCAE53,
&#036;DEBB9EC5,
 &#036;47B2CF7F, &#036;30B5FFE9, &#036;BDBDF21C, &#036;CABAC28A, &#036;53B39330, &#036;24B4A3A6,
&#036;BAD03605,
 &#036;CDD70693, &#036;54DE5729, &#036;23D967BF, &#036;B3667A2E, &#036;C4614AB8, &#036;5D681B02,
&#036;2A6F2B94,
 &#036;B40BBE37, &#036;C30C8EA1, &#036;5A05DF1B, &#036;2D02EF8D );

function CalculateBufferCRC32( CRC   : Cardinal;
                               const Buffer;
                               Count : Cardinal ) : Cardinal;
assembler;
asm
 PUSH ESI
 PUSH EDI
 MOV ESI, Buffer
// MOV ECX, Count       // uncomment these strings
// MOV EAX, CRC         // if not use REGISTER calling convention
 CLD
@@Loop:
  MOV EDI, EAX                       // copy CRC into DI
  LODSB                              // load next byte into AL
  XOR EDI, EAX                       // put array index into DL
  SHR EAX, 8                         // shift CRC one byte right
  SHL DI, 2                          // correct DI
  XOR EAX, DWORD PTR CRC32Table[EDI] // calculate next CRC value
 LOOP @@Loop
 POP EDI
 POP ESI
end;

end.</pre>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=14762&amp;user=24&amp;forum_n=1&amp;topic=1346.html&amp;page=0&amp;anchor=3" class="addthx" data-post="14762"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Spiteful[/b]','')">Spiteful</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.1 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=154">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2005 05:34 <br><script type="text/javascript">QU('Spiteful','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Spiteful" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=1346.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
CRC32		proc len<img src="img/smilies/s5.gif" alt="">WORD, data<img src="img/smilies/s5.gif" alt="">WORD
<br>push	esi
<br>push	ecx
<br>push	edx
<br>
<br>	mov	esi, data
<br>                mov	ecx, len
<br>	xor	edx, edx
<br>	xor           eax,eax
<br>                dec           eax
<br>	
<br>
<br>CRC32calc:
<br>	mov	dl, byte ptr [esi]
<br>	xor	dl, al
<br>	shr	eax, 8
<br>	xor	eax, dword ptr [hashtab + 4*edx]
<br>	inc	esi
<br>	dec	ecx
<br>	jnz	CRC32calc
<br>
<br>	not	eax
<br>
<br>	pop	edx
<br>	pop	ecx
<br>	pop	esi
<br>	ret
<br>
<br>CRC32 endp
<br>
<br>
<br>inittable proc ; динамическое заполнение таблицы
<br>	push ebx
<br>	lea edx,hashtab ; указатель на выдел. память
<br>	xor ebx,ebx
<br>	initl:
<br>	xor eax,eax
<br>	mov al,bl
<br>	xor cx,cx
<br>	entryloop:
<br>	test eax,1
<br>	jz nobit
<br>	shr eax,1
<br>	xor eax,0EDB88320h
<br>	jmp entrygon
<br>	nobit:
<br>	shr eax,1
<br>	entrygon:
<br>	inc cx
<br>	test cx,8
<br>	jz entryloop
<br>	mov dword ptr [ebx*4+edx],eax
<br>	inc bx
<br>	test bx,256
<br>	jz initl
<br>	
<br>	
<br>	pop ebx
<br>	
<br>	ret
<br>
<br>inittable endp
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=14768&amp;user=154&amp;forum_n=1&amp;topic=1346.html&amp;page=0&amp;anchor=4" class="addthx" data-post="14768"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]AlexZ[/b]','')">AlexZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 203.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.22<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=175">Участник</a><br><font color=blue>UPX Killer -d</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2005 05:58 &middot; Поправил: AlexZ <br><script type="text/javascript">QU('AlexZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexZ" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=1346.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>Ara</b>
<b>Spiteful</b>

Круто! Спасибо!

А я вот пока добился того, что откомпилил Сишный пример, дизассемблировал объектный файл идой, да перекатал всё дело на ТАСМ, скомпилив объектный файл, потом прилинковал в Делфе, и скомпилил себе EXEшник! Теперь CRC файла совпадают, как в DAMN Hash кальке.

<pre>
.code

;GetCRC(pBufer:pointer;Len:integer):dword;
GetCRC		proc

var_4C          equ -4Ch
var_C           equ -0Ch
var_8           equ -8
var_4           equ -4
arg_0           equ 8
arg_4           equ 0Ch

                push    ebp
                mov     ebp, esp
                sub     esp, 4Ch
                push    ebx
                push    esi
                push    edi
                lea     edi, [ebp+var_4C]
                mov     ecx, 13h
                mov     eax, 0CCCCCCCCh
                rep stosd
                mov     [ebp+var_4], 0FFFFFFFFh
                mov     [ebp+var_C], 0
                jmp     @@loc_831
; ---------------------------------------------------------------------- -----

@@loc_828:
                mov     eax, [ebp+var_C]
                add     eax, 1
                mov     [ebp+var_C], eax

@@loc_831:
                mov     ecx, [ebp+var_C]
                cmp     ecx, [ebp+arg_4]
                jge      @@loc_865
                mov     edx, [ebp+arg_0]
                add     edx, [ebp+var_C]
                movsx   eax, byte ptr [edx]
                mov     [ebp+var_8], eax
                mov     ecx, [ebp+var_4]
                shr     ecx, 8
                mov     edx, [ebp+var_4]
                and     edx, 0FFh
                mov     eax, [ebp+var_8]
                xor     eax, edx
                xor     ecx, crc32tab[eax*4] ; ulong * CRC32Table
                mov     [ebp+var_4], ecx
                jmp     @@loc_828
; ---------------------------------------------------------------------- -----

@@loc_865:
                mov     eax, [ebp+var_4]
                xor	    eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                ret	8

GetCRC		endp


.data
; 0
crc32tab dd 000000000h, 077073096h, 0ee0e612ch, 0990951bah
dd 0076dc419h, 0706af48fh, 0e963a535h, 09e6495a3h
dd 00edb8832h, 079dcb8a4h, 0e0d5e91eh, 097d2d988h
dd 009b64c2bh, 07eb17cbdh, 0e7b82d07h, 090bf1d91h
; 1
dd 01db71064h, 06ab020f2h, 0f3b97148h, 084be41deh
dd 01adad47dh, 06ddde4ebh, 0f4d4b551h, 083d385c7h
dd 0136c9856h, 0646ba8c0h, 0fd62f97ah, 08a65c9ech
dd 014015c4fh, 063066cd9h, 0fa0f3d63h, 08d080df5h
; 2
dd 03b6e20c8h, 04c69105eh, 0d56041e4h, 0a2677172h
dd 03c03e4d1h, 04b04d447h, 0d20d85fdh, 0a50ab56bh
dd 035b5a8fah, 042b2986ch, 0dbbbc9d6h, 0acbcf940h
dd 032d86ce3h, 045df5c75h, 0dcd60dcfh, 0abd13d59h
; 3
dd 026d930ach, 051de003ah, 0c8d75180h, 0bfd06116h
dd 021b4f4b5h, 056b3c423h, 0cfba9599h, 0b8bda50fh
dd 02802b89eh, 05f058808h, 0c60cd9b2h, 0b10be924h
dd 02f6f7c87h, 058684c11h, 0c1611dabh, 0b6662d3dh
; 4
dd 076dc4190h, 001db7106h, 098d220bch, 0efd5102ah
dd 071b18589h, 006b6b51fh, 09fbfe4a5h, 0e8b8d433h
dd 07807c9a2h, 00f00f934h, 09609a88eh, 0e10e9818h
dd 07f6a0dbbh, 0086d3d2dh, 091646c97h, 0e6635c01h
; 5
dd 06b6b51f4h, 01c6c6162h, 0856530d8h, 0f262004eh
dd 06c0695edh, 01b01a57bh, 08208f4c1h, 0f50fc457h
dd 065b0d9c6h, 012b7e950h, 08bbeb8eah, 0fcb9887ch
dd 062dd1ddfh, 015da2d49h, 08cd37cf3h, 0fbd44c65h
; 6
dd 04db26158h, 03ab551ceh, 0a3bc0074h, 0d4bb30e2h
dd 04adfa541h, 03dd895d7h, 0a4d1c46dh, 0d3d6f4fbh
dd 04369e96ah, 0346ed9fch, 0ad678846h, 0da60b8d0h
dd 044042d73h, 033031de5h, 0aa0a4c5fh, 0dd0d7cc9h
; 7
dd 05005713ch, 0270241aah, 0be0b1010h, 0c90c2086h
dd 05768b525h, 0206f85b3h, 0b966d409h, 0ce61e49fh
dd 05edef90eh, 029d9c998h, 0b0d09822h, 0c7d7a8b4h
dd 059b33d17h, 02eb40d81h, 0b7bd5c3bh, 0c0ba6cadh
; 8
dd 0edb88320h, 09abfb3b6h, 003b6e20ch, 074b1d29ah
dd 0ead54739h, 09dd277afh, 004db2615h, 073dc1683h
dd 0e3630b12h, 094643b84h, 00d6d6a3eh, 07a6a5aa8h
dd 0e40ecf0bh, 09309ff9dh, 00a00ae27h, 07d079eb1h
; 9
dd 0f00f9344h, 08708a3d2h, 01e01f268h, 06906c2feh
dd 0f762575dh, 0806567cbh, 0196c3671h, 06e6b06e7h
dd 0fed41b76h, 089d32be0h, 010da7a5ah, 067dd4acch
dd 0f9b9df6fh, 08ebeeff9h, 017b7be43h, 060b08ed5h
; A
dd 0d6d6a3e8h, 0a1d1937eh, 038d8c2c4h, 04fdff252h
dd 0d1bb67f1h, 0a6bc5767h, 03fb506ddh, 048b2364bh
dd 0d80d2bdah, 0af0a1b4ch, 036034af6h, 041047a60h
dd 0df60efc3h, 0a867df55h, 0316e8eefh, 04669be79h
; B
dd 0cb61b38ch, 0bc66831ah, 0256fd2a0h, 05268e236h
dd 0cc0c7795h, 0bb0b4703h, 0220216b9h, 05505262fh
dd 0c5ba3bbeh, 0b2bd0b28h, 02bb45a92h, 05cb36a04h
dd 0c2d7ffa7h, 0b5d0cf31h, 02cd99e8bh, 05bdeae1dh
; C
dd 09b64c2b0h, 0ec63f226h, 0756aa39ch, 0026d930ah
dd 09c0906a9h, 0eb0e363fh, 072076785h, 005005713h
dd 095bf4a82h, 0e2b87a14h, 07bb12baeh, 00cb61b38h
dd 092d28e9bh, 0e5d5be0dh, 07cdcefb7h, 00bdbdf21h
; D
dd 086d3d2d4h, 0f1d4e242h, 068ddb3f8h, 01fda836eh
dd 081be16cdh, 0f6b9265bh, 06fb077e1h, 018b74777h
dd 088085ae6h, 0ff0f6a70h, 066063bcah, 011010b5ch
dd 08f659effh, 0f862ae69h, 0616bffd3h, 0166ccf45h
; E
dd 0a00ae278h, 0d70dd2eeh, 04e048354h, 03903b3c2h
dd 0a7672661h, 0d06016f7h, 04969474dh, 03e6e77dbh
dd 0aed16a4ah, 0d9d65adch, 040df0b66h, 037d83bf0h
dd 0a9bcae53h, 0debb9ec5h, 047b2cf7fh, 030b5ffe9h
; F
dd 0bdbdf21ch, 0cabac28ah, 053b39330h, 024b4a3a6h
dd 0bad03605h, 0cdd70693h, 054de5729h, 023d967bfh
dd 0b3667a2eh, 0c4614ab8h, 05d681b02h, 02a6f2b94h
dd 0b40bbe37h, 0c30c8ea1h, 05a05df1bh, 02d02ef8dh


end</pre>
<br><br><font size="1"><i>-----<br>Я медленно снимаю с неё UPX... *FF_User*</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=14778&amp;user=175&amp;forum_n=1&amp;topic=1346.html&amp;page=0&amp;anchor=5" class="addthx" data-post="14778"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вопросы по CRC32.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#6" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="1346">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=1346" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
