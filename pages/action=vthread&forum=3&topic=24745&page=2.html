<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>new Syser Debugger by reversecode - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT=" история реверса в оффтопе кто не видел --&gt; Link &lt;-- благодарностей не надо, багов наверняка там еще много, как собственных так и в процесса реверса, TODO тоже еще есть но в целом уже можно запустить, трейсить, ставить бп,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41144'>Adler</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=42623'>site-pro</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> new Syser Debugger by reversecode</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=24745&amp;page=1.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=24745&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=3&amp;topic=24745&amp;page=1.html">2</a> . <b>3</b> . <a href="action=vthread&amp;forum=3&amp;topic=24745&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=3&amp;topic=24745&amp;page=3.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 мая 2017 04:33 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#1');return false;">#1</a> </span><div align=left><br>
<img src="https://raw.githubusercontent.com/marakew/syser/master./images/SyserDebuggerx32.png" border="0" align="" alt=""><br><br>история реверса в оффтопе  кто не видел <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=24494" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br>благодарностей не надо,<br>багов наверняка там еще много, как собственных так и в процесса реверса, TODO тоже еще есть<br>но в целом уже можно запустить, трейсить, ставить бп, добавлять вотчи, даже плагины, итд<br><br>интересны моменты(багрепорты) когда дебаггер будет падать<br><br>x32/x64 https://www.sendspace.com/file/t4lpr5 - недоступна, в розыске последняя версия кто успел сохранить<br><br>4 июня 2017, 20:59:10<br>http://rgho.st/67jjLSRTg<br><br><br>1607 210517<br>add handle int 3 <br>fix mouse scroll<br>fix memory leak PEFile read import<br><br>0413 230517<br>fix crash on delete watch item<br>improve terminate debug<br>add FlushInstructionCache on WriteMemory<br>start debug from cmdline<br><br>2046 230517<br>improve reset(reload the input file) (WO hotkey)<br><br>1528 240517<br>hide BP(CCh) bytes from HexView, show original value<br>colored BP(code,data) in HexView<br>done re PopupMenu on HexView (hotkey not tested), operation toolbar in TODO<br>done re command(edit,move,compare) memory<br><br>0203 250517<br>done re ModuleList window<br>done re ascii/unicode string context ref<br>fix env path by add manifest<br><br>2224 250517<br>fix crash without dbg plugin<br>first build x64<br><br>1813 280517<br>fix mouse wheel scroll on x64<br>fix scroll by UPbtn bar<br>add ALT+ hotkey<br>fix fit hexview on x64<br>fix hexview change addr on edit addr area<br>fix align stackview on x64<br>fix str sym ref on \t<br>add resolve ctx ref on r8-r15 CPU reg x64<br>improve PE loader for x64, for resolve import/export sym<br>fix select bytes on hexview for x64<br>add show EB line jmp ref<br>chg addr/offs represent on codeview<br><br>0731 290517<br>fix PE Loader for x64, to read import/export for hibase &gt; 32bit, as example kernelbase.dll<br>done re sym command, allow show/add symbol/use it for set breakpoint<br>fix readpe onload file, for correct read sizeof file for x64<br>fix search module range and module info status for x64<br><br>1258 040617<br>fix disable load x86 on syser x64<br>fix fmt fit addr exception violation on syser x64<br>fix PID/TID status and expr var<br>fix fit addr tab in code/data view for x64<br>fix &#039;p ret&#039; cmd, run to return<br>implement SDK menu api<br>done re process list window (attach work, detach from target at todo)<br>starting re peexplorer window<br><br>1559 040617<br>fix load SyserColor.cfg from old SyserOption.exe util https://www.sendspace.com/file/l7r3pw<br><br>2058 040617<br>improve highlight keyword<br><br>api и пример плагина в архиве дистрибутива<br><br>x32<br><br><img src="http://meson.ad-l.ink/7wvwRdpPD/image.png" border="0" align="" alt=""><br><br>x64<br><img src="http://polariton.ad-l.ink/7qpvNZqYX/image.png" border="0" align="" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376045&amp;user=15381&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=1" class="addthx" data-post="376045"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31325" title="21-05-2017 01:39, ранг:12.1" target="_blank">zNob</a>, <a href="action=userinfo&user=40990" title="21-05-2017 01:48, ранг:96.4" target="_blank">difexacaw</a>, <a href="action=userinfo&user=41575" title="21-05-2017 01:56, ранг:35.7" target="_blank">shellstorm</a>, <a href="action=userinfo&user=4773" title="21-05-2017 02:01, ранг:243.8" target="_blank">plutos</a>, <a href="action=userinfo&user=11966" title="21-05-2017 02:07, ранг:502.7" target="_blank">r_e</a>, <a href="action=userinfo&user=35473" title="21-05-2017 05:09, ранг:278.8" target="_blank">dosprog</a>, <a href="action=userinfo&user=18316" title="21-05-2017 05:47, ранг:227.2" target="_blank">SReg</a>, <a href="action=userinfo&user=36838" title="21-05-2017 06:45, ранг:2.7" target="_blank">DICI BF</a>, <a href="action=userinfo&user=39556" title="21-05-2017 07:23, ранг:7.3" target="_blank">sefkrd</a>, <a href="action=userinfo&user=4554" title="21-05-2017 07:54, ранг:216.4" target="_blank">HandMill</a>, <a href="action=userinfo&user=3136" title="21-05-2017 08:58, ранг:297.2" target="_blank">Veliant</a>, <a href="action=userinfo&user=2777" title="21-05-2017 10:28, ранг:504.3" target="_blank">daFix</a>, <a href="action=userinfo&user=20406" title="21-05-2017 11:05, ранг:224.8" target="_blank">Vamit</a>, <a href="action=userinfo&user=26651" title="21-05-2017 12:17, ранг:321.5" target="_blank">ELF_7719116</a>, <a href="action=userinfo&user=35168" title="21-05-2017 13:12, ранг:64.1" target="_blank">v00doo</a>, <a href="action=userinfo&user=31506" title="21-05-2017 19:11, ранг:15.3" target="_blank">VanHelsing</a>, <a href="action=userinfo&user=28512" title="21-05-2017 22:10, ранг:56.4" target="_blank">-Sanchez-</a>, <a href="action=userinfo&user=33253" title="21-05-2017 23:45, ранг:16.6" target="_blank">Abraham</a>, <a href="action=userinfo&user=3520" title="22-05-2017 05:14, ранг:586.8" target="_blank">mak</a>, <a href="action=userinfo&user=7963" title="22-05-2017 06:03, ранг:118.0" target="_blank">Hugo Chaves</a>, <a href="action=userinfo&user=23665" title="22-05-2017 08:10, ранг:0.1" target="_blank">raiser</a>, <a href="action=userinfo&user=28841" title="22-05-2017 08:12, ранг:100.5" target="_blank">vden</a>, <a href="action=userinfo&user=16624" title="22-05-2017 13:06, ранг:280.9" target="_blank">MasterSoft</a>, <a href="action=userinfo&user=4109" title="23-05-2017 22:47, ранг:3.2" target="_blank">MarcElBichon</a>, <a href="action=userinfo&user=29" title="26-05-2017 04:19, ранг:384.1" target="_blank">nice</a>, <a href="action=userinfo&user=27483" title="26-05-2017 05:28, ранг:0.0" target="_blank">chessgod101</a>, <a href="action=userinfo&user=3062" title="26-05-2017 19:50, ранг:0.0" target="_blank">stnt</a>, <a href="action=userinfo&user=1931" title="30-05-2017 16:07, ранг:704.0" target="_blank">4kusNick</a>, <a href="action=userinfo&user=3756" title="31-05-2017 09:43, ранг:56.6" target="_blank">==DJ==[ZLO]</a>, <a href="action=userinfo&user=5846" title="01-06-2017 02:28, ранг:34.8" target="_blank">VOLKOFF</a>, <a href="action=userinfo&user=17432" title="01-06-2017 12:06, ранг:454.9" target="_blank">ClockMan</a>, <a href="action=userinfo&user=6052" title="05-07-2017 11:56, ранг:3.1" target="_blank">freudz</a>, <a href="action=userinfo&user=25008" title="30-09-2017 16:24, ранг:22.4" target="_blank">Dazz</a></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2017 00:24 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#2');return false;">#2</a> </span><div align=left><br>
F11 step branch о котором я писал последний раз в офтопе, перечитайте<br>его даже в x64dbg хотели добавлять....<br>он не реализован в ring3 сисера, только в ring0 есть<br>там нужен доступ на запись в MSR<br>или DR7... и хз даст ли винда поменять там тот бит... надо экспериментировать, тестировать.. посему пока будет как стептрейс<br><br>дизасм да, сыроватый, китайцы его наверное особо и не тестили
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376238&amp;user=15381&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=2" class="addthx" data-post="376238"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=41575" title="27-05-2017 06:03, ранг:39.7" target="_blank">shellstorm</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Haoose-GP[/b]','')">Haoose-GP</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/29223.gif" alt=""><br><span class=txtSm>Ранг: 62.3 (постоянный), 51thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.13'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=29223">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2017 00:43 &middot; Поправил: Haoose-GP <br><script type="text/javascript">QU('Haoose-GP','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Haoose-GP" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#3');return false;">#3</a> </span><div align=left><br>
<b>reversecode</b><br>x64 - вверх скроллится, вниз - не реагирует. x32 - и туда и сюда работает.<br>В обоих - не работают горячие клавиши Alt+{что-нибудь}. Ctrl+1/2 - работают.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376239&amp;user=29223&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=3" class="addthx" data-post="376239"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2017 12:39 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#4');return false;">#4</a> </span><div align=left><br>
Поддержу немного тему.<br>Плагин-хайдер для нового сайсера.<br><noindex><a href="https://yadi.sk/d/L0UKb6QK3JYPRY" rel="nofollow" target="_blank">https://yadi.sk/d/L0UKb6QK3JYPRY</a></noindex><br><noindex><a href="https://www.sendspace.com/file/hwp40a" rel="nofollow" target="_blank">https://www.sendspace.com/file/hwp40a</a></noindex><br>Распаковывать так же как и размещены в архиве - syser_hide.dll в Plugins, hide_generic.dll рядом с главным exe.<br><br>Кто хочет, может использовать hide_generic.dll в своих проектах. Грузится отладчиком через LoadLibrary и больше ничего делать не надо. Библиотека устанавливает хук на ZwWaitForDebugEvent в процессе отладчика и из обработчика устанавливаются все остальные хуки и патчится память в отлаживаемом процессе.<br>Конфиг зашит в самой dll в конце файла в виде ([\x00] - выключено, любой другой символ - включено):<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">ZwQueryInformationProcess<span class="hl_char">[</span>x<span class="hl_char">]</span></li><li class="hl_l1">ZwSetInformationThread<span class="hl_char">[</span>x<span class="hl_char">]</span></li><li class="hl_l0">ZwClose<span class="hl_char">[</span>x<span class="hl_char">]</span></li><li class="hl_l1">NtGlobalFlag<span class="hl_char">[</span>x<span class="hl_char">]</span></li><li class="hl_l0">ProcessHeapFlag<span class="hl_char">[</span>x<span class="hl_char">]</span></li><li class="hl_l1">IsDebuggerPresent<span class="hl_char">[</span>x<span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br>Тестовый пример под отладкой<br><img src="http://www.picshare.ru/uploads/170526/0w9FatLJEb.png" border="0" align="" alt=""><br><br>Upd: сам же нашел баг... в режиме syswow64 хуки не ставятся тк код отличается от версии x86
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376251&amp;user=3136&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=4" class="addthx" data-post="376251"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=2585" title="26-05-2017 11:42, ранг:1025.9" target="_blank">Gideon Vi</a>, <a href="action=userinfo&user=14629" title="26-05-2017 18:14, ранг:442.1" target="_blank">sendersu</a>, <a href="action=userinfo&user=29" title="27-05-2017 04:30, ранг:384.1" target="_blank">nice</a>, <a href="action=userinfo&user=21426" title="27-05-2017 18:59, ранг:58.6" target="_blank">Dart Raiden</a>, <a href="action=userinfo&user=36838" title="27-05-2017 20:33, ранг:2.7" target="_blank">DICI BF</a>, <a href="action=userinfo&user=35473" title="28-05-2017 16:57, ранг:281.5" target="_blank">dosprog</a>, <a href="action=userinfo&user=1931" title="30-05-2017 16:07, ранг:704.0" target="_blank">4kusNick</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2017 19:06 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#5');return false;">#5</a> </span><div align=left><br>
обновил, много всяких багов все еще в портировании на x64<br>долго фиксил peloader под x64 для резолва символов в дизасме, надеюсь все гуд<br><br>1813 280517<br>fix mouse wheel scroll on x64<br>fix scroll by UPbtn bar<br>add ALT+ hotkey<br>fix fit hexview on x64<br>fix hexview change addr on edit addr area<br>fix align stackview on x64<br>fix str sym ref on \t<br>add resolve ctx ref on r8-r15 CPU reg x64<br>improve PE loader for x64, for resolve import/export sym<br>fix select bytes on hexview for x64<br>add show EB line jmp ref<br>chg addr/offs represent on codeview
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376328&amp;user=15381&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=5" class="addthx" data-post="376328"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3230" title="28-05-2017 18:36, ранг:180.1" target="_blank">Bronco</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2017 19:20 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#6');return false;">#6</a> </span><div align=left><br>
<I>Veliant пишет:<br>Плагин-хайдер для нового сайсера. <br></I><br><strike>Что-то не качается ничего по обеим ссылкам. <br>Первая вообще не раскрывается,<br>по второй пишут, что &quot;File unavailable&quot;.<br>Так и должно быть?<br>И иди знай, то ли это связано со всякими блокировками вконтактиков, то ли не связано, хз  </strike><br><br>updated<br>.. Вроде скачал.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376330&amp;user=35473&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=6" class="addthx" data-post="376330"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 07:42 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#7');return false;">#7</a> </span><div align=left><br>
продолжаем фиксить x64, обновил еще<br><br>0731 290517<br>fix PE Loader for x64, to read import/export for hibase &gt; 32bit, as example kernelbase.dll<br>done re sym command, allow show/add symbol/use it for set breakpoint<br>fix readpe onload file, for correct read sizeof file for x64<br>fix search module range and module info status for x64
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376365&amp;user=15381&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=7" class="addthx" data-post="376365"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]TryAga1n[/b]','')">TryAga1n</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 262.5 (наставник), 337thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.45'>Активность: 0.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=31275">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 13:38 &middot; Поправил: TryAga1n <br><script type="text/javascript">QU('TryAga1n','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TryAga1n" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#8');return false;">#8</a> </span><div align=left><br>
<I>reversecode пишет:<br>интересны моменты(багрепорты) когда дебаггер будет падать </I><br>64 битная версия:<br>При поптыке открыть x86 приложение, все намертво зависает.<br><br>32 битная версия:<br>При попытке открыть незапротекченое Microsoft Visual C#11 приложение, висит.<br>Если EP находится в хидере, так же получаем полный висяк.<br>C нулевым EP тоже висит.<br>Решение хз, наверное криво написан парсер хидера
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376370&amp;user=31275&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=8" class="addthx" data-post="376370"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 14:08 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#9');return false;">#9</a> </span><div align=left><br>
с такими баг репортами можете сразу и фиксы предлагать  <img src="img/smilies/s5.gif" alt=""><br><br>про первый знаю, уже столкнулся, но не разбирался.. <br>хз должен же наверное CreateProcess как то говорить что не может создать процесс ?<br><br>а второе даже и пробовать не с чем, шарпа вроде и нет под рукой.. в винде разве что поискать<br><br><b>Добавлено спустя 5 минут</b><br>http://bbs.pediy.com/thread-217773.htm<br>китайцы про обсид что то пишут, я так думаю там акксес виолайшин из за протекта ? т.е. не баг ? <br>или нужно сделать что бы игнорились эксепшены как в ольке ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376371&amp;user=15381&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=9" class="addthx" data-post="376371"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]TryAga1n[/b]','')">TryAga1n</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 262.5 (наставник), 337thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.45'>Активность: 0.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=31275">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 14:14 <br><script type="text/javascript">QU('TryAga1n','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TryAga1n" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#10');return false;">#10</a> </span><div align=left><br>
<I>reversecode пишет:<br>или нужно сделать что бы игнорились эксепшены как в ольке </I><br>если после эксепшенов можно дебажить, то пусть вылазят. в идеале конечно сделать опциональный игнор эксепшенов по коду, как в ольке.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376372&amp;user=31275&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=10" class="addthx" data-post="376372"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 14:14 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#11');return false;">#11</a> </span><div align=left><br>
<I>TryAga1n пишет:<br>Решение хз, наверное криво написан парсер хидера  </I><br>дебагер не парсит файлы которые запускает. банальный CreateProcess<br>должно видной обслуживаться и как то сигнализировать какими то ласт еррорами как минимум
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376373&amp;user=15381&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=11" class="addthx" data-post="376373"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]TryAga1n[/b]','')">TryAga1n</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 262.5 (наставник), 337thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.45'>Активность: 0.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=31275">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 14:17 <br><script type="text/javascript">QU('TryAga1n','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TryAga1n" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#12');return false;">#12</a> </span><div align=left><br>
<I>reversecode пишет:<br>банальный CreateProcess </I><br>Ну тогда как минимум его нужно делать не из MainThread&#039;a, а то очень не приятно, когда интерфейс зависает и приходится постоянно килять процесс через диспетчер <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376374&amp;user=31275&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=12" class="addthx" data-post="376374"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 14:20 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#13');return false;">#13</a> </span><div align=left><br>
да надо будет для начала посмотреть где там что там и от чего оно лагает<br><br>банальный парсер PE в сисере есть, <br>заставить его открывать и смотреть хидеры перед пиханием в крейт процесс. дело не сложное<br><br>отточить базовое ядро только для начала надо
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376375&amp;user=15381&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=13" class="addthx" data-post="376375"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]OKOB[/b]','')">OKOB</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6801.png" alt=""><br><span class=txtSm>Ранг: 527.7 (<b>!</b>), 381thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.78'>Активность: 0.16<span style='color:red'>&searr;</span>0.09</span><br>Статус: <a href="action=userinfo&amp;user=6801">Участник</a><br><font color=blue><font color=red>Победитель турнира 2010</font></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 14:57 <br><script type="text/javascript">QU('OKOB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OKOB" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#14');return false;">#14</a> </span><div align=left><br>
<I>reversecode пишет:<br>а второе даже и пробовать не с чем, шарпа вроде и нет под рукой.. в винде разве что поискать </I><br><br>Извращения Corkami над РЕ форматом<br>https://github.com/corkami/pocs/tree/master/PE<br>и тут, если полистать<br>https://code.google.com/archive/p/corkami/downloads?page=1
<br><br><font size="1"><i>-----<br>127.0.0.1, sweet 127.0.0.1</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=376379&amp;user=6801&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=14" class="addthx" data-post="376379"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 18:14 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#15');return false;">#15</a> </span><div align=left><br>
в этом нужен будет совет, от тех кто сражаются с пакерами и протекторами<br>можно полагаться на pe header всегда ? чувствительна ли к нему винда  ?<br><br>а то что бы не вышло так что я поставлю условие на проверку к примеру архитектуры, опшион хеадера, гуи систем<br><br>а потом окажется что какие то файлы их не проходят, а винда вообще плюет на все это и тупо запускает...<br><br>так что нужен совет какие данные брать  для проверки формата на валидность для запуска в отладчике
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376386&amp;user=15381&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=15" class="addthx" data-post="376386"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 18:21 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#16');return false;">#16</a> </span><div align=left><br>
Что касается архитектуры - можешь полагаться на PE заголовок.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=376387&amp;user=11966&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=16" class="addthx" data-post="376387"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Djeck[/b]','')">Djeck</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 196.0 (ветеран), 72thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.2'>Активность: 0.14<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=11304">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 19:10 <br><script type="text/javascript">QU('Djeck','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Djeck" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#17');return false;">#17</a> </span><div align=left><br>
<I>reversecode пишет:<br>китайцы про обсид что то пишут, я так думаю там акксес виолайшин из за протекта ? т.е. не баг ?  </I><br><br>Видимо да. Обсид эксепшны кидает дай бог.Неверные команды, деление на ноль и т.д.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376388&amp;user=11304&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=17" class="addthx" data-post="376388"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 20:17 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#18');return false;">#18</a> </span><div align=left><br>
<I>reversecode пишет:<br> какие данные брать для проверки формата на валидность для запуска в отладчике  <br></I><br>Так пускай CreateProcess() и проверяет. - так ли уж необходимо это усложнять?<br><br><I>reversecode пишет:<br>дебагер не парсит файлы которые запускает. банальный CreateProcess <br></I><br>Ну и нормально (?)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376390&amp;user=35473&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=18" class="addthx" data-post="376390"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 20:33 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#19');return false;">#19</a> </span><div align=left><br>
я пока еще не смотрел в чем там проблема, но<br><br>судя по всему одного CreateProcess мало, и оно там(в винде) не проверяет что запускает<br>сорс отладчика есть в офтопе, там проверка если CreateProcess вернет 0,<br>ноль не возвращает, иначе бы отлуп был по открытию файла...<br>значит винда ничего не проверяет..... и возвращает не ноль
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376391&amp;user=15381&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=19" class="addthx" data-post="376391"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 20:36 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#20');return false;">#20</a> </span><div align=left><br>
<b>reversecode</b><br><br>&gt;  какие данные брать для проверки формата на валидность для запуска в отладчике <br><br>Модуль валидный, если он может быть загружен. Следовательно для валидации его нужно загрузить штатными средствами, к примеру создать файловую секцию(SEC_IMAGE) и если она будет успешно создана, то образ валид.<br>Процесс создать тоже самое по сути, тоже образ мапится, но только там левые механизмы используются, так что излишне.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=376392&amp;user=40990&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=20" class="addthx" data-post="376392"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 20:54 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#21');return false;">#21</a> </span><div align=left><br>
поигрался с STEP BRANCH<br>обсуждал ранее в офтопе<br>не заводится он...<br>краткий екскурс, винда позволяет через DR7 бит 8 и 9 добираться до MSR 0x1D9<br>ставим TF в EFLAGS<br>и 9 бит в DR7 (тоже что и 2 бит в 0x1D9)<br>и должны генерится #DB которые должна ловить WaitForDebugEvent<br><br>ставим оба флага, отпускаем треид<br>и<br>выполнения пролетает мимо всех инструкций, как будто никаких TF и BTF не стоит вообще<br>и завершается<br>никаких других евентов в WaitForDebugEvent кроме терминейта, не приходит...<br>т.е. установленный 9 бит в DR7 что то делает, только делает что то странное, ощущения что вообще степ трейс отключает<br>причем если бы он не устанавливался, то работал бы установленный TF в EFLAGS,<br>а так получается и TF игнорится... загадка<br><br>ех жаль, такая хорошая идея пропала<br><br>смотрел в свой ntoskrnl.exe<br>все присутствует, т.е. код который позволяет через DR7 9 бит включать BTF , есть<br>значит где то в другом собака зарыта...<br>заресечил бы кто ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376393&amp;user=15381&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=21" class="addthx" data-post="376393"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 21:12 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#22');return false;">#22</a> </span><div align=left><br>
<b>reversecode</b><br><br>На скайлайке если не ошибаюсь только отображение мср на др, не юзайте это. Это фича нового железа.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=376394&amp;user=40990&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=22" class="addthx" data-post="376394"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 21:33 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#23');return false;">#23</a> </span><div align=left><br>
core2duo и всякие Corei5 и выше это не такое уж и новое железо))<br>и оно не отображается, оно меняет<br><br><span style="word-break: break-all">http://gate.upm.ro/os/LABs/Windows_OS_Internals_Curriculum_Resource_Kit-ACADEMIC/WindowsResearchKernel-WRK/WRK-v1.2/base/ntos/ke/amd64/procstat.asm</span><br>вот пример из старого врк для амд<br>для интелла там только проверка на интел
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376395&amp;user=15381&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=23" class="addthx" data-post="376395"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 21:48 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#24');return false;">#24</a> </span><div align=left><br>
<b>reversecode</b><br><br>В том году разбирали это на r0crew. Оказалось что железячная фича и ось не причём, но я не помню подробности, в принципе могу попробовать поискать, если телеграм хранит логи. Если хотите правильно сделать, то нужно почитать доки Интела по порту сей фичи и её поддержку, затем определить камень и что он поддерживает этот механизм, как обычно cpuid.<br>Может лучше это сделать стандартными методами - драйвер, msr, branch trace.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=376396&amp;user=40990&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=24" class="addthx" data-post="376396"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2017 21:56 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#25');return false;">#25</a> </span><div align=left><br>
ну так естесно железная фитча MSR<br>но достучаться к MSR можно только в r0<br>а тут оказывается винда дает бекдор к этим регистрам, через биты DR7 регистра в r3<br>только вот все равно не работает...<br><br>ладно, разобрался с запуском x86 прог на x64 дебагере<br>CreateProcess работает, а чего ему собственно не работать, он то в емуляторе пускает, <br>все верно, вот только дебаг евенты уже другие приходят STATUS_WX86_BREAKPOINT<br>//Exception status code used by Win32 x86 emulation subsystem<br>такие не хендлятся, вот оно и висит в бесконечном цикле....<br><br>так что надо ставить какую то проверку, созданный ли процесс через CreateProcess emu или нет<br>если на 64 и emu, значит тушим и выходим<br><br>по хорошему я бы сделал что бы x64 дебагером и x86 проги можно было отлаживать... но думаю утону<br>пусть это будет в TODO<br>а сейчас это просто как то ловить и зарезать такие проги<br><br><b>Добавлено спустя 28 минут</b><br>отладка x86 на x64 исправлена через IsWow64Process
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376397&amp;user=15381&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=25" class="addthx" data-post="376397"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 мая 2017 08:19 &middot; Поправил: spinz <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#26');return false;">#26</a> </span><div align=left><br>
<I>reversecode пишет:<br>ставим TF в EFLAGS<br>и 9 бит в DR7 (тоже что и 2 бит в 0x1D9)<br>и должны генерится #DB которые должна ловить WaitForDebugEvent<br> </I><br>BTF - это же бит 1, бит 2 - reserved
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376412&amp;user=22831&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=26" class="addthx" data-post="376412"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 мая 2017 12:13 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#27');return false;">#27</a> </span><div align=left><br>
ну не бит, число<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>char</b></span>&nbsp;__cdecl&nbsp;SetBTF_sub_194C8<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v1<span class="hl_comment">; // [esp+0h] [ebp-8h]@3</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v2<span class="hl_comment">; // [esp+4h] [ebp-4h]@3</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span>BTF_PRESENT_byte_160200&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadMSR_X_sub_19436<span class="hl_char">(</span>0x1D9<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>v1<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>v2<span class="hl_char">)</span><span class="hl_comment">;   // #define IA32_DEBUGCTL                           0x1D9</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v2&nbsp;<span class="hl_char">|</span><span class="hl_char">=</span>&nbsp;2u<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WriteMSR_X_sub_19492<span class="hl_char">(</span>0x1D9<span class="hl_char">,</span>&nbsp;v1<span class="hl_char">,</span>&nbsp;v2<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br><br><b>Добавлено спустя 5 часов 1 минуту</b><br><br><br><b>spinz</b><br>не помню, есть разве разница в каком порядке грудятся drx регистры ? __writedr это непосредственная запись mov dr0, итд<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;loadDR_213067_sub_4635C<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__writedr<span class="hl_char">(</span>2u<span class="hl_char">,</span>&nbsp;DRx_dword_1605C0<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__writedr<span class="hl_char">(</span>1u<span class="hl_char">,</span>&nbsp;DRx_dword_1605C0<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__writedr<span class="hl_char">(</span>3u<span class="hl_char">,</span>&nbsp;DRx_dword_1605C0<span class="hl_char">[</span><span class="hl_number">3</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__writedr<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;DRx_dword_1605C0<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__writedr<span class="hl_char">(</span>6u<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__writedr<span class="hl_char">(</span>7u<span class="hl_char">,</span>&nbsp;DRx_dword_1605C0<span class="hl_char">[</span><span class="hl_number">7</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">&amp;</span>&nbsp;~0x2000u<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;load_DR_1234567_sub_46326<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__writedr<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;DRx_dword_1605C0<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__writedr<span class="hl_char">(</span>1u<span class="hl_char">,</span>&nbsp;DRx_dword_1605C0<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__writedr<span class="hl_char">(</span>2u<span class="hl_char">,</span>&nbsp;DRx_dword_1605C0<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__writedr<span class="hl_char">(</span>3u<span class="hl_char">,</span>&nbsp;DRx_dword_1605C0<span class="hl_char">[</span><span class="hl_number">3</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__writedr<span class="hl_char">(</span>6u<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__writedr<span class="hl_char">(</span>7u<span class="hl_char">,</span>&nbsp;DRx_dword_1605C0<span class="hl_char">[</span><span class="hl_number">7</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">&amp;</span>&nbsp;~0x2000u<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=376414&amp;user=15381&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=27" class="addthx" data-post="376414"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июня 2017 02:49 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#28');return false;">#28</a> </span><div align=left><br>
а под win64 SEH уже нету ? fs:[0]+0 уже не используется ?<br>а то что то ничего нагуглить не могу
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376475&amp;user=15381&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=28" class="addthx" data-post="376475"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июня 2017 03:32 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#29');return false;">#29</a> </span><div align=left><br>
<b>reversecode</b>, <noindex><a href="http://www.osronline.com/article.cfm?article=469" rel="nofollow" target="_blank">--&gt; тут &lt;--</a></noindex> можно посмотреть
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376476&amp;user=5846&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=29" class="addthx" data-post="376476"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июня 2017 03:38 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#30');return false;">#30</a> </span><div align=left><br>
<b>reversecode</b><br>посмотри плезир у себя, как сисер кодирует в архитектуре х64 инструкцию &quot;MOV REG, 0x80000000&quot;<br>в х64dbg какой то звиздец с этой константой. <br>XEDParse кодирует её отрицательной &quot;MOV REG, -0x80000000&quot;, или это косяк декодировки капстона. <br>AsmJit при асмбле выдаёт полную жесть &quot;41 B8 00 B4 C4 04| MOV R8D, 4C4B400&quot; <br>Один  Keystone иногда кодирует правильно &quot;49 B8 00 00 00 80 00 00 00 00| MOVABS R8, 80000000&quot;, но не всегда, чаще выдаёт такое же как и  AsmJit.
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=376477&amp;user=3230&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=30" class="addthx" data-post="376477"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июня 2017 04:02 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24745&amp;page=2#31');return false;">#31</a> </span><div align=left><br>
<b>VOLKOFF</b><br>та это я видел, но что ложится в fs там не показано, у чела в статье сразу кусок дизасма<br>где 0 строкой<br>&lt;00&gt; mov     [rsp+0x8],rcx<br>&lt;05&gt; sub     rsp,0x28<br><br>вообщем наверное нужно свои примеры сбилдить и посмотреть<br><br>нужно всего лишь для красивой разукраски стеквотча, для x86 не делал... и вот думаю если делать, то можно ли будет так и для x64 разукрасить...<br><br><b>Bronco</b><br>я асм еще не вытягивал с сисера, он там есть факт, но умеет ли 64 хз<br>вытягивать ли его тоже хз, <br>вамит сказал что без дизасма ему один асм не зачем<br>а дизасм в апи там  будет жесть...<br><br>но если отталиваться от того что сисер дизасмит,  то таким же образом я думаю он и ассемблит<br>а диасмит он так<br>DISASM 49 b8 00 00 00 80 00 00 00 00  Len 10 = &#039; mov r8,80000000&#039;<br><br><b>Добавлено спустя 1 час 9 минут</b><br>печаль, асм в сисере 16/32
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376478&amp;user=15381&amp;forum_n=3&amp;topic=24745&amp;page=2&amp;anchor=31" class="addthx" data-post="376478"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3230" title="01-06-2017 01:50, ранг:181.6" target="_blank">Bronco</a>, <a href="action=userinfo&user=14629" title="01-06-2017 03:16, ранг:443.4" target="_blank">sendersu</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=24745&amp;page=1.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=24745&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=3&amp;topic=24745&amp;page=1.html">2</a> . <b>3</b> . <a href="action=vthread&amp;forum=3&amp;topic=24745&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=3&amp;topic=24745&amp;page=3.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> new Syser Debugger by reversecode</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24745" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
