<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>StarForce 5.7 MMOG - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Есть одна игра - Prime World, которая совсем недавно была защищена с помощью StarForce 5.7 MMOG Мне нужно научиться обходить защиту или, что ещё лучше, научиться её снимать. Снятие защиты мне необходимо для поиска багов в игре. У">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a>, <a target='_blank' href='?action=userinfo&amp;user=55940'>exp50848</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> StarForce 5.7 MMOG</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=1&amp;topic=20449&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=1&amp;topic=20449&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Once[/b]','')">Once</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.71'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=33148">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2012 20:14 &middot; Поправил: Once <br><script type="text/javascript">QU('Once','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Once" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Есть одна игра - <noindex><a href="http://ru.playpw.com" rel="nofollow" target="_blank"><u>Prime World</u></a></noindex>, которая совсем недавно была защищена с помощью <noindex><a href="http://www.star-force.ru/solutions/product/starforce-mmog/" rel="nofollow" target="_blank"><u>StarForce 5.7 MMOG</u></a></noindex><br>Мне нужно научиться обходить защиту или, что ещё лучше, научиться её снимать.<br>Снятие защиты мне необходимо для поиска багов в игре.<br>У меня есть старая, не накрытая Старом версия.<br>Раньше сам exe&#039;шник весил мало и подтягивал все функции из dll, сейчас всё в одном exe.<br>Сама игра весит 1.7 GB, но я собрал необходимые файлы в архив:<br>Новая версия (20MB) - <noindex><a href="http://multi-up.com/780073" rel="nofollow" target="_blank"><u>http://multi-up.com/780073</u></a></noindex><br>Старая версия (12MB) - <noindex><a href="http://multi-up.com/780089" rel="nofollow" target="_blank"><u>http://multi-up.com/780089</u></a></noindex><br><br><br>То что нашел сам:<br>Файл PW_Game.exe защищён StarForce 5.70.37.002 MMOG<br><strike>BM вроде нету.</strike><br>Защитный модуль имеет название sakijapi.dll. В старой версии он имеется, но, похоже, не используется. Упакован UPX, распаковывается легко если надо.<br>Если запустить PW_Game.exe - появится MessageBox, который говорит, что нужно запустить лаунчер. Это нормально, т.к. PW_Game.exe запускается с набором параментров о сессии, логине, разрешении, и т.д. <br>Скрыть Olly помогает плагин фантом.<br>OEP - <b>00A094DD</b><br>В старой версии EP - <b>00401443</b><br>Сдампив на этом OEP без восстановления импорта, можно запустить дамп, но возникает исключение - деление на 0 в модуле защиты по адресу <b>015FDF57</b>.<br>Не знаю, нужно ли там восстанавливать импорт?<br>По адресу <b>00A092AC</b> происходит вызов Старовской функции, в которой вызывается <b>_initterm_e</b> (в старой версии exe&#039;шника вызов этой функции виден по адресу <b>00401212</b>), которая и вызывает функцию, в которой происходит исключение.<br><br>Не знаю куда дальше двигаться..<br>Если занопить <b>_initterm_e</b> и следом за ним <b>_initterm</b>, то исключение будет в ntdll<br>Эти initterm&#039;ы, как я понимаю, вызывают конструкторы классов, используемых в приложении, а может и нет =)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313430&amp;user=33148&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=1" class="addthx" data-post="313430"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2012 07:55 &middot; Поправил: Nightshade <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
Вм стара выделяет 2 или 3 куска памяти(таблица контекстов и сам контекст). Прилепляем к ехе новую секцию и при вызове VirtualAlloc, правим указатели на свою секцию. В итоге на оеп у нас все память вм в последней секции и все указатели на память вм всегда валидны. Ресурсы крайне редко защищены. Иногда бывает, что ресурсы в 2 разных секциях и надо собрать их в 1. <br>Такие дампы очень удобны для исследования вм.<br>CPUID не запатчить так просто. Перед этим надо снять защиту CRC. ВМ стара проверяет овердокуя адресов в вм на валидность. Чаще всего проверки вида (константа xor кусок_кода)=номер регистра в вм.<br> (кусок кода) xor (кусок кода) xor (кусок кода) xor (константа)= лента пикода вм. <br>Другой тип проверок, когда получают определенный адрес вм, в цикле складывают dword ы от адреса и ниже. А потом смотрят на сумму и делают прыжок на ошибку, если не сошлось.<br>Запатчишь небольшой кусок - получишь неверный номер регистра или нарушишь логику работы вм. Cpuid ов в коде от 200-300 до 1000. А теперь прикинь сколько у тебя будет ошибок. <br>В правильном дампе все проверки патчатся, а потом уже патчатся cpuid, апи и всякие fs[18] и fs[30]
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314065&amp;user=4618&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=2" class="addthx" data-post="314065"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2012 08:20 &middot; Поправил: MasterSoft <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<I>Pchelovod пишет:<br>Насколько я помню,она в 90% случаев запакована UPX ,и чтобы загрузить жертву в отладчик с распакованной dll нужно пропатчить проверку контрольной суммы (Старфорс кричит что файл заражен вирусов и типа галактика в опасности) </I><br>как патчить я уже писал, ничего там сложного нет, всё даже наоборот, но зачем вообще снимать с неё упх? ну хз, может для удобства...<br><br><I>Nightshade пишет:<br>Запатчишь небольшой кусок - получишь неверный номер регистра или нарушишь логику работы вм. Cpuid ов в коде от 200-300 до 1000. А теперь прикинь сколько у тебя будет ошибок.  </I><br>смотря где находиться этот кусок, он говорит про патч сразу после анпака дллки, (а ты смело подумал, что он цпуид уже патчить вздумал) патчицо одна инструкция в PSC_StartInitialization, как правило этого достаточно, чтобы всё работало без ошибок. по поводу патча чего-либо другого - полностью согласен.<br><br><I>Nightshade пишет:<br>Сам код(не в секции вм который) ничем не защищен и там можно патчить триалы, демы, проверки на упх и прочую ерунду. </I><br>+1<br><br><I>Nightshade пишет:<br>Как сцена вообще пропускает такие релизы? </I><br>так уж пошло, что в чужих релизах ковыряться не хорошо, поэтому думаю судят по работоспособности, работает - значит гуд.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314066&amp;user=16624&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=3" class="addthx" data-post="314066"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2012 08:29 &middot; Поправил: Nightshade <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
Вм распаковывается для того, чтобы красиво ее потом вырезать и приклеить только вм, без секции кода. Сам код(не в секции вм который) ничем не защищен и там можно патчить триалы, демы, проверки на упх и прочую ерунду.<br>Про патч я писал Veliant у, который предлагает патч cpuid на другую инструкцию.<br>В том кряке от скидов, где дамп вм, не запатченны антидампы. Как сцена вообще пропускает такие релизы?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314067&amp;user=4618&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=4" class="addthx" data-post="314067"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Pchelovod[/b]','')">Pchelovod</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=32468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2012 14:05 &middot; Поправил: Pchelovod <br><script type="text/javascript">QU('Pchelovod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pchelovod" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<I>Nightshade пишет:<br>CPUID не запатчить так просто. Перед этим надо снять защиту CRC. ВМ стара проверяет овердокуя адресов в вм на валидность </I><br>Если у нас дамп с приклеенной памятью,то его работа для ВМ ничем не отличается от запуска игры под эмулятором Daemon Tools с образа. Все адреса ВМ должны быть как в оригинале,иначе у вас даже дамп с привязкой к одному CPU не будет работать. Поэтому не совсем понятен смысл данной фразы
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314074&amp;user=32468&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=5" class="addthx" data-post="314074"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2012 14:23 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
<b>Pchelovod</b><br>Имеется ввиду дамп, работающий не только на вашей машине. Правильно подправленный дамп будет запускаться и у других, а для этого надо что-то делать с cpuid. Выше и предложены варианты, что именно надо делать и как.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=314077&amp;user=6336&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=6" class="addthx" data-post="314077"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Pchelovod[/b]','')">Pchelovod</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=32468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2012 17:52 &middot; Поправил: Pchelovod <br><script type="text/javascript">QU('Pchelovod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pchelovod" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Да это уже ежу давно понятно. Он пишет что &quot;ВМ стара проверяет овердокуя адресов в вм на валидность &quot;, а я говорю что ВМ стара и без вашего cpuid проверяет кучу адресов. Иными словами,никакой разницы в работе виртуальной машины нет если это дамп с полностью приклеянной памятью<br>И вообще не вижу смысла в ваших демагогиях на эту тему: завсегдатаи форума заниматься этим не хотят,кроме Veliant ,а новичкам ваши рассуждения ни к чему.Им нужны мануалы в картинках
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314082&amp;user=32468&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=7" class="addthx" data-post="314082"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2012 10:19 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<I>Nightshade пишет:<br>Как сцена вообще пропускает такие релизы? </I><br><br>RIP и уже давненько. Сейчас, как верно заметил <b>MasterSoft</b>, &quot;лишь бы хоть как-то работало&quot;. Время чудес, к стати, любой мало-мальски грамотный реверсер может стать королем.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314101&amp;user=2585&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=8" class="addthx" data-post="314101"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Pchelovod[/b]','')">Pchelovod</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=32468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2012 18:48 <br><script type="text/javascript">QU('Pchelovod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pchelovod" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
Что делать,если в полученном дампе нет инструкций 0F A2 CPUID?<br>Трасса в аттаче<br><br><img src="img/attach.gif" alt=""> <a href="./files/0577_10.11.2012_EXELAB.rU.tgz">0577_10.11.2012_EXELAB.rU.tgz</a> - rtrace.txt
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314130&amp;user=32468&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=9" class="addthx" data-post="314130"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2012 20:30 &middot; Поправил: ELF_7719116 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
<I>Pchelovod пишет:<br>Что делать,если в полученном дампе нет инструкций 0F A2 CPUID? </I><br>Они все в выделенной памяти.<br><br>Почитал и стало интересно. VM старфорса толком не исследовал. Поэтому не совсем понимаю, что мешает, как в SecuROM VM полностью перестроить aka выдрать привязку? Там все достаточно просто - CPUID идет на декодирование таблицы &quot;островков&quot;; запретив шифрование на первом островке, выдираем декодер в нем и остальных 254 (их же адреса известны из таблицы). По времени конечно придется посидеть (удобно написать визуализатор) - но ведь работает!<br><br><b>ADD:</b> Или <b>самый быстрый способ с минимальныйми переделками</b> - в дампе, перед первым заходом в VM, сами перекодируем таблицу дельта-смещений с текущим CPUID...PROFIT!<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314135&amp;user=26651&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=10" class="addthx" data-post="314135"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Pchelovod[/b]','')">Pchelovod</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=32468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2012 20:49 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('Pchelovod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pchelovod" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
Так всё равно ничего не понятно.Кто может поясните на примере,как это сделать.Достаточно 1 адреса, остальные 254 доделаем сами. Вот 3 рабочих дампа разных без фикса cpuid:<br>http://depositfiles.com/files/51izhm4f2<br>http://depositfiles.com/files/h9g3x1xxi<br>http://depositfiles.com/files/swqzr9emb<br><br>Рабочих означает что там уже всё что нужно приклеено,пофиксено и восстановлено. Но пашет только на 1 процессоре<br><br>Если бы можно было эмулировать CPUID ,то проблема решилась проще.Делаем 1 дамп,пишем лоадер который подсунет дампу вместо реального идентификатора процессора &quot;правильный&quot; и всё работало.<br>Но как я понимаю сделать это нельзя,потому что значение берется напрямую из железа?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314137&amp;user=32468&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=11" class="addthx" data-post="314137"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2012 21:07 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
<I>Pchelovod пишет:<br>Но как я понимаю сделать это нельзя,потому что значение берется напрямую из железа </I><br>Ага! CPUID по сути обычная инструкция, поэтому проблема одна - надо знать когда и где она вызывается. Тут два варианта - ставить перед входом в VM свой обработчик и править опкод 0F A2 на 0F 0B (UD2) чтоб получить исключение и подсунуть нужные данные (далеко не факт, что подправим абсолютно все и там где надо - проектор можен шифровать критические участки своего кода) <i class=x>OR</i> заниматься самотрейсингом, проверяя каждую инструкцию на предмет схожести с CPUID... но это слишком медленно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314142&amp;user=26651&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=12" class="addthx" data-post="314142"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2012 21:49 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<I>Pchelovod пишет:<br>Если бы можно было эмулировать CPUID </I><br>http://deroko.phearless.org/cpuid_break.rar <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314146&amp;user=16624&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=13" class="addthx" data-post="314146"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2012 22:57 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
еще раз повторяю. нельзя патчить cpuid на другие инструкции. вм перестанет работать. кроме того. стар активно использует эксепшены для стирания железных бряков. и ваше исключение уйдет стару, а не вам
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314147&amp;user=4618&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=14" class="addthx" data-post="314147"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 ноября 2012 12:10 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
<b>Nightshade</b><br>Каким образом в старфорсе CPUID используется? Что шифруется?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314165&amp;user=26651&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=15" class="addthx" data-post="314165"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 ноября 2012 17:09 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
При запуске значения cpuid шифруются. Потом в вм закриптованное значение расшифровывают и сравнивают с текущим. Не совпало - топаем на йух
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314176&amp;user=4618&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=16" class="addthx" data-post="314176"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 ноября 2012 21:13 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
По выложенному выше трейсу где можно распарсил формат команд. Остальные надо смотреть.<br><br>Пасс к архиву дефолтный для раздела &quot;скачать&quot; этого ресурса.<br>f1-f4 - флаги<br>r1-r3 - регистры<br>a - адреса<br>o - опкод<br>c - константа<br><br><img src="img/attach.gif" alt=""> <a href="./files/5686_11.11.2012_EXELAB.rU.tgz">5686_11.11.2012_EXELAB.rU.tgz</a> - op_format.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314184&amp;user=3136&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=17" class="addthx" data-post="314184"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 ноября 2012 07:56 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
а можно пароль в личку?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314192&amp;user=4618&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=18" class="addthx" data-post="314192"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 ноября 2012 09:49 &middot; Поправил: ClockMan <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
<img src="http://exelab.ru./images/info.png" border="0" align="" alt="">
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=314194&amp;user=17432&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=19" class="addthx" data-post="314194"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 ноября 2012 09:53 &middot; Поправил: Nightshade <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
я тебя могу обрадовать. Смещения в ленте вм не постоянны и меняются в каждом билде. Такую таблицу декомпиль должен создавать сам. Руками парсить нет смысла.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314195&amp;user=4618&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=20" class="addthx" data-post="314195"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 ноября 2012 11:19 <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
<I>Nightshade пишет:<br>я тебя могу обрадовать. Смещения в ленте вм не постоянны и меняются в каждом билде. Такую таблицу декомпиль должен создавать сам. Руками парсить нет смысла. </I><br>Да вообще-то я в курсе. А тк декомпиля у меня пока нет, то сделал руками. Да и заняло это не так много времени.<br>Впринципе статически это не так сложно распарсить, можно даже масками.<br>Все биты читаются reg = dword [edi+20+n]/shr reg, a/and reg, b.<br>Для начала надо сделать нормальное извлечение кода без левых переходов. В моем представлении надо смотреть последовательно команды и записывать какие флаги они изменяют, потом в случае всяких stc/jc просто отбрасывать ветвления. Тоже самое с cmp esi, 0/cmp edi,0/cmp esp,0.<br>Остается только как-то определять код вида<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;reg<span class="hl_char">,</span>&nbsp;<span class="hl_function">const</span></li><li class="hl_l1"><span class="hl_function"><b>jmp</b></span>&nbsp;m1</li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1">m1<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_function"><b>cmp</b></span>&nbsp;reg<span class="hl_char">,</span>&nbsp;<span class="hl_function">const</span></li><li class="hl_l1"><span class="hl_function"><b>je</b></span>&nbsp;good</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=314197&amp;user=3136&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=21" class="addthx" data-post="314197"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 ноября 2012 11:56 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
я сейчас пишу анализатор таких ветвлений. Но извлечение правильного кода, пока не придумал как делать. Во многих обработчиках есть ветвления byte, word, dword, qword.плюс логические операции. Не зная всех шаблонов команд я не пойму ветвление это обработчика или мусор. С обработкой ветвления мусора проще. Там всегда можно вычислить прыжок. Пока хочу дернуть все хендлеры без учета ветвлений самого хэндлера, а потом составить их шаблоны.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314198&amp;user=4618&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=22" class="addthx" data-post="314198"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]kioresk[/b]','')">kioresk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/10650.gif" alt=""><br><span class=txtSm>Ранг: 154.2 (ветеран), 66thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10650">Участник</a><br><font color=blue>REVENGE Crew</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 ноября 2012 03:31 &middot; Поправил: kioresk <br><script type="text/javascript">QU('kioresk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kioresk" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
<b>Veliant</b>,<br><br><I>Остается только как-то определять код вида</I><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;reg<span class="hl_char">,</span>&nbsp;<span class="hl_function">const</span></li><li class="hl_l1"><span class="hl_function"><b>jmp</b></span>&nbsp;m1</li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1">m1<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_function"><b>cmp</b></span>&nbsp;reg<span class="hl_char">,</span>&nbsp;<span class="hl_function">const</span></li><li class="hl_l1"><span class="hl_function"><b>je</b></span>&nbsp;good</li>        </ol>
    </div>
</div></div>
<br><br>Рекомендую посмотреть связку Mediana в роли дизасма и <b>ntldr</b>&#039;овский x86_64_emu в роли эмулятора.<br>Такие куски можно сворачивать даже с помощью несложного паттерна:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">i<span class="hl_char">.</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;reg32_1<span class="hl_char">,</span>&nbsp;imm32_1&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;reg32<span class="hl_char">,</span>&nbsp;imm32</li><li class="hl_l1">j<span class="hl_char">.</span>&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;reg32_1<span class="hl_char">,</span>&nbsp;imm32_2&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;<span class="hl_function">nop</span></li><li class="hl_l0">k<span class="hl_char">.</span>&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;imm32_3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;<span class="hl_function">nop</span></li>        </ol>
    </div>
</div></div>
<br><br>Код:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>CMD_MOV_REG32_IMM32<span class="hl_char">(</span>i<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;CMD_CMP_REG32_IMM32<span class="hl_char">(</span>j<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;CMD_JZ_IMM32<span class="hl_char">(</span>k<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;ARG1_REG32<span class="hl_char">(</span>i<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;ARG1_REG32<span class="hl_char">(</span>j<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br><br>Макросы:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;reg32<span class="hl_char">,</span>&nbsp;imm32</li><li class="hl_l1">#define&nbsp;CMD_MOV_REG32_IMM32<span class="hl_char">(</span>i<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>instr<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>id&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;ID_MOV<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>instr<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>ops<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">.</span>flags&nbsp;<span class="hl_char">&amp;</span>&nbsp;OPERAND_TYPE_REG<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>instr<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>ops<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">.</span>size&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;OPERAND_SIZE_32<span class="hl_char">)</span>&nbsp;&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>instr<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>ops<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>flags&nbsp;<span class="hl_char">&amp;</span>&nbsp;OPERAND_TYPE_IMM<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>instr<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>ops<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>size&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;OPERAND_SIZE_32<span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l1"><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;reg32<span class="hl_char">,</span>&nbsp;imm32</li><li class="hl_l0">#define&nbsp;CMD_CMP_REG32_IMM32<span class="hl_char">(</span>i<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>instr<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>id&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;ID_CMP<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>instr<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>ops<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">.</span>flags&nbsp;<span class="hl_char">&amp;</span>&nbsp;OPERAND_TYPE_REG<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>instr<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>ops<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">.</span>size&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;OPERAND_SIZE_32<span class="hl_char">)</span>&nbsp;&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>instr<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>ops<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>flags&nbsp;<span class="hl_char">&amp;</span>&nbsp;OPERAND_TYPE_IMM<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>instr<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>ops<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>size&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;OPERAND_SIZE_32<span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l0"><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;imm32</li><li class="hl_l1">#define&nbsp;CMD_JZ_IMM32<span class="hl_char">(</span>i<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>instr<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>id&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;ID_JZ<span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l1"><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;arg1&nbsp;reg32</li><li class="hl_l0">#define&nbsp;ARG1_REG32<span class="hl_char">(</span>i<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>instr<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">.</span>ops<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">.</span>value<span class="hl_char">.</span>reg<span class="hl_char">.</span><span class="hl_function">code</span><span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l0"><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br><br><br>Эмулятор соответственно подключается когда надо что-то вычислить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314250&amp;user=10650&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=23" class="addthx" data-post="314250"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3136" title="13-11-2012 04:10, ранг:204.0" target="_blank">Veliant</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]normanCRC[/b]','')">normanCRC</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.65'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33284">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2012 12:37 <br><script type="text/javascript">QU('normanCRC','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=normanCRC" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#24');return false;">#24</a> </span><div align=left><br>
Добрый день.Не стал создавать новую тему,я так сказать тоже интересуюсь исследованием SF.Опыта у меня пока мало,почитал темы - более менее понятно.Единственный вопрос возник,как найти проверку контрольной суммы у PROTECT.DLL? Нужно пропатчить код:<br>5B33C0<br>394D<br>085F<br>0F94C0  ЗАМЕНИТЬ НА 33C040 (SETE AL ---&gt; XOR EAX,EAX + INC EAX)<br>Как найти это место и почему именно его надо патчить?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314296&amp;user=33284&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=24" class="addthx" data-post="314296"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2012 15:59 <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#25');return false;">#25</a> </span><div align=left><br>
Можно и в других местах пропатчить.<br>Проверка кода ошибки тут:<br><img src="http://rghost.ru/private/41562489/04ae8d14fd408aaf3d56fda6286c1be1/image.png" border="0" align="" alt=""><br>Код ошибки выставляется тут:<br><img src="http://rghost.ru/private/41562506/cb4f61a797c7da1ab07c9d52c7ae7ead/image.png" border="0" align="" alt=""><br>Так что твой SETE нужно искать где-то чуть выше установки кода ошибки в одном из call&#039;ов
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314301&amp;user=3136&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=25" class="addthx" data-post="314301"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2012 17:36 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#26');return false;">#26</a> </span><div align=left><br>
SETE AL? зачем его искать когда всё проще, выше функа, в ней и патчишь. на примере вышеприведённого скрина:<br><br>меняешь:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">02E8655A</span></li>        </ol>
    </div>
</div></div>
 - если CRC не совпадает, возвращает код ошибки.<br>на<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li>        </ol>
    </div>
</div></div>
 - реплейсим,  процедуру не выполняем (нах лишние телодвижения?), возвращаем 0.<br>всё.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314304&amp;user=16624&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=26" class="addthx" data-post="314304"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]normanCRC[/b]','')">normanCRC</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.65'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33284">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 ноября 2012 10:18 <br><script type="text/javascript">QU('normanCRC','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=normanCRC" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#27');return false;">#27</a> </span><div align=left><br>
Ещё такой вопрос - установил себе Syser Kernel Debugger последней версии, но он отключает драйвер SPTD из-за несовместимости. Драйвер нужен для эмуляции образа,без него игра не запустится.<br>Как быть,выходит что ничего другого кроме OllyDbg мы не можем использовать для исследования Стара?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314316&amp;user=33284&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=27" class="addthx" data-post="314316"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 ноября 2012 11:25 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#28');return false;">#28</a> </span><div align=left><br>
В гугле есть информация, как совместить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314318&amp;user=2585&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=28" class="addthx" data-post="314318"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]normanCRC[/b]','')">normanCRC</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.65'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33284">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2012 13:11 <br><script type="text/javascript">QU('normanCRC','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=normanCRC" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=20449&amp;page=1#29');return false;">#29</a> </span><div align=left><br>
Накопал тут статью как устранить антидампы в Старфорсе 4.50 Pro<br>https://svn.exelab.ru/art/?action=view&amp;id=316<br><br>Там про секуром,но в SF всё аналогично походу. Может кому пригодится
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314593&amp;user=33284&amp;forum_n=1&amp;topic=20449&amp;page=1&amp;anchor=29" class="addthx" data-post="314593"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=1&amp;topic=20449&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=1&amp;topic=20449&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> StarForce 5.7 MMOG</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#30" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="20449">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=20449" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
