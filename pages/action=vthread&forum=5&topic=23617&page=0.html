<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Changer STEAM by OSTROG, что делать когда dproto искажает sid? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Не получается полноценно эмулировать steamid через софт (Changer STEAM by OSTROG). Если подключаюсь я к тестовому серверу с dproto 0.9.0.548. То нахожу в записанной демке это, к примеру:">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=42860'>igorcauret</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Changer STEAM by OSTROG, что делать когда dproto искажает sid?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Manio133[/b]','')">Manio133</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.4 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.09'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=25595">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2015 19:47 &middot; Поправил: Manio133 <br><script type="text/javascript">QU('Manio133','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Manio133" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23617.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Не получается полноценно эмулировать steamid через софт (Changer STEAM by OSTROG). Если подключаюсь я к тестовому серверу с dproto 0.9.0.548. То нахожу в записанной демке это, к примеру:<br>\bottomcolor\6\model\gordon\topcolor\30\name\SET\*sid\6436716<br><br>А должно быть это:<br>\bottomcolor\6\model\gordon\topcolor\30\name\SET\*sid\76561197966702444<br><br>Это же я вижу и на серверах. То есть все норм. Человек играет со стим. <br><br>Но я не могу подделать реальный id. С чем это связано? Оно просто умножает на два число 3218358 (2*3218358 = 6436716), а должно ещё добавлять смещение 76561197960265728.<br><br>76561197960265728 + 3218358*2 = 76561197966702444<br><br>Dproto как-то эту подмену обнаруживает. И меня, если банят то не по этому steam id, а по ip сразу.<br>Когда выключить dproto, то при подключении с клиента <br>логи:<br>-------<br>Connecting to 127.0.0.1:27015 ...<br>Trying p48/auth3/revEm<br>-------<br><br>У меня показывает что клиент стим, и правильно вычисляет его *sid (\bottomcolor\6\model\gordon\topcolor\30\name\SET\*sid\76561197966702444). Но droto все портит. Хорошо, что соль к серверу не добавили.<br><br>Ещё мне неясно как вычисляется чексумма в конце<br>STEAM_0:0:1<br>... 0A 4A 00 00 00<br>01 00 00 80 76 65 72 00 00 00 00 00 02 00 00 00 01 00 10 01 41 44 46 4E 4C 4F 4C 46<br>...<br>41 44 46 4E 4C 4F 4C 46 чек-сумма steamid<br><br>STEAM_0:0:2<br>02 00 00 80 ....................... 04 00 00 00 ............41 44 46 4E 4C 4F 4C 47<br><br>STEAM_0:0:3<br>03 00 00 80 ....................... 06 00 00 00 ............41 44 46 4E 4C 4F 4C 48<br><br>STEAM_0:0:4<br>04 00 00 80 ....................... 08 00 00 00 ............41 44 46 4E 4C 4F 4C 41<br><br>STEAM_0:0:5<br>05 00 00 80 ....................... 0A 00 00 00 ............41 44 46 4E 4C 4F 4C 42<br><br>STEAM_0:0:7<br>07 00 00 80 ....................... 0E 00 00 00 ............41 44 46 4E 4C 4F 4C 44<br><br>STEAM_0:0:8<br>08 00 00 80 ....................... 10 00 00 00 ............41 50 43 57 4B 46 42 4A<br><br>STEAM_0:0:9<br>09 00 00 80 ....................... 12 00 00 00 ............41 50 43 57 4B 46 42 4B<br><br>STEAM_0:0:12<br>0C 00 00 80 ....................... 18 00 00 00 ............41 50 43 57 4B 46 42 4E<br><br>STEAM_0:0:13<br>0D 00 00 80 ....................... 1A 00 00 00 ............41 50 43 57 4B 46 42 4F<br><br>STEAM_0:0:14<br>0E 00 00 80 ....................... 1C 00 00 00 ............41 50 43 57 4B 46 42 50<br><br>STEAM_0:0:18<br>12 00 00 80 ....................... 24 00 00 00 ............41 44 46 4E 4C 4F 51 53<br><br><br><br>STEAM_0:0:10<br>0A 00 00 80 ....................... 14 00 00 00 ............41 50 43 57 4B 46 42 4C<br><br>STEAM_0:0:100<br>64 00 00 80 ....................... C8 00 00 00 ............41 44 46 4E 4C 4F 51 49<br><br>STEAM_0:0:1000000000<br>00 CA 9A 3B ....................... 00 94 35 77 ............41 42 4B 4D 4D 4C 42 53<br><br>STEAM_0:0:2147483647<br>FF FF FF FF ....................... FE FF FF FF ............41 44 48 47 4A 4B 56 53
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356179&amp;user=25595&amp;forum_n=5&amp;topic=23617.html&amp;page=0&amp;anchor=1" class="addthx" data-post="356179"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2015 19:58 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23617.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
И наработки-то где? Адреса процедур, дизасм листинги?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356180&amp;user=1556&amp;forum_n=5&amp;topic=23617.html&amp;page=0&amp;anchor=2" class="addthx" data-post="356180"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2015 20:04 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23617.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
игроманы на сайт игроманов, здесь вам делать нечего, за вас никто ничего не будет изучать
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356181&amp;user=15381&amp;forum_n=5&amp;topic=23617.html&amp;page=0&amp;anchor=3" class="addthx" data-post="356181"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2015 20:05 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23617.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Я вообще не понял о чем речь. Впрочем, как и 90% этого сайта тоже  <img src="img/smilies/s1.gif" alt=""><br><b>Changer STEAM by OSTROG</b> - это хрень, которая меняет ID стима (К.О.) для CS 1.6<br><noindex><a href="http://www.4cw.ru/cs/config/89-dproto.html#1" rel="nofollow" target="_blank">--&gt; dtopto &lt;--</a></noindex> это, судя по всему, плагин, который создает SteamID, по serial number харда (традиционный способ).<br>Я не понимаю, например, самого элементраного - какая связь между двумя этими программами и зачем их нужно вместе юзать??
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356182&amp;user=26651&amp;forum_n=5&amp;topic=23617.html&amp;page=0&amp;anchor=4" class="addthx" data-post="356182"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]TryAga1n[/b]','')">TryAga1n</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 262.5 (наставник), 337thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.45'>Активность: 0.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=31275">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2015 20:37 <br><script type="text/javascript">QU('TryAga1n','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TryAga1n" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23617.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>какая связь между двумя этими программами и зачем их нужно вместе юзать??  </I><br>Чтобы читерить и после бана перезаходить на тот же сервер, очевидно же.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356184&amp;user=31275&amp;forum_n=5&amp;topic=23617.html&amp;page=0&amp;anchor=5" class="addthx" data-post="356184"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=27422" title="16-06-2015 08:02, ранг:10.8" target="_blank">unknownproject</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2015 07:33 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23617.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>TryAga1n пишет:<br>Чтобы читерить и после бана перезаходить на тот же сервер, очевидно же. </I><br>Я уже в более глубоком смысле имел ввиду (непосрдественной роли): dtopto генерирует, Changer меняет?<br>По идее, у топикастера, получается, все проблемы на начальном этапе (с dtopto). Но потом, склыдвается впечатление, что всё наоборот.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356194&amp;user=26651&amp;forum_n=5&amp;topic=23617.html&amp;page=0&amp;anchor=6" class="addthx" data-post="356194"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Manio133[/b]','')">Manio133</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.4 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.09'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=25595">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2015 10:19 &middot; Поправил: Manio133 <br><script type="text/javascript">QU('Manio133','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Manio133" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23617.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Я думал люди в теме. Вот тема, которая давно подымалась на ресурсе <noindex><a href="http://wasm.ru/forum/viewtopic.php?id=44317" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br>Цель поста, раскрыть алгоритм генерации steam_id модулем ssteam.dll, и проблемы которые возникают с dproto, который узнает, что клиент подменяет steam id и не добавляет 76561197960265728, при вычислении sid. ssteam.dll позволяет генерить steam_id в виде набора байт при  передачи пакета &quot;connect 48&quot; от клиента контры к серверу контры, которые предаются в момент коннекта. <br>При подключении клиента контры cs1.6 к серверу контры. От клиента к серверу отправляется пакет<br>00000000 | FF FF FF FF 63 6F 6E 6E 65 63 74 20 34 38 20 37     | яяяяconnect 48 7<br>00000010 | 35 36 34 36 35 37 32 30 20 22 5C 70 72 6F 74 5C   | 56465720 &quot;\prot\<br>00000020 | 33 5C 75 6E 69 71 75 65 5C 2D 31 5C 72 61 77 5C  | 3\unique\-1\raw\<br>00000030 | 73 74 65 61 6D 5C 63 64 6B 65 79 5C 38 32 37 34  | steam\cdkey\8274<br>00000040 | 38 39 32 37 34 38 38 62 31 35 38 38 62 39 30 30   | 8927488b1588b900<br>00000050 | 31 65 35 37 62 34 38 39 66 62 35 66 22 20 22 5C   | 1e57b489fb5f&quot; &quot;\<br>00000060 | 5F 63 6C 5F 61 75 74 6F 77 65 70 73 77 69 74 63    | _cl_autowepswitc<br>00000070 | 68 5C 31 5C 62 6F 74 74 6F 6D 63 6F 6C 6F 72 5C   | h\1\bottomcolor\<br>00000080 | 36 5C 63 6C 5F 64 6C 6D 61 78 5C 31 32 38 5C 6D  | 6\cl_dlmax\128\m<br>00000090 | 6F 64 65 6C 5C 67 6F 72 64 6F 6E 5C 6E 61 6D 65   | odel\gordon\name<br>000000A0 | 5C 53 45 54 5C 74 6F 70 63 6F 6C 6F 72 5C 33 30   | \SET\topcolor\30<br>000000B0 | 5C 74 72 61 6E 73 6C 69 74 5C 31 5C 5F 76 67 75   | \translit\1\_vgu<br>000000C0 | 69 5F 6D 65 6E 75 73 5C 31 5C 63 6C 5F 75 70 64   | i_menus\1\cl_upd<br>000000D0 | 61 74 65 72 61 74 65 5C 31 30 31 5C 63 6C 5F 6C   | aterate\101\cl_l<br>000000E0 | 63 5C 31 5C 63 6C 5F 6C 77 5C 31 5C 72 61 74 65   | c\1\cl_lw\1\rate<br>000000F0 | 5C 32 35 30 30 30 5C 68 77 70 5C 31 22 0A 4A 00   | \25000\hwp\1&quot;.J.<br>00000100 | 00 00 <b>B6 1B 31 00 76 65 72 00 00 00 00 00 6C 37</b> | <b>..¶.1.ver.....l7</b><br>00000110 | <b>62 00 01 00 10 01 41 4F 4A 54 49 5A 50 45</b> 00 00 | b <b>.....AOJTIZPE</b>..<br>00000120 | 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................<br>00000130 | 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................<br>00000140 | 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................<br>00000150 | 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................<br>00000160 | 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................<br>00000170 | 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................<br>00000180 | 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................<br>00000190 | 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................<br>000001A0 | 00 00 00 00 20 00 00 00 01 00 00 00 00 00 00 00 | .... ...........<br><br>Самое интересное -- это набор выделенных байт, ответственных за генерирование steam id.<br>В данном пакете генериться STEAM_0:0:3218358.<br>Интересующий набор байт:<br><b>B6 1B 31 00</b> 76 65 72 00 00 00 00 00 <b>6C 37 62 00</b> 01 00 10 01 <b>41 4F 4A 54 49 5A 50 45</b><br><br>младший - старший байты (переворачиваем, для вычисления значения в dec)<br>B6 1B 31 00 -&gt; 00 31 1B B6 = 3218358<br>6C 37 62 00 -&gt; 00 62 37 6C = 6436716 (3218358 * 2) двойное его значение<br>41 4F 4A 54 49 5A 50 45 -&gt; &quot;магическая&quot; чек-сумма, которая вычисляется хитрым способом.<br>Этот хитрый способ я хочу найти, но не знаю метода. Как мне вскрыть алгоритм генерации не вдаваясь в дизассемблирование ssteam.dll и dproto, а оперируя данными пакета и изменения байтов в нем. Вот я и снял различные наборы байт, для различных steam id, заданных через steam id changer by OSTROG.<br><br>Формула вычисления sid<br>STEAM_0:X:YYYYYY<br>sid = (X:YYYYYY * 2 + X) + 76561197960265728<br>sid = (3218358 * 2 + 0) + 76561197960265728<br>sid = 76561197966702444<br><br>Соответствует профилю в стиме (это пример, у меня много есть всяких других steam id)<br>http://steamcommunity.com/profiles/76561197966702444<br><br>Чтобы подключить модуль в контру нужно скопировать два файла в корень игры. <br>ssteam.asi<br>ssteam.dll<br><br>Использование:<br>1. Запустить контру<br>2. В консоли написать <br>steam_random_id 0<br>steam_set_id 3218358  (STEAM_0:0:3218358 )<br><br><b>Декриптовать никак нельзя</b>? <br>Эти хвосты<br>STEAM_0:0:3218358<br>41 4F 4A 54 49 5A 50 45<br><br>STEAM_0:0:1<br>41 44 46 4E 4C 4F 4C 46<br><br>STEAM_0:0:2<br>41 44 46 4E 4C 4F 4C 47<br><br>STEAM_0:0:3<br>41 44 46 4E 4C 4F 4C 48<br><br>STEAM_0:0:4<br>41 44 46 4E 4C 4F 4C 41<br><br>STEAM_0:0:5<br>41 44 46 4E 4C 4F 4C 42<br><br>STEAM_0:0:7<br>41 44 46 4E 4C 4F 4C 44<br><br>Отсюда выходит частная закономерность (к примеру), что для <br>STEAM_0:0:6, будет этот &quot;хвост&quot;<br>41 44 46 4E 4C 4F 4C 43<br><br>При проверке на прокси (подстановке этого хвоста в пакет connect 48) получаем вменяемый адекват при вводе команды status:<br><br>hostname:  Test server<br>version :  48/1.1.2.6 4554 insecure  (10)<br>tcp/ip  :  192.168.1.62:27018<br>map     :  de_dust2 at: 0 x, 0 y, 0 z<br>players :  1 active (32 max)<br><br>#      name userid uniqueid frag time ping loss adr<br># 1    &quot;SET&quot; 2 STEAM_0:0:6   0 00:04   14    0<br><br>Видим пользователя с STEAM_0:0:6 .<br>На своем тестовом сервере содержимое<br>cstrike\addons\metamod\plugins.ini<br><br>;; Metamod plugins.ini<br>; AMX Mod X 1.8.0<br><br>win32   addons\amxmodx\dlls\amxmodx_mm.dll<br>; win32   addons\booster\booster_mm.dll<br>; win32   addons\STATSME\dlls\sm_cstrike_mm.dll<br>win32   addons\dproto\dproto.dll<br>; Enable this instead for binary logging<br>; win32   addons\amxmodx\dlls\amxmodx_bl_mm.dll<br><br>В консоли hlds сервера вводи команду meta list<br>meta list<br>Currently loaded plugins:<br>      description      stat pend  file              vers      src  load  unlod<br> [ 1] AMX Mod X        RUN   -    amxmodx_mm.dll    v1.8.2    ini  Start ANY  <br> <b>[ 2] dproto_EF        RUN   -    dproto.dll        v0.9.548  ini  Start Never</b><br> [ 3] Fun              RUN   -    fun_amxx.dll      v1.8.2    pl1  ANY   ANY  <br> [ 4] Engine           RUN   -    engine_amxx.dll   v1.8.2    pl1  ANY   ANY  <br> [ 5] FakeMeta         RUN   -    fakemeta_amxx.dl  v1.8.2    pl1  ANY   ANY  <br> [ 6] CStrike          RUN   -    cstrike_amxx.dll  v1.8.2    pl1  ANY   ANY  <br> [ 7] CSX              RUN   -    csx_amxx.dll      v1.8.2    pl1  ANY   ANY  <br><br>dproto ативирован<br><br>Стим id меняет, но сервер его видит как эмулирующий steam id<br><br>То есть когда я записал демку и посмотрел её в hex редакторе (искал по команде сервера fullserverinfo), то я нашел это<br>fullserverinfo &quot;\*gamedir\cstrike&quot;<br> <br>    \bottomcolor\6\model\gordon\topcolor\30\name\SET\*sid\12<br><br>а должно быть (12+76561197960265728)<br>fullserverinfo &quot;\*gamedir\cstrike&quot;<br> <br>    \bottomcolor\6\model\gordon\topcolor\30\name\SET\*sid\76561197960265740<br><br>Теперь, если я подставляю 3218358 -- получаю<br><br>fullserverinfo &quot;\*gamedir\cstrike&quot;<br> <br>    \bottomcolor\6\model\gordon\topcolor\30\name\SET\*sid\6436716<br><br>а должно быть (6436716+76561197960265728= 76561197966702444)<br><br>fullserverinfo &quot;\*gamedir\cstrike&quot;<br> <br>    \bottomcolor\6\model\gordon\topcolor\30\name\SET\*sid\76561197966702444<br>, что соответствовало бы профилю 76561197966702444<br><br>по http://steamidfinder.com/<br><br>http://steamcommunity.com/profiles/76561197966702444<br><br>Вот в чем <b>проблема</b><br><br>Приложения:<br>https://www.dropbox.com/sh/kjwf3rwpe83t34b/AAAUgoukbwj81NG8x7XXOGTFa?dl=0
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356195&amp;user=25595&amp;forum_n=5&amp;topic=23617.html&amp;page=0&amp;anchor=7" class="addthx" data-post="356195"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2015 11:04 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23617.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Manio133 пишет:<br>Как мне вскрыть алгоритм генерации не вдаваясь в дизассемблирование ssteam.dll и dproto </I><br>никак<br><I>Manio133 пишет:<br>а оперируя данными пакета и изменения байтов в нем </I><br>великий комбинатор? к гадалкам
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356198&amp;user=15381&amp;forum_n=5&amp;topic=23617.html&amp;page=0&amp;anchor=8" class="addthx" data-post="356198"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2015 11:16 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23617.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Тема закрыта за нарушение п.9 <noindex><a href="action=manual" rel="nofollow" target="_blank">правил форума</a></noindex>, коль никаких дизасмов, адресов и тд выложено так и не было. На этом форуме работают с кодом, а не гадают на пакетах и кофе.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356200&amp;user=1556&amp;forum_n=5&amp;topic=23617.html&amp;page=0&amp;anchor=9" class="addthx" data-post="356200"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Changer STEAM by OSTROG, что делать когда dproto искажает sid?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23617" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
