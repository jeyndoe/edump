<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Блог DenCoder&#039;а - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем привет! Всем здоровья, достатка, удачи, успехов... всех благ! ) Вот и нашлось немножко времени, чтобы завести блог. Давно хотел, но время для меня на вес золота... С вашего позволения здесь буду описывать процессы">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/blog.png" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=12&sortBy=0&page=0.html"><b>Дневники и блоги</b></a> <b class=bulletHead>&#8212;&#8250;</b> Блог DenCoder&#039;а</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=12&amp;topic=23661&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=12&amp;topic=23661&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=12&amp;topic=23661&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июля 2015 15:23 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Всем привет! Всем здоровья, достатка, удачи, успехов... всех благ! )<br><br>Вот и нашлось немножко времени, чтобы завести блог. Давно хотел, но время для меня на вес золота...<br><br>С вашего позволения здесь буду описывать процессы обхода/взлома/разбора защит, с которыми приходилось сталкиваться. Кому-то может пригодиться, кому-то - нет... Но за время работы немного узнал, что есть такая защита, перед которой некоторые коллеги пасуют - VMProtect. Может, в общем и есть такие страшные версии вмпрота, на которые терять кучу времени бессмысленно - не знаю, я с такими не сталкивался. Но скажу, что очень часто снимать вмпрот или разбирать то, что им накрыто, просто нет необходимости!<br><br>Вмпроты, которые мне попались в мае (сразу 2 подряд) - не такие страшные. Первым из них была накрыта lockpdfu.dll - компонент DRM защиты pdf-ок. Подробнее <noindex><a href="https://exelab.ru/f/?action=vthread&amp;forum=1&amp;topic=22687" rel="nofollow" target="_blank">--&gt; здесь &lt;--</a></noindex>.<br>Человек 2 или 3 года ждал, когда же, наконец, найдётся кто-нибудь, кто даст возможность свободно пользоваться pdf-документами на любом компе и редактировать. И находился некто с других сайтов, кто чуть не кинул... Попробую объяснить морально-идеологический аспект в двух словах прежде всего:<br><br>Человек - учитель, ему необходим учебный материал без ограничений использования с возможностью редактировать. Одна из купленных тетрадей, на файле которой я помогал решить задачу, стоила что-то вроде 70 гривен, использовать можно только на 2х компах и никак нельзя что-то пометить, что-то исправить. Чтобы, например, поделиться с учениками, сколько-то нужно дополнительно проплачивать... мда... куда катится мир, одни то ли бизнесмены, то ли барыги...<br><br>Ставим задачу: перехватить расшифровку запротекченной тетради, записать в отдельную папку оригинальный pdf.<br><br>Из совета Vovan666 <I>запротектил пдф-ку персональной версией, после чего без проблем из памяти AcroRd32 достал чистую pdf-ку.</I> честно говоря, не понял про протект персональной версией, но проверил можно ли что-то из памяти выцепить: даже и обычные pdf-ки в первозданном виде в памяти не хранятся, сигнатур %pdf-1.4 .. %pdf-1.7 нет. То, что находится с такой сигной - какая-то полоска для самого ридера )<br><br>Я пошёл своим путём. Раз нельзя выцепить из памяти - незаметно (для защиты) встанем на место после декрипта и незаметно сольём поток в файл. Звучит просто, но пришлось немного попотеть... <br><br>CreateFile, SetFilePointer, CloseHandle удалось хукнуть джампом без проблем. А вот ветка кода из acrord32.dll, вызывающая чтение функой ReadFile была хукнута в NtReadFile защитой + каким-то магическим образом проверялся crc этой ветки, а также защита не давала поставить ни софт бряк, ни джамп на ReadFile ни до, ни внутри, ни после... в дрова лезть не будем! Софт бряк нельзя поставить, а против харда защита ничего не имеет против! <img src="img/smilies/s1.gif" alt=""> Вспомнил, что имеется такая функция AddVectoredExceptionHandler и быстро нарисовалась идея (что не я - первооткрыватель, знаю, потому и пишу, что вспомнил) поставить 2 харда на ReadFile и после и обрабтать по своему. Потратил немножко времени на кодинг, но удалось, с первой подзадачей справился, осталось только записать файл.<br><br>Записать файл - тут кажется, проще не бывает. Но во-первых под 7кой и выше нужно перевести для этого акроридер в незащищённый режим, чтобы были привилегии, во-вторых - NtWriteFile также хукнута защитой и возвращала жестокий AD. Снимать хук без изучения защиты бесполезно - работать как надо не будет. ReadFile, WriteFile - так защита обменивалась какими-то важными данными. Не стал тратить время на изучение механизмов, сделал проще: против вызова NtWriteFile в месте после хука защита тоже ничего не имела против. Тут, я думаю, подробности излишни, в ntdll индексы всех фунок(nt-сервисов) идут по возрастающей по порядку во всех версиях винды, не встречалось другого(берём адрес хукнутого сервиса, находим следующий/предыдущий, берём оттуда индекс сервиса и минус/плюс 1) <img src="img/smilies/s1.gif" alt=""><br><br>Новичкам с опытом кодинга может быть полезно <img src="img/smilies/s2.gif" alt=""><br><br>В следующий раз (может быть сегодня вечером, может и через года 2) опишу отлом какой-то из версий вмпрота под x64, где тоже есть морально-идеологический аспект
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=356852&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=1" class="addthx" data-post="356852"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31932" title="02-12-2015 19:11, ранг:3.2" target="_blank">TLN</a>, <a href="action=userinfo&user=42835" title="21-07-2017 00:14, ранг:0.0" target="_blank">Zoeken</a></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июля 2015 12:43 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Не буду тянуть с описанием очередного отлома. Но начну всё-таки с благодарностей.<br><br>Ибо почему мне и другим удаётся что-то сделать - всё благодаря ребятам по ту (разработчики) и по другую сторону(реверсеры, взломщики)! Thanks to:<br>Всё же m&#036;! Ведь не было бы основы - ОС, работу чего бы изучал? подо что бы писал? на чём б я развернулся?<br>Спасибо m&#036; за винду от XP до 7 x86, x64! Спасибо за Visual Studio! Спасибо ребятам, отломавшим лицензирование!<br>Спасибо за грамотный MSDN!<br>Спасибо компании VMWare за их одноимённый продукт! Благодарности ребятам, отломавшим защиту!<br>Спасибо Ильфаку за иду! Спасибо за лекарства!<br>Спасибо всем за WinHex!<br>Особые благодарности экзелабу! васму! rsdn! за накопленную энциклопедическую базу!<br>Спасибо всем, кто приложил усилия, чтобы сделать жизнь кодеров и реверсеров легче!<br>Спасибо Румянцеву, спасибо Зубкову! По сей день заглядываю в книги как в справочники. Жаль только нельзя нажать Ctrl-F )<br>Спасибо chromanova.fm за моральную помощь в трудные моменты реверса и отладки своих тулз! Спасибо всем, кто им помог! <img src="img/smilies/s1.gif" alt=""><br><br>Моя мечта - заработать денег столько, чтобы каждому причастному можно было выписать чек на достойную сумму. Но пока это мечты...<br><br>Итак, посчастливилось познакомиться с людьми, которым было необходимо лекарство для некоего софта. Лекарство это было уже на тот момент, барыги накрыли его вмпротом и перепродавали за 500-700&#036; где-то за один ключ. Общая задача: убрать ограничения. Подзадачи: кейген и free-версия лекарства.<br><br>Каждая из подзадач на начальном этапе не предполагала, что легко осуществима. Ведь что я слышал иногда о реверсерах, сталкивающихся с вмпротом, повергало и меня в сомнения, что справлюсь... Ну, с вмпротом сталкивался уже не однажды, и не стараясь его изучать, по чуть-чуть до меня доходило, что это просто замусоренная виртуальная машина сродни эмулятору какого-то проца, какие я и сам умею писать. &quot;Что там может быть сложного?&quot; - прикинул я.<br><br>Сложность была маленькая - всё это дело под x64, подо что в настоящее время мало приличных дебаггеров. x64dbg не работало на WinXP x64 - в хидере чётко было прописано, что работает, начиная с висты. Но даже перебив хидер и поставив нужный msvc redistributable, загрузить не удалось, поскольку не было функи из kernel32. Win7 x64 на виртуалке работал тормозно на моей тачке, поэтому всё же решил попробовать настроить либо иду, либо WinDbg... Представляю сейчас, сколько бы я времени потерял с недоделанным WinDbg )<br><br>У иды есть remote Win32 Debugger, достаточно хорошо для этой задачи подошёл. (кстати, пользовалась ida 5.5). Накрытое лекарство было выполнено в dll прокладкой, написал простенький лоадер для неё и дебаг старт свой лоадер. Тут маленький нюанс - лоадер грузил dll динамически, а в dll был TlsCallback, который вызывается, только если dll статически прилинкована! Посмотрев, в TlsCallback был неизвестный vm entry, для чего он был нужен - не стал тратить время, да и не понадобилось.<br><br>Сразу с DllEntryPoint встретился с точкой входа в вм, и первые примитивы, которые были встречены - извлечение из виртуального стека на rbp (в своих делах был просто назван VStack) значений и помещением в область локальных переменных, размер которой 0xC0. По Vamit&#039;у, наверное, это будут регистры, 24 шт.(за терминологию спасибо Vamit&#039;у, постараюсь её держаться, но не особо люблю читать, так что поправьте меня, где неточно). Что же делать? Первое - вычислить, сколько всего примитивов, и оценить, сколько времени понадобится на их разбор. Выцепил алго, который по дешифрованному индексу из байт-кода, вычислял адрес примитива, отсортировал по адресам, получалось на некоторые примитивы один индекс, на остальные - больше, до 8. И всего 79 примитивов. Попробовал разобрать один, второй, третий.... первоначально уходило много времени, поскольку был ещё и мусор. По подсчётам надо было на полный разбор от 3 до 5 дней... Не стал полностью разбирать, а просто поставил 79 точек останова, и там где останавливалось, попутно разбирал дальше, убирал бряк, если примитив не заслуживал особого внимания и давал какое-то осмысленное название примитиву...<br><br>3 особо важных было найдено, назвал их CallFunc, getCrc и vmExit. Через CallFunc поначалу производился некоторый импорт, как потом оказалось среди них функи антиотладки. Их было всего 4, начеркал в блокнотике схему действий, как их обходить:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">kernel32_IsDebuggerPresent<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">bSuccess&nbsp;<span class="hl_char">=</span>&nbsp;kernel32_CheckRemoteDebuggerPresent<span class="hl_char">(</span>GetCurrentProcess<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>bBeingDebugged<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns&nbsp;<span class="hl_number">1</span><span class="hl_char">,</span>&nbsp;bBeingDebugged&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">NtStatus&nbsp;<span class="hl_char">=</span>&nbsp;ntdll_NtQueryInformationProcess<span class="hl_char">(</span>GetCurrentProcess<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;ProcessDebugObjectHandle<span class="hl_char">(</span>0x1e<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>DebugHandle<span class="hl_char">,</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>HANDLE<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns&nbsp;0xC0000353<span class="hl_char">(</span>STATUS_PORT_NOT_SET<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;DebugHandle&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">NtStatus&nbsp;<span class="hl_char">=</span>&nbsp;ntdll_NtSetInformationThread<span class="hl_char">(</span>GetCurrentThread<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;ThreadHideFromDebugger<span class="hl_char">(</span>0x11<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;предотвратить&nbsp;обращение</li>        </ol>
    </div>
</div></div>
<br><br>Мне казалось, это не конец, встречусь обязательно с чем-то страшным. Поэтому на всякий случай изредка снимал снэпшоты, чтобы ошибившись, откатиться. Эта версия вмпрота не детектила виртуалку, хоть и встречалась cpuid, но даже на этот случай я был готов достаточно к такому повороту. Но к удивлению, последнее, что увиделось - это открытие самой себя и проверка контрольных сумм. Не так страшен чёрт, как его малюют! <img src="img/smilies/s1.gif" alt=""> (Испанская версия - no es tan fiero el le&#243;n como lo pintan - &quot;не так страшен лев, как его рисуют&quot;). Были там, конечно, ещё проверки crc, но этим нас не напугать! Кстати, в проверках были слабые места, которые можно было и усилить.<br><br>С чуть меньше половиной примитивов познакомился, некоторые были дублями других, встретил распаковку, полный импорт всех необходимых функций, релоки, дошёл до oep, нашёл DllMain, нашёл релоки, сдампил. Переделал все секции, добавил релоки, стал думать, как приклеить импорт... Сложностью было то, что адреса импортируемых функций были разбросаны по разным адресам... Не буду описывать подробно сложности, можно было сделать уже распакованную версию этой dll, но я посчитал это лишней тратой времени, так как импорт-функи вызывались через такую хитрую последовательность(привожу примерно, без мусора):<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;r64<span class="hl_char">,</span>&nbsp;const1</li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;r64<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>r64&nbsp;<span class="hl_char">+</span>&nbsp;const2<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>lea</b></span>&nbsp;r64<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>r64&nbsp;<span class="hl_char">+</span>&nbsp;const3<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;r64</li><li class="hl_l0"><span class="hl_function">retn</span></li>        </ol>
    </div>
</div></div>
<br>для чего надо было писать какой-то детект, а у меня был вариант проще.<br><br>И вот, подумалось, что всё, вм пройдена, DllMain, сейчас начнётся самое сладкое, пусть даже и с мусором... И вдруг встретилась знакомая сигнатура точки входа в вм, ещё одну.<br><br>Что же делать, придётся разбирать новую вм, которых оказалось даже 2. И разобрал все 79, дал осмысленные имена, записал в файл, и понял, что без трейсера ничего не смогу сделать. Пришлось писать... не стал закладывать всё, лишь по мере столкновения с новым. Получилась, конечно, каша в этой версии вмтрейсера, но пользоваться можно (если есть файлик с именами примитивов и группами индексов). На разбор второй вм у меня ушло 2.5 дня. Но разбор 3ей - уже 3 часа. Всё потому, что заглядывая в тело примитива, было уже видно, что он делает.<br><br>Вот тогда, при разборе очередного лога, понял в чём смысл стрелок Пирса )<br>Приведу один пример - как выражается операция XOR через них:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">!</span><span class="hl_char">(</span><span class="hl_char">!</span><span class="hl_char">(</span><span class="hl_char">!</span>a&nbsp;<span class="hl_char">&amp;</span>&nbsp;<span class="hl_char">!</span>a<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">(</span><span class="hl_char">!</span>b&nbsp;<span class="hl_char">&amp;</span>&nbsp;<span class="hl_char">!</span>b<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">(</span><span class="hl_char">!</span>b&nbsp;<span class="hl_char">&amp;</span>&nbsp;<span class="hl_char">!</span>a<span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br>Можно ли это назвать сложным для человека с отл по дискретке? )<br>Немного усложняло всё дело то, что константы для операций явно не указывались, а были хитрой последовательностью сложения констант из байт-кода с константами из памяти по адресу, смещение которого вычислялось аналогично. Но привык за некоторое время... Суть кряка как раз и проявилась на стрелках Пирса: XOR хешей от оборудования (хеши по некоторому алго меняются, и из них образуется код запроса) с &lt;&quot;хешами&quot;&gt; введённого ключа(6 двордов &quot;хешей&quot; из 40-символьного ключа делаются путём перевода из base32 в binary, получающийся 25ый байт - crc ключа). Должно было получиться правильное некое значение, без которого либо вылет, либо по-прежнему просило бы зарегистрироваться... Без валидной пары практичекски невозможно вычислить, не зная принципов предыдущих кряков, легче уж тогда сломать оригинал...<br><br>В общей сложности, на всё ушло месяц и 1 неделя. Так долго благодаря тщательности исследования, ожидания по-настоящему хитрой защиты, чего не встретилось ну и из-за написания и отладки вмтрейсера, который периодически приходилось править и править, и последняя правка была на последней неделе проводимой работы. &quot;Сохранение флагов&quot; работало плохо на mul-примитивах, знак результата не всегда тот получался... Терпение, целеустремлённость, упёртость, внимательность, аккуратность - необходимые качества тут, которые пригодились.<br><br>На этом пока всё! Кто догадался, о каком кряке шла речь - просьба нигде не упоминать пока! <img src="img/smilies/s1.gif" alt=""><br><br><I>Удача любит подготовленных</I><br>Удачи!!! <img src="img/smilies/s2.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=356868&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=2" class="addthx" data-post="356868"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=2777" title="19-08-2015 07:29, ранг:471.8" target="_blank">daFix</a>, <a href="action=userinfo&user=31932" title="16-11-2015 21:28, ранг:3.2" target="_blank">TLN</a>, <a href="action=userinfo&user=1379" title="16-03-2017 16:41, ранг:512.9" target="_blank">Jupiter</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.53'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июля 2015 00:47 &middot; Поправил: hors <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>DenCoder пишет:<br> Спасибо Румянцеву, спасибо Зубкову! По сей день заглядываю в книги как в справочники. Жаль только нельзя нажать Ctrl-F ) </I><br><br>Зубков есть и в виде chm справки и в виде pdf. Так что Ctrl-F будет работать. <br><br>Я тоже купил в 2004 году книгу Зубкова &quot;Assembler для DOS, Windows и UNIX&quot;. Это единственная оставшаяся в моей бумажной библиотеке книга на русском языке. Вот фото прилагаю:<br><br><img src="http://s61.radikal.ru/i174/1507/39/8a77759fd64a.jpg" border="0" align="" alt="">
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=356898&amp;user=31056&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=3" class="addthx" data-post="356898"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июля 2015 12:15 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Да да, именно эта книга. Помогает по части sse, mmx, FPU. Единственное что - книге уже 11 лет, по CPUID данные уже устарели и много чего нет.<br><br><b>hors</b><br>Давай всё ж задетектим версию вмпрота. Просмотрел сигнатуры в текущей версии die, ничего похожего нет. В попавшейся мне версии вмпрота, начиная с ep сигнатуры -<br>e9....<br>джамп ведёт на ещё один e9...., который выводит на 68....e9....<br>оттуда 0f8b.... &lt;- jnp(может быть любое условие)<br>следом опять 68....e9....<br>а по целевому адресу в jnp за многими e9 (встречалось и до 4х) то же самое 68....e9.... , где в push та же самая константа, что и после jnp<br><br>нагляднее вот так будет, наверное:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">DllEntryPoint<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DllEntryPoint_0</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">DllEntryPoint_0<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DllEntryPoint_0_0</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">DllEntryPoint_0_0<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;const1</li><li class="hl_l0"><span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_1</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">loc_1<span class="hl_char">:</span></li><li class="hl_l1">j<span class="hl_char">(</span>cc<span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_2</li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;const2</li><li class="hl_l1"><span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_3</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">loc_2<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_4</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">loc_4<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;const2</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">loc_3<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br>за этой последовательностью последовательности инструкций<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;r64</li><li class="hl_l1"><span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br>20 регистров так &quot;сохраняется&quot;, среди которых бывают дубли<br><br>Вход в вм редко ветвится больше, чем на двое, но бывало где-то и 5-6 веток, в каждой ветке по смыслу ровно то же, что и в других. Все ветки рано или поздно сходятся в одну...<br><br>Какая это версия?
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=356905&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=4" class="addthx" data-post="356905"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31932" title="05-12-2015 08:23, ранг:3.2" target="_blank">TLN</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.53'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июля 2015 12:58 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Какая это версия? </I><br><br>В файле есть строка &quot;debugger has been found running in your system.&quot;?
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=356911&amp;user=31056&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=5" class="addthx" data-post="356911"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июля 2015 13:47 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Есть, но шифрована, в отркытом виде почти никакие строки не хранятся. Там есть ещё одна строка для MessageBox&#039;а, тоже шифрована:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">File&nbsp;corrupted<span class="hl_char">!</span>&nbsp;<span class="hl_function"><b>This</b></span>&nbsp;program&nbsp;has&nbsp;been&nbsp;manipulated&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;maybe&nbsp;<span class="hl_quote">it's infected by a Virus or cracked. This file won'</span>t&nbsp;work&nbsp;anymore<span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br><br>Это сообщение выскочило однажды, когда перебил таблицу с CRC(таблица для проверки crc случайных регионов на байт-коде) под свои бряки и случайно пропустил глобальную проверку контрольных сумм, которая захватывала и эту таблицу )
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=356913&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=6" class="addthx" data-post="356913"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31932" title="06-12-2015 11:22, ранг:3.2" target="_blank">TLN</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.53'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июля 2015 13:57 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Есть, но шифрована, в отркытом виде почти никакие строки не хранятся. </I><br><br>Тогда это vmprotect версии 2.06 или старше(2.06-2.13)
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=356914&amp;user=31056&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=7" class="addthx" data-post="356914"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24257" title="07-07-2015 11:00, ранг:220.6" target="_blank">DenCoder</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июля 2015 14:02 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
В чём сложности детекта? )
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=356915&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=8" class="addthx" data-post="356915"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.53'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июля 2015 14:21 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>DenCoder пишет:<br>В чём сложности детекта? )  </I><br><br>Да в общем-то никаких сложностей нет и никогда не было. <br>Единственно, что некоторые разработчики защит внимательно следят за тем что связанно с их программами.<br>Поэтому к примеру публикация в открытом доступе распаковщика вмпротект(раз мы о нём заговорили),<br>приведёт только к усложнению защиты. Кому от этого станет лучше?<br>Это же касается и алгоритмов детекта.
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=356918&amp;user=31056&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=9" class="addthx" data-post="356918"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июля 2015 16:09 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>hors пишет:<br>Единственно, что некоторые разработчики защит внимательно следят за тем что связанно с их программами.Поэтому к примеру публикация в открытом доступе распаковщика вмпротект(раз мы о нём заговорили),приведёт только к усложнению защиты. Кому от этого станет лучше? </I><br>В нормальных организациях нанимают крякеров для проверки их защиты. Также нормальные организации сами идут к повышению надёжности их защит. Отлом 2.xx версий уже не один раз описывали. Ну даже если опишут, раскроют отлом 3.0, то это чуть больше, чем <strike>ничего</strike> нисколько подтолкнёт разработчиков усложнить её. (А барыги всё ж будут больше вкладываться в новые протекторы) <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=356919&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=10" class="addthx" data-post="356919"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31932" title="07-12-2015 21:06, ранг:3.2" target="_blank">TLN</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 августа 2015 20:43 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
И затишье...<br><br>Мучаюсь с qemu, linux и gdb <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=358105&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=11" class="addthx" data-post="358105"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2015 16:04 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Вот и подходит к концу, наконец, очередной проект в моей практике. Особенно тут ничего и не напишешь, поскольку весь код на ладони, ладонь должна быть здоровая. Реверсить код, разбухнувший в 20 мб из-за включенной опции компилятора оптимизировать циклы их разворачиванием там, где не надо, с последовательностями инструкций типа<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;r4<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_function"><b>cmp</b></span>&nbsp;r4<span class="hl_char">,</span>&nbsp;<span class="hl_number">4</span></li>        </ol>
    </div>
</div></div>
,<br><br>что скорей всего явлется результатом стиля программирования, в котором за правило взято определять константы через #define с инструкциями из расширения NEON для работы на 64битными числами, с блок-схемой, на которой хексрейс без goto обойтись не может(и ещё раз убедился, что хексрейс никаких денег не стоит) - огромное неудовольствие, хуже чем реверс обфускированного кода... <b>Об этом и о хекс-рейсе чуть позже</b>, но это и было главной причиной, почему решил именно сэмулировать прошивку и прицепиться отладчиком.<br><br>Хочется верить, что лет через 10 будет самонастраиваемый, самоконфигурируемый потомок qemu и инструменты подоспеют годные для отладки. А пока время, потраченное с оптимизмом на запуск линукса из прошивки не стоит времени, потраченного на статический реверс. Можно найти родственный линукс специально для qemu, поставить, найти все компоненты для работы целевого приложения в прошивке, прицепиться отладчиком. Исходя из моего мимолётного опыта в этой области, оцененная вероятность, что будет работать, как должно, не дотягивает до 30%. Впрочем, это зависит ещё от степени изучения исходников qemu, от умений их править, отлаживать и собирать как надо(а никто за вас этого делать не будет), а также от умений править исходники gdb и с фантазией, какая есть, умений творения mdi поудобнее, чем сделано в insight(там вообще-то куча плавающих окошек, пародия на ольку). Пока этими умениями не обзавёлся, пожалел время... Но обзаведшись какими-то, комбинируя динамику со статикой (реверс дизассемблером, отладчик только в особо трудных местах развёрнутых циклов криптоалго), вышел на финишную прямую.<br><br>Мда... что сказать. Будучи 7 лет назад азартным игроком, до конца от этого не избавился, поставил немного не на ту лошадку и потерял чуть больше времени, чем ожидалось. Из всего надо извлекать пользу! Очень возможно, приобретённые скилы разовьются и пригодятся в будущем.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=359043&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=12" class="addthx" data-post="359043"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31932" title="10-12-2015 06:43, ранг:3.2" target="_blank">TLN</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2015 00:26 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Об этом и о хекс-рейсе чуть позже </I><br>жаждим подробностей ))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359064&amp;user=15381&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=13" class="addthx" data-post="359064"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2015 14:24 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Ну раз действительно жаждИте, немного поспешу <img src="img/smilies/s1.gif" alt=""><br>Защищать хексрейс, я так понял, будешь? )<br><br>Исходный asm-листинг<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STMFD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">SP</span><span class="hl_char">!</span><span class="hl_char">,</span>&nbsp;{R4<span class="hl_char">-</span>R6}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12<span class="hl_char">,</span>&nbsp;#0xFFFFFFFF</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R5<span class="hl_char">,</span>&nbsp;#0</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#8<span class="hl_char">]</span>&nbsp;<span class="hl_comment">; pEncryptCtx-&gt;sAddressBlock[0].ulEBSA = -1</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R5<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">]</span>&nbsp;<span class="hl_comment">; pEncryptCtx-&gt;bValidFlag = false</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R5<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#4<span class="hl_char">]</span>&nbsp;<span class="hl_comment">; pEncryptCtx-&gt;iNoOfBlocks = 0</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R5<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x2C<span class="hl_char">]</span>&nbsp;<span class="hl_comment">; pEncryptCtx-&gt;iNoOfDecryptedBlocks = 0</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0xC<span class="hl_char">]</span>&nbsp;<span class="hl_comment">; pEncryptCtx-&gt;sAddressBlock[0].ulEBEA = -1</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R4</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R1<span class="hl_char">]</span>&nbsp;<span class="hl_comment">; pDecryptedBlockList[0]: allocated buffer of DATABLOCK2</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R6<span class="hl_char">,</span>&nbsp;R2</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R4<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x20<span class="hl_char">]</span>&nbsp;<span class="hl_comment">; pEncryptCtx-&gt;pDecryptedBlock[0] = pDecryptedBlockList[0]</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R1<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2<span class="hl_char">,</span>&nbsp;R5</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEQ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_3B774C</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2<span class="hl_char">,</span>&nbsp;#1</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x2C<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R5<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R4<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x10<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x14<span class="hl_char">]</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R1<span class="hl_char">,</span>#4<span class="hl_char">]</span>&nbsp;<span class="hl_comment">; pDecryptedBlockList[1]: initially NULL</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x24<span class="hl_char">]</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R3</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R1<span class="hl_char">,</span>#4<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R3<span class="hl_char">,</span>&nbsp;R5</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEQ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_3B7770</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R3</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x2C<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R3<span class="hl_char">,</span>&nbsp;R3<span class="hl_char">,</span>&nbsp;#1</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R3<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x2C<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R5<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R2<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x1C<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x18<span class="hl_char">]</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R1<span class="hl_char">,</span>#8<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x28<span class="hl_char">]</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R1<span class="hl_char">,</span>#8<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12<span class="hl_char">,</span>&nbsp;R5</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEQ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_3B77A0</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x2C<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1<span class="hl_char">,</span>&nbsp;R12<span class="hl_char">,</span>&nbsp;#1</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x2C<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R5<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R2<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R6<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x30<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">loc_3B7740&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: ch2_InitEncryptContext+104j</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R0<span class="hl_char">,</span>&nbsp;#0x80000000</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDMFD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_registr">SP</span><span class="hl_char">!</span><span class="hl_char">,</span>&nbsp;{R4<span class="hl_char">-</span>R6}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>BX</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LR</li><li class="hl_l1"><span class="hl_comment">; ---------------------------------------------------------------------------</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">loc_3B774C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: ch2_InitEncryptContext+34j</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x14<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x10<span class="hl_char">]</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R1<span class="hl_char">,</span>#4<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x24<span class="hl_char">]</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R3</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R1<span class="hl_char">,</span>#4<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R3<span class="hl_char">,</span>&nbsp;#0</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVNE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R3</span><span class="hl_char">,</span>&nbsp;#1</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRNE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R3</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x2C<span class="hl_char">]</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRNE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R12<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span style="word-break: break-all">loc_3B7770&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: ch2_InitEncryptContext+5Cj</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12<span class="hl_char">,</span>&nbsp;#0xFFFFFFFF</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x1C<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x18<span class="hl_char">]</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R1<span class="hl_char">,</span>#8<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R12<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x28<span class="hl_char">]</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R3</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R1<span class="hl_char">,</span>#8<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R3<span class="hl_char">,</span>&nbsp;#0</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVNE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2</span><span class="hl_char">,</span>&nbsp;#0</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LDRNE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R3</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x2C<span class="hl_char">]</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R3</span><span class="hl_char">,</span>&nbsp;R3<span class="hl_char">,</span>&nbsp;#1</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRNE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R3</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x2C<span class="hl_char">]</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRNE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R12<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span style="word-break: break-all">loc_3B77A0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: ch2_InitEncryptContext+88j</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>STR</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R6<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>R0<span class="hl_char">,</span>#0x30<span class="hl_char">]</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_3B7740</span></li><li class="hl_l1"><span class="hl_comment">; End of function ch2_InitEncryptContext</span></li>        </ol>
    </div>
</div></div>
<br><br>На идовском граф-вью во в меру уменьшенном виде это выглядит так<br><img src="http://i70.fastpic.ru/big/2015/0927/bf/9d96652948326dfd3f0c99a654bcecbf.jpg" border="0" align="" alt=""><br>Вы знаете, что зелёные линии - переход по истинному условию, красные - если условие ложно, синие - бузусловный переход.<br><br>Конструкциями if-else на языке си без специальных ухищрений <b>такую конструкцию в общем виде</b> не передать. Для того, чтобы это было возможно, нужен либо язык с ператором выхода из условном блока, что есть в бейсике, либо эмулировать этот оператор при помощи операторов do{...}while(false); и break;.<br><br>Слава богу, к таким ухищрениям прибегать не приходися, но совсем не слава богу в том, что приходится искать подобие между левой и правой ветками для того, чтобы их избежать...<br><br>Заденем немного хексрейс, как он бы справился с этой задачей ))<br>Вот как<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">unsigned&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;__fastcall&nbsp;ch2_InitEncryptContext<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;a1<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;a2<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;a3<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v3<span class="hl_comment">; // r4@1</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v4<span class="hl_comment">; // r6@1</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v5<span class="hl_comment">; // r2@2</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v6<span class="hl_comment">; // r2@3</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v8<span class="hl_comment">; // r12@6</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v9<span class="hl_comment">; // r12@8</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;0xFFFFFFFF<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>a1&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x2C<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0xC<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;0xFFFFFFFF<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v3&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>a2<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v4&nbsp;<span class="hl_char">=</span>&nbsp;a3<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x20<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>a2<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>a2&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x14<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;0xFFFFFFFF<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x10<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;0xFFFFFFFF<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;v8&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a2&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x24<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;v8<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a2&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x2C<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>v8&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;LABEL_8<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x2C<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>v3&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x10<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;0xFFFFFFFF<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x14<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;0xFFFFFFFF<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v5&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a2&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x24<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;v5<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a2&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;{</li><li class="hl_l0">LABEL_8<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x1C<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;0xFFFFFFFF<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x18<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;0xFFFFFFFF<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;v9&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a2&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x28<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;v9<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a2&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x2C<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>v9&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;LABEL_10<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x2C<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>v5&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x1C<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;0xFFFFFFFF<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x18<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;0xFFFFFFFF<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v6&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a2&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x28<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;v6<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a2&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;{</li><li class="hl_l0">LABEL_10<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x30<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;v4<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0x80000000<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x2C<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>v6&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_DWORD&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>a1&nbsp;<span class="hl_char">+</span>&nbsp;0x30<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;v4<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;return&nbsp;0x80000000<span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br><br>67 ни для не понятных строк кода на си!<br>Честно скажу, на всякий случай потратил чуть больше времени, чтоб адаптироваться и быть готовым к &quot;таким общего вида конструкциям&quot; (не задумывался над тем, как обозвать, но пришло в голову назвать &quot;параллельным кодом&quot;), поразмыслил над логикой компилятора и выявил общие части, которые совсем нет небходимости дублировать в каждой ветке.<br><br>Вот что получилось:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;ch2_InitEncryptContext<span class="hl_char">(</span>ENCRYPTCONTEXT2<span class="hl_char">*</span>&nbsp;pEncryptCtx<span class="hl_char">,</span>&nbsp;DATABLOCK2<span class="hl_char">*</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">3</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;DATABLOCK2<span class="hl_char">*</span>&nbsp;encBlock<span class="hl_char">/</span><span class="hl_char">*</span>R6<span class="hl_char">*</span><span class="hl_char">/</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>bValidFlag&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>false</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfBlocks&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBSA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBEA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span><span class="hl_char">(</span>pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBSA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBEA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span><span class="hl_char">(</span>pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBSA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBEA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span><span class="hl_char">(</span>pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pEncryptedBlock&nbsp;<span class="hl_char">=</span>&nbsp;encBlock<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0x80000000<span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br><br>Вообще говоря, и этот код можно сократить, но это для меня лишнее.<br><br>Практически 90% кода так написано, подвергнуто непредсказуемым коварствам компилятора - дублируется часть кода, развёрнуты циклы. + Кодер, который писал это, не обременял себя особо его смыслом - работает и работает. Код приложения в 20 мб из прошивки можно было уменьшить примерно раза в 3, не снижая скорости его работы. А хексрейс тут лоханулся. Применительно к ARM-архитектурам, учесть и заложить оптимизацию создателю в нём не удалось.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=359071&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=14" class="addthx" data-post="359071"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2015 14:52 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
и?<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">unsigned&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;__fastcall&nbsp;ch2_InitEncryptContext<span class="hl_char">(</span>ENCRYPTCONTEXT2&nbsp;<span class="hl_char">*</span>pEncryptCtx<span class="hl_char">,</span>&nbsp;DATABLOCK2&nbsp;<span class="hl_char">*</span><span class="hl_char">*</span>pDecryptedBlockList<span class="hl_char">,</span>&nbsp;DATABLOCK2&nbsp;<span class="hl_char">*</span>a3<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;DATABLOCK2&nbsp;<span class="hl_char">*</span>v3<span class="hl_comment">; // r4@1</span></li><li class="hl_l1">&nbsp;&nbsp;DATABLOCK2&nbsp;<span class="hl_char">*</span>v5<span class="hl_comment">; // r2@2</span></li><li class="hl_l0">&nbsp;&nbsp;DATABLOCK2&nbsp;<span class="hl_char">*</span>v6<span class="hl_comment">; // r2@3</span></li><li class="hl_l1">&nbsp;&nbsp;DATABLOCK2&nbsp;<span class="hl_char">*</span>v8<span class="hl_comment">; // r12@6</span></li><li class="hl_l0">&nbsp;&nbsp;DATABLOCK2&nbsp;<span class="hl_char">*</span>v9<span class="hl_comment">; // r12@8</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBSA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>bValidFlag&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfBlocks&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBEA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v3&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span>pDecryptedBlockList<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span>pDecryptedBlockList<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">*</span>pDecryptedBlockList&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBEA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBSA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;v8&nbsp;<span class="hl_char">=</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;v8<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v8<span class="hl_char">-</span><span class="hl_char">&gt;</span>iCount&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;LABEL_8<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v3<span class="hl_char">-</span><span class="hl_char">&gt;</span>iCount&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBSA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBEA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v5&nbsp;<span class="hl_char">=</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;v5<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span>pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;{</li><li class="hl_l0">LABEL_8<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBEA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBSA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;v9&nbsp;<span class="hl_char">=</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;v9<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">+</span><span class="hl_char">+</span>pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v9<span class="hl_char">-</span><span class="hl_char">&gt;</span>iCount&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;LABEL_10<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">+</span><span class="hl_char">+</span>pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v5<span class="hl_char">-</span><span class="hl_char">&gt;</span>iCount&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBEA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBSA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v6&nbsp;<span class="hl_char">=</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;v6<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span>pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;{</li><li class="hl_l0">LABEL_10<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pEncryptedBlock&nbsp;<span class="hl_char">=</span>&nbsp;a3<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0x80000000<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">+</span><span class="hl_char">+</span>pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v6<span class="hl_char">-</span><span class="hl_char">&gt;</span>iCount&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pEncryptedBlock&nbsp;<span class="hl_char">=</span>&nbsp;a3<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;return&nbsp;0x80000000<span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=359073&amp;user=15381&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=15" class="addthx" data-post="359073"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2015 15:02 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>reversecode пишет:<br>и? </I><br>Что &quot;и&quot;? 5 датаблоков, когда используется один - нормально? goto - нормально? <img src="img/smilies/s1.gif" alt=""><br>Из асма в си тут переводить проще без хексрейса! ))<br><br>Ну а не к хексрейсу, а к кодеру(ам):<br>Если ещё дальше посмотреть на соседнюю функцию, то эта функция вообще не нужна. Можно ограничиться<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">(</span>pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;</span></li><li class="hl_l1">pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pEncryptedBlock&nbsp;<span class="hl_char">=</span>&nbsp;encBlock<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=359074&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=16" class="addthx" data-post="359074"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31932" title="22-12-2015 13:17, ранг:3.3" target="_blank">TLN</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2015 15:14 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
ну если нет претензий к рейсу то о чем разговор))<br>причесал,у меня вышло так<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">unsigned&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;__fastcall&nbsp;ch2_InitEncryptContext<span class="hl_char">(</span>ENCRYPTCONTEXT2&nbsp;<span class="hl_char">*</span>pEncryptCtx<span class="hl_char">,</span>&nbsp;DATABLOCK2&nbsp;<span class="hl_char">*</span><span class="hl_char">*</span>pDecryptedBlockList<span class="hl_char">,</span>&nbsp;DATABLOCK2&nbsp;<span class="hl_char">*</span>a3<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBSA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>bValidFlag&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfBlocks&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBEA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBEA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBSA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pDecryptedBlockList</span><span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>iCount&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBEA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBSA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">+</span><span class="hl_char">+</span>pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks<span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pDecryptedBlockList</span><span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>iCount&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pEncryptedBlock&nbsp;<span class="hl_char">=</span>&nbsp;a3<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0x80000000<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>iCount&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBSA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBEA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBEA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBSA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">+</span><span class="hl_char">+</span>pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks<span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pDecryptedBlockList</span><span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>iCount&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pEncryptedBlock&nbsp;<span class="hl_char">=</span>&nbsp;a3<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0x80000000<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">+</span><span class="hl_char">+</span>pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>iCount&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBEA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>sAddressBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">.</span>ulEBSA&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pDecryptedBlock<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pEncryptedBlock&nbsp;<span class="hl_char">=</span>&nbsp;a3<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0x80000000<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">+</span><span class="hl_char">+</span>pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>iNoOfDecryptedBlocks<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pDecryptedBlockList<span class="hl_char">[</span><span class="hl_number">2</span><span class="hl_char">]</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>iCount&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pEncryptCtx<span class="hl_char">-</span><span class="hl_char">&gt;</span>pEncryptedBlock&nbsp;<span class="hl_char">=</span>&nbsp;a3<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0x80000000<span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br><br><b>Добавлено спустя 9 минут</b><br>там на самом деле бинарь скомпилирован без оптимизации с dwarf, поэтому такие конструкции и остались,<br>думаю если бы включили оптимизацию, компилер мог поулучшать все эти переходы
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359075&amp;user=15381&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=17" class="addthx" data-post="359075"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2015 15:31 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>reversecode пишет:<br>ну если нет претензий к рейсу </I><br>есть есть... точнее - были были, но раз с ним не договориться, то они бесполезны так-то. Монстр декомпиляции дискредитирован! И на этом всё! <img src="img/smilies/s1.gif" alt=""><br><br><I>reversecode пишет:<br>причесал </I><br>Немодная причёска, 67 строк против 37 <img src="img/smilies/s1.gif" alt=""><br><br><I>reversecode пишет:<br>там на самом деле бинарь скомпилирован без оптимизации с dwarf, поэтому такие конструкции и остались,думаю если бы включили оптимизацию, компилер мог поулучшать все эти переходы </I><br>Реверс, развёрнутые циклы есть ещё в других местах, совсем не в необходимых - это прямо доказывает, что оптимизация <b>как-то</b> влючена. )<br>Разворачивание циклов даёт вообще-то маленькое преимущество и при их вложенности одного в другой, за счёт избавления от проверок счётчика и непредсказуемого сброса кэша инструкций. Но циклы в тех местах, где они выполняются всего однажды за одно чтение файла. Чего там именно оптимизировать - гадали разработчики долго <img src="img/smilies/s1.gif" alt=""><br><br>P.S. Писали ООП-маньяки...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=359076&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=18" class="addthx" data-post="359076"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2015 16:17 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
хз чем дискредитирован? гоуту всегда были проблемой рейса, ильфак новую математику изобратать не может, <br>а по той что писал аглосы для детекта циклов итд, другую не изобрели напишешь теорию, и ильфак заложит эти алгосы в рейс))<br><br>к ооп там вообще никаким местом, нет ооп подхода
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359079&amp;user=15381&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=19" class="addthx" data-post="359079"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2015 16:45 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>reversecode пишет:<br>к ооп там вообще никаким местом, нет ооп подхода </I><br>Не, это дописал без пояснений. Не захотел пояснять. Рейс, и проблемы, о которых написао - действительно к ООП не имеют отношения. Но чтение файла сделано - потребовалось, пипец, порядка 10 структур, массивом со списком кешей приплели(из-за массива кешей и тормозила и падала ида) и прочую лабуду. Не ООП? Это также можно было б вырезать, на 5 мб сократив код. )<br><br>На уроке по ООП однокурсник получает задание. Точно не помню уже какое, но смысл был именно использовать при реализации классы. Сделано было без них, потому что они там не нужны были. Доказать преподу, что надо задачи решать как можно проще, не удалось... Студентов некоторых ВУЗов учат вставлять классы, объекты везде, где только можно. Маниакализм! )<br><br><I>reversecode пишет:<br>ильфак новую математику изобратать не может </I><br>То, что новую &quot;математику&quot; кто-то не может &quot;изобрести&quot; - это совсем не проблема математики! <img src="img/smilies/s1.gif" alt=""><br>Математика сейчас на достаточном уровне, чтоб заложить нужную &quot;математику&quot; так, как надо.<br><br><I>reversecode пишет:<br>напишешь теорию, и ильфак заложит эти алгосы в рейс </I><br>Что мне с этого? ) Вариант! Но трудно реализуемый! И не в профессиональном смысле &quot;трудно&quot;.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=359081&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=20" class="addthx" data-post="359081"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2015 16:49 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
да я все понял что ооп не к рейсу, и ответил, что ооп там в той прошивке нет, ну ясно дело в классах что то реализовали и все<br><br>ильфак не изобретатель теории математики и новых алгоритмов, рейс писан по книге по типу дракона где все алгосы и их детекты описаны, новых еще никто не изобрел<br><br>тебе с этого слава, и много предложений о работе, будешь всемирно известный, а это почти == богатый
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359082&amp;user=15381&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=21" class="addthx" data-post="359082"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2015 16:54 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>reversecode пишет:<br>тебе с этого слава, и много предложений о работе, будешь всемирно известный, а это почти == богатый </I><br>Это нужно вклад времени сделать, жертвуя многим, веря и не сомневаясь в том, что от старта до момента запланированного финиша ничего не случится с тобой, с семьёй, и не начнётся война. <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=359083&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=22" class="addthx" data-post="359083"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 октября 2015 00:59 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Опять вмпрот x64.<br><br>Непонятно из-за чего после 3х-месясячной паузы в этом направлении, несмотря на 2х-недельный разгон мозга, в скорости отстаю от прежних результатов в среднем около часа на 3, но в некоторых моментах... На этот раз всё же вместо 5 недель будет 3. Жалею, что не нашлось времени на анпакер.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=359613&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=23" class="addthx" data-post="359613"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.53'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 октября 2015 11:21 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Жалею, что не нашлось времени на анпакер.<br> </I><br><br>Твой анпакер использует DebugAPI или всё распаковывается в статике?
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=359624&amp;user=31056&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=24" class="addthx" data-post="359624"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 октября 2015 22:32 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
Его пока ещё нет, есть только алгоритм действий и в них включено использование вмтрейсера. И в этом алгоритме пока нет части, как проводить анализ снятых логов. Вмтрейсер делает пока маленькую работу.<br><br>Есть определённая алгоритмическая задача, как вмтрейсер превратить в &quot;девиртуализатор&quot; (по аналогии с &quot;ассемблер&quot; - &quot;дизассемблер&quot;), особенно в частях, где байт-код ветвится... И вот когда будет он, и из переведённого на простой язык байт-кода деобфускатор удалит мусор, и другим модулем проанализируется требуемая часть логики, отбросится всё ненужное... тогда это и будет анпакер. Пока так я себе это представляю. По удалению мусора из различных функций (получение ид устройств, формирование хвида, кодирование хвида ключом, декрипт строк, распаковка, импорт, ...) особой работы нет, повторюсь - оно на глаз воспринимается легко, сразу видно, где мусор.<br><br>Вот для чего я столько написал, чтобы ответить на твой вопрос?... Собственно говоря, искал место для DebugAPI в анпакере. )))<br><br>Метод обхода антидебага в вмпроте этой версии достаточно прост:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">kernel32_IsDebuggerPresent<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">bSuccess&nbsp;<span class="hl_char">=</span>&nbsp;kernel32_CheckRemoteDebuggerPresent<span class="hl_char">(</span>GetCurrentProcess<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>bBeingDebugged<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns&nbsp;<span class="hl_number">1</span><span class="hl_char">,</span>&nbsp;bBeingDebugged&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">NtStatus&nbsp;<span class="hl_char">=</span>&nbsp;ntdll_NtQueryInformationProcess<span class="hl_char">(</span>GetCurrentProcess<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;ProcessDebugObjectHandle<span class="hl_char">(</span>0x1e<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>DebugHandle<span class="hl_char">,</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>HANDLE<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns&nbsp;0xC0000353<span class="hl_char">(</span>STATUS_PORT_NOT_SET<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;DebugHandle&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">NtStatus&nbsp;<span class="hl_char">=</span>&nbsp;ntdll_NtSetInformationThread<span class="hl_char">(</span>GetCurrentThread<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;ThreadHideFromDebugger<span class="hl_char">(</span>0x11<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;предотвратить&nbsp;обращение</li>        </ol>
    </div>
</div></div>
<br><br>Но! Для анпакера не требуются действия по анти-анти-отладке. Можно ветки кода с антидебажными проверками(всего одна, перед распаковкой), а также с проверками crc(статическая и рандомная, встречается достаточное число раз, чтоб отсеять нетерпеливых и непредусмотрительных) просто исключить. Это можно сделать и вручную, даже можно наполовину распаковать вручную, так чтобы не требовался обход антиотладки вообще в дальнейшем. Скрипт для ольки от LCF-AT и делает это с использованием платформы с DebugAPI так же - наполовину! Но под x86, и не всегда корректно, особенно для dll (DISABLE_ASLR_BY_SCRIPT для dll по меньшей мере - наивность). От OEP он не снимает прот - то есть не избавляет от байт-кода дальше, не заложена в него эта функция.<br><br>Добрались, наконец, до ответа:<br>Анпакер, задуманный мной, будет полностью автономный, и будет представлять собой реализацию алгоритма, по которому можно снять прот и вручную, но с расширенными функциями для упрошения последующего анализа человеком. А потому DebugAPI ему будет не нужен.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=359667&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=25" class="addthx" data-post="359667"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31056" title="29-10-2015 23:01, ранг:86.8" target="_blank">hors</a>, <a href="action=userinfo&user=25500" title="31-10-2015 07:04, ранг:36.7" target="_blank">igorca</a>, <a href="action=userinfo&user=31932" title="16-12-2015 10:33, ранг:3.3" target="_blank">TLN</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2015 00:32 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>hors пишет:<br>Тогда это vmprotect версии 2.06 или старше(2.06-2.13)  </I><br>Зашёл как всегда на форум, по привычке проверил все сообщения - скучно... Но благодаря карме Спекзи наткнулся вот <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=13406&amp;page=0#12" rel="nofollow" target="_blank">--&gt; тут &lt;--</a></noindex> (и не только) на историю форума 7 лет назад, в том числе и  на ярый разбор вмпрота пропавшим куда-то Демоном. И dermatolog давно не появлялся. А вот дела, оказывается он и есть автор вмпрота <img src="img/smilies/s14.gif" alt="">... Да, я много пропустил, поздно появился интернет... Так вот по строчке о детекте отладки можно также сказать, что это может быть и 1.7. Там она тоже шифровалась. Не знаю, неубедительный признак )<br><br>Кол-во примитивов разбиравшейся Демоном прожки под вмпротом было 48, а не 79, как было у меня в мае. Сейчас это 79. Это может быть признаком версии, хотя вполне может быть настраиваемо. Не знаю, как там автор задумал, ни разу не видел и и не надо пока.<br><br>Увлекательное чтиво оригинальных фраз dermatolog, Demon666, ... 7 лет назад было меньше вменяемых людей? <img src="img/smilies/s15.gif" alt=""><br><br><b>Добавлено спустя 17 часов</b><br>Что-то меня потянуло на историю, аж не выспался... К автору вмпрота отношусь нейтрально, то, что там, когда-то было у него с кем-то, и у кого-то с ним - так бывает иногда. Это совсем никак не говорит о постоянных плохих или хороших человеческих качествах... Не буду судить о человеке, он вполне кажется нормальным, просто где-то чуть лишне реагировал. Видимо, какая-то вспыльчивость каждому присуща...<br><br>Всё-таки установил, вроде, минимальную версию прота, которым накрыта была одна и сейчас другая поделка. По <noindex><a href="http://vmpsoft.com/20100926/vmprotect-2-06-is-released/#more-309" rel="nofollow" target="_blank">такому признаку</a></noindex> имеем дело с версией не меньше 2.06. Именно функция VMProtectBeginVirtualizationLockByKey(), позволяющая защитить код ключом так, что без правильного ключа команда выполнится неправильно, и определяет минимум использованного прота. До 2.06, как я понял, ничего подобного не было. По крайней мере не нашёл...<br><br>Схематично, условно и более просто это выглядит так под защитой VMProtect<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>оригинальный&nbsp;код</li><li class="hl_l1">a&nbsp;<span class="hl_char">=</span>&nbsp;0x10<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>код&nbsp;под&nbsp;защитой&nbsp;VMProtect&nbsp;с&nbsp;ключом&nbsp;0x46</li><li class="hl_l0">a&nbsp;<span class="hl_char">=</span>&nbsp;0x56&nbsp;^&nbsp;key<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>Понятно, что взятый наугад ключ, пройдя проверку валидности (по правилам, описанным выше, ну или необязательно у меня) только один из 4 млрд даст нужное значение 0x10 для инициализации переменной. Если результат работы защищаемой программы очень зависит от него, то проверить все со скоростью 1 проверка/сек можно одним компьютером за 136 лет, либо сетью в 30 млн компов за 4 месяца. Только валидная пара поможет установить верный ключ. Тут есть несколько моментов, как улучшить защиту от подмены &quot;левой&quot; пары, чтоб в итоге обеспечить более надёжную защиту... Хз, реализовано оно или нет уже в новых версиях, но писать не хочу об этом пока. <img src="img/smilies/s1.gif" alt=""><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">2</span><span class="hl_char">.</span><span class="hl_number">06</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">=</span>&nbsp;Version&nbsp;<span class="hl_char">&lt;</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">.</span><span class="hl_number">13</span></li>        </ol>
    </div>
</div></div>
<br><br>Ладно, поинтересовался немного - пора от этого отстать, всё раскапывать - время надо.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=360056&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=26" class="addthx" data-post="360056"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31932" title="04-12-2015 07:14, ранг:3.2" target="_blank">TLN</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.53'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2015 12:01 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<I>DenCoder пишет:<br> Так вот по строчке о детекте отладки можно также сказать, что это может быть и 1.7. Там она тоже шифровалась. Не знаю, неубедительный признак </I><br><br>Шифрование строк загрузчика появилось в версии 2.06
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=360072&amp;user=31056&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=27" class="addthx" data-post="360072"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2015 19:02 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<I>hors пишет:<br>Шифрование строк загрузчика появилось в версии 2.06  </I><br>Да, наверное, стоит согласиться. Принял под словами ацкого Демона &quot;расшифровка адреса&quot; расшифровку строки...<br><br>Ну да ладно, 2 признака версий 2.06+ теперь известны: 1) дешифровка строк; 2) наличие(и использование) функции VMProtectBeginVirtualizationLockByKey(). 2ой признак часто не выявить до самого конца анализа логов вмтрейсера, потому будет неудобным в определении версии. Но и наличие 1ого признака выявить - нужно сначала попасться на антиотладке. У тебя, <b>hors</b>, die детект этой вм сделан на основе первых байт и имён секций, как я смотрел вскользь. Это даёт 100% определения? Для x64 он всё же не определяет версию.<br><br>Интересует версия 2.13. Вроде бы там dermatolog(он до сих пор, наверное, во главе и возможно с командой), сделал срок действия лицензии.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">1</span><span class="hl_char">)</span>Activation&nbsp;codes&nbsp;can&nbsp;now&nbsp;expire<span class="hl_char">.</span>&nbsp;Great&nbsp;for&nbsp;promotions<span class="hl_char">!</span></li><li class="hl_l1"><span class="hl_number">2</span><span class="hl_char">)</span>Both&nbsp;expiration&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_function">end</span><span class="hl_char">-</span>of<span class="hl_char">-</span>support&nbsp;dates&nbsp;can&nbsp;be&nbsp;now&nbsp;relative<span class="hl_char">,</span>&nbsp;so&nbsp;you&nbsp;can&nbsp;make&nbsp;them&nbsp;work&nbsp;for&nbsp;a&nbsp;month&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;year&nbsp;since&nbsp;the&nbsp;selling&nbsp;date<span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br>Не уверен смогу ли найти. Не попадалось никому такое?
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=360083&amp;user=24257&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=28" class="addthx" data-post="360083"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31932" title="01-12-2015 18:10, ранг:3.2" target="_blank">TLN</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.53'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2015 21:23 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Это даёт 100% определения? </I><br><br>100% Определения не даёт никто, а для быстрого детекта того что есть вполне достаточно.
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=360086&amp;user=31056&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=29" class="addthx" data-post="360086"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.17'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 декабря 2015 05:28 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=23661&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
ну может и не ново, но в 2.11 добавили активацию, соответственно всё, что выше 2.11 (вплоть до 3.07) определяется по наличию таких строк в секции с вм:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">type<span class="hl_char">=</span>activation<span class="hl_char">&amp;</span><span class="hl_function">code</span><span class="hl_char">=</span></li><li class="hl_l1">type<span class="hl_char">=</span>deactivation<span class="hl_char">&amp;</span>hash<span class="hl_char">=</span></li><li class="hl_l0">activation<span class="hl_char">.</span>php<span class="hl_char">?</span><span class="hl_function">code</span><span class="hl_char">=</span></li><li class="hl_l1">deactivation<span class="hl_char">.</span>php<span class="hl_char">?</span>hash<span class="hl_char">=</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=360950&amp;user=16624&amp;forum_n=12&amp;topic=23661&amp;page=0&amp;anchor=30" class="addthx" data-post="360950"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=12&amp;topic=23661&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=12&amp;topic=23661&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=12&amp;topic=23661&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/blog.png" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=12&sortBy=0&page=0.html"><b>Дневники и блоги</b></a> <b class=bulletHead>&#8212;&#8250;</b> Блог DenCoder&#039;а</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="12">
<input type="hidden" name="topic" value="23661">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23661" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
