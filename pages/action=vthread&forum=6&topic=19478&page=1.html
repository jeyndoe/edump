<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Многослойное динамическое шифрование (пример полиморфного кода на C/C++) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Везде так много говорится о крутости шифрования кода на лету и даже не просто шифрования, а ещё и многослойного, но нигде я что-то не могу найти примера, который бы на пальцах показывал что это такое. Может есть у кого самый">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=1288'>UniSoft</a>, <a target='_blank' href='?action=userinfo&amp;user=7823'>ManHunter</a>, <a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Многослойное динамическое шифрование (пример полиморфного кода на C/C++)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=19478&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=19478&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]wowfactor[/b]','')">wowfactor</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.49'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 января 2012 18:55 <br><script type="text/javascript">QU('wowfactor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wowfactor" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Везде так много говорится о крутости шифрования<br>кода на лету и даже не просто шифрования, а ещё<br>и многослойного, но нигде я что-то не могу найти<br>примера, который бы на пальцах показывал что это<br>такое.<br><br>Может есть у кого самый минимальный-минимальный<br>пример на си, который показывает суть методики<br>многослойного шифрования кода, чтобы сразу<br>стало понятно что такое многослойное, а что такое<br>однослойное шифрование?<br><br>В идеале хотелось бы пример, который можно было <br>бы скопировать в файл a.cpp и запустить <br><br>c:\&gt; g++ a.cpp &amp;&amp; a.exe<br><br>PS. я на этом форуме новенький, мне хочется попросить<br>администрацию добавить к кнопкам style=&quot;cursor:pointer&quot;<br>куда с этим вопросом обращаться?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299210&amp;user=31149&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=1" class="addthx" data-post="299210"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 10:56 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
<b>wowfactor пишет:<br>задача моей защиты страшно рявкнуть</b><br>Вспомнил, как в далекие 90 годы ломал одну софтинку под DOS - результатом неправильного взлома было сообщение что активирован такой-то вирус, который поразил ваш комп. При подробном разборе проги выяснилось, что если идти по неправильному пути - то действительно распаковывается и активируется вирус, если же путь распаковки правильный, то о вирусе никто ничего и не знает.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299331&amp;user=20406&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=2" class="addthx" data-post="299331"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]wowfactor[/b]','')">wowfactor</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.49'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 12:28 &middot; Поправил: wowfactor <br><script type="text/javascript">QU('wowfactor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wowfactor" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
2 HandMill<br>&gt; Надеюсь смешать код на си и ассемблере <br>&gt; для вас проблем не составит<br><br><b>составит</b><br><br>я не системщик, асма не знаю и опыта<br>смешивания си и асма у меня пока не было<br><br>скоро мне предстоит процедура, которую<br>я очень боюсь - научиться выдирать код<br>апишных функций и инлайнить их в код своих<br>программ с нарушением структуры инъекции,<br>мешающей поиску по паттерну, но с полным <br>сохранением функциональности вставки<br><br>мне насколько страшна сама эта мысль,<br>что я даже пока думать о ней не хочу<br><br><br>&gt; http://indy-vx.narod.ru/Bin/GCBE.zip <br><br>я там ничего не понял<br>и вообще я там ни одного сишного файла<br>не нашел<br><br><br>2 Dart Sergius<br>&gt; ну или что-то типо такого мутить<br><br>а где здесь способ определения длины процедуры?<br>и как в этом способе зашифровать например<br>три функции сразу?<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;state<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;{&nbsp;state1<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">; }</span></li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;state1<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;{&nbsp;state2<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">; }</span></li><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;state2<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;{&nbsp;state3<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">; }</span></li>        </ol>
    </div>
</div></div>
<br><br>как по вашей методике взять этот блок<br>целиком, скопировать его в кучу, там<br>зашифровать, переместить в новое место,<br>расшифровать, выполнить, опять защифровать<br>и опять переместить в новое место?<br><br>может тут дефайнами надо какие-то<br>метки вставлять на асме или что-то<br>типа того, а потом адреса этих меток<br>вычитать, чтобы получить длину блока<br>и ещё надо как-то от компилятора<br>защитится чтобы он не раскидал эти<br>функции внутри объектного файла<br><br>2 mak<br>&gt; cам не знаешь, что тебе конкретно нужно<br><br>нужно самый простой пример на си многослойного<br>шифрования исполняемого кода в рантайме<br><br>&gt; даже не посмотрел похоже<br><br>я открыл статью, что такое Triple Des,<br>там написано - это такой шифр, я закрыл<br>статью и написал, что шифры не в этой<br>теме. что не так?<br><br>&gt; определись с терминами<br><br>какой именно использованный мной термин<br>или фраза вызывает у вас многозначное <br>толкование?<br><br>эта тема не о стойкости криптоалгоритмов,<br>а о многослойности шифрования исполняемого кода<br><br>&gt; в многослойном шифровании может использоваться<br>&gt; один и тот же криптоалгоритм, а может <br>&gt; и разные<br><br>для упрощения понимания многослойности<br>было принято решение использовать только ксор<br><br>&gt; сюда же входит тема о комбинации криптоалгоритмов<br><br>нет, не входит<br>конкретно в этой отельной теме - только ксор<br><br><I>&gt; Какие примеры конкретно ты хочешь увидеть? С ксором?</I><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;exeblock<span class="hl_char">(</span><span class="hl_function"><b>void</b></span>&nbsp;<span class="hl_char">*</span>p<span class="hl_char">)</span>&nbsp;{&nbsp;asm&nbsp;volatile&nbsp;<span class="hl_char">(</span><span class="hl_quote">&quot;call *%0&quot;</span><span class="hl_char">:</span><span class="hl_char">:</span><span class="hl_quote">&quot;r&quot;</span><span class="hl_char">(</span>p<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">; }</span></li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;crypt<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">&amp;</span>&nbsp;buf<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;count&nbsp;<span class="hl_char">=</span>&nbsp;strlen<span class="hl_char">(</span>buf<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;buf<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;0x79<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">; i &lt; count; i++) buf[i] ^= buf[i-1];</span></li><li class="hl_l0">}</li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;decrypt<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">&amp;</span>&nbsp;buf<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;count&nbsp;<span class="hl_char">=</span>&nbsp;strlen<span class="hl_char">(</span>buf<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;for<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;count<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">; i &gt; 0 ; i--) buf[i] ^= buf[i-1];</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;buf<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;0x79<span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function">void</span><span class="hl_char">*</span>&nbsp;pFrom<span class="hl_comment">; void* pTo;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;state<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;{&nbsp;state_<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">; }</span></li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;state_<span class="hl_char">(</span><span class="hl_char">)</span>{&nbsp;<span class="hl_char">:</span><span class="hl_char">:</span>flag<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_comment">; }</span></li>        </ol>
    </div>
</div></div>
<br><br>я хочу чтобы кто-нибудь добавил в этом<br>примере строчки, которые позволят:<br><br>1. скопировать блок из двух функций<br>   state() и state_() в кучу <br>   и сохранить адрес в pFrom<br>   <br>2. там его зашифровать через crypt()<br>   и скопировать полученную шифрованную<br>   строку в новое место в куче и адрес<br>   сохранить в pTo<br>   <br>3. потом расшифровать из pTo с помощью<br>   decrypt() и выполнить этот блок из двух<br>   фукнций через exeblock()<br><br><br><br>&gt; тебе таким образом сколько примеров <br>&gt; не показывай, мало будет.<br><br>одного примера вполне хватит<br><br>если вы под примером понимаете какой-нибудь<br>проект на 80000 LOC в котором где-то на 32500 строке<br>содержится пример горячего дешифрования<br>куска кода с последующим шифрованием,<br>то я не этот пример имел ввиду, когда<br>просил пример<br><br>мне кажется, что пример, который я прошу,<br>должен как-то уместиться в 20-25 строчек,<br>то есть что-то такое, что профессионал<br>может написать по памяти прямо на ходу<br><br>&gt; c простым ксором многослойное шифрование <br>&gt; можно найти в крипторах, там и будет <br>&gt; нужный полиморф по условию темы<br><br>мне может не хватить квалификации вычлинить<br>пример горячего шифрования кода среди<br>алгоритма самого шифра, поэтому я и прошу<br>детский пример, изолированно демонстрирующий<br>горячее шифрование
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299334&amp;user=31149&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=3" class="addthx" data-post="299334"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]wowfactor[/b]','')">wowfactor</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.49'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 12:31 <br><script type="text/javascript">QU('wowfactor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wowfactor" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
2 Vamit<br>&gt; распаковывается и активируется вирус<br><br>я был на открытом семинаре отдела К <br>и там нам рассказывали, что создание вирусов - <br>это УК риски, поэтому так лучше не делать никогда
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299335&amp;user=31149&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=4" class="addthx" data-post="299335"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]yagello[/b]','')">yagello</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.1 (постоянный), 30thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.56'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=23568">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 12:44 <br><script type="text/javascript">QU('yagello','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=yagello" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<I>wowfactor пишет:<br>я был на открытом семинаре отдела К </I><br>Это было еще до отдела &quot;К&quot; и не факт, что в России.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299336&amp;user=23568&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=5" class="addthx" data-post="299336"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 13:54 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
<b>wowfactor</b> я б для начала тебе посоветовал, прежде чем лезьт в такие дебри почитать о способах создания само модифицируемого кода. я сделал, правда на Делфе движочек. Правда недоделал обработку некоторых комманд. Так вот этот движок, берет код, по 1ой комманде уносит его в спец. отведенную область и там ее выполняет, а а движок контролирует выполнение этой комманды (типа что на  входе что на выходе). Своеобразная виртуальная машина. Не статическая не димначеская, а чтото среднее. Я это к чему веду. Я написал его на делфе. с 1ой лиш вставкой асма. Типа реально все, ток высокоуровневые языки от таких эксперементов с ума сходят.
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299337&amp;user=17319&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=6" class="addthx" data-post="299337"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 13:59 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
&gt;научиться выдирать код апишных функций и инлайнить их в код своих программ<br>&gt; с нарушением структуры инъекции, мешающей поиску по паттерну, но с полным <br>&gt; сохранением функциональности вставки<br><br>Эх, опять фигней страдаете. Такого добра в современных протекторах полным полно. И обходится так же элементарно. Как правило каждая АПИ вызвает еще АПИ, которые в свое время все равно могут быть переловлены. К примеру если вы полностью выдерите апи функцию CreateFileA и сделаете ее невидимой для взломщика, то ему не составит труда переловить ZwCreateFile, которая вызывается из CreateFileA и которую уже никак не проэмулируешь, потому что это низкоуровненвая процедура, не используемая в языках высокого уровня.
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299338&amp;user=2775&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=7" class="addthx" data-post="299338"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=28841" title="18-01-2012 10:25, ранг:25.9" target="_blank">vden</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]OKOB[/b]','')">OKOB</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6801.png" alt=""><br><span class=txtSm>Ранг: 527.7 (<b>!</b>), 381thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.78'>Активность: 0.16<span style='color:red'>&searr;</span>0.09</span><br>Статус: <a href="action=userinfo&amp;user=6801">Участник</a><br><font color=blue><font color=red>Победитель турнира 2010</font></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 14:12 &middot; Поправил: OKOB <br><script type="text/javascript">QU('OKOB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OKOB" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<I>wowfactor пишет:<br>я хочу чтобы кто-нибудь добавил в этомпримере строчки, которые позволят </I><br><br>strlen работать не будет, т.к. в коде как криптованом так и нет могут быть нули (признак конца С строки)<br><br><img src="img/attach.gif" alt=""> <a href="./files/430a_18.01.2012_EXELAB.rU.tgz">430a_18.01.2012_EXELAB.rU.tgz</a> - zzz.RAR
<br><br><font size="1"><i>-----<br>127.0.0.1, sweet 127.0.0.1</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299340&amp;user=6801&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=8" class="addthx" data-post="299340"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31149" title="18-01-2012 11:22, ранг:8.0" target="_blank">wowfactor</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 14:17 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<I>wowfactor пишет:<br>мне кажется, что пример, который я прошу,<br>должен как-то уместиться в 20-25 строчек,<br>то есть что-то такое, что профессионал<br>может написать по памяти прямо на ходу </I><br>Нужно размапить PE файл, а это не 25 строчек, говорю же основ не знаешь. Скачай с офсайта ASProtect, у него прямо с EP начинается многослойное дешифрование загрузчика, слоев 6-8. Если не понимаешь в дизасме и отладке машинных команд, то пример на Си тоже тебе ничего не даст, т.к. результаты можно будет увидеть только в дизасме/отладчике.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299341&amp;user=3232&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=9" class="addthx" data-post="299341"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=17432" title="18-01-2012 10:50, ранг:286.1" target="_blank">ClockMan</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 14:18 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
<I>wowfactor пишет:<br>1. скопировать блок из двух функций<br>state() и state_() в кучу <br>и сохранить адрес в pFrom</I><br><br>ну бери и копируй, в чём сложность?<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">_asm&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;state</li>        </ol>
    </div>
</div></div>
<br><br>ну а дальше например с помощью memcpy копируй куда надо. либо функу на асме написать. узнать размер функи можно заюзав какие-нибудь маркеры, либо дисасм прикрутить. либо ручками посчитать на крайняк, но это не кошерно.<br><br><I>wowfactor пишет:<br>2. там его зашифровать через crypt()<br>и скопировать полученную шифрованную<br>строку в новое место в куче и адрес<br>сохранить в pTo </I><br>тоже самое, копируешь, я бы выделил память VirtualAlloc (либо malloc) и копировал уже туда.<br>С расшифровкой тоже самое.<br><br>Может я чёт не так понял, но причём тут шифрование я хз, закриптовать ты и сам знаешь как...асм учи.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299342&amp;user=16624&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=10" class="addthx" data-post="299342"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]vden[/b]','')">vden</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 112.9 (ветеран), 186thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.22'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=28841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 14:49 &middot; Поправил: vden <br><script type="text/javascript">QU('vden','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vden" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
<I>wowfactor пишет:<br>чувак, я ни хрена не понял, что ты сказал, </I><br><br>ну подразумевалось закинуть exe в IDA и потрейсить с адреса 510754.<br>имхо, если проблемы с асмом и дизасмом, то пока рановато защиты делать.<br><br>все же если интересно, то вот мой примитивный сорс (на Delphi)<br><img src="img/attach.gif" alt=""> <a href="./files/7c31_18.01.2012_EXELAB.rU.tgz">7c31_18.01.2012_EXELAB.rU.tgz</a> - example.dpr
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299347&amp;user=28841&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=11" class="addthx" data-post="299347"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]OKOB[/b]','')">OKOB</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6801.png" alt=""><br><span class=txtSm>Ранг: 527.7 (<b>!</b>), 381thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.78'>Активность: 0.16<span style='color:red'>&searr;</span>0.09</span><br>Статус: <a href="action=userinfo&amp;user=6801">Участник</a><br><font color=blue><font color=red>Победитель турнира 2010</font></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 14:49 &middot; Поправил: OKOB <br><script type="text/javascript">QU('OKOB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OKOB" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
CodeBreakers Magazine Vol.1, No 2, 2006, <br>автор Giovanni Tropeano<br>статья Self Modifying Code <br><br>http://www.scribd.com/doc/47681501/65-276-1-PB<br><br>или<br><br>книга C/C++ Secure Programming<br>автор Gene Spafford<br>глава 12. Anti-Tampering<br>раздел 12.17 <noindex><a href="http://etutorials.org/Programming/secure+programming/Chapter+12.+Anti-Tampering/12.17+Using+Self-Modifying+Code/" rel="nofollow" target="_blank"> Using Self-Modifying Code</a></noindex>
<br><br><font size="1"><i>-----<br>127.0.0.1, sweet 127.0.0.1</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299348&amp;user=6801&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=12" class="addthx" data-post="299348"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=17319" title="18-01-2012 11:05, ранг:119.9" target="_blank">VodoleY</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]wowfactor[/b]','')">wowfactor</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.49'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 17:14 <br><script type="text/javascript">QU('wowfactor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wowfactor" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
2 VodoleY<br>&gt; почитать о способах создания само модифицируемого кода<br><br>так, блин, в этом-то и вопрос!<br>где можно прочитать про самомодифицирующийся<br>исполняемый код с изложением на си (а не на дельфи)<br>начиная с самых-самых простых примеров<br><br>мне ниже советуют скачать сорсы боевого проектора<br>и там найти способы; выше соверуют скачать<br>сорсы боевого шифра и там найти; а я сдохну,<br>пока в них найду пример выскусывания кода<br>с последующими манипуляциями<br><br>&gt; я сделал, правда на Делфе движочек<br><br>передо мной не стоит цели создавать<br>ни виртуальную машину, ни peloader,<br>а лишь хочу управлять подачей инструкций<br>в уже действующий конвеер внутри исполняемой<br>программы<br><br>2 Maximus<br>&gt; все равно могут быть переловлены<br><br>1. я осознаю риски о которых вы пишите<br><br>2. я вижу суть инъекций не в том, что <br>отловить нельзя, а в том, чтобы свести вызовы<br>с редкими сигнатурами к вызовам с частыми<br>сигнатурами. важно сделать так, чтобы<br>из 1000 вызовов пришлось бы искать лишь<br>одну верную дорогу<br><br>плюс задача-то у меня простая: поставить<br>защиту, которую нельзя снять с помощью<br>туториала, а можно снять только с помощью<br>своей головы<br><br>знаете есть в америке такие цикады, которые<br>вылупляются на свет только раз в 17 лет<br>и они свободно покрывают собой весь город,<br>потому что никто из птиц их не ест, хотя<br>для птиц они очень вкусные. птицы их даже<br>пугаются! новизна и необычность подзадоривает<br>профессионалов, а для ламмеров она наоборот<br>стимулирует пугающую фантазию<br><br>я не собирался фейковать createfile,<br>потому что этот вызов отлично смешивается<br>с &quot;нормальными&quot; созданиями файлов,<br>а вот getfiletime - это слишком<br>явный редкий вызов, который хотелось бы<br>свести к набору каких-нибудь других вызовов,<br>которых в обычной программе дофига<br><br>getsystemtime всем хорош, но он отлючается<br>слишком уж просто: достаточно часы отмотать<br><br>&gt; никак не проэмулируешь, потому что это <br>&gt; низкоуровненвая процедура, не используемая<br>&gt; в языках высокого уровня<br><br>я не знаю пока как решается эта задача<br><br>может можно как-то через ассемблерную <br>вставку получать дату последного обращения<br>к файлу. важно найти только такой способ,<br>чтобы он не был уникальным по отношению<br>к обычной работе прикладной программы<br><br>я в эту тему пока даже не вникаю -<br>это надо отдельное время и отдельные<br>нервы<br><br>2 OKOB<br>&gt; 430a_18.01.2012_EXELAB.rU.tgz - zzz.RAR <br><br><b>Аллилуя, господи!!! Аллилуя!!!</b><br><br>не понятно только зачем двойную память <br>выделяем, а так - Аллилуя!!!<br><br>&gt; если не понимаешь в дизасме и отладке<br>&gt; машинных команд, то пример на Си тоже <br>&gt; тебе ничего не даст, т.к. результаты можно<br>&gt; будет увидеть только в дизасме/отладчике.<br><br>ну отчего же? я же смог понять пример OKOB&#039;а<br>оказалось, что кастинг сигнатуры функции<br>дает адрес начала блока, а для вызова любого<br>raw-куска достаточно скастить void* указатель<br>к указателю на функцию - вот и вся кухня<br>с полиморфным шифрованием в рантайме<br><br>&gt; _asm mov eax, offset state<br><br>зачем? оказалось все проще (int*)state<br><br>&gt; я чёт не так понял, но причём тут шифрование<br><br>как причем? с момента вывода кода в кучу<br>мы можем им управлять в рантайме, а значит<br>код, который у нас в самой программе и код<br>который реально выполняется - это не одно<br>и то же, а это и есть шифрование по определению<br><br>2 vden<br>&gt; вот мой примитивный сорс (на Delphi)<br><br>спасибо, но я на нем не шарю<br>как-то не сложилось у меня с ним<br><br>2 OKOB<br>&gt; http://www.scribd.com/doc/47681501/65-276-1-PB<br><br>the length of the body of a function is equal <br>to thedifference between the pointer to the function<br>and thepointer to the function following it. Easy!<br><br>ну почему такие статьи хрен найдешь<br>через гугл, а только через общение, блин!<br><br>====<br><br><br>короче, какие у меня были вопросы о принципе<br>многослойности шифрования я их получил<br>через пример OKOB&#039;а и статью этого Джованни<br><br>спасибо всем, кто помогал мне при записи <br>этого альбома <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299356&amp;user=31149&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=13" class="addthx" data-post="299356"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 19:03 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
<b>wowfactor</b> На самом деле все просто. код можно сделать модифицируемым не так многими спосабами. <br>1. выполнять в стеке (там секция с досупом на чтения и запись)<br>2. выделять область памяти и VirtualProtectom изменять доступ<br>3. с помью MapedFile (им я и пользуюсь обычно)<br>И ПРОЧИТАЙ ТО ЧТО ТЕБЕ ОКОВ подогнал. <br>З.Ы. есть еще более извращенные способы. но и этого с головой<br>З.Ы.Ы, про 7ку точно не знаю, в ней вроде запретили код в стеке выполнять.<br>про модификацию кода у Касперского Криса пару неплохих и легеньких статей.
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299358&amp;user=17319&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=14" class="addthx" data-post="299358"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]wowfactor[/b]','')">wowfactor</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.49'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2012 00:58 <br><script type="text/javascript">QU('wowfactor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wowfactor" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
2 VodoleY<br><br>я прочитал и статью, и главу которую он дал,<br>и про ваши три метода прочитал <br>и не понимаю нафиг они все нужны?<br><br>ведь благодаря примеру ОКОВ&#039;а мы видим,<br>что какое угодно рантайм манипулирование,<br>в т.ч. шифрование можно мутить с помощью <br>самого банального маллока, а адреса брать <br>тупо кастингом сигнатур функций, а любой <br>raw-блок памяти можно вызвать через кастинг<br>указателя на этот блок к указателю на функцию<br><br>не знаю кому как, а мне маллока хватит<br>с головой<br><br>спасибо ОКОВу ещё раз
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299375&amp;user=31149&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=15" class="addthx" data-post="299375"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2012 01:49 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
<I>wowfactor пишет:<br>задача текущей темы не peloader&#039;ы изучать,а многослойность, то есть не сложностьстроковых декрипторов, а полифорфизмисполняемого кода в рантайме средствами си </I><br><br>То есть какой-то сферический конь в вакууме. Реальную проблему удержания кода в рабочем виде - кому оно надо <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299378&amp;user=10168&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=16" class="addthx" data-post="299378"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2012 06:00 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
<I>wowfactor пишет:<br>так, блин, в этом-то и вопрос!<br>где можно прочитать про самомодифицирующийся<br>исполняемый код с изложением на си (а не на дельфи)<br>начиная с самых-самых простых примеров </I><br>ехх<br>нет у вас полёта мысли<br><br>зачем вам asm?<br>пишите свою VM на сях или плюсах<br>которая будет уметь работать только с вашими абстрактными данными <br>где данные и будет ваша программа на тех же опять сях или плюсах<br>ну итд<br>асбтракция над абстракцией<br>всего то...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299380&amp;user=15381&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=17" class="addthx" data-post="299380"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b][-alex-][/b]','')">[-alex-]</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.0 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.04'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=21477">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2012 10:12 <br><script type="text/javascript">QU('[-alex-]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[-alex-]" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
Забавный тред. Знаний у ТС ноль в нужном направлении, платить кому то - не хочется, а самому разбираться и писать - лениво. И активное обсуждение при этом.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299383&amp;user=21477&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=18" class="addthx" data-post="299383"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=4554" title="19-01-2012 06:22, ранг:174.7" target="_blank">HandMill</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2012 10:39 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
С самого начала топик мне не нравился, пора его уже закрыть, пожалуй. И так самплы уже дали.<br>И вообще здесь форум не защиты софта, если что, поэтому не стоит сюда с такими вопросами ходить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299385&amp;user=1556&amp;forum_n=6&amp;topic=19478&amp;page=1&amp;anchor=19" class="addthx" data-post="299385"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=2775" title="19-01-2012 06:31, ранг:342.2" target="_blank">Maximus</a>, <a href="action=userinfo&user=21477" title="19-01-2012 06:45, ранг:5.0" target="_blank">[-alex-]</a>, <a href="action=userinfo&user=24946" title="19-01-2012 07:01, ранг:19.5" target="_blank">DimitarSerg</a>, <a href="action=userinfo&user=18316" title="19-01-2012 07:12, ранг:78.7" target="_blank">SReg</a>, <a href="action=userinfo&user=4554" title="19-01-2012 07:47, ранг:174.7" target="_blank">HandMill</a>, <a href="action=userinfo&user=21589" title="19-01-2012 08:44, ранг:105.6" target="_blank">_ruzmaz_</a>, <a href="action=userinfo&user=22828" title="19-01-2012 09:08, ранг:46.2" target="_blank">Dart Sergius</a>, <a href="action=userinfo&user=21572" title="19-01-2012 09:17, ранг:34.1" target="_blank">hlmadip</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=19478&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=19478&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Многослойное динамическое шифрование (пример полиморфного кода на C/C++)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19478" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
