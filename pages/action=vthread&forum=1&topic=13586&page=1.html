<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Вопросы по написанию универсального распаковщика - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Привет всем! Форум читаю достаточно давно, узнал много нового, но сейчас возникли вопросы, на которые я не смог ответить самостоятельно, поэтому прошу помощи. Сначала краткая предыстория. Крякингом я занимаюсь меньше полугода,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вопросы по написанию универсального распаковщика</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=1&amp;topic=13586&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=1&amp;topic=13586&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=1&amp;topic=13586&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=1&amp;topic=13586&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Wolfram[/b]','')">Wolfram</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.48'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19474">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 января 2009 11:21 &middot; Поправил: Wolfram <br><script type="text/javascript">QU('Wolfram','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wolfram" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Привет всем! Форум читаю достаточно давно, узнал много нового, но сейчас возникли вопросы, на которые я не смог ответить самостоятельно, поэтому прошу помощи.<br><br>Сначала краткая предыстория. Крякингом я занимаюсь меньше полугода, научился за это время ломать сильно тупые защиты, где разработчик понадеялся на упаковщик/протектор. Автоматическим распаковщиком (или на &quot;полуавтомате&quot; - break&#039;n&#039;enter - EP - bpm esp-4 - OEP - dump - ImpRec) снимаем защиту, патчим пару байт - и готово. Но это, понятно, проходит далеко не всегда. Тупая защита + не самый простой пакер = приехали <img src="img/smilies/s9.gif" alt=""><br>И где-то месяца 2 назад я начал писать собственный универсальный распаковщик. Принцип действия у него задумывается такой:<br>- создаём замороженный поток.<br>- в EP втыкаем хук (jmp eip, чтобы не трассировать стандартным методом через TF, что обычно палится защитой) отпускаем программу до EP, замораживаем (SuspendThread), снимаем хук.<br>- далее эмулируем работу подопытной программы на виртуальных регистрах, но на её реальной памяти (Read/WriteProcessMemory).<br>- при этом ловим программу при возникновении исключений на входе в обработчик и на выходе из него; на возврате из системных вызовов (KiFastSystemCallRet); вообще, полностью отслеживаем передачу управления. Для этого предусмотрено втыкание хука в любое нужное место.<br>- на всём пути выполнения каким-либо образом запоминаем порядок передачи управления и адреса участков памяти, которые были изменены в адресном пространстве подопытной программы.<br>- когда доходим до OEP (определим, например, на основе статистики по нескольким файлам, покарёженных одним и тем же пакером), дампим всё, что было изменено.<br>- восстанавливаем импорт (пока с этим вопросом подробно не разбирался)<br>- делаем ещё какие-нибудь дополнительные приседания<br>- получаем рабочий дамп, который можно изучать в дизассемблере <img src="img/smilies/s1.gif" alt=""><br><br>Понятно, что, например, для Armadillo дополнительных приседаний будет очень много, но ASProtect вполне мог бы поддаться на такую провокацию.<br>С него я и решил начать. Запаковал виндовский блокнот с помощью ASProtect2.1, научился проходить на EP и стал &quot;обучать&quot; свой распаковщик ассемблерным инструкциям по одной. Проверка простая: если при встрече с незнакомой инструкцией актуализировать контекст и отпустить программу (ResumeThread), и она не грохнется, то с большой вероятностью все предыдущие инструкции выучены правильно.<br><br>&lt;отредактировано Wolfram&gt;<br>(Перенёс первый вопрос в свой второй пост, чтобы он не повторялся на каждой странице)<br><br>Заранее спасибо за ответы. Прошу модераторов не закрывать данную тему, когда они будут получены, потому что распаковщик пишется, и новые вопросы непременно будут возникать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=217964&amp;user=19474&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=1" class="addthx" data-post="217964"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2009 06:00 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
<b>Gideon Vi</b><br>Обучалась вобщем так: Уних в базе были забиты пакеры-проты и когда что то попадалось новое эта прога анализировала действия крякера в отладчеке и добавляла в свою базу новый способ распаковки.<br>И если напремер прот вел себя не совсем стандартно но есть на него сигнатура и способ взлома она могла додумать как поступить в том или ином случае.<br>Например как в аспре исключительные ситуации или импорт,прога такое запросто фиксила сама.<br><br>Вобщем теми людми кто это писал был проделан адский труд.<br><br>Приятно было посмотреть на такого монстра в действии.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218160&amp;user=6&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=2" class="addthx" data-post="218160"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2009 06:23 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
в том-то и дело, что не просто адский. тем страннее, что нигде не всплывало.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218161&amp;user=2585&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=3" class="addthx" data-post="218161"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2009 07:27 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
<b>F_a_u_s_t</b><br>Чушь какая-то. Кто же с тобой поделился такой исчерпывающей инфой, я бы ему медаль дал!<img src="img/smilies/s6.gif" alt=""><br><I>Gideon Vi пишет:<br>нигде не всплывало </I><br>Даже если такое чудо и есть (в чём я очень сильно сомневаюсь)<img src="img/smilies/s13.gif" alt=""> оно не всплывёт никогда, по крайней мере для обычных смертных. Ну типа только private version.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218162&amp;user=16624&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=4" class="addthx" data-post="218162"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2009 07:57 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<b>MasterSoft</b>, есть такая штука, как тщеславие. Пока что ничего круче темного анпакера не выплывало.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218163&amp;user=2585&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=5" class="addthx" data-post="218163"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2009 09:11 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
<I>F_a_u_s_t пишет:<br>Уних в базе были забиты пакеры-проты и когда что то попадалось новое эта прога анализировала действия крякера в отладчеке и добавляла в свою базу новый способ распаковки. </I><br>Это типа фантазии на тему любимого китайцами олимашин <img src="img/smilies/s1.gif" alt="">)<I>Gideon Vi пишет:<br>Пока что ничего круче темного анпакера не выплывало. </I><br>Такая же байка
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218166&amp;user=293&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=6" class="addthx" data-post="218166"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Wolfram[/b]','')">Wolfram</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.48'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19474">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2009 10:47 <br><script type="text/javascript">QU('Wolfram','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wolfram" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>А это как вообще может быть? Эмулируешь команды, а ругается винда??? Как при эмуляции прога может упасть??? Может возникнуть эксепшн в эмуляторе, но прога то при чем, это же не процесс а образ в эмуляторе.<br>ИМХО понос мыслей.  </I><br><br>Нет, это именно процесс, который запускается и тормозится на  EP. Может быть, следовало написать &quot;трассировка&quot; вместо &quot;эмуляция&quot; (мне кажется, что здесь и то, и другое), но принцип такой: анпакер работает на виртуальных регистрах (переменные в адресном пространстве анпакера) и на памяти программы (в её адресном пространстве). Через ReadProcessMemory читаем очередную инструкцию, если нужно, читаем некоторую область памяти программы (ReadProcessMemory), изменяем значения переменных, соответствующих регистрам, изменяем некоторую область памяти программы (WriteProcessMemory). При встрече с неописанной пока инструкцией делаем SetThreadContext и ResumeThread. И если перед этим мы что-то не то сделали в адресном пространстве проги, или установили не тот контекст, то она упадёт! Поскольку падает не на первой инструкции, то, думаю, такой метод имеет право на существование.<br><br><I>Archer пишет:<br>Глядя на концепт-сразу скажу про потенциальные косяки и ограничения:<br>-патчить код на оеп не всегда хорошо, ТЛС коллбек может пропалить это;<br>-полная эмуляция кода распаковщика штука адская, учитывая трюки антэмуляции и тд, писать будешь до пенсии;<br>-если дампить всё, что изменено, дамп будет под 100М, ибо там будет стек, куча, возможно, патч системных либ и фиг знает, что ещё;<br>-если за основу ОЕП брать статистику по пакеру, это не generic unpacker, а multi unpacker, другими словами, неизвестное не возьмёт;<br>-не совсем ясно, как ставится хук, если за основу взят DebugApi-это зло;<br>-некоторые концептуальные вещи могут быть не охвачены, типа многопоточности: иногда расшифровкой кода занимается 1 поток, он запускает поток 2, который и идёт на оеп, а 1 дохнет, как это будет обработано-хз.  </I><br>Я не ставлю цель, чтобы брал всё и сразу. Про TLS и многопоточность знаю, но не все же пакеры их используют. Обработку всех этих фишек буду прикручивать потом, а пока считаем, что их нет.<br>Хук в моём анпакере - это 2 байта 0xebfe (jmp eip). Если нужно, чтобы какой-то кусок кода исполнила сама программа, то сразу после него втыкается такой хук, а затем ждём, когда управление дойдёт до него, а дальше, очевидно, не пройдёт. Теперь останавливаем поток и возвращаем оригинальные байты на место. Этот метод я уже проверил, пока работает без косяков.<br>Если не сложно, расскажи, пожалуйста, про трюки антиэмуляции, которые могут испортить жизнь при _таком_ подходе (кроме многопоточности).<br><br>Собственно, к вопросу про mov. SetThreadContext  работает, но как-то странно. Устанавливается только eip, остальные регистры остаются без изменений. Кто-нибудь может объяснить, почему так происходит, и что с этим делать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218170&amp;user=19474&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=7" class="addthx" data-post="218170"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2009 11:33 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
Трюков антиэмуляции может быть много, начиная с того, что цикл какой-нить с парой инструкций выполняется много раз, на чём эмуль задумается надолго, и заканчивая вызовом разных апишек (а ты их не эмулишь, как я понял) и дальше управление может быть передано (может, апи хитрая, может, код подправлен) в произвольное место, а не сразу после её вызова, тогда контроль потеряешь. Обращения к невалидной памяти тоже хз, как эмулить будешь, надо исключение кидать, а чтоб не потерять управление разглядывать СЕХИ/ВЕХИ/UnhandledExeceptionFilter. Это из основного, что сходу в голову пришло.<br>С SetThreadContext, имхо, после ЕП не может он работать странно в 1 потоке. Сам забыл выставить регистры в контексте, флаги контекста, проверяешь неправильно или что ещё.<br><br>Не совсем понятно, как анпакер может обучаться. В теории оно звучит хорошо, конечно, а в реальности хз. Видео даёшь ему посмотреть, что ли, а он втыкает и учится...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218173&amp;user=1556&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=8" class="addthx" data-post="218173"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]AlexZ[/b]','')">AlexZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 203.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.22<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=175">Участник</a><br><font color=blue>UPX Killer -d</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2009 12:38 &middot; Поправил: AlexZ <br><script type="text/javascript">QU('AlexZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexZ" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<I>Flashback/TMX пишет:<br>на каком-то сайте видел тутор для написания дескремблера UPX </I><br><br>Может это мой тутор? <img src="img/smilies/s5.gif" alt=""><br>www.azsoft.nm.ru/art/n0.htm<br><br>ps. Прога и полностью на прологе... Жесть.
<br><br><font size="1"><i>-----<br>Я медленно снимаю с неё UPX... *FF_User*</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=218181&amp;user=175&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=9" class="addthx" data-post="218181"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ASMax[/b]','')">ASMax</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 62.9 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.06'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2032">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2009 14:12 <br><script type="text/javascript">QU('ASMax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ASMax" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
<I>F_a_u_s_t пишет:<br>Просто знаю одни черти писале на прологе софтину-анпакер с AI самое интересное что оно реально работало причем еще и самообучалось. </I><br>Skynet? <img src="img/smilies/s5.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218197&amp;user=2032&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=10" class="addthx" data-post="218197"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2009 15:35 &middot; Поправил: mak <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
<b>F_a_u_s_t</b> Прав что есть такой анпакер. Всплывать он и не будет , люди которые его делали занимаются наукой и делом. На вопрос бываете ли вы на форумах по системам защиты, ответ был таков - нет не бываем , мы учим будущие поколения , все самые новые технологии рождаются у нас. <br><br>У меня есть повод , ну оч большой доверять им по самое нехочу. <br><br><b>ASMax</b> в шутку называют так сами разработчики , есть 2 варианта реализации. Первый это был не столь интересный , в основном методы математические по ИИ. А вот потом был бум , был создан организм , как его назвать фиг знает , он как бы и техниа и живой , он может думать как человек и в тоже время является кибермашиной. В основу мозга положена находка биологов. Которые нашли жизнь схожую с нашей, но которая перестала развиваться по каким то причинам. Это особый кристаллический состав , точнее это квазикристалический состав. Его мощность мыслительсная состоит просто из невероятной вычислетельной силой и скорости обучения. <br><br>А вообще второму виду мало уделяют внимания , имеется ввиду по анпкам, потому что с такой машиной появились другие задачи.<br><br><b>Archer</b> скоро увидишь =) уже вон сколько людей над этим работают
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=218207&amp;user=3520&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=11" class="addthx" data-post="218207"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2009 16:30 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
Вот уж точно, сон разума рождает чудовишь <img src="img/smilies/s1.gif" alt="">)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218214&amp;user=293&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=12" class="addthx" data-post="218214"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2009 16:37 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
Ребенки, сочинять - это тоже уметь надо. Идея отладки такого рода систем на апаке смешна и нелепа, попытка выебнуться на таких утках глупа и убога.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218217&amp;user=2585&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=13" class="addthx" data-post="218217"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2009 18:25 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
Я понял, мы все умрём, боты нас поработят. Не то, чтобы я совсем не верил в движение прогресса и революционные открытия, но как-то сомнительно, что они придут ко мне, чтоб анпачить мне упх.<br>Предвижу тут адский оффтоп, поэтому сразу говорю, давайте с этим понемногу завязывать и ближе к теме держаться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218239&amp;user=1556&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=14" class="addthx" data-post="218239"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]AlexZ[/b]','')">AlexZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 203.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.22<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=175">Участник</a><br><font color=blue>UPX Killer -d</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2009 18:27 <br><script type="text/javascript">QU('AlexZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexZ" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
<I>mak пишет:<br>был создан организм , как его назвать фиг знает , он как бы и техниа и живой , он может думать как человек и в тоже время является кибермашиной. В основу мозга положена находка биологов. Которые нашли жизнь схожую с нашей, но которая перестала развиваться по каким то причинам. Это особый кристаллический состав , точнее это квазикристалический состав. Его мощность мыслительсная состоит просто из невероятной вычислетельной силой и скорости обучения.  </I><br><br>Ссылками на материалы по теме не угостишь?<br>Можно даже на мед.ресурсы, так даже лучше.
<br><br><font size="1"><i>-----<br>Я медленно снимаю с неё UPX... *FF_User*</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=218240&amp;user=175&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=15" class="addthx" data-post="218240"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2009 02:17 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
to all:<br>Ну конечно все это чушь,просто решил проверить теорию спекза что флудерры номер 1 как раз старички а не нубики.<img src="img/smilies/s6.gif" alt=""><br>Извините меня не удержался.<br><b>mak</b><br>Я тоже где то читал подобное ну как сказал <b>Gideon Vi</b> <u>Идея отладки такого рода систем на апаке смешна и нелепа...</u> другое дело научные иследования.<br><b>Archer</b><br>Обещаю больше не ставить таких флудерских экспериментов.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218296&amp;user=6&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=16" class="addthx" data-post="218296"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2009 02:25 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
Втему:<br>Не у кого не завалялся сорец анпакера (любого,[упыха) на делфи.<br><br>Ps. и помните я извинился!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218299&amp;user=6&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=17" class="addthx" data-post="218299"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2009 02:30 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
<b>F_a_u_s_t</b><br>Вот: ap0x.jezgra.net/SDK.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218300&amp;user=16624&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=18" class="addthx" data-post="218300"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 января 2009 10:42 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
Поскипал справедливый гнев толпы, хотя саму провокацию оставил для потомков. Больше так лучше не делать, а то плохо кончится.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218326&amp;user=1556&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=19" class="addthx" data-post="218326"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Flashback/TMX[/b]','')">Flashback/TMX</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.12'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=16851">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 января 2009 15:33 <br><script type="text/javascript">QU('Flashback/TMX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flashback/TMX" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
<I>AlexZ пишет:<br>Может это мой тутор?  </I><br>Да, я про него, но адресс не помнил<br><br><I>pavka пишет:<br>Это типа фантазии на тему любимого китайцами олимашин </I><br>Это недоделанный ОллиСкрипт?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=218469&amp;user=16851&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=20" class="addthx" data-post="218469"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Wolfram[/b]','')">Wolfram</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.48'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19474">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 января 2009 15:41 <br><script type="text/javascript">QU('Wolfram','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wolfram" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
Это снова я со своим распаковщиком.<br>Проблему с неустанавливающимся контекстом я решил, правда, через <img src="img/smilies/s16.gif" alt="">, так что не кидайте помидорами. Вписываем на eip такое:<br>mov eax, ...<br>mov ecx, ...<br>..................<br>push ...<br>popf<br>jmp eip<br>отпускаем прогу, замораживаем на jmp, возвращаем всё на место.<br>Невероятно, но это работает! Нормальное решение пытался найти, но SetThreadContext не хочет устанавливать ничего, кроме eip, хоть ты тресни.<br><br>Рапаковщик уже знает около 200 инструкций. Т.е. берём прогу, запакованную чем-то, он доходит до первой неизвестной инструкции, сообщает об этом и отпускает прогу, и она после этого не грохается.<br><br>В ASProtect выученных инструкций уже хватает, чтобы дойти до первого вызова VirtualAlloc и пройти её код до системного вызова sysenter (0x0f34). Обратно в ring3 управление вернётся на KiFastSystemCallRet. У меня на XP SP2 она находится по адресу 0x7c90eb94. Теперь можно отпустить прогу, а потом поймать, или использовать VirtualAllocEx, чтобы эмулировать вызов. Второй вариант мне нравится больше, правда, тогда придётся и другие вызовы эмулировать, но мы же не ищем лёгких путей! <img src="img/smilies/s1.gif" alt=""><br><br>Отсюда вопрос: положение KiFastSystemCallRet зависит только от версии ОС, или от чего-то ещё?<br>И ещё один вопрос: можно ли без написания ring0 драйвера (я этого пока не умею) прочитать дескрипторы сегментов, зная их селекторы? Может, где-нибудь в нижней половине памяти лежит копия GDT, или ещё как-то? Хочется знать базовые адреса и размеры сегментов.<br>И может ли ring3 протектор каким-либо образом изменить GDT (вряд ли, конечно, но вдруг), или создать LDT?<br><br>Заранее спасибо за ответы. Не бейте сильно, если опять с терминами напутал <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=219436&amp;user=19474&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=21" class="addthx" data-post="219436"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 января 2009 16:44 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
Контекст жёсткий, лучше бы поотлаживал и разобрался.<br>Положение KiFastSystemCallRet хардкодить нельзя, много, от чего зависит, от СП и патчей вполне может. Может и от архитектуры, ибо при инсталле на разные архитектуры немного разные либы ставятся.<br>С селекторами юзай GetThreadSelectorEntry, если вопрос правильно понял, погугли статью на эту тему, можно добавлять свои записи в табличку.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=219439&amp;user=1556&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=22" class="addthx" data-post="219439"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Wolfram[/b]','')">Wolfram</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.48'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19474">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 января 2009 06:38 <br><script type="text/javascript">QU('Wolfram','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wolfram" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
Спасибо огромное за GetThreadSelectorEntry, это как раз то, что мне нужно.<br>На тему KiFastSystemCallRet до меня наконец-то дошло. Адрес её загрузки можно посмотреть в таблице экспорта ntdll.dll. Только хочу спросить: всегда ли адрес, полученный таком образом, будет валидным? И может ли протектор сделать так, чтобы в ntdll.dll был один адрес, а на деле - другой?<br><br>А на тему жёсткого контекста - полностью согласен, но я убил на эту проблему целый день, да так и не понял, в чём дело. Когда осознАю - сделаю по-нормальному. Просто решил не топтаться на месте слишком долго.<br>Кстати, по этой же причине пока реализовал эмуляцию системных вызовов через исполнение, с ловлей на KiFastSystemCallRet.<br>Думаю, что после появления первой версии анпакера, вскоре начнут появляться и следующие, с исправлением этих &quot;заплаток&quot;.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=219510&amp;user=19474&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=23" class="addthx" data-post="219510"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]SVIN95[/b]','')">SVIN95</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 39.0 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.72'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18599">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 января 2009 19:07 <br><script type="text/javascript">QU('SVIN95','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVIN95" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#24');return false;">#24</a> </span><div align=left><br>
<b>Wolfram</b><br>Советую начать с написания анпакера для RCryptor (он СОВСЕМ не шифрует таблицу импорта - достаточно сдампить на OEP). Позже для PKLITE32 (тоже импорт целый, но до OEP труднее добраться). Сам вот только что написал rcryptor unpacker)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=219566&amp;user=18599&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=24" class="addthx" data-post="219566"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]SemDJ[/b]','')">SemDJ</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8110.jpg" alt=""><br><span class=txtSm>Ранг: 114.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.62'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8110">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 января 2009 19:37 &middot; Поправил: SemDJ <br><script type="text/javascript">QU('SemDJ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SemDJ" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#25');return false;">#25</a> </span><div align=left><br>
<I>SVIN95 пишет:<br>Советую начать с написания анпакера для RCryptor </I><br>Ну и нах анпакер RCryptor, PKLITE32??? Если <b>Wolfram</b> уже его тестит на ASProtect???<img src="img/smilies/s12.gif" alt="">
<br><br><font size="1"><i>-----<br>minimaL_patсh на руборде</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=219569&amp;user=8110&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=25" class="addthx" data-post="219569"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 января 2009 20:58 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#26');return false;">#26</a> </span><div align=left><br>
Если есть в экспорте-значит, валидный. Другой вопрос, для каждой ли винды он вынесен в экспорт-это раз и ответ-хз. Второе-в процессе могут его и подгадить, читать надо с файла на диске, ибо нтдлл не релоцируется, с релоками будет проще.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=219579&amp;user=1556&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=26" class="addthx" data-post="219579"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Wolfram[/b]','')">Wolfram</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.48'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19474">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 января 2009 13:54 <br><script type="text/javascript">QU('Wolfram','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wolfram" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#27');return false;">#27</a> </span><div align=left><br>
2 Archer:<br>Спасибо большое.<br><br>2 SVIN95 &amp; SemDJ:<br>Я его сейчас тестирую на нескольких пакерах сразу, по принципу: реализовал несколько инструкций - потестил на всех по очереди. Если ни на одном не упало - значит, наверное, всё правильно.<br><br>И, наконец, 2 all:<br>Мы добрались до OEP в UPX!!!!!!!!!!!!!!!!!!!<br>Ура!!!!!!!!!!!!!!!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=219644&amp;user=19474&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=27" class="addthx" data-post="219644"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 января 2009 20:11 <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#28');return false;">#28</a> </span><div align=left><br>
<b>Archer</b><br>Вопрос, близкий к теме. Можно ли Bounds импорт перетащить в обычный импорт безопасно?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=219714&amp;user=2449&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=28" class="addthx" data-post="219714"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 января 2009 22:25 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#29');return false;">#29</a> </span><div align=left><br>
Я просто обрезал баунд и совмещал с обычным. Пока косяков не было. По сути это 1 хрен, формат тот же, просто баунд побыстрее обрабатывается (точнее, вообще не обновляется, если таймстамп либы совпал).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=219729&amp;user=1556&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=29" class="addthx" data-post="219729"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Wolfram[/b]','')">Wolfram</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.48'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19474">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2009 12:34 <br><script type="text/javascript">QU('Wolfram','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wolfram" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#30');return false;">#30</a> </span><div align=left><br>
С контекстом я разобрался окончательно. Как и предполагалось, не хватало одной строчки:<br>lpContext-&gt;ContextFlags = CONTEXT_ALL;<br>Собственно, поэтому не все регистры и устанавливались.<br><br>Сейчас распаковщик уже доходит до OEP в UPX, ASPack, NSPack и ORiEN. Также стало известно, что PECompact, MEW, ASProtect и многие другие активно юзают математический сопроцессор. Ну, не беда, доку по нему я уже нарыл, буду раскуривать <img src="img/smilies/s1.gif" alt=""><br><br>Вопрос такой:<br>Системные вызовы я пока эмулирую через исполнение с ловлей на KiFastSystemCallRet, с этим пока, вроде, проблем нет. А при возникновении исключения просто передаю управление на KiUserExceptionDispatcher, а дальше работаю в обычном режиме, не заботясь, что лежит в FS:[0] и пр. Два первых исключения в ASProtect и одно в PECompact таким способом проходятся отлично (дальше начинается FPU). Может ли протектор заставить нас потерять управление при таком подходе?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=219985&amp;user=19474&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=30" class="addthx" data-post="219985"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2009 19:33 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=1#31');return false;">#31</a> </span><div align=left><br>
А я тебе сразу сказал, с контекстом поглядеть на флаги, что наверняка сам чо-нить забыл.<br><br>Если используется ринг0 драйвер с обработкой исключений, типа 3 стара, то просто передача на KiUserExceptionDispatcher пойдёт лесом ввиду неправильности. Самоотладка типа 2 процессов в арме аналогично. Возможно, есть ещё косяки. Проще дать выполниться 1 вызывающей исключение инструкции и пусть управление само пойдёт на KiUserExceptionDispatcher. Хотя в описанных выше случаях приложение заработает при этом, но управление ты потеряешь.<br>З.Ы. На этапе обкатки ещё обнаружишь, где не работает <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=220032&amp;user=1556&amp;forum_n=1&amp;topic=13586&amp;page=1&amp;anchor=31" class="addthx" data-post="220032"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=1&amp;topic=13586&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=1&amp;topic=13586&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=1&amp;topic=13586&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=1&amp;topic=13586&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вопросы по написанию универсального распаковщика</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="13586">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=13586" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
