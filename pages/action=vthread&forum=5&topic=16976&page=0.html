<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>требуется помощь в анализе проги с HW_ID - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="есть прога, специфична тем, что используется для загрузки прошивки в atmega контроллер (девайс с ним висит на usb-шнурке, соединенном с компом,и прога проверяет есть ли такая девайсина или нет,если нет, то так и пишет)...">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> требуется помощь в анализе проги с HW_ID</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ufolog[/b]','')">ufolog</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.67'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26876">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2010 23:35 <br><script type="text/javascript">QU('ufolog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ufolog" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16976.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
есть прога, специфична тем, что используется для загрузки прошивки в atmega контроллер (девайс с ним висит на usb-шнурке, соединенном с компом,и прога проверяет есть ли такая девайсина или нет,если нет, то так и пишет)...<br>упакована ASpack 2.12...Если все ок(девайсина с атмелом есть) то прога генерит что то типа HW_Id(собирает всякую инфу с компа) и выдает что то типа такого:<br>1976091F183C81FF<br>в нижней строке окна просит ввести ключ...<br>ключ должен быть из 16 символов, если короче вылетает окно(которое об этом и предупреждает) <img src="img/smilies/s1.gif" alt=""><br>если ключ из 16 символов,но не тот что прислал автор <img src="img/smilies/s1.gif" alt="">(после получения перевода),то окон никаких не вылазит,все возвращается назад,то есть к надписи ввести ключ...<br>итак что было сделано:<br>-распакована (помогла ASPDie) дальше все действия с этим exe-шником;<br>-прошелся поиском текста(есть и &quot;ключ ОК&quot;, &quot;Активировано успешно&quot;,&quot;ключ ОК,нажмите Х&quot;) пользовал W32Dasm от URsoft;<br>-в дампе по адресу 0015B938 лежит id (на данный момент такой 1976091F183C81FF, если поменяю boot в атмеге программатором станет другим, проверено <img src="img/smilies/s1.gif" alt="">)<br>-там же по адресам 0015BA28;0015BA38 лежит ещё одна интересная последовательность BC2BB57F066DE0DA (нет не ключ...проверял, не проходит <img src="img/smilies/s1.gif" alt="">)<br>-адрес 0015B9F8 - тот ключ который вводим в нижнюю строку окна <br>если поставить bp  на обращение чтения по этим адресам (либо там где лежит 1976091F183C81FF, либо там где лежит BC2BB57F066DE0DA,то можно выйти на какую то процедуру(сорри тут пошли затыки и догадки...) то по стеку видно как в в дамп укладывается<br>0015BA30 -&gt; BC2BB57F066DE0DA<br>009A3BF4 - &gt; 63870100797F639D (этой области не было в дампе, она есть только когда прога что то считает)<br>009A5C54 - &gt;18237B3C5519855F....<br>мне почему то подумалось в что то про криптование...<img src="img/smilies/s1.gif" alt=""><br>особенно когда увидел два этих числа <br>BC2BB57F066DE0DA<br>63870100797F639D прога их крутила ...чего то пыталась высчитать...сорри знаний маловато пока...<br>чего то подумал что это RSA <img src="img/smilies/s1.gif" alt=""><br>сунул из по очереди в RSATool2v110...<br>с ...BC2BB не в прямом , не в инверсном виде ничего путного не вышло ...(не факторизовалось, так кажется<img src="img/smilies/s1.gif" alt="">)<br>а вот второе, то что 63...в инверсном виде(9D637F7900018763) чудненько разложилось на <br>12C77(P) И 8618E2E7B375(Q)...<br>да все эти &quot;фигурки&quot; с числами прога виписывает тут (примерно<img src="img/smilies/s1.gif" alt="">)<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">7C9021F6</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8EE4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">FS</span><span class="hl_char">,</span><span class="hl_registr"><b>SP</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; Modification of segment register</span></li><li class="hl_l1"><span class="hl_number">7C9021F8</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">89448F</span>&nbsp;E4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">+</span><span class="hl_registr">ECX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">-</span><span class="hl_number">1C</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">7C9021FC</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B448E</span>&nbsp;E8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESI</span><span class="hl_char">+</span><span class="hl_registr">ECX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">-</span><span class="hl_number">18</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">7C902200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">89448F</span>&nbsp;E8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">+</span><span class="hl_registr">ECX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">-</span><span class="hl_number">18</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">7C902204</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B448E</span>&nbsp;EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESI</span><span class="hl_char">+</span><span class="hl_registr">ECX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">-</span><span class="hl_number">14</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">7C902208</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">89448F</span>&nbsp;EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">+</span><span class="hl_registr">ECX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">-</span><span class="hl_number">14</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">7C90220C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B448E</span>&nbsp;F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESI</span><span class="hl_char">+</span><span class="hl_registr">ECX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">-</span><span class="hl_number">10</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">7C902210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">89448F</span>&nbsp;F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">+</span><span class="hl_registr">ECX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">-</span><span class="hl_number">10</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">7C902214</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B448E</span>&nbsp;F4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESI</span><span class="hl_char">+</span><span class="hl_registr">ECX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">-</span>C<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">7C902218</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">89448F</span>&nbsp;F4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">+</span><span class="hl_registr">ECX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">-</span>C<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">7C90221C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B448E</span>&nbsp;F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESI</span><span class="hl_char">+</span><span class="hl_registr">ECX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">-</span><span class="hl_number">8</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">7C902220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">89448F</span>&nbsp;F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">+</span><span class="hl_registr">ECX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">-</span><span class="hl_number">8</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">7C902224</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B448E</span>&nbsp;FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESI</span><span class="hl_char">+</span><span class="hl_registr">ECX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">-</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">7C902228</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">89448F</span>&nbsp;FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">+</span><span class="hl_registr">ECX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">-</span><span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">7C90222C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D048D</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ECX</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br>саму прогу положил сюда (в оригинале, не распакованную, изменено только название ехе-шника, если надо укажу откуда взял):<br>hxxp://www.multiupload.com/2TERDNEGZM<br>может быть у кого-то более опытного найдется время, что бы глянуть и направить куда надо рыть <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=269776&amp;user=26876&amp;forum_n=5&amp;topic=16976.html&amp;page=0&amp;anchor=1" class="addthx" data-post="269776"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2010 12:31 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16976.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>7C9021F6</b><br>адрес не смущает?<br><br>вряд ли защита внутри ntdll ;)
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=269802&amp;user=1379&amp;forum_n=5&amp;topic=16976.html&amp;page=0&amp;anchor=2" class="addthx" data-post="269802"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ufolog[/b]','')">ufolog</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.67'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26876">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 ноября 2010 22:37 <br><script type="text/javascript">QU('ufolog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ufolog" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16976.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
да,что то я сглупил...с шифрованием <img src="img/smilies/s1.gif" alt=""><br>&quot;молодой,глупый...&quot;<br>во общем бьюсь об эту прогу уже который день ...<br>плюнул на серийник( не дорос я наверное до этого), попробовал заменой je на nop и jmp <img src="img/smilies/s1.gif" alt=""><br>да результат есть ,то есть если тут <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00402CCC</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">84C9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">CL</span><span class="hl_char">,</span><span class="hl_registr">CL</span></li><li class="hl_l1"><span class="hl_number">00402CCE</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0F84</span>&nbsp;<span class="hl_number">12020000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_number">00402EE6</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; &lt;- меняем на JNE или NOP</span></li><li class="hl_l0"><span class="hl_number">00402CD4</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">66</span><span class="hl_char">:</span>C745&nbsp;A4&nbsp;B000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">5C</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0B0</span></li><li class="hl_l1"><span class="hl_number">00402CDA</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">33C0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">00402CDC</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8945</span>&nbsp;C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">16</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00402CDF</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8D55</span>&nbsp;C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">16</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00402CE2</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;FF45&nbsp;B0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>INC</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">20</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00402CE5</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B4D</span>&nbsp;<span class="hl_number">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">28</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00402CE8</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B81</span>&nbsp;<span class="hl_number">10030000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ECX</span><span class="hl_char">+</span><span class="hl_number">310</span><span class="hl_char">]</span></li><li class="hl_l1">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br> то прога допрыгает до надписи &quot;ключ ОК,нажмите Х&quot;...<br>прежде чем этот Х нажать делаем тут <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00402A0E</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">84C9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">CL</span><span class="hl_char">,</span><span class="hl_registr">CL</span></li><li class="hl_l1"><span class="hl_number">00402A10</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0F84</span>&nbsp;AE000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_number">00402AC4</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;  &lt;- NOP сюда вместо перехода</span></li><li class="hl_l0"><span class="hl_number">00402A16</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">66</span><span class="hl_char">:</span>C745&nbsp;A4&nbsp;<span class="hl_number">6800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">5C</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">68</span></li><li class="hl_l1"><span class="hl_number">00402A1C</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;BA&nbsp;<span class="hl_number">30F64700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_number">47F630</span></li><li class="hl_l0"><span class="hl_number">00402A21</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8D45</span>&nbsp;DC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">9</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br>теперь жму &quot;Х&quot; ...получаю &quot;ключ ОК&quot; в строке проги и выскакивает окно &quot;активировано успешно&quot;...<br>только вот прошить не получиться <img src="img/smilies/s9.gif" alt="">,так как нужно ещё тут<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004022F7</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">84C9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">CL</span><span class="hl_char">,</span><span class="hl_registr">CL</span></li><li class="hl_l1"><span class="hl_number">004022F9</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">74</span>&nbsp;<span class="hl_number">48</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">00402343</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;  JMP сюда вместо JE</span></li><li class="hl_l0"><span class="hl_number">004022FB</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B45</span>&nbsp;A0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">24</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">004022FE</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B80</span>&nbsp;F4020000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">+</span><span class="hl_number">2F4</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00402304</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">33D2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_registr">EDX</span></li><li class="hl_l1"><span class="hl_number">00402306</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B08</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">]</span></li><li class="hl_l0">&nbsp;</li>        </ol>
    </div>
</div></div>
 <br>теперь все ок ...кнопа &quot;прошить&quot; активна,жмем выбираем что будем передавать в атмел через USB...<img src="img/smilies/s1.gif" alt=""><br>Прошивать то прошивает, да только при этом меняется ИД, (что совсем не надо<img src="img/smilies/s9.gif" alt="">) и в атмел попадает какой то мусор вместо прошивки, так девайсина с атмелом не работает как должна <img src="img/smilies/s9.gif" alt=""><br>То есть одними поправками переходов не обойтись...надо что бы в атмел попало то, что надо (не докопал ещё что же надо)..<br>Предположения такие: раз прошивка атмела типа зашифрована, то в прогу на компе попадает валидный ключ, прога активирует (засылает по usb в атмел то же какой то ключ, загрузчик в атмеле используя этот ключ расладывает(расшифровывает) принятое с компа куда надо по полочкам...Тогда все в шоколаде...<br>Вообщем круг замкнулся опять вернулись к тому с чего начали ...нужен ключ <img src="img/smilies/s9.gif" alt=""><br>И на фига такие заморочки в проге, где ключ стоит 35у.е. ...<br>Вообщем все плохо...<img src="img/smilies/s9.gif" alt=""><br>Может, где чего почитать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=270457&amp;user=26876&amp;forum_n=5&amp;topic=16976.html&amp;page=0&amp;anchor=3" class="addthx" data-post="270457"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> требуется помощь в анализе проги с HW_ID</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=16976" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
