<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Взлом жирной программы на Delphi. Нужна помощь - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Пожалста, помогите взломать программу на Delphi, я совсем запутался в его коде. Саму программу можно скачать здесь: link_deleted_by_forum_engine/files/7067496 Довольно большая. Архив весит ~1,5 МБ Программа показывает">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Взлом жирной программы на Delphi. Нужна помощь</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]GreatDeal[/b]','')">GreatDeal</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.96'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=17543">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2008 21:21 <br><script type="text/javascript">QU('GreatDeal','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GreatDeal" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12498.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Пожалста, помогите взломать программу на Delphi, я совсем запутался в его коде.<br>Саму программу можно скачать здесь: link_deleted_by_forum_engine/files/7067496  Довольно большая. Архив весит ~1,5 МБ<br><br>Программа показывает регистрационный номер (1048-576-000) и просит ввести пароль. После ввода и нажатия кнопки ОК, окно скрывается, и в случае верного ввода, программа запускается. В случае неверного она просто терминируется.<br>Вот что я пытался сделать:<br>Включена проверка наличия отладчика:<br>...<br>5B26A0BC   FF15 C011265B    CALL DWORD PTR DS:[5B2611C0]             ; kernel32.IsDebuggerPresent<br>5B26A0C2   85C0             TEST EAX,EAX<br>5B26A0C4   0F85 397F0100    JNZ 5B282003<br>...<br>пропатчив один байт (85C0 - TEST EAX,EAX) в (33C0 - XOR EAX,EAX) можно продолжить.<br>Запускается окно запроса логина/пароля TREG_F, в котором оконная процедура находится по адресу:<br>00 47 75 79<br>...<br>00 47 75 B9<br><br>Так как не умею в OllyDbg ставить брейпоинты на сообщения windows, а DeDe после почти получасовой декомпиляции не показал модуля TREG_F, я не нашел обработчика нажатия на кнопку ОК. Но после нажатия на эту кнопку цикл оконной процедуры прерывается и переходит на то место, где он обычно не был (в теле оконной процедуры):<br>004775A9  |. E8 36FDFFFF    |CALL Kadrs.004772E4<br>Но похоже, что именно здесь и начинается верификация, т.к. в коде много работы с байтами, операторы, неиспользуемые в обычном коде. Но вот только сам заветный джамп я так и не нашел <img src="img/smilies/s13.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=198422&amp;user=17543&amp;forum_n=5&amp;topic=12498.html&amp;page=0&amp;anchor=1" class="addthx" data-post="198422"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]4kusNick[/b]','')">4kusNick</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1931.jpg" alt=""><br><span class=txtSm>Ранг: 748.2 <font color=magenta>(<b>! !</b>)</font>, 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.1'>Активность: 0.37<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1931">Участник</a><br><font color=blue>bytecode!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2008 21:47 <br><script type="text/javascript">QU('4kusNick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=4kusNick" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12498.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>GreatDeal</b><br>Перелей на filefactory какой-нить, а то у меня с депозитом и рапидой траблы.
<br><br><font size="1"><i>-----<br>Флэш, ява, дотнет - на завтрак, обед и ужин. Unity3D на закуску.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=198423&amp;user=1931&amp;forum_n=5&amp;topic=12498.html&amp;page=0&amp;anchor=2" class="addthx" data-post="198423"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]GreatDeal[/b]','')">GreatDeal</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.96'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=17543">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2008 22:17 &middot; Поправил: GreatDeal <br><script type="text/javascript">QU('GreatDeal','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GreatDeal" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12498.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Тот-же архив на FileFactory:<br>www.filefactory.com/file/64dd31/n/Kadrs_rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=198426&amp;user=17543&amp;forum_n=5&amp;topic=12498.html&amp;page=0&amp;anchor=3" class="addthx" data-post="198426"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2008 22:43 &middot; Поправил: Flint <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12498.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
т.к всех необходимых файлов нету программа не может корректно запустится<br>ставь бряк (F2) тут:<br><br>007C205E  |.  48            DEC EAX <br><br>вводи код и жамкай на кнопку<br>_________________________________________<br>а еще глянь здесь<br><br>007C1F61  |.  8B55 F0       MOV EDX,DWORD PTR SS:[EBP-10]<br>007C1F88  |.  8B55 E8       MOV EDX,DWORD PTR SS:[EBP-18]<br><br>в edx, насколько я понял заносятся адреса правильных паролей (их может быть 2)
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=198428&amp;user=2981&amp;forum_n=5&amp;topic=12498.html&amp;page=0&amp;anchor=4" class="addthx" data-post="198428"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2008 22:57 &middot; Поправил: tihiy_grom <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12498.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>GreatDeal пишет:<br>а DeDe после почти получасовой декомпиляции не показал модуля TREG_F </I><br>Зверско <img src="img/smilies/s1.gif" alt=""> получасовая декомпиляция. У меня на AM2 5200 ГГц всё заняло около 5-6 минут.<br><br><b>Flint</b><br>Хоть их и два, но при их вводе прога вываливается с ошибкой - и это не из-за отсутствия файлов<br><br><b>GreatDeal</b><br>В общем твой переход вот тут<br>007C1EBA  |. /0F83 17030000 JNB Kadrs.007C21D7
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=198429&amp;user=10534&amp;forum_n=5&amp;topic=12498.html&amp;page=0&amp;anchor=5" class="addthx" data-post="198429"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]depler[/b]','')">depler</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/12579.gif" alt=""><br><span class=txtSm>Ранг: 247.7 (наставник), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.95'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12579">Участник</a><br><font color=blue>Халявщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 августа 2008 00:05 &middot; Поправил: depler <br><script type="text/javascript">QU('depler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=depler" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12498.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
tihiy_grom<br>Не похож он на заветный переход, у меня прога падает. Хотя пишет что библиотек нет и чето еще. Мож точно файлов не хватает?
<br><br><font size="1"><i>-----<br>Лень - это подсознательная мудрость</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=198438&amp;user=12579&amp;forum_n=5&amp;topic=12498.html&amp;page=0&amp;anchor=6" class="addthx" data-post="198438"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 августа 2008 00:18 &middot; Поправил: tihiy_grom <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12498.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>Depler</b><br>А у меня всё ок с запуском, только пишет что база не обнаружена<br><br><img src="http://img120.imageshack.us/img120/433/123fy9.jpg" border="0" align="" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=198445&amp;user=10534&amp;forum_n=5&amp;topic=12498.html&amp;page=0&amp;anchor=7" class="addthx" data-post="198445"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]4kusNick[/b]','')">4kusNick</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1931.jpg" alt=""><br><span class=txtSm>Ранг: 748.2 <font color=magenta>(<b>! !</b>)</font>, 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.1'>Активность: 0.37<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1931">Участник</a><br><font color=blue>bytecode!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 августа 2008 01:13 &middot; Поправил: 4kusNick <br><script type="text/javascript">QU('4kusNick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=4kusNick" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12498.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Опоздал блин <img src="img/smilies/s4.gif" alt="">
<br><br><font size="1"><i>-----<br>Флэш, ява, дотнет - на завтрак, обед и ужин. Unity3D на закуску.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=198449&amp;user=1931&amp;forum_n=5&amp;topic=12498.html&amp;page=0&amp;anchor=8" class="addthx" data-post="198449"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]GreatDeal[/b]','')">GreatDeal</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.96'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=17543">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 августа 2008 09:51 &middot; Поправил: GreatDeal <br><script type="text/javascript">QU('GreatDeal','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GreatDeal" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12498.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
2 <b>Flint</b>:<br>Я в шоке <img src="img/smilies/s15.gif" alt="">. А можно поинтересоваться, как ты нашел (да еще и так быстро) этот код? Я пол-дня ковырялся. И мне очень стыдно - я видел в стеке эти строки, но почему-то они мне не показались похожими на серийник <img src="img/smilies/s14.gif" alt=""><br><br>2 <b>tihiy_grom</b>:<br>У меня Celeron 1.8GHz, 1.50MB ОЗУ. На своем AMD Athlon 900GHz+384ОЗУ я бы еще дольше ждал <img src="img/smilies/s1.gif" alt=""><br>По найденым кодам Fint&#039;а - при наличии бибилиотек (программа действительно работает с подключаемыми библиотеками Firebird SQL Server) программа успешно регистрируется и заносит регистрационную информацию в базу. Вообщем, работает на ура.<br><br>А вот при изменении на JMP<br>[007C1EBA |. /0F83 17030000 JNB Kadrs.007C21D7]<br>окно программы загружается, минуя регистрацию, но сразу-же возникает исключительная ситуация:<br><b>Exception E06D7363</b><br>Сообщение: <b>Access violation when writing to [00000004]</b><br><img src="img/smilies/s11.gif" alt="">Не уверен, что это за переход, но он не выполняется даже когда программа уже зарегистрирована.<br><br>Проверка регистрационного кода здесь:<br>00404F5D  |&gt; 8B0E           /MOV ECX,DWORD PTR DS:[ESI]   ; введеный пользователем код<br>00404F5F  |. 8B1F           |MOV EBX,DWORD PTR DS:[EDI]     ; чему он должен соответствовать<br>00404F61  |. 39D9           |CMP ECX,EBX<br>00404F63  |. 75 58          |JNZ SHORT Kadrs.00404FBD	         ; занопить<br>...<br>00404F89  |. 8B0E           MOV ECX,DWORD PTR DS:[ESI]<br>00404F8B  |. 8B1F           MOV EBX,DWORD PTR DS:[EDI]<br>00404F8D  |. 38D9           CMP CL,BL<br>00404F8F  |. 75 41          JNZ SHORT Kadrs.00404FD2	        ; занопить<br>00404F91  |. 4A             DEC EDX<br>00404F92  |. 74 17          JE SHORT Kadrs.00404FAB<br>00404F94  |. 38FD           CMP CH,BH<br>00404F96  |. 75 3A          JNZ SHORT Kadrs.00404FD2	       ; занопить<br>[/c]<br><br>Программа запускается, но в этом коде проверяются не только ключи, но и другие строки (lstrcmp дельфийская). Надо смотреть выше. Вообщем, я очень доволен ключами <img src="img/smilies/s1.gif" alt=""><br><br>Кстати, я так и не понял, для чего она проверяет наличие отладчика. Даже без отключения под отладчиком отлично работает.<br><br>Большое спасибо за участие!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=198477&amp;user=17543&amp;forum_n=5&amp;topic=12498.html&amp;page=0&amp;anchor=9" class="addthx" data-post="198477"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]GreatDeal[/b]','')">GreatDeal</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.96'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=17543">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 августа 2008 09:56 <br><script type="text/javascript">QU('GreatDeal','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GreatDeal" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12498.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>tihiy_grom пишет:<br>А у меня всё ок с запуском </I><br>А в статусе Olly у тебя Exception 0FEDFADE. Это ведь не из-за отсутсвия бд?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=198480&amp;user=17543&amp;forum_n=5&amp;topic=12498.html&amp;page=0&amp;anchor=10" class="addthx" data-post="198480"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 августа 2008 10:06 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12498.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>GreatDeal пишет:<br>Я в шоке . А можно поинтересоваться, как ты нашел (да еще и так быстро) этот код? </I><br><br>Даже в дизассемблер не загружал ее <img src="img/smilies/s1.gif" alt=""> Программа ведь завершается при вводе неверного серийника. Значит нужно поставить бряк на ExitProcess, потом  посмотреть в стеке адреса возврата из кэллов и в итоге поднимаешься к процедуре проверки кода.
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=198482&amp;user=2981&amp;forum_n=5&amp;topic=12498.html&amp;page=0&amp;anchor=11" class="addthx" data-post="198482"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]GreatDeal[/b]','')">GreatDeal</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.96'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=17543">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 августа 2008 10:32 <br><script type="text/javascript">QU('GreatDeal','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GreatDeal" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12498.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>Flint пишет:<br>Значит нужно поставить бряк на ExitProcess </I><br><br>Спасибо за переданный опыт. Впредь буду думать шире <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=198484&amp;user=17543&amp;forum_n=5&amp;topic=12498.html&amp;page=0&amp;anchor=12" class="addthx" data-post="198484"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]steepx[/b]','')">steepx</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.95'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=17601">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 августа 2008 09:27 <br><script type="text/javascript">QU('steepx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=steepx" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=12498.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Народ, так объясните как обошли пароль? У меня либо вообще программа не запускается <b>(Flint)</b> или запускается, но не подлючается к базе(возможно из-за ввода логина и пароля).....<img src="img/smilies/s4.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=199156&amp;user=17601&amp;forum_n=5&amp;topic=12498.html&amp;page=0&amp;anchor=13" class="addthx" data-post="199156"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Взлом жирной программы на Delphi. Нужна помощь</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#14" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="12498">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=12498" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
