<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Подскажите по теории распака. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Проблема в следующем. Нашел ОЕП, сдампил, вроде разобрался с ресурсами (был один инвалидный адрес, оказался ExitProcess), но не запускается. Нашел первый &quot;косяк&quot; Внутри распака и оригинала есть такое. Code:      ">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Подскажите по теории распака.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=19818&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=19818&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2012 01:50 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Проблема в следующем.<br>Нашел ОЕП, сдампил, вроде разобрался с ресурсами (был один инвалидный адрес, оказался ExitProcess), но не запускается.<br>Нашел первый &quot;косяк&quot;<br>Внутри распака и оригинала есть такое.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00455EBF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>Call</b></span>&nbsp;<span class="hl_number">003864C6</span></li>        </ol>
    </div>
</div></div>
<br>В оригинале, соответственно эта пп-мма выполняется.<br>А в распаке этой секции просто нет, вот и вылетает при запуске.<br>Как мне поступить? Вернее как-бы Вы поступили?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304200&amp;user=29098&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=1" class="addthx" data-post="304200"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2012 02:05 &middot; Поправил: tihiy_grom <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Так как адрес &#036;003864C6 меньше чем стандартная ImageBase у модуля (&#036;00400000), то обычно пакеры выделяют этот участок памяти через VirtualAlloc.<br>Поэтому можно сначала посмотреть размер этого региона памяти, добавить секцию такого же размера к экзешнику, дождаться пока пакер соберётся выделить память, и после VirtualAlloc подменить получившийся адрес на адрес этой нашей новой секции.<br><br>Как-то так. Не мешало бы уточнить что за пакер, ну и саму программу выложить. А то гадать можно долго.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304201&amp;user=10534&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=2" class="addthx" data-post="304201"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29098" title="27-04-2012 17:34, ранг:8.4" target="_blank">Kuzya69</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2012 02:47 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
http://zalil.ru/33126971<br>Пакер PCGuard наверно 5-ой версии.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304203&amp;user=29098&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=3" class="addthx" data-post="304203"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]NikolayD[/b]','')">NikolayD</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 189.9 (ветеран), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.36'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24529">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2012 10:28 <br><script type="text/javascript">QU('NikolayD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NikolayD" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#4');return false;">#4</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0DE</span></li><li class="hl_l1"><span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">00E264C6</span></li>        </ol>
    </div>
</div></div>
<br>Это крипта PCGuard&#039;а. Расшифровывает код идущий после этого вызова и выполняет его:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00455EC4</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">8F8A0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">0045E958</span></li><li class="hl_l1"><span class="hl_number">00455EC9</span>&nbsp;&nbsp;&nbsp;&nbsp;BE&nbsp;C4CB8800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ESI</span><span class="hl_char">,</span>VCM<span class="hl_char">.</span><span class="hl_number">0088CBC4</span></li><li class="hl_l0"><span class="hl_number">00455ECE</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_number">00455ECF</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">7A890000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">0045E84E</span></li><li class="hl_l0"><span class="hl_number">00455ED4</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_number">00455ED5</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">14880000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">0045E6EE</span></li><li class="hl_l0"><span class="hl_number">00455EDA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8378</span>&nbsp;<span class="hl_number">14</span>&nbsp;<span class="hl_number">6A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">+</span><span class="hl_number">14</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">6A</span></li><li class="hl_l1"><span class="hl_number">00455EDE</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">59</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">ECX</span></li><li class="hl_l0"><span class="hl_number">00455EDF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">59</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">ECX</span></li><li class="hl_l1"><span class="hl_number">00455EE0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">7D</span>&nbsp;<span class="hl_number">07</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JGE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">00455EE9</span></li><li class="hl_l0"><span class="hl_number">00455EE2</span>&nbsp;&nbsp;&nbsp;&nbsp;C605&nbsp;ADCC8800&nbsp;<span class="hl_number">0</span><span class="hl_char">&gt;</span><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">88CCAD</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_number">00455EE9</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">70144900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">00491470</span></li><li class="hl_l0"><span class="hl_number">00455EEE</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">547D4900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">00497D54</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; ASCII &quot;VAGCOM.CFG&quot;</span></li><li class="hl_l1"><span class="hl_number">00455EF3</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">881D</span>&nbsp;ACCC8800&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">88CCAC</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">BL</span></li><li class="hl_l0"><span class="hl_number">00455EF9</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">891D</span>&nbsp;A4CC8800&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">88CCA4</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EBX</span></li><li class="hl_l1"><span class="hl_number">00455EFF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">891D</span>&nbsp;D8CB8800&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">88CBD8</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">00455F05</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">77710000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">0045D081</span></li><li class="hl_l1"><span class="hl_number">00455F0A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8BF0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ESI</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">00455F0C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">59</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">ECX</span></li><li class="hl_l1"><span class="hl_number">00455F0D</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">3BF3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">ESI</span><span class="hl_char">,</span><span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">00455F0F</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">59</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">ECX</span></li><li class="hl_l1"><span class="hl_number">00455F10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">74</span>&nbsp;<span class="hl_number">2D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">00455F3F</span></li><li class="hl_l0"><span class="hl_number">00455F12</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D85</span>&nbsp;ECFEFFFF&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">114</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00455F18</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">00455F19</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_number">00455F1A</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;CD2AFCFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">004189EC</span></li><li class="hl_l0"><span class="hl_number">00455F1F</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">59</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">ECX</span></li><li class="hl_l1"><span class="hl_number">00455F20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">83F8</span>&nbsp;FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_char">-</span><span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">00455F23</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">59</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">ECX</span></li><li class="hl_l1"><span class="hl_number">00455F24</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">74</span>&nbsp;<span class="hl_number">10</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">00455F36</span></li><li class="hl_l0"><span class="hl_number">00455F26</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D85</span>&nbsp;ECFEFFFF&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">114</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00455F2C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8BCF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_registr">EDI</span></li><li class="hl_l0"><span class="hl_number">00455F2E</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00455F2F</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;D8000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">0045600C</span></li><li class="hl_l0"><span class="hl_number">00455F34</span>&nbsp;&nbsp;^&nbsp;EB&nbsp;DC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">00455F12</span></li><li class="hl_l1"><span class="hl_number">00455F36</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l0"><span class="hl_number">00455F37</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">506F0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">0045CE8C</span></li><li class="hl_l1"><span class="hl_number">00455F3C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">59</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">ECX</span></li><li class="hl_l0"><span class="hl_number">00455F3D</span>&nbsp;&nbsp;&nbsp;&nbsp;EB&nbsp;<span class="hl_number">0D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">00455F4C</span></li><li class="hl_l1"><span class="hl_number">00455F3F</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">891D</span>&nbsp;<span class="hl_number">60374A00</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">4A3760</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">00455F45</span>&nbsp;&nbsp;&nbsp;&nbsp;C605&nbsp;A0CC8800&nbsp;<span class="hl_number">0</span><span class="hl_char">&gt;</span><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">88CCA0</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_number">00455F4C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">381D</span>&nbsp;<span class="hl_number">68AB8800</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">88AB68</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">BL</span></li><li class="hl_l0"><span class="hl_number">00455F52</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">00008000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">00800000</span></li><li class="hl_l1"><span class="hl_number">00455F57</span>&nbsp;&nbsp;&nbsp;&nbsp;BE&nbsp;D0E0E000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ESI</span><span class="hl_char">,</span><span class="hl_number">0E0E0D0</span></li><li class="hl_l0"><span class="hl_number">00455F5C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">74</span>&nbsp;<span class="hl_number">05</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">00455F63</span></li><li class="hl_l1"><span class="hl_number">00455F5E</span>&nbsp;&nbsp;&nbsp;&nbsp;BE&nbsp;FFFFFF00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ESI</span><span class="hl_char">,</span><span class="hl_number">0FFFFFF</span></li><li class="hl_l0"><span class="hl_number">00455F63</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_number">00455F64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8BCF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_registr">EDI</span></li><li class="hl_l0"><span class="hl_number">00455F66</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">7CEB0100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">00474AE7</span></li><li class="hl_l1"><span class="hl_number">00455F6B</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8935</span>&nbsp;A8CC8800&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">88CCA8</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ESI</span></li><li class="hl_l0"><span class="hl_number">00455F71</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B35</span>&nbsp;D0D24700&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ESI</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">47D2D0</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; kernel32.GetCurrentProcess</span></li><li class="hl_l1"><span class="hl_number">00455F77</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">80000000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">80</span></li><li class="hl_l0"><span class="hl_number">00455F7C</span>&nbsp;&nbsp;&nbsp;&nbsp;FFD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_number">00455F7E</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">00455F7F</span>&nbsp;&nbsp;&nbsp;&nbsp;FF15&nbsp;B8D24700&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">47D2B8</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; kernel32.SetPriorityClass</span></li><li class="hl_l1"><span class="hl_number">00455F85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">00455F87</span>&nbsp;&nbsp;&nbsp;&nbsp;FFD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_number">00455F89</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">00455F8A</span>&nbsp;&nbsp;&nbsp;&nbsp;FF15&nbsp;BCD24700&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">47D2BC</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; kernel32.SetProcessAffinityMask</span></li><li class="hl_l1"><span class="hl_number">00455F90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">0F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0F</span></li><li class="hl_l0"><span class="hl_number">00455F92</span>&nbsp;&nbsp;&nbsp;&nbsp;FF77&nbsp;<span class="hl_number">28</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">+</span><span class="hl_number">28</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00455F95</span>&nbsp;&nbsp;&nbsp;&nbsp;FF15&nbsp;C0D24700&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">47D2C0</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; kernel32.SetThreadPriority</span></li><li class="hl_l0"><span class="hl_number">00455F9B</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8BCF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_registr">EDI</span></li><li class="hl_l1"><span class="hl_number">00455F9D</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;EA050000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">0045658C</span></li><li class="hl_l0"><span class="hl_number">00455FA2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;DE000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0DE</span></li><li class="hl_l1"><span class="hl_number">00455FA7</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;BC069D00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">00E26668</span></li><li class="hl_l0"><span class="hl_number">00455FAC</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D8D</span>&nbsp;<span class="hl_number">10F9FFFF</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">6F0</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00455FB2</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">44CDFDFF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">00432CFB</span></li><li class="hl_l0"><span class="hl_number">00455FB7</span>&nbsp;&nbsp;&nbsp;&nbsp;A1&nbsp;<span class="hl_number">983A4A00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">4A3A98</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00455FBC</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">33F6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">ESI</span><span class="hl_char">,</span><span class="hl_registr">ESI</span></li><li class="hl_l0"><span class="hl_number">00455FBE</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8BC8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00455FC0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0FAFC8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>IMUL</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">00455FC3</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">85C9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_registr">ECX</span></li><li class="hl_l1"><span class="hl_number">00455FC5</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">7E</span>&nbsp;<span class="hl_number">1A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JLE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">00455FE1</span></li><li class="hl_l0"><span class="hl_number">00455FC7</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">88130000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">1388</span></li><li class="hl_l1"><span class="hl_number">00455FCC</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">9361FDFF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">0042C164</span></li><li class="hl_l0"><span class="hl_number">00455FD1</span>&nbsp;&nbsp;&nbsp;&nbsp;A1&nbsp;<span class="hl_number">983A4A00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">4A3A98</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00455FD6</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">59</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">ECX</span></li><li class="hl_l0"><span class="hl_number">00455FD7</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8BC8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00455FD9</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">46</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>INC</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l0"><span class="hl_number">00455FDA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0FAFC8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>IMUL</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00455FDD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">3BF1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">ESI</span><span class="hl_char">,</span><span class="hl_registr">ECX</span></li><li class="hl_l0"><span class="hl_number">00455FDF</span>&nbsp;&nbsp;^&nbsp;<span class="hl_number">7C</span>&nbsp;E6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JL</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">00455FC7</span></li><li class="hl_l1"><span class="hl_number">00455FE1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D8D</span>&nbsp;<span class="hl_number">10F9FFFF</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">6F0</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00455FE7</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">885D</span>&nbsp;FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">BL</span></li><li class="hl_l1"><span class="hl_number">00455FEA</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;DEB0FDFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">004310CD</span></li><li class="hl_l0"><span class="hl_number">00455FEF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">834D</span>&nbsp;FC&nbsp;FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>OR</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span>FFFFFFFF</li><li class="hl_l1"><span class="hl_number">00455FF3</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D4D</span>&nbsp;EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">14</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00455FF6</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">6FAF0100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;VCM<span class="hl_char">.</span><span class="hl_number">00470F6A</span></li><li class="hl_l1"><span class="hl_number">00455FFB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B4D</span>&nbsp;F4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span>C<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00455FFE</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">5F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l1"><span class="hl_number">00455FFF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">5E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l0"><span class="hl_number">00456000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">33C0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00456002</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">5B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">00456003</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">64</span><span class="hl_char">:</span><span class="hl_number">890D</span>&nbsp;<span class="hl_number">0000000</span><span class="hl_char">&gt;</span><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">FS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ECX</span></li><li class="hl_l1"><span class="hl_number">0045600A</span>&nbsp;&nbsp;&nbsp;&nbsp;C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">LEAVE</span></li><li class="hl_l0"><span class="hl_number">0045600B</span>&nbsp;&nbsp;&nbsp;&nbsp;C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">RETN</span></li>        </ol>
    </div>
</div></div>
<br><br>У этих продуктов под PCGuard вроде ещё VMProtect и/или Virtualizer )))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304213&amp;user=24529&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=4" class="addthx" data-post="304213"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]AKAB[/b]','')">AKAB</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/24135.jpg" alt=""><br><span class=txtSm>Ранг: 79.4 (постоянный), 183thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.44'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24135">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2012 13:06 <br><script type="text/javascript">QU('AKAB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AKAB" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
unpacking PC Guard 5.07  by  PassingThrough<br>http://tuts4you.com/download.php?view.3286
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304222&amp;user=24135&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=5" class="addthx" data-post="304222"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2012 15:45 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>NikolayD</b><br>Спасибо, но......<br>Чуть поподробнее можно объяснить. Вижу что в вашем коде переадресована подпрограмма<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00455FA2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;DE000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0DE</span></li><li class="hl_l1"><span class="hl_number">00455FA7</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;BC069D00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">00E26668</span></li>        </ol>
    </div>
</div></div>
<br>Наверно имеется ввиду перенос кода из участка 00376668..., в участок 00E26668..., с созданием там секции?<br>Но где вот это лежит, или лежать должно, и что с этим делать? <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0DE</span></li><li class="hl_l1"><span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">00E264C6</span></li>        </ol>
    </div>
</div></div>
<br>Или имелось ввиду именно то-что я выделил в предыдущем коде, просто ошиблись?<br>Я еще новичек, и с двух слов не всегда понимаю.<br><br><b>AKAB</b><br>Спасибо, интересный тутор. Но возникла проблема. Там перед вызовом функции VirtualAlloc, автор изменяет свойства окна, (WinXP=5.1 ---&gt; Win7=6.1) в GetVersionExA. А на моей программе этот &quot;финт ушами&quot; не проходит. У меня VirtualAlloc вызывается раньше чем GetVersionExA. Но все равно спасибо. Пока пробую &quot;адаптировать&quot; способ под свой случай.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304289&amp;user=29098&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=6" class="addthx" data-post="304289"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]NikolayD[/b]','')">NikolayD</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 189.9 (ветеран), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.36'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24529">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2012 16:21 <br><script type="text/javascript">QU('NikolayD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NikolayD" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Крипта работает так, что сначала расшифрованный участок выполняется и затем снова шифруется. Ну как-то так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00455EBA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;DE000000&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0DE</span></li><li class="hl_l1"><span class="hl_number">00455EBF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">02069D00</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">00E264C6</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; процедура расшифровывает кусок кода</span></li><li class="hl_l0"><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span>Здесь&nbsp;участок&nbsp;с&nbsp;кодом<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l1"><span class="hl_number">00455FA2</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;DE000000&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0DE</span></li><li class="hl_l0"><span class="hl_number">00455FA7</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;E8&nbsp;BC069D00&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">00E26668</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; процедура зашифровывает кусок кода</span></li>        </ol>
    </div>
</div></div>
<br>Таким образом получается тебе нужно выполнить расшифровку (просто установить железный/мемори бряк на байт идущий после вызова), перенести код в свой дамп и занопить обе процедуры.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304290&amp;user=24529&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=7" class="addthx" data-post="304290"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29098" title="26-04-2012 13:10, ранг:8.0" target="_blank">Kuzya69</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2012 16:41 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>NikolayD</b><br>А заставить крипту создать зашифрованный код в другом участке, а потом шифровать-дешифровать в том участке, где и создает, не будет правильней? <br>Извини если вопрос покажется &quot;глупым&quot;. Просто скажи &quot;Ты не прав&quot;.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304291&amp;user=29098&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=8" class="addthx" data-post="304291"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]NikolayD[/b]','')">NikolayD</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 189.9 (ветеран), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.36'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24529">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2012 16:53 <br><script type="text/javascript">QU('NikolayD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NikolayD" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Это называется из пустого в порожнее )))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304292&amp;user=24529&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=9" class="addthx" data-post="304292"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2012 18:21 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>Kuzya69</b><br>Нормальным тоном считается выдирать скрытый код и вставлять его на место.<br>ЗЫ. У мну просто тоже самое и с виртуальной машиной SecuROM&#039;а 7 было: что лучше выполнить <b>30k</b> асм инструкций VM или <b>10</b> эквивалентных асм инструкций?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304296&amp;user=26651&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=10" class="addthx" data-post="304296"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 01:10 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>tihiy_grom</b><br>Вы писали<br><b><i class=x>добавить секцию такого же размера к экзешнику, дождаться пока пакер соберётся выделить память, и после VirtualAlloc подменить получившийся адрес на адрес этой нашей новой секции.</i></b><br>А нельзя через VirtualAlloc добавить секцию? Зачем там параметр &quot;Базовый адрес&quot;? Пробовал в Олли изменить это значение перед вызовом VirtualAlloc, возвращается ошибка (00000000).<br>Пробовал задать базовый адрес такой-же, который автоматом создается. То-есть перед вызовом базовый адрес задается NUL, а возвращается 00360000. Я пробовал перед вызовом подменить базовый адрес сразу на 00360000, но АПИ вернула ошибку (00000000).<br>Если все мои действия неверны, то как нужно создавать секцию при помощи Олли?<br><br>И еще один вопрос, где подсмотреть числовые значения параметров функции?<br>Например хочу изменить параметр с PAGE_EXECUTE_READ  на PAGE_EXECUTE, и не знаю какое значение ввести. Олли-то это знает, но как это мне увидеть? Не перебирать-же все возможные значения.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304312&amp;user=29098&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=11" class="addthx" data-post="304312"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Dart Sergius[/b]','')">Dart Sergius</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/22828.jpg" alt=""><br><span class=txtSm>Ранг: 105.6 (ветеран), 36thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22828">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 01:30 <br><script type="text/javascript">QU('Dart Sergius','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dart Sergius" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>Kuzya69</b>, вы должны прикрутить секцию которую будете размещать где требуется к файлу. Потом вызывать VirtualAlloc с параметров &quot;желательный адрес&quot; не NULL, а тот который у вас был ранее.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304315&amp;user=22828&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=12" class="addthx" data-post="304315"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 01:51 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>Dart Sergius</b><br><i class=x><b>...вы должны прикрутить секцию которую будете размещать где требуется к файлу...</b></i><br>Вот тут можно поподробнее, как это сделать в Олли? Или ссылку если не трудно?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304317&amp;user=29098&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=13" class="addthx" data-post="304317"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Dart Sergius[/b]','')">Dart Sergius</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/22828.jpg" alt=""><br><span class=txtSm>Ранг: 105.6 (ветеран), 36thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22828">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 02:34 <br><script type="text/javascript">QU('Dart Sergius','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dart Sergius" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>Kuzya69</b>, прикрутить секцию надо любым PE редактором.<br>Потом <br>VirtualAlloc(&lt;наш желаемый адрес&gt;...)<br>и копируем всё что в нашей новой секции в выделенную память.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304318&amp;user=22828&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=14" class="addthx" data-post="304318"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29098" title="26-04-2012 13:09, ранг:8.0" target="_blank">Kuzya69</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 14:18 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
А секцию создавать с размерами RawSize=нулевой, а VirtualSize=такой как VirtualAlloc создает, только округлить до ближайшей большей 1000h? Правильно я понимаю?<br>Просто никак не получается создать секцию в диапазоне (виртуальном) 00А20000 размером 18000. Если с помощью LordPE создавать автоматом (не меняя VOffset и ROffset), то создается.<br>Понятно, что можно оставить и так, но нужно и по другому научиться?<br><br>И все равно остался вопрос. При запуске секции 360000 еще нет. После вызова VirtualAlloc с параметрам для адреса секции &quot;по усмотрению Винды&quot; эта секция появляется. Как программа создает эту секцию при выполнении? Даже так, какой код вписать мне в Олли, чтоб программа сама создала нужную мне секцию?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304339&amp;user=29098&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=15" class="addthx" data-post="304339"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 14:34 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Клуб телепатов собрался<img src="img/smilies/s6.gif" alt="">,по сущевству в 4 посте<b>NikolayD</b> отписался<img src="img/smilies/s2.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=304342&amp;user=17432&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=16" class="addthx" data-post="304342"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 15:33 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Так в чем вопрос-то? Я вроде все написАл.<br>Просто надо понять, как секции создаются, самой программой? И почему вручную не получается, с моими установками ?<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">009C65E0</span>&nbsp;Main&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">40</span>&nbsp;<span class="hl_comment">; Protect_VirtualAlloc_1</span></li><li class="hl_l1"><span class="hl_number">009C65E5</span>&nbsp;Main&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">1000</span>&nbsp;<span class="hl_comment">; AllocationType_VirtualAlloc_1</span></li><li class="hl_l0"><span class="hl_number">009C6602</span>&nbsp;Main&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>ESI</b></span>&nbsp;<span class="hl_comment">; Size_VirtAlloc_1</span></li><li class="hl_l1"><span class="hl_number">009C6609</span>&nbsp;Main&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_comment">; Address_VirtAlloc_1                   </span></li><li class="hl_l0"><span class="hl_number">009C660E</span>&nbsp;Main&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">+</span><span class="hl_number">429314</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; kernel32.VirtualAlloc</span></li>        </ol>
    </div>
</div></div>
<br>После выполнения этого куска кода появляется секция <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Memory&nbsp;map<span class="hl_char">,</span>&nbsp;item&nbsp;<span class="hl_number">15</span></li><li class="hl_l1">&nbsp;Address<span class="hl_char">=</span><span class="hl_number">00360000</span></li><li class="hl_l0">&nbsp;Size<span class="hl_char">=</span><span class="hl_number">00018000</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">98304</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;Owner<span class="hl_char">=</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">00360000</span>&nbsp;<span class="hl_char">(</span>itself<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;<span class="hl_function">Section</span><span class="hl_char">=</span></li><li class="hl_l1">&nbsp;Type<span class="hl_char">=</span>Priv&nbsp;<span class="hl_number">00021040</span></li><li class="hl_l0">&nbsp;Access<span class="hl_char">=</span>RWE</li><li class="hl_l1">&nbsp;Initial&nbsp;access<span class="hl_char">=</span>RWE</li>        </ol>
    </div>
</div></div>
<br>Мне надо чтоб эта секция появилась в другом месте <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>Address<span class="hl_char">=</span><span class="hl_number">00E20000</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br>Как исправить код?<br>А по первой части предыдущего сообщения.<br>Создаю в LordPE секцию. Так мне надо.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Voffset<span class="hl_char">=</span><span class="hl_number">00A20000</span>&nbsp;<span class="hl_char">(</span>чтоб&nbsp;в&nbsp;Олли&nbsp;эта&nbsp;секция&nbsp;была&nbsp;<span class="hl_number">00E20000</span>&nbsp;как&nbsp;советовал&nbsp;NikolayD<span class="hl_char">)</span></li><li class="hl_l1">Vsize<span class="hl_char">=</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00018000</span></li><li class="hl_l0">Rsize<span class="hl_char">=</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00000000</span></li>        </ol>
    </div>
</div></div>
<br>Остальное оставляю на усмотрение LordPE.<br>Файл не запускается.<br>Если создаю секцию.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Vsize<span class="hl_char">=</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00018000</span></li><li class="hl_l1">Rsize<span class="hl_char">=</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00000000</span></li>        </ol>
    </div>
</div></div>
<br>Остальное оставляю на усмотрение LordPE.<br>Секция создается, но в другом месте и файл запускается.<br>Почему не могу создать, как я хочу?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304348&amp;user=29098&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=17" class="addthx" data-post="304348"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 15:45 &middot; Поправил: ClockMan <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#18');return false;">#18</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_number">00455EBA</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0DE</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">&gt;</span><span class="hl_function"><b>New</b></span>&nbsp;origin&nbsp;here</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_number">00455EBF</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">003B64C6</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_number">00455EC4</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>LES</b></span>&nbsp;<span class="hl_registr">EBP</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">+</span><span class="hl_number">1C</span><span class="hl_char">]</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>Breakpoint<span class="hl_char">&gt;</span>Hardware<span class="hl_char">,</span>on&nbsp;execution</li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=304350&amp;user=17432&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=18" class="addthx" data-post="304350"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 16:07 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Это я понял как сделать. Я спрашивал в предыдущем посте совсем о другом.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304351&amp;user=29098&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=19" class="addthx" data-post="304351"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 16:14 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>Kuzya69 пишет:</b><br><i class=x>Остальное оставляю на усмотрение LordPE.<br>Файл не запускается.</i><br><br>И не запустится, если нарушена непрерывность образа. В таком случае можно, чтоб не париться, юзать опцию Validate PE в Pe Tools.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=304352&amp;user=6336&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=20" class="addthx" data-post="304352"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 16:26 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>ARCHANGEL пишет:</b><br><i class=x><b>И не запустится, если нарушена непрерывность образа.</b></i><br>Так образ в месте RawOffset непрерывен, да и секцию в файл я нулевую добавляю.<br>Смотрел FlexHex-ом.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304354&amp;user=29098&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=21" class="addthx" data-post="304354"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 16:37 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>Kuzya69</b><br>Непрерывность должна быть по Virtual Offset. Дырок в виртуальной памяти проекции образа быть не должно, т.е. если хотите выделить память в адресах типа 00Е00000 - пожалуйста, а если хотите обязать загрузчик это делать, значит надо сделать предыдущую секцию больше по виртуальным адресам так, что пространство перед вашим заветным адресом принадлежало предыдущей секции.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=304355&amp;user=6336&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=22" class="addthx" data-post="304355"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29098" title="26-04-2012 13:09, ранг:8.0" target="_blank">Kuzya69</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 17:01 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Виртуальную память когда смотреть? На ЕР, OEP, после прохода всех VirtualAlloc, или уже когда программа запустилась?<br>Чтоб узнать куда секцию можно вписать, и какую соответственно увеличивать?<br><br><br>Пардон, кажется понял.<br>Можно не обязательно увеличивать предыдущую, а создать пустую секцию в этом разрыве.<br>Посчитал Voffset-ы Vsize-ы всех секций в таблице LordPE. И вроде дошло. Спасибо!!!<br><br>А как с заданием адреса секции для VirtualAlloc? Что я чуть выше писАл.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304357&amp;user=29098&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=23" class="addthx" data-post="304357"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 18:05 <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
Да что вам так упёрлись эти адреса. <br>Вы же добавили уже к файлу секцию нужного размера? Теперь когда VirtualAlloc отработает, и в памяти появится секция с адресом 00360000 - тупо после выхода из VirtualAlloc смените значение в регистре EAX на нужный адрес.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304361&amp;user=10534&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=24" class="addthx" data-post="304361"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 18:12 &middot; Поправил: ELF_7719116 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>Kuzya69</b><br>Секции создаются загрузчиком. Для этого существуют низкоуровневые API типа  ZwCreateSection и макросы для них другие.<br><i class=x>VirtualAlloc(Ex)</i> - выделяет виртуальную память, которая может быть освобождена. По существу все же это не одно и тоже.<br>например типичный код:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">VirtualAlloc<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">*</span><span class="hl_char">)</span>0x1000000<span class="hl_char">,</span>0x1000<span class="hl_char">,</span>MEM_COMMIT<span class="hl_char">|</span>MEM_RESERVE<span class="hl_char">,</span>PAGE_EXECUTE_READ<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>В первом аргументе задается желаемый адрес выделяемой памяти(в данном случае 0x1000000),  который не NULL.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304362&amp;user=26651&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=25" class="addthx" data-post="304362"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 18:36 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<b>tihiy_grom</b><br><i class=x><b>Да что вам так упёрлись эти адреса. </b></i><br>Парни, ну я заодно и учусь. Я хочу понять как это происходит. Просто повторять действия тутора не интересно. Параллельно хочу понять, как создаются эти секции.<br><b>ELF_7719116</b><br><i class=x><b>В первом аргументе задается желаемый адрес выделяемой памяти(в данном случае 0x1000000), который не NULL. </b></i><br>Вот именно так я и делал, только аргумент адреса засовывал прямо в стек, перед вызовом VirtualAlloc.<br>Я так понял, чтоб VirtualAlloc &quot;выделил секцию&quot;, нужно чтоб эта секция уже была создана загрузчиком?<br>Но почему тогда VirtualAlloc создает ее в свободном пространстве 00360000, и не создает в созданной мной, через LordPE секции. Может нужно, при создании в LordPE, задать моей секции, какие-то атрибуты &quot;что она свободна&quot;?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304364&amp;user=29098&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=26" class="addthx" data-post="304364"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 19:04 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
Уффф. Так, начнём сначала. Есть три разных понятия: объект &quot;секция&quot;, секция Portable Executable и участок виртуальной памяти, именуемый во всяких утилитах как <b>регион</b> (region). <br><br>1.<i class=x>Итак, объект &quot;секция&quot; не стоит путать с термином &quot;секция&quot; из PE-файла, это вовсе не одно и тоже. Section object создается в ЕДИНСТВЕННОМ экземпляре на файл. Доказательство: функция NtCreateSection, вызывается ОДИН раз - в коде лоадера (ntdll.dll) из LdrpCreateDllSection (эта, в свою очередь, из LdrpMapDll), и в коде CreateProcess также единожды, в последовательности...</i><br><br>Продолжение <noindex><a href="http://wasm.ru/article.php?article=packers2" rel="nofollow" target="_blank">--&gt; Здесь &lt;--</a></noindex><br><br>2.  Секция Portable Executable имеет больше схожих черт с регионом, но разница в том, что секция проецируется на адресное пространство загрузчиком операционной системы, и от нас с вами не требуется никаких дополнительных программерских телодвижений. Подробнее <noindex><a href="http://www.wasm.ru/print.php?article=packlast01#22" rel="nofollow" target="_blank">--&gt; Здесь &lt;--</a></noindex><br><br>3. Регион - самое простое из этих понятий. Регионом называют множество последовательно расположенных виртуальных страниц с одинаковыми атрибутами доступа. VirtualAlloc выделяет именно регион. <br><br>Если вы хотите сдампить некоторую ВМ, то тут есть два различных способа её хранения - либо в секции (термин 2), которую вы сразу настраиваете на загрузку по требуемому виртуальному адресу, либо просто где-то в файле, неважно где, но т.к. это дамп, то по иронии судьбы, простейшим способом будет всё то же создание новой секции. В чём же разница? Разница в том, что в первом случае вы добиваетесь загрузки ВМ по требуемому адресу благодаря элементам IMAGE_SECTION_TABLE заголовка, а во втором случае выделяете регион программно и копируете туда код из вашей новой секции.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=304368&amp;user=6336&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=27" class="addthx" data-post="304368"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 20:31 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Отлично, я действительно путал термины. Трудновато для понимания с первого взгляда, но попробую вкурить. Еще раз двадцать перечитаю.<br>Докладываю, распаковал, все запускается. Сделал так<br>1)создал новую секцию<br>2) До прихода в ОЕП дважды вызывался VirtualAlloc. И создавал секции до ImageBase. После ОЕП секции создавались после ImageBase.(поэтому я их не трогал).<br>Так вот, я по выходу из процедуры просто подменял адреса создаваемых секций на созданную мной секцию, с учетом, что области не должны пересечься. <br>3) Пришел в ОЕП и сдампил. Работает.<br> С П А С И Б О     В С Е М    ! ! !<br>Будем дальше учиться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304378&amp;user=29098&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=28" class="addthx" data-post="304378"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]AKAB[/b]','')">AKAB</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/24135.jpg" alt=""><br><span class=txtSm>Ранг: 79.4 (постоянный), 183thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.44'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24135">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 21:02 <br><script type="text/javascript">QU('AKAB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AKAB" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
вот тебе  сам  PassingThrough  распакававал<br>http://ar.rghost.net/37783852
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304380&amp;user=24135&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=29" class="addthx" data-post="304380"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 апреля 2012 21:23 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19818&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<b>AKAB</b><br>Спасибо. Но согласитесь, самому научиться и понять куда приятней.<br>Я просто начал с младшей версии. А в принципе хочу старшие освоить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=304382&amp;user=29098&amp;forum_n=5&amp;topic=19818&amp;page=0&amp;anchor=30" class="addthx" data-post="304382"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=19818&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=19818&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Подскажите по теории распака.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="19818">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19818" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
