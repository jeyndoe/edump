<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>нужно опознать криптоалгоритм - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброго времени суток всем! Ковыряя ресурсы одной игрушки, наткнулся на расшифровку данных по какому-то алгоритму. На самопал слабо похоже - если разработчик и решает защитить ресурсы своим алго, то обычно дальше xor/rol/sub">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a>, <a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> нужно опознать криптоалгоритм</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2013 01:44 <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22185.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброго времени суток всем!<br><br>Ковыряя ресурсы одной игрушки, наткнулся на расшифровку данных по какому-то алгоритму.<br>На самопал слабо похоже - если разработчик и решает защитить ресурсы своим алго, то обычно дальше xor/rol/sub никто не заходит. А тут что-то хитрое, с расшифровкой по ключу (который намертво зашит в код). Поэтому мне и кажется, что тут был использован какой-то готовый алгоритм. Опознать его мне не удаётся - констант в коде нет, криптосёрчеры молчат, а я в криптографии не силён.<br><br>Я рипнул и перевёл код, но понимания это не принесло. Сорец в аттаче.<br><br><br>ЗЫ: нет, разворачивать принцип мне не нужно. Просто хочу узнать, что это за алго.<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/480f_21.09.2013_EXELAB.rU.tgz">480f_21.09.2013_EXELAB.rU.tgz</a> - algo.cpp
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331152&amp;user=26242&amp;forum_n=6&amp;topic=22185.html&amp;page=0&amp;anchor=1" class="addthx" data-post="331152"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2013 02:03 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22185.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
IDEA
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331153&amp;user=15381&amp;forum_n=6&amp;topic=22185.html&amp;page=0&amp;anchor=2" class="addthx" data-post="331153"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=26242" title="20-09-2013 23:00, ранг:40.8" target="_blank">-=AkaBOSS=-</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]DimitarSerg[/b]','')">DimitarSerg</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/24946.png" alt=""><br><span class=txtSm>Ранг: 253.5 (наставник), 684thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.26'>Активность: 0.26<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=24946">Участник</a><br><font color=blue>radical</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2013 02:11 &middot; Поправил: DimitarSerg <br><script type="text/javascript">QU('DimitarSerg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DimitarSerg" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22185.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Очень похоже на IDEA (процедура mul, у тебя weirdproc )... нашёл в DcpCrypt (искал по and &#036;FFFF)<br><br>add<br><b>reversecode</b><br>А вы шутрее оказались <img src="img/smilies/s1.gif" alt=""><br><br>add2:<br>Ну и собственно у Шнейера на сайте:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;Idea<span class="hl_char">(</span>u_int16&nbsp;<span class="hl_char">*</span><span class="hl_function">in</span><span class="hl_char">,</span>&nbsp;u_int16&nbsp;<span class="hl_char">*</span><span class="hl_function">out</span><span class="hl_char">,</span>&nbsp;u_int16&nbsp;<span class="hl_char">*</span>key<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;register&nbsp;u<span class="hl_char">+</span>int16&nbsp;x0<span class="hl_char">,</span>&nbsp;x1<span class="hl_char">,</span>&nbsp;x2<span class="hl_char">,</span>&nbsp;x3<span class="hl_char">,</span>&nbsp;s1<span class="hl_char">,</span>&nbsp;s2<span class="hl_char">,</span>&nbsp;round<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x0&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_function">in</span><span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;  x1 = *in++;  x2 = *in++;  x3 = *in;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span>round&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; round &lt; 8; round++) {</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x0&nbsp;<span class="hl_char">*</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span>key<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x1&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span>key<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x2&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span>key<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x3&nbsp;<span class="hl_char">*</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span>key<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s1&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;x1<span class="hl_comment">;  s2  = x2;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x2&nbsp;^<span class="hl_char">=</span>&nbsp;x0<span class="hl_comment">;  x1 ^= x3;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x2&nbsp;<span class="hl_char">*</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span>key<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x1&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;x2<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x1&nbsp;<span class="hl_char">*</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span>key<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x2&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;x1<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x0&nbsp;^<span class="hl_char">=</span>&nbsp;x1<span class="hl_comment">;  x3 ^= x2;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x1&nbsp;^<span class="hl_char">=</span>&nbsp;s2<span class="hl_comment">;  x2 ^= s1;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_function">out</span><span class="hl_char">+</span><span class="hl_char">+</span>&nbsp;<span class="hl_char">=</span>&nbsp;x0&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_char">*</span>key<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_function">out</span><span class="hl_char">+</span><span class="hl_char">+</span>&nbsp;<span class="hl_char">=</span>&nbsp;x2&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_char">*</span>key<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;	/* Yes, this is x2, not x1 */</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_function">out</span><span class="hl_char">+</span><span class="hl_char">+</span>&nbsp;<span class="hl_char">=</span>&nbsp;x1&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_char">*</span>key<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_function"><b>out</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;x3&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_char">*</span>key<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;}</li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>ds</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=331154&amp;user=24946&amp;forum_n=6&amp;topic=22185.html&amp;page=0&amp;anchor=3" class="addthx" data-post="331154"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=26242" title="20-09-2013 23:00, ранг:40.8" target="_blank">-=AkaBOSS=-</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2013 05:07 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22185.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>reversecode</b>, <b>DimitarSerg</b> - большое спасибо!<br><br>Возник еще один вопрос: <br>а можно ли трансформировать ключ обратно к 128-битному виду?<br><br>я нашёл такое описание:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Задача&nbsp;процедуры&nbsp;расширения&nbsp;ключа&nbsp;<span class="hl_char">-</span>&nbsp;формирование&nbsp;<span class="hl_number">52</span>&nbsp;<span class="hl_number">16</span><span class="hl_char">-</span>битных&nbsp;подключей<span class="hl_char">,</span>&nbsp;используемых&nbsp;в&nbsp;раундах&nbsp;шифрования&nbsp;и&nbsp;дополнительных&nbsp;преобразованиях&nbsp;<span class="hl_char">(</span>т<span class="hl_char">.</span>&nbsp;е<span class="hl_char">.</span>&nbsp;всего&nbsp;<span class="hl_number">832</span>&nbsp;бита&nbsp;ключевой&nbsp;информации<span class="hl_char">)</span><span class="hl_char">.</span>&nbsp;Данная&nbsp;процедура&nbsp;весьма&nbsp;проста<span class="hl_char">,</span>&nbsp;и&nbsp;выполняется&nbsp;она&nbsp;следующим&nbsp;образом<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_number">1</span><span class="hl_char">.</span>&nbsp;<span class="hl_number">128</span><span class="hl_char">-</span>битный&nbsp;ключ&nbsp;шифрования&nbsp;делится&nbsp;на&nbsp;восемь&nbsp;подключей&nbsp;по&nbsp;<span class="hl_number">16</span>&nbsp;бит<span class="hl_comment">; они становятся первыми восемью подключами алгоритма (K11, K12, K13, K14, K15, K16, K21, K22).</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_number">2</span><span class="hl_char">.</span>&nbsp;Ключ&nbsp;шифрования&nbsp;циклически&nbsp;сдвигается&nbsp;влево&nbsp;на&nbsp;<span class="hl_number">25</span>&nbsp;бит<span class="hl_char">.</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_number">3</span><span class="hl_char">.</span>&nbsp;Результат&nbsp;делится&nbsp;на&nbsp;восемь&nbsp;следующих&nbsp;подключей<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_number">4</span><span class="hl_char">.</span>&nbsp;Ключ&nbsp;шифрования&nbsp;циклически&nbsp;сдвигается&nbsp;влево&nbsp;на&nbsp;<span class="hl_number">25</span>&nbsp;бит<span class="hl_char">,</span>&nbsp;и&nbsp;так&nbsp;далее&nbsp;до&nbsp;выработки&nbsp;необходимого&nbsp;количества&nbsp;подключей<span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br><br>Проблема в том, что в программе зашит уже расширенный ключ, и мне кажется, что в данном случае он не является трансформированным 128-битным, а представляет собой просто рандомный набор.<br>Или я ошибаюсь?<br><br>ADD<br>мдя. проспался, почитал описание алгоритма повнимательнее...<br>получается, что исходный ключ сначала расширяется по алгоритму, который описан выше, а потом ЕЩЕ РАЗ трансформируется для получения ключа для дешифровки...<br>ладно, буду разбираться...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331158&amp;user=26242&amp;forum_n=6&amp;topic=22185.html&amp;page=0&amp;anchor=4" class="addthx" data-post="331158"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2013 13:20 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22185.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
ну что бы продолжить квест, этот алго 1 в 1 с аттача похож на реализацию в библиотеке botan<br>могу еще подсыпать уголька ;) и сказать что такую тему с таким алго уже на лабе поднимали и тоже угадывали
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331164&amp;user=15381&amp;forum_n=6&amp;topic=22185.html&amp;page=0&amp;anchor=5" class="addthx" data-post="331164"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2013 02:07 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22185.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>reversecode пишет:<br>такую тему с таким алго уже на лабе поднимали </I><br><noindex><a href="https://ssl.exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19319&amp;page=0" rel="nofollow" target="_blank">ЭТУ</a></noindex>, видимо.<br>Но я уже покопал исходники разных реализаций алгоритма, порипал код (в аттаче).<br><br>Ключ всё-таки получилось вернуть к 128-битному виду, но возник неожиданный нюанс - при использовании во внешних приложениях результат расшифровки не совпадает.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;этот&nbsp;комплект&nbsp;данных&nbsp;я&nbsp;рипнул&nbsp;из&nbsp;программы</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;шифрование<span class="hl_char">/</span>расшифровка&nbsp;по&nbsp;алгоритму&nbsp;происходит&nbsp;правильно<span class="hl_char">,</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;но&nbsp;проверка&nbsp;через&nbsp;CrypTool&nbsp;даёт&nbsp;другие&nbsp;результаты<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_function"><b>byte</b></span>&nbsp;Key0<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;0x7B<span class="hl_char">,</span>0x00<span class="hl_char">,</span>0x6F<span class="hl_char">,</span>0x00<span class="hl_char">,</span>0x0A<span class="hl_char">,</span>0x00<span class="hl_char">,</span>0x0C<span class="hl_char">,</span>0x00<span class="hl_char">,</span>0xDE<span class="hl_char">,</span>0x00<span class="hl_char">,</span>0x5A<span class="hl_char">,</span>0x00<span class="hl_char">,</span>0x01<span class="hl_char">,</span>0x00<span class="hl_char">,</span>0x08<span class="hl_char">,</span>0x00&nbsp;&nbsp;&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>byte</b></span>&nbsp;EncData0<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;0xDB<span class="hl_char">,</span>0x42<span class="hl_char">,</span>0xA3<span class="hl_char">,</span>0xC5<span class="hl_char">,</span>0x1F<span class="hl_char">,</span>0xD7<span class="hl_char">,</span>0xCE<span class="hl_char">,</span>0x05&nbsp;&nbsp;&nbsp;&nbsp;}<span class="hl_comment">;		// зашифрованные данные из программы</span></li><li class="hl_l1"><span class="hl_function"><b>byte</b></span>&nbsp;DecData0<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;0x78<span class="hl_char">,</span>0x9C<span class="hl_char">,</span>0xBD<span class="hl_char">,</span>0x7D<span class="hl_char">,</span>0x09<span class="hl_char">,</span>0x7C<span class="hl_char">,</span>0x1B<span class="hl_char">,</span>0xC7&nbsp;&nbsp;&nbsp;&nbsp;}<span class="hl_comment">;		// расшифрованные данные - начало zLib потока</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;а&nbsp;эти&nbsp;два&nbsp;комплекта&nbsp;я&nbsp;нашёл&nbsp;в&nbsp;исходниках&nbsp;DCPCrypt&nbsp;<span class="hl_char">-</span>&nbsp;dcpidea<span class="hl_char">.</span>pas</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;зашифрованные<span class="hl_char">/</span>расшифрованные&nbsp;результаты&nbsp;не&nbsp;совпадают&nbsp;с&nbsp;ожидаемыми</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;при&nbsp;проверке&nbsp;через&nbsp;CrypTool&nbsp;выходные&nbsp;данные&nbsp;соответствуют&nbsp;ожидаемым</li><li class="hl_l0"><span class="hl_function"><b>byte</b></span>&nbsp;Key1<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;0x3A<span class="hl_char">,</span>0x98<span class="hl_char">,</span>0x4E<span class="hl_char">,</span>0x20<span class="hl_char">,</span>0x00<span class="hl_char">,</span>0x19<span class="hl_char">,</span>0x5D<span class="hl_char">,</span>0xB3<span class="hl_char">,</span>0x2E<span class="hl_char">,</span>0xE5<span class="hl_char">,</span>0x01<span class="hl_char">,</span>0xC8<span class="hl_char">,</span>0xC4<span class="hl_char">,</span>0x7C<span class="hl_char">,</span>0xEA<span class="hl_char">,</span>0x60&nbsp;&nbsp;&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>byte</b></span>&nbsp;DecData1<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;0x01<span class="hl_char">,</span>0x02<span class="hl_char">,</span>0x03<span class="hl_char">,</span>0x04<span class="hl_char">,</span>0x05<span class="hl_char">,</span>0x06<span class="hl_char">,</span>0x07<span class="hl_char">,</span>0x08&nbsp;&nbsp;&nbsp;&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>byte</b></span>&nbsp;EncData1<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;0x97<span class="hl_char">,</span>0xBC<span class="hl_char">,</span>0xD8<span class="hl_char">,</span>0x20<span class="hl_char">,</span>0x07<span class="hl_char">,</span>0x80<span class="hl_char">,</span>0xDA<span class="hl_char">,</span>0x86&nbsp;&nbsp;&nbsp;&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>byte</b></span>&nbsp;Key2<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;0x00<span class="hl_char">,</span>0x64<span class="hl_char">,</span>0x00<span class="hl_char">,</span>0xC8<span class="hl_char">,</span>0x01<span class="hl_char">,</span>0x2C<span class="hl_char">,</span>0x01<span class="hl_char">,</span>0x90<span class="hl_char">,</span>0x01<span class="hl_char">,</span>0xF4<span class="hl_char">,</span>0x02<span class="hl_char">,</span>0x58<span class="hl_char">,</span>0x02<span class="hl_char">,</span>0xBC<span class="hl_char">,</span>0x03<span class="hl_char">,</span>0x20&nbsp;&nbsp;&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>byte</b></span>&nbsp;DecData2<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;0x05<span class="hl_char">,</span>0x32<span class="hl_char">,</span>0x0A<span class="hl_char">,</span>0x64<span class="hl_char">,</span>0x14<span class="hl_char">,</span>0xC8<span class="hl_char">,</span>0x19<span class="hl_char">,</span>0xFA&nbsp;&nbsp;&nbsp;&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>byte</b></span>&nbsp;EncData2<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;0x65<span class="hl_char">,</span>0xBE<span class="hl_char">,</span>0x87<span class="hl_char">,</span>0xE7<span class="hl_char">,</span>0xA2<span class="hl_char">,</span>0x53<span class="hl_char">,</span>0x8A<span class="hl_char">,</span>0xED&nbsp;&nbsp;&nbsp;&nbsp;}<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br><strike>то ли лыжи не едут,</strike> то ли ключ должен быть еще как-то обработан перед использованием, то ли алгоритм не тот (хотя это вряд ли - я его пошагово сверил со структурой, изображённой в википедии).<br>В общем, мне нужна помощь... опять.<br><br><img src="img/attach.gif" alt=""> <a href="./files/97cc_22.09.2013_EXELAB.rU.tgz">97cc_22.09.2013_EXELAB.rU.tgz</a> - algo.cpp<br><br><br>/ADD<br>Таки разобрался cо своим вопросом.<br>Несовпадения возникали из-за несоответствия байтового порядка.<br>Стандартные утилиты (CrypTool etc) при шифровании/расшифровке по-умолчанию преобразуют входящие данные и ключ в big-endian, а та реализация алгоритма, с которой я столкнулся и рипнул, работала с тем что дают и не выёживалась)<br><br>Проблема решена - тему закрываю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=331190&amp;user=26242&amp;forum_n=6&amp;topic=22185.html&amp;page=0&amp;anchor=6" class="addthx" data-post="331190"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> нужно опознать криптоалгоритм</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22185" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
