<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как найти OEP для запакованной библиотеки DLL - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="С помощью программы GeTaOEP в режиме external dll loader получаются такие результаты: Dll has been injected into the target process at base address 0x10000000 Processing... Target imagebase: 0x00160000 Approximate OEP RVA:">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41144'>Adler</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как найти OEP для запакованной библиотеки DLL</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]StarXruk[/b]','')">StarXruk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.08'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=32258">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июня 2012 20:06 &middot; Поправил: StarXruk <br><script type="text/javascript">QU('StarXruk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StarXruk" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20031.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
С помощью программы GeTaOEP в режиме external dll loader получаются такие результаты:<br><b>Dll has been injected into the target process at base address 0x10000000<br>Processing...<br>Target imagebase: 0x00160000<br>Approximate OEP RVA: 0x000375D5<br>                 VA: 0x001975D5<br>Target process has been terminated</b><br>Как теперь найти в отладчике,когда запущен основной процесс,этот адрес? По адресу 001975D5 ничего нет<br>При загрузке программы,модуль этой Dll занимает область памяти: 00330000 - 00392000
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306948&amp;user=32258&amp;forum_n=5&amp;topic=20031.html&amp;page=0&amp;anchor=1" class="addthx" data-post="306948"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июня 2012 20:15 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20031.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
00330000 + 000375D5 = 003675D5
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=306949&amp;user=2981&amp;forum_n=5&amp;topic=20031.html&amp;page=0&amp;anchor=2" class="addthx" data-post="306949"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]StarXruk[/b]','')">StarXruk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.08'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=32258">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июня 2012 21:35 <br><script type="text/javascript">QU('StarXruk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StarXruk" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20031.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Ну вот в отладчике загружен этот фрагмент:<br><img src="http://ic.pics.livejournal.com/svinovod2012/49577432/6470/original.png" border="0" align="" alt=""><br>Судя по всему ОЕР=003675B4-00330000=000375B4<br>Загружаем ImpRec:<br><img src="http://s1.pixant.ru/05/epicfail.jpg" border="0" align="" alt=""><br>И почему-то ничего не находит
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306951&amp;user=32258&amp;forum_n=5&amp;topic=20031.html&amp;page=0&amp;anchor=3" class="addthx" data-post="306951"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июня 2012 21:41 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20031.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Значит GeTaOEP  нашла неверный OEP
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=306952&amp;user=2981&amp;forum_n=5&amp;topic=20031.html&amp;page=0&amp;anchor=4" class="addthx" data-post="306952"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=21572" title="12-06-2012 11:04, ранг:43.2" target="_blank">hlmadip</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июня 2012 21:47 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20031.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
ну вот <strike>нах</strike> накой сюда скрины цеплять? <img src="img/smilies/s10.gif" alt=""><br>можно ведь просто скопировать нужный участок и оформить тегом кода<br><br>во-первых, OEP находится там, где вызывается процедура, на которой у тебя открыт отладчик<br>во-вторых, IAT далеко не всегда можно найти автоматически. посмотри, где у тебя начало блока<br>с адресами импорта и впиши всё ручками <img src="img/smilies/s3.gif" alt=""><br><br><b>Flint</b><br>не, OEP походу правильный (почти, чуть назад надо вернуться)<br>стандартный код для MSVC++ 8.0<br>/ADD: упс, и то верно. забыл, что это длл.<img src="img/smilies/s15.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306953&amp;user=26242&amp;forum_n=5&amp;topic=20031.html&amp;page=0&amp;anchor=5" class="addthx" data-post="306953"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июня 2012 21:58 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20031.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>во-первых, OEP находится там, где вызывается процедура, на которой у тебя открыт отладчик </I><br>OEP длл это начало DllMain, где практически всегда есть проверка на DLL_PROCESS_ATTACH, что в отладчике выглядит как CMP DWORD PTR SS:[EBP+C],1
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=306954&amp;user=2981&amp;forum_n=5&amp;topic=20031.html&amp;page=0&amp;anchor=6" class="addthx" data-post="306954"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=32258" title="10-06-2012 20:27, ранг:0.2" target="_blank">StarXruk</a>, <a href="action=userinfo&user=31971" title="10-06-2012 20:27, ранг:1.4" target="_blank">Svinovod</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]StarXruk[/b]','')">StarXruk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.08'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=32258">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июня 2012 22:12 <br><script type="text/javascript">QU('StarXruk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StarXruk" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20031.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>Flint пишет:<br>OEP длл это начало DllMain, где практически всегда есть проверка на DLL_PROCESS_ATTACH, что в отладчике выглядит как CMP DWORD PTR SS:[EBP+C],1 </I><br>Нет такого,вот только что есть:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">*</span>&nbsp;Referenced&nbsp;by&nbsp;a&nbsp;<span class="hl_char">(</span>U<span class="hl_char">)</span>nconditional&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;<span class="hl_char">(</span>C<span class="hl_char">)</span>onditional&nbsp;Jump&nbsp;at&nbsp;Address<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_char">|</span><span class="hl_char">:</span><span class="hl_number">10008E14</span><span class="hl_char">(</span>C<span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_char">|</span></li><li class="hl_l1"><span class="hl_char">:</span><span class="hl_number">10008ECD</span>&nbsp;<span class="hl_number">897D0C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">0C</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">*</span>&nbsp;Referenced&nbsp;by&nbsp;a&nbsp;<span class="hl_char">(</span>U<span class="hl_char">)</span>nconditional&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;<span class="hl_char">(</span>C<span class="hl_char">)</span>onditional&nbsp;Jump&nbsp;at&nbsp;Address<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_char">|</span><span class="hl_char">:</span><span class="hl_number">10008F0F</span><span class="hl_char">(</span>U<span class="hl_char">)</span></li><li class="hl_l1"><span class="hl_char">|</span></li><li class="hl_l0"><span class="hl_char">:</span><span class="hl_number">10008ED0</span>&nbsp;<span class="hl_number">837D0C00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">0C</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l1"><span class="hl_char">:</span><span class="hl_number">10008ED4</span>&nbsp;<span class="hl_number">763B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jbe</b></span>&nbsp;<span class="hl_number">10008F11</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=306955&amp;user=32258&amp;forum_n=5&amp;topic=20031.html&amp;page=0&amp;anchor=7" class="addthx" data-post="306955"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июня 2012 22:21 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20031.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>StarXruk</b><br>а теперь от этого места вверх ищи конструкцию вида<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li>        </ol>
    </div>
</div></div>
<br>это и будет ОЕП<br><br>btw. а чем запаковано-то хоть?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306957&amp;user=26242&amp;forum_n=5&amp;topic=20031.html&amp;page=0&amp;anchor=8" class="addthx" data-post="306957"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]StarXruk[/b]','')">StarXruk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.08'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=32258">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июня 2012 22:42 &middot; Поправил: StarXruk <br><script type="text/javascript">QU('StarXruk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StarXruk" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20031.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Выше есть вот что:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">:</span><span class="hl_number">10008DA0</span>&nbsp;<span class="hl_number">55</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_char">:</span><span class="hl_number">10008DA1</span>&nbsp;<span class="hl_number">8BEC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li>        </ol>
    </div>
</div></div>
<br>Но на адресе 338DA0 бряк не срабатывает и IAT не ищется. <br><I>-=AkaBOSS=- пишет:<br>а чем запаковано-то хоть?  </I><br><b>Frontline Protect Technology Starforce 4.70.8.0 Pro</b><br>В аттаче сама библиотека,а вот дамп:<br><noindex><a href="http://depositfiles.com/files/1ceh30yh5" rel="nofollow" target="_blank">http://depositfiles.com/files/1ceh30yh5</a></noindex><br><br><img src="img/attach.gif" alt=""> <a href="./files/9a89_10.06.2012_EXELAB.rU.tgz">9a89_10.06.2012_EXELAB.rU.tgz</a> - EventsLib.dll
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306958&amp;user=32258&amp;forum_n=5&amp;topic=20031.html&amp;page=0&amp;anchor=9" class="addthx" data-post="306958"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июня 2012 22:54 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20031.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
StarForce V1.X-V5.X -&gt; StarForce Copy Protection System   * Sign.By.fly [Overlay] *
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=306959&amp;user=2981&amp;forum_n=5&amp;topic=20031.html&amp;page=0&amp;anchor=10" class="addthx" data-post="306959"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]StarXruk[/b]','')">StarXruk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.08'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=32258">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июня 2012 22:58 &middot; Поправил: StarXruk <br><script type="text/javascript">QU('StarXruk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StarXruk" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20031.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Смысл здесь в том,что проверку диска переместили из exe-файла в эту библиотеку.Если распаковать сам исполняемый файл,восстановить импорт - он запускается,но проверяет диск.<br>Поэтому,нужно распаковать dll - для этого надо найти точку входа DllEntryPoint.<br>Откуда я узнал,что проверка в этой библиотеке? Да очень просто,по наличию секции .sforce3 ,которая однозначно говорит о том что файл упакован Старфорсом.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306960&amp;user=32258&amp;forum_n=5&amp;topic=20031.html&amp;page=0&amp;anchor=11" class="addthx" data-post="306960"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июня 2012 23:07 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20031.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
дык писал уже:<br><I>-=AkaBOSS=- пишет:<br>посмотри, где у тебя начало блока<br>с адресами импорта и впиши всё ручками  </I><br><br>у тебя на скрине явно видны команды вида<br> jmp dword ptr ds:[xxxxxxxx]<br>и<br> call dword ptr ds:[xxxxxxxx]<br><br>найди в дампе один из этих адресов, и просмотри вверх, где он начинается<br>вычисли RVA этого адреса и введи его в поле RVA в импрек<br>после просмотри вниз, где этот блок кончается...<br>вычти из большего меньшее, получишь размер<br>введешь его в поле Size в импрек, нажмешь Get Imports<br><br><br><I>StarXruk пишет:<br>проверку диска переместили из exe-файла в эту библиотеку </I><br>нет, просто на неё тоже навесили Старфорс, и она тоже грузит protect.dll, которая<br>уже работает с дровами и проверяет диск<br><br><I>StarXruk пишет:<br>надо найти точку входа DllEntryPoint. </I><br>дык, нашли ж уже<br>то, что там ничего не останавливается, еще ничего не значит<br>стар мог скопировать часть кода и выполнить его гдето в другом месте
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306961&amp;user=26242&amp;forum_n=5&amp;topic=20031.html&amp;page=0&amp;anchor=12" class="addthx" data-post="306961"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=32258" title="10-06-2012 20:26, ранг:0.2" target="_blank">StarXruk</a>, <a href="action=userinfo&user=31971" title="10-06-2012 20:27, ранг:1.4" target="_blank">Svinovod</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июня 2012 23:32 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20031.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Не досидел в бане 23 дня, исправлено.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=306962&amp;user=1556&amp;forum_n=5&amp;topic=20031.html&amp;page=0&amp;anchor=13" class="addthx" data-post="306962"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31971" title="10-06-2012 20:27, ранг:1.4" target="_blank">Svinovod</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как найти OEP для запакованной библиотеки DLL</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=20031" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
