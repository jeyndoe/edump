<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Статическая трассировка кода - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем привет, Изучаю x86 драйвер, он защищен с помощью vmp Случай достаточно простой, только некоторые функции мутированы (обфусцированы?), даже нет внешней упаковки Для того чтобы посмотреть обфускацию целиком, нужна трасса от и">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Статическая трассировка кода</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 декабря 2017 18:39 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Всем привет,<br>Изучаю x86 драйвер, он защищен с помощью vmp<br>Случай достаточно простой, только некоторые функции мутированы (обфусцированы?), даже нет внешней упаковки<br>Для того чтобы посмотреть обфускацию целиком, нужна трасса от и до<br>Дебажить его у меня нет возможности, да и вообще хочу попробовать сделать это статически<br>Возможно идея глупая, но что если написать упрощенный процессор с обработкой нужных инструкций (операции стека, прыжки, вызовы), который бы &quot;выполнял&quot; код до тех пор пока не встретиться выход из функции<br>Правда не ясно что делать c вызовами API, stdcall мы же очищаем стек, но вот с другими соглашениями?<br>Дело даже не в проте, а вообще в целом<br>Я пыталась делать парсер конкретных команд под конкретный прот, но дело в том, что это не возможно реализовать, ибо число нелогичных приемов может быть очень большое, поэтому нужно спуститься на самый нижний уровень, для того чтобы выполнять код как сам процессор это делает<br>Возможно кто-то даст дельный совет, может кто-то уже делал подобное?<br>Так же я пыталась найти псевдо-код, как процессор выполняет команды, т.к. вмпрот любит использовать редкие команды, может у кого то есть линки?<br>Спасибо
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380866&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=1" class="addthx" data-post="380866"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]SegFault[/b]','')">SegFault</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 44.8 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.95'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29820">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 декабря 2017 18:44 <br><script type="text/javascript">QU('SegFault','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SegFault" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
google: symbolic execution. Есть вполне рабочие движки на руби, питоне, жабе, и даже нативные
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380867&amp;user=29820&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=2" class="addthx" data-post="380867"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40448" title="11-12-2017 16:28, ранг:15.9" target="_blank">Boostyq</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 декабря 2017 19:01 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>SegFault</b><br><br>Как вы себе представляете кернел код на питоне <img src="img/smilies/s5.gif" alt=""> ?<br><br>Это сразу сломает ось, это вообще возможно запустить в км в принципе ?<br><br>&gt; Так же я пыталась найти псевдо-код, как процессор выполняет команды<br><br>Тоесть получается что вы не знаете что псевдокод описан в манах по архитектуре, тоесть их никогда не видели(основы). Тогда вы эту задачу решить не сможите, если не знаете базовую архитектуру. В таком случае как можно пытаться снять кернел протектор, это невозможно. У вас скилл не достаточный для данной работы.<br><br>&gt; Возможно идея глупая, но что если написать упрощенный процессор с обработкой нужных инструкций <br><br>Виртуальную машину, а точнее визор - да, это способ.)
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380868&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=3" class="addthx" data-post="380868"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 декабря 2017 19:10 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Тоесть получается что вы не знаете что псевдокод описан в манах по архитектуре, тоесть их никогда не видели(основы). Тогда вы эту задачу решить не сможите, если не знаете базовую архитектуру. В таком случае как можно пытаться снять кернел протектор, это невозможно. У вас скилл не достаточный для данной работы. </I><br>Спасибо за ответ<br>Я не спорю, что знания совсем не полные, я за обучение в процессе<br>Но мне кажется я недостаточно верно выразилась<br>Я не собираюсь эмулировать код, исполнять его как либо, а лишь написать инструмент, который проследит маршрут кода от и до<br>Архитектура только x86, как основной инструмент ида с питоном<br>И конечно я понимаю инструкции, но мне гораздо проще читать например код, чем документацию, т.е. не &quot;retn - возврат&quot;, а &quot;eip = *(uint32_t *)esp; esp += 4;&quot;<br>Конечная цель лишь получение трассы от и до у конкретной функции, для дальнейшего статического анализа
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380869&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=4" class="addthx" data-post="380869"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 декабря 2017 19:19 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>Boostyq</b><br><br>А в чём тогда проблема ?<br>Ставите ловушку и накапливайте лог в бд. С чем именно проблема ?<br>Как установить ловушку ?<br>Понятно что получится бд огромного размера и она будет бесполезной, но задача как я понял просто снять трассу.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380870&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=5" class="addthx" data-post="380870"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 389thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 декабря 2017 20:55 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
На основании чeго будут выполняться ветвления?<br><br>Это абсурд.<br><br>И название темы дурацкое - как трассировка может быть статической?<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380871&amp;user=35473&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=6" class="addthx" data-post="380871"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40819" title="11-12-2017 18:30, ранг:12.4" target="_blank">gggeorggge</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 декабря 2017 21:17 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>dosprog пишет:<br>На основании чeго будут выполняться ветвления?<br><br>Это абсурд. </I><br><br>Привет<br>Ничего не должно исполнятся<br>Суть в том, чтобы сохранить трассу для конкретной функции со всеми ветвлениями<br>Просто протекторы часто мешают кусочки кода и сложно по ним ориентироваться, где-то они разбросаны по доп. секции, так же бывает, что одни и те же участки используются несколькими защищенными функциями, однако если будет цельная трасса, можно это как-то изучать
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380872&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=7" class="addthx" data-post="380872"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 декабря 2017 22:00 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Boostyq пишет: Ничего не должно исполнятся </I><br><br>Самый простой вариант, это берете эмулятор, самый обычный хоть на базе capstone и к эмулятору добавляете ядерные заглушки, есть и статические альтернативы dbi, но там много кодить, очень много.<br>Настраиваете контекст и эмулируете необходимую вам функцию. Можно допилить pintrace.<br>Проект от которого можно оттолкнуться https://github.com/marcusbotacin/BranchMonitoringProject<br>если что то совсем простое, как выше уже писали сойдет symbolic execution.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380875&amp;user=41575&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=8" class="addthx" data-post="380875"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40448" title="11-12-2017 19:38, ранг:15.9" target="_blank">Boostyq</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 01:09 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Тут аналогичная задача, только немного для иных целей <noindex><a href="http://www.rohitab.com/discuss/topic/42331-antimemory-scanner-bypassing-nod32-memory-scan/page-4" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>Ну как я и говорил, почему не поставить обычную ловушку и трассировать через классический TF/branch trace не понятно. В км прикрутить классические дби врядле получится, оно всё еле ровно в юм работает <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380878&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=9" class="addthx" data-post="380878"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 02:43 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>Boostyq пишет:</b><br><br><i class=x>Возможно идея глупая, но что если написать упрощенный процессор с обработкой нужных инструкций (операции стека, прыжки, вызовы), который бы &quot;выполнял&quot; код </i><br>И<br><i class=x>Я не собираюсь эмулировать код, исполнять его как либо</i><br><br>Воу-воу, так будет эмуляция или нет?<br><br><i class=x>Для того чтобы посмотреть обфускацию целиком, нужна трасса от и до</i><br><br>От начала функции и до её конца? После вмпрота? О, ну тогда у меня для вас плохие новости.<br><br>Правильно Клерк пишет - не будет такая эмуляция работать. Вы забываете, что в ядре есть много своего АПИ, есть свои структуры и даже fs указывает совсем не туда, куда в юзермоде. Всё ядро будете эмулировать?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380879&amp;user=6336&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=10" class="addthx" data-post="380879"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 03:02 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>ARCHANGEL</b><br><br>Задача ведь в выделении кода, целиком процедур. Для этого нужно найти точки входа, исходные адреса для формирования cfg. Трассировка это лишь способ получить эти входы, причём она обеспечивает хорошее покрытие.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380880&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=11" class="addthx" data-post="380880"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 03:32 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>ARCHANGEL пишет: Всё ядро будете эмулировать?  </I><br><br>чем вариант pemu плох? api совместимо с pin. <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380881&amp;user=41575&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=12" class="addthx" data-post="380881"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 08:29 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Для этого нужно найти точки входа, исходные адреса для формирования cfg. Трассировка это лишь способ получить эти входы, причём она обеспечивает хорошее покрытие. </I><br>При пакетной виртуализации функций это дохлый номер. Вы никогда не найдете реальную точку входа в функцию, т.к. её просто нет - каждая вызываемая функция исполняется внутри вм без выхода из неё.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380883&amp;user=20406&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=13" class="addthx" data-post="380883"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=2585" title="12-12-2017 08:13, ранг:1044.7" target="_blank">Gideon Vi</a>, <a href="action=userinfo&user=14629" title="12-12-2017 08:45, ранг:478.3" target="_blank">sendersu</a>, <a href="action=userinfo&user=17319" title="18-12-2017 15:12, ранг:482.9" target="_blank">VodoleY</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 11:46 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
То что дал SegFault полезно, только как я поняла, проблема в том, что нужны входные данные и в зависимости от них, каждый условный прыжок пойдет по одному из 2 вариантов<br>В то время как мне нужны все ветви, т.е. весь код который может исполнятся при вызове данной функции<br>Я понимаю, что там могут быть обманные прыжки в никуда, которые никогда не выполняются, но этого я пока не вижу, я делаю это для простой обфускации<br>Вообще тема сложная для меня, и я хочу начать хотя бы с этого<br>Поэтому пробую писать скрипт для иды, который управляет стеком, работает с esp, ebp (остальные регистры наверное тоже придется добавить), следит за eip до тех пор пока точка выхода не будет после вызова<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00013978</span>&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>ecx</b></span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;здесь&nbsp;начинаем</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00013979</span>&nbsp;<span class="hl_number">018</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001397A</span>&nbsp;<span class="hl_number">01C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;Protected2&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;тут&nbsp;код&nbsp;уходит&nbsp;в&nbsp;доп<span class="hl_char">.</span>&nbsp;секцию</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001397F</span>&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_1398A&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_char">&gt;</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;здесь&nbsp;останавливаемся</li>        </ol>
    </div>
</div></div>
<br>Я понимаю, что при полной защите вмп все гораздо сложнее, но в моем случае только обфускация<br>Вот почему я не говорю эмуляция, это просто трассировка кода
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380887&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=14" class="addthx" data-post="380887"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 12:17 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>Boostyq пишет:<br>.text:0001397A 01C                 call    Protected2 // тут код уходит в доп. секцию </I><br>А кто сказал что это вызов функции? В вмпроте практически любой call сначала надо рассматривать как jmp и анализировать код дальше и только если будет из него возврат на следующую инструкцию или он ссылается на чистый код в программной секции, то это call.<br><I>Boostyq пишет:<br>но в моем случае только обфускация </I><br>Если функи только обфусцированы и отсутствует виртуализация, то такой код очень просто восстанавливается из под вмпрота руками и головой.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380888&amp;user=20406&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=15" class="addthx" data-post="380888"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 12:24 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>Vamit пишет:<br>А кто сказал что это вызов функции? В вмпроте практически любой call сначала надо рассматривать как jmp и анализировать код дальше и только если будет из него возврат на следующую инструкцию или он ссылается на чистый код в программной секции, то это call. </I><br>Именно поэтому я пытаюсь написать трейсер, потому что у вмпрота слишком много трюков которые неочевидны<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Вызов&nbsp;PsGetCurrentProcessId<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_char">.</span>MMQ0<span class="hl_char">:</span><span class="hl_number">00026F2A</span>&nbsp;<span class="hl_number">00C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>PsGetCurrentProcessId</li><li class="hl_l0"><span class="hl_char">.</span>MMQ0<span class="hl_char">:</span><span class="hl_number">00026F30</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">44</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>MMQ0<span class="hl_char">:</span><span class="hl_number">00026F34</span>&nbsp;<span class="hl_number">00C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_char">.</span>MMQ0<span class="hl_char">:</span><span class="hl_number">00026F35</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">bh</span></li><li class="hl_l1"><span class="hl_char">.</span>MMQ0<span class="hl_char">:</span><span class="hl_number">00026F39</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">dx</span></li><li class="hl_l0"><span class="hl_char">.</span>MMQ0<span class="hl_char">:</span><span class="hl_number">00026F3D</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">48</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>MMQ0<span class="hl_char">:</span><span class="hl_number">00026F41</span>&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>retn</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">52</span></li><li class="hl_l0">Прыжок<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_char">.</span>MMQ0<span class="hl_char">:</span><span class="hl_number">00026EDC</span>&nbsp;<span class="hl_number">004</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>MMQ0<span class="hl_char">:</span><span class="hl_number">00026EDF</span>&nbsp;<span class="hl_number">008</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">30h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>MMQ0<span class="hl_char">:</span><span class="hl_number">00026EE3</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">28</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_41076</li><li class="hl_l0"><span class="hl_char">.</span>MMQ0<span class="hl_char">:</span><span class="hl_number">00026EE8</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">28</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">stc</span></li>        </ol>
    </div>
</div></div>
<br>Однако тут я точно уверена, так как этот кусочек кода находится в нормальной функции, а уже при вызове уходит в секцию прота
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380889&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=16" class="addthx" data-post="380889"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 12:27 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>shellstorm</b><br><br>Вы об этом <noindex><a href="https://github.com/utds3lab/pemu" rel="nofollow" target="_blank">--&gt; pemu &lt;--</a></noindex> ?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380890&amp;user=6336&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=17" class="addthx" data-post="380890"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 12:36 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>Boostyq пишет:<br>Однако тут я точно уверена, так как этот кусочек кода находится в нормальной функции, а уже при вызове уходит в секцию прота </I><br>Вы ошибаетесь, т.к. вмпрот присутствует не только в своих секциях, но и во всех других секциях вместо кусков сожранных им.<br>Приведенный вами код это обфусцированный вызов апи функции PsGetCurrentProcessId
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380891&amp;user=20406&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=18" class="addthx" data-post="380891"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 12:43 <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>Vamit пишет:<br>Вы ошибаетесь, т.к. вмпрот присутствует не только в своих секциях, но и во всех других секциях вместо кусков сожранных им.<br>Приведенный вами код это обфусцированный вызов апи функции PsGetCurrentProcessId  </I><br>Спасибо, уже установлено <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380892&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=19" class="addthx" data-post="380892"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 14:42 &middot; Поправил: shellstorm <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>ARCHANGEL пишет: Вы об этом --&gt; pemu &lt;-- ?  </I><br><br>Да, этот, есть еще варианты с виртуализацией.<br><br><I>Boostyq пишет: проблема в том, что нужны входные данные и в зависимости от них, каждый условный прыжок пойдет по одному из 2 вариантов </I><br><br>Эта задача относится к фаззингу (при неизвестных входящих параметрах) и покрытию кода.<br>У этого чувака http://shell-storm.org/ (автор triton) доходчиво и доступно рассмотрены эти квесты.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380896&amp;user=41575&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=20" class="addthx" data-post="380896"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=26261" title="22-01-2019 05:50, ранг:23.2" target="_blank">bartolomeo</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 15:02 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>shellstorm пишет:<br>Эта задача относится к фаззингу (при неизвестных входящих параметрах) и покрытию кода.<br>У этого чувака http://shell-storm.org/ (автор triton) доходчиво и доступно рассмотрены эти квесты.  </I><br>Вы имеете ввиду исполнять тритоном с указанием параметров, но множество раз и случайными?
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380897&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=21" class="addthx" data-post="380897"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 15:11 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>Boostyq пишет: Вы имеете ввиду исполнять тритоном с указанием параметров, но множество раз и случайными? </I><br><br>Нет, имею ввиду, что там есть теория с практическими примерами использования symbolic execution, dbi, etc.<br>Сложность заключается в падениях, вы хотите покрыть все ветви кода, но не все из них рабочие, а движки не боги писали, падают, поэтому нужно пилить систему откатов с сохранением промежуточных результатов.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380898&amp;user=41575&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=22" class="addthx" data-post="380898"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 18:18 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<b>Vamit</b><br><br>Имелось ввиду точки входа в любой исполняемый код(который исполняет cpu), будь там хеловорд, драйвер или вм, разницы нет. Да и вспомните как задача в которой вы участвовали была решена(тот самый вмпрот) - визор выделил(накопил) EP, на основе их через конструктор был сформирован cfg, к нему применена свёртка и на выхлопе массив ваших вм обработчиков, не смотря на огромное число выборок <img src="img/smilies/s1.gif" alt=""><br><br><b>shellstorm</b><br><br>На 86 есть весьма быстрые и стабильные моторы, так что думаю принципиально реализация не проблема вовсе. Думаю просто вы и тс не знаете с чего начать, не видите общей картины <img src="img/smilies/s2.gif" alt="">
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380906&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=23" class="addthx" data-post="380906"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 18:39 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>difexacaw пишет: На 86 есть весьма быстрые и стабильные моторы </I><br><br>Например? Только плиз, без ваших моторов. <img src="img/smilies/s1.gif" alt=""> Не знаю ни одного стабильного движка, а знаю их много. Вот здесь уточню, речь не о частичном покрытии, а о полном, оно в свою очередь зависит от множества факторов, частично проблемы с неполными данными можно решить через фаззинг или посредством солвера, но на это требуется огромное количество времени.<br>В качестве примера приведу псевдокод:<br>hash = hash_data(read_user_data_value());<br>if hash == hash_function()<br>{<br>     address = function_decrypt();<br>     goto address;<br>}<br>в расшифрованной функции может быть куча ветвлений, но здесь есть зависимость от данных и динамического исполнения. Частичное покрытие сделать не сложно, но ТС хочет полное.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380908&amp;user=41575&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=24" class="addthx" data-post="380908"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 18:48 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>shellstorm</b><br><br>Ну а чем вам тот же кайт не устраивает(конструктор/билдер), это хороший 86 мотор. Их не так много, что бы выбирать. Да, я не использовал AVL деревья, обычные списки для работы с cfg. Но даже без этого, это весьма шустрый мотор, который не крешит и в км. Это просто как пример, что давно есть стабильные обкатанные моторы. И для трассировки например то же. Полноценные решения. При желании это всё собирается быстро и отлаживается без проблем.<br><br>Но тут вопрос в ином имхо. Нужно общее понимание, механизм, какие иснтрументы и для чего. Этого всего нет. А поэтому не имея опыта что то собрать врядле получится. А пилить визоры и конструкторы для км по мойму затея в данном случае провальная.<br><br><b>Добавлено спустя 4 минуты</b><br><b>shellstorm</b><br><br>&gt; в расшифрованной функции может быть куча ветвлений, но здесь есть зависимость от данных и динамического исполнения.<br><br>Визор/трассировка даёт локальный cfg, тоесть EP для построения полного возможного графа конструктором. Всё что не включено в динамик и как следствие статик cfg не относится к работе апп, это не вызывается и не используется, например часть индекса массива векторов, которая никогда не вызывается, а таким образом не нужна и исключается. В случае вмп это и не нужно.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380909&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=25" class="addthx" data-post="380909"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 19:05 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>difexacaw пишет: Визор/трассировка даёт локальный cfg, тоесть EP для построения полного возможного графа конструктором </I><br><br>Это не то, для построения подобной карты в IDA полно скриптов в том числе есть и заточенные для анализа VM, но это частичное покрытие, но в коде встречаются и jmp reg, что с этим делать при неполных данных? <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380912&amp;user=41575&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=26" class="addthx" data-post="380912"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40990" title="12-12-2017 16:15, ранг:165.6" target="_blank">difexacaw</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 19:14 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>shellstorm</b><br><br>А причём тут ида, это унылый юм парсер. jmp reg я выше описал. Лайкну вам за то, что у нас одинаковый ход мыслей.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380913&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=27" class="addthx" data-post="380913"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 19:20 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<I>difexacaw пишет: А причём тут ида, это унылый юм парсер.  </I><br><br>ТС пишет: Архитектура только x86, как основной инструмент ида с питоном.<br>В данной задаче IDA это UI с батарейками, а сам движок можно подключить любой, хоть ваш кайт, подключив его к трассировочным интерфейсам IDA.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380914&amp;user=41575&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=28" class="addthx" data-post="380914"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 19:39 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<b>shellstorm</b><br><br>Короче говоря, посмотрим что получится, но а пока я не вижу предмета или задачи для обсуждения <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380915&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=29" class="addthx" data-post="380915"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 декабря 2017 19:59 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<I>difexacaw пишет:<br>А причём тут ида, это унылый юм парсер. jmp reg я выше описал. Лайкну вам за то, что у нас одинаковый ход мыслей.  </I><br>Он будет рассчитан верно, если на его генерацию не влияют входные данные<br>Я пока не буду много говорить, не хочу показаться глупой<br>Получится - хорошо, если нет - то просто плюс к знанию ассемблера<br>А так, трейсер поддерживает чтение из стека/дб и запись в стек, скоро буду тестировать, но очень много вариаций инструкций, нужны не все, но многие<br>---<br>Такс, ида дает неплохой апи по дизасму, но отвратительный при работе с выражениями типа [ebp+ecx-2C4h]<br>Реализовала обработку простых команд JMP, J*, CALL, RET, PUSH, POP, но описать даже одну команду ADD с таким апи сложно<br>Вообщем буду искать движок способный работать с этим проще, или писать что-то свое, чтобы любое выражение просто преобразовывалось в виртуальный адрес и если он относится к виртуальному стеку/статическому адресу/контексту, то записывать/читать в соответствующем месте
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380919&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=0&amp;anchor=30" class="addthx" data-post="380919"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Статическая трассировка кода</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="24981">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24981" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
