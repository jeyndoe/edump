<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Странный UPX. Помогите советом - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Есть прога - DosPrn (h**p://webfile.ru/508819 - 320Kb) exe-шник упакован (по мнению PEiD&#039;а, да и на глаз очень похоже) UPX&#039;ом. Названия секций: ALLA; BETA;  .rsrc Хотя распаковка UPX&#039;а для меня не проблема, но">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=7823'>ManHunter</a>, <a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a>, <a target='_blank' href='?action=userinfo&amp;user=55853'>rtsgreg1989</a> (+9 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Странный UPX. Помогите советом</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 10:09 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Есть прога - DosPrn  (h**p://webfile.ru/508819 - 320Kb)
<br>exe-шник упакован (по мнению PEiD&#039;а, да и на глаз очень похоже) UPX&#039;ом.
<br>Названия секций: ALLA;  BETA;   .rsrc
<br>Хотя распаковка  UPX&#039;а для меня не проблема, но возникли две траблы:
<br>1. Дамп снимается, но не могу восстановить импорт, ни руками, 
<br>   ни при помощи различных утилит<img src="img/smilies/s9.gif" alt="">
<br>2. Ладно, хотел сделать инлайн патч. Но при добавлении пары строк кода на 
<br>   точке перехода к ОЕР, прога вывливается тут:
<br>
<br>;************************ Код пакера *************************
<br><pre>
001E821C  89F9            MOV ECX, EDI
001E821E  57              PUSH EDI
001E821F  48              DEC EAX
001E8220  F2:AE           REPNE SCAS BYTE PTR ES:[EDI]
001E8222  55              PUSH EBP
001E8223  FF96 78940E00   CALL DWORD PTR DS:[ESI+E9478]     ; KERNEL32.GetProcAddress
001E8229  09C0            OR EAX, EAX               ; EAX = 0, а в непатченой адрес API  
001E822B  74 07           JE SHORT 001E8234             ;прыгает на екзит процес   
001E822D  8903            MOV DWORD PTR DS:[EBX], EAX
001E822F  83C3 04         ADD EBX, 4
001E8232  EB E1           JMP SHORT 001E8215
001E8234  FF96 7C940E00   CALL DWORD PTR DS:[ESI+E947C]     ;ExitProcess
001E823A  83C7 04         ADD EDI, 4
001E823D  8D5E FC         LEA EBX, DWORD PTR DS:[ESI-4]</pre>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35096&amp;user=423&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=1" class="addthx" data-post="35096"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]6aHguT[/b]','')">6aHguT</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/1126.jpg" alt=""><br><span class=txtSm>Ранг: 70.5 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.46'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1126">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 10:47 &middot; Поправил: 6aHguT <br><script type="text/javascript">QU('6aHguT','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=6aHguT" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Я не спец могу и ошибаться, но тут помоему проверка селостности 
<br><pre>001E821C  89F9            MOV ECX, EDI
001E821E  57              PUSH EDI
001E821F  48              DEC EAX
001E8220  F2:AE           REPNE SCAS BYTE PTR ES:[EDI]
001E8222  55              PUSH EBP
001E8223  FF96 78940E00   CALL DWORD PTR DS:[ESI+E9478]     ; KERNEL32.GetProcAddress
001E8229  09C0            OR EAX, EAX               ; EAX = 0, а в непатченой адрес API  
001E822B  74 07           JE SHORT 001E8234    ; попробуй тут jne втулить
</pre>    
<br>Что-то неприпомню что UPX так делал ....<img src="img/smilies/s13.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35101&amp;user=1126&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=2" class="addthx" data-post="35101"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 11:30 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<i>6aHguT пишет:
<br>001E822B  74 07           JE SHORT 001E8234    ; попробуй тут jne втулить </i>
<br>
<br>Не прокатит. В EAX должен быть адрес API функции, а тут ноль<img src="img/smilies/s14.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35110&amp;user=423&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=3" class="addthx" data-post="35110"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 11:41 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>crc1</b>
<br>Уже тыщу раз писалось, как вручную определять начало таблицы импорта, тыб хоть статью MozgC прочитал что ли. Все распаковывается нормально. Что до инлайна - тоже нормально инлайнится, т.к. это простой UPX.
<br>Ну и сразу скажу про эту прогу - наскоком пропатчить ее неудастся, прога будет потом жутко глючить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35111&amp;user=24&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=4" class="addthx" data-post="35111"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 13:33 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Вопрос по восстановлению импорта снимается.  Тормознул я<img src="img/smilies/s14.gif" alt="">
<br>Ну а
<br><i>Ara пишет:
<br>Что до инлайна - тоже нормально инлайнится </i>
<br>не получается.
<br>На переходе к ОЕР я пишу:
<br><pre>
:001E8266                   add edi, 00000002
:001E8269                    jmp 001E824D
:001E826B                      popad
:001E826C           mov byte ptr [00XXXXXX], EB         ;Меняю три байта
:001E8273           mov byte ptr [00XXXXXX], 00
:001E827A           mov byte ptr [00XXXXXX], EB
:001E8281               push 001AB588                           ;   =&gt; OEP
:001E8286                       ret
</pre>
<br>При запуске выдает это
<br>&quot;Ошибка инициализации приложения (0хс0000017) Для выхода...&quot;
<br><i>Ara пишет:
<br> наскоком пропатчить ее неудастся, прога будет потом жутко глючить. </i>
<br>А нельзя чуть поподробнее...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35130&amp;user=423&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=5" class="addthx" data-post="35130"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 15:27 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>crc1</b>
<br>Какой-то кривой у тебя инлайн.
<br>
<br><i>crc1 пишет:
<br>А нельзя чуть поподробнее... </i>
<br>Неа, сама прога стоит копейки какие-то, мучаться с ней лень было <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35137&amp;user=24&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=6" class="addthx" data-post="35137"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 17:09 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<i>Ara пишет:
<br>Какой-то кривой у тебя инлайн. </i>
<br>В чем кривизна?
<br>Это же форум. Ты гордо называешься - наставник, дык наставь на путь истинный<img src="img/smilies/s5.gif" alt="">
<br>И потом, откуда ты взял, что
<br><i>Ara пишет:
<br>прога будет потом жутко глючить </i>, если <i>мучаться с ней лень было </i>
<br>В чем глюки если не секрет
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35147&amp;user=423&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=7" class="addthx" data-post="35147"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Asterix[/b]','')">Asterix</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 450.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.26<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=58">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 17:15 &middot; Поправил: Asterix <br><script type="text/javascript">QU('Asterix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Asterix" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Мля, у меня что-то с глазами, топик то про UPX, sorry не то запостил
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35149&amp;user=58&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=8" class="addthx" data-post="35149"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 18:17 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>Asterix</b>
<br>Спасибо за мини-тутор, но в моем случае <b>исполняемый файл</b>. Упакован UPX
<br>Переход на ОЕР фиксированный: jmp 001AB588
<br>Адреса постоянные. Почему не получается поменять на переходе к ОЕР три байта в памяти?
<br>После изменений прога даже в ОЛЮ не грузится, вылетает с ошибкой <img src="img/smilies/s9.gif" alt="">
<br>ЗЫ. To all
<br>Опять к импорту. Под ХР восстановил ипреком импорт. Прога запустилась. Гуд
<br>Перегрузился под 2К. Распакованная прога падает с ошибкой &quot;Порядковый номер 878 не найден
<br>в библиотеке DLL kernel32.dll&quot;. Восстановил импорт под 2К, все заработало 
<br>В обоих случаях ОЕР и RVA  в импрек вставлял одни и теже
<br>Мля, чтобы это значило?<img src="img/smilies/s9.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35154&amp;user=423&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=9" class="addthx" data-post="35154"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 18:24 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>Asterix</b>
<br>Пока ответ писал ты уже и тутор снес. Быстро<img src="img/smilies/s5.gif" alt="">
<br>А зря, поучительная весч для незнающих. Выложи в раздел статьи
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35156&amp;user=423&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=10" class="addthx" data-post="35156"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Asterix[/b]','')">Asterix</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 450.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.26<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=58">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 18:47 <br><script type="text/javascript">QU('Asterix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Asterix" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<i>crc1 пишет:
<br>Опять к импорту. Под ХР восстановил ипреком импорт. Прога запустилась. Гуд 
<br>Перегрузился под 2К. Распакованная прога падает с ошибкой &quot;Порядковый номер 878 не найден 
<br>в библиотеке DLL kernel32.dll&quot;. </i>
<br>
<br>У тебя неправильные настройки ИмпРека, наверное галка стоит на Импорт по ординалам
<br>или что-то в этом роде
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35159&amp;user=58&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=11" class="addthx" data-post="35159"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 19:56 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<i>crc1 пишет:
<br>Почему не получается поменять на переходе к ОЕР три байта в памяти? </i>
<br>Да потомучто ты своим патчем затираешь нужные данные. Сделай JMP _свободное место и там размещай свой патч.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35164&amp;user=24&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=12" class="addthx" data-post="35164"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Grey[/b]','')">Grey</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 389.6 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.93'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=99">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 20:15 <br><script type="text/javascript">QU('Grey','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Grey" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>crc1</b>
<br>А что у тебя с перходом на ОЕП? Почему сначала JMP а потом POPAD? И как ты вообще выходишь на инлайн?
<br><br><font size="1"><i>-----<br>TBR</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35166&amp;user=99&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=13" class="addthx" data-post="35166"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 11:57 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>Ara</b>
<br>Спасибо. 
<br>Сделал длинный джамп на св. место и все поехало<img src="img/smilies/s1.gif" alt="">
<br><b> to Asterix</b>
<br>Глянь в аттаче мои настройки ImportREC и подскажи че не правильно
<br><i>Grey пишет:
<br> Почему сначала JMP а потом POPAD </i>
<br>Потому что так в оригинальном упакованном файле
<br><pre>001E8260  C1E0 10           SHL EAX, 10
001E8263  66:8B07           MOV AX, WORD PTR DS:[EDI]
001E8266  83C7 02           ADD EDI, 2
001E8269  EB E2             JMP SHORT 001E824D
001E826B  61                POPAD
001E826C  E9 37010000       JMP 001E83A8                              ;тут переход на инлайн
001E8271  0000              ADD BYTE PTR DS:[EAX], AL
001E8273  008C82 1E009C82   ADD BYTE PTR DS:[EDX+EAX*4+829C001E], CL
</pre><br><br><img src="img/attach.gif" alt=""> <a href="./files/30bd_OptionImportREC.jpg">30bd_OptionImportREC.jpg</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35206&amp;user=423&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=14" class="addthx" data-post="35206"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Asterix[/b]','')">Asterix</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 450.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.26<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=58">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 16:53 <br><script type="text/javascript">QU('Asterix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Asterix" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>crc1</b>
<br>вроде все по умолчанию, тогда не знаю в чем проблема
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35230&amp;user=58&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=15" class="addthx" data-post="35230"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2005 08:58 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=2838.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Ладно, прикроем тему
<br>Спасибо всем кто откликнулся
<br>С импортом попробую докумкать сам
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35278&amp;user=423&amp;forum_n=1&amp;topic=2838.html&amp;page=0&amp;anchor=16" class="addthx" data-post="35278"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Странный UPX. Помогите советом</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=2838" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
