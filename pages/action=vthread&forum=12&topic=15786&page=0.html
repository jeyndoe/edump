<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Драйвер для ATI 3D RAGE PRO TURBO AGP 2X и реверсинг - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Исследования перешли в реверс драйвера Syser Debugger 1 февраля 2010 года Нашел на одном из ftp-серверов игру Freelancer... Посмотрел системные требования - должна пойти. Поставил, запускаю - критическое предупреждение программы">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/blog.png" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=12&sortBy=0&page=0.html"><b>Дневники и блоги</b></a> <b class=bulletHead>&#8212;&#8250;</b> Драйвер для ATI 3D RAGE PRO TURBO AGP 2X и реверсинг</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=12&amp;topic=15786&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=12&amp;topic=15786&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 февраля 2010 17:46 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
<b>Исследования перешли в реверс драйвера Syser Debugger</b><br><br><b>1 февраля 2010 года</b><br><br>Нашел на одном из ftp-серверов игру Freelancer... Посмотрел системные требования - должна пойти. Поставил, запускаю - критическое предупреждение программы о том, что драйвер видеокарты устарел и рекомендуется его обновить. Попробовал без нового драйвера, в графике много артефактов, в частности луч звезды в космосе отображается в виде нескольких двумерных квадратов с окружностями внутри. Попробовал найти новый драйвер...<br><br><b>2 февраля 2010 года</b><br><br>Найти не удалось ничего новее legacy All-in-wonder rage pro от февраля 2002 года. У меня Windows XP. Видел сборки Windows XP с включенными в них дровами для RAGE PRO 5.10.2613.6010, но по-моему это ошибка - нуль ошибочно заменен на 3...<br><br>Поставил. Результаты значительно лучше в графике. Первый ролик с сюжетом игры был показан без артефактов, да и вообще ролики стали нормально отображаться. Но только ролики. В остальном стало только хуже. Когда заходит дело до отображения текста, то текст невозможно разобрать из-за того, что он мелькает и перемешивается с неведомо по какому алгоритму и откуда берущимися другими текстами и пиктограмками из игры. А иногда можно получить и BSOD...<br><br>Пробовал найти более новый драйвер от сторонних разработчиков. Находил новые, но для Vista и за деньги...<br><br>Нашел еще много информации о том, что ATI не умеет писать драйвера, Линуксоидам очень везет - практически любой драйвер могут собрать(но мне исходники драйвера под никсы ни к чему), попробовал несколько утилит для настройки - все бесполезно....<br><br><b>5 февраля 2010 года</b><br><br>Напрашивалось уже несколько решений<br>1) Забить на все<br>2) Накопить на новую видюху с поддержкой AGP 2X<br>3) Обновить SP до 3<br>4) Поставить вообще Ubuntu<br>5) Заказать драйвер<br>6) Реверс инжиринг существующего драйвера<br><br>Напрашивалась мысль  - &quot;Как же делаются драйвера для Linux? Ведь спецификации видеоадаптеров закрыты. Реверс инжиринг?&quot;<br><br>Поискав в интернете, это частично подтвердилось. Оказалось, что не так уж и мало кодеров копаются во внутренностях закрытых драйверов. Но также наткнулся на официальном сайте, на то, что ATI вроде как поддерживает разработчиков для своих устройств на других ОС. Для себя из их инструментов ничего полезного не нашел...<br><br><b>7 февраля</b><br><br>Все же решился на реверсинг. Но мне нужен инструмент. А у меня в арсенале OllyDbg 1.0 и 2.0 beta, Ida 4.04, WinDbg (глючит окно с листингом). Пробовал SoftIce - вообще не работает, патчи ставил, много чего делал - не помогает. SysDebuger вываливается в BSOD. И вот решил поискать новую Иду с мыслью &quot;а вдруг?&quot; и наткнулся на 5.5. Не поверил своему счастью - сейчас много чего в интернете размешали с г.... примерно 1:100, поэтому внимательно прочитал все посты на форуме cracklab по этой теме. Получив многочисленные подтверждения решил поставить...<br><br>Радость возросла до небес. Вот оно - то, о чем я мечтал и сам хотел написать. В мечтах, конечно, еще взаимосвязи данных, ну да ладно. Такой визуализированный дизассемблер - уже очень круто!!!<br><br><b>8 февраля</b><br><br>Редкие BSOD&#039;ы в игре Freelancer все время ссылались на один и тот же адрес BFA053A6 в модуле ati2drad.dll. Поэтому вполне возможно, что место недоработки драйвера там или в другом драйвере, который обращается к этой функции...<br><br>Место, в котором происходит 5 исключение, содержит инструкцию fld dword ptr [ecx]...<br><br>Посмотрев функцию, сделано несколько выводов:<br>1) алгоритм функции в упрощении сводится, грубо говоря, к следующему<br><br>func(Arg1, Arg2, Arg3, Arg4)<br>{<br>   m = Arg1 + &lt;фикс. смещение&gt;;<br>  Base = Arg2;<br>  Addr1 = Arg3;<br><br>  do<br>  {<br>    x = *(WORD*)Addr1;<br>    y = *(WORD*)(Addr1 + 2);<br>    z = *(WORD*)(Addr1 + 4);<br><br>   xAddr = x * m + Base;<br>   yAddr = y * m + Base;<br>   zAddr = z * m + Base;<br><br>    {<br>      //вычисления при помощи адресов xAddr, yAddr, zAddr<br>      //на какой-то итерации цикла первое же обрашение по одному из адресов<br>      //и вызывает 5 исключение<br>    }<br><br>    Addr1 += Arg4;<br>  }while(&lt;сложная комбинация условий&gt;);<br>}<br><br>2) Возможно параметры какие-то неверно передаются. Проследив кросс-реферинг, выяснил, что это функция имеет ссылку только в памяти в группе адресов. Адрес базы также имеет ссылку на запись, та функция также, докопался до источника адреса - область память динамически выделяется...<br><br><b>10 февраля</b><br><br>3) Нужен все же отладчик, скачал новую версию SysDebugger, буду пробовать<br>4) Нужно с кем-то обсудить. Еле как зарегистрировался на cracklab. :D
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=251260&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=1" class="addthx" data-post="251260"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2010 18:35 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>16 февраля</b><br><br>Syser.Debugger.v1.99.1900.1185 произвольно вываливается в BSOD с кодом 0x7F(8, 0x80042000, 0, 0). Это обстоятельство побудило меня проверить оперативную память и драйвера. Штатной утилитой verifier нашел несколько дров, непроходящих проверку, отключил их. Отключил вообще все дрова от программ, которыми уже давно не пользуюсь, антивирусы, антируткиты. Все то же самое.<br><br>Поиски проблемы с Syser сподвигли проанализировать crash dump. 0x7F с кодом исключения 8 - двойная ошибка #DF, которая возникает в случаях, когда одновременно происходят два исключения, которые не могут быть обслужены последовательно. К таким исключениям относятся #DE(INT 0 - деление на нуль), #TS(INT 0A - ошибочный TSS), #NP(INT 0B - сегмент недоступен), #SS(INT 0C - Ошибка стека), #GP(INT 0D - общая ошибка защиты) и #PF(INT 0E - ошибка сегментной адресации).<br><br>Какие именно исключения в тот момент возникли, анализ полного Crash dump&#039;а не показывает. WinDbg лишь показал<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">BUGCHECK_STR<span class="hl_char">:</span>&nbsp;&nbsp;0x7f_8</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">TSS<span class="hl_char">:</span>&nbsp;&nbsp;<span class="hl_number">00000028</span>&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">.</span>tss&nbsp;0x28<span class="hl_char">)</span></li><li class="hl_l1"><span class="hl_registr">eax</span><span class="hl_char">=</span><span class="hl_number">0000f0ac</span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">=</span><span class="hl_number">00000000</span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">=</span><span class="hl_number">0000f054</span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">=</span>f53e7816&nbsp;<span class="hl_registr">esi</span><span class="hl_char">=</span><span class="hl_number">00000030</span>&nbsp;<span class="hl_registr">edi</span><span class="hl_char">=</span><span class="hl_number">0000262c</span></li><li class="hl_l0">eip<span class="hl_char">=</span>f54fcf00&nbsp;<span class="hl_registr">esp</span><span class="hl_char">=</span><span class="hl_number">0000f000</span>&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">=</span><span class="hl_number">0000f02c</span>&nbsp;iopl<span class="hl_char">=</span><span class="hl_number">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nv&nbsp;up&nbsp;<span class="hl_registr"><b>di</b></span>&nbsp;pl&nbsp;nz&nbsp;ac&nbsp;po&nbsp;nc</li><li class="hl_l1"><span class="hl_registr">cs</span><span class="hl_char">=</span><span class="hl_number">0008</span>&nbsp;&nbsp;<span class="hl_registr">ss</span><span class="hl_char">=</span><span class="hl_number">0010</span>&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">=</span><span class="hl_number">0023</span>&nbsp;&nbsp;<span class="hl_registr">es</span><span class="hl_char">=</span><span class="hl_number">0023</span>&nbsp;&nbsp;<span class="hl_registr">fs</span><span class="hl_char">=</span><span class="hl_number">0030</span>&nbsp;&nbsp;<span class="hl_registr">gs</span><span class="hl_char">=</span><span class="hl_number">0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;efl<span class="hl_char">=</span><span class="hl_number">00010012</span></li><li class="hl_l0">Syser<span class="hl_char">!</span>gpSyserPluginUI<span class="hl_char">+</span>0x1684<span class="hl_char">:</span></li><li class="hl_l1">f54fcf00&nbsp;<span class="hl_number">68023bb5f7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;SDbgMsg<span class="hl_char">+</span>0xb02&nbsp;<span class="hl_char">(</span>f7b53b02<span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br><br>Почему бы в Ida не посмотреть?<br>В Syser.sys не нашел по указанному смещению (0x1684) такой команды, видимо он самораспаковывается, или в нем 2 сегмента кода, на тот момент не установил. Но в SDbgMsg.sys обнаружил по смещению 0xb02 функцию с единственной O-ссылкой. По смещению A18, на который эта ссылка указывала, находилось<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00010A13</span>&nbsp;<span class="hl_number">028</span>&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">78</span>&nbsp;<span class="hl_number">24</span>&nbsp;<span class="hl_number">01</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;dword_12478</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00010A18</span>&nbsp;<span class="hl_number">02C</span>&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">02</span>&nbsp;<span class="hl_number">0B</span>&nbsp;<span class="hl_number">01</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;sub_10B02</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00010A1D</span>&nbsp;<span class="hl_number">030</span>&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">0E</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0Eh</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00010A1F</span>&nbsp;<span class="hl_number">034</span>&nbsp;E8&nbsp;<span class="hl_number">4E</span>&nbsp;FB&nbsp;FF&nbsp;FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_10572</li>        </ol>
    </div>
</div></div>
<br><br>Параметр 0E - это как раз номер исключения (ошибки), sub_10B02 - адрес того самого обработчика этого исключения. Смысл вызываемой функции sub_10572 в том, что в ней подменяется адрес обработчика исключения #GP на sub_10B02. И я мыслю так, что этот обработчик не вызывается, так как не успело обработаться какое-то другое из списка...<br><br>Ладно, скачал 1195 релиз Syser&#039;а, буду проверять, то же ли самое. Скопирую перед установкой нового сисера старые драйвера от него с базами Ida в другую папку...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=251732&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=2" class="addthx" data-post="251732"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2010 22:46 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
И 1195 весело, под музыку кейгена, вылетает в BSOD с той же ошибкой.<br><br>В дровах нового Syser&#039;а изменен только Syser.sys. Все остальные дрова те же.<br><br>Результаты анализа дампа такие<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">kd<span class="hl_char">&gt;</span>&nbsp;<span class="hl_char">!</span>analyze&nbsp;<span class="hl_char">-</span>v&nbsp;<span class="hl_char">-</span>f</li><li class="hl_l1"><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span></li><li class="hl_l0"><span class="hl_char">*</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">*</span></li><li class="hl_l1"><span class="hl_char">*</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bugcheck&nbsp;Analysis&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">*</span></li><li class="hl_l0"><span class="hl_char">*</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">*</span></li><li class="hl_l1"><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">UNEXPECTED_KERNEL_MODE_TRAP&nbsp;<span class="hl_char">(</span><span class="hl_number">7f</span><span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_function"><b>This</b></span>&nbsp;means&nbsp;a&nbsp;trap&nbsp;occurred&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;kernel&nbsp;mode<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;it's a trap of a kind</li><li class="hl_l1">that&nbsp;the&nbsp;kernel&nbsp;isn't allowed to have/catch (bound trap) or that</li><li class="hl_l0">is&nbsp;always&nbsp;instant&nbsp;death&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>double</b></span>&nbsp;fault<span class="hl_char">)</span><span class="hl_char">.</span>&nbsp;&nbsp;The&nbsp;first&nbsp;number&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;the</li><li class="hl_l1">bugcheck&nbsp;params&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;the&nbsp;trap&nbsp;<span class="hl_char">(</span><span class="hl_number">8</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>double</b></span>&nbsp;fault<span class="hl_char">,</span>&nbsp;etc<span class="hl_char">)</span></li><li class="hl_l0">Consult&nbsp;an&nbsp;Intel&nbsp;x86&nbsp;family&nbsp;manual&nbsp;to&nbsp;learn&nbsp;more&nbsp;about&nbsp;what&nbsp;these</li><li class="hl_l1">traps&nbsp;are<span class="hl_char">.</span>&nbsp;Here&nbsp;is&nbsp;a&nbsp;<span class="hl_char">*</span>portion<span class="hl_char">*</span>&nbsp;of&nbsp;those&nbsp;codes<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_function"><b>If</b></span>&nbsp;kv&nbsp;shows&nbsp;a&nbsp;taskGate</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;<span class="hl_char">.</span>tss&nbsp;on&nbsp;the&nbsp;part&nbsp;before&nbsp;the&nbsp;colon<span class="hl_char">,</span>&nbsp;then&nbsp;kv<span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_function"><b>Else</b></span>&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;kv&nbsp;shows&nbsp;a&nbsp;trapframe</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;<span class="hl_char">.</span>trap&nbsp;on&nbsp;that&nbsp;value</li><li class="hl_l0"><span class="hl_function">Else</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>trap&nbsp;on&nbsp;the&nbsp;appropriate&nbsp;frame&nbsp;will&nbsp;show&nbsp;where&nbsp;the&nbsp;trap&nbsp;was&nbsp;taken</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>on&nbsp;x86<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>this</b></span>&nbsp;will&nbsp;be&nbsp;the&nbsp;<span class="hl_registr"><b>ebp</b></span>&nbsp;that&nbsp;goes&nbsp;with&nbsp;the&nbsp;procedure&nbsp;KiTrap<span class="hl_char">)</span></li><li class="hl_l1"><span class="hl_function">Endif</span></li><li class="hl_l0">kb&nbsp;will&nbsp;then&nbsp;show&nbsp;the&nbsp;corrected&nbsp;stack<span class="hl_char">.</span></li><li class="hl_l1">Arguments<span class="hl_char">:</span></li><li class="hl_l0">Arg1<span class="hl_char">:</span>&nbsp;<span class="hl_number">00000008</span><span class="hl_char">,</span>&nbsp;EXCEPTION_DOUBLE_FAULT</li><li class="hl_l1">Arg2<span class="hl_char">:</span>&nbsp;<span class="hl_number">80042000</span></li><li class="hl_l0">Arg3<span class="hl_char">:</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l1">Arg4<span class="hl_char">:</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">Debugging&nbsp;Details<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">BUGCHECK_STR<span class="hl_char">:</span>&nbsp;&nbsp;0x7f_8</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">TSS<span class="hl_char">:</span>&nbsp;&nbsp;<span class="hl_number">00000028</span>&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">.</span>tss&nbsp;0x28<span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_registr">eax</span><span class="hl_char">=</span><span class="hl_number">0000800b</span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">=</span><span class="hl_number">00000080</span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">=</span><span class="hl_number">00000000</span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">=</span><span class="hl_number">00000000</span>&nbsp;<span class="hl_registr">esi</span><span class="hl_char">=</span><span class="hl_number">00000000</span>&nbsp;<span class="hl_registr">edi</span><span class="hl_char">=</span><span class="hl_number">00000000</span></li><li class="hl_l1">eip<span class="hl_char">=</span>f54c7819&nbsp;<span class="hl_registr">esp</span><span class="hl_char">=</span><span class="hl_number">0000f000</span>&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">=</span><span class="hl_number">0000f004</span>&nbsp;iopl<span class="hl_char">=</span><span class="hl_number">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nv&nbsp;up&nbsp;<span class="hl_registr"><b>di</b></span>&nbsp;ng&nbsp;nz&nbsp;na&nbsp;po&nbsp;cy</li><li class="hl_l0"><span class="hl_registr">cs</span><span class="hl_char">=</span><span class="hl_number">0008</span>&nbsp;&nbsp;<span class="hl_registr">ss</span><span class="hl_char">=</span><span class="hl_number">0010</span>&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">=</span><span class="hl_number">0120</span>&nbsp;&nbsp;<span class="hl_registr">es</span><span class="hl_char">=</span><span class="hl_number">0120</span>&nbsp;&nbsp;<span class="hl_registr">fs</span><span class="hl_char">=</span><span class="hl_number">0000</span>&nbsp;&nbsp;<span class="hl_registr">gs</span><span class="hl_char">=</span><span class="hl_number">0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;efl<span class="hl_char">=</span><span class="hl_number">00010083</span></li><li class="hl_l1">Syser<span class="hl_char">!</span>DllUnload<span class="hl_char">+</span>0x885b<span class="hl_char">:</span></li><li class="hl_l0">f54c7819&nbsp;f00fba2d3c6b60f51f&nbsp;<span class="hl_function"><b>lock</b></span>&nbsp;<span class="hl_function"><b>bts</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span>Syser<span class="hl_char">!</span>gpSyserPluginUI<span class="hl_char">+</span>0x12e0&nbsp;<span class="hl_char">(</span>f5606b3c<span class="hl_char">)</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">1Fh</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_number">0120</span><span class="hl_char">:</span>f5606b3c<span class="hl_char">=</span><span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span></li><li class="hl_l1">Resetting&nbsp;default&nbsp;scope</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">DEFAULT_BUCKET_ID<span class="hl_char">:</span>&nbsp;&nbsp;DRIVER_FAULT</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">PROCESS_NAME<span class="hl_char">:</span>&nbsp;&nbsp;System</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">LAST_CONTROL_TRANSFER<span class="hl_char">:</span>&nbsp;&nbsp;from&nbsp;<span class="hl_number">00000000</span>&nbsp;to&nbsp;f54c7819</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">STACK_TEXT<span class="hl_char">:</span>&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_number">0000f004</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;Syser<span class="hl_char">!</span>DllUnload<span class="hl_char">+</span>0x885b</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">STACK_COMMAND<span class="hl_char">:</span>&nbsp;&nbsp;<span class="hl_char">.</span>tss&nbsp;0x28&nbsp;<span class="hl_comment">; kb</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">FOLLOWUP_IP<span class="hl_char">:</span>&nbsp;</li><li class="hl_l0">Syser<span class="hl_char">!</span>DllUnload<span class="hl_char">+</span><span class="hl_number">885b</span></li><li class="hl_l1">f54c7819&nbsp;f00fba2d3c6b60f51f&nbsp;<span class="hl_function"><b>lock</b></span>&nbsp;<span class="hl_function"><b>bts</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span>Syser<span class="hl_char">!</span>gpSyserPluginUI<span class="hl_char">+</span>0x12e0&nbsp;<span class="hl_char">(</span>f5606b3c<span class="hl_char">)</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">1Fh</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">SYMBOL_STACK_INDEX<span class="hl_char">:</span>&nbsp;&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">SYMBOL_NAME<span class="hl_char">:</span>&nbsp;&nbsp;Syser<span class="hl_char">!</span>DllUnload<span class="hl_char">+</span><span class="hl_number">885b</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">FOLLOWUP_NAME<span class="hl_char">:</span>&nbsp;&nbsp;MachineOwner</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">MODULE_NAME<span class="hl_char">:</span>&nbsp;Syser</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">IMAGE_NAME<span class="hl_char">:</span>&nbsp;&nbsp;Syser<span class="hl_char">.</span>sys</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">DEBUG_FLR_IMAGE_TIMESTAMP<span class="hl_char">:</span>&nbsp;&nbsp;<span class="hl_number">4b49f44d</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">FAILURE_BUCKET_ID<span class="hl_char">:</span>&nbsp;&nbsp;0x7f_8_Syser<span class="hl_char">!</span>DllUnload<span class="hl_char">+</span><span class="hl_number">885b</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">BUCKET_ID<span class="hl_char">:</span>&nbsp;&nbsp;0x7f_8_Syser<span class="hl_char">!</span>DllUnload<span class="hl_char">+</span><span class="hl_number">885b</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">Followup<span class="hl_char">:</span>&nbsp;MachineOwner</li><li class="hl_l0"><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li>        </ol>
    </div>
</div></div>
<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">kd<span class="hl_char">&gt;</span>&nbsp;<span class="hl_char">!</span>thread</li><li class="hl_l1">THREAD&nbsp;<span class="hl_number">8358c1e8</span>&nbsp;&nbsp;Cid&nbsp;<span class="hl_number">0004</span><span class="hl_char">.</span><span class="hl_number">0088</span>&nbsp;&nbsp;Teb<span class="hl_char">:</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;Win32Thread<span class="hl_char">:</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;RUNNING&nbsp;on&nbsp;processor&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_function"><b>Not</b></span>&nbsp;impersonating</li><li class="hl_l1">DeviceMap&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e10010e0</li><li class="hl_l0">Owning&nbsp;Process&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Image<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">&lt;</span>Unknown<span class="hl_char">&gt;</span></li><li class="hl_l1">Attached&nbsp;Process&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">837cb660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Image<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System</li><li class="hl_l0">Wait&nbsp;Start&nbsp;TickCount&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">37883</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ticks<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">Context&nbsp;Switch&nbsp;Count&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">709</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">UserTime&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">00</span><span class="hl_char">:</span><span class="hl_number">00</span><span class="hl_char">:</span><span class="hl_number">00</span><span class="hl_char">.</span><span class="hl_number">000</span></li><li class="hl_l1">KernelTime&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">00</span><span class="hl_char">:</span><span class="hl_number">00</span><span class="hl_char">:</span><span class="hl_number">00</span><span class="hl_char">.</span><span class="hl_number">000</span></li><li class="hl_l0">Start&nbsp;Address&nbsp;NtApm<span class="hl_char">!</span>SuspendPollThread&nbsp;<span class="hl_char">(</span>0xf7bef50a<span class="hl_char">)</span></li><li class="hl_l1">Stack&nbsp;Init&nbsp;f7be3000&nbsp;Current&nbsp;f7be2d34&nbsp;Base&nbsp;f7be3000&nbsp;Limit&nbsp;f7be0000&nbsp;<span class="hl_function"><b>Call</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">Priority&nbsp;<span class="hl_number">8</span>&nbsp;BasePriority&nbsp;<span class="hl_number">8</span>&nbsp;PriorityDecrement&nbsp;<span class="hl_number">0</span>&nbsp;DecrementCount&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span style="word-break: break-all">ChildEBP&nbsp;RetAddr&nbsp;&nbsp;Args&nbsp;to&nbsp;Child&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0"><span class="hl_number">00000000</span>&nbsp;f54c7819&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;nt<span class="hl_char">!</span>KiTrap08<span class="hl_char">+</span>0x44&nbsp;<span class="hl_char">(</span>FPO<span class="hl_char">:</span>&nbsp;TSS&nbsp;<span class="hl_number">28</span><span class="hl_char">:</span><span class="hl_number">0</span><span class="hl_char">)</span></li><li class="hl_l1">WARNING<span class="hl_char">:</span>&nbsp;Stack&nbsp;unwind&nbsp;information&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;available<span class="hl_char">.</span>&nbsp;Following&nbsp;frames&nbsp;may&nbsp;be&nbsp;wrong<span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_number">0000f004</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;Syser<span class="hl_char">!</span>DllUnload<span class="hl_char">+</span>0x885b</li>        </ol>
    </div>
</div></div>
<br><br>Более подробную информацию выложу позже.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=251760&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=3" class="addthx" data-post="251760"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2010 23:16 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Пока непонятно, в чем дело. Возможно в дампе просто не та информация. По указанному смещению Syser!DllUnload+0x885b действительно находится указанная команда lock bts dword ptr [Syser!gpSyserPluginUI+0x12e0 (f5606b3c)], 1Fh. Но блок, в контексте которого эта команда с префиксом LOCK, аналогичен блоку, заключенному в скобки критических секций (EnterCriticalSection и LeaveCriticalSection).<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001980D</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001980D</span>&nbsp;loc_1980D<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; CODE XREF: .text:00019822j</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001980D</span>&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_4<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019810</span>&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_4<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1000h</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019817</span>&nbsp;<span class="hl_function"><b>jg</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_19824</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019819</span>&nbsp;<span class="hl_function"><b>lock</b></span>&nbsp;<span class="hl_function"><b>bts</b></span>&nbsp;dword_158B3C<span class="hl_char">,</span>&nbsp;<span class="hl_number">1Fh</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019822</span>&nbsp;<span class="hl_function"><b>jb</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_1</li>        </ol>
    </div>
</div></div>
<br><br>Как может произойти исключение на этой команде???<br><br>Возможно следующий BSOD даст другой, более правдивый дамп...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=251765&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=4" class="addthx" data-post="251765"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2010 00:01 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Обнаружил еще по кросс-референсам, что функция sub_19800, которой принадлежит этот блок, вызывается в самом начале одного из трех обработчиков исключений 6, 0B и 0C. Это соответственно #UD (Недопустимая операция), #NP (Сегмент недоступен) и #SS (Ошибка стека). Но к списку одновременных исключений, вызывающих #DF, относится только #NP и #SS.<br><br>В качестве аргументов этой функции передается только один аргумент в каждом обработчике - номер исключения. Но сама функция оперирует гораздо большим количеством - 8 аргументов. Эти аргументы - адрес возврата, код ошибки, который передается исключению. Но до обработки их не доходит ввиду появления еще одного исключения.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=251767&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=5" class="addthx" data-post="251767"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2010 00:35 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Сдается мне, что ошибка в Syser в том, что он просто не обрабатывает 8 исключение <img src="img/smilies/s5.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=251768&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=6" class="addthx" data-post="251768"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2010 01:29 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
И только я приготовился к новому запуску сиськи, закрыл уже браузер, хотел уже закрыть WinDbg, но решил пробить стек от его лимита. Для меня сначала все казалось бессмысленными данными. Но вдруг краем глаза заметил, что все данные повторяются.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">f7be1700&nbsp;&nbsp;<span class="hl_number">0000000d</span>&nbsp;<span class="hl_number">804e1827</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;f54c7819</li><li class="hl_l1">f7be1710&nbsp;&nbsp;<span class="hl_number">00000008</span>&nbsp;<span class="hl_number">00010083</span>&nbsp;<span class="hl_number">00000001</span>&nbsp;<span class="hl_number">00001740</span></li><li class="hl_l0">f7be1720&nbsp;&nbsp;f550d679&nbsp;<span class="hl_number">0000000d</span>&nbsp;<span class="hl_number">804e1827</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l1">f7be1730&nbsp;&nbsp;f54c7819&nbsp;<span class="hl_number">00000008</span>&nbsp;<span class="hl_number">00010083</span>&nbsp;<span class="hl_number">00000001</span></li><li class="hl_l0">f7be1740&nbsp;&nbsp;<span class="hl_number">00001764</span>&nbsp;f550d679&nbsp;<span class="hl_number">0000000d</span>&nbsp;<span class="hl_number">804e1827</span></li><li class="hl_l1">f7be1750&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;f54c7819&nbsp;<span class="hl_number">00000008</span>&nbsp;<span class="hl_number">00010083</span></li><li class="hl_l0">f7be1760&nbsp;&nbsp;<span class="hl_number">00000001</span>&nbsp;<span class="hl_number">00001788</span>&nbsp;f550d679&nbsp;<span class="hl_number">0000000d</span></li><li class="hl_l1">f7be1770&nbsp;&nbsp;<span class="hl_number">804e1827</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;f54c7819&nbsp;<span class="hl_number">00000008</span></li>        </ol>
    </div>
</div></div>
<br><br>Итак до бесконечности. Налицо переполнение стека!!! А это #SS. Второе исключение похоже найдено...<br><br>Но какое все же первое?<br><br>Для начала вводим !address 804e1827 и узнаем, что этот адрес лежит в диапазоне адресов ntoskrnl.exe. f54c7819 - адрес той самой команды, которая вызывает исключение. Здесь чего-то я не понимаю, как может инструкция lock bts вызвать исключение, если адрес валидный? Только если то самое 0E, ошибка страничной адресации #PF... Оно возникает при обращениях к странице памяти, когда страница в данный момент выгружена на диск.<br>Третий адрес f550d679 оказался адресом возврата из функции, в которой происходит исключение. Тогда 0D - ее аргумент, который, судя по коду, совпадает с номером исключения. 1980 - предыдущий ebp (фрейм уровнем выше). Значит, дальше 1 - переменная, счетчик цикла (этот блок приведен выше). Счетчик досчитал до 1, то есть исключение возникает на самой первой итерации цикла.<br><br>Но тогда что такое 10083 и вслед за ним 8? Дальше идет адрес команды, вызвавшей исключение - f54c7819 и что-то дальше.<br><br>Попробуем пойти в обратную сторону. Адрес, предшествующий параметру, 804e1827 - возможно адрес команды вызвавшей исключение #GP (0D). Если так, то теперь дело за ntoskrnl.exe...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=251771&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=7" class="addthx" data-post="251771"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2010 11:45 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>17 февраля</b><br><br>ntoskrnl реверсить да с pdb-файлами одно удовольствие, даже толком поспать не смог... <img src="img/smilies/s1.gif" alt=""> <br><br>804e1827 - адрес обработчика тоже исключения 0D. (#GP - общая ошибка защиты)<br><br>Похоже, что Syser делает подмену обработчика по стандарту - сначала его обработчик, затем виндовый. Обработчик в Syser вызывается через шлюз вызова, виндовый с кодом ошибки при этом сохраняется дальше в стеке, чтобы быть вызванным после обработки Syser&#039;а. Возможно в некоторых случаях наоборот. Но почему же переполнение стека???<br><br>Приведу еще раз дамп стека, только на сей раз более полный и тогда можно будет понять, что курица все же сначала была, а не яйца. )))<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">f7be29b0&nbsp;&nbsp;f550d679&nbsp;<span class="hl_number">0000000d</span>&nbsp;<span class="hl_number">804e1827</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l1">f7be29c0&nbsp;&nbsp;f54c7819&nbsp;<span class="hl_number">00000008</span>&nbsp;<span class="hl_number">00010083</span>&nbsp;<span class="hl_number">00000001</span></li><li class="hl_l0">f7be29d0&nbsp;&nbsp;<span class="hl_number">000029f4</span>&nbsp;f550d679&nbsp;<span class="hl_number">0000000d</span>&nbsp;<span class="hl_number">804e1827</span></li><li class="hl_l1">f7be29e0&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;f54c7819&nbsp;<span class="hl_number">00000008</span>&nbsp;<span class="hl_number">00010083</span></li><li class="hl_l0">f7be29f0&nbsp;&nbsp;<span class="hl_number">00000001</span>&nbsp;<span class="hl_number">00002a18</span>&nbsp;f550d679&nbsp;<span class="hl_number">0000000d</span></li><li class="hl_l1">f7be2a00&nbsp;&nbsp;<span class="hl_number">804e1827</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;f54c7819&nbsp;<span class="hl_number">00000008</span></li><li class="hl_l0">f7be2a10&nbsp;&nbsp;<span class="hl_number">00010083</span>&nbsp;<span class="hl_number">00000001</span>&nbsp;<span class="hl_number">00002a3c</span>&nbsp;f550d679</li><li class="hl_l1">f7be2a20&nbsp;&nbsp;<span class="hl_number">0000000d</span>&nbsp;<span class="hl_number">804e1827</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;f54c7819</li><li class="hl_l0">f7be2a30&nbsp;&nbsp;<span class="hl_number">00000008</span>&nbsp;<span class="hl_number">00010083</span>&nbsp;<span class="hl_number">00000001</span>&nbsp;e1820000</li><li class="hl_l1">f7be2a40&nbsp;&nbsp;f550d985&nbsp;<span class="hl_number">0000000c</span>&nbsp;<span class="hl_number">804e1530</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0">f7be2a50&nbsp;&nbsp;f54f371c&nbsp;<span class="hl_number">00000008</span>&nbsp;<span class="hl_number">00010097</span>&nbsp;<span class="hl_number">8337c15c</span></li><li class="hl_l1">f7be2a60&nbsp;&nbsp;<span class="hl_number">000080e5</span>&nbsp;<span class="hl_number">00000118</span>&nbsp;<span class="hl_number">00000202</span>&nbsp;<span class="hl_number">00f001fa</span></li><li class="hl_l0">f7be2a70&nbsp;&nbsp;f7be2dcc&nbsp;f7be2d74&nbsp;<span class="hl_number">0000530b</span>&nbsp;f7beff40</li><li class="hl_l1">f7be2a80&nbsp;&nbsp;<span class="hl_number">0000530b</span>&nbsp;f7beff40&nbsp;<span class="hl_number">00000000</span>&nbsp;f7be2d74</li><li class="hl_l0">f7be2a90&nbsp;&nbsp;f7bef99d&nbsp;f7be2aa4&nbsp;f7beff60&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l1">f7be2aa0&nbsp;&nbsp;<span class="hl_number">804dc750</span>&nbsp;<span class="hl_number">00010006</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">836f6380</span></li><li class="hl_l0">f7be2ab0&nbsp;&nbsp;<span class="hl_number">836f6380</span>&nbsp;f7be2acc&nbsp;<span class="hl_number">80563ffe</span>&nbsp;<span class="hl_number">836f6388</span></li><li class="hl_l1">f7be2ac0&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">837ee730</span>&nbsp;f7be2af0</li><li class="hl_l0">f7be2ad0&nbsp;&nbsp;<span class="hl_number">00000202</span>&nbsp;<span class="hl_number">804e834a</span>&nbsp;<span class="hl_number">000000b4</span>&nbsp;<span class="hl_number">804e8372</span></li><li class="hl_l1">f7be2ae0&nbsp;&nbsp;<span class="hl_number">00000001</span>&nbsp;<span class="hl_number">00000001</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;f7be2b9c</li><li class="hl_l0">f7be2af0&nbsp;&nbsp;<span class="hl_number">804ec813</span>&nbsp;f7be2b04&nbsp;<span class="hl_number">00000001</span>&nbsp;<span class="hl_number">00000300</span></li><li class="hl_l1">f7be2b00&nbsp;&nbsp;<span class="hl_number">8055ef80</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;f7be2b84&nbsp;f7be2b84</li><li class="hl_l0">f7be2b10&nbsp;&nbsp;f7be2b84&nbsp;f7be2b84&nbsp;f7be2b84&nbsp;f7be2b84</li><li class="hl_l1">f7be2b20&nbsp;&nbsp;f7be2b84&nbsp;f7be2b84&nbsp;f7be2b84&nbsp;f7be2b84</li><li class="hl_l0">f7be2b30&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000120</span>&nbsp;<span class="hl_number">00000120</span></li><li class="hl_l1">f7be2b40&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0">f7be2b50&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">0000530b</span>&nbsp;e1820000&nbsp;<span class="hl_number">000080bc</span></li><li class="hl_l1">f7be2b60&nbsp;&nbsp;<span class="hl_number">00000118</span>&nbsp;<span class="hl_number">00000200</span>&nbsp;e1824000&nbsp;e1825000</li><li class="hl_l0">f7be2b70&nbsp;&nbsp;e1826000&nbsp;e1827000&nbsp;e1828000&nbsp;e1829000</li><li class="hl_l1">f7be2b80&nbsp;&nbsp;<span class="hl_number">836f6ca8</span>&nbsp;e1958000&nbsp;<span class="hl_number">00005314</span>&nbsp;<span class="hl_number">00000001</span></li><li class="hl_l0">f7be2b90&nbsp;&nbsp;<span class="hl_number">000000b4</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">000000b4</span>&nbsp;<span class="hl_number">0000081b</span></li><li class="hl_l1">f7be2ba0&nbsp;&nbsp;<span class="hl_number">8055ef80</span>&nbsp;f7be2bd8&nbsp;<span class="hl_number">80549631</span>&nbsp;<span class="hl_number">837f7000</span></li><li class="hl_l0">f7be2bb0&nbsp;&nbsp;<span class="hl_number">0000081b</span>&nbsp;<span class="hl_number">00000015</span>&nbsp;<span class="hl_number">837a3548</span>&nbsp;<span class="hl_number">837f1000</span></li><li class="hl_l1">f7be2bc0&nbsp;&nbsp;<span class="hl_number">00000001</span>&nbsp;ffffff4c&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0">f7be2bd0&nbsp;&nbsp;c038606c&nbsp;<span class="hl_number">0000001b</span>&nbsp;f7be2c18&nbsp;<span class="hl_number">8054b28b</span></li><li class="hl_l1">f7be2be0&nbsp;&nbsp;<span class="hl_number">8054b2af</span>&nbsp;<span class="hl_number">837a3548</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0">f7be2bf0&nbsp;&nbsp;e180cbf8&nbsp;<span class="hl_number">00000001</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000070</span></li><li class="hl_l1">f7be2c00&nbsp;&nbsp;<span class="hl_number">804dcea6</span>&nbsp;<span class="hl_number">00000001</span>&nbsp;<span class="hl_number">00000006</span>&nbsp;f7be2c1c</li><li class="hl_l0">f7be2c10&nbsp;&nbsp;<span class="hl_number">8058ee67</span>&nbsp;e180cb90&nbsp;f7be2dac&nbsp;<span class="hl_number">805b52ce</span></li><li class="hl_l1">f7be2c20&nbsp;&nbsp;e181b000&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">805b52d8</span></li><li class="hl_l0">f7be2c30&nbsp;&nbsp;<span class="hl_number">0000067a</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">0000067a</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l1">f7be2c40&nbsp;&nbsp;<span class="hl_number">00000002</span>&nbsp;<span class="hl_number">0000047e</span>&nbsp;<span class="hl_number">000029ed</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0">f7be2c50&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l1">f7be2c60&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0">f7be2c70&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;f768adae&nbsp;<span class="hl_number">000001f7</span></li><li class="hl_l1">f7be2c80&nbsp;&nbsp;<span class="hl_number">837a4374</span>&nbsp;<span class="hl_number">837a40e8</span>&nbsp;<span class="hl_number">837a4370</span>&nbsp;f7be2c9c</li><li class="hl_l0">f7be2c90&nbsp;&nbsp;f7692729&nbsp;<span class="hl_number">837a4374</span>&nbsp;<span class="hl_number">837d8058</span>&nbsp;f7be2cb4</li><li class="hl_l1">f7be2ca0&nbsp;&nbsp;f7691502&nbsp;<span class="hl_number">837da5c8</span>&nbsp;<span class="hl_number">837a4374</span>&nbsp;<span class="hl_number">806f3628</span></li><li class="hl_l0">f7be2cb0&nbsp;&nbsp;<span class="hl_number">8345c26c</span>&nbsp;f7be2cec&nbsp;f768bda1&nbsp;<span class="hl_number">00000001</span></li><li class="hl_l1">f7be2cc0&nbsp;&nbsp;<span class="hl_number">837a4370</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">837da918</span>&nbsp;<span class="hl_number">00000202</span></li><li class="hl_l0">f7be2cd0&nbsp;&nbsp;<span class="hl_number">804e3ee3</span>&nbsp;<span class="hl_number">837da918</span>&nbsp;<span class="hl_number">837a40e8</span>&nbsp;ffdff9c0</li><li class="hl_l1">f7be2ce0&nbsp;&nbsp;<span class="hl_number">0d7da5c8</span>&nbsp;f7be2d00&nbsp;f768e614&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0">f7be2cf0&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">837dab7c</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l1">f7be2d00&nbsp;&nbsp;f7be2d24&nbsp;<span class="hl_number">804dad9f</span>&nbsp;<span class="hl_number">837da918</span>&nbsp;<span class="hl_number">837a4030</span></li><li class="hl_l0">f7be2d10&nbsp;&nbsp;<span class="hl_number">0001000d</span>&nbsp;ffffffff&nbsp;f7be2d24&nbsp;<span class="hl_number">806f4076</span></li><li class="hl_l1">f7be2d20&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;f7bef347&nbsp;badb0d00</li><li class="hl_l0">f7be2d30&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;f7be2dcc&nbsp;<span class="hl_number">00000246</span>&nbsp;<span class="hl_number">804dbde0</span></li><li class="hl_l1">f7be2d40&nbsp;&nbsp;f7be2d80&nbsp;<span class="hl_number">8358c1e8</span>&nbsp;ffdff120&nbsp;<span class="hl_number">00000246</span></li><li class="hl_l0">f7be2d50&nbsp;&nbsp;<span class="hl_number">804dc6bc</span>&nbsp;<span class="hl_number">8358c258</span>&nbsp;<span class="hl_number">8358c1e8</span>&nbsp;<span class="hl_number">804dc6f2</span></li><li class="hl_l1">f7be2d60&nbsp;&nbsp;f7beff60&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">804dc750</span>&nbsp;<span class="hl_number">804dc98b</span></li><li class="hl_l0">f7be2d70&nbsp;&nbsp;<span class="hl_number">00be2dcc</span>&nbsp;f7be2d94&nbsp;f7befaa6&nbsp;<span class="hl_number">0000530b</span></li><li class="hl_l1">f7be2d80&nbsp;&nbsp;f7be2d90&nbsp;f7be2d8c&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0">f7be2d90&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;f7bef541&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l1">f7be2da0&nbsp;&nbsp;<span class="hl_number">8358c1e8</span>&nbsp;f7be2ddc&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0">f7be2db0&nbsp;&nbsp;<span class="hl_number">8057dfed</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l1">f7be2dc0&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;f7be2db8&nbsp;<span class="hl_number">00000000</span>&nbsp;ffffffff</li><li class="hl_l0">f7be2dd0&nbsp;&nbsp;<span class="hl_number">804e2af1</span>&nbsp;<span class="hl_number">804fa640</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l1">f7be2de0&nbsp;&nbsp;<span class="hl_number">804fa477</span>&nbsp;f7bef50a&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0">f7be2df0&nbsp;&nbsp;<span class="hl_number">0000027f</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l1">f7be2e00&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00001f80</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0">f7be2e10&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000000</span></li>        </ol>
    </div>
</div></div>
<br><br>Вверху наши рекурсии обработчика, внизу около 512 байт до базы стека заполнено нулями.<br>Попробуем разобрать по частям наш стек<br><br>вводим команды dd, начиная с dd f7be2a3c L1, чтобы удобнее было здесь выложить<br><br>Первая часть<br>Здесь повторяется, за исключением e1820000<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">f7be2a3c&nbsp;&nbsp;e1820000&nbsp;<span class="hl_char">-</span>&nbsp;адрес&nbsp;в&nbsp;выгружаемом&nbsp;пуле&nbsp;<span class="hl_char">(</span>Paged&nbsp;Pool<span class="hl_char">)</span></li><li class="hl_l1">f7be2a38&nbsp;&nbsp;<span class="hl_number">00000001</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span></li><li class="hl_l0">f7be2a34&nbsp;&nbsp;<span class="hl_number">00010083</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span></li><li class="hl_l1">f7be2a30&nbsp;&nbsp;<span class="hl_number">00000008</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span></li><li class="hl_l0">f7be2a2c&nbsp;&nbsp;f54c7819&nbsp;<span class="hl_char">-</span>&nbsp;адрес&nbsp;команды&nbsp;в&nbsp;обработчике&nbsp;Syser<span class="hl_char">,</span>&nbsp;вызвавшей&nbsp;исключение</li><li class="hl_l1">f7be2a28&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_char">-</span>&nbsp;код&nbsp;ошибки&nbsp;исключения<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span>&nbsp;для&nbsp;стандартного&nbsp;обработчика&nbsp;исключения&nbsp;#GP&nbsp;в&nbsp;большинстве&nbsp;случаев</li><li class="hl_l0">f7be2a24&nbsp;&nbsp;<span class="hl_number">804e1827</span>&nbsp;<span class="hl_char">-</span>&nbsp;адрес&nbsp;виндового&nbsp;обработчика&nbsp;в&nbsp;ntoskrnl&nbsp;исключения&nbsp;#GP<span class="hl_char">,</span>&nbsp;_KiTrap0D</li><li class="hl_l1">f7be2a20&nbsp;&nbsp;<span class="hl_number">0000000d</span>&nbsp;<span class="hl_char">-</span>&nbsp;номер&nbsp;исключения&nbsp;для&nbsp;вызываемой&nbsp;из&nbsp;обработчика&nbsp;Syser&nbsp;исключения&nbsp;#GP&nbsp;функции</li><li class="hl_l0">f7be2a1c&nbsp;&nbsp;f550d679&nbsp;<span class="hl_char">-</span>&nbsp;адрес&nbsp;возврата&nbsp;в&nbsp;обработчик&nbsp;Syser&nbsp;исключения&nbsp;#GP</li><li class="hl_l1">f7be2a18&nbsp;&nbsp;<span class="hl_number">00002a3c</span>&nbsp;<span class="hl_char">-</span>&nbsp;сохраняемый&nbsp;<span class="hl_registr"><b>ebp</b></span>&nbsp;для&nbsp;для&nbsp;вызываемой&nbsp;из&nbsp;обработчика&nbsp;Syser&nbsp;исключения&nbsp;#GP&nbsp;функции</li>        </ol>
    </div>
</div></div>
<br><br>Это я уже выкладывал, но в таком виде смотреть удобней и приятней. Как мы узнали, что e1820000 - пул? Очень просто - набрали команду !address e1820000 (благо, у меня полный креш дамп). В ответ windbg напрягся, подумал и выдал<br><br>  e1000000 - 0fc00000                           <br>          Usage       KernelSpaceUsagePagedPool<br><br>К пулу еще, может, вернусь...<br><br>Итак, началось все (точнее, повторы начались) с непонятных 3 двойных слов и адреса команды, вызвавшей исключение (не факт, конечно, в зависимости от исключения адрес может указывать на следующую команду). Но эта команда в функции, которая вызывается из обработчика какого-то исключения (нельзя сказать, что началось все именно с #GP, поскольку эта функция вызывается многими обработчиками). И, возможно, 3 этих непонятных числа - составной код ошибки. Но тогда из этого и из того, что только два исключения из набора {0, 0A, 0B, 0C, 0D, 0E} способны вызвать 8, а также из того, что второе исключение - 0C, следует только одно:<br><br>все началось с исключения, не входящего в этот набор.<br><br>Про составные коды ошибок в книге от Зубкова ничего не нашел, такие не исключаются при исключениях от 12h... Вернемся к этому вопросу чуть позже (для этого надо погуглить).<br><br>С первой частью дампа немного ясно. Возможно, вторая часть больше прояснит смысл неясных двойных слов.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">f7be2a4c&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_char">-</span>&nbsp;код&nbsp;ошибки</li><li class="hl_l1">f7be2a48&nbsp;&nbsp;<span class="hl_number">804e1530</span>&nbsp;<span class="hl_char">-</span>&nbsp;адрес&nbsp;виндового&nbsp;обработчика&nbsp;в&nbsp;ntoskrnl&nbsp;исключения&nbsp;#SS<span class="hl_char">,</span>&nbsp;_KiTrap0C</li><li class="hl_l0">f7be2a44&nbsp;&nbsp;<span class="hl_number">0000000c</span>&nbsp;<span class="hl_char">-</span>&nbsp;номер&nbsp;исключения&nbsp;для&nbsp;вызываемой&nbsp;из&nbsp;обработчика&nbsp;Syser&nbsp;исключения&nbsp;#SS&nbsp;функции</li><li class="hl_l1">f7be2a40&nbsp;&nbsp;f550d985&nbsp;<span class="hl_char">-</span>&nbsp;адрес&nbsp;возврата&nbsp;в&nbsp;обработчик&nbsp;Syser&nbsp;исключения&nbsp;#SS</li>        </ol>
    </div>
</div></div>
<br><br>По той же самой схеме, как и выше, это ни что иное, как результат исключения 0C (#SS). Но код ошибки равен 0, а это значит, что не было переполнения стека и ошибка произошла не из-за отсутствия сегмента стека ss. Но, по определению не может происходить одновременно два исключения(#SS и #GP) из набора выше без результирующего #DF! Либо из этого правила есть исключения, либо #SS было обработано &quot;правильно&quot; и одно из неясных слов первой части дампа - адрес возврата. Хотя возможно еще и третье - часть стека был заменена,  что вполне может иметь место при переполнении стека (тогда третья часть дампа поможет :s2<img src="img/smilies/s1.gif" alt="">.<br><br>2-ое невозможно, так как код обработчика исключения sub_5F97E после возврата из функции затер бы флагами и другими регистрами все.<br><br>Вот код обработчика, по которому можно увидеть, что после вызова функции - заглушка, хотя можно там, между командами mov fs, eax и pop fs вставить дополнительный код обработчика.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F97E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_5F97E&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; DATA XREF: .text:00012779o</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F97E</span>&nbsp;<span class="hl_number">000</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0Ch</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F980</span>&nbsp;<span class="hl_number">004</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_19800</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F985</span>&nbsp;<span class="hl_number">004</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F989</span>&nbsp;<span class="hl_number">000</span>&nbsp;<span class="hl_function">pushf</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F98A</span>&nbsp;<span class="hl_number">004</span>&nbsp;<span class="hl_function">pusha</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F98B</span>&nbsp;<span class="hl_number">024</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F98D</span>&nbsp;<span class="hl_number">024</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F98E</span>&nbsp;<span class="hl_number">028</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">es</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F98F</span>&nbsp;<span class="hl_number">02C</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">fs</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F991</span>&nbsp;<span class="hl_number">030</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">23h</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F995</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">66h</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F995</span>&nbsp;<span class="hl_number">030</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ax</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F998</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>assume</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_function">nothing</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F998</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">66h</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F998</span>&nbsp;<span class="hl_number">030</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">es</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F99B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>assume</b></span>&nbsp;<span class="hl_registr">es</span><span class="hl_char">:</span><span class="hl_function">nothing</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F99B</span>&nbsp;<span class="hl_number">030</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">30h</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F99F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">66h</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F99F</span>&nbsp;<span class="hl_number">030</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">fs</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F9A2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>assume</b></span>&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_function">nothing</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F9A2</span>&nbsp;<span class="hl_number">030</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">fs</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F9A4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>assume</b></span>&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_function">nothing</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F9A4</span>&nbsp;<span class="hl_number">02C</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">es</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F9A5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>assume</b></span>&nbsp;<span class="hl_registr">es</span><span class="hl_char">:</span><span class="hl_function">nothing</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F9A5</span>&nbsp;<span class="hl_number">028</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F9A6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>assume</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>_data</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F9A6</span>&nbsp;<span class="hl_number">024</span>&nbsp;<span class="hl_function">popa</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F9A7</span>&nbsp;<span class="hl_number">004</span>&nbsp;<span class="hl_function">popf</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F9A8</span>&nbsp;<span class="hl_number">000</span>&nbsp;<span class="hl_function">retn</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0005F9A8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_5F97E&nbsp;<span class="hl_function">endp</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=251777&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=8" class="addthx" data-post="251777"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2010 11:55 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
и код функции, которая вызывается большинством обработчиков Syser<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_19800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; CODE XREF: .text:0005F674p</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:0005F95Ap</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:0005F980p</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:0005F9ACp</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">-</span><span class="hl_number">0Ch</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">-</span><span class="hl_number">8</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">-</span><span class="hl_number">4</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">8</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">10h</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">14h</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">18h</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">1Ch</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">20h</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_1C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">24h</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019800</span>&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019801</span>&nbsp;<span class="hl_number">004</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019803</span>&nbsp;<span class="hl_number">004</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>sub</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">4</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019806</span>&nbsp;<span class="hl_number">008</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_4<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001980D</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001980D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_1980D<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:00019822j</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001980D</span>&nbsp;<span class="hl_number">008</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_4<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019810</span>&nbsp;<span class="hl_number">008</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_4<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1000h</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019817</span>&nbsp;<span class="hl_number">008</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jg</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_19824</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019819</span>&nbsp;<span class="hl_number">008</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lock</b></span>&nbsp;<span class="hl_function"><b>bts</b></span>&nbsp;dword_158B3C<span class="hl_char">,</span>&nbsp;<span class="hl_number">1Fh</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019822</span>&nbsp;<span class="hl_number">008</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jb</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_1980D</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019824</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019824</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_19824<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:00019817j</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019824</span>&nbsp;<span class="hl_number">008</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019825</span>&nbsp;<span class="hl_number">00C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019826</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">10h</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001982B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">66h</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001982B</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001982E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>assume</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_function">nothing</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001982E</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">0Ch</span><span class="hl_char">+</span>var_8<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019832</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_157B38<span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019837</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019839</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">0Ch</span><span class="hl_char">+</span>var_C<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001983C</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>word_157B9A<span class="hl_char">,</span>&nbsp;<span class="hl_registr">ax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019842</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_157B3C<span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019848</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_157B40<span class="hl_char">,</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001984E</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_157B44<span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019854</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_157B50<span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001985A</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_157B54<span class="hl_char">,</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019860</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">0</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019863</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_157B4C<span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019868</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_10<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001986B</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>word_157B96<span class="hl_char">,</span>&nbsp;<span class="hl_registr">ax</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019871</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">3</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019875</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_1988A</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019877</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_18<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001987A</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_157B48<span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001987F</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_1C<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019882</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>word_157B98<span class="hl_char">,</span>&nbsp;<span class="hl_registr">ax</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019888</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_1989B</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001988A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------- -----</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001988A</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001988A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_1988A<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:00019875j</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001988A</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_18<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001988D</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_157B48<span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019892</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ss</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019895</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>word_157B98<span class="hl_char">,</span>&nbsp;<span class="hl_registr">ax</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001989B</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001989B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_1989B<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:00019888j</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001989B</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001989D</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">fs</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198A0</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>word_157B9C<span class="hl_char">,</span>&nbsp;<span class="hl_registr">ax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198A6</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">es</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198A9</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>word_157B94<span class="hl_char">,</span>&nbsp;<span class="hl_registr">ax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198AF</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">gs</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198B2</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>word_157B9E<span class="hl_char">,</span>&nbsp;<span class="hl_registr">ax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198B8</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_8<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198BB</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_157BBC<span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198C0</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_0<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198C3</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_157BB8<span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198C8</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_C<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198CB</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_157B8C<span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198D0</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_14<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198D3</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_157B90<span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198D8</span>&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198D9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>assume</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>_data</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198D9</span>&nbsp;<span class="hl_number">00C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198DA</span>&nbsp;<span class="hl_number">008</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">pusha</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198DB</span>&nbsp;<span class="hl_number">028</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">pushf</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198DC</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">cld</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198DD</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;dword_157854</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198E2</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198E4</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_1992D</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198E6</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>loc_25DD3<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198ED</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_1992D</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198EF</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_43FD8</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198F4</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;dword_157B8C</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">000198FA</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;dword_157854</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019900</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">+</span><span class="hl_number">4408h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019906</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dword_157B30<span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001990B</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jb</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_19915</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001990D</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">+</span><span class="hl_number">440Ch</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019913</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jb</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_1992D</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019915</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_19915<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:0001990Bj</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019915</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019917</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>imul</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">8Ch</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001991D</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;off_126C70</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019923</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">23h</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019925</span>&nbsp;<span class="hl_number">030</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019926</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;dword_157B38</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001992B</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>rep</b></span>&nbsp;<span class="hl_function">movsd</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001992D</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001992D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_1992D<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:000198E4j</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001992D</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:000198EDj</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001992D</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:00019913j</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001992D</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lock</b></span>&nbsp;<span class="hl_function"><b>btr</b></span>&nbsp;dword_158B3C<span class="hl_char">,</span>&nbsp;<span class="hl_number">1Fh</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019936</span>&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">popf</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019937</span>&nbsp;<span class="hl_number">028</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">popa</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00019938</span>&nbsp;<span class="hl_number">008</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001993A</span>&nbsp;<span class="hl_number">004</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001993B</span>&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">retn</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0001993B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_19800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">endp</span></li>        </ol>
    </div>
</div></div>
<br><br>Что-то совсем туго... Неужели в некоторых случаях возможны два и более одновременных исключения типа #SS и #GP ???
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=251778&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=9" class="addthx" data-post="251778"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2010 12:41 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Нашел на WASM <noindex><a href="http://www.wasm.ru/article.php?article=pipm12" rel="nofollow" target="_blank">--&gt; здесь &lt;--</a></noindex> фразу &quot;а также: Зубков тоже ошибается... &quot;. <img src="img/smilies/s5.gif" alt=""> Видимо из-за ошибок автора книги, которую я читаю, вся неразбериха и получается.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=251780&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=10" class="addthx" data-post="251780"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2010 14:19 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<noindex><a href="http://dims.karelia.ru/x86/intr_3.shtml" rel="nofollow" target="_blank">Эта статья расставила все по местам</a></noindex>.<br><br>Первая часть дампа стека будет выглядеть так<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">f7be2a3c&nbsp;&nbsp;e1820000&nbsp;<span class="hl_char">-</span>&nbsp;адрес&nbsp;в&nbsp;выгружаемом&nbsp;пуле&nbsp;<span class="hl_char">(</span>Paged&nbsp;Pool<span class="hl_char">)</span></li><li class="hl_l1">f7be2a38&nbsp;&nbsp;<span class="hl_number">00000001</span>&nbsp;<span class="hl_char">-</span>&nbsp;локальная&nbsp;переменная<span class="hl_char">-</span>итератор&nbsp;в&nbsp;вызываемой&nbsp;функции&nbsp;из&nbsp;обработчика&nbsp;Syser&nbsp;исключения</li><li class="hl_l0">f7be2a34&nbsp;&nbsp;<span class="hl_number">00010083</span>&nbsp;<span class="hl_char">-</span>&nbsp;EFLAGS</li><li class="hl_l1">f7be2a30&nbsp;&nbsp;<span class="hl_number">00000008</span>&nbsp;<span class="hl_char">-</span>&nbsp;селектор&nbsp;команд</li><li class="hl_l0">f7be2a2c&nbsp;&nbsp;f54c7819&nbsp;<span class="hl_char">-</span>&nbsp;адрес&nbsp;команды&nbsp;в&nbsp;обработчике&nbsp;Syser<span class="hl_char">,</span>&nbsp;вызвавшей&nbsp;исключение</li><li class="hl_l1">f7be2a28&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_char">-</span>&nbsp;код&nbsp;ошибки&nbsp;исключения<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span>&nbsp;для&nbsp;стандартного&nbsp;обработчика&nbsp;исключения&nbsp;#GP&nbsp;в&nbsp;большинстве&nbsp;случаев</li><li class="hl_l0">f7be2a24&nbsp;&nbsp;<span class="hl_number">804e1827</span>&nbsp;<span class="hl_char">-</span>&nbsp;адрес&nbsp;виндового&nbsp;обработчика&nbsp;в&nbsp;ntoskrnl&nbsp;исключения&nbsp;#GP<span class="hl_char">,</span>&nbsp;_KiTrap0D</li><li class="hl_l1">f7be2a20&nbsp;&nbsp;<span class="hl_number">0000000d</span>&nbsp;<span class="hl_char">-</span>&nbsp;номер&nbsp;исключения&nbsp;для&nbsp;вызываемой&nbsp;из&nbsp;обработчика&nbsp;Syser&nbsp;исключения&nbsp;#GP&nbsp;функции</li><li class="hl_l0">f7be2a1c&nbsp;&nbsp;f550d679&nbsp;<span class="hl_char">-</span>&nbsp;адрес&nbsp;возврата&nbsp;в&nbsp;обработчик&nbsp;Syser&nbsp;исключения&nbsp;#GP</li><li class="hl_l1">f7be2a18&nbsp;&nbsp;<span class="hl_number">00002a3c</span>&nbsp;<span class="hl_char">-</span>&nbsp;сохраняемый&nbsp;<span class="hl_registr"><b>ebp</b></span>&nbsp;для&nbsp;для&nbsp;вызываемой&nbsp;из&nbsp;обработчика&nbsp;Syser&nbsp;исключения&nbsp;#GP&nbsp;функции</li>        </ol>
    </div>
</div></div>
<br><br>В EFLAGS только RS взведен. На тему этого флага есть расхождения, а у Зубкова вообще противоречивые высказывания в одном абзаце:<br><br>&quot;Флаг RF - когда этот флаг равен 1, отладочные исключения временно запрещены. <b>Он устанавливается командой IRETD </b>из обработчика отладочного прерывания, чтобы #DB не произошло перед выполнением команды, которая его вызвала, еще раз. <b>На флаг не влияют команды POPF, PUSHF, IRET</b>.&quot;<br><br>На этом исследования ставлю пока на паузу, так как еще много других дел...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=251851&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=11" class="addthx" data-post="251851"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.33'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2010 15:14 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
1) В нашей компьтерной коммисионке GF2 MX400 - 200р Радеоны и GF4 и 5-е по 500-600р<br>    Неужто это дорого? Свяжись с любыми ремонтниками - они может бесплатно такое добро подарят.<br>2) Единственный плюс в твоей работе - это освоение syser и драйверов, но материал не подходящий.<br>   Где гарантия, что дело не в драйвере, а в железе.<br><br>  Был у меня в свое IDE-контроллер &quot;ускоренный&quot; с шиной VLB и с 286-м(!) на плате.<br>  И драйвера были, но сам по себе он кривой был - железно.<br>  Прямо с ним еще видео-карта. Так пока профи не сделали нормальные драйвера - она не заработала.<br><br> Ну и как нормальный вариант : все-таки поискать драйвера. Очень часто  самые новые не есть самые лучшие.<br><br>3) А ты уверен, что для этой игры AGP 2X достаточно, а главное что твоя мамка это поддерживает и в БИОС-е включено ? Я уже для себя уяснил, что железо должно быть сбалансировано. Нельзя ждать безглючности, когда железо из разных весовых категорий.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=251858&amp;user=4072&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=12" class="addthx" data-post="251858"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2010 18:26 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
1) Я сам себе ремонтник. Плюс ко всей продукции от ATI уже отношусь скептически. NVidia надо проверить.<br><br>2) Да, из названия темы можно убрать все про видеоадаптер и оставить реверс драйвера. Люблю копаться. Исследования проблемы могут помочь не только в освоении драйверов, но и выяснить, в чем же проблема на самом деле, в железе или в дровах?<br><br>3) Уверен - для двух версий драйверов ошибки разные. Соединить бы два комплекта драйверов в один без ошибок... <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=251874&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=13" class="addthx" data-post="251874"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2010 16:41 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>ДАЛЬШЕ ВСЕ ДЛЯ TRIAL ДИСТРИБУТИВА Syser Debugger</b><br><br>В новых дампах все то же самое. Только в стеке указатели на фреймы более правдивые и первопричина исключений #GP - #UD. Это исключение не содержит кода ошибки. В стеке после виндового обработчика _KiTrap06 записан адрес возврата 2, селектор cs = 0x1000 (может быть только для реального и виртуального режимов), EFLAGS = 0xb0202 (RF = 1, VM = 1, VIF = 1). Имеет место межсегментное переключение, поскольку дальше (если так) ESP = 0x1ffc, ss = 0x1000 (может быть только для реального режимов и втруального режимов). Далее 16 байт нули и 0x27f, 0x7c900000 (база ntdll.dll)  и опять 16 нулей.<br><br>Что еще? На момент креша cr2 = f795bffc - выход за пределы нижней границы стека, cr0 = 8001003b (PG = 1, CD = 0, NW = 0, AM = 0, WP = 1, NE = 1, ET = 1, TS = 1 - задача переключена, EM = 0, MP = 1, PE = 1), cr4 = 6d9 (10(???) бит = 1, FSR = 1, PMC = 0, PGE = 1, MCE = 1, PAE = 0, PSE = 1, DE = 1, TSD = 0, PVI = 0, VME = 1), cr3 = 00039000 (20 старших бит физ. адреса начала каталога страниц = 39, PCD = 0, PWT = 0)<br>все dr = 0<br><br>Отсюда можно сделать вывод, что исключение #UD возникло в виртуальном режиме, адрес команды вызвавшей исключение - cs:ip = 1000:0002, ss:sp = 1000:1ffc.<br><br>gdtr = 8003f000, gdtl = 3ff, idtr = 8003f400, idtl = 7ff, tr = 50, ldtr = 0<br>Отюда селекторы могут быть от 8 до 3F8, номера шлюзов от 0 до FF.<br><br>Шлюзы<br><br>                               адрес           сег IOPL тип шлюза<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;<span class="hl_number">0</span><span class="hl_char">(</span>#DE<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804dfbff</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_number">1</span><span class="hl_char">(</span>#DB<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span>f68f9fe8&nbsp;SE&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания&nbsp;Syser<span class="hl_char">!</span>KiHookTrap_01</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_number">2</span><span class="hl_char">(</span>NMI<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0058</span><span class="hl_char">:</span><span class="hl_number">0000112e</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;Шлюз&nbsp;задачи</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_number">3</span><span class="hl_char">(</span>#BP<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span>f68fa000&nbsp;SE&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания&nbsp;Syser<span class="hl_char">!</span>KiHookTrap_03</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_number">4</span><span class="hl_char">(</span>#OF<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804e02e0</span>&nbsp;SE&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_number">5</span><span class="hl_char">(</span>#BR<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804e0441</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_number">6</span><span class="hl_char">(</span>#UD<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span>F68FA018&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания&nbsp;Syser<span class="hl_char">!</span>KiHookTrap_06</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_number">7</span><span class="hl_char">(</span>#NM<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E0C33</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_number">8</span><span class="hl_char">(</span>#DF<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0050</span><span class="hl_char">:</span><span class="hl_number">1188</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;Шлюз&nbsp;задачи</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_number">9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E1060</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;&nbsp;A<span class="hl_char">(</span>#TS<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E1185</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;&nbsp;B<span class="hl_char">(</span>#NP<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span>F68FA030&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания&nbsp;Syser<span class="hl_char">!</span>KiHookTrap_0B</li><li class="hl_l0">&nbsp;&nbsp;C<span class="hl_char">(</span>#SS<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span>F68FA048&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания&nbsp;Syser<span class="hl_char">!</span>KiHookTrap_0C</li><li class="hl_l1">&nbsp;&nbsp;D<span class="hl_char">(</span>#GP<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span>F68FA060&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания&nbsp;Syser<span class="hl_char">!</span>KiHookTrap_0D</li><li class="hl_l0">&nbsp;&nbsp;E<span class="hl_char">(</span>#PF<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span>F68F9FB8&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания&nbsp;Syser<span class="hl_char">!</span>KiHookTrap_0E</li><li class="hl_l1">&nbsp;&nbsp;F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E225A</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">10</span><span class="hl_char">(</span>#MF<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E237F</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">11</span><span class="hl_char">(</span>#AC<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E24BD</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">12</span><span class="hl_char">(</span>#MC<span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">00a0</span><span class="hl_char">:</span><span class="hl_number">804E225A</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;Шлюз&nbsp;задачи</li><li class="hl_l1">&nbsp;<span class="hl_number">13</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E262B</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">14</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E225A</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E225A</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E225A</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">17</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E225A</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">18</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E225A</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">19</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E225A</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">1A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E225A</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">1B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E225A</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">1C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E225A</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">1D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E225A</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">1E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E225A</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">1F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E225A</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;</li><li class="hl_l1">&nbsp;<span class="hl_number">21</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_number">22</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;</li><li class="hl_l1">&nbsp;<span class="hl_number">23</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_number">24</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;</li><li class="hl_l1">&nbsp;<span class="hl_number">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_number">26</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;</li><li class="hl_l1">&nbsp;<span class="hl_number">27</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_number">28</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;</li><li class="hl_l1">&nbsp;<span class="hl_number">29</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_number">2A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804DF417</span>&nbsp;SE&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">2B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804DF522</span>&nbsp;SE&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">2C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804DF6C7</span>&nbsp;SE&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">2D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span>F68FA078&nbsp;SE&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания&nbsp;Syser<span class="hl_char">!</span>KiHookTrap_2D</li><li class="hl_l0">&nbsp;<span class="hl_number">2E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804DEEA6</span>&nbsp;SE&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">2F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804E225A</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">806F447C</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">31</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span>F68F9FD0&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания&nbsp;Syser<span class="hl_char">!</span>KiHookTrap_31</li><li class="hl_l0">&nbsp;<span class="hl_number">32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804DE574</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">33</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">834D767C</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">34</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">835FDB94</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">8348166C</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">36</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804DE59C</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">37</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804DE5A6</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">38</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">806ED190</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">39</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">8355B48C</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">3A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">833BB044</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">3B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">833B9044</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">3C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span>F68FA090&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания&nbsp;Syser<span class="hl_char">!</span>KiHookTrap_3C</li><li class="hl_l1">&nbsp;<span class="hl_number">3D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804DE5E2</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">3E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">837DA954</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l1">&nbsp;<span class="hl_number">3F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">837D8DD4</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li><li class="hl_l0">&nbsp;<span class="hl_number">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">0008</span><span class="hl_char">:</span><span class="hl_number">804DE600</span>&nbsp;SE&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;шлюз&nbsp;прерывания</li>        </ol>
    </div>
</div></div>
<br><br>SE - бит присутствия сегмента.<br>Как видно, Syser.sys перехватывает #DB, #BP, #UD, #NP, #SS, #GP, #PF, INT 2D, INT 31, INT 3C. Дальше все обработчики от прерываний 3D до FF в ntoskrnl.exe. Три обработчика вызываются через шлюзы задач: NMI, #DF, #MC.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=251988&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=14" class="addthx" data-post="251988"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2010 21:47 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Таблица дескрипторов.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;обязательный&nbsp;нулевой&nbsp;дескриптор</li><li class="hl_l1"><span class="hl_number">8</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;FFFFFFFF&nbsp;<span class="hl_number">32</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Code</b></span>&nbsp;чтение&nbsp;было&nbsp;обращение&nbsp;</li><li class="hl_l0"><span class="hl_number">10</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;FFFFFFFF&nbsp;<span class="hl_number">32</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Data</b></span>&nbsp;запись&nbsp;было&nbsp;обращение&nbsp;</li><li class="hl_l1"><span class="hl_number">18</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;FFFFFFFF&nbsp;<span class="hl_number">32</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_function"><b>Code</b></span>&nbsp;чтение&nbsp;было&nbsp;обращение&nbsp;</li><li class="hl_l0"><span class="hl_number">20</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;FFFFFFFF&nbsp;<span class="hl_number">32</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_function"><b>Data</b></span>&nbsp;запись&nbsp;было&nbsp;обращение&nbsp;</li><li class="hl_l1"><span class="hl_number">28</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">80042000</span>&nbsp;<span class="hl_number">000020AB</span>&nbsp;<span class="hl_number">16</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;System&nbsp;&nbsp;Занятый&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;TSS</li><li class="hl_l0"><span class="hl_number">30</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;FFDFF000&nbsp;<span class="hl_number">00001FFF</span>&nbsp;<span class="hl_number">32</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Data</b></span>&nbsp;запись&nbsp;было&nbsp;обращение&nbsp;</li><li class="hl_l1"><span class="hl_number">38</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">00013000</span>&nbsp;<span class="hl_number">00000FFF</span>&nbsp;<span class="hl_number">32</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_function"><b>Data</b></span>&nbsp;запись&nbsp;было&nbsp;обращение&nbsp;</li><li class="hl_l0"><span class="hl_number">40</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">00000400</span>&nbsp;<span class="hl_number">0000FFFF</span>&nbsp;<span class="hl_number">16</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_function"><b>Data</b></span>&nbsp;запись&nbsp;</li><li class="hl_l1"><span class="hl_number">48</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_number">50</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">80550B80</span>&nbsp;<span class="hl_number">00000068</span>&nbsp;<span class="hl_number">16</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;System&nbsp;&nbsp;Занятый&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;TSS</li><li class="hl_l1"><span class="hl_number">58</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">80550BE8</span>&nbsp;<span class="hl_number">00000068</span>&nbsp;<span class="hl_number">16</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;System&nbsp;&nbsp;Свободный&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;TSS</li><li class="hl_l0"><span class="hl_number">60</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">00022F30</span>&nbsp;<span class="hl_number">0000FFFF</span>&nbsp;<span class="hl_number">16</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Data</b></span>&nbsp;запись&nbsp;было&nbsp;обращение&nbsp;</li><li class="hl_l1"><span class="hl_number">68</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">000B8000</span>&nbsp;<span class="hl_number">00003FFF</span>&nbsp;<span class="hl_number">16</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Data</b></span>&nbsp;запись&nbsp;</li><li class="hl_l0"><span class="hl_number">70</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;FFFF7000&nbsp;<span class="hl_number">000003FF</span>&nbsp;<span class="hl_number">16</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Data</b></span>&nbsp;запись&nbsp;</li><li class="hl_l1"><span class="hl_number">78</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">80400000</span>&nbsp;<span class="hl_number">0000FFFF</span>&nbsp;<span class="hl_number">16</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Code</b></span>&nbsp;чтение&nbsp;</li><li class="hl_l0"><span class="hl_number">80</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">80400000</span>&nbsp;<span class="hl_number">0000FFFF</span>&nbsp;<span class="hl_number">16</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Data</b></span>&nbsp;запись&nbsp;</li><li class="hl_l1"><span class="hl_number">88</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_number">90</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_number">98</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;</li><li class="hl_l0">A0&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">837EF048</span>&nbsp;<span class="hl_number">00000068</span>&nbsp;<span class="hl_number">16</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;System&nbsp;&nbsp;Свободный&nbsp;<span class="hl_number">32</span><span class="hl_char">-</span>битный&nbsp;TSS</li><li class="hl_l1">A8&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;</li><li class="hl_l0">B0&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;</li><li class="hl_l1">B8&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;</li><li class="hl_l0">C0&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;</li><li class="hl_l1">C8&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;</li><li class="hl_l0">D0&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;</li><li class="hl_l1">D8&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;</li><li class="hl_l0">E0&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;F77AF000&nbsp;<span class="hl_number">0000FFFF</span>&nbsp;<span class="hl_number">16</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Code</b></span>&nbsp;подчинненный&nbsp;чтение&nbsp;было&nbsp;обращение&nbsp;</li><li class="hl_l1">E8&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">0000FFFF</span>&nbsp;<span class="hl_number">16</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Data</b></span>&nbsp;запись&nbsp;</li><li class="hl_l0">F0&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;<span class="hl_number">804D8B28</span>&nbsp;<span class="hl_number">0003CF7B</span>&nbsp;<span class="hl_number">16</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Code</b></span>&nbsp;было&nbsp;обращение&nbsp;</li><li class="hl_l1">F8&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;F7BE0000&nbsp;<span class="hl_number">0000FFFF</span>&nbsp;<span class="hl_number">16</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Data</b></span>&nbsp;запись&nbsp;было&nbsp;обращение&nbsp;</li><li class="hl_l0"><span class="hl_number">100</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;F77BF000&nbsp;<span class="hl_number">0000FFFF</span>&nbsp;<span class="hl_number">32</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Data</b></span>&nbsp;запись&nbsp;было&nbsp;обращение&nbsp;</li><li class="hl_l1"><span class="hl_number">108</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;F77BF000&nbsp;<span class="hl_number">0000FFFF</span>&nbsp;<span class="hl_number">32</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Data</b></span>&nbsp;запись&nbsp;было&nbsp;обращение&nbsp;</li><li class="hl_l0"><span class="hl_number">110</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;F77BF000&nbsp;<span class="hl_number">0000FFFF</span>&nbsp;<span class="hl_number">32</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Data</b></span>&nbsp;запись&nbsp;было&nbsp;обращение&nbsp;</li><li class="hl_l1"><span class="hl_number">118</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;F780F000&nbsp;<span class="hl_number">0000FFFF</span>&nbsp;<span class="hl_number">16</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Code</b></span>&nbsp;подчинненный&nbsp;чтение&nbsp;было&nbsp;обращение&nbsp;</li><li class="hl_l0"><span class="hl_number">120</span>&nbsp;<span class="hl_char">-</span>&nbsp;&nbsp;F733AFA0&nbsp;<span class="hl_number">0000FFFF</span>&nbsp;<span class="hl_number">32</span>&nbsp;P&nbsp;DPL&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_function"><b>Data</b></span>&nbsp;запись&nbsp;было&nbsp;обращение</li>        </ol>
    </div>
</div></div>
<br><br>P - бит присутствия сегмента<br>Непонятно, почему у системных дескрипторов разрядность 16, а TSS - 32битные. Также непонятен вызов обработчика #MC через дескриптор A0. Но ошибки нет - парсинг макросом.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=252034&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=15" class="addthx" data-post="252034"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2010 16:33 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>HiEndsoft</b> тут неадекватно отозвался о моем блоге... Нельязя так... <b>[09 апреля 2010 г.]ПОТЕРТО - ГОРМОНЫ У ВСЕХ УСПОКОИЛИСЬ <img src="img/smilies/s5.gif" alt=""></b>
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=252128&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=16" class="addthx" data-post="252128"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2010 23:08 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Если не уймётесь, я обоих в бан отправлю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=252164&amp;user=1556&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=17" class="addthx" data-post="252164"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 февраля 2010 18:51 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Если прыгнуть по одному из адресов обработчиков в Syser, прописанных в таблице, то мы окажемся в секции данных в окружении одних нулей. Это говорит о том, функция установки хуков на прерывания прописывает туда код, который уже передает управление одной из функций обработчиков, и вписывает в стек возврат на виндовый обработчик. Есть интерес более детально ее пореверсить. Также нужно выяснить, в какой виртуальной задаче произошло исключение #UD. <br><br>Пореверсив немного виндовый обработчик _KiTrap_06, выяснил, что источник исключения #UD и есть инструкция по адресу 1000:0002 или 10002 в защищенном режиме. Обработчик сравнивает четыре байта по адресу инструкции-источника с 1) C4 C4 50 42 и 2) C4 C4 50 43, но ничего такого у нас нет (у нас C4 C4 FE 00), и обработчик сравнивает два байта с С4 С4. Не странно ли? Как будто исключение #UD по адресу 1000:0002 - необходимая часть работы системы. <img src="img/smilies/s5.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=252229&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=18" class="addthx" data-post="252229"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2010 22:22 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Занопил установку хука на 6 исключение и уаля, хотя бы при старте винды комп не вылетает в BSOD. <img src="img/smilies/s1.gif" alt=""><br><br>Но и syser.sys не грузится.<br>Что-то странное происходит. Обработка любого исключения вызывает рекурсивные #GP(0). Команда вида mov dword ptr ss:Address, r32 вызывает #SS и вслед за ним те же рекурсии с #GP. Бред какой-то...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=252364&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=19" class="addthx" data-post="252364"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2010 21:01 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
Ладно, с праздиком тебя! И давай расскажи, что у тебя такое случилось.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=252455&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=20" class="addthx" data-post="252455"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2010 22:09 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Один понял сообщение, видимо, второй не понял. На 3 дня бан.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=252462&amp;user=1556&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=21" class="addthx" data-post="252462"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2010 00:29 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Отдохнул несколько дней. Решил опять немного покопаться в сисере. И меня осенило, я просто был невнимателен к информации в WinDbg...<br><br>Отдыхая от этого занятия несколько дней, я все время думал, как может происходить исключение при обращениях по адресам, по которым недавно все было нормально. И вот глянув в очередной раз на уже надоевший анализ WinDbg, я заметил<br><br>f5550819 f00fba2d3cfb68f51f lock bts dword ptr [Syser!gpSyserPluginUI+0x12e0 (f568fb3c)],1Fh ds:0120:f568fb3c=????????<br><br>Так ведь дело то в том, что ds = 120, лимит у этого сегмента FFFF, а адрес по которому обращение - выходит за эти пределы. Это и вызывает исключение #GP(0). Рекурсивное.<br><br>Дальше, посмотрев еще раз на регистры в момент краша, увидел tr = 50. Залез в этот TSS, там в принципе были уже все данные для KeBugCheck2, которая, похоже, и выводит синий экран. Посмотрел в стек этой задачи. Вызов был из tss = 28. Сохраненные регистры этой задачи находятся в 80042000. Оттуда вывел ss = F8. С ним та же самая история, что и с ds = 120 - команда mov     ss:byte_F569212B, 1 по адресу F557C71C вызывает иссключение #SS, поскольку адрес заходит за границы лимита (В случае, если syser.sys грузится с ситемой, то все начинается с #UD; при ручной загрузке первая проблема - #SS).<br><br>В случае ds можно было б предположить, что где-то он сбивается. Но ss в большинстве случаев нет необходимости использовать явно. Значит, скорее всего, в драйвере ошибочное использование сегментных регистров.<br><br>Но что теперь? Syser.sys не дает себя менять так просто. Он в каком-то месте проверяет свою котрольную сумму или хеш и в случае изменений не грузится. А так было бы простым решением изменить пару байт... Эту проблему надо решить.<br><br>Также непонятно, каким чудом у других Syser Debugger работает?<br>Возможны несколько тому причин:<br>1) Дескрипторы в GDT по другому определены в системе<br>2) Для TSS = 28 системой не используются данные селекторы, cs = 8, а ds = es = ss = 10<br>3) Какой-то драйвер сбивает селекторы<br>4) Неведомо откуда syser.sys другой<br>5) Что-то еще...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=252698&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=22" class="addthx" data-post="252698"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]-=Hellsing=-[/b]','')">-=Hellsing=-</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 25.8 (посетитель), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.73'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18541">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2010 15:15 &middot; Поправил: -=Hellsing=- <br><script type="text/javascript">QU('-=Hellsing=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=Hellsing=-" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Также непонятно, каким чудом у других Syser Debugger работает? </I><br><br>К примеру, также как и SoftIce на одних осях он работает, а на других нет. У меня, к примеру, и SoftIce и Syser нормально работают в XP SP2 (Если конечно винда чистая).<br><br>Но насчёт Syser Debugge нет такой тенденции как у SoftIce ты, наверное, первый у кого Syser Debugge не хочет работать. <br><br>Вот мой Syser.sys сам Syser скачивал от <a href="http://www.exelab.ru/download.php?action=list&amp;n=MTA=" target="_blank">отсюдова</a>.<br><img src="img/attach.gif" alt=""> <a href="./files/4bab_27.02.2010_CRACKLAB.rU.tgz">4bab_27.02.2010_CRACKLAB.rU.tgz</a> - Syser.sys.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=252733&amp;user=18541&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=23" class="addthx" data-post="252733"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2010 17:59 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
Это кстати  от 1185. <img src="img/smilies/s1.gif" alt=""><br><br>В общем ясно - можно исключить 4-ый пункт. Значит какой-то драйвер сбивает селекторы или возникают какие-то условия, при которых выполняется код, в котором сам драйвер их сбивает. Будем искать... Пока отдыхаю.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=252743&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=24" class="addthx" data-post="252743"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 марта 2010 02:33 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>Дистриб опять 1195, взят с форума</b><br><br>Изменил один байт ради интереса в syser.sys. Заменил префикс ss на команду NOP. Теперь вместо первого #SS возникает #GP. Если селекторы сбиты, то так и должно быть...<br><br>Нашел дальше в стеке, за адресом возникновения первого исключения, следующее:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">f7be2a50&nbsp;&nbsp;f53e071d&nbsp;<span class="hl_char">-</span>&nbsp;eip<span class="hl_char">,</span>&nbsp;адрес&nbsp;инструкции<span class="hl_char">,</span>&nbsp;на&nbsp;которой&nbsp;возникло&nbsp;первое&nbsp;#GP&nbsp;<span class="hl_char">(</span>раньше&nbsp;#SS<span class="hl_char">)</span></li><li class="hl_l1">f7be2a54&nbsp;&nbsp;<span class="hl_number">00000008</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_registr">cs</span></li><li class="hl_l0">f7be2a58&nbsp;&nbsp;<span class="hl_number">00010097</span>&nbsp;<span class="hl_char">-</span>&nbsp;EFLAGS</li><li class="hl_l1">f7be2a5c&nbsp;&nbsp;<span class="hl_number">833a7044</span>&nbsp;<span class="hl_char">-</span>&nbsp;обработчик&nbsp;прерывания&nbsp;<span class="hl_number">3C</span><span class="hl_char">,</span>&nbsp;см<span class="hl_char">.</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l0">f7be2a60&nbsp;&nbsp;<span class="hl_number">000080e5</span>&nbsp;<span class="hl_char">-</span>&nbsp;должен&nbsp;быть&nbsp;eip<span class="hl_char">,</span>&nbsp;адрес&nbsp;последней&nbsp;команды</li><li class="hl_l1">f7be2a64&nbsp;&nbsp;<span class="hl_number">00000118</span>&nbsp;<span class="hl_char">-</span>&nbsp;должен&nbsp;быть&nbsp;<span class="hl_registr">cs</span></li><li class="hl_l0">f7be2a68&nbsp;<span class="hl_number">00000202</span>&nbsp;<span class="hl_char">-</span>&nbsp;очень&nbsp;похоже&nbsp;на&nbsp;EFLAGS</li><li class="hl_l1">f7be2a6c&nbsp;<span class="hl_number">00f001fa</span>&nbsp;<span class="hl_char">-</span>&nbsp;при&nbsp;межсегментном&nbsp;переключении&nbsp;должно&nbsp;быть&nbsp;<span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">(</span>в&nbsp;старших&nbsp;<span class="hl_number">16</span>&nbsp;битах&nbsp;возможно&nbsp;просто&nbsp;мусор<span class="hl_char">)</span></li><li class="hl_l0">f7be2a70&nbsp;&nbsp;<span class="hl_number">0000530b</span>&nbsp;<span class="hl_char">-</span>&nbsp;при&nbsp;межсегментном&nbsp;переключении&nbsp;должно&nbsp;быть&nbsp;<span class="hl_registr">ss</span></li><li class="hl_l1">f7be2a74&nbsp;&nbsp;f7beff40</li><li class="hl_l0">f7be2a78&nbsp;&nbsp;f7be2dcc</li><li class="hl_l1">f7be2a7c&nbsp;&nbsp;f7be2d74</li>        </ol>
    </div>
</div></div>
<br><br>(1) Проверил каждый установленный сисером обработчик прерываний и нашел для INT 3C:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">f54f4050&nbsp;<span class="hl_number">6844703a83</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">833A7044h</span></li><li class="hl_l1">f54f4055&nbsp;<span class="hl_number">6812073ef5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;Syser<span class="hl_char">!</span>DllUnload<span class="hl_char">+</span>0x34754&nbsp;<span class="hl_char">(</span>f53e0712<span class="hl_char">)</span></li><li class="hl_l0">f54f405a&nbsp;c3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">ret</span></li>        </ol>
    </div>
</div></div>
<br><br>Это сходится с тем, что в стеке. Команда !address показывает, что это в невыгружаемом пуле, а поиск файла по первым байтам в системной папке находит только ntoskrnl.exe, но смещения для некоторых дальних джампов изменены. Кто-то скопировал полностью обработчик и поправил смещения...<br><br>Если теперь сравнить обработчик в сисере (f53acef6) с предположительно виндовым, то можно увидеть, что якобы виндовый приводит сначала селекторы в порядок (фрагменты кода помечены 2 и 3), а потом уже начинает обработку! Этого нет в сисере!!!<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;<span class="hl_char">&lt;</span>b<span class="hl_char">&gt;</span>Обработчик&nbsp;сисера<span class="hl_char">&lt;</span><span class="hl_char">/</span>b<span class="hl_char">&gt;</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0712&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_F53E0712&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; CODE XREF: .text:F53E0772j</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53E0712&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; DATA XREF: .text:F53AD7E5o</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0712&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">cs</span><span class="hl_char">:</span>byte_F54F3B05<span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E071A&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_F53E0725</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E071C&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">nop</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E071D&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">dd</span><span class="hl_char">:</span>byte_F54F612B<span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0724&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">retn</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0725&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------- -----</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0725</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0725&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_F53E0725<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:F53E071Aj</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0725&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0729&nbsp;<span class="hl_char">-</span><span class="hl_number">04</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">pusha</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E072A&nbsp;<span class="hl_number">01C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">pushf</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E072B&nbsp;<span class="hl_number">020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">64h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; AT Keyboard controller 8042.</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E072D&nbsp;<span class="hl_number">020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FFh</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0732&nbsp;<span class="hl_number">020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte_F54F613C<span class="hl_char">,</span>&nbsp;<span class="hl_registr">al</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0737&nbsp;<span class="hl_number">020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0739&nbsp;<span class="hl_number">020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">60h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; AT Keyboard controller 8042.</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E073B&nbsp;<span class="hl_number">020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte_F54C15E4<span class="hl_char">,</span>&nbsp;<span class="hl_registr">al</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0740&nbsp;<span class="hl_number">020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_F53E004C</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0745&nbsp;<span class="hl_number">020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dword_F54F8290</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E074B&nbsp;<span class="hl_number">020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0Ch</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E074D&nbsp;<span class="hl_number">024</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_F53DFC7C</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0752&nbsp;<span class="hl_number">024</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">popf</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0753&nbsp;<span class="hl_number">020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">popa</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0754&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">iret</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53E0754&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_F53E0712&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>endp</b></span>&nbsp;<span class="hl_comment">; sp-analysis failed</span></li>        </ol>
    </div>
</div></div>
<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;<span class="hl_char">&lt;</span>b<span class="hl_char">&gt;</span>Предположительно&nbsp;виндовый&nbsp;обработчик<span class="hl_char">&lt;</span><span class="hl_char">/</span>b<span class="hl_char">&gt;</span></li><li class="hl_l1"><span class="hl_number">833a7044</span>&nbsp;<span class="hl_number">54</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0"><span class="hl_number">833a7045</span>&nbsp;<span class="hl_number">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_number">833a7046</span>&nbsp;<span class="hl_number">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">833a7047</span>&nbsp;<span class="hl_number">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_number">833a7048</span>&nbsp;<span class="hl_number">57</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0"><span class="hl_number">833a7049</span>&nbsp;<span class="hl_number">83ec54</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>sub</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span><span class="hl_number">54h</span></li><li class="hl_l1"><span class="hl_number">833a704c</span>&nbsp;<span class="hl_number">8bec</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span><span class="hl_registr">esp</span></li><li class="hl_l0"><span class="hl_number">833a704e</span>&nbsp;<span class="hl_number">89442444</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">44h</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_number">833a7052</span>&nbsp;<span class="hl_number">894c2440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">40h</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_number">833a7056</span>&nbsp;<span class="hl_number">8954243c</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">3Ch</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">edx</span></li><li class="hl_l1"><span class="hl_number">833a705a</span>&nbsp;f744247000000200&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">70h</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">20000h</span></li><li class="hl_l0"><span class="hl_number">833a7062</span>&nbsp;<span class="hl_number">0f852a010000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jne</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">833a7192</span></li><li class="hl_l1"><span class="hl_number">833a7068</span>&nbsp;<span class="hl_number">66837c246c08</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>word</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">6Ch</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">8</span></li><li class="hl_l0"><span class="hl_number">833a706e</span>&nbsp;<span class="hl_number">7423</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>je</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">833a7093</span></li><li class="hl_l1"><span class="hl_number">833a7070</span>&nbsp;<span class="hl_number">8c642450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>word</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">50h</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">fs</span></li><li class="hl_l0"><span class="hl_number">833a7074</span>&nbsp;<span class="hl_number">8c5c2438</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>word</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">38h</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ds</span></li><li class="hl_l1"><span class="hl_number">833a7078</span>&nbsp;<span class="hl_number">8c442434</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>word</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">34h</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">es</span></li><li class="hl_l0"><span class="hl_number">833a707c</span>&nbsp;<span class="hl_number">8c6c2430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>word</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">30h</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">gs</span></li><li class="hl_l1"><span class="hl_char">(</span><span class="hl_number">2</span><span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_number">833a7080</span>&nbsp;bb30000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span><span class="hl_number">30h</span></li><li class="hl_l1"><span class="hl_number">833a7085</span>&nbsp;b823000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_number">23h</span></li><li class="hl_l0"><span class="hl_number">833a708a</span>&nbsp;<span class="hl_number">668ee3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">fs</span><span class="hl_char">,</span><span class="hl_registr">bx</span></li><li class="hl_l1"><span class="hl_number">833a708d</span>&nbsp;<span class="hl_number">668ed8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">,</span><span class="hl_registr">ax</span></li><li class="hl_l0"><span class="hl_number">833a7090</span>&nbsp;<span class="hl_number">668ec0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">es</span><span class="hl_char">,</span><span class="hl_registr">ax</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_number">833a7093</span>&nbsp;<span class="hl_number">648b1d00000000</span>&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">833a709a</span>&nbsp;<span class="hl_number">64c70500000000ffffffff</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0FFFFFFFFh</span></li><li class="hl_l0"><span class="hl_number">833a70a5</span>&nbsp;<span class="hl_number">895c244c</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">4Ch</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_number">833a70a9</span>&nbsp;<span class="hl_number">81fc00000100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span><span class="hl_number">10000h</span></li><li class="hl_l0"><span class="hl_number">833a70af</span>&nbsp;<span class="hl_number">0f82b5000000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jb</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">833a716a</span></li><li class="hl_l1"><span class="hl_number">833a70b5</span>&nbsp;c744246400000000&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">64h</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_number">833a70bd</span>&nbsp;fc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">cld</span></li><li class="hl_l1"><span class="hl_number">833a70be</span>&nbsp;<span class="hl_number">8b5d60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">60h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">833a70c1</span>&nbsp;<span class="hl_number">8b7d68</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">68h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">833a70c4</span>&nbsp;<span class="hl_number">89550c</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">0Ch</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_number">833a70c7</span>&nbsp;c74508000ddbba&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0BADB0D00h</span></li><li class="hl_l1"><span class="hl_number">833a70ce</span>&nbsp;<span class="hl_number">895d00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">833a70d1</span>&nbsp;<span class="hl_number">897d04</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">edi</span></li><li class="hl_l1"><span class="hl_number">833a70d4</span>&nbsp;f60550f0dfffff&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">0FFDFF050h</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0FFh</span></li><li class="hl_l0"><span class="hl_number">833a70db</span>&nbsp;<span class="hl_number">750d</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jne</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">833a70ea</span></li><li class="hl_l1"><span class="hl_number">833a70dd</span>&nbsp;bf08703a83&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span><span class="hl_number">833A7008h</span></li><li class="hl_l0"><span class="hl_number">833a70e2</span>&nbsp;e97b3c13fd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nt<span class="hl_char">!</span>KiInterruptDispatch&nbsp;<span class="hl_char">(</span><span class="hl_number">804dad62</span><span class="hl_char">)</span></li><li class="hl_l1"><span class="hl_number">833a70e7</span>&nbsp;<span class="hl_number">8d4900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ecx</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">833a70ea</span>&nbsp;f7457000000200&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">70h</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">20000h</span></li><li class="hl_l1"><span class="hl_number">833a70f1</span>&nbsp;<span class="hl_number">7509</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jne</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">833a70fc</span></li><li class="hl_l0"><span class="hl_number">833a70f3</span>&nbsp;f7456c01000000&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">6Ch</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_number">833a70fa</span>&nbsp;<span class="hl_number">74e1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>je</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">833a70dd</span></li><li class="hl_l0"><span class="hl_number">833a70fc</span>&nbsp;<span class="hl_number">0f21c3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>dr0</li><li class="hl_l1"><span class="hl_number">833a70ff</span>&nbsp;<span class="hl_number">0f21c9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>dr1</li><li class="hl_l0"><span class="hl_number">833a7102</span>&nbsp;<span class="hl_number">0f21d7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>dr2</li><li class="hl_l1"><span class="hl_number">833a7105</span>&nbsp;<span class="hl_number">895d18</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">18h</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">833a7108</span>&nbsp;<span class="hl_number">894d1c</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">1Ch</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_number">833a710b</span>&nbsp;<span class="hl_number">897d20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">20h</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">edi</span></li><li class="hl_l0"><span class="hl_number">833a710e</span>&nbsp;<span class="hl_number">0f21db</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>dr3</li><li class="hl_l1"><span class="hl_number">833a7111</span>&nbsp;<span class="hl_number">0f21f1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>dr6</li><li class="hl_l0"><span class="hl_number">833a7114</span>&nbsp;<span class="hl_number">0f21ff</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>dr7</li><li class="hl_l1"><span class="hl_number">833a7117</span>&nbsp;<span class="hl_number">895d24</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">24h</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">833a711a</span>&nbsp;<span class="hl_number">894d28</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">28h</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_number">833a711d</span>&nbsp;<span class="hl_number">33db</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span><span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">833a711f</span>&nbsp;<span class="hl_number">897d2c</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">2Ch</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">edi</span></li><li class="hl_l1"><span class="hl_number">833a7122</span>&nbsp;<span class="hl_number">0f23fb</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dr7<span class="hl_char">,</span><span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">833a7125</span>&nbsp;<span class="hl_number">648b3d20000000</span>&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">20h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">833a712c</span>&nbsp;<span class="hl_number">8b9ff8020000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_number">2F8h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">833a7132</span>&nbsp;<span class="hl_number">8b8ffc020000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_number">2FCh</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">833a7138</span>&nbsp;<span class="hl_number">0f23c3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dr0<span class="hl_char">,</span><span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">833a713b</span>&nbsp;<span class="hl_number">0f23c9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dr1<span class="hl_char">,</span><span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_number">833a713e</span>&nbsp;<span class="hl_number">8b9f00030000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_number">300h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">833a7144</span>&nbsp;<span class="hl_number">8b8f04030000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_number">304h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">833a714a</span>&nbsp;<span class="hl_number">0f23d3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dr2<span class="hl_char">,</span><span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">833a714d</span>&nbsp;<span class="hl_number">0f23d9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dr3<span class="hl_char">,</span><span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_number">833a7150</span>&nbsp;<span class="hl_number">8b9f08030000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_number">308h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">833a7156</span>&nbsp;<span class="hl_number">8b8f0c030000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_number">30Ch</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">833a715c</span>&nbsp;<span class="hl_number">0f23f3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dr6<span class="hl_char">,</span><span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">833a715f</span>&nbsp;<span class="hl_number">0f23f9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dr7<span class="hl_char">,</span><span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_number">833a7162</span>&nbsp;e976ffffff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">833a70dd</span></li><li class="hl_l0"><span class="hl_number">833a7167</span>&nbsp;<span class="hl_number">8d4900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ecx</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">833a716a</span>&nbsp;<span class="hl_number">8b442464</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">64h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">833a716e</span>&nbsp;b910000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_number">10h</span></li><li class="hl_l1"><span class="hl_number">833a7173</span>&nbsp;<span class="hl_number">8bd4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span><span class="hl_registr">esp</span></li><li class="hl_l0"><span class="hl_number">833a7175</span>&nbsp;c1e010&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>shl</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_number">10h</span></li><li class="hl_l1"><span class="hl_number">833a7178</span>&nbsp;<span class="hl_number">64031508000000</span>&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">8</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">833a717f</span>&nbsp;<span class="hl_number">89442464</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">64h</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">(</span><span class="hl_number">3</span><span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_number">833a7183</span>&nbsp;<span class="hl_number">668ed1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ss</span><span class="hl_char">,</span><span class="hl_registr">cx</span></li><li class="hl_l1"><span class="hl_number">833a7186</span>&nbsp;<span class="hl_number">8be2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span><span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_number">833a7188</span>&nbsp;<span class="hl_number">8bea</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span><span class="hl_registr">edx</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_number">833a718a</span>&nbsp;e92effffff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">833a70bd</span></li>        </ol>
    </div>
</div></div>
<br><br>Теперь понятно, почему при первом исключении сисер сохраняет ebp = e1820000... Но что за адрес 118:80e5 ? WinDbg ничего не дает в ответ на этот запрос. Она просто не находит его в известных диапазонах адресов...<br><br>Нужен ntoskrnl.exe из папки %SystemRoot%\System32\ от Windows XP Pro SP2 для сравнения со своим. MD5-хэш моего B9D0F564511439E9C64F92387C622222, размер - 2 182 784 байт. Кто может, подсобите, плиз!
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=252866&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=25" class="addthx" data-post="252866"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]-=Hellsing=-[/b]','')">-=Hellsing=-</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 25.8 (посетитель), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.73'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18541">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 марта 2010 10:48 &middot; Поправил: -=Hellsing=- <br><script type="text/javascript">QU('-=Hellsing=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=Hellsing=-" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Нужен ntoskrnl.exe из папки %SystemRoot%\System32\ от Windows XP Pro SP2 для сравнения со своим. MD5-хэш моего B9D0F564511439E9C64F92387C622222. </I><br><br><noindex><a href="http://narod.ru/disk/18353667000/ntoskrnl.exe.html" rel="nofollow" target="_blank">--&gt; ntoskrnl.exe &lt;--</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=252883&amp;user=18541&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=26" class="addthx" data-post="252883"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 марта 2010 13:06 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
В этом ntoskrnl на 32384 байт меньше, приведенный обработчик 3C содержит несущественные изменения, версии совпадают, внутренние имена нет - у меня ntoskrnl.exe, в этом - ntkrnlmp.exe. Почти все то же самое...<br>Размер: 2 150 400 байт<br>MD5-хэш: F571D3CBE7BF4119E85880A3FE64BD74<br><br>В общем, понятно уже, что разработчики сисера кое-чего не учли и допустили ошибку, которая не проявляет себя с другими аппаратными конфигурациями. Но найти ошибку мало, нужно теперь решение проблемы. Ко мне в голову приходят основных 2 варианта:<br>1) Сообщить разрабам сисера о найденной ошибке<br>2) Исправить самому - написать свой обработчик для сисера или модифицировать установщик хука на INT 3C так, чтобы модифицировался виндовый, чтобы восстановление селекторов происходило перед передачей управления в обработчик сисера, затем прыг в обработчик и затем в KiInterruptDispatch.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=252892&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=27" class="addthx" data-post="252892"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 марта 2010 13:38 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
Оптимально - вариант №1, но судя по топу ты воспользуешься №2 <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=252894&amp;user=2585&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=28" class="addthx" data-post="252894"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 марта 2010 17:56 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<img src="img/smilies/s1.gif" alt=""> Да, ты прав. Можно сообщить об ошибке, как параллельное решение проблемы. Только кто этим займется? Я по-английски читаю только технические тексты. Пробовал как-то с Израильским программистом по аське общаться - кое-как поняли друг друга. В общем если кто-нить вдруг захочет связаться с разработчиками, то нужно перевести и отправить им этот текст:<br><br><I>&quot;В драйвере syser.sys обнаружена ошибка. Ее смысл в том, что возникает прерывание (<b>у меня INT 3C, на компьютерах с другой конфигурацией номер может отличаться</b>) в то время, когда выполняется код 16-битного драйвера, а установленный на него в syser.sys обработчик не восстанавливает селекторы ds, es и ss. Это влечет за собой рекурсивную обработку #GP до переполнения стека, что и приводит к #DF и BSOD. Данная ошибка проявляется не на всех аппаратных конфигурациях. Как вариант исправления данной ошибки предлагается исправить код установки хука на это прерывание по смещению 0x27DB от начала файла syser.sys таким образом, чтобы перед началом его обработки селекторы приводились в порядок для правильной адресации глобальных переменных.&quot;</I><br><br>Кстати все то же самое и к #UD относится и все остальные хученные исключения и прерывания надо просмотреть. Лично я пока не понимаю, неужели в Win32 еще есть 16-битные драйвера и как так этого не учли разработчики.<br><br>Пока разберусь дальше с установкой хука на прерывание 3C. В зависимости от даты креш-дампа база syser.sys может отличаться, т.к. для удобства я в иде перебазирую драйвер. Сейчас рассматривается код сисера с базой 0xF53AB000. Код установки хука:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53AD7DB&nbsp;<span class="hl_number">014</span>&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">0C</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0Ch</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53AD7DD&nbsp;<span class="hl_number">018</span>&nbsp;E8&nbsp;<span class="hl_number">78</span>&nbsp;<span class="hl_number">24</span>&nbsp;<span class="hl_number">03</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_F53DFC5A<span class="hl_comment">; определяет номер прерывания</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53AD7E2&nbsp;<span class="hl_number">014</span>&nbsp;<span class="hl_number">53</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>ebx</b></span><span class="hl_comment">; 0</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53AD7E3&nbsp;<span class="hl_number">018</span>&nbsp;<span class="hl_number">57</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>edi</b></span><span class="hl_comment">; 4</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53AD7E4&nbsp;<span class="hl_number">01C</span>&nbsp;<span class="hl_number">56</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>esi</b></span><span class="hl_comment">; 0x10</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53AD7E5&nbsp;<span class="hl_number">020</span>&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">12</span>&nbsp;<span class="hl_number">07</span>&nbsp;<span class="hl_number">3E</span>&nbsp;F5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;sub_F53E0712<span class="hl_comment">; обработчик прерывания</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53AD7EA&nbsp;<span class="hl_number">024</span>&nbsp;<span class="hl_number">50</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>eax</b></span><span class="hl_comment">; номер прерывания, у меня 3C</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53AD7EB&nbsp;<span class="hl_number">028</span>&nbsp;A3&nbsp;<span class="hl_number">40</span>&nbsp;<span class="hl_number">61</span>&nbsp;<span class="hl_number">4F</span>&nbsp;F5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dword_F54F6140<span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53AD7F0&nbsp;<span class="hl_number">028</span>&nbsp;E8&nbsp;<span class="hl_number">81</span>&nbsp;<span class="hl_number">6B</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_F53B4376<span class="hl_comment">; установщик хука</span></li>        </ol>
    </div>
</div></div>
<br><br>Код функции определения номера прерывания:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_F53DFC5A&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; CODE XREF: .text:F53AD6D5p</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53DFC5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53AD7DDp</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53DFC5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53E887Dp</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC5A</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">4</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC5A</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; FUNCTION CHUNK AT .text:F53DF744 SIZE 00000016 BYTES</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC5A</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC5A&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte_F54F5890<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC61&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jnz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_F53DFC76</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC63&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span>arg_0<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC67&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">10h</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC6A&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jnb</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_F53DFC72</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC6C&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">30h</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC6F</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC6F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;locret_F53DFC6F<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:F53DFC74j</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC6F&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>retn</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">4</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC72&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------- -----</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC72</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC72&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_F53DFC72<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:F53DFC6Aj</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC72&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC74&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;locret_F53DFC6F</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC76&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------- -----</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC76</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC76&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_F53DFC76<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:F53DFC61j</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC76&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_F53DF744</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DFC76&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_F53DFC5A&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">endp</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53DF744&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; START OF FUNCTION CHUNK FOR sub_F53DFC5A</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DF744</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53DF744&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_F53DF744</span><span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; CODE XREF: .text:loc_F53DFC76j</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DF744&nbsp;<span class="hl_number">000</span>&nbsp;<span class="hl_number">8B</span>&nbsp;<span class="hl_number">44</span>&nbsp;<span class="hl_number">24</span>&nbsp;<span class="hl_number">04</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span>arg_0<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DF748&nbsp;<span class="hl_number">000</span>&nbsp;<span class="hl_number">8D</span>&nbsp;<span class="hl_number">44</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">10</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">10h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DF74C&nbsp;<span class="hl_number">000</span>&nbsp;<span class="hl_number">50</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DF74D&nbsp;<span class="hl_number">004</span>&nbsp;E8&nbsp;<span class="hl_number">5C</span>&nbsp;FF&nbsp;FF&nbsp;FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_F53DF6AE</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DF752&nbsp;<span class="hl_number">000</span>&nbsp;<span class="hl_number">25</span>&nbsp;FF&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FFh</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53DF757&nbsp;<span class="hl_number">000</span>&nbsp;C2&nbsp;<span class="hl_number">04</span>&nbsp;<span class="hl_number">00</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>retn</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">4</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53DF757&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; END OF FUNCTION CHUNK FOR sub_F53DFC5A</span></li>        </ol>
    </div>
</div></div>
<br><br>Алгоритм вычисления этого номера зависит от байтовой переменной (возможно булевой) по адресу F54F5890. Если она равна нулю, номер определяется просто - IntNum = Arg0 + 0x30 = 0x3C.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=252916&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=29" class="addthx" data-post="252916"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 марта 2010 23:42 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15786&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
Код функции установщика хука<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_F53B4376&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; CODE XREF: .text:F53AB8F6p</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53AD6FDp</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53AD719p</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53AD72Ap</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53AD746p</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53AD762p</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53AD771p</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53AD780p</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53AD78Fp</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53AD7A6p</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53AD7C6p</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53AD7F0p</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53AD80Ep</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53AD828p</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4376</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NewIrql&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">8</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">0Ch</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">10h</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">14h</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4376&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">18h</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4376</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4376&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4377&nbsp;<span class="hl_number">004</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4379&nbsp;<span class="hl_number">004</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B437A&nbsp;<span class="hl_number">008</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B437B&nbsp;<span class="hl_number">00C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B437C&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>KeGetCurrentIrql</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4382&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">cl</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1Fh</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; NewIrql</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4384&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>NewIrql<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">al</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4387&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>KfRaiseIrql</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B438D&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">pushf</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B438E&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">cli</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B438F&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;dword_F54C7B1C&nbsp;<span class="hl_comment">; ? Число процессоров</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4394&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4396&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4397&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4399&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jbe</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_F53B43E0</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B439B&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B439D&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B439F&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jbe</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_F53B43CE</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43A1</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43A1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_F53B43A1<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:F53B43CCj</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43A1&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_10<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43A4&nbsp;<span class="hl_number">018</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;off_F54C7B24</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43A9&nbsp;<span class="hl_number">018</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_C<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43AC&nbsp;<span class="hl_number">01C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_registr">esi</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43AF&nbsp;<span class="hl_number">01C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_8<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43B2&nbsp;<span class="hl_number">020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">38h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43B5&nbsp;<span class="hl_number">020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_4<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43B8&nbsp;<span class="hl_number">024</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43B9&nbsp;<span class="hl_number">028</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_0<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43BC&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_F53B392E</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43C1&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43C3&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_F53B4400</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43C5&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43C6&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;dword_F54C7B1C</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43CC&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jb</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_F53B43A1</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43CE</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43CE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_F53B43CE<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:F53B439Fj</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B43CE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53B43FEj</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43CE&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">popf</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43CF</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43CF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_F53B43CF<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:F53B4403j</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43CF&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">cl</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>NewIrql<span class="hl_char">]</span>&nbsp;<span class="hl_comment">; NewIrql</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43D2&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>KfLowerIrql</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43D8&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43D9&nbsp;<span class="hl_number">00C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">bl</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43DB&nbsp;<span class="hl_number">00C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43DC&nbsp;<span class="hl_number">008</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">leave</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43DD&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>retn</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">14h</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43E0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------- -----</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43E0</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43E0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_F53B43E0<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:F53B4399j</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43E0&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43E2&nbsp;<span class="hl_number">018</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_F53B3804</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43E7&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_10<span class="hl_char">]</span><span class="hl_comment">; 0</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43EA&nbsp;<span class="hl_number">018</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_C<span class="hl_char">]</span><span class="hl_comment">; 4</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43ED&nbsp;<span class="hl_number">01C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_8<span class="hl_char">]</span><span class="hl_comment">; 0x10</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43F0&nbsp;<span class="hl_number">020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_4<span class="hl_char">]</span><span class="hl_comment">; новый обработчик</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43F3&nbsp;<span class="hl_number">024</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>eax</b></span><span class="hl_comment">; база IDT</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43F4&nbsp;<span class="hl_number">028</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_0<span class="hl_char">]</span><span class="hl_comment">; номер прерывания</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43F7&nbsp;<span class="hl_number">02C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_F53B392E</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43FC&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B43FE&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jnz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_F53B43CE</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4400</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_F53B4400<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:F53B43C3j</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4400&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">popf</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4401&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">bl</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">bl</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4403&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_F53B43CF</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B4403&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_F53B4376&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">endp</span></li>        </ol>
    </div>
</div></div>
<br><br>В переменной dword_F54C7B1C количество процессоров. Т.к. у меня один процессор, то меня интересует только часть этой функции, по адресу F53B43E0. Выясняется, что и сам установщик не здесь, а возможно в sub_F53B392E, которая в случае успеха должна возвращать не 0.<br><br>Глянем и первую функцию<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_F53B3804&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; CODE XREF: .text:F53ACB29p</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B3804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53AE2F9p</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B3804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53B3912p</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B3804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53B43E2p</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B3804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53B4FADp</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B3804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53C3319p</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B3804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53E8E48p</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B3804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53EB285p</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B3804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53EE07Cp</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B3804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F53FA900p</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span style="word-break: break-all">F53B3804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; .text:F5412C90p</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3804</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>word</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">-</span><span class="hl_number">8</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">-</span><span class="hl_number">6</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg_0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;&nbsp;<span class="hl_number">8</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3804</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3804&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3805&nbsp;<span class="hl_number">004</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3807&nbsp;<span class="hl_number">004</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3808&nbsp;<span class="hl_number">008</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3809&nbsp;<span class="hl_number">00C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B380A&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B380B&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_8<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B380E&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>sidt</b></span>&nbsp;&nbsp;&nbsp;&nbsp;fword&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3811&nbsp;<span class="hl_number">014</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3812&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>arg_0<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3815&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3817&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_F53B381F</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3819&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>movzx</b></span>&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_8<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B381D&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B381F</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B381F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_F53B381F<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: .text:F53B3817j</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B381F&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_6<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3822&nbsp;<span class="hl_number">010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3823&nbsp;<span class="hl_number">00C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">leave</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3824&nbsp;<span class="hl_number">000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>retn</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">4</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span>F53B3824&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_F53B3804&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">endp</span></li>        </ol>
    </div>
</div></div>
<br><br>Суть ее - определение базы IDT. Параметр функции - указатель, в котором надо сохранить лимит таблицы, у нас 0.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=252944&amp;user=24257&amp;forum_n=12&amp;topic=15786&amp;page=0&amp;anchor=30" class="addthx" data-post="252944"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=12&amp;topic=15786&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=12&amp;topic=15786&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/blog.png" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=12&sortBy=0&page=0.html"><b>Дневники и блоги</b></a> <b class=bulletHead>&#8212;&#8250;</b> Драйвер для ATI 3D RAGE PRO TURBO AGP 2X и реверсинг</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="12">
<input type="hidden" name="topic" value="15786">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15786" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
