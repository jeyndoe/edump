<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>нужно разобраться  COM  CAPICOM - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="всех приветствую  собственно проблема - как работать с CAPICOM в асме (fasm)? об инсталляции самого CAPICOM - не говорим.. и так понятно. CoInitialize + CoCreateInstance - тут все понятно... меня интересует интерфейс Utilities">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> нужно разобраться  COM  CAPICOM</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]DMD[/b]','')">DMD</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 85.5 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.59'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=892">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 ноября 2009 14:01 &middot; Поправил: DMD <br><script type="text/javascript">QU('DMD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DMD" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15326.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
всех приветствую <img src="img/smilies/s1.gif" alt=""><br><br>собственно проблема - как работать с CAPICOM в асме (fasm)?<br><br>об инсталляции самого CAPICOM - не говорим.. и так понятно.<br><br>CoInitialize + CoCreateInstance - тут все понятно... <br>меня интересует интерфейс Utilities<br>ссылка на msdn<br> msdn.microsoft.com/en-us/library/aa388176(VS.85).aspx<br><br>CLSID {22A85CE1-F011-4231-B9E4-7E7A0438F71B}   ; ProgID - &quot;CAPICOM.Utilities.1&quot;<br>IID {EB166CF6-2AE6-44DA-BD96-0C1635D183FE}   ; &quot;IUtilities&quot;<br><br>методы этого интерфейса - тоже известны...<br>но в каком порядке они &quot;лежат&quot; в vtable?!?! <br><br>и вот еще одна непонятность:<br>попробовал последовательно получать указатели на интерфейсы CAPICOM.Utilities.1<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_quote">&quot;IUnknown&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">004020F0</span>&nbsp;&nbsp;CC&nbsp;<span class="hl_number">21</span>&nbsp;<span class="hl_number">3F</span>&nbsp;<span class="hl_number">00</span></li><li class="hl_l1"><span class="hl_quote">&quot;IDispatch&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">004020F0</span>&nbsp;&nbsp;CC&nbsp;<span class="hl_number">21</span>&nbsp;<span class="hl_number">3F</span>&nbsp;<span class="hl_number">00</span></li><li class="hl_l0"><span class="hl_quote">&quot;IObjectSafety&quot;</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">004020F0</span>&nbsp;&nbsp;D0&nbsp;<span class="hl_number">21</span>&nbsp;<span class="hl_number">3F</span>&nbsp;<span class="hl_number">00</span></li><li class="hl_l1"><span class="hl_quote">&quot;ISupportErrorInfo&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">004020F0</span>&nbsp;&nbsp;C8&nbsp;<span class="hl_number">21</span>&nbsp;<span class="hl_number">3F</span>&nbsp;<span class="hl_number">00</span></li><li class="hl_l0"><span class="hl_quote">&quot;IUtilities&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">004020F0</span>&nbsp;&nbsp;CC&nbsp;<span class="hl_number">21</span>&nbsp;<span class="hl_number">3F</span>&nbsp;<span class="hl_number">00</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br>те.  указатели на &quot;IUnknown&quot; &quot;IDispatch&quot; &quot;IUtilities&quot; - все эквивалентны.. как такое может быть?!<br><br>тем более что указатели, полученные и через IUnknown &quot;QueryInterface&quot; и через прямой вызов CoCreateInstance, совпадают.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_quote">&quot;IUtilities&quot;</span></li><li class="hl_l1"><span class="hl_number">004020F0</span>&nbsp;&nbsp;CC&nbsp;<span class="hl_number">21</span>&nbsp;<span class="hl_number">3F</span>&nbsp;<span class="hl_number">00</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;М</span><span class="hl_char">!</span><span class="hl_char">?</span><span class="hl_char">.</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_number">003F21CC</span>&nbsp;&nbsp;B0&nbsp;<span class="hl_number">25</span>&nbsp;CA&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">9C</span>&nbsp;<span class="hl_number">25</span>&nbsp;CA&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">01</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;°<span class="hl_char">%</span>К<span class="hl_char">.</span>њ<span class="hl_char">%</span>К<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_number">003F21DC</span>&nbsp;&nbsp;B8&nbsp;AA&nbsp;BA&nbsp;<span class="hl_number">00</span>&nbsp;FF&nbsp;FF&nbsp;FF&nbsp;FF&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;ёЄє<span class="hl_char">.</span>яяяя<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_number">003F21EC</span>&nbsp;&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">01</span>&nbsp;F0&nbsp;AD&nbsp;BA&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>р­є<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_number">003F21FC</span>&nbsp;&nbsp;<span class="hl_number">80</span>&nbsp;AA&nbsp;BA&nbsp;<span class="hl_number">00</span>&nbsp;FF&nbsp;FF&nbsp;FF&nbsp;FF&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;ЂЄє<span class="hl_char">.</span>яяяя<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_number">003F220C</span>&nbsp;&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;AB&nbsp;AB&nbsp;AB&nbsp;AB&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>««««</li><li class="hl_l0"><span class="hl_number">003F221C</span>&nbsp;&nbsp;AB&nbsp;AB&nbsp;AB&nbsp;AB&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">43</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">0D</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;««««<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>C<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_number">003F222C</span>&nbsp;&nbsp;EE&nbsp;<span class="hl_number">04</span>&nbsp;EE&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">90</span>&nbsp;<span class="hl_number">03</span>&nbsp;<span class="hl_number">3F</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">90</span>&nbsp;<span class="hl_number">03</span>&nbsp;<span class="hl_number">3F</span>&nbsp;<span class="hl_number">00</span>&nbsp;EE&nbsp;FE&nbsp;EE&nbsp;FE&nbsp;&nbsp;оо<span class="hl_char">.</span>ђ<span class="hl_char">?</span><span class="hl_char">.</span>ђ<span class="hl_char">?</span><span class="hl_char">.</span>оюою</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;via&nbsp;<span class="hl_quote">&quot;IUnknown&quot;</span></li><li class="hl_l0"><span class="hl_number">00402110</span>&nbsp;&nbsp;CC&nbsp;<span class="hl_number">21</span>&nbsp;<span class="hl_number">3F</span>&nbsp;<span class="hl_number">00</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;М</span><span class="hl_char">!</span><span class="hl_char">?</span><span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br>но опять не все ясно: методов у &quot;IUtilities&quot; - 9, а в таблице всего два элемента<br><br>Ps<br>статьи на васм&#039;е не особо помогли... кое-что там уже давно устарело... да и многое не описано.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=244450&amp;user=892&amp;forum_n=6&amp;topic=15326.html&amp;page=0&amp;anchor=1" class="addthx" data-post="244450"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Av0id[/b]','')">Av0id</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 516.1 (<b>!</b>), 39thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1378">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 ноября 2009 15:18 &middot; Поправил: Av0id <br><script type="text/javascript">QU('Av0id','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Av0id" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15326.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
может что-нибудь в этом духе?<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>format</b></span>&nbsp;PE&nbsp;GUI&nbsp;<span class="hl_number">4</span><span class="hl_char">.</span><span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_function"><b>entry</b></span>&nbsp;start</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>include</b></span>&nbsp;<span class="hl_quote">'%fasminc%\win32a.inc'</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>align</b></span>&nbsp;<span class="hl_number">4</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">struc&nbsp;GUID&nbsp;param1<span class="hl_char">,</span>param2<span class="hl_char">,</span>param3<span class="hl_char">,</span>param4</li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">.</span>Data1&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;param1</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">.</span>Data2&nbsp;<span class="hl_function"><b>dw</b></span>&nbsp;param2</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">.</span>Data3&nbsp;<span class="hl_function"><b>dw</b></span>&nbsp;param3</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">.</span>Data4&nbsp;<span class="hl_function"><b>dq</b></span>&nbsp;param4</li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">struct&nbsp;IUtilities</li><li class="hl_l0">&nbsp;&nbsp;QueryInterface&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;AddRef&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;Release&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;Base64Decode&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;Base64Encode&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;BinaryStringToByteArray&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;BinaryToHex&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;ByteArrayToBinaryString&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;GetRandom&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;HexToBinary&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;LocalTimeToUTCTime&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;UTCTimeToLocalTime&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0"><span class="hl_function">ends</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>macro</b></span>&nbsp;comcall&nbsp;pobj<span class="hl_char">,</span>&nbsp;func<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>param<span class="hl_char">]</span>&nbsp;{</li><li class="hl_l1">&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;~&nbsp;param&nbsp;eq</li><li class="hl_l0">&nbsp;&nbsp;reverse</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;pushd&nbsp;param</li><li class="hl_l0">&nbsp;<span class="hl_function"><b>end</b></span>&nbsp;<span class="hl_function">if</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;common</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;pobj&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_registr">ebx</span><span class="hl_char">,</span><span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_registr">edx</span><span class="hl_char">,</span><span class="hl_registr">esi</span><span class="hl_char">,</span><span class="hl_registr">edi</span><span class="hl_char">&gt;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>local</b></span>&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span>pobj</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span>pobj&nbsp;at&nbsp;pobj</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;pobj</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_char">.</span><span class="hl_char">.</span>pobj<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;pobj</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span>&nbsp;<span class="hl_function">if</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;func<span class="hl_char">]</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>section</b></span>&nbsp;<span class="hl_quote">'.bss'</span>&nbsp;<span class="hl_function"><b>data</b></span>&nbsp;<span class="hl_function">readable</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">CLASS_Utilities&nbsp;GUID&nbsp;<span class="hl_number">022A85CE1h</span><span class="hl_char">,</span><span class="hl_number">0F011h</span><span class="hl_char">,</span><span class="hl_number">04231h</span><span class="hl_char">,</span><span class="hl_number">0B9E4h</span><span class="hl_char">,</span><span class="hl_number">07E7A0438F71Bh</span></li><li class="hl_l1">IID_IUtilities&nbsp;GUID&nbsp;<span class="hl_number">0EB166CF6h</span><span class="hl_char">,</span><span class="hl_number">02AE6h</span><span class="hl_char">,</span><span class="hl_number">044DAh</span><span class="hl_char">,</span><span class="hl_number">0BD96h</span><span class="hl_char">,</span><span class="hl_number">00C1635D183FEh</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;псевдо<span class="hl_char">-</span>код&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">CoCreateInstance<span class="hl_char">(</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>CLASS_Utilities<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l0">QueryInterface<span class="hl_char">(</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>IID_IUtilities<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;fasm&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">comcall&nbsp;&nbsp;<span class="hl_char">[</span>hCapiCom<span class="hl_char">]</span><span class="hl_char">,</span>IUtilities<span class="hl_char">.</span>Base64Decode<span class="hl_char">,</span><span class="hl_registr">ecx</span></li><li class="hl_l1">&nbsp;</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=244454&amp;user=1378&amp;forum_n=6&amp;topic=15326.html&amp;page=0&amp;anchor=2" class="addthx" data-post="244454"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]DMD[/b]','')">DMD</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 85.5 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.59'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=892">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 ноября 2009 20:28 &middot; Поправил: DMD <br><script type="text/javascript">QU('DMD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DMD" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15326.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>Av0id пишет:<br>может что-нибудь в этом духе? </I><br><br>нет, в этом духе не подойдет<br>приведенный вариант псевдо-кода - это практически классическое описание COM<br>вся ерунда в том, что struct IUtilities описана &quot;руками&quot; как <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">struct&nbsp;IUtilities</li><li class="hl_l1">&nbsp;&nbsp;QueryInterface&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;AddRef&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;Release&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;Base64Decode&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;Base64Encode&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;BinaryStringToByteArray&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;BinaryToHex&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;ByteArrayToBinaryString&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;GetRandom&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;HexToBinary&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;LocalTimeToUTCTime&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;UTCTimeToLocalTime&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;</li>        </ol>
    </div>
</div></div>
<br>а после получения указателя на этот интерфейс в памяти имеем следующее:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_quote">&quot;IUtilities&quot;</span></li><li class="hl_l1"><span class="hl_number">004020F0</span>&nbsp;&nbsp;CC&nbsp;<span class="hl_number">21</span>&nbsp;<span class="hl_number">3F</span>&nbsp;<span class="hl_number">00</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;М</span><span class="hl_char">!</span><span class="hl_char">?</span><span class="hl_char">.</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_number">003F21CC</span>&nbsp;&nbsp;B0&nbsp;<span class="hl_number">25</span>&nbsp;CA&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">9C</span>&nbsp;<span class="hl_number">25</span>&nbsp;CA&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">01</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span></li><li class="hl_l0"><span class="hl_number">003F21DC</span>&nbsp;&nbsp;B8&nbsp;AA&nbsp;BA&nbsp;<span class="hl_number">00</span>&nbsp;FF&nbsp;FF&nbsp;FF&nbsp;FF&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span></li><li class="hl_l1"><span class="hl_number">003F21EC</span>&nbsp;&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">01</span>&nbsp;F0&nbsp;AD&nbsp;BA&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span></li><li class="hl_l0"><span class="hl_number">003F21FC</span>&nbsp;&nbsp;<span class="hl_number">80</span>&nbsp;AA&nbsp;BA&nbsp;<span class="hl_number">00</span>&nbsp;FF&nbsp;FF&nbsp;FF&nbsp;FF&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span></li><li class="hl_l1"><span class="hl_number">003F220C</span>&nbsp;&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;AB&nbsp;AB&nbsp;AB&nbsp;AB</li><li class="hl_l0"><span class="hl_number">003F221C</span>&nbsp;&nbsp;AB&nbsp;AB&nbsp;AB&nbsp;AB&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">43</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">0D</span>&nbsp;<span class="hl_number">00</span></li><li class="hl_l1"><span class="hl_number">003F222C</span>&nbsp;&nbsp;EE&nbsp;<span class="hl_number">04</span>&nbsp;EE&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">90</span>&nbsp;<span class="hl_number">03</span>&nbsp;<span class="hl_number">3F</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">90</span>&nbsp;<span class="hl_number">03</span>&nbsp;<span class="hl_number">3F</span>&nbsp;<span class="hl_number">00</span>&nbsp;EE&nbsp;FE&nbsp;EE&nbsp;FE</li><li class="hl_l0">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br>те. в vtable имеем всего два элемента,,,,<br><br>что я и описал #1 <br><br>ps<br>может быть я и не прав, но при получении указателей через IUnknown обрабатывать его счетчик через AddRef мне не пришлось - он сам увеличивался.<br><br>pps<br>если последовательность элементов struct <b>IUtilities </b>взята &quot;от M&#036;&quot;...  тогда это не факт
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=244478&amp;user=892&amp;forum_n=6&amp;topic=15326.html&amp;page=0&amp;anchor=3" class="addthx" data-post="244478"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Av0id[/b]','')">Av0id</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 516.1 (<b>!</b>), 39thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1378">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2009 11:55 <br><script type="text/javascript">QU('Av0id','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Av0id" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15326.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
а IID и CLSID правильны?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=244512&amp;user=1378&amp;forum_n=6&amp;topic=15326.html&amp;page=0&amp;anchor=4" class="addthx" data-post="244512"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]DMD[/b]','')">DMD</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 85.5 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.59'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=892">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 ноября 2009 15:06 &middot; Поправил: DMD <br><script type="text/javascript">QU('DMD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DMD" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15326.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
мда...<br>все же удалось в fasm заставить эту (не знаю как по-мягче ее назвать) концепцию закодировать стринг в Base64.<br><br>сначала ответы на вопросы:<br><br>CLSID {22A85CE1-F011-4231-B9E4-7E7A0438F71B} ; ProgID - &quot;CAPICOM.Utilities.1&quot;<br>IID {EB166CF6-2AE6-44DA-BD96-0C1635D183FE} ; &quot;IUtilities&quot;<br>это все правильно...<br><br>предложенная структура vtable:<br><br>struct IUtilities<br>  QueryInterface dd ?<br>  AddRef dd ?<br>  Release dd ?<br>  Base64Decode dd ?<br>  Base64Encode dd ?<br>  BinaryStringToByteArray dd ?<br>  BinaryToHex dd ?<br>  ByteArrayToBinaryString dd ?<br>  GetRandom dd ?<br>  HexToBinary dd ?<br>  LocalTimeToUTCTime dd ?<br>  UTCTimeToLocalTime dd ?<br>ends<br><br>похоже, была взята из msdn и.. гм .. неверна.. точнее, почти верна и к тому же на msdn она приведена в алфавитном порядке.<br><br>по-уму, эта таблица выглядит так:<br><br>QueryInterface<br>AddRef<br>Release<br>GetTypeInfoCount<br>GetTypeInfo<br>GetIDsOfNames<br>Invoke<br>GetRandom<br>Base64Encode<br>Base64Decode<br>BinaryToHex<br>HexToBinary<br>BinaryStringToByteArray<br>ByteArrayToBinaryString<br>LocalTimeToUTCTime<br>UTCTimeToLocalTime<br><br>о проблемах по порядку:<br>- спасибо Hangatyr&#039;у за указание о первом (опущенном во всех описаниях) параметре (статья за 2004 год!).<br>никто не обозвал это указателем_на_Context  - а зря... что-то было проще в понимании.<br>- указатели_на_указатели - эта фишка вымотает любые нервы<br>- структура стрингов: с явным указанием длины в [&#036;-4]<br>- коды ошибок на столько разнообразны, на сколько и засекречены. что где искать - неизвестно.<br>E_OUTOFMEMORY 8007000E Out of memory error не вполне помогает при поиске ошибки в описании стринга и его длины.<br><br>может быть, на высокоуровневых языках многое будет проще чем на асме.<br>но в любом случае, если потребуется выполнить, на пример, скрипт на VB в асме (пример есть на васм), те. с пустого места определить последовательность элементарных действий (методов) для выполнения поставленной задачи будет не совсем просто.<br><br>а так, для простых действий (кодирование/декодирование и пр.) использовать вполне можно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=244655&amp;user=892&amp;forum_n=6&amp;topic=15326.html&amp;page=0&amp;anchor=5" class="addthx" data-post="244655"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Av0id[/b]','')">Av0id</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 516.1 (<b>!</b>), 39thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1378">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 ноября 2009 19:07 <br><script type="text/javascript">QU('Av0id','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Av0id" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15326.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
capicom sdk подними и узнаешь про коды ошибок, указатели на указатели - это типично для всей COM<br><br>ps. выложишь пример?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=244679&amp;user=1378&amp;forum_n=6&amp;topic=15326.html&amp;page=0&amp;anchor=6" class="addthx" data-post="244679"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]DMD[/b]','')">DMD</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 85.5 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.59'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=892">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2009 12:23 &middot; Поправил: DMD <br><script type="text/javascript">QU('DMD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DMD" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15326.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>Av0id пишет:<br>capicom sdk подними и узнаешь про коды ошибок </I><br><br>смотрел... не нашел,,,<br>тут и то лучше описано (коды ошибок):<br><noindex><a href="http://msdn.microsoft.com/en-us/library/ee265170(BTS.10).aspx" rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/library/ee265170(BTS.10).aspx</a></noindex> -&gt; COM<br><br><noindex><a href="http://msdn.microsoft.com/en-us/library/aa375685(VS.85).aspx" rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/library/aa375685(VS.85).aspx</a></noindex> -&gt; CAPICOM<br><br><I>Av0id пишет:<br>выложишь пример </I><br>код под такую последовательность:<br>CLSID -&gt; GUID_IUnknow -&gt; IUnknown(_IID_IUtilities)<br><br>(но можно пользоваться и такой последовательностью:<br>CLSID -&gt; GUID_IUtilities)<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;&nbsp;&nbsp;&nbsp;MultiByteToWideChar<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;_CLSID<span class="hl_char">,</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">,</span>&nbsp;buffer<span class="hl_char">,</span>&nbsp;<span class="hl_number">100h</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;&nbsp;&nbsp;&nbsp;CLSIDFromString<span class="hl_char">,</span>&nbsp;&nbsp;buffer<span class="hl_char">,</span>&nbsp;_rez_A</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;&nbsp;&nbsp;&nbsp;MultiByteToWideChar<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;_GUID_IUnknow<span class="hl_char">,</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">,</span>&nbsp;buffer<span class="hl_char">,</span>&nbsp;<span class="hl_number">100h</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;&nbsp;&nbsp;&nbsp;CLSIDFromString<span class="hl_char">,</span>&nbsp;&nbsp;buffer<span class="hl_char">,</span>&nbsp;_rez_B</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;&nbsp;&nbsp;&nbsp;CoInitialize<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;&nbsp;&nbsp;&nbsp;CoCreateInstance<span class="hl_char">,</span>&nbsp;_rez_A<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">,</span>&nbsp;_rez_B<span class="hl_char">,</span>&nbsp;adr_IUnknown</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;&nbsp;&nbsp;&nbsp;MultiByteToWideChar<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;_IID<span class="hl_char">,</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">,</span>&nbsp;buffer<span class="hl_char">,</span>&nbsp;<span class="hl_number">100h</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;&nbsp;&nbsp;&nbsp;CLSIDFromString<span class="hl_char">,</span>&nbsp;&nbsp;buffer<span class="hl_char">,</span>&nbsp;_rez_B</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_char">[</span>adr_IUnknown<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adr_Interface</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_rez_B</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_char">[</span>adr_IUnknown<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>edx</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">]</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_comment">;     struct IUtilities</span></li><li class="hl_l0"><span class="hl_comment">;        QueryInterface           equ 0x00</span></li><li class="hl_l1"><span class="hl_comment">;        AddRef</span></li><li class="hl_l0"><span class="hl_comment">;        Release</span></li><li class="hl_l1"><span class="hl_comment">;        GetTypeInfoCount</span></li><li class="hl_l0"><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_comment">;        GetTypeInfo              equ 0x10</span></li><li class="hl_l0"><span class="hl_comment">;        GetIDsOfNames</span></li><li class="hl_l1"><span class="hl_comment">;        Invoke</span></li><li class="hl_l0"><span class="hl_comment">;        GetRandom</span></li><li class="hl_l1"><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_comment">;        Base64Encode             equ 0x20</span></li><li class="hl_l1"><span class="hl_comment">;        Base64Decode</span></li><li class="hl_l0"><span class="hl_comment">;        BinaryToHex</span></li><li class="hl_l1"><span class="hl_comment">;        HexToBinary</span></li><li class="hl_l0"><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_comment">;        BinaryStringToByteArray  equ 0x30</span></li><li class="hl_l0"><span class="hl_comment">;        ByteArrayToBinaryString</span></li><li class="hl_l1"><span class="hl_comment">;        LocalTimeToUTCTime</span></li><li class="hl_l0"><span class="hl_comment">;        UTCTimeToLocalTime</span></li><li class="hl_l1"><span class="hl_comment">;     ends</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>stdcall</b></span>&nbsp;&nbsp;&nbsp;Get_Length<span class="hl_char">,</span>&nbsp;Input_String&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Length of string</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_char">[</span>Input_String_length<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;<span class="hl_comment">; save &quot;Length&quot;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>adr_Interface<span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Base64Encode</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adr_Out_string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Input_String&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span>adr_Interface<span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>edx</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">20h</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;&nbsp;&nbsp;&nbsp;WideCharToMultiByte<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>adr_Out_string<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">,</span>&nbsp;out_buffer_sample<span class="hl_char">,</span>&nbsp;<span class="hl_number">100h</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_char">-</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_CLSID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;&nbsp;<span class="hl_quote">&quot;{22A85CE1-F011-4231-B9E4-7E7A0438F71B}&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; ProgID - &quot;CAPICOM.Utilities.1&quot;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_GUID_IUnknow&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;&nbsp;<span class="hl_quote">&quot;{00000000-0000-0000-C000-000000000046}&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; &quot;IUnknown&quot;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;    _IID            db  &quot;{00000000-0000-0000-C000-000000000046}&quot;, 0       ; &quot;IUnknown&quot;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;    _IID            db  &quot;{00020400-0000-0000-C000-000000000046}&quot;, 0       ; &quot;IDispatch&quot;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;    _IID            db  &quot;{CB5BDC81-93C1-11CF-8F20-00805F2CD064}&quot;, 0       ; &quot;IObjectSafety&quot;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;    _IID            db  &quot;{DF0B3D60-548F-101B-8E65-08002B2BD119}&quot;, 0       ; &quot;ISupportErrorInfo&quot;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_IID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;&nbsp;<span class="hl_quote">&quot;{EB166CF6-2AE6-44DA-BD96-0C1635D183FE}&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; &quot;IUtilities&quot;  </span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_rez_A&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>rb</b></span>&nbsp;<span class="hl_number">10h</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_rez_B&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>rb</b></span>&nbsp;<span class="hl_number">10h</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adr_IUnknown&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adr_Interface&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adr_Out_string&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_comment">;     Input_String_Structure                          ;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>rb</b></span>&nbsp;<span class="hl_number">0Ch</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Input_String_length&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Input_String&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_quote">&quot;foob&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>align</b></span>&nbsp;<span class="hl_number">10h</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out_buffer_sample&nbsp;&nbsp;<span class="hl_function"><b>rb</b></span>&nbsp;<span class="hl_number">20h</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>rb</b></span>&nbsp;<span class="hl_number">50h</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_char">*</span></li><li class="hl_l1">&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_char">*</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_number">00402140</span>&nbsp;&nbsp;<span class="hl_number">66</span>&nbsp;<span class="hl_number">6F</span>&nbsp;<span class="hl_number">6F</span>&nbsp;<span class="hl_number">62</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">90</span>&nbsp;<span class="hl_number">90</span>&nbsp;<span class="hl_number">90</span>&nbsp;<span class="hl_number">90</span>&nbsp;<span class="hl_number">90</span>&nbsp;<span class="hl_number">90</span>&nbsp;<span class="hl_number">90</span>&nbsp;<span class="hl_number">90</span>&nbsp;<span class="hl_number">90</span>&nbsp;<span class="hl_number">90</span>&nbsp;<span class="hl_number">90</span>&nbsp;&nbsp;foob<span class="hl_char">.</span>ђђђђђђђђђђђ</li><li class="hl_l0"><span class="hl_number">00402150</span>&nbsp;&nbsp;<span class="hl_number">2D</span>&nbsp;<span class="hl_number">2D</span>&nbsp;<span class="hl_number">2D</span>&nbsp;<span class="hl_number">2D</span>&nbsp;<span class="hl_number">2D</span>&nbsp;<span class="hl_number">2D</span>&nbsp;<span class="hl_number">2D</span>&nbsp;<span class="hl_number">2D</span>&nbsp;<span class="hl_number">2D</span>&nbsp;<span class="hl_number">2D</span>&nbsp;<span class="hl_number">2D</span>&nbsp;<span class="hl_number">2D</span>&nbsp;<span class="hl_number">2D</span>&nbsp;<span class="hl_number">2D</span>&nbsp;<span class="hl_number">2D</span>&nbsp;<span class="hl_number">2D</span>&nbsp;&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l1"><span class="hl_number">00402160</span>&nbsp;&nbsp;<span class="hl_number">5A</span>&nbsp;<span class="hl_number">6D</span>&nbsp;<span class="hl_number">39</span>&nbsp;<span class="hl_number">76</span>&nbsp;<span class="hl_number">59</span>&nbsp;<span class="hl_number">67</span>&nbsp;<span class="hl_number">3D</span>&nbsp;<span class="hl_number">3D</span>&nbsp;<span class="hl_number">0D</span>&nbsp;<span class="hl_number">0A</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;Zm9vYg<span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_number">00402170</span>&nbsp;&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br>у меня есть замечание &amp; еще несколько вопросов:<br>- к результату добавляются два байта 0х0D +0х0A.. нужно это учитывать..<br><br>- можно ли бойтись без инсталляции всего пакета? (мы подразумеваем CAPICOM)<br>я о regsvr32.exe + CAPICOM.dll...<br>и самый насущный в приложении СОМ вопрос по fasm:<br>ок, мы получили указатель на интерфейс, вытащили указатель на vtable + &quot;руками&quot; описали структуру vtable. можно ли как-нибуть это связать?<br>что бы пользоваться call [.Base64Decode] а не call [edx+0xC0]
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=244768&amp;user=892&amp;forum_n=6&amp;topic=15326.html&amp;page=0&amp;anchor=7" class="addthx" data-post="244768"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Av0id[/b]','')">Av0id</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 516.1 (<b>!</b>), 39thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1378">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2009 17:39 &middot; Поправил: Av0id <br><script type="text/javascript">QU('Av0id','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Av0id" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15326.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>нет, в этом духе не подойдет</I><br><br>только в итоге получилось почему-то именно в этом духе<br><br><I>DMD пишет:<br>ок, мы получили указатель на интерфейс, вытащили указатель на vtable + &quot;руками&quot; описали структуру vtable. можно ли как-нибуть это связать?<br>что бы пользоваться call [.Base64Decode] а не call [edx+0xC0]  </I><br><br>см. мой первый пост внимательнее, макрос comcall и пример его использования там же<br><br>в твоем случае:<br>comcall [adr_Interface],IUtilities.Base64Encode,Input_String,adr_Out_string<br><br><I>смотрел... не нашел,,,</I><br><br>плохо смотрел
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=244917&amp;user=1378&amp;forum_n=6&amp;topic=15326.html&amp;page=0&amp;anchor=8" class="addthx" data-post="244917"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]DMD[/b]','')">DMD</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 85.5 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.59'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=892">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 ноября 2009 10:58 <br><script type="text/javascript">QU('DMD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DMD" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15326.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<img src="img/smilies/s11.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=244960&amp;user=892&amp;forum_n=6&amp;topic=15326.html&amp;page=0&amp;anchor=9" class="addthx" data-post="244960"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> нужно разобраться  COM  CAPICOM</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15326" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
