<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Распаковка AsProtect на примерах - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте! Очень прошу, помогите найти или выдайте пжалста из запасов прогу Advanced Archive Password Recovery v.3.00 кто может, очень хочется научиться распаковке, а проги нормальной нет. Далее повтор моего вчерашнего">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=42623'>site-pro</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a>, <a target='_blank' href='?action=userinfo&amp;user=35066'>artyavmu</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка AsProtect на примерах</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=6.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=6.html">7</a> . <b>8</b> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=11.html">12</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=12.html">13</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=8.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2007 12:10 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте! Очень прошу, помогите найти или выдайте пжалста из запасов прогу Advanced Archive Password Recovery v.3.00 кто может, очень хочется научиться распаковке, а проги нормальной нет. Далее повтор моего вчерашнего письма(лежит в чужой теме, найти можно в поиске введите: Распаковка ASProtecta - моё сообщение самое свежее)<br>----------------------------------------------------------------------  ------------------------------------------------------------------<br>Здравствуйте. Понимаю, что лезу немного не туда, но обсуждения статьи &quot;Распаковка нового ASProtect на примере Advanced Archive Password Recovery v.3.00&quot; автора SergSh на форуме и в поисковике вроде бы не видно(может статья просто древняя), а тут вроде бы тоже у ASR-ра 2-я версия. Суть проблемы:<br><br>1 Сам по вашим статьям научился распаковывать ASProtect 1.22-1.23 ,1.23 RC4, 1.24(проги типа Electra, Куриная месть.Первая разборка, скринсейвер и т.д. с затиранием репой краденого начала проги и без).<br><br>2 Нужно двигаться дальше и тут с удивлением обнаруживаю, что статей по распаковке версий 1.3-2.0 нет вааще(может я в шары долблюсь, незнаю). Плиз, если можно, то ссылку на подобную статью, а то руководство как починить велосипед есть(1.21-1.22), как починить мопед-есть(1.23 RC4), как починить боинг747 и космический челнок-есть(2.0x-2.12xx и выше). А вот как отремонтировать просто машину нет.<br><br>3 Из всех имеющихся статей более всего понятно было у SergSh в &quot;Распаковка нового ASProtect на примере Advanced Archive Password Recovery v.3.00&quot;, но тут такой казус. Проискав в инете подопытную прогу версии 3.0 нашел две ссылки, скачал, инсталятор обещал версия 3.0 (как в статье),- в итоге версия 3.01, чем забиты все ссылки на эту прогу в инете и PEID говорит не ASProtect 1.2-1.3 registered(2.0x по словам SergSh),а ASProtect 2.1x SKE. Ну ладно:<br><br>а)34раз Shift+F9 ставим бряк на ближайший переход внизу, ещё раз Shift+F9, снимаем бряк,ставим на Alt+M на секцию кода(401000), но не снова Shift+F9, как в статье, а trace into(а то EOP будет на две команды ниже и затруться два Push-а). Останавливаемся на EOP 42A910. Ctrl+A и всё видится чинно и благородно.<br><br>б)Читаем статейку дальше и пробуем запустить его скрипт(в папку его,в Script , в Олю, в виде txt предварительно). И оля повисает пробовал подождать 1,5 часа думал это скрипт так долго на более свежей версии ASp-ра трудится(хрен то там:s14. Запущено как положено без бряков и с OEP после trace into и я в plugin-&gt;IsDebuggerPresent -&gt;Hide, с полным игнором исключений.<br><br>в) Руками по его совету IAT пока не пробовал, всё так пока трудно для понимания и непривычно и завтра на работу а уже 2ночи. Граждане, слезно молю дайте ссылку на настоящий Advanced Archive Password Recovery v.3.00, а то шатл починить не могу пока, дайте хоть чертежи к боингу. А если почти серьезно, то научиться распаковывать ASPr до второй версии включительно руками хочется так, что аж эти руки зудят.<br><br>P.S. Не пинайте сильно за дурацкие просьбы самого маленького. Это первый выход в свет. Начал реверсить 18.12.06 с нуля. Реверсил даже в новогоднюю ночь. Для меня это очень важно(научиться распаковывать)!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=115630&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=1" class="addthx" data-post="115630"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 мая 2007 08:23 &middot; Поправил: Demon666 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#2');return false;">#2</a> </span><div align=left><br>
<I>tar4 пишет:<br>В ЕСХ - счетчик </I><br>Не ты его так запутаешь еще больше, там нет префикса <b>rep</b> и ecx тут не причем…<br>(MOVS BYTE PTR ES:[EDI],BYTE PTR DS:[ESI] выполнится только один раз)<br>Происходит копирование байта из [esi](значит readme разрешено) по адресу, который в edi находиться, у него нет прав доступа к этому участку памяти на запись, отсюда и наг, но на чтение и исполнение есть…
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=137822&amp;user=4551&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=2" class="addthx" data-post="137822"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 мая 2007 09:47 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#3');return false;">#3</a> </span><div align=left><br>
<b>Demon666</b> прав ибо я уже попробовал вариант когда EAX приёмник EBX источник, да ещё и явно задал единицу в ECX. Один хрен хоть по F7 хоть по F8 при попытке выполнить<br>MOVS BYTE PTR ES:[EDI],BYTE PTR DS:[ESI] результатом описанное выше исключение.<br><br>Странно ещё и то, что секция 400000(PE-заголовок) имеет RWE,- я так понял,что чтение, запись разрешена.<br>ЧТО за хрень ведь ODBgScript 1.48 как то получает право на запись(он три раза в скрипте PE_kill-а пишет в эту секцию хренову тучу байт), я пытаюсь один байтик сменить и хрен то там.<br><br><b>Это не может быть какая нибудь Олькина настройка о которой я не подозреваю на изменение PE-заголовка или его секции?</b><br><br><b>Как получают права доступа к секции PE-заголовка на запись?</b><br><br><b>Demon666</b> плиз если знаешь, как получить права?! Дальнейшая работа стоит из за этого.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=137833&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=3" class="addthx" data-post="137833"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 мая 2007 10:02 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#4');return false;">#4</a> </span><div align=left><br>
<I>Small_S пишет:<br>Странно ещё и то, что секция 400000(PE-заголовок) имеет RWE</I><br><br>ты уверен, что посмотрел в тот столбик? (Access) вообще там должно стоять &quot;R&quot;.<br>может пропустил что в скрипте пе-килла?
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=137835&amp;user=72&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=4" class="addthx" data-post="137835"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 мая 2007 10:55 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#5');return false;">#5</a> </span><div align=left><br>
<b>Hellspawn</b> на <b>может пропустил что в скрипте пе-килла?</b> Нет я вообще не меняю его код, а только внутри ассемблерной вставки в нужный момент пушую то что у него в нескольких регистрах произвожу свои действия и возвращаю как было. Единственным результатом работы моего участка будет то что в единственной его строке будет меняться значение (ххFF) то15FF, то25FF.<br><br>На   <b>ты уверен, что посмотрел в тот столбик? (Access) вообще там должно стоять &quot;R&quot;.</b> Сейчас проверю, мог и зевануть(дело происходит на работе, постоянно кто то отвлекает и сушит мозги).<br><br><b>Кто, где задаёт эти R или W в свойстве Access? Млин, как это менять если там найду не то что нужно?</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=137839&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=5" class="addthx" data-post="137839"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 мая 2007 13:27 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#6');return false;">#6</a> </span><div align=left><br>
Alt+M, выбери (обязательно!) секцию PE header, ПКМ-&gt;Set access-&gt;Full access <br>(получишь доступ RWE CopyOnWr.. в Access ко всем секциям проги (сразу на все Imag ???????? в Type))<br>После этого можешь писать по этим адресам что хочешь, НО это только для теста того, что ты делаешь(!) не более…
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=137848&amp;user=4551&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=6" class="addthx" data-post="137848"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Sturgeon[/b]','')">Sturgeon</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 105.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.56'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3305">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 мая 2007 18:57 &middot; Поправил: Sturgeon <br><script type="text/javascript">QU('Sturgeon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sturgeon" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#7');return false;">#7</a> </span><div align=left><br>
<I>Hellspawn пишет:<br> должно стоять &quot;R&quot; </I><br>Сейчас вот тоже посмотрел все анпакми и пару прог, запакованных разными версиями аспра. В колонке Access у ФФФСЕХ секций стоит атрибут &quot;R&quot;. Как оно вообще работает непонятно%). А в колонке Initial access опять же у всех секций стоит RWE. Что это за колонка Initial access? И чем она отличается от просто Access?<br>P.S. Small_S, не мог бы ты перезалить куда нибудь Advanced Archive Password Recovery v.3.00. Ссылка в первых постах уже сдохла, а скачивается отовсюду только v.3.01. Может плохо искал. Ты кстати ковырял эту версию? Там тоже вроде аспр 2.11. Првда она от того, что написано в статье, отличается.<br>P.P.S. Это я решил пройти путь Small_S с самого начала, опираясь на то, что уже было здесь написано.<br>P.P.P.S. Херня какая-то. У меня для вообще всех прог Олька показывает ля всех секций Access &quot;R&quot;, а Initial access &quot;RWE&quot;. Надо попробовать другую сборку себе поставить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=137907&amp;user=3305&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=7" class="addthx" data-post="137907"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 мая 2007 22:10 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#8');return false;">#8</a> </span><div align=left><br>
<b>Sturgeon</b> на <b>У меня для вообще всех прог Олька показывает ля всех секций Access &quot;R&quot;</b> сборка тут не при чём. И у меня показывает для всех секций. Ещё днём на работе я провёл два эксперимента.<br><br> 1 В асм коде PE_kill-а  вида <b>mov word ptr ds:[ebx], 15ff</b> засунул нужный мне на тот момент адрес внутри секции  пе-заголовка(00400E72). Оля как я и подозревал упала в знакомое исключение. Этим я установил, что код ПЕ_килла имеет те же права доступа, что и мой(это не удивительно так как мой код вставка в его).<br> <br> 2 Зарядил в приведённую выше свою конструкцию адрес приёмника в секции кода(нашел там не распознанную команду FFFF- 00401F15). Как я и ожидал мой байт число-15 был благополучно напечатан по требуемому адресу. Откуда следует вполне определённый вывод: <b>несмотря на то что все секции разрешены только на чтение(Access - R) вполне реально в них можно писать из любой секции, включая и секцию пе заголовка. Доступ же на запись в эту секцию можно получить только какими то неведомыми мне пока способами. </b><br><br>Пораскинув мозгами, я понял, что потеряю ещё очень много времени пока узнаю как это делается, если не найду другого выхода и он был найден.<br><br>В который уже раз я внимательно прошёл по PE_kill-овской подпрограмме скрипта ребилд апи и заметил, что адрес изменяемой аспровой функции оказывается не только на первом run в ecx, но и на последнем в ebx.<br>И тут я понял: зачем в извращенной форме насиловать пе-секцию заставляя записаться в неё 1 байт в такое место.<br><br>MOV WORD PTR DS:[EBX],<b>15</b>FF<br><br>лучше заменить эту команду группой своих. Вот новый код и новая сигнатура для последней(третьей посчёту инжекции кода скрипта PE_kill-а) по поговорке а ларчик просто открывался:<br><br>00400E18---------------------PUSH EDI<br>00400E19---------------------PUSH EAX<br>00400E1A---------------------CALL kernel32.GetProcAddress<br>00400E1F ---------------------NOP<br>00400E20 -------------------- ADD ECX,4<br>00400E23 -------------------- CMP ECX,EDX<br>00400E25 -------------------- JA SHORT ARCHPR.00400E2D<br>00400E27 -------------------- CMP DWORD PTR DS:[ECX],EAX<br>00400E29 -------------------- JNZ SHORT ARCHPR.00400E20<br>00400E2B -------------------- JMP SHORT ARCHPR.00400E3C<br>00400E2D --------------------  CMP ESI,EDI<br>00400E2F  -------------------- JE SHORT ARCHPR.00400E3A<br>00400E31 --------------------- MOV DWORD PTR DS:[ECX],0<br>00400E37 --------------------- ADD ECX,4<br>00400E3A  ---------------------MOV DWORD PTR DS:[ECX],EAX<br>00400E3C ----------------------<b>PUSH ECX</b><br>00400E3D ----------------------<b>MOV ECX,DWORD PTR DS:[EBX-1]</b><br>00400E40   --------------------<b>CMP CL,2E</b><br>00400E43  ---------------------<b>JE SHORT ARCHPR.00400E4D</b><br>00400E45  ---------------------<b>MOV WORD PTR DS:[EBX],25FF</b><br>00400E4A  ---------------------<b>POP ECX</b><br>00400E4B  ---------------------<b>JMP SHORT ARCHPR.00400E53</b><br>00400E4D  --------------------- <b>MOV WORD PTR DS:[EBX],15FF</b><br>00400E52  --------------------- <b>POP ECX</b><br>00400E53  --------------------- MOV DWORD PTR DS:[EBX+2],ECX<br>00400E56  --------------------- ADD BYTE PTR DS:[EAX],AL<br><br>Остальные изменения отпишу завтра нет уже сил. Завтра ещё бухать на работе надо выспаться.<br>Скрипт проверил только на адвансед пассворд рековери. Не знаю как он пойдёт на других прогах, но здесь просто сказка. Он ещё пошустрее стал работать так как из скрипта при каждом прогоне не исправляет код перехода это во вставке выше(всё таки асм код шустрее скриптового). Если бы не необходимость задавать границы IAT, то вообще бы всё прошло на автомате. После прохода до OEP описанным ранее фаиндером, сразу модернизированный скрипт, оллидамп, сразу импрект. Запуск и никаких падений или вылетов, хоть закрывай, хоть смоти эбаут хоть запускай, хоть сохраняй, хоть что делай. <img src="img/smilies/s12.gif" alt=""><br><br><b>Sturgeon</b> завтра залью, но если ты внимательно читал, то там я как раз и шпарю 3.01 и сейчас проверяю на ней.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=137958&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=8" class="addthx" data-post="137958"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 мая 2007 22:15 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#9');return false;">#9</a> </span><div align=left><br>
Млинн. Совсем из ума выживаю сигнатуру забыл вставить.<br>#5750E8099E407C9083C1043BCA7706390175F5EB0F3BF77409C7010000000083C1048 901518B4BFF80F92E740866C703FF2559EB0666C703FF1559894B020000#
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=137959&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=9" class="addthx" data-post="137959"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2007 18:54 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#10');return false;">#10</a> </span><div align=left><br>
<b>Sturgeon</b> вот долгожданный файл, в том виде как мне его предоставил SergSh.<br>_http://dump.ru/files/3/320086937/<br><br><b>Огромная просьба ко всем.</b> Завтра, послезавтра буду делать скрипту автоматический поиск границ IAT и возможно очистку IAT от мусора. Нужны будут испытания. Как вы понимаете испытывать удобно на тех прогах, что покрыты аспром не по самое нихочу, а только с защитой импорта как у адвенсед пассворд рековери. Унпакми приведённые <b>Sturgeon</b> подходят для этих целей мало.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=138058&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=10" class="addthx" data-post="138058"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2007 16:20 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#11');return false;">#11</a> </span><div align=left><br>
1.Ну наконец то свершилось и я  уже перешёл на новый ODBgScript v1.62.3.VC6 (26 May 2007)<br>   <br> 1.62 (26 May 2007)<br>   + Indent/color ASM Blocks (EXEC/ENDE)<br>   + Added GCI parameter COMMAND to get asm command string (like OPCODE), SIZE, CONDITION, TYPE<br>   + TICK without variable set time from start in text, in &quot;%d ms&quot; format. log purpose.<br>   + Added SCMP,SCMPI size parameter, to compare addr data.<br>     * DF/SF flags fixed<br>   * EOB with EXEC/ENDE fixed<br>   * After Error Script Cursor, also added &quot;!&quot; symbol in front of line<br>   * Fixed SUB &lt;reg&gt; command <b>&lt;---------Вот это мешало нормально работать скрипту по IAT</b><br>   * Fixed Value History in commands using DoMOV <br>данная версия стала достаточно устойчивой, чтобы уверенно с ней работать.<br><br> 2. Наконец привожу первую модефикацию скрипта о которой писал ночью 24.05.07<br>   По заявленным ранее причинам я не стану аттачить или постить изменённый скрипт <br>  PE_kill-а целиком(пока разрешение на это не получено).Поскольку хотелось бы всё<br>  таки провести испытания модификации скрипта, да и новичкам было бы легче обращаться<br>  с корректно работающим скриптом,- то поступлю следующим образом: поясняю те строки<br>  в скрипте, которые должны быть изменены. Итак перед вами и передо мной исходный скрипт<br>  PE_kill-а из его рар статьи, о примере FontExpert 2005.<br><br> 1. Вводим новые переменные, необходимые для работы:<br>    после var OEP(в исходном тексте) вводим<br>    <b>var colich_call<br>    var colich_jmp<br>    var prov<br>    mov colich_call,0 </b> // и тутже задаём нулевые значения для двух из них<br>    <b>mov colich_jmp,0</b><br>    Кроме того в блоке инициализации можно убрать переменную var type_api<br><br> 2. Чуть ниже удаляем диалог выбора типа изменяемых скриптом переходов(место где задаётся<br>    var type_api).<br>    je @halt<br>    mov IAT_end	,&#036;RESULT  //Вот после этого<br>   <b> //mov type_api,15<br>    //msgyn &quot;Do you want to use opcod &quot;call&quot; (FF15) for recovering redirector? If you <br>    choose &quot;No&quot; will be used opcod &quot;jmp&quot; (FF25).&quot;<br>    //cmp &#036;RESULT,1<br>    //je @init<br>    //mov type_api,25</b><br><br> 3. Теперь спускаемся в подпрограмму @repuild_api_init: в самое важное место для работы<br>    mov addr_iat_reb,eip<br>    mov [eip],#5750E8099E407C9083C1043BCA7706390175F5EB0F3BF77409C701000000008 3C104890<br>    166C703FF00894B02# //ВОТ ЭТУ СИГНАТУРУ НУЖНО ПОМЕНЯТЬ (ОНА БУДЕТ САМА МЕНЯТЬ JMP И CALL)<br>    по новому строка будет выглядеть так:<br>   <b> mov [eip],#5750E8099E407C9083C1043BCA7706390175F5EB0F3BF77409C701000000008 3C104890<br>    1518B4BFF80F92E740866C703FF2559EB0666C703FF1559894B020000#</b><br><br> 4. В этой же подпрограмме меняем ниже такой блок<br>   <b> bp eip<br>    add eip,37</b>       //25- это старое значение у нас теперь код длиннее<br>    <b>bp eip</b><br>    //<b>sub eip,4</b>      - А это место вообще глушим оно раньше принудительно задавало тип<br>    //<b>add [eip],type_api</b>     перехода JMP или CALL<br><br> 5. Теперь спускаемся в подпрограмму @repuild_api: и находим такой блок<br>     mov edi,DLL_lost<br>     bc eip<br>     run  // сразу за run добавляем блок проверки какой переход найден и две его подпрограммы<br>     <br>     <b>OPCODE ebx - 1<br>     mov prov, &#036;RESULT<br>     ATOI prov<br>     mov prov, &#036;RESULT<br>     cmp prov,2E<br>     je call_15<br>     JMP call_25<br>  <br>     call_15:<br>     mov colich_call,colich_call + 1<br>     jmp pusk<br><br>     call_25:<br>     mov colich_jmp, colich_jmp + 1</b><br>  <br>     <b>pusk: </b>                  //Добавим необходимую метку<br>     <b>sub eip,37 </b>             //25- это значение старое у нас код длиннее<br><br>  6. Идём в подпрограмму @end: и меняем значения в блоке затирающем следы работы скрипта в <br>     секции PE-заголовка<br>     add eip,7<br>     bc eip<br>     <b>add eip,37</b>                 //25- это значение старое у нас код длиннее<br>     bc eip<br>     dec addr_finder<br>     <b>fill addr_finder,56,00 </b> //,44,00- это значение старое у нас код длиннее иначе не <br>     bphwc LoadLibrary        // затрёт полностью<br><br>     В этой же подпрограмме меняем строку выводящую информацию о работе скрипта<br>     eval &quot;Script finished! In total {counter} functions are restored!&quot;<br>     на эту:<br>     <b>eval &quot;Script finished! In total {counter} functions are restored! Восстановлено<br>     {colich_call} Call и {colich_jmp} jmp переходов.&quot;</b><br><br>     ВСЁ РАДОСТНО ИСПЫТЫВАЕМ СКРИПТ! МНОЙ ПОКА ОШИБОК В РАБОТЕ НЕ ОБНАРУЖЕНО!<br>     ТЕСТИРУЕМ(ЖЕЛАТЕЛЬНО НА ПРОГАХ ТОЛЬКО С ЗАЩИТОЙ ИМПОРТА, ТАК ПРОВЕРЯТЬ ЛЕГЧЕ)<br>     ЕСЛИ ОБНАРУЖИВАЕМ КОСЯКИ, ТО ПИШЕМ В ЭТОТ ТОПИК.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=138149&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=11" class="addthx" data-post="138149"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2007 07:12 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#12');return false;">#12</a> </span><div align=left><br>
И снова я поторопился. Скрипт работает только на файлах типа Адвенседа.Сорри перед всеми. Прийдётся учитывать в ассемблерной вставке, то что я делал ранее в прототипе на скриптовом языке(анализатор того что перед аспровым кэллом) и от чего отказался, или ещё более глубоко рыть в самой процедуре после переходника(в командной секции аспра) и искать закономерности. <img src="img/smilies/s9.gif" alt=""> Всё равно будет правильно для 2.1х определять хоть я год буду возиться!!!<img src="img/smilies/s10.gif" alt=""><br><br>Повторяю просьбу. Нужно много различных прог только с защищённым импортом для тестирования и проверки различных конструкций.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=138217&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=12" class="addthx" data-post="138217"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2007 16:00 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#13');return false;">#13</a> </span><div align=left><br>
<b>Hellspawn</b> есть идея и возник вопрос точнее два вопроса. Появилась идея использовать для скрипта сигнатуры или их общие части(так например  заглянув в сигнатуры ПЕ тулса можно увидеть что в трёх версиях Borland Delphi v4.0 - v5.0; Borland Delphi v4.0 - v5.0; Borland Delphi v3.0 используется общая часть  из всех трёх сигнатур 50 6A 00 E8 ?? ?? FF FF BA ?? ?? ?? ?? 52 89 05 ?? ?? ?? ?? 89 42 04).<br> Общая схема о которой я сейчас думаю: <br> а) Определяем, что этот файл принадлежит такой то версии делфи или там С, С++<br> б) Подставляем в третью часть инжекционного кода PE_kill-а(та что отвечает за восстановление перехода)необходимую сигнатуру, учитывающую особенности перехода JMP или CALL  в данной версии.<br><br>Почему вопрос именно тебе? Да потому что ИМХО DIE на сегодняшний день лучший анализатор паковки, компилинга. Так например PEID говорит на распакованный мной Иконловер не имеет вида, а DIE-Делфи 5<br><br> <b>Вопросы:</b><br><br> <b>1. На какой стадии и в какой секции нужно искать наличие сигнатур?</b>(что то я попробовал поискать средствами Оли обозначенную выше сигну в иконловере который на Делфи и ни в каких вариантах не нашёл, толи сигна плохая, но DIE показывает делфи5)<br><br> <b>2. Вообще какой алгоритм поиска сигнатур в незнакомых версиях компиляторов?</b>(меня сейчас как сам понимаешь волнуют сигны компиляторов или если есть в них различие сигны компиляторов под протекторами).<br><br><b>Hellspawn</b> пожалуйста, ответь на эти вопросы. Я понимаю, многим ветеранам, возможно и тебе  могут быть непонятны мои усилия. Зачем так рыть носом землю, если есть мастера, которые всё уже разработали. Но я хочу научиться всему, чтобы самому иметь подобные навыки и знания.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=138275&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=13" class="addthx" data-post="138275"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2007 16:47 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#14');return false;">#14</a> </span><div align=left><br>
<I>Small_S пишет:<br>1. На какой стадии и в какой секции нужно искать наличие сигнатур? </I><br><br>вообще в первой секции: CODE (но это до упаковки)<br><br>вот тебе мои нароботки:<br><br><b>Delphi 6,7 (_InitExe)</b><br>538BD833C0A3????????6A00E8????????A3????????A1????????A3????????33C0A3   ????????33C0A3<br>????????E8????????BA????????8BC3E8<br><br><b>Delphi 4,5 (_InitExe)</b><br>506A00E8????????BA????????5289??????????89????C7420800000000C7420C0000   0000E8<br>????????5A58E8<br><br><b>Delphi 3 (_InitExe)</b><br>506A00E8????????BA????????528905????????8942??E8????????5A58E8<br><br>+ я юзаю методу от ДеДе <img src="img/smilies/s2.gif" alt=""><br><br><I>Small_S пишет:<br>2. Вообще какой алгоритм поиска сигнатур в незнакомых версиях компиляторов? </I><br><br>пакуешь несколько файлов с разными опциями и смотришь одинаковое <img src="img/smilies/s1.gif" alt=""> (кол-во секций, их хар-ки,<br>расположение, нахождение импорта - в какой он секции и т.д.)
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=138284&amp;user=72&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=14" class="addthx" data-post="138284"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2007 21:23 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#15');return false;">#15</a> </span><div align=left><br>
<b>Hellspawn</b> фенкс за помощь. Уже копаю в этом напрвлении. Правда пока даже в распакованном мной файле в секции кода не могу найти сигнатуры:<br>Delphi 4,5 (_InitExe)<br>506A00E8????????BA????????5289??????????89????C7420800000000C7420C0000  0000E8<br>????????5A58E8 <br><br>Максимум что встречается(правда часто) из этого ряда это <br>506A00E8????????<br>Например:<br>006B588B---- 50-----------------------PUSH EAX<br>006B588C----6A 00--------------------PUSH 0<br>006B588E----E8 6925D5FF----------CALL &lt;JMP.&amp;user32.MessageBoxA&gt;<br>Ну да я согласен, что конструкция явно дельфовая, но всёж хотелось бы для приличия полную сигнатуру поймать.<br>Может правда делфи разный бывает DIE пишет:<br>Borland Delphi[ver:5] Object Pascal<br><b>Есть отличия в сигнатурах Borland Delphi[ver:5] Object Pascal и Delphi 4,5?</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=138337&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=15" class="addthx" data-post="138337"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2007 21:49 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#16');return false;">#16</a> </span><div align=left><br>
открой в ольге дельфовую прогу и зайди в первый call он и есть _InitExe <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=138344&amp;user=72&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=16" class="addthx" data-post="138344"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2007 21:59 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#17');return false;">#17</a> </span><div align=left><br>
<b>Hellspawn</b> Фенкс до меня начинает доходить почему на точке входа в запакованных, но остановленных перед самым запуском прогах не могу найти нужной сигны. Начало то спёрто в отдельную секцию да ещё и разбавлено мусором. Но вот почему я в распакованной NewSec не нахожу, пока недопёр. Я ж в неё восстановил начало скриптом SergSh. По идее основные конструкции должны сохраняться прога то работает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=138348&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=17" class="addthx" data-post="138348"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2007 22:33 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#18');return false;">#18</a> </span><div align=left><br>
Кажется нашел в NewSec только как же бедняжку перекурочило:<br>было сначала <b>50</b> потом через <b>JMP</b><br>007B7D7B     <b>6A 00</b>                        PUSH 0<br>007B7D7D     68 A57C7B00                  PUSH damp2_ic.007B7CA5<br>007B7D82   -<b> E9</b> 39F4C4FF                  JMP &lt;JMP.&amp;kernel32.GetModuleHandleA&gt;<br>потом прыг в первую секцию кода. Н-да.! Это целая история найти и интерпретировать её как дельфовую. У тебя там DIE по ходу умеет мусорный код разгребать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=138354&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=18" class="addthx" data-post="138354"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июня 2007 23:19 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#19');return false;">#19</a> </span><div align=left><br>
Привет всем. На работе прилично прижали со временем, пришлось временно замолчать. <br>Из новостей скрипт теперь правильно работает на трёх тестовых прогах (Иконловере, Адвенседе и Фонтэксперте), а может даже и на многих дельфовых,  и на многих сишных, не знаю, нужно тестить. Ключевой участок кода выглядит так:<br>GMEMI OEP, MEMORYBASE<br>  find &#036;RESULT,#8BC0FF25????????8BC0#                  <br>  CMP &#036;RESULT,0<br>  je Cwat<br>  mov    [eip],#5750E8099E407C9083C1043BCA7706390175F5EB0F3BF77409C701000000008 3C1048901518B4BFE80F98B740F8B4B0680F98B740766C703FF15EB0566C703FF25598 94B020000#<br>  mov nastroika1,3E<br>  mov nastroika2,5D<br>  jmp PRODOLJ<br><br>  Cwat:<br>  GMEMI OEP, MEMORYBASE<br>  find &#036;RESULT,#6A002EFF15????????# <br>  CMP &#036;RESULT,0<br>  je Cnorm<br>  mov [eip],#5750E8099E407C9083C1043BCA7706390175F5EB0F3BF77409C701000000008 3C1048901518B4BFF80F92E740866C703FF2559EB0666C703FF1559894B020000#<br>  mov nastroika1,37<br>  mov nastroika2,56<br>  jmp PRODOLJ<br>  <br>  Cnorm:  //#506A00E8????????#<br>  mov [eip],#5750E8099E407C9083C1043BCA7706390175F5EB0F3BF77409C701000000008 3C104890166C703FF00894B02#<br>  mov nastroika1,25<br>  mov nastroika2,44<br>  PRODOLJ:<br>  add eip,2<br><br>Однако постить полностью все изменения рано(кому нужно будет сами инициализируйте две новые переменные и там где идёт учёт смещений  бряков и освобождения памяти из за разной длины сигнатуры вставляйте эти переменные). Есть и ещё причины: если на Адвенседе и Фонтэксперте скрипт ведёт исправление и подсчёт безукоризненно, то при работе с иконловером присутствует целых 2 бага:<br><br>а) Первая исправляемая функция одновременно является и точкой входа в прогу, на которую ставит бряк скрипт из за чего видимо там в адресе(в даблворде отвечающем за адрес) появляется не нулевой старший байт(B4). Из за этого адрес переходника смотрит не на  скажем 006С45FE(точно не помню это от балды взято для примера) а на B46C45FE,- тоесть черте куда. Я в конец скрипта вставил проверку, там где eip на значение OEP переходит, этого байта, но тут как в поговорке&quot;не верь глазам своим&quot; при прогоне видно, что он нулевой(00), дык какого черта в окне CPU пишем B4. Знаю что в статье SergSh это место вручную правится, хотя там скрипт на другом принципе и тоже видимо косяк(но там вообще аспровый кэлл не преобразуется).<br><br>б)Когда прогоняется скрипт исправляет он 83h переходов типа jmp а пишет 73h. Уже проверял каждый аспровый кэлл в ручную по условию есть mov eax,eax до или после вызова. Хоть сверху, хоть снизу есть хотя бы по одному и правит правильно(83 перехода). Пока недопёр почему счётчик работающий идеально в двух других прогах всбрыкивает в этой. Вот код обновлённого счётчика(инициализируется ещё одна переменная):<br><br>  mov nastroika,ebx<br>  FIND nastroika,#25#<br>  mov nastroika,nastroika + 1<br>  cmp &#036;RESULT,nastroika   //prov,25<br>  je call_25<br>   <br>  call_15:<br>  mov colich_call,colich_call + 1<br>  jmp pusk<br><br>  call_25:<br>  mov colich_jmp, colich_jmp + 1<br>  <br>  pusk:<br><br>Есть и ещё причина участок кода, где задаются сигнатуры 3-ей инжекции будет не там где он сейчас, а в самом начале скрипта, он же будет одновременно не только задавать переменные для инжекции но и искать по типичным для каждой версии сигнам обращений к IAT, начало IAT. Все наверное заметили, что я отказался пока от идеи определять по полной сигнатуре тип компилятора и уже затем подгружать тот или иной вариант инжекции. Искать полное первое обращение к скажем гетмодулехандле у дельфовой проги под VM - это потребует недетской изворотливости от скрипта(там и кода наверное будет ещё треть от того, что уже есть в скрипте),  а это всего один вариант и фиг его знает сколько там всяких сюрьпризов в этом мусорном коде(в общем до времён когда или кодить буду мощнее или прижмёт, что деваться некуда). К томуже и так заставил правильно работать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139238&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=19" class="addthx" data-post="139238"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 июня 2007 20:55 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#20');return false;">#20</a> </span><div align=left><br>
Привет всем по поводу вчерашнего бага <b>а)</b> удалось разобраться написать в конце скрипта процедурку по коррекции этого бага. Сорри за плохую память и уточняю байт который там висит B4, сейчас исправлю в посте выше. Однако это не связано с постановкой бряка на точке входа. Я доходил до последнего исключения и последнего джеемпе и по Cntrl+G переходил на адрес 004071С0 без всяких бряков, <b>В4</b> там всё равно висит. <b>Причины этого байта мне непонятны может кто то пояснит из ветеранов?</b> Одно могу сказать точно обычными способами перезаписать из скрипта поверх <b>B4</b> 00,- не возможно(я перепробовал всяко, даже ставил eip посреди слова адреса и тёр нулями DWORD, результат один байты адреса перезаписываются, заколдованный байт нет). <br>  <br>Я поступил в связи с таким непонятным косяком в своей обычной манере,- если перелезть через гору никак, то обойдём её. Ниже участок кода, добавленный в конце скрипта. Он не требует инициализации новых переменных, используются 3 старых(их значения можно менять к этому времени) и пару регистров(аналогично). <br><br> bc eip<br>@CORREKCIA:<br>  mov nastroika,OEP<br>  FIND nastroika,#FF25??????B48BC0#<br>  CMP &#036;RESULT,0<br>  mov nastroika,&#036;RESULT<br>  je @endend<br>  FIND nastroika,#000000000000000000000000000000000000#<br>  cmp &#036;RESULT,0<br>  je @sorry<br>  mov nastroika1,&#036;RESULT + 8<br>  mov nastroika2,nastroika1-nastroika-5<br>  mov eip,nastroika<br>  mov [eip],#E9#<br>  mov ebx,nastroika2<br>  mov eax,[eip+2]    <br>  mov [eip+1],ebx<br>  mov eip,nastroika1<br>  mov [eip],#FF25#<br>  mov [eip+2],eax<br>  mov [eip+6],#8Bc0#<br>  mov [eip+8],#E9#<br>  xor ebx,ebx<br>  mov [eip+9],ebx - nastroika2 - A<br>  mov eip,OEP<br>  JMP @endend<br>@sorry:<br>  eval &quot;Вижу ошибку адресации IAT по адресу {nastroika}, но не могу найти достаточно свободного места, чтобы исправить!&quot;<br>  msg &#036;RESULT  <br>@endend:<br>  eval &quot;Script finished! In total {counter} functions are restored! Восстановлено {colich_call} Call и {colich_jmp} jmp переходов.&quot;<br>  msg &#036;RESULT<br><br>Логика подпрограммы проста. Ищет по сигнатуре этот косяк(после отработки основной части скрипта), если не нашёл то заканчиваем. Если нашёл, то ищем достаточно места,запоминаем адрес вызова API в таблице, в eax. Далее формируем переход туда пишем там нормальный вызов из таблицы, добавляем mov eax,eax  и записываем переход назад, но уже к следующему вызову API.<br><br>Данная доработка сделана не зря снял ради эксперимента дамп без устранения бага и нашёл в дампе <b>B4</b>. То есть без этого дополнения прейдёться править руками.<br><br>Обойти то обошёл, но просто любопытно что это за <b>B4</b> такое нестираемое??????????? <img src="img/smilies/s13.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139355&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=20" class="addthx" data-post="139355"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2007 23:02 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#21');return false;">#21</a> </span><div align=left><br>
Привет всем. И снова нужна помощь. Кто знает хорошо API. Мне нужна функция которая бы по адресу (четырёхбайтовому), что в IAT выясняла бы начало это АПИ-функи или нет(соответственно если не начало, то ноль в каком нибудь регистре). Лоадлайбрари, насколько я понял из статьи  PE_kill-а возвращает в EAX базу библиотеки, а в edi - указатель на строку названия функции(вроде не подходит ибо даже если и будет показывать не на строку названия, а куда то ещё, то как в асме различить на строку это или нет и если на строку то на какую). <br> <br> Зачем я думаю все понимают и против мусора, и для механизма поиска. Встречаются мусорные строки указывающие на область адресов API, но они явно левые, так как оля которая мигом пишет, имя API по 4-хбайтовому адресу просто молча показывает адрес.<br><br><b>Пожалуйста не молчим</b>, пожалуй только это держит, уже продуман и выполнен механизм поиска границ IAT. Возможно, что  и без такого определения будет работать, но хотелось бы сделать точно, всё левое вычистить, нормальные вызовы в API и в прогу оставить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139784&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=21" class="addthx" data-post="139784"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июня 2007 14:41 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#22');return false;">#22</a> </span><div align=left><br>
<b>Small_S</b><br>Ну насколько я видел разные анализаторы и т.д. Если им просто тыкают на какой-то адрес в пространстве процесса и спрашивают, это адрес АПИ-функции или нет, то они просто начинают парсить все экспортируемые функции из всех библиотек в этом процессе и просто сравнивать. Если совпало-АПИ, нет-значит нет. Способ хреновый и медленный, но лучше я не видел, если вопрос так понял. <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139895&amp;user=1556&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=22" class="addthx" data-post="139895"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июня 2007 14:58 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#23');return false;">#23</a> </span><div align=left><br>
<b>Archer</b> правильно понял. У меня уже есть задумка, по формальным признакам начала АПИ проверять прям по её коду, каждый вызов. В асм вставке это будет наверное довольно шустро. Я думаю пару байт сравнить у нескольких сотен функций  за секунду пробежит. Пока проверяю эту версию и пока против этого ничего не говорит, но крайне мало времени. Режим на работе до 21-21_30, ужин, отлежаться пол часа. И до 2х ночи больше не могу, сильно спать хочется на работе, на утро(с 8ми работаю).<br><br>Просто я думал есть АПИ какая нить ей кидаешь адрес, а она название функи + в другом регистре ноль если не точка входа в функу(начало функи), не знаю как правильно выразиться.<br><br>Читать, искать некогда, <b>Archer</b> не знаешь как там в апи устроено. В секции кода понятно код фунок, а где эти сами названия(строки)  и как они связаны  с началом этого кода??
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139896&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=23" class="addthx" data-post="139896"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июня 2007 15:50 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#24');return false;">#24</a> </span><div align=left><br>
Ещё интересный для меня вопрос: Что выполняется в асме быстрее-<br>mov ecx, 00000000h <br>или <br>xor ecx,ecx.<br><b>Или иными словами кто быстрее логика или присвоение?</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139904&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=24" class="addthx" data-post="139904"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июня 2007 17:03 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#25');return false;">#25</a> </span><div align=left><br>
<b>Small_S</b><br>Насчёт связи названия функи с началом её кода-надо смотреть в сторону таблицы экспорта, как она устроена. Тут устройство что для АПИ, что для любой библиотеки одинаковое. И лучше тут ничего нет, имхо, как парсить её именно руками, ибо так быстрее, чем вытаскивать оттуда имя, а потом через GetProcAddress искать её код. Своего кода у меня на это нет, так что поделиццо не могу. <img src="img/smilies/s9.gif" alt=""><br>Логика, имхо, побыстрее будет, но скорее всего не это место будет самым узким по скорости. <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139916&amp;user=1556&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=25" class="addthx" data-post="139916"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июня 2007 04:30 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#26');return false;">#26</a> </span><div align=left><br>
<I>Small_S пишет:<br>Ещё интересный для меня вопрос: Что выполняется в асме быстрее-<br>mov ecx, 00000000h<br>или xor ecx,ecx.  </I><br>xor ecx,ecx<br><I>Small_S пишет:<br>по формальным признакам начала АПИ проверять прям по её коду, </I><br>Мне кажется, ты слишком много хочешь от скрипта. Эта операция, если да же ты ее реализуешь, будет занимать много времени. Да и, насколько я помню, аспр забирает часть кода начала апи и у тебя могут возникнуть проблемы с распознованием одной и той же функции в разных прогах...<br>p.s. Может пора тебе перейти на &quot;чистый асм&quot; и писать лоадер?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139993&amp;user=1631&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=26" class="addthx" data-post="139993"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июня 2007 09:59 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#27');return false;">#27</a> </span><div align=left><br>
Привет всем.<br>tar4, немного недопонял меня. <br><br>Сейчас идёт работа над правильным распознаванием скриптом начала и конца IAT, с одновременным распознаванием и удалением адресов не имеющих отношения к вызовам АПИ и к вызовам в тело(в любые адреса) проги.<br>В идеале после работы распознавателя начала-конца и одновременно чистильщика всей секции, где находится таблица вызовов IAT, в данной секции должны остаться только вызовы АПИ и вызовы адресов, что ведут в прогу.И вся эта часть ещё до работы движка PE_kill-а, так как именно она &quot;сообщит&quot; движку исходные границы таблицы IAT.<br>Поэтому, я думаю, скрипт не будет волновать <b>аспр забирает часть кода начала апи </b>, ведь он забирает у спертых(защищённых), а мы чистим мусор среди неспёртых вызовов. <br><br><b>Или я ошибаюсь и он прёт даже у фунок, которые имеют изначально нормальный вызов в проге, и как вирь или драйвер размещает в системных библиотеках свои jmp на свой участок кода?</b><br><br>Определитель начала-конца+чистильщик будет в виде асм вставки.<br><br>К великому сожалению в последние дни меня сильно выматывают на работе, видимо основной результат будет на праздниках, когда появится хотя бы один спокойный день. Так то всё готово, подход к вставке готов, признаки начала АПИ(по которым буду смотреть мусор, не мусор) в секции кода системных библиотек изучены вчера. Осталось закодить вставку со свежей головой.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=140011&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=27" class="addthx" data-post="140011"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июня 2007 12:33 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#28');return false;">#28</a> </span><div align=left><br>
<b>Small_S</b> ыы, можно ничего не чистить, а просто похукать заполнение IAT адресами, мой последний скрипт именно так и делал. Составить свою таблицу адресов IAT и по ним восстанавливать.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=140035&amp;user=3232&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=28" class="addthx" data-post="140035"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июня 2007 20:23 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#29');return false;">#29</a> </span><div align=left><br>
<b>PE_Kill</b> , приветствую и на страницах топика!(в личке уже написал).<br><b>мой последний скрипт именно так и делал. </b>  А что за скрипт? Его где то найти можно или это что то приватное?<br><br><b>можно ничего не чистить, а просто похукать заполнение IAT адресами</b> - Это очень интересно и будет непременно изучено.<br><br>Просто сейчас я уже в шаге от выполнения того, чего задумал, уж дожму.(да и сколько времени потрачено ибо я не Гейтс, не Торвальдс и не Вирт,- вьезжаю ме-ее-едленно :s1<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=140085&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=29" class="addthx" data-post="140085"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2007 06:30 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#30');return false;">#30</a> </span><div align=left><br>
<I>Small_S пишет:<br>А что за скрипт? Его где то найти можно или это что то приватное? </I><br>После стотьи  дописывал скрипты. Когда скрипты превратились по размеру в толковые словари (ХЗ сколько тысяч строк там было) я их все грохнул, ибо скриптисы - зло, сильно держат в своих рамках и не дают создать что то действительно стоящее.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=140135&amp;user=3232&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=30" class="addthx" data-post="140135"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2007 22:33 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=7#31');return false;">#31</a> </span><div align=left><br>
Привет всем. Хотел я сегодня порадовать общество доделанным поисковиком чистильщиком, но случилась одна загвоздка. Вставка(асм) работает нормально и весьма быстро, пока проверяемые адреса имеют истиное значение, но среди мусора попадается некоторые значения, которые хотя и лежат в области АПИ библиотек, но в несуществующих адресах(там же секции не перекрывают полностью всё пространство). Вот когда асм вставка пытается прочесть признаки начала АПИ по такому адресу наступает исключение чтения чёрте от куда. <br><br>Знатоки функций АПИ, к вам обращаюсь!!!<br><b>НУЖНА АПИ КОТОРАЯ БЕРЁТ ЛЮБОЙ АДРЕС И ВОЗВРАЩАЕТ НОЛЬ(АДРЕС НЕ СУЩЕСТВУЕТ), 1 (АДРЕС СУЩЕСТВУЕТ).</b><br><br>Ни в жизнь не поверю, что такой нет на свете. Как это чудо зовётся? Мне не надо о ней дайте мне только имя уж я её нахлобучу как надо. Я сейчас пытаюсь подстроить сюда eoe команду скрипта, но это гон, асм в 1000раз быстрее, к тому же eoe весьма глючное существо (я уже имел с ним дело ранее)<br><br><b>PE_Kill</b> зло то оно зло но пока без них никуда.<img src="img/smilies/s15.gif" alt=""><br><br>Не молчим, вот оно, уже работает, хреновы исключения мешают!!! <img src="img/smilies/s10.gif" alt=""> <img src="img/smilies/s10.gif" alt=""> <img src="img/smilies/s10.gif" alt=""><br><b>Ну или как на асме обработать исключение чтения из никуда????????????????</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=140283&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=7&amp;anchor=31" class="addthx" data-post="140283"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=6.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=6.html">7</a> . <b>8</b> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=11.html">12</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=12.html">13</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=8.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка AsProtect на примерах</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="3">
<input type="hidden" name="topic" value="7466">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=7466" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
