<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Распаковка AsProtect на примерах - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте! Очень прошу, помогите найти или выдайте пжалста из запасов прогу Advanced Archive Password Recovery v.3.00 кто может, очень хочется научиться распаковке, а проги нормальной нет. Далее повтор моего вчерашнего">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=42623'>site-pro</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a>, <a target='_blank' href='?action=userinfo&amp;user=35066'>artyavmu</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка AsProtect на примерах</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=8.html">&lt;&lt;</a> <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=0.html">1</a> ... <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=8.html">9</a> . <b>10</b> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=10.html">11</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=11.html">12</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=12.html">13</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=10.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2007 12:10 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте! Очень прошу, помогите найти или выдайте пжалста из запасов прогу Advanced Archive Password Recovery v.3.00 кто может, очень хочется научиться распаковке, а проги нормальной нет. Далее повтор моего вчерашнего письма(лежит в чужой теме, найти можно в поиске введите: Распаковка ASProtecta - моё сообщение самое свежее)<br>----------------------------------------------------------------------  ------------------------------------------------------------------<br>Здравствуйте. Понимаю, что лезу немного не туда, но обсуждения статьи &quot;Распаковка нового ASProtect на примере Advanced Archive Password Recovery v.3.00&quot; автора SergSh на форуме и в поисковике вроде бы не видно(может статья просто древняя), а тут вроде бы тоже у ASR-ра 2-я версия. Суть проблемы:<br><br>1 Сам по вашим статьям научился распаковывать ASProtect 1.22-1.23 ,1.23 RC4, 1.24(проги типа Electra, Куриная месть.Первая разборка, скринсейвер и т.д. с затиранием репой краденого начала проги и без).<br><br>2 Нужно двигаться дальше и тут с удивлением обнаруживаю, что статей по распаковке версий 1.3-2.0 нет вааще(может я в шары долблюсь, незнаю). Плиз, если можно, то ссылку на подобную статью, а то руководство как починить велосипед есть(1.21-1.22), как починить мопед-есть(1.23 RC4), как починить боинг747 и космический челнок-есть(2.0x-2.12xx и выше). А вот как отремонтировать просто машину нет.<br><br>3 Из всех имеющихся статей более всего понятно было у SergSh в &quot;Распаковка нового ASProtect на примере Advanced Archive Password Recovery v.3.00&quot;, но тут такой казус. Проискав в инете подопытную прогу версии 3.0 нашел две ссылки, скачал, инсталятор обещал версия 3.0 (как в статье),- в итоге версия 3.01, чем забиты все ссылки на эту прогу в инете и PEID говорит не ASProtect 1.2-1.3 registered(2.0x по словам SergSh),а ASProtect 2.1x SKE. Ну ладно:<br><br>а)34раз Shift+F9 ставим бряк на ближайший переход внизу, ещё раз Shift+F9, снимаем бряк,ставим на Alt+M на секцию кода(401000), но не снова Shift+F9, как в статье, а trace into(а то EOP будет на две команды ниже и затруться два Push-а). Останавливаемся на EOP 42A910. Ctrl+A и всё видится чинно и благородно.<br><br>б)Читаем статейку дальше и пробуем запустить его скрипт(в папку его,в Script , в Олю, в виде txt предварительно). И оля повисает пробовал подождать 1,5 часа думал это скрипт так долго на более свежей версии ASp-ра трудится(хрен то там:s14. Запущено как положено без бряков и с OEP после trace into и я в plugin-&gt;IsDebuggerPresent -&gt;Hide, с полным игнором исключений.<br><br>в) Руками по его совету IAT пока не пробовал, всё так пока трудно для понимания и непривычно и завтра на работу а уже 2ночи. Граждане, слезно молю дайте ссылку на настоящий Advanced Archive Password Recovery v.3.00, а то шатл починить не могу пока, дайте хоть чертежи к боингу. А если почти серьезно, то научиться распаковывать ASPr до второй версии включительно руками хочется так, что аж эти руки зудят.<br><br>P.S. Не пинайте сильно за дурацкие просьбы самого маленького. Это первый выход в свет. Начал реверсить 18.12.06 с нуля. Реверсил даже в новогоднюю ночь. Для меня это очень важно(научиться распаковывать)!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=115630&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=1" class="addthx" data-post="115630"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2007 08:39 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#2');return false;">#2</a> </span><div align=left><br>
<I>Small_S пишет:<br>В общем предстоят продолжительные эксперименты с попытками изменить атрибуты &quot;налету&quot; </I><br>VirtualProtect Addr=ImageBase,Size=1000h,NewProtect=PAGE_READWRITE ну или как тебе надо
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=141926&amp;user=3232&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=2" class="addthx" data-post="141926"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2007 09:50 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#3');return false;">#3</a> </span><div align=left><br>
<b>PE_Kill</b> фенкс, если я верно понял это на СИ. Но уже легче я где то уже видел в одной из статей как <br>VirtualProtect в асме юзается. Хотя уже практически готов вариант с формированием адресов и размеров областей аспра в стеке и с последующенй работой на сверку от туда. Всё равно нужно знать на будущее.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141930&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=3" class="addthx" data-post="141930"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2007 10:39 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#4');return false;">#4</a> </span><div align=left><br>
<I>Small_S пишет:<br>если я верно понял это на СИ. </I><br>Неа, это я сам синтаксис придумал, а название функи из МСДН
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=142020&amp;user=3232&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=4" class="addthx" data-post="142020"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2007 21:43 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#5');return false;">#5</a> </span><div align=left><br>
Привет всем. К сожалению на работе крутой аврал. Второй вечер не могу даже прикоснуться к скрипту. Есть время только отвечать на посты и задавать вопросы. У меня нет МСДН, но есть справка к делфи 6, немного подрезана, но достаточно полная перевёл оттуда про VirtualProtect и сразу возникли 2 вопроса.<br>  <br>  1)<b>PE_Kill</b> пишешь <b>NewProtect=PAGE_READWRITE</b> ещё скажи как там флаг тот или иной задаётся? Я имею ввиду какую циферку нужно в стек третьей пихать(там ведь 10 разных флагов,-PAGE_READONLY, PAGE_READWRITE, PAGE_WRITECOPY, PAGE_EXECUTE, PAGE_EXECUTE_READ, PAGE_EXECUTE_READWRITE, PAGE_EXECUTE_WRITECOPY, PAGE_GUARD, PAGE_NOACCESS, PAGE_NOCACHE,). Или всё просто например:<br>пихаем 00000001,-значит PAGE_READONLY, пихаем 00000002,-значит PAGE_READWRITE и т.д.<br>Или там иначе, я конечно проверю своё предположение, как время появится, но вдруг принцип другой перебирать целый DWORD, это не фунт изюма. Подскажи не разу не грамотному или может общий принцип выставки флагов есть(наверно есть элементарное правило, но что то не попадалось на глаза).<br><br> 2)Не понятен такой момент пишут про четвёртую входную переменную<b> lpflOldProtect</b> (ты писал 3)<br>Points to a variable that the function sets to the previous access protection value of the first page in the specified region of pages. If this parameter is NULL or does not point to a valid variable, the function fails. <br>Я перевёл так(ну конечно при моих познаниях инглиша):<br><br>Направьте на <b>переменную</b> хранящую функциональные наборы  предыдущего значения защиты доступа первой страницы в указанной области страниц. Если этот параметр НУЛЕВОЙ или не указывает на правильную переменную,наступают функциональные сбои. <br><br>Я как будет время прочитаю досконально скачанную статью по PE-заголовку. Я верно думаю? Это там где то <b>переменная</b> на каждую секцию лежит?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=142148&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=5" class="addthx" data-post="142148"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2007 21:55 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#6');return false;">#6</a> </span><div align=left><br>
<I>Small_S пишет:<br>Я как будет время прочитаю досконально скачанную статью по PE-заголовку. Я верно думаю? Это там где то переменная на каждую секцию лежит? </I><br><br>ты должен указать переменную в которую возвратиться пред. атрибуты области памяти <img src="img/smilies/s1.gif" alt=""><br><br><I>Small_S пишет:<br>пихаем 00000001 </I> ну почти так:<br><br>PAGE_NOACCESS = 1;<br>PAGE_READONLY = 2;<br>PAGE_READWRITE = 4;<br>PAGE_WRITECOPY = 8;<br>PAGE_EXECUTE = &#036;10;<br>PAGE_EXECUTE_READ = &#036;20;<br>PAGE_EXECUTE_READWRITE = &#036;40;<br>PAGE_EXECUTE_WRITECOPY = &#036;80;<br>PAGE_GUARD = &#036;100;
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=142154&amp;user=72&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=6" class="addthx" data-post="142154"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2007 22:06 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#7');return false;">#7</a> </span><div align=left><br>
<b>Hellspawn</b> спс за скорость.<br>На второй поврос тоесть(в условиях асма) любой адрес с достаточным для PDWORD свободным местом. Поправить если не так.<br><br>На первый вопрос А-гаааааа тут то она и попалась!<img src="img/smilies/s3.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=142158&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=7" class="addthx" data-post="142158"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2007 22:07 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#8');return false;">#8</a> </span><div align=left><br>
<I>Small_S пишет:<br>На первый поврос тоесть(в условиях асма) любой адрес с достаточным для PDWORD свободным местом. Поправить если не так. </I><br><br>ну да + возможность записи по этому адресу <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=142159&amp;user=72&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=8" class="addthx" data-post="142159"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2007 22:19 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#9');return false;">#9</a> </span><div align=left><br>
<b>Hellspawn</b> и ещё ты не в курсе? Когда я начал ковырять не только Аспр 2.хх, но и 1.35, обратил внимание, что очень бедно с OEP-фаиндерами. Так у меня из пяти скриптов по Аспр 1.2х-1.3х всего один от бит хака (кэлл то кэлл) со встроенным скриптом от sanniassin в одном из трёх разных прог нашёл OEP.<br>Тебе известны более менее универсальные для 1.35 или ссылки на тутор где есть основные принципы поиска в версиях без исключений. Я там с разными извращениями доходил вроде до OEP или VOEP, но как то всё смотрелось ненадёжно, да и муторно перекидывать после некоторых признаков то на чтение кода, то на аспр секцию, то обратно. Может кто уже нормальный алгоритм разработал, ну или скрипт чтоб поизучать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=142164&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=9" class="addthx" data-post="142164"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 июня 2007 22:26 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#10');return false;">#10</a> </span><div align=left><br>
Привет всем. Обложили меня работой волки(с ударением на последний слог). Только сегодня немного удалось посидеть с асм вставкой. К этому моменту я пока всё также дорабатываю поиск через стек(не пробовал записи в PE-заголовок). Саму встаку, которая уже ищет правильно и до 00400000 и после проги до системных библ, ещё нужно оптимизировать. Главная недоработка адреса после последних участков выделенной аспр-памяти и до системных библ, там большой кусок недоступной памяти получается, соответственно с исключениями и  вставка притормаживает минут на 6. Но уже знаю решение и скоро уберу. В младшей части ECX организую счётчик до 1-ой шестнадцатеричной тысячи(что составляет 1000Х1000=1000000h) и буду его сбрасывать если попался читаемый участок и наращивать, если попался нечитаемый. Как только размер нечитаемой памяти перевалит через 1000000h вставка прекратит сканировать память, экономия во времени составит около 5B260000h/1000000h=5Bh=90раз, т.е. 360с/90р=4сек, что вполне приемлемо(ну в действительности около 10-ти, так как до этого момента ещё есть). Пока вид у вставки страшный, одна только сигнатура почти на 100 байт:<br><br>#6A006A005253558BEC33D283C508516A006A0033DB3BD1734A6068FF0F000052E8939 1407C83F800751C613E837C24040075053E8954240481C30010000081C200100000EBC F6183FB00750881C200100000EBC13E011C2481C2000001006633D2EBAC81F90000265 B740C87EC5A87E5B90000265BEB9E83C4083E833C2400740583C404EBF483EC10595D5 B5A83EC0C3E833C2400740583EC04EBF483EC08EB6883C4088BEC83C5083E8B4500390 372113E0345FC3903770983EC0858E99500000083C5083E837D0C007402EBDB83EC085 883EC04EB7A0000#<br><br>но повторюсь ещё доработаю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=143147&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=10" class="addthx" data-post="143147"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 июня 2007 21:34 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#11');return false;">#11</a> </span><div align=left><br>
Привет всем. Наконецто скрипт работает нормально с асм вставкой по корректной очистке ссылок на любые области в секции с таблицей IAT. Он это делает корректно и ниже проги(возможные обращения в собственные этой проги драйвера), и выше проги (в секции аспра), и ещё выше (в системных библиотеках). Потестил только что на 8-ми прогах везде начало-конец правильно, очищено корректно. Конечно теперь нули в секции с IAT не сплошные, но зато остаются целыми например такие места как в иконловере:<br><br>006E1444  00000000  ....<br>006E1448  00000000  ....<br>006E144C  7C812AC6  Ж*Ѓ|  kernel32.GetSystemInfo<br>006E1450  00000000  ....<br>006E1454  00000000  ....<br>006E1458  00C87290  ђrИ.===========================ВОТ ОНО<br>006E145C  00000000  ....<br>006E1460  00000000  ....<br>006E1464  00000000  ....<br>006E1468  00000000  ....<br>006E146C  7C80D47E  ~ФЂ|  kernel32.GetLocaleInfoA<br><br>или как в актуалспа:<br><br>00531B0C  77D7A32A  *ЈЧw  user32.DdeUninitialize<br>00531B10  77D7A4EE  о¤Чw  user32.DdeInitializeA<br>00531B14  00000000  ....<br>00531B18  00334070  p@3.  hk.RemoveMouseHook<b>--------вот это явно какие то дрова или библы проги</b><br>00531B1C  00334040  @@3.  hk.SetMouseHook<br>00531B20  00000000  ....<br>00531B24  0034448C  ЊD4.  hprog.ShowProcess<br>00531B28  003443BC  јC4.  hprog.HideProcess<br>00531B2C  00000000  ....<br>00531B30  00000000  ....<br><br>Теперь, кстати, дальнейшая работа пойдет над обработкой подобных мест в IAT, так как первый пример ведёт в секцию аспра, а оттуда в собственную аспровую таблицу IAT(я уже находил такое и в иконловере и в актуалспа), где в данном случае вызывается kernel32.GetProcAddress<br><br>00C9C270  7C80176B  kЂ|  kernel32.GetSystemTime<br>00C9C274  7C812AC6  Ж*Ѓ|  kernel32.GetSystemInfo<br>00C9C278  7C80AC28  (¬Ђ|  kernel32.GetProcAddress++++++++++++++++++++++++++Вот оно<br>00C9C27C  7C80B529  )µЂ|  kernel32.GetModuleHandleA<br>00C9C280  7C80B357  WіЂ|  kernel32.GetModuleFileNameA<br><br>Ну а завтра добавлю во вставку двига PE_kill-а чтобы когда дописывает новую апишку смотрело по адресу где пишет ноль или нет(если не ноль, то смотрим следующий). А то первый пример посреди секции и его точно не затрёт, а вот второй пример это после конца IAT и надо, чтобы он оставлял всякие вызовы типа:<br><br>00531B24  0034448C  ЊD4.  hprog.ShowProcess<br>00531B28  003443BC  јC4.  hprog.HideProcess<br><br>Завтра же постараюсь описать для любопытствующих саму вставку, которую так долго дописывал(правда в основном из за нехватки времени). Пока скрипт в аттаче.<br><br>p.s. скрипт немного(у меня на пресскоте 3,5ГГц-4 секунды)задумывается, когда чистит секцию и анализирует адреса на валидность,- это нормально.<br><br><b>Hellspawn</b> отдельно благодарю за выложенный аналог импректа(это было в другом топике, заметил и скачал) и вообще за помощь. Буду изучать в дальнейшем, может когдато смогу его переделать и доделать.<br><br><img src="img/attach.gif" alt=""> <a href="./files/58b9_28.06.2007_CRACKLAB.rU.tgz">58b9_28.06.2007_CRACKLAB.rU.tgz</a> - IAT_rec_modern1pSO.osc
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=143673&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=11" class="addthx" data-post="143673"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 июля 2007 22:12 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#12');return false;">#12</a> </span><div align=left><br>
Привет всем! Наконец то могу выдать нормально рабочую версию скрипта ибо пришлось повозиться по порядку:<br><br>  1Скрипт теперь не только грамотно чистит, но и не трёт подозрительные вызовы  в тело проги или в выделенные участки Аспровой памяти.<br>Хотя я не совсем доволен как удалось сделать, но из тех вариантов, что перепробовал этот пока оптимальный. Хотел сделать как PE_kill, чтобы шёл массив функций из одной библы, затем через ноль следующий массив и т. д., но при этом через ноль или через нули пропускались эти самые подозрительные адреса(см. предыдущий пост). Однако оказалось, что исходный механизм определения и сравнения базы прошлой восстановленной функи (ESI)  и нынешней восстановленной функи(EDI), не идеален. Он хорошо действует пока после найденной в уже существующей таблице функе не появится функа из другой библиотеки, но вызова которой ещё нет в IAT(или может это получалось при взаимодействии с моим кодом, хотя врятли). Тогда в редких случаях рядом ставились функи из разных библ и импрект не желал их нормально определять. Я хотел схитрить и нулить младшую часть даблворда адреса фунок и сравнивать две соседние, но оказалось, что системные библы сильно велики и в одной библе может быть не одна 10000, поняв что затея будет не слабее чем с очисткой секции IAT, решил пока пойти по более лёгкому пути, как у Сержа. Заделал во всех трёх вставках запись найденных фунок через ноль и подозрительные вызовы через один или два ноля. Всё в импректе более нет залипаний фунок с разных библ, а подозрительные адреса можно смотреть хоть до, хоть после скрипта, снятия дампа или восстановления в импректе.<br><br>  2.Ещё одна мелкая неприятность была обнаружена, она состоит в том, что с очисткой мусора импрект начал иногда брать появившиеся двойные нули за начало IAT, таким образом обрезая часть IAT при автоматическом определении. Пока сделал дёшево  сердито. В конце скрипта, в мессаге сообщается не только, сколько было восстановлено переходов и какого они типа, но и что нужно вбить в окно RVA(начало IAT) и что нужно вбить в окно Size(конечный размер IAT) для правильного восстановления. Причём после такого вбивания(ну конечно не забываем задать и OEP) и нажатия на гет импорт и шов инвалид можно сразу отрезать то, что там будет. Не нужно ни дизасма, ни плага 1.23, никаких слипаний, ничего похожего на вызовы АПИ. Не определёнными будут только около десятка- двух этих самых подозрительных вызовов. В общем я проверял на 5ти прогах просто сказка.<br><br>Знаю вставки ещё можно шлифовать и шлифовать, как будет время оптимизирую и наверное сделаю механизм заполнения найденных фунок в пределах старой таблицы с одновременным решением проблемы появившихся двойных нулей.<br><br>Ну а пока вперёд на последний бастион импорта- забранные в командную Аспр секцию в её Аспр IAT функи, которые пока скрипт не определяет(см. пример из предыдущего поста).<br><br>Про обещание пояснить что я накодил не забыл, завтра постараюсь, спать пора, завтра на работу.<br><br><img src="img/attach.gif" alt=""> <a href="./files/6fdf_03.07.2007_CRACKLAB.rU.tgz">6fdf_03.07.2007_CRACKLAB.rU.tgz</a> - IAT_rec_modern1pSO.osc
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=144606&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=12" class="addthx" data-post="144606"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июля 2007 22:05 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#13');return false;">#13</a> </span><div align=left><br>
Вот краткие пояснения. Реализация слабовата(особенно хождение по стеку туда сюда), но на тот момент времени не было вааще, сам поражаюсь как накодил урывками по нескольку минут, почти не имея возможности сосредоточиться:<br><br><b>PUSH 0  </b> //<br><b>PUSH 0  </b> //Признак начала искомых адресов в стеке двойной ноль<br><b>PUSH EDX</b>   //пушуем конец последней секции проги<br><b>PUSH EBX</b>   //пушуем начало секции таблицы импорта<br><b>PUSH EBP</b>   //без сохранения EBP видимо тоже не обойтись так как стек крутим по полной<br><b>MOV EBP,ESP</b> //запоминаем нынешнюю вершину стека<br><b>XOR EDX,EDX</b>  //проверять память будем вначале с нуля, вот и ноль в EDX<br><b>ADD EBP,8 </b>   //у нас уже много чего запихано в стек подныриваем поближе к началу<br><b>PUSH ECX </b>   //сохраняем ECX-это будет очень хитрый регистр старшая часть контролирует текущий адрес<br>            //младшая сколько уже было обращений к несуществующим адресам<br><b>PUSH 0 </b>    //а эти нули нужны для правильной работы кода вместо них будет адрес начала секции<br><b>PUSH 0 </b>     // и её размер<br><b>XOR EBX,EBX</b>   // Освобождаем регистр для работы<br><b>CMP EDX,ECX</b>   //и начинаем сравнивать не достиг ли текущий адрес в начале 00400000, а затем границы библ<br><b>JNB SHORT icolover.00400D6C</b> //если не ниже то пора менять значение ECX или вообще заканчивать сканить<br><b>PUSHAD</b>        //сохраняем все регистры <br><b>PUSH 0FFF</b>     //готовим чтение на 1000 байт от заданной позиции<br><b>PUSH EDX </b>     //это заданная позиция<br><b>CALL kernel32.IsBadReadPtr </b> //читаем по заданным условиям<br><b>CMP EAX,0</b>     //а прочитали ли мы?<br><b>JNZ SHORT icolover.00400D44</b>  //не прочитали и значит нужно будет идти увеличивать счётчик CX и текущий EDX<br><b>POPAD </b> //а это если прочитали, вначале вынимаем все регистры из стека<br><b>CMP DWORD PTR DS:[ESP+4],0</b> //затем сравниваем была ли запись базы этого участка памяти в стеке<br><b>JNZ SHORT icolover.00400D33 </b> //была и тогда уходим<br><b>MOV DWORD PTR DS:[ESP+4],EDX </b> //не было и тогда пишем адрес базы в стек<br><b>ADD EBX,1000</b>    //запись размера области уже была или не была,но просто увеличиваем<br><b>ADD EDX,1000 </b>   //и текущий проверочный адрес тоже увеличиваем<br><b>XOR CX,CX</b>  // поскольку мы прочитали то счётчик чтения недоступных адресов обнулился<br><b>JMP SHORT icolover.00400D10</b>  //ну и пошли на новый круг проверки<br><b>POPAD</b>   //ну а теперь если не прочитали, вынимаем все регистры из стека<br><b>CMP EBX,0</b>   //был ли размер области выделенной памяти в EBX?(а не первый ли раз мы не прочитали?)<br><b>JNZ SHORT icolover.00400D5B</b>  //первый и значит нужно пойти и записать размер законченной области<br><b>ADD EDX,1000</b>  //увеличиваем текущий адрес<br><b>INC CX </b>  //увеличиваем счётчик &quot;неправильных чтений&quot;<br><b>CMP CX,0FFF</b>  //ВАЖНЫЙ МОМЕНТ.ЕСЛИ CX ПРЕВЫСИТ ЭТУ ВЕЛИЧИНУ, ЗНАЧИТ МЫ УЖЕ ГДЕ ТО ОЧЕНЬ ВЫСОКО<br><b>JNB SHORT icolover.00400D80 </b> //НАД СЕКЦИЯМИ АСПРА И ПОРА ЗАКАНЧИВАТЬ(ФИШКА СОКРАЩАЕТ ВРЕМЯ в десятки раз)<br><b>JMP SHORT icolover.00400D10 </b> //в противном случае уходим на следующий круг проверки<br><b>ADD DWORD PTR DS:[ESP],EBX</b>    // вот здесь пишем размер текущего участка выделенной памяти<br><b>ADD EDX,10000</b>    //а эта фишка тоже для экономии времени, правда не столь сильной<br><b>XOR DX,DX</b>        //(если область закончилась то можно прибавить больше и чтоб до ровной 10000)<br><b>INC CX</b>           //и здесь увеличиваем счётчик &quot;неправильных чтений&quot;<br><b>JMP SHORT icolover.00400D0A</b>  //а отсюда переход пушевание двух нулей и начало розыска следующ области<br><b>CMP ECX,5B260000 </b>            //а здесь начинаем задавать новую верхнюю границу адреса проверки<br><b>JE SHORT icolover.00400D80</b>   //и если уже всё просканировали то заканчиваем с этим<br><b>XCHG ESP,EBP</b>                 //Далее быстренько достаём значение конца последней секции проги<br><b>POP EDX</b>                      //теперь ведь сканить будем не с ноля а с конца проги до<br><b>XCHG EBP,ESP</b>                 // системных библиотек. Это значение передаём в EDX<br><b>MOV ECX,5B260000</b>             // ну а ECX присваиваем значение нижней границы библ<br><b>JMP SHORT icolover.00400D10</b>  //погнали снова сканить память<br><br><b>ADD ESP,8</b>                  //далее идем по стеку до наших сохранённых регистров<br><b>CMP DWORD PTR DS:[ESP],0</b>   //используя как признак ноль<br><b>JE SHORT icolover.00400D8F</b> //и уходим  по достижению на доставание значений регистров<br><b>ADD ESP,4 </b>                 //иначе продолжаем сканить<br><b>JMP SHORT icolover.00400D83</b><br><b>SUB ESP,10</b>                 //подныриваем под значения<br><b>POP ECX                    <br>POP EBP<br>POP EBX<br>POP EDX  </b>                  //вытаскиваем их<br><b>SUB ESP,0C</b>                 <br><b>CMP DWORD PTR DS:[ESP],0 </b>    //далее снова по стеку назад используя признак нуля<br><b>JE SHORT icolover.00400DA5</b>   //<br><b>SUB ESP,4</b><br><b>JMP SHORT icolover.00400D99</b>  //<br><b>SUB ESP,8 </b>                   //а вот этот прыжок готовит два нуля для другой АСМ вставки<br><b>JMP SHORT icolover.00400E04</b>  //на неё по окончанию и прыгаем когда регистры приведены в первоначальный вид.<br><br>Далее ничего сложного. Другая вставка формирует адреса из секции таблицы IAT(она сканит уже секцию с IAT а не память).Те адреса, что были в границах библ она проверяет на чтение сама, а адреса ниже 00400000 и выше последней секции проги, но ниже нижней границы библ поставляет сюда. В этой вставке происходит сверка присланного адреса, со значениями, что теперь есть у нас в стеке и далее в зависимости от того входит адрес в какую либо из обнаруженных реально существующих секций или нет идёт прыжок в другую вставку на затирание или на оставление в покое этого адреса.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=144784&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=13" class="addthx" data-post="144784"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2007 16:36 &middot; Поправил: Isaev <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#14');return false;">#14</a> </span><div align=left><br>
<b>1.</b> &quot;IAT_rec_modern1pSO.osc&quot; какие версии может?<br>Пробывал на iconlover 3.0 (Version: ASProtect 2.xx (may be 2.11) Registered [1])<br><i class=x>&quot;Скрипт очистил секцию адресации IAT по адресу 0, он определил начало таблицы как FFF, конец таблицы как 1000. Если вы согласны нажмите &quot;Да&quot;. Если хотите задать границы работы скрипта сами нажмите &quot;Нет&quot;!&quot;</i><br>При задании далее вручную, летит куча ошибок...<br><br><b>2.</b> Каким образом правильно определить конец IAT?<br>В статье SergSh&#039;a этот момент как-то не очень понял...<br><br><b>3.</b> В актуальной версии iconlover (Version: ASProtect 1.35 build 04.25 or 06.26 Release [Extract])<br>по версии 1.35 почти ничего на форуме нет (или не нашёл)...<br>исключения там не возникают... Как с ним бороться?
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=147822&amp;user=6946&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=14" class="addthx" data-post="147822"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2007 18:23 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#15');return false;">#15</a> </span><div align=left><br>
Всем привет.<br><b>Isaev</b> на <b>&quot;IAT_rec_modern1pSO.osc&quot; какие версии может?</b> может многие версии(как и его исходный от PE_kill) 2х, 2.1х, 1.35, но нужно выйти на OEP, а не VOEP и причём правильно(когда IAT развернулась). iconlover 3.0 точно может проверено на многих машинах, правда на XP SP2 только.<br><br>Посему дружище, бери версию пять VOEP-OEP-фаиндера из этого же топика.<br>а)запускаешь, после непродолжительной работы скрипт выводит сообщение, &quot;Скрипт просканировал память! База, блока виртуальной памяти=хххххххх !&quot; .<br>б)нажимаешь кнопку отмена, так как тебе в данном случае VOEP не надо.<br>в) Ставишь бряк на доступ к секции кода(она по 00401000), жмёшь Shift+F9. Падаешь на OEP.<br>г) Снимаешь  этот бряк, так как изначально скрипт требовал отсутствие посторонних бряков и в модефикации это сохранилось. Ну и всё запускаешь IAT_rec_modern1pSO.osc<br><br>Да ещё пока не забыл обязательно выставь в настройках оли галку игнорирования исключений в кернеле32 иначе активно юзающаяся в ассемблерной вставке <b>kernel32.IsBadReadPtr</b> просто будет после наступления каждого исключения доступа к памяти стопорить Олю и скрипт. И ты наверное успеешь поседеть прежде чем первая вставка отработает, к тому же сотрёшь до локтя палец задавливая Shift+F9.<br>Кстати у тебя скорее всего именно из за этой галки скрипт и не пашет.<br><br>Если не поможет скинь пожалуста дамп твоего OEP в виде txt, откуда запускаешь скрипт. Но всё должно быть тип топ ибо модефикация скрипта изначально разрабатывалась на основе иконловера, фонтэксперта и пассворд рековера.<br><br><b>по версии 1.35</b> действительно нет пока более менее универсального VOEP-OEP-фаиндера, я ещё доберусь до этого, но пока даже продолжать IAT_rec_modern1pSO.osc некогда.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147835&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=15" class="addthx" data-post="147835"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2007 18:51 &middot; Поправил: Isaev <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#16');return false;">#16</a> </span><div align=left><br>
<I>Small_S пишет:<br>а)запускаешь, после непродолжительной работы скрипт выводит сообщение, что обнаружена область выделенной памяти по адресу такому то и что VOEP находится по адресу такому то. <br>б)нажимаешь кнопку отмена, так как тебе в данном случае VOEP не надо. </I><br>Ну так в этот момент ты уже на ней<br><br><I>Small_S пишет:<br>Кстати у тебя скорее всего именно из за этой галки скрипт и не пашет. </I><br>Я скрипт второй запускал с VOEP...<br><br>(я вообще думал, что они VEOP и OEP вместе не существуют... Заблуждаюсь?)<br>с VOEP я разобрался и вручную, а как OEP найти?
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=147837&amp;user=6946&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=16" class="addthx" data-post="147837"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2007 19:59 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#17');return false;">#17</a> </span><div align=left><br>
<b>Ну так в этот момент ты уже на ней</b> нет ты в этот момент на последнем джеемпе(после последнего исключения). Немного я неправильно текст сообщения передал, сорри, оно выглядит так:<br>&quot;Скрипт просканировал память! База, блока виртуальной памяти=001100000 !&quot; (у меня так у тебя другой адрес будет). Сейчас поправлю предыдущий пост.<br><br><b>я вообще думал, что они VEOP и OEP вместе не существуют... </b> так то оно да, вместе не существуют. Просто для ясности полагаю называть VOEP- виртуальную(лежащую в выделенном участке памяти)точку входа в программу, а за OEP место первого обращения к секции кода проги.<br><br>Если ты запустишь скрипт в выделенном участке памяти(VEOP), то он просто не находит, по сигнам обращение того или иного типа и не может правильно выскочить на секцию в которой находится IAT, ну и как следствие не может почистить и т.д.<br><br>Действуй как написано выше. С последнего джеемпе,отмена, бряк на секцию кода проги на чтение, Shift+F9, снимаешь бряк и запускай скрипт.<br><br>Вот какая OEP у меня:<br><br>004071C0     E8 3B8ED100                  CALL 01120000<br>004071C5     B4 8B                        MOV AH,8B<br>004071C7     C0FF 25                      SAR BH,25                                        ; Shift constant out of range 1..31<br>004071CA     2813                         SUB BYTE PTR DS:[EBX],DL<br>004071CC     6E                           OUTS DX,BYTE PTR ES:[EDI]                        ; I/O command<br>004071CD     008B C0FF2524                ADD BYTE PTR DS:[EBX+2425FFC0],CL<br>004071D3     136E 00                      ADC EBP,DWORD PTR DS:[ESI]<br>004071D6     8BC0                         MOV EAX,EAX<br>004071D8   - FF25 20136E00                JMP DWORD PTR DS:[6E1320]                        ; kernel32.TlsSetValue<br><br>тут замусоренно получается из за того, что первый же шаг на входе и сразу идём в Аспрову защиту импорта -<b>CALL 01120000</b>. Не пугайся, запускай скрипт он этот и многие другие вызовы исправит.<br><br>например из этого куска: <b>8BC0 FF2524136E00 8BC0</b>- типичный вызов в делфи апи-функи из IAT.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147849&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=17" class="addthx" data-post="147849"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2007 22:16 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#18');return false;">#18</a> </span><div align=left><br>
<I>Small_S пишет:<br>База, блока виртуальной памяти=001100000 !&quot; (у меня так у тебя другой адрес будет) </I><br>у меня 011D0000 а почему он в принципе другой?<br><br><br>Скрипт пошёл <img src="img/smilies/s1.gif" alt=""> !<br>&quot;Скрипт очистил секцию адресации IAT по адресу 6E1000, он определил начало таблицы как 6E1220, конец таблицы как 6E1D04.<br><br>Но уже после часа работы в цикле:<br>006E2021  41              INC ECX<br>006E2022  3BCA          CMP ECX,EDX<br>006E2024  73 13         JNB SHORT icolover.006E2039<br>006E2026  8039 E8     CMP BYTE PTR DS:[ECX],0E8<br>006E2029  75 F6         JNZ SHORT icolover.006E2021<br><br>я начал подозревать, что что-то не так <img src="img/smilies/s4.gif" alt=""><br>[там снизу пишуться адреса срабатывания Exceptions. В каких пределах они примерно должны быть?]<br><br><I>Small_S пишет:<br>Вот какая OEP у меня: <br>004071C0 E8 3B8ED100 CALL 01120000 </I><br><br>у меня:<br>004071C0 E8 3B8EDE00 CALL 011F0000<br>Не скинешь мне свою версию iconlover? Наверно build другой
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=147870&amp;user=6946&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=18" class="addthx" data-post="147870"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2007 04:25 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#19');return false;">#19</a> </span><div align=left><br>
Так,<br><b>&quot;Скрипт очистил секцию адресации IAT по адресу 6E1000, он определил начало таблицы как 6E1220, конец таблицы как 6E1D04. </b><br>Значит асм-вставка по очистке и определению IAT отработала. Дальше по идее идёт сам двиг от PE_kill.<br><br>Симптомы сильно напоминают наличие антивира или фаера. Посмотри что там у тебя стоит, поотключай. Если же стоит Касперский то ваще нужно удалить его драйвер из папки, чтоб при запуске он его не находил и не мог запуститься.В этом топике об этом уже есть полистай назад и внимательно почитай, а ещё лучше сделай как я качни его, чтоб можно и без нета было читать.<br>Попробуй пока это если не поможет, то подумаем дальше. Основной двиг работает 3-4 минуты.<br><br><b>Наверно build другой</b> ну ты же тоже на 3.0 пробуешь пока попробуй первое может это не понадобится. Хотя жалко нету, как говорится.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147897&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=19" class="addthx" data-post="147897"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2007 12:59 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#20');return false;">#20</a> </span><div align=left><br>
<I>Small_S пишет:<br>Симптомы сильно напоминают наличие антивира или фаера. </I><br>Отрубил всё (AVG, Outpost, DrWeb, Alcohol)<br>изменилась только &quot;База, блока виртуальной памяти&quot;<br><br><I>Small_S пишет:<br>ну ты же тоже на 3.0 пробуешь </I><br>У меня 2 3.0 (2005-Jun-20 &amp; 2005-Jun-25) и оба, похоже, не те<br><br>Script должен в 6E2021-6E2029 цикле крутиться или это уже глюк?<br>Начинает искать с адреса 7B2000, но там же ничего нет
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=147927&amp;user=6946&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=20" class="addthx" data-post="147927"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2007 14:31 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#21');return false;">#21</a> </span><div align=left><br>
<b>Script должен в 6E2021-6E2029 цикле крутиться или это уже глюк?</b> однозначный глюк.<br><br>Предлагаю два решения(ибо подозреваю, что у тебя всё равно дрова с какого то антивира висят в памяти)<br><br>а) Попробуй запустить исходный скрипт от PE_kill-а для восстановления импорта(его можно отыскать в в его rar-статье по распаковке проги Фонтэксперт). Если исходный скрипт не пойдёт, то скорее висит дровина от антивира. Если пойдёт, то  уже я буду упорно морщить лоб, так как это будет касаться перехода с моей вставки (есть там одно подозрительное местечко когда вроде не откуда адресок нужный в стеке по определенному смещению висит и я этот недокументированный глюк системы использую) на двиг.<br><br>б) Есть у тебя чистая система под виртуалкой? Так вот поставь девственную систему под виртуалом и прогу, а затем погони  модернизированный скрипт. Будет медленно, но если после очитки он будет работать как надо, то это будет прямым указанием на висящие дрова.<br><br>Кстати как и чем отрубал AVG, Outpost, DrWeb???
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147940&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=21" class="addthx" data-post="147940"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2007 14:45 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#22');return false;">#22</a> </span><div align=left><br>
<I>Small_S пишет:<br>Кстати как и чем отрубал AVG, Outpost, DrWeb??? </I><br>Вырубил все связанные службы, и потом всё что через Autoruns нашёл галочки снял...<br>После перезагрузки в процессах тоже всё пропало... В принципе довольно чистенько выглядит <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=147942&amp;user=6946&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=22" class="addthx" data-post="147942"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2007 15:00 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#23');return false;">#23</a> </span><div align=left><br>
И всё равно очень настоятельно рекомендую зайти на стр 6 этого топика и найти спец утилиту- антируткит  Rootkit Unhooker 3.31.150.420. Там помоему осталась ссылка где скачать. И вообще почитай, я там довольно долго мучился. Каспер не удалялся(точнее его драйвер) даже прогами, которые контролируют авторан. И обязательно проверь под виртуалом модернизированный  и просто исходный вдруг ты нашёл баг перехода со вставки, все ж молчат, не испытывают модернизированный скрипт, а мне откуда знать у меня на трёх разных компах пашет и всё тип топ. На всякий случай дай билд твоего XP.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147947&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=23" class="addthx" data-post="147947"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2007 15:09 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#24');return false;">#24</a> </span><div align=left><br>
Rootkit Unhooker есть уже давно (кстати новый вышел 3.7.300.502)... Помучаю...<br>А &quot;чистая система под виртуалкой&quot; <img src="img/smilies/s1.gif" alt=""> Рад бы, да места на винте нет... А жаль...
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=147952&amp;user=6946&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=24" class="addthx" data-post="147952"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2007 22:36 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#25');return false;">#25</a> </span><div align=left><br>
<I>Small_S пишет:<br>На всякий случай дай билд твоего XP. </I><br>Версия ОС 5.1.2600 (WinXP Retail)<br><br>Короче вырубил всё (Outpost вырубить действительно сложно... Подмял под себя всю систему :s9<img src="img/smilies/s1.gif" alt="">, В Rootkit Unhooker (на вкладке хуки-Code Hooks Detektor) теперь вообще ничего не находит...<br>На всякий случай выкинул все плаги из Оли<br>Результат никакой... Script PE_Kill&#039;a тоже встаёт на тот-же цикл, но в теле проги (точнее в PE-Header&#039;e <img src="img/smilies/s14.gif" alt=""> 400E01-400E09)<br>Скрипту никаких дополнительный переменных не надо инициализировать?
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=148020&amp;user=6946&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=25" class="addthx" data-post="148020"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2007 23:02 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#26');return false;">#26</a> </span><div align=left><br>
<b>Isaev</b> на <b>Script PE_Kill&#039;a тоже встаёт на тот-же цикл, но в теле проги (точнее в PE-Header&#039;e  400E01-400E09)</b> скинь что там у тебя между 400E01-400E09, код я имею ввиду не ужели точь в точь как ты постил выше?<br><br>Исходный не должен так себя вести он у тысяч народу работает. Точно не забыл убрать бряк с доступа к секции кода?(ремове брэк мемори эссес).<br><br>Тебе бы чистую систему установить. Я ваще наученный горьким опытом хожу в нет, смотрю кино, играюсь в одной системе с каспером, а вот в оле работаю в чистейшей девственной системе.<br><br><b>Скрипту никаких дополнительный переменных не надо инициализировать?</b> нет там всё готово к работе и есть.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=148024&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=26" class="addthx" data-post="148024"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2007 23:56 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#27');return false;">#27</a> </span><div align=left><br>
<I>Small_S пишет:<br>не ужели точь в точь как ты постил выше? </I><br>Ага... точь-в-точь...<br>00400E01 41 INC ECX <br>00400E02 3BCA CMP ECX,EDX <br>00400E04 73 13 JNB SHORT icolover.00400E19 <br>00400E06 8039 E8 CMP BYTE PTR DS:[ECX],0E8 <br>00400E09 75 F6 JNZ SHORT icolover.00400E01<br><br><I>Small_S пишет:<br>Точно не забыл убрать бряк с доступа к секции кода? </I><br>Бл&#036;... Идиота кусок... Ну да, как всегда... Еб&amp; людям мозги <img src="img/smilies/s14.gif" alt=""><br>&quot;Скрипт закончил работу! Общее число восстановленных переходов = 73! Восстановлено 0 Call и 73 jmp переходов. После снятия дампа плагином OllyDump не забудьте в ImpRECt-е кроме адреса точки входа (в окне OEP) вбить в окно RVA начало IAT=<b>2E1220</b> и в окно Size - точный размер IAT=BEC(иначе может неверно определиться начало IAT).&quot;<br>Почему 2E1220, если сначала &quot;он определил начало таблицы как 6E1220&quot;?
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=148033&amp;user=6946&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=27" class="addthx" data-post="148033"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июля 2007 04:13 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#28');return false;">#28</a> </span><div align=left><br>
<b>Почему 2E1220, если сначала &quot;он определил начало таблицы как 6E1220&quot;?</b> потому что отнимается база 400000. Всё у тебя правильно и размер, и восстановлено, и адреса. Кстати билды систем у нас с тобой одинаковые тоже.<br><br>Рад за тебя.<img src="img/smilies/s1.gif" alt=""> Но для данной проги импорт- это только начало. Читай дальше Сержа. Что касается этого скрипта то он ещё кое что оставляет и это кое что буду доделывать чуть позжа.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=148045&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=28" class="addthx" data-post="148045"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2007 04:23 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#29');return false;">#29</a> </span><div align=left><br>
Привет всем! Вчера вечером вроде доделал в IAT_rec_modern1pSO.osc исправление обращений к функе GetProcAddress, ну и  возможно, обращений к любым функам вызываемым через командную область Аспра в выделенной памяти. На иконловере и актуалспа вроде работает, но ещё потестирую и вечером, если нормально выложу очередную модификацию.<br><br>Имеется вопрос: никто не знает, если одна и таже Апи прописана в таблице IAT по нескольку раз -это имеет какие нибудь негативные последствия для проги? Судя по вчерашним прогонам по актуалспа-нет. Прога пашет и в импректе никаких заморочек при восстановлении. А вот PE_kill в исходном скрипте на стадии восстановления вызовов ищет была в таблице уже данная функа или нет и если не была, то дописывает в конец. Это просто из эстетических побуждений и для экономии места сделано или есть более серьезные причины?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=149407&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=29" class="addthx" data-post="149407"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2007 21:06 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#30');return false;">#30</a> </span><div align=left><br>
Всем привет! Протестировал на 6-ти прогах под разными аспрами. Скрипт рубит, как и было раньше, на версиях 1.35-2-2.1 до 2.19, если стоишь на OEP и нет каких нить прибабахов. Как и писал вчера изменения коснулись автоматического восстановления GetProcAddress. Кроме того проводится ещё большая вторичная зачистка, если к примеру ссылка в секции таблицы IAT ведёт на нули или на непонятную пока мне конструкцию типа FEEEFEEEFEEEFEEE... Причем ODBGScript при поиске командой FIND находит данный участок шиворот навыворот из-за чего пришлось делать и так и так:<br><br>v1:<br>  mov prover,[edx]<br>  cmp [edx],0EEFEEEFE------------------так если у нас FEEEFEEE<br>  jne v2<br>  mov [ebx],0<br>v2:<br>  cmp [edx],0FEEEFEEE------------------так если EEFEEEFE<br>  jne v3<br>  mov [ebx],0<br><br>Я конечно не знаю, есть ли ещё функи кроме GetProcAddress, которые не определяются основным движком и спрятаны по такому же механизму, но думаю что наверное бывают, тогда эта доделка будет брать и их.<br>Например в Иконловере GetProcAddress спрятан так:<br><br>в окне дампа видим<br>006E144C_  7C812AC6  Ж*Ѓ|  kernel32.GetSystemInfo<br>006E1450_ 00000000  ....<br>006E1454_  00000000  ....<br>006E1458_  00C87290  ђrИ.===========================ВОТ ОНО<br>006E145C_  00000000  ....<br><br>а по этому адресу:<br>00C87290_________________ PUSH EBP<br>00C87291_________________ MOV EBP,ESP<br>00C87293_________________ MOV EDX,DWORD PTR SS:[EBP+C]<br>00C87296_________________ MOV EAX,DWORD PTR SS:[EBP+8]<br>00C87299_________________ CMP EAX,DWORD PTR DS:[C99458]<br>00C8729F_________________ JNZ SHORT 00C872AA<br>00C872A1_________________ MOV EAX,DWORD PTR DS:[EDX*4+C99458]<br>00C872A8_________________ JMP SHORT 00C872B1<br>00C872AA _________________ PUSH EDX<br>00C872AB_________________ PUSH EAX<br>00C872AC_________________ CALL 00C7577C          ; JMP to kernel32.GetProcAddress<br>00C872B1_________________ POP EBP<br>00C872B2_________________ RETN 8<br><br>после чего на келле<br>00C75774 _________________ JMP DWORD PTR DS:[C9C27C]                   ; kernel32.GetModuleHandleA<br>00C7577A _________________ MOV EAX,EAX<br>00C7577C _________________ JMP DWORD PTR DS:[C9C278]++++++++++ ; kernel32.GetProcAddress<br>00C75782 _________________ MOV EAX,EAX<br>00C75784 _________________ JMP DWORD PTR DS:[C9C274]                   ; kernel32.GetSystemInfo<br>00C7578A _________________ MOV EAX,EAX<br><br>ну а там у аспра своя IAT в окне дампа видим:<br>00C9C270  7C80176B  kЂ|  kernel32.GetSystemTime<br>00C9C274  7C812AC6  Ж*Ѓ|  kernel32.GetSystemInfo<br>00C9C278  7C80AC28  (¬Ђ|  kernel32.GetProcAddress++++++++++++++++++++++++++Вот оно<br>00C9C27C  7C80B529  )µЂ|  kernel32.GetModuleHandleA<br>00C9C280  7C80B357  WіЂ|  kernel32.GetModuleFileNameA<br><br>Вот по приведённому алгоритму и ищется, на этот раз с асмом сильно не стал морочить голову, всё в скрипте идёт, в основном.<br>В аттаче новая модефикация скрипта.<br><br><br><br><br><img src="img/attach.gif" alt=""> <a href="./files/f18a_31.07.2007_CRACKLAB.rU.tgz">f18a_31.07.2007_CRACKLAB.rU.tgz</a> - IAT_rec_modern1.1pSO.osc
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=149671&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=30" class="addthx" data-post="149671"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2007 22:14 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=7466&amp;page=9#31');return false;">#31</a> </span><div align=left><br>
Привет всем. Вот и опять я воткнулся и требуется помощь. По порядку.<br>Позавчера решил посмотреть почему модификация скрипта по импорту не и идёт на Аспр 2.3 и обнаружил, что там импорт и украденный, и исходный весь в выделенной памяти(таблица IAT).<br>НУ и решил из скрипта нарастить последнюю секцию на ту самую величину (C000h)  и переписать из выделенной памяти в тело проги, так сказать, а там уже заниматься по накатанной. Ну найти три величины в заголовке файла не составило труда(общий размер образа- вначале, размер секции и описание прав доступа там где секция последняя описывается). Ну думаю руками попробую в окне дампа вначале. Перезабил циферки сохранил бекап. Alt+M, а там то ничего не меняется. Так  вот и вопрос:<br><br>Как олю заставить воспринять новые значения размеров последней секции в уже загруженном образе, а не в мёртвом файле лежащем на диске?<br><br>Я попробовал в винхексе в исходном поменять(получается но это не выход ), во первых аспр такое движение потом палит, а во вторых мне надо из асм-кода или скриптового хода это делать в уже развернутом образе. <br>Наверняка одна или две апишки какие нибудь существуют, которые заставляют перезаписаться адресное пространство с учётом PE-заголовка, висящего образа, просто я пока не нарвался на эту информацию.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150360&amp;user=9147&amp;forum_n=3&amp;topic=7466&amp;page=9&amp;anchor=31" class="addthx" data-post="150360"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=8.html">&lt;&lt;</a> <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=0.html">1</a> ... <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=8.html">9</a> . <b>10</b> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=10.html">11</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=11.html">12</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=12.html">13</a> . <a href="action=vthread&amp;forum=3&amp;topic=7466&amp;page=10.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка AsProtect на примерах</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="3">
<input type="hidden" name="topic" value="7466">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=7466" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
