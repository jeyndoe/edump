<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Нужна помощь в борьбе с виром - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Вот вчем вопрос: пишу лечилку от вира. Но эта сволота убила нужные доки. Поэтому столкнулся с проблемою: 1) как вычислить size of image? 2) исходник какой нить проги на дельфе, которая работает с секциями? 3) как деасемблировать,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=39467'>hgdagon</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Нужна помощь в борьбе с виром</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=8928&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=8928&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]AnXIouS[/b]','')">AnXIouS</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 22.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.11'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11790">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 июня 2007 00:55 <br><script type="text/javascript">QU('AnXIouS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AnXIouS" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Вот вчем вопрос: пишу лечилку от вира. Но эта сволота убила нужные доки. Поэтому столкнулся с проблемою: 1) как вычислить size of image?<br>2) исходник какой нить проги на дельфе, которая работает с секциями?<br>3) как деасемблировать, тоесть E9E23CFBFF -&gt; JMP 0040FCEE?<br>Или пример проги на Дельфе, которая умеет все выше перечисленоё
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139247&amp;user=11790&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=1" class="addthx" data-post="139247"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 июня 2007 01:16 <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>AnXIouS пишет:<br>1) как вычислить size of image? </I><br>Поищи исходники SDTrestore, там был код, рассчитывающий GetTotalImageSize по секциям; он на С, но я не вижу причины, по которым тебе нужен имено дельфи-код. <br><I>AnXIouS пишет:<br>2) исходник какой нить проги на дельфе, которая работает с секциями </I><br>Если с С не cможешь перевести в Дельфи, то врядли стоит браться за работу с файлами РЕ-формата... <br><br><I>AnXIouS пишет:<br>3) как деасемблировать, тоесть E9E23CFBFF -&gt; JMP 0040FCEE? </I><br><br>Например:<br><br>00400000 JMP 00500000 (E9FBFF0F00)<br>E9 - JMP<br>FBFF0F00 это число 0x000FFFFB (задом наперед) 0x000FFFFB = 0x00500000 - 0x00400000 - 0x5 <br>(5 - длина команды, 5 байт)
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=139248&amp;user=2060&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=2" class="addthx" data-post="139248"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Shad0vv[/b]','')">Shad0vv</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 34.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.52'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3393">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 июня 2007 01:23 &middot; Поправил: Shad0vv <br><script type="text/javascript">QU('Shad0vv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Shad0vv" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Сдаётся мне цель как раз противоположная.<br>Но всё же.. Найди прогу от &quot;PE optimizer&quot; от  <b>Dr.Golova</b>, вместе с ней идут сорсы, там как раз всё описано.<br>На счет дизассемблирования, в сети есть описание систематизации команд, я например это всё отрыл в книге Юрова &quot;Assembler 2-е издание&quot;.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139249&amp;user=3393&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=3" class="addthx" data-post="139249"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Styx[/b]','')">Styx</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 103.1 (ветеран), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.07<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=12">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 июня 2007 08:49 <br><script type="text/javascript">QU('Styx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Styx" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>AnXIouS</b><br>На wasm есть дизассемблерный движок на асме
<br><br><font size="1"><i>-----<br>Crack your mind, save the planet</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=139270&amp;user=12&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=4" class="addthx" data-post="139270"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Guru_eXe[/b]','')">Guru_eXe</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4379.gif" alt=""><br><span class=txtSm>Ранг: 282.8 (наставник), 24thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.25'>Активность: 0.26<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4379">Участник</a><br><font color=blue>win32.org.ru</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 июня 2007 09:00 <br><script type="text/javascript">QU('Guru_eXe','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Guru_eXe" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Styx пишет:<br>На wasm есть дизассемблерный движок на асме </I><br>Читай выше - нужно на дельфи... Есть дизасм движек, мб он на васме, от рема, написан на дельфи.
<br><br><font size="1"><i>-----<br>may all your PUSHes be POPed!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=139271&amp;user=4379&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=5" class="addthx" data-post="139271"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Ratinsh[/b]','')">Ratinsh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 191.8 (ветеран), 46thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.54'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3333">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 июня 2007 14:19 <br><script type="text/javascript">QU('Ratinsh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ratinsh" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
дельфи тоже люблю, но для разнообразия <img src="img/smilies/s5.gif" alt=""><br>http_//bigspider.altervista.org/CodingTutes/spider10.zip<br>http_//bigspider.altervista.org/ToolsAndProgs/spider20.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139317&amp;user=3333&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=6" class="addthx" data-post="139317"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]AnXIouS[/b]','')">AnXIouS</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 22.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.11'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11790">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 июня 2007 18:22 <br><script type="text/javascript">QU('AnXIouS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AnXIouS" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Во первых сенкс. Во вторых: с++ знаю недостаточно  (опирался на инфу, вирусом снесённую) это 1; вирус неравнодушен к с++, а дельфи не трогает это 2; <br>люблю я дельфю...<br>С-шные исходняки всеравно пригодятся, так как для дельфи добра такой тематики мало.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139333&amp;user=11790&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=7" class="addthx" data-post="139333"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]WolfHunter[/b]','')">WolfHunter</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 22.2 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.05'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5300">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 июня 2007 01:07 <br><script type="text/javascript">QU('WolfHunter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=WolfHunter" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
&gt;вирус неравнодушен к с++, а дельфи не трогает это 2<br>кинь семпл виря что-ли, а то что-то интересно, как это он такой избирательный...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139378&amp;user=5300&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=8" class="addthx" data-post="139378"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]AnXIouS[/b]','')">AnXIouS</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 22.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.11'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11790">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 июня 2007 07:20 <br><script type="text/javascript">QU('AnXIouS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AnXIouS" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Скинь мне на е-мейл свой е-мейл, и я те пришлю его.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139387&amp;user=11790&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=9" class="addthx" data-post="139387"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]WolfHunter[/b]','')">WolfHunter</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 22.2 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.05'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5300">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 июня 2007 08:58 <br><script type="text/javascript">QU('WolfHunter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=WolfHunter" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
забавно, а мыло я откуда узнаю? =)<br>check PM.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139397&amp;user=5300&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=10" class="addthx" data-post="139397"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]AnXIouS[/b]','')">AnXIouS</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 22.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.11'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11790">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 июня 2007 19:11 <br><script type="text/javascript">QU('AnXIouS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AnXIouS" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Ноччу будет. Бо инет через мабилу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139511&amp;user=11790&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=11" class="addthx" data-post="139511"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]AnXIouS[/b]','')">AnXIouS</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 22.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.11'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11790">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2007 00:14 <br><script type="text/javascript">QU('AnXIouS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AnXIouS" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
WolfHunter, уже отправил.<br>Я сегодня с ним немного разобрался: зовут его win32.expiro.c, выловил Нодом, но с лечением проблема.<br>По личной статистике добавлю: не трогает некоторые протекторы и пакеры, а также продукты Борландов. И файлы убил скорей всего не он.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139555&amp;user=11790&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=12" class="addthx" data-post="139555"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]GPcH[/b]','')">GPcH</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3.gif" alt=""><br><span class=txtSm>Ранг: 631.1 (<b>!</b>), 62thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.37<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3">Участник</a><br><font color=blue>Автор VB Decompiler</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2007 01:25 <br><script type="text/javascript">QU('GPcH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GPcH" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>AnXIouS</b><br><br>ImageSize = ImageBase + LastSectionRVA + LastSectionSize
<br><br><font size="1"><i>-----<br>Никогда не делай то, что возможно. Стремись сделать то что невозможно впринципе!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=139558&amp;user=3&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=13" class="addthx" data-post="139558"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]AnXIouS[/b]','')">AnXIouS</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 22.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.11'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11790">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2007 01:34 <br><script type="text/javascript">QU('AnXIouS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AnXIouS" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
GPсH, вот это конкретно, сенкс.<br>Осталось только научится удалять секции, и УнВир будет готов. :-D
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139561&amp;user=11790&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=14" class="addthx" data-post="139561"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ganjman[/b]','')">ganjman</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 14.1 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.26'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=4332">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2007 07:35 <br><script type="text/javascript">QU('ganjman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ganjman" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>GPcH пишет:<br>ImageSize = ImageBase + LastSectionRVA + LastSectionSize </I><br><br>ImageBase то, зачем?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139579&amp;user=4332&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=15" class="addthx" data-post="139579"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2007 10:48 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>ganjman пишет:<br>ImageBase то, зачем? </I><br><br><br>кстати да, база не нужна, да и размер (если считать таким образом) может получиться не точный...<br>лучше всего пройтись по секциям и суммировать их размер, делая поправку на выравнивание! <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=139634&amp;user=72&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=16" class="addthx" data-post="139634"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]asd[/b]','')">asd</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 162.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.58'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3241">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2007 11:03 <br><script type="text/javascript">QU('asd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=asd" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>Hellspawn</b><br>Это зачем? Не могу представить себе такую ситуацию. Или ты про то, что последня секция в списке может оказаться не последней по размещению в памяти?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139639&amp;user=3241&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=17" class="addthx" data-post="139639"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2007 11:04 <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
#define ibaseDD *(PULONG)&amp;ibase<br><br>BOOL GetHeaders(PCHAR ibase,  PIMAGE_FILE_HEADER	*pfh,  PIMAGE_OPTIONAL_HEADER *poh, PIMAGE_SECTION_HEADER *psh)<br>{<br>    PIMAGE_DOS_HEADER mzhead=(PIMAGE_DOS_HEADER)ibase;<br>    <br>    if((mzhead-&gt;e_magic!=IMAGE_DOS_SIGNATURE) || (ibaseDD[mzhead-&gt;e_lfanew]!=IMAGE_NT_SIGNATURE))<br>        return FALSE;<br>    <br>    *pfh=(PIMAGE_FILE_HEADER)&amp;ibase[mzhead-&gt;e_lfanew];<br>    if (((PIMAGE_NT_HEADERS)*pfh)-&gt;Signature!=IMAGE_NT_SIGNATURE) <br>        return FALSE;<br><br>    *pfh=(PIMAGE_FILE_HEADER)((PCHAR)*pfh+sizeof(IMAGE_NT_SIGNATURE));<br>    <br>    *poh=(PIMAGE_OPTIONAL_HEADER)((PCHAR)*pfh+sizeof(IMAGE_FILE_HEADER));<br>    if ((*poh)-&gt;Magic!=IMAGE_NT_OPTIONAL_HDR32_MAGIC)<br>        return FALSE;<br>    <br>    *psh=(PIMAGE_SECTION_HEADER)((PCHAR)*poh+sizeof(IMAGE_OPTIONAL_HEADER) );<br>    return TRUE;<br>}<br><br>int GetTotalImageSize(PIMAGE_DOS_HEADER pdh,  PIMAGE_FILE_HEADER pfh,  PIMAGE_OPTIONAL_HEADER poh,  PIMAGE_SECTION_HEADER psh)<br>{<br>	int Size=0;<br>	int Alignment = poh-&gt;SectionAlignment;<br><br>	if(poh-&gt;SizeOfHeaders % Alignment == 0)<br>	{<br>		Size += poh-&gt;SizeOfHeaders;<br>	} else<br>	{<br>		int Mul = poh-&gt;SizeOfHeaders / Alignment;<br>		Mul++;<br>		Size += (Mul*Alignment);<br>	}<br>	<br>	unsigned int i;<br>	for(i=0; i &lt; pfh-&gt;NumberOfSections; i++)<br>	{<br>		if(psh[i].Misc.VirtualSize)<br>		{<br>			if(psh[i].Misc.VirtualSize % Alignment == 0)<br>			{<br>				Size+= psh[i].Misc.VirtualSize;<br>			} else<br>			{<br>				int Mul = psh[i].Misc.VirtualSize / Alignment;<br>				Mul++;<br>				Size += (Mul*Alignment);<br>			}<br>		}<br>	}<br>	return Size;<br>}<br><br>Похожий код используется в SDTrestore.
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=139641&amp;user=2060&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=18" class="addthx" data-post="139641"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2007 11:09 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>asd пишет:<br>Это зачем? Не могу представить себе такую ситуацию. Или ты про то, что последня секция в списке может оказаться не последней по размещению в памяти? </I><br><br>много чего может быть, поверь мне на слово...<br><br><b>Error_Log</b> - вот корректный код, могу на дельфи для кучи кинуть <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=139642&amp;user=72&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=19" class="addthx" data-post="139642"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]asd[/b]','')">asd</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 162.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.58'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3241">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2007 11:41 <br><script type="text/javascript">QU('asd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=asd" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>Hellspawn</b><br>Неа, не поверю. За 2 года ниразу не натыкался на файл, для которого это не работало бы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139647&amp;user=3241&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=20" class="addthx" data-post="139647"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]asd[/b]','')">asd</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 162.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.58'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3241">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2007 12:19 <br><script type="text/javascript">QU('asd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=asd" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>Error_Log</b><br><i class=x>*psh=(PIMAGE_SECTION_HEADER)((PCHAR)*poh+sizeof(IMAGE_OPTIONAL_HEADER)  );<br></i><br>Так делать не стоит. Заголовки секций не обязательно идут следом за OptionalHeader.(пример - файлы пакованые винупаком 0.39, и ещё где-то видел.)<br>начало таблица секций = адрес начала  OptionalHeader + поле SizeOfOptionalHeader которое лежит в FileHeader<br><br><i class=x>if(psh[i].Misc.VirtualSize % Alignment == 0) <br>{ <br>Size+= psh[i].Misc.VirtualSize; <br>} else <br>{ <br>int Mul = psh[i].Misc.VirtualSize / Alignment; <br>Mul++; <br>Size += (Mul*Alignment); <br>}</i><br>тут другая проблема - если поле VirtualSize = 0, то следует брать поле SizeOfRawData и ровнять его по SectionAlignment. Могу выложить такой файлик.<br><br>И ещё я сам не пробовал, но такое вроде возможно сделать, хотя и изврат. Если между секциями дырки будут - то твой алгоритм тоже не сработает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139655&amp;user=3241&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=21" class="addthx" data-post="139655"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2007 14:09 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>asd</b><br><br>у меня есть парочка, только щас найти не могу (какие-то скремблеры были, это типо защита от<br>дампа была) <img src="img/smilies/s4.gif" alt=""> так как пока не занимаюсь анализатором...<br><br>з.ы. так что с сабжем? написал ТС антивиря? <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=139682&amp;user=72&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=22" class="addthx" data-post="139682"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]WolfHunter[/b]','')">WolfHunter</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 22.2 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.05'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5300">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2007 15:30 <br><script type="text/javascript">QU('WolfHunter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=WolfHunter" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
&gt;И ещё я сам не пробовал, но такое вроде возможно сделать, хотя и изврат. <br>&gt;Если между секциями дырки будут - то твой алгоритм тоже не сработает.<br>а я вот попробовал. масм32 + ручки. результат в аттаче.<br><br>01.exe - дыра между хидером и 1-й секцией.<br>02.exe - 01.exe, только SizeOfHeaders изменен так чтоб после выравнивания не было дыры.<br>03.exe - дыра между 1-й и 2-й секциями.<br><br>на Вин2k запускается только 02.exe.<br><br>&gt;з.ы. так что с сабжем? написал ТС антивиря?<br>what is &quot;ТС&quot;?<br><br><img src="img/attach.gif" alt=""> <a href="./files/0cb6_04.06.2007_CRACKLAB.rU.tgz">0cb6_04.06.2007_CRACKLAB.rU.tgz</a> - 1.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139707&amp;user=5300&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=23" class="addthx" data-post="139707"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]WolfHunter[/b]','')">WolfHunter</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 22.2 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.05'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5300">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2007 15:36 <br><script type="text/javascript">QU('WolfHunter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=WolfHunter" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
ЗЫ лечилка для сабжа пишется за пол часа, или час максимум(это если с ПЕ умно работать).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139709&amp;user=5300&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=24" class="addthx" data-post="139709"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]censor[/b]','')">censor</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.2 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.35'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3991">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июня 2007 16:37 <br><script type="text/javascript">QU('censor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=censor" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>WolfHunter пишет:<br>what is &quot;ТС&quot;? </I><br>AFAIK, Topic Starter
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139723&amp;user=3991&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=25" class="addthx" data-post="139723"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]AnXIouS[/b]','')">AnXIouS</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 22.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.11'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11790">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июня 2007 00:52 <br><script type="text/javascript">QU('AnXIouS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AnXIouS" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
Написал, но только на половину: никак с секциями не могу разобратся, чото не прёт удаление.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139795&amp;user=11790&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=26" class="addthx" data-post="139795"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июня 2007 14:33 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<I>AnXIouS пишет:<br>Написал, но только на половину: никак с секциями не могу разобратся, чото не прёт удаление. </I><br><br>уменьшаешь кол-во секицй в заголовке на 1, трёшь заголовок секции (40 байт), пересчитываешь<br>sizeofimage, и сохраняешь всё это дело в новый файл, но без посл, секции...  <img src="img/smilies/s1.gif" alt=""> наверное как-то так...
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=139892&amp;user=72&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=27" class="addthx" data-post="139892"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]asd[/b]','')">asd</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 162.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.58'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3241">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июня 2007 15:13 <br><script type="text/javascript">QU('asd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=asd" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
или лучьше просто OEP найди и поставь в заголовок, если конечно вир что-нибудь наподобии UEP не использует - тогда ищи переход на вирус и анализируй, как он старые байты востанавливает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139898&amp;user=3241&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=28" class="addthx" data-post="139898"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]AnXIouS[/b]','')">AnXIouS</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 22.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.11'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11790">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июня 2007 00:16 <br><script type="text/javascript">QU('AnXIouS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AnXIouS" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
С удалением секций более-менее разобрался, завтра должен дописать. Но ещо несколько вопросов: чо за фрукт - боундимпорт; и какой использовать вид доступа к файлу, какой лучше - паскалевский, маппинга или файлстрин.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139983&amp;user=11790&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=29" class="addthx" data-post="139983"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]asd[/b]','')">asd</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 162.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.58'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3241">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 июня 2007 05:15 <br><script type="text/javascript">QU('asd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=asd" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8928&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<I>AnXIouS пишет:<br>боундимпорт </I> <br>Это один из видов импорта. Почитать можно, к примеру в одной из статей(2 вроде) из цикла &quot;От зелёного к красному&quot; - есть на васме. Лучше не мучайчся, а просто сотри указатель на него.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=139995&amp;user=3241&amp;forum_n=6&amp;topic=8928&amp;page=0&amp;anchor=30" class="addthx" data-post="139995"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=8928&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=8928&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Нужна помощь в борьбе с виром</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=8928" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
