<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Запуск файла из памяти - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем привет! Изучаю статью &quot;Запуск файла из памяти&quot; с ресурса WASM. Столкнулся с проблемой. не могу понять почему в одном случае файл запускается а в другом нет. Все вроде работатет отлично, но если я в исходник добаляю">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Запуск файла из памяти</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]just76[/b]','')">just76</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.92'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37860">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 августа 2014 10:03 &middot; Поправил: just76 <br><script type="text/javascript">QU('just76','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=just76" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23010.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Всем привет!<br>Изучаю статью &quot;Запуск файла из памяти&quot; с ресурса WASM. Столкнулся с проблемой. не могу понять почему в одном случае файл запускается а в другом нет. Все вроде работатет отлично, но если я в исходник добаляю функцию - &quot;invoke MessageBox, 0, 0, 0 ,0&quot; то файл не запускается.<br>Прилагаю исходник + файл для заупуска ( MessageBox обычный ) + пример в котором не хочет запускатся файл. Почему так происходит? Помогите пожалуйста разобратся.<br><br><img src="img/attach.gif" alt=""> <a href="./files/c658_09.08.2014_EXELAB.rU.tgz">c658_09.08.2014_EXELAB.rU.tgz</a> - fasm_run.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345318&amp;user=37860&amp;forum_n=6&amp;topic=23010.html&amp;page=0&amp;anchor=1" class="addthx" data-post="345318"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 августа 2014 11:26 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23010.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;</li><li class="hl_l1">MSG<span class="hl_char">.</span>EXE<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;<span class="hl_char">.</span><span class="hl_number">01001000</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">6A00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">&nbsp;<span class="hl_char">.</span><span class="hl_number">01001002</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">6800300001</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;<span class="hl_number">001003000</span>&nbsp;</li><li class="hl_l1">&nbsp;<span class="hl_char">.</span><span class="hl_number">01001007</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">6805300001</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;<span class="hl_number">001003005</span>&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_char">.</span><span class="hl_number">0100100C</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">6A00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">&nbsp;<span class="hl_char">.</span><span class="hl_number">0100100E</span><span class="hl_char">:</span>&nbsp;E813000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;MessageBoxA&nbsp;<span class="hl_comment">;user32.dll</span></li><li class="hl_l0">&nbsp;<span class="hl_char">.</span><span class="hl_number">01001013</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">6A00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;<span class="hl_number">000</span></li><li class="hl_l1">&nbsp;<span class="hl_char">.</span><span class="hl_number">01001015</span><span class="hl_char">:</span>&nbsp;E800000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_char">.</span><span class="hl_number">00100101A</span>&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_char">.</span><span class="hl_number">0100101A</span><span class="hl_char">:</span>&nbsp;FF2500204000&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;d<span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_number">000402000</span><span class="hl_char">]</span>&nbsp;&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;Что&nbsp;в&nbsp;том&nbsp;DWORD'e ?</li><li class="hl_l1">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br>Всё нормально запускаетс и с- и без MessageBox&#039;а в файле START.ASM.<br>Завершается в обоих случаях с GP#.<br>В листинге обозначил ошибку.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345320&amp;user=35473&amp;forum_n=6&amp;topic=23010.html&amp;page=0&amp;anchor=2" class="addthx" data-post="345320"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]just76[/b]','')">just76</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.92'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37860">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 августа 2014 12:00 <br><script type="text/javascript">QU('just76','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=just76" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23010.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Спасибо! )
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345321&amp;user=37860&amp;forum_n=6&amp;topic=23010.html&amp;page=0&amp;anchor=3" class="addthx" data-post="345321"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]just76[/b]','')">just76</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.92'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37860">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 августа 2014 12:22 <br><script type="text/javascript">QU('just76','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=just76" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23010.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
переделал пример на masm. прилагаю 2 бинарника, оба запускают файл ( простое окно ) из ресурсов. первый ( good.exe ) работает отлично, ко второму ( notgood.exe ) я добавил функцию MessageBox, и он перестал запускать файл ( простое окно ). в чем дело я понять не могу. не понимаю почему так происходит. кому не лень гляньте в ольке. в чем может быть дело. а то я всю голову сломал.<br>да, после проецирования файла, в ольке такая картина:<br><br>-----------------------------------------------------------------------------------------------<br>CPU Disasm<br>Address   Hex dump          Command                                  Comments<br>00401000    6A 00           PUSH 0<br>00401002    E8 95010000     CALL &lt;JMP.&amp;user32.MessageBoxA&gt;           ; Jump to KERNEL32.GetModuleHandleA<br>00401007    A3 18304000     MOV DWORD PTR DS:[403018],EAX<br>0040100C    E8 85010000     CALL &lt;JMP.&amp;kernel32.ExitProcess&gt;         ; Jump to KERNELBASE.GetCommandLineA<br>00401011    A3 1C304000     MOV DWORD PTR DS:[40301C],EAX<br>00401016    6A 0A           PUSH 0A<br>00401018    FF35 1C304000   PUSH DWORD PTR DS:[40301C]<br>0040101E    6A 00           PUSH 0<br>00401020    FF35 18304000   PUSH DWORD PTR DS:[403018]<br>00401026    E8 06000000     CALL 00401031<br>0040102B    50              PUSH EAX<br>0040102C    E8 5F010000     CALL &lt;JMP.ExitProcess&gt;                   ; Jump to KERNEL32.ExitProcess<br>-----------------------------------------------------------------------------------------------<br><br>00401002    E8 95010000     CALL &lt;JMP.&amp;user32.MessageBoxA&gt;           ; Jump to KERNEL32.GetModuleHandleA - почему так?<br>0040100C    E8 85010000     CALL &lt;JMP.&amp;kernel32.ExitProcess&gt;         ; Jump to KERNELBASE.GetCommandLineA - почему так?<br><br>спасибо за внимание, надеюсь на помощь в решении вопроса.<br><br>пароль к файлу: 123asd<br><br><img src="img/attach.gif" alt=""> <a href="./files/69c7_11.08.2014_EXELAB.rU.tgz">69c7_11.08.2014_EXELAB.rU.tgz</a> - example.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345367&amp;user=37860&amp;forum_n=6&amp;topic=23010.html&amp;page=0&amp;anchor=4" class="addthx" data-post="345367"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 августа 2014 12:24 &middot; Поправил: ajax <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23010.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
заипали. тем 20 уже с этим вопросом. вир/протмейкеры, идите в ...
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=345368&amp;user=8830&amp;forum_n=6&amp;topic=23010.html&amp;page=0&amp;anchor=5" class="addthx" data-post="345368"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]just76[/b]','')">just76</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.92'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37860">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 августа 2014 12:29 <br><script type="text/javascript">QU('just76','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=just76" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23010.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
я прошу помощи, в решении вопроса. ведь для этого и существует форум. разве я не прав? кому есть что посоветовать или помочь по решению вопроса, выскажите свои мысли пожалуйста. всю голову уже сломал.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345369&amp;user=37860&amp;forum_n=6&amp;topic=23010.html&amp;page=0&amp;anchor=6" class="addthx" data-post="345369"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 августа 2014 13:47 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23010.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>just76 пишет:<br>Jump to KERNEL32.GetModuleHandleA - почему так? </I><br><strike>По воле компилятора, а он исходя из опций так компилит</strike><br>не понял сразу всей проблемы, что-то с исходником не так...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=345382&amp;user=24257&amp;forum_n=6&amp;topic=23010.html&amp;page=0&amp;anchor=7" class="addthx" data-post="345382"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]just76[/b]','')">just76</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.92'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37860">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 августа 2014 13:58 <br><script type="text/javascript">QU('just76','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=just76" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23010.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
да нет. с исходником все нормально. это после проецирования файла и перехода на точку входа, получается такая история. и все падает на функции CreateWindowsEx. понять не могу почему так.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345383&amp;user=37860&amp;forum_n=6&amp;topic=23010.html&amp;page=0&amp;anchor=8" class="addthx" data-post="345383"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 августа 2014 14:16 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23010.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Не знаю, что у Вас, но у меня всё работает.<br>И, кстати, ничего похожего на листинг 5ю постами выше не нашёл ни в одном из exe, приложенных там же
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=345386&amp;user=24257&amp;forum_n=6&amp;topic=23010.html&amp;page=0&amp;anchor=9" class="addthx" data-post="345386"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]just76[/b]','')">just76</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.92'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37860">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 августа 2014 14:24 <br><script type="text/javascript">QU('just76','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=just76" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23010.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
хммм... на XP работает, а вот на 7 и 8 почему то нет ( у вас на какой ОС работает? ХП 7 8 ( x86, x64 )?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345388&amp;user=37860&amp;forum_n=6&amp;topic=23010.html&amp;page=0&amp;anchor=10" class="addthx" data-post="345388"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 августа 2014 14:35 <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23010.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
ASLR/релоки. ну, попробуйте погуглить хоть чуть
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=345390&amp;user=8830&amp;forum_n=6&amp;topic=23010.html&amp;page=0&amp;anchor=11" class="addthx" data-post="345390"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]just76[/b]','')">just76</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.92'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37860">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 августа 2014 14:42 <br><script type="text/javascript">QU('just76','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=just76" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23010.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
нет не в релоках дело. собрал с простым окном ( без релоков ) в ресурсах. все равно не хочет работать ((((<br><br><b>Добавлено спустя 1 минуту</b><br>именно в 7 8 не хочет (
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345392&amp;user=37860&amp;forum_n=6&amp;topic=23010.html&amp;page=0&amp;anchor=12" class="addthx" data-post="345392"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 августа 2014 17:16 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23010.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Loadlibrary/GetProcAddress нормально работают. Почему не пользуетесь?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345395&amp;user=35473&amp;forum_n=6&amp;topic=23010.html&amp;page=0&amp;anchor=13" class="addthx" data-post="345395"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]just76[/b]','')">just76</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.92'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37860">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 августа 2014 17:35 <br><script type="text/javascript">QU('just76','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=just76" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23010.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
такая реализация. они там ненужны.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345396&amp;user=37860&amp;forum_n=6&amp;topic=23010.html&amp;page=0&amp;anchor=14" class="addthx" data-post="345396"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 августа 2014 18:32 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23010.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Значит меняй реализацию, клади файл на диск и запускай по-человечески. Здесь не в почёте вся околовирусная/протекторная тематика. Тем более, что тема избита и изжёвана, и весь вопрос-взять и отладить свой кривокод.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345397&amp;user=1556&amp;forum_n=6&amp;topic=23010.html&amp;page=0&amp;anchor=15" class="addthx" data-post="345397"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Запуск файла из памяти</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23010" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
