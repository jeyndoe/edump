<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>запихнуть запись о dll в импорт проги - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="мне надо как-то запихнуть запись о длл в импорт проги. Нужно чтобы длл получила управление сразу после всех остальных длл, тоесть ее в конец нада добавить.... Чувствую нада писать перепаковщик, который будет добавлять эту сраную">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=39467'>hgdagon</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> запихнуть запись о dll в импорт проги</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]fix200[/b]','')">fix200</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 22.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.92'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5986">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 ноября 2006 14:24 <br><script type="text/javascript">QU('fix200','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=fix200" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
мне надо как-то запихнуть запись о длл в импорт проги. Нужно чтобы длл получила управление сразу после всех остальных длл, тоесть ее в конец нада добавить....<br>Чувствую нада писать перепаковщик, который будет добавлять эту сраную запись.<br>1) Есть какойнить путь проще?<br>2) какие особености при пересборке учитывать?  надо ли импортировать  хотя бы одну функцию, или достаточно просто имя длл  вписать в нужное место?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=103986&amp;user=5986&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=1" class="addthx" data-post="103986"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Rascal[/b]','')">Rascal</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/60.jpg" alt=""><br><span class=txtSm>Ранг: 260.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=60">Участник</a><br><font color=blue>John Smith</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 ноября 2006 14:42 &middot; Поправил: Rascal <br><script type="text/javascript">QU('Rascal','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rascal" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<a href="http://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6281&amp;page=0" target="_new">http://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6281&amp;page= 0</a><br>Там есть аттач мой. Добавление в импорт новой библиотеки. Работает только с асмовыми прогами. Влом было доделывать. Прога работала, тестил. Новая библа получала управление.<br>Перестраивать маловероятно что-нить заработает. Только новую секцию с импортом цеплять, это когда нулей не хватит для добавления новой библиотеки и функции.
<br><br><font size="1"><i>-----<br>Недостаточно только получить знания:надо найти им приложение</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=103988&amp;user=60&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=2" class="addthx" data-post="103988"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]__[/b]','')">__</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.1 (ветеран), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.73'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7172">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 ноября 2006 15:20 &middot; Поправил: __ <br><script type="text/javascript">QU('__','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=__" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>fix200 пишет:<br>мне надо как-то запихнуть запись о длл в импорт проги. </I><br><br>можно с помощью импрека, вручную подредактировав текстовый файл импорта который генерит импрек
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=103992&amp;user=7172&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=3" class="addthx" data-post="103992"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 ноября 2006 16:52 &middot; Поправил: s0larian <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>fix200</b>, так тебе надо изменить таблицу импорта. Беда только в том, что &quot;уедут&quot; offset-ы внутри файла. Я бы написал кусок кода который бы добавлял в конец файла секцию .newImport, перемащал туда то что лежит по указателю import directory и потом добавлял туда свою .dll и её функцию. Но, придётся писать код.<br><br>Попробуй сделать те же шаги но используя LordPE, imprec, pe explorer....
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=103996&amp;user=1737&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=4" class="addthx" data-post="103996"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]n1kto[/b]','')">n1kto</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 54.0 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.26'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4343">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 ноября 2006 02:01 <br><script type="text/javascript">QU('n1kto','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=n1kto" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>fix200 пишет:<br>мне надо как-то запихнуть запись о длл в импорт проги. Нужно чтобы длл получила управление сразу после всех остальных длл, тоесть ее в конец нада добавить....  </I><br>IID King поможет отцу русской демократии<br>искать на wasm.ru
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=104037&amp;user=4343&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=5" class="addthx" data-post="104037"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 ноября 2006 02:14 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Можно минизагрузчик на EntryPoint засандалить.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=104040&amp;user=3232&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=6" class="addthx" data-post="104040"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]MoonShiner[/b]','')">MoonShiner</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 186.8 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 ноября 2006 03:26 <br><script type="text/javascript">QU('MoonShiner','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MoonShiner" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
1) Создаешь новую секцию, забитую нулями;<br>2) в начало секции копируешь все Import Directory Table (их размер и количество определяется легко);<br>3) дописываешь к перенесенным свою Import Directory Table, остальное оставляешь забитым нулями;<br>4) в ПЕ-хидере меняешь указатель на виртуальный адрес твоей новой секции.<br><br>Это все. В своей Import Directory Table проставишь ссылки на имя либы, табличку адресов на имена и на табличку адресов импорта из этой либы. Все эти указатели пусть кажут в твою же секцию. Думаю - это все.<br><br>ЗЫ Новую секцию желательно создавать, поскольку в старой может не быть места для добавления.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=104046&amp;user=2&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=7" class="addthx" data-post="104046"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]__[/b]','')">__</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.1 (ветеран), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.73'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7172">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 ноября 2006 03:46 &middot; Поправил: __ <br><script type="text/javascript">QU('__','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=__" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>MoonShiner</b><br>это все делает импрек автоматом<br><br>сохраняем импорт в .txt<br><br>FThunk: 0000303C	NbFunc: 00000003<br>1	0000303C	kernel32.dll	00B7	ExitProcess<br>1	00003040	kernel32.dll	013C	GetCurrentProcess<br>1	00003044	kernel32.dll	002E	CheckRemoteDebuggerPresent<br><br>FThunk: 0000304C	NbFunc: 00000002<br>1	0000304C	user32.dll	01DD	MessageBoxA<br>1	00003050	user32.dll	02D9	wsprintfA<br><br>добавляем нужные функции<br><br>FThunk: 0000303C	NbFunc: 00000003<br>1	0000303C	kernel32.dll	00B7	ExitProcess<br>1	00003040	kernel32.dll	013C	GetCurrentProcess<br>1	00003044	kernel32.dll	002E	CheckRemoteDebuggerPresent<br><br>FThunk: 0000304C	NbFunc: 00000002<br>1	0000304C	user32.dll	01DD	MessageBoxA<br>1	00003050	user32.dll	02D9	wsprintfA<br><br>FThunk: 00003058	NbFunc: 00000002<br>1	00003058	kernel32.dll	0242	LoadLibraryA<br>1	0000305C	kernel32.dll	0198	GetProcAddress<br><br>загружаем обратно
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=104055&amp;user=7172&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=8" class="addthx" data-post="104055"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]MoonShiner[/b]','')">MoonShiner</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 186.8 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 ноября 2006 05:53 <br><script type="text/javascript">QU('MoonShiner','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MoonShiner" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>__</b>, а если необходимо сделать для большого количества файлов на автомате? Будешь писать скрипт и прогу, которая будет запускать импрек, получать через него импорт, править его и нажимать в импреке кнопочку, чтобы сохранить его? Я просто описал алго, по которому можно написать соответствующую тулзу.<br><br>ЗЫ А если у тебя есть ехе-шник, но нет специфических библиотек, которые он использует? Ты не сможешь его запустить, чтобы в дальнейшем натравить на него импрек...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=104090&amp;user=2&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=9" class="addthx" data-post="104090"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]fix200[/b]','')">fix200</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 22.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.92'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5986">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2006 06:09 <br><script type="text/javascript">QU('fix200','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=fix200" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
спасибо всем<br><br>ИмпРеком получилось. <br><br>Прога Rascal&#039;a вылетает при загрузке  в функции CImportEditor::FindImportSection на 3 строке mov ax, [ebx + 0x06]. Не разобрался почему.<br><br>Вручную не получается что-то. Я добавил новую секцию размером 1000h, в хедер и физически. Посмотрел в хедере  указатель на таблицу импорта, скопировал ее в новую секцию. Странно, но размер там стоял 64h, хотя там явно больше. Поправил указатель на последнюю секцию на начало моего импорта. Туда же влепил 1 мою функцию и имя DLL.  Прога грузится.  Но об моей длл ни слуху не духу. В списках импорта ее тоже не видно ((  тоже незнаю почему, чтото неверно сделал. <br><br>PE_Kill, загрузчик можно. А если GetProcAddress нету в импорте?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=104261&amp;user=5986&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=10" class="addthx" data-post="104261"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]asd[/b]','')">asd</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 162.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.58'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3241">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2006 06:28 <br><script type="text/javascript">QU('asd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=asd" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>fix200 пишет:<br>Странно, но размер там стоял 64h </I><br>Чтож странного - значит в импорте 4 библиотеки<br><br><I>fix200 пишет:<br>Туда же влепил 1 мою функцию и имя DLL </I><br>А добавил свою Import Directory Table.<br><br><I>fix200 пишет:<br>А если GetProcAddress нету в импорте? </I><br>Найти ручками в кернеле.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=104263&amp;user=3241&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=11" class="addthx" data-post="104263"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Rascal[/b]','')">Rascal</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/60.jpg" alt=""><br><span class=txtSm>Ранг: 260.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=60">Участник</a><br><font color=blue>John Smith</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2006 07:59 <br><script type="text/javascript">QU('Rascal','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rascal" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>fix200 пишет:<br>Прога Rascal&#039;a вылетает при загрузке в функции CImportEditor::FindImportSection на 3 строке mov ax, [ebx + 0x06]. Не разобрался почему.</I><br>Хехе, плохо смотрел. Там чётко задано имя файла - calc.exe Нужно переименовать асмовую прогу в calc.exe, кинуть в папку с прогой и запустить.
<br><br><font size="1"><i>-----<br>Недостаточно только получить знания:надо найти им приложение</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=104273&amp;user=60&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=12" class="addthx" data-post="104273"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2007 15:13 &middot; Поправил: 0xy <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
А как автоматом добавить dll в импорт, НЕ СОЗДАВАЯ НОВОЙ СЕКЦИИ ? (нулей вроде хватает)<br><br>В PeTools почему-то добавление недоступно, а LordPE создает новую секцию <img src="img/smilies/s14.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=113998&amp;user=3910&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=13" class="addthx" data-post="113998"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]lord_Phoenix[/b]','')">lord_Phoenix</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1858.gif" alt=""><br><span class=txtSm>Ранг: 353.0 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.14'>Активность: 0.37<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1858">Участник</a><br><font color=blue>resreveR</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2007 22:30 <br><script type="text/javascript">QU('lord_Phoenix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=lord_Phoenix" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
ручками добавляй ;) если не знаешь как - поищи в паках т53, там было именно то, что тебе надо
<br><br><font size="1"><i>-----<br>Тут не могла быть ваша реклама</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=114027&amp;user=1858&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=14" class="addthx" data-post="114027"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2007 23:08 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>lord_Phoenix пишет:<br>поищи в паках т53 </I><br>Это где? <img src="img/smilies/s14.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=114035&amp;user=3910&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=15" class="addthx" data-post="114035"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]RUffex[/b]','')">RUffex</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5845">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2007 23:43 &middot; Поправил: RUffex <br><script type="text/javascript">QU('RUffex','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=RUffex" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=6800.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>0xy пишет:<br>Это где?  </I><br><a href="http://www.exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3530" target="_blank">http://www.exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3530</a> <br>а поточнее:<br><a href="http://lord-phoenix.com/t53/" target="_new">http://lord-phoenix.com/t53/</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=114042&amp;user=5845&amp;forum_n=6&amp;topic=6800.html&amp;page=0&amp;anchor=16" class="addthx" data-post="114042"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> запихнуть запись о dll в импорт проги</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#17" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="6800">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=6800" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
