<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите распаковать новый uTorrent 2.2 RC2 - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="download.utorrent.com/2.2/utorrent.exe Раньше просто upx-ом распаковывалось, сейчас не хочет. Файл после упаковки модифицировался, как минимум добавлена еще одна секция. Попробовал Quick Unpack и разные RL!deUPX - ничего не">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите распаковать новый uTorrent 2.2 RC2</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=16874&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=16874&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]StUser[/b]','')">StUser</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.72'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26704">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2010 13:01 <br><script type="text/javascript">QU('StUser','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StUser" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
download.utorrent.com/2.2/utorrent.exe<br>Раньше просто upx-ом распаковывалось, сейчас не хочет. Файл после упаковки модифицировался, как минимум добавлена еще одна секция. Попробовал  Quick Unpack и разные RL!deUPX - ничего не выходит.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268154&amp;user=26704&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=1" class="addthx" data-post="268154"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2010 14:19 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Вручную распаковывается за 5 сек как обычный upx, только перед дампом всем секциям нужно установить Full Access<br>OEP - 0048BD64<br>IAT START - 0048CFFC<br>IAT SIZE - 000008A8
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268155&amp;user=5291&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=2" class="addthx" data-post="268155"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]StUser[/b]','')">StUser</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.72'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26704">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2010 15:37 <br><script type="text/javascript">QU('StUser','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StUser" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Как вручную? По тем мануалам что нашел  в инете и тут на сайте ничего не выходит. Загружаю exe в OllyDbg, ищу по Ctrl-F popap, нахожу какой-то по адресу 004db8c7, после которого идет jmp. Ставлю на него брекпоинт, F9 - вываливается Access violation где-то в ntdll, потом Shift-F9  и Debbuged program was unable to process exeption. <img src="img/smilies/s9.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268160&amp;user=26704&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=3" class="addthx" data-post="268160"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]gena-m[/b]','')">gena-m</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 87.8 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.83'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18095">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2010 15:50 &middot; Поправил: gena-m <br><script type="text/javascript">QU('gena-m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=gena-m" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>Как вручную?</b><br>1. Ставишь <b>железный</b> бряк в Олли  на адрес ОЕП который дал <b>Vovan666</b> и делаешь дамп с помощью PETools.<br>2. Прикручиваешь импорт  по данным который дал <b>Vovan666</b> с помощью ImpREC.<br>3. Можешь при желании разобраться с секцией ресурсов, а затем прикрутить импорт.<br>4. Говоришь спасибо <b>Vovan666</b> за предоставленную информацию.<br><br><b>ищу по Ctrl-F popap</b> ???????????<br> нужно искать <b>POPAD</b>, нужный тебе находится здесь:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004FF2BB</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">61</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">POPAD</span></li><li class="hl_l1"><span class="hl_number">004FF2BC</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8D4424</span>&nbsp;<span class="hl_number">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">-</span><span class="hl_number">80</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">004FF2C0</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">&gt;</span>&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_number">004FF2C2</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">39C4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">004FF2C4</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>^&nbsp;<span class="hl_number">75</span>&nbsp;FA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JNZ</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;utorrent<span class="hl_char">.</span><span class="hl_number">004FF2C0</span></li><li class="hl_l1"><span class="hl_number">004FF2C6</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">83EC</span>&nbsp;<span class="hl_number">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>SUB</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_char">-</span><span class="hl_number">80</span></li><li class="hl_l0"><span class="hl_number">004FF2C9</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_char">-</span>&nbsp;E9&nbsp;<span class="hl_number">96CAF8FF</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;utorrent<span class="hl_char">.</span><span class="hl_number">0048BD64</span></li>        </ol>
    </div>
</div></div>
<br><br>а  JMP utorrent.0048BD64 ведет на ОЕП
<br><br><font size="1"><i>-----<br>Надежда - есть худшее из зол, ибо она продлевает наши страдания.© Ф. Ницше</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=268161&amp;user=18095&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=4" class="addthx" data-post="268161"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]StUser[/b]','')">StUser</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.72'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26704">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2010 16:19 <br><script type="text/javascript">QU('StUser','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StUser" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>gena-m</b><br>Железные брекпоинт на тот OEP срабатывает, но нак найти его? Не буду же я для каждой версии uTorrent-a тут OEP и остальные данные спрашивать? Как найти тот popad правильный? Если там делов на 5 секунд, можно хотя бы коротенькую инструкцию и какие инструменты использовать? У меня упорно отладка валится при брекпоинте на тот popad с jmp-ом,  какой бы брекпоинт я не ставил - обычный или железный.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268163&amp;user=26704&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=5" class="addthx" data-post="268163"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]StUser[/b]','')">StUser</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.72'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26704">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2010 16:22 &middot; Поправил: StUser <br><script type="text/javascript">QU('StUser','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StUser" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>нужно искать POPAD, нужный тебе находится здесь:</b><br>Спасибо. Блин, во всех инструкциях jmp идет сразу после popad.<br><br>И что-то в  ImpREC я ни IAT START ни IAT SIZE не нахожу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268164&amp;user=26704&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=6" class="addthx" data-post="268164"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2010 16:29 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
К чему все эти pushad\popad тупо прокручиваешь весь код вниз до нулей, последний jmp=jmp(oep)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268165&amp;user=5291&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=7" class="addthx" data-post="268165"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]gena-m[/b]','')">gena-m</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 87.8 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.83'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18095">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2010 16:39 <br><script type="text/javascript">QU('gena-m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=gena-m" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>можно хотя бы коротенькую инструкцию</b><br><br>Коротенькая инструкция:<br><br>стоим на ЕП и видим 004FE710    PUSHAD, приходит мысль что неплохо было бы нажать 1 раз F8.<br>Обнаруживаем что в стеке, при выполнении команды PUSHAD сохранились все регистры.<br>Набираем в окне дампа (Ctrl+G) адрес указателя вершины стека 30ffa4 и нажимаем ОК.<br>Видим в окне дампа такое:<br><br>0030FFA4  <b>38 07 91 7C</b> FF FF FF FF F0 FF 30 00 C4 FF 30 00  8‘|яяяяря0.Дя0.<br>0030FFB4  00 C0 FD 7F 94 EB 90 7C B0 FF 30 00 00 00 00 00  .Аэ”лђ|°я0.....<br><br>Левой клавишей мыша выбираем 38 07 91 7C и нажимаем правую клавишу мыша и в меню бряки выбираем железный на доступ. Нажимаем F9 и прерываемся в этом месте ниже POPAD:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004FF2BB</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">61</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">POPAD</span></li><li class="hl_l1"><span class="hl_number">004FF2BC</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8D4424</span>&nbsp;<span class="hl_number">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">-</span><span class="hl_number">80</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">004FF2C0</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">&gt;</span>&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_number">004FF2C2</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">39C4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">004FF2C4</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>^&nbsp;<span class="hl_number">75</span>&nbsp;FA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JNZ</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;utorrent<span class="hl_char">.</span><span class="hl_number">004FF2C0</span></li><li class="hl_l1"><span class="hl_number">004FF2C6</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">83EC</span>&nbsp;<span class="hl_number">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>SUB</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_char">-</span><span class="hl_number">80</span></li><li class="hl_l0"><span class="hl_number">004FF2C9</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_char">-</span>&nbsp;E9&nbsp;<span class="hl_number">96CAF8FF</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;utorrent<span class="hl_char">.</span><span class="hl_number">0048BD64</span></li>        </ol>
    </div>
</div></div>
<br><br>Дальше смотришь мой пост выше.<br><br><b> У меня упорно отладка валится при брекпоинте на тот popad с jmp-ом</b><br>1. Выбрось все плагины.<br>2. Скачай чистую Олии и работай с ней.<br>3. Используй только железные бряки, если простые не умеешь.
<br><br><font size="1"><i>-----<br>Надежда - есть худшее из зол, ибо она продлевает наши страдания.© Ф. Ницше</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=268166&amp;user=18095&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=8" class="addthx" data-post="268166"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]StUser[/b]','')">StUser</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.72'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26704">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2010 16:40 &middot; Поправил: StUser <br><script type="text/javascript">QU('StUser','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StUser" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>gena-m</b><br><b>Vovan666</b><br>Спасибо.  <br><br>То есть. Последовательность действий примерно такая:<br>1. Загружаю в OllyDbg v2.0 uTorrent.exe.<br>2. Пролистываю вниз до нулей.<br>3. Ставлю брекпоинт на последний JMP utorrent.0048BD64 (в данном случае)<br>4. F9, F8 - оказываюсь на OEP.<br>5. В View-&gt;Memory map на всех секциях с owher uTorrent делаю Set access -&gt; Full<br>6. Запускаю PETools, Dump Full на процессе uTorrent, сохраняю exe в файл.<br>7. Запускаю ImpREC и ...  <img src="img/smilies/s9.gif" alt=""><br>Вот тут затык. Не пойму куда тут вбивать эти IAT START ни IAT SIZE. Ни разу еще импорт не восстанавливал. И как определить эти IAT START ни IAT SIZE?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268167&amp;user=26704&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=9" class="addthx" data-post="268167"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]gena-m[/b]','')">gena-m</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 87.8 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.83'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18095">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2010 16:52 &middot; Поправил: gena-m <br><script type="text/javascript">QU('gena-m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=gena-m" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>И что-то в ImpREC я ни IAT START ни IAT SIZE не нахожу.</b> <br>Внизу слева есть три окошка <br>OEP - адрес ОЕП-400000 =8BD64<br>RVA - IAT START-400000= 8CFFC<br>Size - IAT SIZE= 8A8<br><br><b>И не забудь -  вверху есть окошко (Attach to an Active Process) и там выбери процесс с именем utorrent.</b><br><br><b>И как определить эти IAT START ни IAT SIZE?</b> Читай статьи по распаковке, а лучше <a href="http://www.exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14847" target="_blank">--&gt; это. &lt;--</a>
<br><br><font size="1"><i>-----<br>Надежда - есть худшее из зол, ибо она продлевает наши страдания.© Ф. Ницше</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=268169&amp;user=18095&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=10" class="addthx" data-post="268169"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]StUser[/b]','')">StUser</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.72'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26704">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2010 17:07 &middot; Поправил: StUser <br><script type="text/javascript">QU('StUser','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StUser" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>gena-m</b><br>Значит дальше так?<br>7. Запускаю ImpREC, выбираю процесс uTorrent  (он все еще висит остановленный в OlleDbg на OEP)<br>8. вбиваю в  ImpREC OEP=8BD64, RVA=8CFFC, Size=8A8<br>9. нажимаю GetImports - все dll-ки valid:YES<br>10. Жму Fix Dump, выбираю Dumped.exe, сохраненный из PETools, получаю Dumped_.exe<br>Что дальше? Полученый Dumped_.exe при запуске валится по адресу Offset: 0008bd98<br><br><br><i class=x>Добавленно.</i><br>Ага, кажется понял. Надо выставить соответствующие атрибыты секциям в exe. Пока тупо вбил в HIEW все единица в атрибуты всех секций. Вроде, работает, но думаю это не совсем правильно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268171&amp;user=26704&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=11" class="addthx" data-post="268171"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]verdizela[/b]','')">verdizela</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.0 (ветеран), 116thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4093">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2010 17:15 &middot; Поправил: verdizela <br><script type="text/javascript">QU('verdizela','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=verdizela" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>StUser</b><br>Если в олли стоиш на оеп, смотриш и запоминаеш(или копируеш адрес). Далее скопированный адрес оеп в олли - 400000 = что получилось вводиш в имреке в поле оеп, жмеш AutoSearch, далее жмеш GetImports, после этого FixDump и сохраняеш.<br>А вообще лучше бы почитал туторов по теме распаковки, их полно и есть подробное описание, как пользоваться ImpRec и т.д.
<br><br><font size="1"><i>-----<br>We do what we want because we can.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=268172&amp;user=4093&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=12" class="addthx" data-post="268172"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]StUser[/b]','')">StUser</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.72'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26704">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2010 17:29 <br><script type="text/javascript">QU('StUser','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StUser" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>Vovan666</b><br><b>gena-m</b><br><b>verdizela</b><br>Спасибо! Вроде, получилось. Не понятно, только одно. Ведь выставлял права на секции в OllyDbg, а в окончательном exe все-равно прав на какую-то секцию (вроде UPX1) не хватает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268173&amp;user=26704&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=13" class="addthx" data-post="268173"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]gena-m[/b]','')">gena-m</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 87.8 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.83'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18095">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2010 17:34 <br><script type="text/javascript">QU('gena-m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=gena-m" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Можно откорректировать и просмотреть права доступа к секциям в PETools, я обычно через него делаю а не в Олли.
<br><br><font size="1"><i>-----<br>Надежда - есть худшее из зол, ибо она продлевает наши страдания.© Ф. Ницше</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=268174&amp;user=18095&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=14" class="addthx" data-post="268174"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]AKAB[/b]','')">AKAB</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/24135.jpg" alt=""><br><span class=txtSm>Ранг: 79.4 (постоянный), 183thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.44'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24135">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2010 23:57 <br><script type="text/javascript">QU('AKAB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AKAB" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>StUser пишет:<br><br>download.utorrent.com/2.2/utorrent.exe<br>Раньше просто upx-ом распаковывалось, сейчас не хочет. Файл после упаковки модифицировался, как минимум добавлена еще одна секция. Попробовал Quick Unpack и разные RL!deUPX - ничего не выходит.  </I><br><br><br>я сделал tutrial специально для тебя <br>www.mediafire.com/?ytrrhjtck5mgwdk
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268201&amp;user=24135&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=15" class="addthx" data-post="268201"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=25008" title="29-03-2011 19:42, ранг:10.8" target="_blank">Dazz</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2010 05:36 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Tutor это правильно!<br>PS а что за прога? сразу в swf пишет или конвертнул просто потом?
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=268214&amp;user=6946&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=16" class="addthx" data-post="268214"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]AKAB[/b]','')">AKAB</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/24135.jpg" alt=""><br><span class=txtSm>Ранг: 79.4 (постоянный), 183thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.44'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24135">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2010 07:04 <br><script type="text/javascript">QU('AKAB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AKAB" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>Isaev пишет:<br>PS а что за прога? сразу в swf пишет или конвертнул просто потом?<br> </I><br>portable_InstantDemo.v7.0.0
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268215&amp;user=24135&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=17" class="addthx" data-post="268215"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]StUser[/b]','')">StUser</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.72'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26704">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2010 12:56 &middot; Поправил: StUser <br><script type="text/javascript">QU('StUser','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StUser" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>AKAB</b><br>Спасибо.  Примерно так и делал. Только дампил PETools.<br>Заметил одну проблему с распакованным таким образом uTorrent-ом. Если он уже запущен, то добавлении торрентов из браузеров или просто кликом на *.torrent файле не срабатывает - не появляется окно добавления закачки. Что это может быть?<br><br><b>Добавленно.</b><br>А если дампить с помощью ImpREC, как в туторе <b>AKAB</b>  - то все нормально. <img src="img/smilies/s1.gif" alt="">  Хотя, скорей-всего, это я первый раз с PETools-ом где-то наглючил. <b>AKAB</b>, еще раз спасибо!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268226&amp;user=26704&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=18" class="addthx" data-post="268226"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]verdizela[/b]','')">verdizela</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.0 (ветеран), 116thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4093">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2010 13:57 <br><script type="text/javascript">QU('verdizela','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=verdizela" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>StUser пишет:<br>Только дампил PETools.Заметил одну проблему с распакованным таким образом uTorrent-ом. Если он уже запущен, то добавлении торрентов из браузеров или просто кликом на *.torrent файле не срабатывает - не появляется окно добавления закачки. Что это может быть? </I><br>Скорее всего был косяк с  настройками в PETools.
<br><br><font size="1"><i>-----<br>We do what we want because we can.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=268229&amp;user=4093&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=19" class="addthx" data-post="268229"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]StUser[/b]','')">StUser</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.72'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26704">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2010 17:32 &middot; Поправил: StUser <br><script type="text/javascript">QU('StUser','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StUser" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>verdizela</b><br>Скорей-всего. <br><br>Я тут подумал, для моих целей, возможно, и распаковывать не надо. <br>Если я в оригинальный exe вставлю перед jmp-ом на OEP что-то типа:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004FF2C9</span>&nbsp;&nbsp;C605&nbsp;DAAE4000&nbsp;EB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">40AEDA</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0EB</span></li><li class="hl_l1"><span class="hl_number">004FF2D0</span>&nbsp;&nbsp;E9&nbsp;<span class="hl_number">8FCAF8FF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_number">0048BD64</span></li>        </ol>
    </div>
</div></div>
<br>То никаких косяков по-идее не должно вылезти? Я там просто меняю условный переход на безусловный. Или  адрес этого jmp-а будет меняться в зависимости от системы?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268237&amp;user=26704&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=20" class="addthx" data-post="268237"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2010 18:25 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
От системы адреса не меняются, если только это не DLL она по разным адресам грузиться может.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=268250&amp;user=3232&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=21" class="addthx" data-post="268250"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2010 19:28 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>От системы адреса не меняются, если только это не DLL она по разным адресам грузиться может.  </I><br>В семерке часто бывает, что грузит куда попало.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268261&amp;user=5291&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=22" class="addthx" data-post="268261"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2010 22:51 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Слышал про эту фишку, если она включена. Но разве для нее не надо релоков?
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=268294&amp;user=3232&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=23" class="addthx" data-post="268294"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]4kusNick[/b]','')">4kusNick</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1931.jpg" alt=""><br><span class=txtSm>Ранг: 748.2 <font color=magenta>(<b>! !</b>)</font>, 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.1'>Активность: 0.37<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1931">Участник</a><br><font color=blue>bytecode!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 октября 2010 00:51 &middot; Поправил: 4kusNick <br><script type="text/javascript">QU('4kusNick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=4kusNick" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
На 7x64 оеп такой же.
<br><br><font size="1"><i>-----<br>Флэш, ява, дотнет - на завтрак, обед и ужин. Unity3D на закуску.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=268301&amp;user=1931&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=24" class="addthx" data-post="268301"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]StUser[/b]','')">StUser</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.72'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26704">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 октября 2010 17:45 &middot; Поправил: StUser <br><script type="text/javascript">QU('StUser','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StUser" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
То есть сегмент памяти, куда распаковывается код, может меняться и MOV BYTE PTR DS:[40AEDA],0EB может записать патч не туда? Тогда как лучше патчить без распаковки?<br>Придумал пока такой вариант, вместо:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004FF2B8</span>&nbsp;&nbsp;&nbsp;&nbsp;FFD5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_registr">EBP</span></li><li class="hl_l1"><span class="hl_number">004FF2BA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">004FF2BB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">61</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">POPAD</span></li><li class="hl_l1"><span class="hl_number">004FF2BC</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D4424</span>&nbsp;<span class="hl_number">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">-</span><span class="hl_number">80</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">004FF2C0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_number">004FF2C2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">39C4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">004FF2C4</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">75</span>&nbsp;FA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JNE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">004FF2C0</span></li><li class="hl_l1"><span class="hl_number">004FF2C6</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">83EC</span>&nbsp;<span class="hl_number">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>SUB</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_char">-</span><span class="hl_number">80</span></li><li class="hl_l0"><span class="hl_number">004FF2C9</span>&nbsp;&nbsp;&nbsp;&nbsp;C605&nbsp;DAAE4000&nbsp;E&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">40AEDA</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0EB</span></li><li class="hl_l1"><span class="hl_number">004FF2D0</span>&nbsp;&nbsp;&nbsp;E9&nbsp;<span class="hl_number">8FCAF8FF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_number">0048BD64</span></li>        </ol>
    </div>
</div></div>
<br>делаю:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004FF2B8</span>&nbsp;&nbsp;&nbsp;&nbsp;FFD5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_registr">EBP</span></li><li class="hl_l1"><span class="hl_number">004FF2BA</span>&nbsp;&nbsp;&nbsp;&nbsp;EB&nbsp;<span class="hl_number">12</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">004FF2CE</span></li><li class="hl_l0"><span class="hl_number">004FF2BC</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D4424</span>&nbsp;<span class="hl_number">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">-</span><span class="hl_number">80</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">004FF2C0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_number">004FF2C2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">39C4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">004FF2C4</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">75</span>&nbsp;FA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JNE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">004FF2C0</span></li><li class="hl_l0"><span class="hl_number">004FF2C6</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">83EC</span>&nbsp;<span class="hl_number">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>SUB</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_char">-</span><span class="hl_number">80</span></li><li class="hl_l1"><span class="hl_number">004FF2C9</span>&nbsp;&nbsp;&nbsp;E9&nbsp;<span class="hl_number">96CAF8FF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_number">0048BD64</span></li><li class="hl_l0"><span class="hl_number">004FF2CE</span>&nbsp;&nbsp;&nbsp;&nbsp;C687&nbsp;DAAE0000&nbsp;E&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESI</span><span class="hl_char">+</span><span class="hl_number">09EDA</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0EB</span></li><li class="hl_l1"><span class="hl_number">004FF2D5</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">004FF2D6</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">61</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">POPAD</span></li><li class="hl_l1"><span class="hl_number">004FF2D7</span>&nbsp;&nbsp;&nbsp;EB&nbsp;E3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">004FF2BC</span></li>        </ol>
    </div>
</div></div>
<br>В ESI в данном случае, как я понял, хранится адрес начала секции, куда UPX распаковывает код(???). У меня это постоянно 0x401000. Теоретически, такой вариант патчинга должен срабатывать и для случаев, когда, как пишет <b>Vovan666</b>, exe-шник  грузится куда-попало?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268395&amp;user=26704&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=25" class="addthx" data-post="268395"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 октября 2010 18:10 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
я бы сделал так<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004FF2C9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">50</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">004FF2CA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">64</span><span class="hl_char">:</span>A1&nbsp;<span class="hl_number">30000000</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">FS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">30</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">004FF2D0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B40</span>&nbsp;<span class="hl_number">08</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">004FF2D3</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C680&nbsp;DAAE0000&nbsp;EB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">+</span>AEDA<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0EB</span></li><li class="hl_l0"><span class="hl_number">004FF2DA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">58</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">004FF2DB</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;E9&nbsp;<span class="hl_number">84CAF8FF</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>JMP</b></span>&nbsp;utorrent<span class="hl_char">.</span><span class="hl_number">0048BD64</span></li><li class="hl_l0">&nbsp;</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=268396&amp;user=5291&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=26" class="addthx" data-post="268396"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]StUser[/b]','')">StUser</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.72'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26704">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 октября 2010 18:33 <br><script type="text/javascript">QU('StUser','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=StUser" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>Vovan666</b><br>Спасибо за ликбез! Про этот Thread Information Block и Process Environment Block я вообще ничего не знал, пришлось гуглить по наводке на FS:[30] ;)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268399&amp;user=26704&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=27" class="addthx" data-post="268399"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Prividenie[/b]','')">Prividenie</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.63'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26993">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 ноября 2010 06:42 <br><script type="text/javascript">QU('Prividenie','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Prividenie" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<I>AKAB пишет:<br>я сделал tutrial специально для тебя<br>www.mediafire.com/?ytrrhjtck5mgwdk </I><br>Уважаемый, если вас не затруднит, может можно такой же для BitTorrenta сделать?<br>download.bittorrent.com/dl/BitTorrent-7.2.exe<br>Я по вашему туториалу распаковал его, а обратно не запаковывается. DiE Scan 0.64 пишет &quot;UPX &lt;Modified&gt;&quot;, а FastScanner 3 final выдал &quot;UPX v3.0&quot;, но распаковать не может.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=271380&amp;user=26993&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=28" class="addthx" data-post="271380"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]AKAB[/b]','')">AKAB</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/24135.jpg" alt=""><br><span class=txtSm>Ранг: 79.4 (постоянный), 183thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.44'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24135">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2010 02:31 <br><script type="text/javascript">QU('AKAB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AKAB" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<I>Prividenie пишет:<br>Уважаемый, если вас не затруднит, может можно такой же для BitTorrenta сделать?<br>--&gt; Link &lt;--<br>Я по вашему туториалу распаковал его, а обратно не запаковывается. DiE Scan 0.64 пишет &quot;UPX &lt;Modified&gt;&quot;, а FastScanner 3 final выдал &quot;UPX v3.0&quot;, но распаковать не может.  </I><br><br><br>www.mediafire.com/?upvcyuy1mu2kpj5
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=271447&amp;user=24135&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=29" class="addthx" data-post="271447"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Prividenie[/b]','')">Prividenie</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.63'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26993">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2010 05:06 <br><script type="text/javascript">QU('Prividenie','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Prividenie" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16874&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<I>AKAB пишет:<br>www.mediafire.com/?upvcyuy1mu2kpj5 </I><br>Спасибо! Но он всё равно не хочет сжиматься, UPX-ом. Насколько я понял, из того что мне говорили на ru-board, он не правильно распакован. На ru-board мне давали нормально распакованную версию, но она более старой версии. Извиняюсь за беспокойство, и ещё раз спасибо за попытку помоч.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=271468&amp;user=26993&amp;forum_n=5&amp;topic=16874&amp;page=0&amp;anchor=30" class="addthx" data-post="271468"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=16874&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=16874&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите распаковать новый uTorrent 2.2 RC2</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=16874" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
