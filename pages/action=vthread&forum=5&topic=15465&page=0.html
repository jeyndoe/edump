<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как пропатчить DLL-модуль в памяти? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="В программе при загрузке подгружаются модули .DLL Я нашёл в каких местах одного из DLL нужно подменить байты, чтобы в программе стали доступны все лицезированные возможности. DLL запакована. Quick Unpacker показывает: PESniffer">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как пропатчить DLL-модуль в памяти?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]krobol2000[/b]','')">krobol2000</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.52'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=14863">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2009 02:38 <br><script type="text/javascript">QU('krobol2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=krobol2000" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
В программе при загрузке подгружаются модули .DLL<br><br>Я нашёл в каких местах одного из DLL нужно подменить байты, чтобы в программе стали доступны все лицезированные возможности.<br><br>DLL запакована. Quick Unpacker показывает:<br><br>PESniffer EP Scan: PEtite v2.1<br>PEiD scanning... PEtite 2.x [Level 0] -&gt; Ian Luck<br><br>В начале файла-DLL находится загрузчик-распаковщик.<br><br>Я в распаковщик встроил свой код, который после распаковки меняет нужные байты в памяти.<br>Т.к. программа проверяет целостность своих файлов, то пришлось ещё добавить нужные байты, чтобы сходилась контрольная сумма.<br><br>Всё это до недавнего времени работало, но теперь появилась ещё какая-то доп. проверка целостности файлов, которую мой DLL уже не проходит.<br><br>Подскажите, каким образом можно поменять эти очень нужные байты в памяти, не меняя DLL-файл?<br><br>Попробовал ABEL loader generator на основную программу, не получается.<br>Пишет, что это защищённая область памяти DLL<br><br>Что можно сделать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246560&amp;user=14863&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=1" class="addthx" data-post="246560"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2009 03:34 &middot; Поправил: SVLab <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
А почему ты думаешь, что правка в памяти тебе поможет? возможно там и происходит дополнительная проверка.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246561&amp;user=4026&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=2" class="addthx" data-post="246561"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2009 05:13 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>krobol2000</b><br>Ты либу патченную не хочешь больше трогать? ну тогда напиши ещё одну и запихни весь код с &quot;инЪекцией&quot; туда, назови её lpk.dll <img src="img/smilies/s3.gif" alt=""> бери masm (ну или на чём ты там пишешь) и вперёд, для записи юзай VirtualProtect. (ну это так сказал, на всякий случай) <img src="img/smilies/s1.gif" alt=""><br><br><I>SVLab пишет:<br>А почему ты думаешь, что правка в памяти тебе поможет? возможно там и происходит дополнительная проверка. </I><br>Не совсем понял, что ты имеешь в виду...Разве нельзя загасить эту проверку в памяти таким же образом как и всё остальное? Да и вообще что мешает просто расковырять эксешник и глянуть что там и как?!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246562&amp;user=16624&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=3" class="addthx" data-post="246562"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]krobol2000[/b]','')">krobol2000</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.52'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=14863">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2009 13:23 <br><script type="text/javascript">QU('krobol2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=krobol2000" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
SVLab, доп. проверки целостности в памяти пока нет, т.к. менял эти байты дебаггером и всё работает.<br><br>MasterSoft, DLL надо оставить оригинальным (сам файл), а вот в памяти после того, как он распакуется, поменять нужные байты.<br>Про lpk.dll не понял. Про VirtualProtect читал, например,  здесь www.xakep.ru/magazine/xa/118/062/1.asp - то что мне нужно это способ №3.<br><br>Это проделывает генератор лоадера - ABEL, но только для ехе-шника. Есть ли похожая программа для изменения подгружаемых DLL?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246571&amp;user=14863&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=4" class="addthx" data-post="246571"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2009 14:31 &middot; Поправил: SVLab <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>MasterSoft пишет:<br>Разве нельзя загасить эту проверку в памяти таким же образом как и всё остальное </I><br>Можно, конечно, ну так ведь человек не может найти где и как проверяется.<br><br><b>krobol2000</b>, а сам себя EXE проверяет?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246577&amp;user=4026&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=5" class="addthx" data-post="246577"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]krobol2000[/b]','')">krobol2000</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.52'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=14863">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2009 15:54 <br><script type="text/javascript">QU('krobol2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=krobol2000" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
SVLab, да, сам себя exe проверяет, т.е. в него встроить нельзя. К тому же он часто обновляется, поэтому при каждом обновлении придётся заново встраивать патчер.<br><br>Насколько я понял, выход такой: на masm32 (сегодня установил его) пишу лоадер, который<br>- запускает основную программу &quot;main.exe&quot;<br>- через 5-10 сек (думаю столько хватит, чтобы main.exe загрузила DLL - &quot;protect.dll&quot;) ищет в памяти нужный модуль protect.dll<br>- патчит в protect.dll нужные байты<br>- лоадер заканчивает работу, а программа продолжает работать в полнофункциональном режиме.<br><br>В аттаче loader.asm, то что я нашёл за образец. Теперь в него нужно вставить код, который реализует патчинг нужной dll. Как это сделать?<br><br><br>Либо, второй вариант:<br>- с помощью ABEL генерю лоадер, который в основную программу main.exe добавит код, который пропатчит нужный модуль после загрузки этого модуля.<br><br>на примере изменение API MessageBoxA:<br>в main.exe вставляем JMP и по адресу JMP:<br><br>00401026 PUSHAD; сохраняем регистры в стек<br>; далее следуют четыре параметра, передаваемые в стек перед вызовом VirtualProtect<br>00401027 PUSH 00401060; указатель на нулевой байт - параметр &quot;lpflOldProtect&quot;<br>0040102C MOV EAX,40; Помещаем в EAX параметр &quot;flNewProtect&quot;, который разрешает запись в область памяти, где располагается наша DLL<br>00401031 PUSH EAX; кладем параметр в стек<br>00401032 PUSH 8; параметр &quot;dwSize&quot;, который представляет собой размер области памяти<br>00401034 PUSH 7E3A05C1; параметр &quot;lpAddress&quot; - начальный адрес области памяти <br>00401039 CALL VirtualProtect; вызываем VirtualProtect<br>0040103E MOV EAX,[401100]; помещаем в eax первые 4 байта машинного кода<br>00401043 MOV EBX,7E3A05C1; в ebx помещаем адрес, по которому будет записано машинное слово<br>00401048 MOV [EBX],EAX; записываем машинный код в тело API-функции<br>0040104A MOV EAX,[401104]; помещаем в eax 4 последних байта машинного кода<br>0040104F MOV EBX,7E3A05C5; в ebx помещаем адрес, по которому будет записано машинное слово<br>00401054 MOV [EBX],EAX; записываем машинный код в тело API-функции<br>00401056 POPAD; восстанавливаем регистры перед вызовом MessageBoxA<br>00401057 CALL MessageBoxA<br>0040105C JMP 00401013; переходим к дальнейшему выполнению программы<br><br>По этому методу есть несколько вопросов: как узнать адрес памяти в которую загружен DLL (ан-но 7E3A05C1).<br><br>Какой метод попроще и как реализовать хоть какой-то?<br><br><img src="img/attach.gif" alt=""> <a href="./files/b2c8_13.12.2009_CRACKLAB.rU.tgz">b2c8_13.12.2009_CRACKLAB.rU.tgz</a> - loader.asm
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246585&amp;user=14863&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=6" class="addthx" data-post="246585"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]_ruzmaz_[/b]','')">_ruzmaz_</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 114.8 (ветеран), 41thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.01'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=21589">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2009 16:41 &middot; Поправил: _ruzmaz_ <br><script type="text/javascript">QU('_ruzmaz_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=_ruzmaz_" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>krobol2000 пишет (в loader.asm):<br>invoke SuspendThread,addr pinfo.hThread ; Тормозим нашу прогу</I><br>А к моменту вызова SuspendThread (после Sleep) прога других потоков не наклепает? Или просто с protect.dll работает только этот поток?<br>Перед WriteProcessMemory возможно еще придется VirtualProtectEx вызывать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246588&amp;user=21589&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=7" class="addthx" data-post="246588"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2009 16:59 &middot; Поправил: BoRoV <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>krobol2000 пишет:<br>protect.dll </I><br>это вы ломаете стар?
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=246590&amp;user=15500&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=8" class="addthx" data-post="246590"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]krobol2000[/b]','')">krobol2000</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.52'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=14863">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2009 17:19 <br><script type="text/javascript">QU('krobol2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=krobol2000" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
нет, не стар. прикладное ПО<br><br>а кусок на asm - это я в инете, как пример нашёл, чтобы на этой базе уже делать лоадер.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246592&amp;user=14863&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=9" class="addthx" data-post="246592"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2009 18:20 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
А dll в импорте или грузится программой?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246598&amp;user=4026&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=10" class="addthx" data-post="246598"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]krobol2000[/b]','')">krobol2000</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.52'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=14863">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2009 20:14 <br><script type="text/javascript">QU('krobol2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=krobol2000" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
это не могу сказать. Не знаю как определить.<br><br>Но при запуске программы подгружается несколько dll
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246605&amp;user=14863&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=11" class="addthx" data-post="246605"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2009 20:39 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>krobol2000 пишет:<br>это не могу сказать. Не знаю как определить. </I><br>Дойди до оеп и посмотри табличку импорта импреком к примеру.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246607&amp;user=16624&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=12" class="addthx" data-post="246607"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]krobol2000[/b]','')">krobol2000</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.52'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=14863">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 декабря 2009 01:33 <br><script type="text/javascript">QU('krobol2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=krobol2000" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Загружаю программу в olly debugger - когда стоит на оеп, то нужного dll ещё не загружено.<br><br>В процессе выполнения программы вызывается функция, которая загружает необходимые для работы dll-ки. Т.е. dll грузятся программой. <br>Программа использует MVC и грузит dll функцией QtCore4.load@QLibrary@@QAE_NXZ<br>которая вызывает в свою очередь функцию kernel32.LoadLibraryW
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246619&amp;user=14863&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=13" class="addthx" data-post="246619"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 декабря 2009 07:08 &middot; Поправил: ClockMan <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>krobol2000 пишет:<br>как узнать адрес памяти в которую загружен DLL </I><br>Пример<br><b><br>PUSH &quot;KERNEL32.dll&quot;<br>CALL kernel32.GetModuleHandleA<br>в EAX адрес по которому загрузилась делка<br>если 0 то делка незагружена<br></b>
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=246625&amp;user=17432&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=14" class="addthx" data-post="246625"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]krobol2000[/b]','')">krobol2000</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.52'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=14863">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 декабря 2009 18:17 <br><script type="text/javascript">QU('krobol2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=krobol2000" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
LOADER.EXE - загружена по адресу 0401000h<br><br>из него, с помощью kernel32.CreateProcessA запускаю основную программу MAIN.EXE<br>MAIN.EXE - загружена по адресу 0401000h. В ней подгружается TARGET.DLL с помощью kernel32.LoadLibraryW.<br>TARGET.DLL загружена по адресу 01161000h (но это частный случай).<br><br>Как из LOADER.EXE попасть в адресное пространство процесса MAIN.EXE, чтобы изменить TARGET.DLL в памяти по адресу 01161000h?<br><br><b>ClockMan</b>,<br>PUSH &quot;KERNEL32.dll&quot;<br>CALL kernel32.GetModuleHandleA показывает адрес местной копии модуля kernel32.dll<br>Соответственно PUSH &quot;TARGET.DLL&quot;; CALL kernel32.GetModuleHandleA; - результат EAX=0 =(
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246647&amp;user=14863&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=15" class="addthx" data-post="246647"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]RSI[/b]','')">RSI</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 284.8 (наставник), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6361">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 декабря 2009 18:48 <br><script type="text/javascript">QU('RSI','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=RSI" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>krobol2000</b><br>тут простых путей мало.<br>1) как тебе все и говорят, твой лоадер должен запустить процесс засуспендженным и выполнить инжект своей длл, которой уже будет проще работать в контексте данного процесса ( можешь погуглить на эту тему ). далее один из вариантов по таймеру сканить не подгрузилась ли длл как тебе тут советовали и тогда ее патчить, или же хучить сплайсингом LoadLibraryEx и анализировать имя длл, а потом патчить.<br>2) вся логика остается в лоадыре он будет отпускать и суспендить процесс через какое-то время и сканировать всю память процесса ( т.е. читать по 0x1000 память ) и искать сигнатуру из кода твоей длл, чтобы распознать что она уже загружена, далее делаешь подсчет насколько тебе нужно сместится относительно найденного адреса чтобы пропатчить ее.<br><br>ну это то что счас в голову пришло
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246649&amp;user=6361&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=16" class="addthx" data-post="246649"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 декабря 2009 20:12 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
1 как и написал RSI твой лоадер должен запустить процесс засуспендженным<br>2 пишешь сразу после CALL QtCore4.load@QLibrary@@QAE_NXZ  EBh,FEh (т.е зацикливаешь прогу)<br>3 Через ResumeThread продолжаешь работу<br>4 ставишь в своем лоадере задержку секунд 5<br>5 Стопоришь процесс через SuspendThread<br>6 Через GetThreadContext получаешь значение EAX (поидее там должен быть адрес куда загрузилась dll)<br>7 Меняешь EBh,FEh на оригинальные, патчишь длл, продолжаешь работу (ResumeThread) <br>8 Собственно и всё INVOKE ExitProcess,0
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246651&amp;user=5291&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=17" class="addthx" data-post="246651"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 декабря 2009 22:50 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>RSI</b>, <b>Vovan666</b><br>Разве не проще просто пропатчить EXE в памяти перед CALL QtCore4.load@QLibrary@@QAE_NXZ. (Как говорит ТC, память не контролируется.) Имя dll должно ведь ей передаваться, если имя не то, просто возвращаем управление проге, если то, - сами вызываем этот загрузчик и правим dll.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246664&amp;user=4026&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=18" class="addthx" data-post="246664"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]SergeyShal2009[/b]','')">SergeyShal2009</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.83'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=22366">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 декабря 2009 04:26 <br><script type="text/javascript">QU('SergeyShal2009','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergeyShal2009" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=15465.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Возможно я не прав, но все эти задержки это не надёжно. Конечно проще мониторить LoadLibraryEx. Ну а код прививки можно вставить и в dll, которая загружается статически, если в ехе нет возможности.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=246670&amp;user=22366&amp;forum_n=5&amp;topic=15465.html&amp;page=0&amp;anchor=19" class="addthx" data-post="246670"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как пропатчить DLL-модуль в памяти?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#20" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="15465">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15465" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
