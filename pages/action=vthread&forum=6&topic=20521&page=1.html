<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Не работает inject dll (исходник прилагается) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте. Пытаюсь реализовать загрузку модуля в процесс &quot;Блокнот&quot; по исходникам MS-REM. Я переделал модули под Embarcadero Delphi XE2 ,всё запускается но инжекта не происходит. Работает только внедрение кода">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=1288'>UniSoft</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Не работает inject dll (исходник прилагается)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=20521&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=20521&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]CodeMaster[/b]','')">CodeMaster</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.64'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33320">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2012 18:11 <br><script type="text/javascript">QU('CodeMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=CodeMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте. Пытаюсь реализовать загрузку модуля в процесс &quot;Блокнот&quot; по исходникам MS-REM.<br>Я переделал модули под Embarcadero Delphi XE2 ,всё запускается но инжекта не происходит.<br>Работает только внедрение кода напрямую через @Main.<br>Исходники и откомпилированные файлы:<br>rghost.ru/41672556
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314498&amp;user=33320&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=1" class="addthx" data-post="314498"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Alchemistry[/b]','')">Alchemistry</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 145.8 (ветеран), 191thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.05'>Активность: 0.14<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=21411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 ноября 2012 22:18 <br><script type="text/javascript">QU('Alchemistry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alchemistry" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
<I>CodeMaster пишет:<br>Я не могу понять,как сделать чтобы хэндл перехватываемого файла получить. </I><br><br>Выполнить пост обработку результата вызова оригинального CreateFile, передав ей в точности все то что пришло в твой хук.<br><br><I>CodeMaster пишет:<br>Иными словами,представьте что Блокнот открывает зашифрованный файл и расшифровывает его в памяти,а мы его оттуда хотим утащить. </I><br><br>И как первое связано со вторым? Ты теоретически перехватил открытие файла, и что с того? Кроме лога обращений к файлам это тебе нифига не даст, файл как был зашифрованный так и останется.<br><br>Вот у тебя есть целевая программа, за поведением которой ты хочешь прошпионить.<br><br>Как она работает с твоим чудесным фаелом? Открывает его, читает в свой буферок, делает с ним грязные штуки и че дальше?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314879&amp;user=21411&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=2" class="addthx" data-post="314879"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]CodeMaster[/b]','')">CodeMaster</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.64'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33320">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 ноября 2012 22:26 <br><script type="text/javascript">QU('CodeMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=CodeMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<I>Alchemistry пишет:<br>Выполнить пост обработку результата вызова оригинального CreateFile, передав ей в точности все то что пришло в твой хук. </I><br>Не понимаю,объясните для блондинок. Внутри хука ещё один хук что-ли поставить и сделать рекурсию?<br><I>Alchemistry пишет:<br>Ты теоретически перехватил открытие файла, и что с того? Кроме лога обращений к файлам это тебе нифига не даст, файл как был зашифрованный так и останется. </I><br>Не совсем так,у меня возможно файл расшифровывается уже перед вызовом CreateFile
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314880&amp;user=33320&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=3" class="addthx" data-post="314880"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 ноября 2012 22:43 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
Модераторы простите меня великодушно.<br><b>CodeMaster</b><br><I>у меня возможно файл расшифровывается уже перед вызовом CreateFile </I><br>Это напалм.<img src="img/smilies/s15.gif" alt=""><br>Магия вуду или нам нужно угадать как?<br>Отвечает Александр Друзь.<img src="img/smilies/s1.gif" alt=""><br><I>Внутри хука ещё один хук что-ли поставить </I><br>Почему бы и нет, что тут такого?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314881&amp;user=6&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=4" class="addthx" data-post="314881"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=6470" title="30-11-2012 19:54, ранг:54.9" target="_blank">tomac</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]CodeMaster[/b]','')">CodeMaster</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.64'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33320">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 ноября 2012 23:04 <br><script type="text/javascript">QU('CodeMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=CodeMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
Мне походу дела надо вот что сделать: выполнить функцию NtQuerySystemInformation c параметром SystemHandleInformation , я получу список всех открытых хэндлов процесса. Среди них будет нужный файл, и его хэндл просто подставить в функцию hFile1:=TrueCreateFileW(ukradhand,....<br>Размер файла только не получится определить через GetFileSize,там придется какие-то извращения придумывать с буфером (читать до тех пор,пока данные не закончатся)<br>Вроде всё понятно,но как реализовать чтоб работало - хз
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314882&amp;user=33320&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=5" class="addthx" data-post="314882"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 ноября 2012 23:46 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
<b>CodeMaster</b><br>Ох и бред же вы пишете. Особенно своей бредовостью меня поразил последний пост. Какой NtQuerySystemInformation? И куда вы будете подставлять найденный хэндл - в CreateFile? А вас не смущает, что она в качестве входных параметров хэндл не принимает? <br><br>Потом что там за бред про рекурсию? Никакой рекурсии. Перехваты делятся на два вида (грубо) - перехват выполняет предварительную фильтрацию входных параметров, т.е. не открывает некоторые файлы с определённой подстрокой в имени, например. Либо второй вид - перехват выполняется для фильтрации результатов выполненной функции - например, вы вызвали CreateFile, а потом вместо хэндла, который она вернула, подсунули хэндл вашего ранее открытого файла (х.з., зачем это нужно, просто пример привожу).<br><br>Т.е. вариант 1:<br>Вызов перехвата сводится либо к вызову оригинальной функции, либо к возврату из перехвата без вызова оригинала.<br><br>Вариант 2:<br>Вызов перехвата сводится к обязательному вызову оригинала, а вот фитрация либо что-то делает, либо возвращает результат неизменным.<br><br>А теперь вы по пунктам попытайтесь объяснить, что вам нужно сделать. Не надо делать догадок, как, вы напишите, что, а как - подскажут.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=314883&amp;user=6336&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=6" class="addthx" data-post="314883"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]CodeMaster[/b]','')">CodeMaster</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.64'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33320">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 14:12 <br><script type="text/javascript">QU('CodeMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=CodeMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Хэндл можно подставить с NtCreateFile ,если переделать библиотеку под её перехват. Насколько это глупо - я не знаю,но мысли такие есть.<br>Что я хочу: есть зашифрованный файл,есть его расшифрованная копия (размеры полностью совпадают), есть процесс который открывает файл и дешифрует его  в памяти. Моя задача - получить на диске файл,полностью такой же как эталон.<br>Что у меня сейчас есть: исходники для перехвата CreateFileW и копирования файла, всё замечательно работает если бы не одна пакость: при открытии защищенного файла получаем на диске test.pak правильного размера,весь забитый нулями. Почему так - хз,по идее должен был просто скопироваться зашифрованный файл.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314901&amp;user=33320&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=7" class="addthx" data-post="314901"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 465thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 14:43 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<I>CodeMaster пишет:<br>Хэндл можно подставить с NtCreateFile </I><br>Ты с обычной API разберись сначала а потом лезь в натив...
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=314904&amp;user=17432&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=8" class="addthx" data-post="314904"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]CodeMaster[/b]','')">CodeMaster</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.64'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33320">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 19:21 <br><script type="text/javascript">QU('CodeMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=CodeMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
Вот накатал рабочий перехватчик для NtCreateFile:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">function&nbsp;NewNtCreateFile<span class="hl_char">(</span>FileHandle<span class="hl_char">:</span>&nbsp;PHandle<span class="hl_comment">; const DesiredAccess: ACCESS_MASK;</span></li><li class="hl_l1">&nbsp;&nbsp;ObjectAttributes<span class="hl_char">:</span>&nbsp;POBJECT_ATTRIBUTES<span class="hl_comment">; IoStatusBlock: PIO_STATUS_BLOCK;</span></li><li class="hl_l0">&nbsp;&nbsp;AllocationSize<span class="hl_char">:</span>&nbsp;PLARGE_INTEGER<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;FileAttributes<span class="hl_char">,</span>&nbsp;ShareAccess<span class="hl_char">,</span>&nbsp;CreateDisposition<span class="hl_char">,</span>&nbsp;CreateOptions<span class="hl_char">:</span>&nbsp;ULONG<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;EaBuffer<span class="hl_char">:</span>&nbsp;PVOID<span class="hl_comment">; EaLength: ULONG): NTSTATUS; stdcall;</span></li><li class="hl_l1">var</li><li class="hl_l0">&nbsp;&nbsp;res&nbsp;<span class="hl_char">:</span>&nbsp;Integer<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;text&nbsp;<span class="hl_char">:</span>&nbsp;PUNICODE_STRING<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;buf<span class="hl_char">:</span>_OFSTRUCT<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;f<span class="hl_char">:</span>hFile<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;buffer&nbsp;<span class="hl_char">:</span>PChar<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;rwd&nbsp;<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>DWORD</b></span><span class="hl_comment">;</span></li><li class="hl_l0">begin</li><li class="hl_l1">&nbsp;&nbsp;result<span class="hl_char">:</span><span class="hl_char">=</span>TrueNtCreateFile<span class="hl_char">(</span>FileHandle<span class="hl_char">,</span>&nbsp;DesiredAccess<span class="hl_char">,</span>&nbsp;ObjectAttributes<span class="hl_char">,</span>&nbsp;IoStatusBlock<span class="hl_char">,</span>&nbsp;AllocationSize<span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileAttributes</span><span class="hl_char">,</span>&nbsp;ShareAccess<span class="hl_char">,</span>&nbsp;CreateDisposition<span class="hl_char">,</span>&nbsp;CreateOptions<span class="hl_char">,</span>&nbsp;EaBuffer<span class="hl_char">,</span>&nbsp;EaLength<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;UnhookCode<span class="hl_char">(</span>@TrueNtCreateFile<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;f<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;CreateFile<span class="hl_char">(</span><span class="hl_quote">'C:\towrite.txt'</span><span class="hl_char">,</span>GENERIC_READ&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;GENERIC_WRITE<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nil<span class="hl_char">,</span>&nbsp;OPEN_ALWAYS<span class="hl_char">,</span>FILE_ATTRIBUTE_NORMAL<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;HookProc<span class="hl_char">(</span><span class="hl_quote">'ntdll.dll'</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">'NtCreateFile'</span><span class="hl_char">,</span>&nbsp;@NewNtCreateFile<span class="hl_char">,</span>&nbsp;@TrueNtCreateFile<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;f&nbsp;<span class="hl_char">=</span>&nbsp;&nbsp;INVALID_HANDLE_VALUE&nbsp;then&nbsp;exit<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">try</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;text<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;ObjectAttributes<span class="hl_char">.</span>ObjectName<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer<span class="hl_char">:</span><span class="hl_char">=</span>#13<span class="hl_char">+</span>#10<span class="hl_char">+</span><span class="hl_quote">'NtOpenFile: '</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;text<span class="hl_char">.</span>Buffer<span class="hl_char">=</span><span class="hl_quote">'\??\C:\proverka.txt'</span>&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;SetFilePointer<span class="hl_char">(</span>f<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span>FILE_END<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;&nbsp;INVALID_SET_FILE_POINTER&nbsp;then&nbsp;exit<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;WriteFile<span class="hl_char">(</span>f<span class="hl_char">,</span>buffer<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">,</span>length<span class="hl_char">(</span>buffer<span class="hl_char">)</span><span class="hl_char">,</span>rwd<span class="hl_char">,</span>nil<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>false</b></span>&nbsp;then&nbsp;exit<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WriteFile<span class="hl_char">(</span>f<span class="hl_char">,</span>text<span class="hl_char">.</span>Buffer^<span class="hl_char">,</span>text<span class="hl_char">.</span>Length<span class="hl_char">,</span>&nbsp;rwd<span class="hl_char">,</span>nil<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;finally</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>f<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>Как мне теперь узнать адрес буфера,куда расшифровывается файл в памяти после перехвата NtCreateFile? Или достаточно будет его прочитать и записать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314914&amp;user=33320&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=9" class="addthx" data-post="314914"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Alchemistry[/b]','')">Alchemistry</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 145.8 (ветеран), 191thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.05'>Активность: 0.14<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=21411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 19:35 <br><script type="text/javascript">QU('Alchemistry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alchemistry" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
<img src="http://ozhouse.wpengine.netdna-cdn.com/files/2012/09/double_facepalm.jpg" border="0" align="" alt=""><br><br><I>CodeMaster пишет:<br>Как мне теперь узнать адрес буфера,куда расшифровывается файл в памяти после перехвата NtCreateFile? </I><br><br>Спроси у Ванги. Заодно поинтересуйся у нее зачем ты перехватил NtCreateFile.<br><br>Чтение из файла идет не через CreateFile, а через ReadFile, а может вообще быть через мапинг и буфер может быть выделен динамически, а может быть определен статически массивом определенной длины. Где это в программе и как это связано с твоим гавнокодом неизвестно никому.<br><br>В общем, лучшим решением твоей проблемы будет это http://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=17633<br><br>Кто хочет почитать предыдущие похождения ТС, см. http://www.cyberforum.ru/delphi-winapi/thread698419.html, ищите темы пользователя, все в том же ключе что и тут.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314915&amp;user=21411&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=10" class="addthx" data-post="314915"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]CodeMaster[/b]','')">CodeMaster</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.64'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33320">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 19:43 <br><script type="text/javascript">QU('CodeMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=CodeMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
Почему-то копироваться не хочет через NtCreateFile:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">begin</li><li class="hl_l1">&nbsp;&nbsp;result<span class="hl_char">:</span><span class="hl_char">=</span>TrueNtCreateFile<span class="hl_char">(</span>FileHandle<span class="hl_char">,</span>&nbsp;DesiredAccess<span class="hl_char">,</span>&nbsp;ObjectAttributes<span class="hl_char">,</span>&nbsp;IoStatusBlock<span class="hl_char">,</span>&nbsp;AllocationSize<span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileAttributes</span><span class="hl_char">,</span>&nbsp;ShareAccess<span class="hl_char">,</span>&nbsp;CreateDisposition<span class="hl_char">,</span>&nbsp;CreateOptions<span class="hl_char">,</span>&nbsp;EaBuffer<span class="hl_char">,</span>&nbsp;EaLength<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;UnhookCode<span class="hl_char">(</span>@TrueNtCreateFile<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;hFile1<span class="hl_char">:</span><span class="hl_char">=</span>CreateFileW<span class="hl_char">(</span><span class="hl_quote">'C:\proverka.txt'</span><span class="hl_char">,</span>GENERIC_READ<span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_SHARE_READ</span><span class="hl_char">,</span>&nbsp;nil<span class="hl_char">,</span>&nbsp;OPEN_ALWAYS<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;hFile2<span class="hl_char">:</span><span class="hl_char">=</span>CreateFileW<span class="hl_char">(</span><span class="hl_quote">'C:\test.pak'</span><span class="hl_char">,</span>GENERIC_WRITE<span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;nil<span class="hl_char">,</span>&nbsp;OPEN_ALWAYS<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;HookProc<span class="hl_char">(</span><span class="hl_quote">'ntdll.dll'</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">'NtCreateFile'</span><span class="hl_char">,</span>&nbsp;@NewNtCreateFile<span class="hl_char">,</span>&nbsp;@TrueNtCreateFile<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>hFile1&nbsp;<span class="hl_char">=</span>&nbsp;&nbsp;INVALID_HANDLE_VALUE<span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;<span class="hl_char">(</span>hFile2<span class="hl_char">=</span>INVALID_HANDLE_VALUE<span class="hl_char">)</span>&nbsp;then&nbsp;exit<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">try</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;text<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;ObjectAttributes<span class="hl_char">.</span>ObjectName<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer<span class="hl_char">:</span><span class="hl_char">=</span>#13<span class="hl_char">+</span>#10<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;text<span class="hl_char">.</span>Buffer<span class="hl_char">=</span><span class="hl_quote">'\??\C:\proverka.txt'</span>&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buff<span class="hl_char">:</span><span class="hl_char">=</span>GetFileSize<span class="hl_char">(</span>hFile1<span class="hl_char">,</span>nil<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;SetFilePointer<span class="hl_char">(</span>hFile1<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;nil<span class="hl_char">,</span>&nbsp;FILE_BEGIN<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;<span class="hl_function">data</span><span class="hl_char">:</span><span class="hl_char">=</span>VirtualAlloc<span class="hl_char">(</span>nil<span class="hl_char">,</span>buff<span class="hl_char">,</span>MEM_COMMIT&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;MEM_RESERVE<span class="hl_char">,</span>PAGE_READWRITE<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;ReadFile<span class="hl_char">(</span>hFile1<span class="hl_char">,</span>data^<span class="hl_char">,</span>buff<span class="hl_char">,</span>zapisano<span class="hl_char">,</span>nil<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;WriteFile<span class="hl_char">(</span>hFile2<span class="hl_char">,</span>data^<span class="hl_char">,</span>buff<span class="hl_char">,</span>zapisano<span class="hl_char">,</span>nil<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;finally</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>f<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=314916&amp;user=33320&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=11" class="addthx" data-post="314916"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 20:41 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
<b>CodeMaster</b><br>Код: no comments<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">BOOL&nbsp;ReadFile<span class="hl_char">(</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;HANDLE&nbsp;hFile<span class="hl_char">,</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;handle&nbsp;of&nbsp;file&nbsp;to&nbsp;read&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;LPVOID&nbsp;lpBuffer<span class="hl_char">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;address&nbsp;of&nbsp;buffer&nbsp;that&nbsp;receives&nbsp;<span class="hl_function"><b>data</b></span>&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;nNumberOfBytesToRead<span class="hl_char">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;read&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;LPDWORD&nbsp;lpNumberOfBytesRead<span class="hl_char">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;address&nbsp;of&nbsp;number&nbsp;of&nbsp;bytes&nbsp;read&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;LPOVERLAPPED&nbsp;lpOverlapped&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;address&nbsp;of&nbsp;structure&nbsp;for&nbsp;<span class="hl_function"><b>data</b></span>&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_char">)</span><span class="hl_comment">;	</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;BOOL&nbsp;WriteFile<span class="hl_char">(</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;HANDLE&nbsp;hFile<span class="hl_char">,</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;handle&nbsp;to&nbsp;file&nbsp;to&nbsp;write&nbsp;to&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;LPCVOID&nbsp;lpBuffer<span class="hl_char">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;pointer&nbsp;to&nbsp;<span class="hl_function"><b>data</b></span>&nbsp;to&nbsp;write&nbsp;to&nbsp;file&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;nNumberOfBytesToWrite<span class="hl_char">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;write&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;LPDWORD&nbsp;lpNumberOfBytesWritten<span class="hl_char">,</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;pointer&nbsp;to&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;LPOVERLAPPED&nbsp;lpOverlapped&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;pointer&nbsp;to&nbsp;structure&nbsp;needed&nbsp;for&nbsp;overlapped&nbsp;I<span class="hl_char">/</span>O</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_char">)</span><span class="hl_comment">;	</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=314919&amp;user=6&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=12" class="addthx" data-post="314919"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]CodeMaster[/b]','')">CodeMaster</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.64'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33320">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 20:44 &middot; Поправил: CodeMaster <br><script type="text/javascript">QU('CodeMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=CodeMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<I>Alchemistry пишет:<br>Спроси у Ванги. Заодно поинтересуйся у нее зачем ты перехватил NtCreateFile. </I><br><img src="http://askalex.ru/wp-content/uploads/2011/05/%D1%81%D0%BA%D1%83%D0%BA%D0%B0.jpg" border="0" align="" alt=""><br><br>Перехватил NtCreateFile чтобы не думать каждый раз,какая функция используется CreateFileW или CreateFileA. Я же не с одной прогой буду свой перехватчик использовать,а с разными
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314920&amp;user=33320&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=13" class="addthx" data-post="314920"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 20:57 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
<I>CodeMaster пишет:<br>Перехватил NtCreateFile чтобы не думать каждый раз,какая функция используется CreateFileW или CreateFileA</I><br>Открой очи светлые и узри, что CreateFileA использует внутри себя CreateFileW.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314922&amp;user=1556&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=14" class="addthx" data-post="314922"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]CodeMaster[/b]','')">CodeMaster</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.64'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33320">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 21:20 <br><script type="text/javascript">QU('CodeMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=CodeMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
Ещё у меня такой вопрос: когда мы перехватили NtCreateFile, у нас есть FileHandle<br>Я пытаюсь получить имя файла по его хэндлу,для этого:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">imyafaila<span class="hl_char">:</span>PWideChar<span class="hl_comment">;</span></li><li class="hl_l1">imyafaila<span class="hl_char">:</span><span class="hl_char">=</span>PWideChar<span class="hl_char">(</span>HandleToFullPath<span class="hl_char">(</span>HWND<span class="hl_char">(</span>FileHandle<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;hFile1<span class="hl_char">:</span><span class="hl_char">=</span>CreateFileW<span class="hl_char">(</span>imyafaila<span class="hl_char">,</span>GENERIC_READ<span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;nil<span class="hl_char">,</span>&nbsp;OPEN_ALWAYS<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>Сама функция:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Function&nbsp;HandleToFullPath<span class="hl_char">(</span>H<span class="hl_char">:</span>&nbsp;HWND<span class="hl_char">)</span><span class="hl_char">:</span>&nbsp;String<span class="hl_comment">;</span></li><li class="hl_l1">Var</li><li class="hl_l0">Pid<span class="hl_char">:</span>Cardinal<span class="hl_comment">;</span></li><li class="hl_l1">M<span class="hl_char">:</span>&nbsp;TModuleEntry32<span class="hl_comment">;</span></li><li class="hl_l0">HSnapshot<span class="hl_char">:</span>&nbsp;THandle<span class="hl_comment">;</span></li><li class="hl_l1">Begin</li><li class="hl_l0">Result<span class="hl_char">:</span><span class="hl_char">=</span><span class="hl_quote">''</span><span class="hl_comment">;</span></li><li class="hl_l1">GetWindowThreadProcessId<span class="hl_char">(</span>H<span class="hl_char">,</span>@Pid<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">HSnapshot<span class="hl_char">:</span><span class="hl_char">=</span>CreateToolhelp32Snapshot<span class="hl_char">(</span>TH32CS_SNAPMODULE<span class="hl_char">,</span>Pid<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>If</b></span>&nbsp;HSnapshot<span class="hl_char">=</span><span class="hl_char">-</span><span class="hl_number">1</span>&nbsp;Then</li><li class="hl_l0">Exit<span class="hl_comment">;</span></li><li class="hl_l1">M<span class="hl_char">.</span>DwSize<span class="hl_char">:</span><span class="hl_char">=</span><span class="hl_function">SizeOf</span><span class="hl_char">(</span>TModuleEntry32<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>If</b></span>&nbsp;Module32First<span class="hl_char">(</span>HSnapshot<span class="hl_char">,</span>M<span class="hl_char">)</span>&nbsp;Then</li><li class="hl_l1">Result<span class="hl_char">:</span><span class="hl_char">=</span>M<span class="hl_char">.</span>SzExePath<span class="hl_comment">;</span></li><li class="hl_l0">CloseHandle<span class="hl_char">(</span>HSnapshot<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>End</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>Не работает. Я сделал преобразование PHandle ---&gt;HWND ,или вообще не в ту сторону копаю?<br>Мне надо чтобы в test.pak копировался перехватываемый файл
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314923&amp;user=33320&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=15" class="addthx" data-post="314923"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Alchemistry[/b]','')">Alchemistry</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 145.8 (ветеран), 191thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.05'>Активность: 0.14<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=21411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 21:28 <br><script type="text/javascript">QU('Alchemistry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alchemistry" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
<b>CodeMaster</b><br><br>Ты или тролль или упоротый. HWND это окно.<br><br>Верни свой гавнокод предыдущий с CreateFile и сделай в хуке этом своем однопоточном CopyFile (http://msdn.microsoft.com/ru-ru/library/windows/desktop/aa363851(v=vs.85).aspx) - победа.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314924&amp;user=21411&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=16" class="addthx" data-post="314924"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=33297" title="29-11-2012 17:06, ранг:0.3" target="_blank">Kolxoznik</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 21:31 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
<b>CodeMaster</b><br>Про функцию получения имени я лучше промолчу.<br><noindex><a href="http://msdn.microsoft.com/en-us/library/aa366789(VS.85).aspx" rel="nofollow" target="_blank">раз</a></noindex><br><noindex><a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff567052(v=vs.85).aspx" rel="nofollow" target="_blank">два</a></noindex><br>...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314925&amp;user=6&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=17" class="addthx" data-post="314925"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]CodeMaster[/b]','')">CodeMaster</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.64'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33320">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 21:43 <br><script type="text/javascript">QU('CodeMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=CodeMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
<b>Alchemistry</b><br>Вот здесь пишут что можно так преобразовывать PHandle в HWND. Это одно и тоже ведь,просто Борланд их разделили в описании.<br><noindex><a href="http://forum.sources.ru/showtopic=58425&amp;hl=" rel="nofollow" target="_blank">http://forum.sources.ru/showtopic=58425&amp;hl=</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314926&amp;user=33320&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=18" class="addthx" data-post="314926"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 22:10 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
<b>CodeMaster</b><br>Твою мать, что ты куришь?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=314927&amp;user=6336&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=19" class="addthx" data-post="314927"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]CodeMaster[/b]','')">CodeMaster</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.64'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33320">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 22:20 <br><script type="text/javascript">QU('CodeMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=CodeMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
<I>Alchemistry пишет:<br>сделай в хуке этом своем однопоточном CopyFile </I><br>Да вот надо попробовать.Я на самом деле не пойму почему у меня ничего не копируется в CreateFile.<br><b>Расшифровка виртуальной файловой системы производится драйвером,абсолютно прозрачно для целевого приложения.Оно просто напросто знать не знает,какой ему файл подсунули - зашифрованный или расшифрованный.</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314929&amp;user=33320&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=20" class="addthx" data-post="314929"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Johnny    Mnemonic[/b]','')">Johnny    Mnemonic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.4 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.52'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=27403">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 22:29 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('Johnny    Mnemonic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Johnny    Mnemonic" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
свиновод<br>иди на ...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314930&amp;user=27403&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=21" class="addthx" data-post="314930"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]CodeMaster[/b]','')">CodeMaster</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.64'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33320">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 22:51 <br><script type="text/javascript">QU('CodeMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=CodeMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
<b>Johnny    Mnemonic</b><br>Вступайте и компилируйте:<br><img src="http://ic.pics.livejournal.com/svinovod2012/49577432/6924/6924_original.png" border="0" align="" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314932&amp;user=33320&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=22" class="addthx" data-post="314932"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2012 23:20 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20521&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
Автор регулярно становится ржакой для всего форума, получает пинка, но быстро бежит обратно. Но ничего, клоуны иногда тоже нужны. Собственно, очередной пинок, с нетерпением запасаемся поп-корном и ждём лулзов от другого ника, как он будет снова городить свой велосипед с квадратными колёсами, не имея знаний ни про одну из его деталей.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=314935&amp;user=1556&amp;forum_n=6&amp;topic=20521&amp;page=1&amp;anchor=23" class="addthx" data-post="314935"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3691" title="30-11-2012 03:41, ранг:65.3" target="_blank">ZaZa</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=20521&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=20521&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Не работает inject dll (исходник прилагается)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=20521" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
