<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Хук API в стартующем процессе - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Мне нужно захучить функцию DirectInput8Create, для того чтобы иметь возможность подменять результаты некоторых функций IDirectInput8. Но, я хочу это сделать так чтобы моя программа, стартовала указанную и хучила">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=55802'>JustLife</a>, <a target='_blank' href='?action=userinfo&amp;user=2094'>2nd</a>, <a target='_blank' href='?action=userinfo&amp;user=33192'>morgot</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=27081'>CDK123</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Хук API в стартующем процессе</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2009 10:10 &middot; Поправил: Hexxx <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Мне нужно захучить функцию DirectInput8Create, для того чтобы иметь возможность подменять результаты некоторых функций IDirectInput8. Но, я хочу это сделать так чтобы моя программа, стартовала указанную и хучила DirectInput8Create только в ней. Глобальный хук мне не нужен. Проблема в том, что DirectInput8Create может быть в импорте, а может быть, что вызывается через LoadLibrary - GetProcAddress. Поэтому хук импорта отпадает. Можно конечно прописаться в AppInitDlls, но мне этот метод ненравится, если моя DLL что-то будет делать не так, система ляжет. <br><br>Вся фигня в том, что DirectInput8Create обычно всего один раз на старте программы вызывается и все, дальше уже ничего не сделать. <br><br>Есть идеи как можно направлено хучить функцию в указаном процессе во время его старта?
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=239963&amp;user=10168&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=1" class="addthx" data-post="239963"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2009 10:32 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Создавай приостановленный процесс, выделяй в нем память и переключай EP в контексте на нее, далее туда записывай загрузчик который загрузит необходимую dll и установит хук (обработчик там же в загрузчике отдельной функцией) далее отдать управление на OEP
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=239967&amp;user=2981&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=2" class="addthx" data-post="239967"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2009 10:59 <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Посмотри AdvApiHook by MsRem
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=239970&amp;user=11974&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=3" class="addthx" data-post="239970"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2009 11:15 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Если с фанатизмом, то можно исрользовать простой цикл отладки, т.е. пишешь мини-отладчик, на ЕР лепишь int3, когда получаешь исключение breakpoint, а адрес, по которому оно произошло, равен ЕР+1, то это как раз оно, всё остальное - EXCEPTION_NOT_HANDLED, когда такое произошло, то если либа статически прилинкована, то она уже в АП процесса и можно перехватывать, если она подгружается динамически, то на ЕР можно внедрить базонезависимый код, который её подгрузит, а потом перехватить. Далее под ХР и старше - -DebugActiveProcessStop, в остальных - младших версиях, чистим значение DebugPort в EPROCESS целевого процесса. Где-то так...
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=239971&amp;user=6336&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=4" class="addthx" data-post="239971"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]DarkWolf[/b]','')">DarkWolf</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12385">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2009 11:33 <br><script type="text/javascript">QU('DarkWolf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DarkWolf" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Если глобально - то Flint и ARCHANGEL правы.<br><br>Но, если нужна именно DirectInput8Create: Посмотри дизасм: она читает данные с реестра и, если нужно, подгружает dinput8d.dll (типа - debug версию). Потом идёт попытка вызвать функцию DirectInput8Create из dinput8d.dll. НО-если функции DirectInput8Create там нету, dinput8d.dll из памяти не выгружается! <br>Напиши свою dinput8d.dll, запиши правильный ключ в реестре, а из своей DllMain() поставишь хуки/поменяешь значения в памяти.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=239972&amp;user=12385&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=5" class="addthx" data-post="239972"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2009 11:39 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Продолжим рубрику &quot;с фанатизмом&quot;<img src="img/smilies/s1.gif" alt="">. Можно править таблицу импорта, т.е. добавить туда свой IMAGE_IMPORT_DESCRIPTOR, это делается для того, чтоб билиотека, в которой мы желаем перехватить функцию, грузилась статически. Тогда можно не заморачиваться с базонезависимостью.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=239973&amp;user=6336&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=6" class="addthx" data-post="239973"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2009 16:19 &middot; Поправил: Hexxx <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Спасибо. Мне вариант флинта понравился. <br><br>Моя идея немного модифицированная. Запускаем процесс в suspended. Пишем свой код, который загрузит нужный хук. Патчим EP джампом на свой код. А в конце своего код, а делаем возврат к EP. Отпускаем процесс.
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=239980&amp;user=10168&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=7" class="addthx" data-post="239980"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2009 19:29 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
в целевом процессе до выполнения EP вызываешь такой код:<br><br>* LoadLibrary для Dinput8.dll - библиотека подгружается в память<br>* хукаешь DirectInput8Create<br>* отпускаешь процесс<br><br>всё
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=239993&amp;user=1379&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=8" class="addthx" data-post="239993"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2009 19:40 &middot; Поправил: Nightshade <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Удалено
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=239995&amp;user=4618&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=9" class="addthx" data-post="239995"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2009 19:43 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Лучше меняй в новом процессе eip на свой код, а в конце пиши джамп на оеп. Или просто меняй еп на свой код. Потом в памяти можно поменять назад, если заботит крк. Вставлять джамп на свой код на еп - значит заморачиватся с анализом длин команд. Проще изменить еп.<br>Можно хучить импорт и грузить библу вручную. Можно хучить экспорт. Можно положить библу с прописаннным хуком в папку, но ты привяжешься к винде.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=239996&amp;user=4618&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=10" class="addthx" data-post="239996"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]uinor[/b]','')">uinor</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.83'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22383">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2009 19:53 &middot; Поправил: uinor <br><script type="text/javascript">QU('uinor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=uinor" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Если не говорить концептуально, а стремиться только к реализации:<br><br>У madshi.net был, кстати, пример хука для DX. madHooks - удобная вещь (если Delphi/Builder, но вроде умеет и с остальным).<br><br>+ Возможно вот <noindex><a href="http://www.deep-shadows.com/hax/3DRipperDX.htm#Download" rel="nofollow" target="_blank">--&gt; это &lt;--</a></noindex> поможет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=239999&amp;user=22383&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=11" class="addthx" data-post="239999"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]sendersu[/b]','')">sendersu</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 512.7 (<b>!</b>), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.56'>Активность: 0.27<span style='color:red'>&searr;</span>0.03</span><br>Статус: <a href="action=userinfo&amp;user=14629">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2009 20:30 <br><script type="text/javascript">QU('sendersu','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sendersu" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
DirectX Logger у rustema (black_ninja) можно посмотреть
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=240003&amp;user=14629&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=12" class="addthx" data-post="240003"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 сентября 2009 16:48 <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>Nightshade пишет:<br>Лучше меняй в новом процессе eip на свой код, а в конце пиши джамп на оеп. Или просто меняй еп на свой код. Потом в памяти можно поменять назад, если заботит крк. Вставлять джамп на свой код на еп - значит заморачиватся с анализом длин команд. Проще изменить еп. </I><br>А я что написал?<br><br><I>sendersu пишет:<br>DirectX Logger у rustema (black_ninja) можно посмотреть </I><br>Если с сорцами то интересно. А где взять?
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240027&amp;user=10168&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=13" class="addthx" data-post="240027"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 сентября 2009 17:44 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Зачем же такие извращения. Отладчик получит сообщение при проецировании файловой секции. Туда записывайте останов и всё на этом.<br><b>Hexxx</b><br>Вобщем если импорт динамический, тогда необходимо отслеживать <b>LdrGetProcedureAddress()</b>. Например шим-нотификация(<b>g_pfnSE_GetProcAddress</b>, <b>LdrInitShimEngineDynamic()</b>). Или точек останова на загрузчик поставить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=240081&amp;user=17964&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=14" class="addthx" data-post="240081"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2009 04:58 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>Hexxx пишет:<br>Патчим EP джампом на свой код. А в конце своего код, а делаем возврат к EP. Отпускаем процесс. </I><br>Это не совсем надежно, т.к. до исполнения EP могут исполняться TLS и загружаться статически импортируемые dll программы, откуда может быть вызван DirectInput8Create. Для надежного хука нужно инжектировать кусок базонезависимого кода и править EIP первого потока процесса до его запуска. <br>Базонезависимый код, используя только ф-и ntdll, перехватывает NtMapViewOfSection для отслеживания загрузки dll, и патчит экспорты dinput8.dll сразу после создания соответствующей ей секции.<br>Для работы базонезависимому коду потребуется как минимум адреса NtMapViewOfSection и NtProtectVirtualMemory, которые можно взять простым GetProcAddress в своём процессе.<br><br>Внимание: использование чего-либо кроме ntdll недопустимо, ибо вносит непредсказуемые глюки. Запускать процесс под отладкой не советую, оно может и проще, но не универсально, т.к. игра может содержать антиотладку.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240099&amp;user=12867&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=15" class="addthx" data-post="240099"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Rustem[/b]','')">Rustem</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 74.1 (постоянный), 34thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.41'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1301">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2009 08:42 <br><script type="text/javascript">QU('Rustem','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rustem" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
А если просто закинуть в папку с прогой свою dinput.dll С экспортом? Прокси длл короче<br>А из нее уже подгружать оригинальную
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=240106&amp;user=1301&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=16" class="addthx" data-post="240106"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2009 09:03 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>Clerk пишет:</b><br><i class=x>Зачем же такие извращения. Отладчик получит сообщение при проецировании файловой секции. Туда записывайте останов и всё на этом.</i><br>Наверное, имелось ввиду, что отладчик получает сообщение при подгрузке библиотеки. Ну, тогда да, такие извраты не требуются. Всё хорошо и гладко, пока не используются антидебаговые трюки, тогда в отладчике загрузки библиотеки можно никогда и не дождаться.<img src="img/smilies/s1.gif" alt=""><br><b>Rustem пишет:</b><br><i class=x>А если просто закинуть в папку с прогой свою dinput.dll С экспортом? Прокси длл короче<br>А из нее уже подгружать оригинальную</i><br>Если не ошибаюсь, данный метод пришёл на этот топик из &quot;Программирования драйверов и систем безопасности&quot; Сорокиной и компании - вот это действительно не было людям покоя. А если библиотека, которую мы хотим заменить, системная - например, ntdll.dll? А если она просто грузится статически? Люди, которые это написали, слышали вообще про Windows File Protection, порядок поиска динамических модулей для загрузки, проактивную защиту антивирусов? Нормально работать это будет только в приложении, где требуется перехватывать функции из самопальных библиотек.<br><b>ntldr пишет:</b><br><i class=x>...до исполнения EP могут исполняться TLS и загружаться статически импортируемые dll программы, откуда может быть вызван DirectInput8Create.</i><br>Могут, но это, к счастью, не очень часто происходит.<br><i class=x>Запускать процесс под отладкой не советую, оно может и проще, но не универсально, т.к. игра может содержать антиотладку.</i><br>Смелое, но мне кажется, безосновательное утверждение. Ничего не мешает, используя, Debug API, остановиться на начале TLS Callback, т.к. первый int3 лежит в недрах загрузчика и срабатывает раньше этого колбэка, и раньше нехороших DllEntryPoint&#039;ов нехороших билиотек. А после перехвата отладчик можно (и нужно) отсоединить.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240107&amp;user=6336&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=17" class="addthx" data-post="240107"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Rustem[/b]','')">Rustem</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 74.1 (постоянный), 34thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.41'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1301">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2009 11:41 <br><script type="text/javascript">QU('Rustem','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rustem" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>ARCHANGEL</b> Под задачу ТС вполне подойдет метод прокси-длл
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=240115&amp;user=1301&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=18" class="addthx" data-post="240115"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]SLV[/b]','')">SLV</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 309.8 (мудрец), 21thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.69'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=663">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2009 12:50 <br><script type="text/javascript">QU('SLV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SLV" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
&gt; Люди, которые это написали, слышали вообще про Windows File Protection, порядок поиска динамических модулей для загрузки, проактивную защиту антивирусов<br>Какой-то поток сознания <img src="img/smilies/s1.gif" alt=""> Клерк всё верно сказал, создание секции это самый удобный момент. <br>Или можно прочитать ключ Shell из реестра и похукатьв процессе шела функции запуска процесса.
<br><br><font size="1"><i>-----<br>Shalom ebanats!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240116&amp;user=663&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=19" class="addthx" data-post="240116"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2009 16:21 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Существует 7 событий при которых отладчику доставляется сообщение. Проецирование секции одно из таких событий. Другое это если срабатывает точка останова.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=240129&amp;user=17964&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=20" class="addthx" data-post="240129"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2009 17:21 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Могут, но это, к счастью, не очень часто происходит. </I><br>ИМХО если делать, то надо делать правильно, а не надеяться на авось. В серьезном продукте всякие &quot;не очень часто&quot; всегда вылезают в огромный гимор.<br><br><I>ARCHANGEL пишет:<br>Смелое, но мне кажется, безосновательное утверждение. Ничего не мешает, используя, Debug API, остановиться на начале TLS Callback, т.к. первый int3 лежит в недрах загрузчика и срабатывает раньше этого колбэка, и раньше нехороших DllEntryPoint&#039;ов нехороших билиотек. А после перехвата отладчик можно (и нужно) отсоединить. </I><br>Когда кажется, крестится надо. Единственный смысл запуска под отладкой в том, чтобы отслеживать загрузку DLL через debug евенты, а для этого процесс должен быть под отладкой постоянно, что автоматически тянет за собой многочисленные проблемы с антиотладкой, решить которые будет труднее, чем сделать по моему совету.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240132&amp;user=12867&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=21" class="addthx" data-post="240132"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2009 13:17 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>ntldr</b><br>Покрестившись до боли в запястье, вернулся к решению вопроса. <img src="img/smilies/s1.gif" alt=""> <br><i class=x>Единственный смысл запуска под отладкой в том, чтобы отслеживать загрузку DLL через debug евенты</i><br>Без обид - полный бред. Зачем нужны эти ивенты, когда следует выполнить перехват функций конкретной библиотеки? Дождались один раз, пока она подгрузится, перехватили, отсоединились. А что там дальше происходит - не наши проблемы. Или имеется ввиду, что на перехватываем функцию ставится точка останова? Но зачем? Таким способом перехват делать - лишний геморрой.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240175&amp;user=6336&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=22" class="addthx" data-post="240175"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2009 13:34 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Без обид - полный бред. </I><br>Без обид, но почитайте MSDN и подучите матчасть.<br><br><I>ARCHANGEL пишет:<br>Зачем нужны эти ивенты, когда следует выполнить перехват функций конкретной библиотеки? </I><br>Хотелось бы вам напомнить, что иногда стоит подумать, прежде чем сказать. И если чуток подумать, то станет ясно, что нельзя перехватывать ф-и библиотеки, если она еще не загружена в процесс, а загрузиться и выгрузиться любая DLL, за редким исключением, может в любой момент. Если еще немного подумать и почитать главу MSDN посвященную Debugging Events, то можно обратить внимание на LOAD_DLL_DEBUG_EVENT. Ну а если до конца включить мозги, то можно даже допереть, что использование этого евента - это единственная причина для запуска процесса под отладкой, и такой подход упрощает написание кода. Если же мы не используем  LOAD_DLL_DEBUG_EVENT, то нам не нужно запускать процесс с флагом DEBUG_PROCES, и этим мы избежим множества проблем с антиотладкой, что я и пытаюсь вам растолковать. Надеюсь до вас дошло, больше повторять не буду.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240177&amp;user=12867&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=23" class="addthx" data-post="240177"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2009 13:41 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>ntldr</b><br>Ну прям как на разных языках. Тут дальше спорить бесполезно, каждый всё равно останется при своём мнении, тем более, автор, думаю, уже давно определился с методом.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240178&amp;user=6336&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=24" class="addthx" data-post="240178"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2009 16:46 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15021.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Сосредоточтесь. Повторяю сообщение доставляется не при загрузке модуля, а при проецировании файловой секции:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">NtMapViewOfSection<span class="hl_char">(</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;Status&nbsp;<span class="hl_char">=</span>&nbsp;MmMapViewOfSection&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span>PVOID<span class="hl_char">)</span><span class="hl_function">Section</span><span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process</span><span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">&amp;</span>CapturedBase<span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZeroBits</span><span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CommitSize</span><span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">&amp;</span>CapturedOffset<span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">&amp;</span>CapturedViewSize<span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InheritDisposition</span><span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AllocationType</span><span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Win32Protect</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>NT_SUCCESS<span class="hl_char">(</span>Status<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span>Status&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;STATUS_CONFLICTING_ADDRESSES<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span><span class="hl_function">Section</span><span class="hl_char">-</span><span class="hl_char">&gt;</span><span class="hl_function">Segment</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>ControlArea<span class="hl_char">-</span><span class="hl_char">&gt;</span>u<span class="hl_char">.</span>Flags<span class="hl_char">.</span>Image<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>Process&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;CurrentProcess<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;{</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DbgkMapViewOfSection&nbsp;<span class="hl_char">(</span><span class="hl_function">Section</span><span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CapturedBase</span><span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CapturedOffset</span><span class="hl_char">.</span>LowPart<span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CapturedViewSize</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;ErrorReturn<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Any&nbsp;time&nbsp;the&nbsp;current&nbsp;process&nbsp;maps&nbsp;an&nbsp;image&nbsp;file<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;a&nbsp;potential&nbsp;debug&nbsp;event&nbsp;occurs<span class="hl_char">.</span>&nbsp;DbgkMapViewOfSection</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;handles&nbsp;these&nbsp;events<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">Section</span><span class="hl_char">-</span><span class="hl_char">&gt;</span><span class="hl_function">Segment</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>ControlArea<span class="hl_char">-</span><span class="hl_char">&gt;</span>u<span class="hl_char">.</span>Flags<span class="hl_char">.</span>Image<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>Process&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;CurrentProcess<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>Status&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;STATUS_IMAGE_NOT_AT_BASE<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DbgkMapViewOfSection&nbsp;<span class="hl_char">(</span><span class="hl_function">Section</span><span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CapturedBase</span><span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CapturedOffset</span><span class="hl_char">.</span>LowPart<span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CapturedViewSize</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}</li>        </ol>
    </div>
</div></div>
<br>Как думаете что в <b>Eip</b> контекста - верно, адрес возврата(если быстрый, то <b>KiFastSystemCallRet</b>) из сервиса <b>NtMapViewOfSection</b>. Это обусловлено тем, что сообщение доставляется из ядра, а в трап-фрейм загружен адрес возврата есчо при сохранении состояния задачи. Никаких других сообщений при/после загрузки модуля отладчик не получит, то - единственное <img src="img/smilies/s11.gif" alt="">.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=240190&amp;user=17964&amp;forum_n=6&amp;topic=15021.html&amp;page=0&amp;anchor=25" class="addthx" data-post="240190"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Хук API в стартующем процессе</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15021" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
