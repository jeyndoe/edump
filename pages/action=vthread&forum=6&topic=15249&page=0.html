<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Несоответсвие между кодом программы в FASM и кодом в OllyDbg - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте. У меня проблема. Пишу программу и в отладчике увидел несоответсвие между кодом программы в FASM и кодом в OllyDbg Код в FASM Code:       format&nbsp;pe&nbsp;gui&nbsp;4.0entry&nbsp;startinclude&nbsp;'win32ax.inc'&nbsp">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Несоответсвие между кодом программы в FASM и кодом в OllyDbg</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Corsag21[/b]','')">Corsag21</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.7'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=22944">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 октября 2009 15:28 &middot; Поправил: Corsag21 <br><script type="text/javascript">QU('Corsag21','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Corsag21" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15249.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте. У меня проблема. Пишу программу и в отладчике увидел несоответсвие между кодом программы в FASM и кодом в OllyDbg<br><br>Код в FASM<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>format</b></span>&nbsp;pe&nbsp;gui&nbsp;<span class="hl_number">4</span><span class="hl_char">.</span><span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_function"><b>entry</b></span>&nbsp;start</li><li class="hl_l0"><span class="hl_function"><b>include</b></span>&nbsp;<span class="hl_quote">'win32ax.inc'</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>section</b></span>&nbsp;<span class="hl_quote">'.data'</span>&nbsp;<span class="hl_function"><b>data</b></span>&nbsp;<span class="hl_function"><b>readable</b></span>&nbsp;<span class="hl_function">writeable</span></li><li class="hl_l1">hProc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">PID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">numberRead&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">hWnd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">len&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;0xFF</li><li class="hl_l0">ipBase&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">ipBuf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">ent&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_number">006e587fh</span></li><li class="hl_l0">PROCESS_VM_READ&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_number">0010</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>section</b></span>&nbsp;<span class="hl_quote">'.code'</span>&nbsp;<span class="hl_function"><b>code</b></span>&nbsp;<span class="hl_function"><b>readable</b></span>&nbsp;<span class="hl_function">executable</span></li><li class="hl_l1">start<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_function"><b>invoke</b></span>&nbsp;FindWindow<span class="hl_char">,</span><span class="hl_quote">'MraWClass'</span><span class="hl_char">,</span><span class="hl_function">NULL</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_char">[</span>hWnd<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_function"><b>invoke</b></span>&nbsp;GetWindowThreadProcessId<span class="hl_char">,</span><span class="hl_char">[</span>hWnd<span class="hl_char">]</span><span class="hl_char">,</span>PID</li><li class="hl_l1"><span class="hl_function"><b>invoke</b></span>&nbsp;OpenProcess<span class="hl_char">,</span><span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROCESS_VM_READ<span class="hl_char">,</span><span class="hl_char">\</span>&nbsp;&nbsp;<span class="hl_comment">; __in  DWORD dwDesiredAccess  PROCESS_VM_READ (0x0010)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">FALSE</span><span class="hl_char">,</span><span class="hl_char">\</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; __in  BOOL bInheritHandle</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span>PID<span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; __in  DWORD dwProcessId</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_char">[</span>hProc<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_comment">;cmp eax,0</span></li><li class="hl_l1"><span class="hl_comment">;je error</span></li><li class="hl_l0"><span class="hl_function"><b>invoke</b></span>&nbsp;&nbsp;&nbsp;&nbsp;GlobalAlloc<span class="hl_char">,</span>GMEM_MOVEABLE&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;GMEM_ZEROINIT<span class="hl_char">,</span>len</li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_char">[</span>ipBuf<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_char">[</span>ipBase<span class="hl_char">]</span><span class="hl_char">,</span>ent</li><li class="hl_l1"><span class="hl_function"><b>invoke</b></span>&nbsp;ReadProcessMemory<span class="hl_char">,</span><span class="hl_char">[</span>hProc<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_char">[</span>ipBase<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_char">[</span>ipBuf<span class="hl_char">]</span><span class="hl_char">,</span>len<span class="hl_char">,</span>numberRead</li><li class="hl_l0"><span class="hl_function"><b>invoke</b></span>&nbsp;CloseHandle<span class="hl_char">,</span><span class="hl_char">[</span>hProc<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_comment">;jmp finish</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_comment">;error:</span></li><li class="hl_l0"><span class="hl_comment">;invoke MessageBox,NULL,'Error','Error',NULL</span></li><li class="hl_l1"><span class="hl_comment">;invoke ExitProcess,0</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_comment">;finish:</span></li><li class="hl_l0"><span class="hl_comment">;invoke MessageBox,NULL,ipBuf,ipBuf,NULL</span></li><li class="hl_l1"><span class="hl_function"><b>invoke</b></span>&nbsp;ExitProcess<span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>section</b></span>&nbsp;<span class="hl_quote">'.idata'</span>&nbsp;<span class="hl_function"><b>import</b></span>&nbsp;<span class="hl_function"><b>data</b></span>&nbsp;<span class="hl_function"><b>readable</b></span>&nbsp;<span class="hl_function">writeable</span></li><li class="hl_l0"><span class="hl_function"><b>library</b></span>&nbsp;kernel32<span class="hl_char">,</span>&nbsp;<span class="hl_quote">'KERNEL32.DLL'</span><span class="hl_char">,</span><span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user32<span class="hl_char">,</span>&nbsp;&nbsp;&nbsp;<span class="hl_quote">'USER32.DLL'</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>import</b></span>&nbsp;kernel32<span class="hl_char">,</span><span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExitProcess<span class="hl_char">,</span>&nbsp;<span class="hl_quote">'ExitProcess'</span><span class="hl_char">,</span><span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OpenProcess<span class="hl_char">,</span>&nbsp;<span class="hl_quote">'OpenProcess'</span><span class="hl_char">,</span><span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GlobalAlloc<span class="hl_char">,</span>&nbsp;<span class="hl_quote">'GlobalAlloc'</span><span class="hl_char">,</span><span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadProcessMemory<span class="hl_char">,</span>&nbsp;<span class="hl_quote">'ReadProcessMemory'</span><span class="hl_char">,</span><span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle<span class="hl_char">,</span>&nbsp;<span class="hl_quote">'CloseHandle'</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>import</b></span>&nbsp;user32<span class="hl_char">,</span><span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FindWindow<span class="hl_char">,</span>&nbsp;<span class="hl_quote">'FindWindowA'</span><span class="hl_char">,</span><span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetWindowThreadProcessId<span class="hl_char">,</span>&nbsp;<span class="hl_quote">'GetWindowThreadProcessId'</span><span class="hl_char">,</span><span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox<span class="hl_char">,</span>&nbsp;<span class="hl_quote">'MessageBoxA'</span></li>        </ol>
    </div>
</div></div>
<br><br>А вот листинг из отладчика OllyDbg<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00402000</span>&nbsp;<span class="hl_char">&gt;</span>&nbsp;<span class="hl_char">$</span>&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_number">00402002</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;E8&nbsp;<span class="hl_number">0A000000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;mra_hack<span class="hl_char">.</span><span class="hl_number">00402011</span></li><li class="hl_l0"><span class="hl_number">00402007</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">4D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DEC</b></span>&nbsp;<span class="hl_registr">EBP</span></li><li class="hl_l1"><span class="hl_number">00402008</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">72</span>&nbsp;<span class="hl_number">61</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JB</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;mra_hack<span class="hl_char">.</span><span class="hl_number">0040206B</span></li><li class="hl_l0"><span class="hl_number">0040200A</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">57</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l1"><span class="hl_number">0040200B</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">43</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>INC</b></span>&nbsp;<span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">0040200C</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">6C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INS&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">ES</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr"><b>DX</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;  I/O command</span></li><li class="hl_l1"><span class="hl_number">0040200D</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">61</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">POPAD</span></li><li class="hl_l0"><span class="hl_number">0040200E</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">73</span>&nbsp;<span class="hl_number">73</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JNB</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;mra_hack<span class="hl_char">.</span><span class="hl_number">00402083</span></li><li class="hl_l1"><span class="hl_number">00402010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DB</b></span>&nbsp;<span class="hl_number">00</span></li><li class="hl_l0"><span class="hl_number">00402011</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;FF15&nbsp;DE304000&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_char">&lt;</span><span class="hl_char">&amp;</span>USER32<span class="hl_char">.</span>FindWindowA<span class="hl_char">&gt;</span><span class="hl_char">&gt;</span><span class="hl_comment">; \FindWindowA</span></li><li class="hl_l1"><span class="hl_number">00402017</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;A3&nbsp;<span class="hl_number">0C104000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">40100C</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">0040201C</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">04104000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;mra_hack<span class="hl_char">.</span><span class="hl_number">00401004</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; /pProcessID = mra_hack.00401004</span></li><li class="hl_l1"><span class="hl_number">00402021</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;FF35&nbsp;<span class="hl_number">0C104000</span>&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">40100C</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |hWnd = 00040550 ('orsagosh93@mail.ru',class='MraWClass')</span></li><li class="hl_l0"><span class="hl_number">00402027</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;FF15&nbsp;E2304000&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_char">&lt;</span><span class="hl_char">&amp;</span>USER32<span class="hl_char">.</span>GetWindowThr<span class="hl_char">&gt;</span><span class="hl_comment">; \GetWindowThreadProcessId</span></li><li class="hl_l1"><span class="hl_number">0040202D</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;FF35&nbsp;<span class="hl_number">04104000</span>&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">401004</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; /ProcessId = DB4</span></li><li class="hl_l0"><span class="hl_number">00402033</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |Inheritable = FALSE</span></li><li class="hl_l1"><span class="hl_number">00402035</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">0A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0A</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |Access = CREATE_THREAD|VM_OPERATION</span></li><li class="hl_l0"><span class="hl_number">00402037</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;FF15&nbsp;<span class="hl_number">72304000</span>&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_char">&lt;</span><span class="hl_char">&amp;</span>KERNEL32<span class="hl_char">.</span>OpenProces<span class="hl_char">&gt;</span><span class="hl_comment">; \OpenProcess</span></li><li class="hl_l1"><span class="hl_number">0040203D</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;A3&nbsp;<span class="hl_number">00104000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">401000</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">00402042</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">10104000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;mra_hack<span class="hl_char">.</span><span class="hl_number">00401010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; /MemSize = 401010 (4198416.)</span></li><li class="hl_l1"><span class="hl_number">00402047</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">42</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">42</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |Flags = GHND</span></li><li class="hl_l0"><span class="hl_number">00402049</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;FF15&nbsp;<span class="hl_number">76304000</span>&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_char">&lt;</span><span class="hl_char">&amp;</span>KERNEL32<span class="hl_char">.</span>GlobalAllo<span class="hl_char">&gt;</span><span class="hl_comment">; \GlobalAlloc</span></li><li class="hl_l1"><span class="hl_number">0040204F</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;A3&nbsp;<span class="hl_number">18104000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">401018</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">00402054</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;C705&nbsp;<span class="hl_number">14104000</span><span class="hl_char">&gt;</span><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">401014</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">6E587F</span></li><li class="hl_l1"><span class="hl_number">0040205E</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">08104000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;mra_hack<span class="hl_char">.</span><span class="hl_number">00401008</span></li><li class="hl_l0"><span class="hl_number">00402063</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">10104000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;mra_hack<span class="hl_char">.</span><span class="hl_number">00401010</span></li><li class="hl_l1"><span class="hl_number">00402068</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DB</b></span>&nbsp;FF</li><li class="hl_l0"><span class="hl_number">00402069</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DB</b></span>&nbsp;<span class="hl_number">35</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;  CHAR '5'</span></li><li class="hl_l1"><span class="hl_number">0040206A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">18104000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DD</b></span>&nbsp;mra_hack<span class="hl_char">.</span><span class="hl_number">00401018</span></li><li class="hl_l0"><span class="hl_number">0040206E</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;FF35&nbsp;<span class="hl_number">14104000</span>&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">401014</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |pBaseAddress = 6E587F</span></li><li class="hl_l1"><span class="hl_number">00402074</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;FF35&nbsp;<span class="hl_number">00104000</span>&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">401000</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |hProcess = 00000028</span></li><li class="hl_l0"><span class="hl_number">0040207A</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;FF15&nbsp;<span class="hl_number">7A304000</span>&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_char">&lt;</span><span class="hl_char">&amp;</span>KERNEL32<span class="hl_char">.</span>ReadProces<span class="hl_char">&gt;</span><span class="hl_comment">; \ReadProcessMemory</span></li><li class="hl_l1"><span class="hl_number">00402080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DB</b></span>&nbsp;FF</li><li class="hl_l0"><span class="hl_number">00402081</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DB</b></span>&nbsp;<span class="hl_number">35</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;  CHAR '5'</span></li><li class="hl_l1"><span class="hl_number">00402082</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">00104000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DD</b></span>&nbsp;mra_hack<span class="hl_char">.</span><span class="hl_number">00401000</span></li><li class="hl_l0"><span class="hl_number">00402086</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;FF15&nbsp;<span class="hl_number">7E304000</span>&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_char">&lt;</span><span class="hl_char">&amp;</span>KERNEL32<span class="hl_char">.</span>CloseHandl<span class="hl_char">&gt;</span><span class="hl_comment">; \CloseHandle</span></li><li class="hl_l1"><span class="hl_number">0040208C</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; /ExitCode = 0</span></li><li class="hl_l0"><span class="hl_number">0040208E</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;&nbsp;FF15&nbsp;<span class="hl_number">6E304000</span>&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_char">&lt;</span><span class="hl_char">&amp;</span>KERNEL32<span class="hl_char">.</span>ExitProces<span class="hl_char">&gt;</span><span class="hl_comment">; \ExitProcess</span></li><li class="hl_l1">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br>Почему после  ReadProcessMemory идет<br>00402080      FF            DB FF<br>00402081      35            DB 35                                    ;  CHAR &#039;5&#039;<br><br>Если я правильно понимаю, то &quot;DB&quot; - это данные. Откуда они беруся в местах, где я их не писал?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=243281&amp;user=22944&amp;forum_n=6&amp;topic=15249.html&amp;page=0&amp;anchor=1" class="addthx" data-post="243281"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Bonez92[/b]','')">Bonez92</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 39.6 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.91'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17764">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 октября 2009 15:34 <br><script type="text/javascript">QU('Bonez92','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bonez92" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15249.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
OllyDbg криво анализовал опкод PUSH.<br>Как правило: PUSH DWORD PTR DS:[401014] в машинном коде так: FF35 14104000<br>Так вот ОллиДбг во время анализа почему-то считал опкод PUSH DWORD PTR DS:[401000] как DB FF, DB 35 и DD 401000.<br><br>А какая версия самого отладчика?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=243283&amp;user=17764&amp;forum_n=6&amp;topic=15249.html&amp;page=0&amp;anchor=2" class="addthx" data-post="243283"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 октября 2009 15:42 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15249.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Там олька не прально проанализировала, там идёт команда:<br><br>00402068     FF35 18104000    PUSH DWORD PTR DS:[401018]<br><br><I>Corsag21 пишет:<br>Откуда они беруся в местах, где я их не писал?  </I><br>Как эт не писал? А кто ReadProcessMemory вызывал? <img src="img/smilies/s1.gif" alt=""> Залезь в <noindex><a href="http://msdn.microsoft.com/en-us/library/ms680553(VS.85).aspx" rel="nofollow" target="_blank">MSDN</a></noindex>  и узнаешь, что при использовании этой функи передаётся 5 параметров:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">BOOL&nbsp;WINAPI&nbsp;ReadProcessMemory<span class="hl_char">(</span></li><li class="hl_l1">&nbsp;&nbsp;__in&nbsp;&nbsp;&nbsp;HANDLE&nbsp;hProcess<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;__in&nbsp;&nbsp;&nbsp;LPCVOID&nbsp;lpBaseAddress<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;__out&nbsp;&nbsp;LPVOID&nbsp;lpBuffer<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;__in&nbsp;&nbsp;&nbsp;SIZE_T&nbsp;nSize<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;__out&nbsp;&nbsp;SIZE_T&nbsp;<span class="hl_char">*</span>lpNumberOfBytesRead</li><li class="hl_l0"><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>И у тя тоже так же:<br>0040205E   .  68 08104000   PUSH mra_hack.00401008<br>00402063   .  68 10104000   PUSH mra_hack.00401010<br>00402068     FF35 18104000    PUSH DWORD PTR DS:[401018]<br>0040206E   .  FF35 14104000 PUSH DWORD PTR DS:[401014]<br>00402074   .  FF35 00104000 PUSH DWORD PTR DS:[401000]  <br>//Ну вот, а теперь вызываем функу<br>0040207A   .  FF15 7A304000 CALL DWORD PTR DS:[&lt;&amp;KERNEL32.ReadProces&gt;]
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=243287&amp;user=16624&amp;forum_n=6&amp;topic=15249.html&amp;page=0&amp;anchor=3" class="addthx" data-post="243287"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Corsag21[/b]','')">Corsag21</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.7'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=22944">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 октября 2009 16:26 &middot; Поправил: Corsag21 <br><script type="text/javascript">QU('Corsag21','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Corsag21" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15249.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
OllyDbg v 1.10<br><br>Спасибо. Теперь понятно, что это отладчик направильно опкод распознал. А то я думал, что fasm криво скомпилировал.<br><br>Опа. В отладчике сделал right_click-&gt;Analysis-&gt;During next analysis, treat selection as-&gt;doubleword. И снова Analyse code. Все встало как надо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=243294&amp;user=22944&amp;forum_n=6&amp;topic=15249.html&amp;page=0&amp;anchor=4" class="addthx" data-post="243294"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2009 01:13 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15249.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
если компилируешь по многу раз и открываешь тот же файл в отладчике, то перед этим лучше удалять соответствующий .udd файл из папки проектов OllyDbg
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=243443&amp;user=1379&amp;forum_n=6&amp;topic=15249.html&amp;page=0&amp;anchor=5" class="addthx" data-post="243443"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Corsag21[/b]','')">Corsag21</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.7'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=22944">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2009 06:45 <br><script type="text/javascript">QU('Corsag21','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Corsag21" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15249.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Понятно. По теме вопросов больше нет. Можно закрывать тему
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=243449&amp;user=22944&amp;forum_n=6&amp;topic=15249.html&amp;page=0&amp;anchor=6" class="addthx" data-post="243449"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Несоответсвие между кодом программы в FASM и кодом в OllyDbg</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15249" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
