<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как передаются аргументы в конструктор класса С++? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="push  ecx               ; dwTime push  nPID.nPID            ; nPID or   eax, 1 sub   esp, 8 mov   ecx, offset stru_4512528    ; this mov   &#036;S1, eax mov   dword ptr math, offset ??_7IExternalSath@@6B@ call  Class1            ">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=6859'>cppasm</a>, <a target='_blank' href='?action=userinfo&amp;user=55996'>dutyfree</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как передаются аргументы в конструктор класса С++?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]olia64[/b]','')">olia64</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.81'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41353">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2016 15:53 <br><script type="text/javascript">QU('olia64','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=olia64" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24345.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
push    ecx                             ; dwTime<br>push    nPID.nPID                       ; nPID<br>or      eax, 1<br>sub     esp, 8<br>mov     ecx, offset stru_4512528        ; this<br>mov     &#036;S1, eax<br>mov     dword ptr math, offset ??_7IExternalSath@@6B@<br>call    Class1                          ; вызываем конструктор класса С++ Class1::Class1()<br><br>void __thiscall Class1::Class1(Class1 *this, struc1 *s1, struc2 *s2, int nPID, unsigned int dwTime)<br><br><br>В стеке  dwTime и nPID , а где найти <br>Class1 *this, struc1 *s1, struc2 *s2  ??
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368095&amp;user=41353&amp;forum_n=5&amp;topic=24345.html&amp;page=0&amp;anchor=1" class="addthx" data-post="368095"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]kid[/b]','')">kid</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.2 (посетитель), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.46'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=27711">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2016 16:29 <br><script type="text/javascript">QU('kid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kid" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24345.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
госспади , вы же сами написали <b>__thiscall</b> , почитать о соглашениях вызова не ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368096&amp;user=27711&amp;forum_n=5&amp;topic=24345.html&amp;page=0&amp;anchor=2" class="addthx" data-post="368096"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]olia64[/b]','')">olia64</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.81'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41353">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2016 16:46 &middot; Поправил: olia64 <br><script type="text/javascript">QU('olia64','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=olia64" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24345.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>kid пишет:госспади , вы же сами написали __thiscall , почитать о соглашениях вызова не ?  </I><br>Без Господа никак?<br><br>Соглашение о вызовах __thiscall используется для функций-членов. Оно по умолчанию используется функциями членами C++, в которых не используются переменные-аргументы.  В соглашении о вызовах __thiscall вызываемый метод очищает стек, что невозможно для функций vararg.  В архитектуре x86 аргументы отправляются в стек справа налево, причем указатель this передается через регистр ECX, а не помещается в стек.  <br><br>Как в этом соглашении передаются указатели на структуры и классы?<br>Тут вроде все понятно:<br>push ecx ; dwTime<br>push nPID.nPID ; nPID<br>or eax, 1<br>sub esp, 8<br>mov ecx, offset stru_4512528 ; this<br><br>А тут что происходит? <br>mov &#036;S1, eax<br>mov dword ptr math, offset ??_7IExternalSath@@6B@<br><br>Как передаются указатели на структуры???
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368097&amp;user=41353&amp;forum_n=5&amp;topic=24345.html&amp;page=0&amp;anchor=3" class="addthx" data-post="368097"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]kid[/b]','')">kid</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.2 (посетитель), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.46'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=27711">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2016 17:10 &middot; Поправил: kid <br><script type="text/javascript">QU('kid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kid" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24345.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
что такое указатель? - DWORD<br>как его передать через стек ? - push DWORD<br>куда ложится указатель на инициализированный класс ? - mov ecx,DWORD <br><br><I>olia64 пишет:<br>push ecx ; dwTime<br>push nPID.nPID ; nPID<br>or eax, 1<br>sub esp, 8<br>mov ecx, offset stru_4512528 ; this </I> <br>(далее должен быть колл на функу класса условно sub_xxxx)<br>это можно интерпритировать как <br>stru_4512528-&gt;sub_xxxx(nPID,dwTime)<br><br><I>olia64 пишет:<br>А тут что происходит? <br>mov &#036;S1, eax<br>mov dword ptr math, offset ??_7IExternalSath@@6B@ </I><br><br>ну первая инструкция без предыстории мало что говорит , вторая инструкция ложит в память по указателю math указатель на ??_7IExternalSath@@6B@<br><br><b>Добавлено спустя 1 минуту</b><br>а вообще ваша вежливость конечно просто на высоте .<br><br><b>Добавлено спустя 18 минут</b><br>Прошу прощения не вчитался в заголовок первый пост .<br>sub esp, 8 - ваши два других аргумента
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368098&amp;user=27711&amp;forum_n=5&amp;topic=24345.html&amp;page=0&amp;anchor=4" class="addthx" data-post="368098"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]olia64[/b]','')">olia64</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.81'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41353">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2016 17:29 <br><script type="text/javascript">QU('olia64','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=olia64" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24345.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>kid пишет:<br>это можно интерпритировать как<br>stru_4512528-&gt;sub_xxxx(nPID,dwTime) </I><br>Нельзя это так интерпретировать, потому что вызов процедуры совершенно четкий<br>void __thiscall Class1::Class1(Class1 *this, struc1 *s1, struc2 *s2, int nPID, unsigned int dwTime)<br>Непонятно как передаются указатели s1 и s2 в общем случае в С++ , как вы заметили __thiscall<br>В стеке только <br>push ecx ; dwTime<br>push nPID.nPID ; nPID<br><br>Получается, что через регистры. Мне подумалось что есть какой то общий механизм передачи указателей на структуры в __thiscall<br>ведь аргументов могло быть намного больше чем регистров.<br><I>kid пишет:<br>а вообще ваша вежливость конечно просто на высоте .  </I><br>Моя вежливость или ваше высокомерие или быть может религиозность?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368099&amp;user=41353&amp;forum_n=5&amp;topic=24345.html&amp;page=0&amp;anchor=5" class="addthx" data-post="368099"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]kid[/b]','')">kid</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.2 (посетитель), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.46'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=27711">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2016 17:33 <br><script type="text/javascript">QU('kid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kid" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24345.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>olia64 пишет:<br>Моя вежливость или ваше высокомерие или быть может религиозность?  </I><br><br>где то было высокомерие ? вот от ваших слов прям разит какой то быдловатостью.<br>вы считаете что вам обязаны все рассказать ? <br><br><br><I>olia64 пишет:<br>Нельзя это так интерпретировать, потому что вызов процедуры совершенно четкий<br>void __thiscall Class1::Class1(Class1 *this, struc1 *s1, struc2 *s2, int nPID, unsigned int dwTime) </I><br><br>ну то что вы верите тому что выплюнула IDA как первой инстанции , то считайте что ваших вторых два аргумента - потенциально просто мусор в стеке .(sub esp, 8 - ваши два других аргумента )<br><br><br><I>olia64 пишет:<br>Получается, что через регистры. Мне подумалось что есть какой то общий механизм передачи указателей на структуры в __thiscall<br>ведь аргументов могло быть намного больше чем регистров. </I><br>1. В соглашении о вызове ясно сказано что только ECX и только для указателя на экземпляр класса .<br>2. И не стоит слепо верить в то что ИДА верно определила соглашение , зачастую это не так .<br><br><b>Добавлено спустя 2 минуты</b><br>и какой нафиг механиз передачи на структуры или просто дворды ??? указатель это дворд ,от того как вы его используете зависит что это , указатель или тупо int , или bool etc.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368100&amp;user=27711&amp;forum_n=5&amp;topic=24345.html&amp;page=0&amp;anchor=6" class="addthx" data-post="368100"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]olia64[/b]','')">olia64</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.81'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41353">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2016 17:46 <br><script type="text/javascript">QU('olia64','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=olia64" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24345.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>kid пишет:<br>вот от ваших слов прям разит какой то быдловатостью.<br></I><br>Например где? Про господа ты начал сам писать.<br>Спасибо я тоже увидел сейчас sub esp, 8  и  прочитал про ECX <br>Вопрос закрыт. Спасибо kid.<br>PS: Половина форума каких то понторезов тут, судя по жаргону лет 16-ти.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368101&amp;user=41353&amp;forum_n=5&amp;topic=24345.html&amp;page=0&amp;anchor=7" class="addthx" data-post="368101"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как передаются аргументы в конструктор класса С++?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24345" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
