<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Легальный способ запретить снятие скриншота - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Приветствую всех! Не так давно (2 года назад) реализовал такой запрет. Думаю, все знают или догадались уже, как я это сделал Обычные хуки функций получения hdc окна и копирования из одного в другой... Вот 2мя часами ранее">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a>, <a target='_blank' href='?action=userinfo&amp;user=55940'>exp50848</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Легальный способ запретить снятие скриншота</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 августа 2011 20:31 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Приветствую всех!<br><br>Не так давно (2 года назад) реализовал такой запрет. Думаю, все знают или догадались уже, как я это сделал <img src="img/smilies/s1.gif" alt=""> Обычные хуки функций получения hdc окна и копирования из одного в другой... Вот 2мя часами ранее интересно стало - а нет ли чего интересного в механизме копирования битмапов?<br><br>Покопался... кажется есть законный способ запретить скриншот окна/экрана, безо всяких инжектов и перехватов. В win32k!NtGdiBitBlt, которая вызывается из BitBlt, перед копированием битмапа производится ряд проверок, в том числе вызывается неэкпотрируемая win32k!UserScreenAccessCheck, где проверяются права. Если таких прав нет, то юзверь получает ERROR_INVALID_HANDLE. Внутри этой функи вызывается nt!PsGetProcessWin32Process - получается указатель на WIN32_PROCESS(по другим данным PROCESSINFO), затем проводятся проверки:<br>(Win32Process-&gt;+0x3C == _grpdeskRitInput || (Win32Process-&gt;+0x48 &amp; 8)) &amp;&amp; !(Win32Process-&gt;+0x8 &amp; 0x40010) - если true - есть доступ...<br><br>Хз, что за структура WIN32_PROCESS (или PROCESSINFO), но в инете нашёл много дезы по ней... Пока установил, что она не меньше, чем 0x194 байта, по смещению 0 указатель на _EPROCESS, по смещению 0xC указатель на _KEVENT...<br><br>Покопался ещё немного, получить структуру WIN32_PROCESS кроме как из _ETHREAD.Win32process, можно также через ядерную таблицу HWND-хендлов окон, где хранятся указатели на структуры, в которых хранится этот WIN32_PROCESS - видимо владелец... Не ошибаюсь ли я, что есть её юзермод-копия? - как-то вроде пробегал по окнам, кажется какую-то таблицу в юзермоде видел...<br><br>Может, кто-то уже копал в эту сторону? Подскажите, если я где-то не прав.<br><br>Нечто нашёл здесь http://indy-vx.narod.ru/log.txt
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=290306&amp;user=24257&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=1" class="addthx" data-post="290306"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 августа 2011 21:01 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
стяни наконецто себе исходники win2k и не мучайся
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290309&amp;user=15381&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=2" class="addthx" data-post="290309"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]vptrlx[/b]','')">vptrlx</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 56.1 (постоянный), 9thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.91'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22056">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 августа 2011 21:06 <br><script type="text/javascript">QU('vptrlx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vptrlx" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
PROCESSINFO сильно поменялась с win 2000. общее представление можно получить оттуда, но оффсеты ни капли не совпадут.<br>Та часть структуры, которой интересовался я, отвечала за взаимодействие win32k и ядра
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290310&amp;user=22056&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=3" class="addthx" data-post="290310"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 августа 2011 21:16 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>reversecode</b>, та нету там. Кстати, там только 10-ая часть, похоже. А может и ещё меньше...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=290313&amp;user=24257&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=4" class="addthx" data-post="290313"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 августа 2011 21:33 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
ох уж этот гугл<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">\</span></li><li class="hl_l1"><span class="hl_char">*</span>&nbsp;UserScreenAccessCheck</li><li class="hl_l0"><span class="hl_char">*</span></li><li class="hl_l1"><span class="hl_char">*</span>&nbsp;Called&nbsp;from&nbsp;the&nbsp;engine&nbsp;to&nbsp;determine&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;the&nbsp;thread's desktop is</li><li class="hl_l0"><span class="hl_char">*</span>&nbsp;active&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;the&nbsp;process&nbsp;has&nbsp;WINSTA_READSCREEN&nbsp;access<span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">*</span></li><li class="hl_l0"><span class="hl_char">*</span>&nbsp;Note&nbsp;that&nbsp;we&nbsp;may&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;may&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;be&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;USER's critical section when this</li><li class="hl_l1"><span class="hl_char">*</span>&nbsp;is&nbsp;called<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_function"><b>This</b></span>&nbsp;is&nbsp;OK&nbsp;as&nbsp;long&nbsp;as&nbsp;we&nbsp;don't reference thing belonging</li><li class="hl_l0"><span class="hl_char">*</span>&nbsp;to&nbsp;other&nbsp;threads<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_function"><b>If</b></span>&nbsp;we&nbsp;did&nbsp;<span class="hl_function"><b>try</b></span>&nbsp;to&nbsp;<span class="hl_function"><b>enter</b></span>&nbsp;the&nbsp;critical&nbsp;<span class="hl_function"><b>section</b></span>&nbsp;here<span class="hl_char">,</span></li><li class="hl_l1"><span class="hl_char">*</span>&nbsp;a&nbsp;deadlock&nbsp;may&nbsp;occur&nbsp;between&nbsp;the&nbsp;engine&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;user<span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_char">*</span></li><li class="hl_l1"><span class="hl_char">*</span>&nbsp;History<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_char">*</span>&nbsp;<span class="hl_number">05</span><span class="hl_char">-</span><span class="hl_number">20</span><span class="hl_char">-</span><span class="hl_number">93</span>&nbsp;JimA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Created<span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">*</span>&nbsp;<span class="hl_number">11</span><span class="hl_char">-</span><span class="hl_number">22</span><span class="hl_char">-</span><span class="hl_number">96</span>&nbsp;BradG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Brought&nbsp;back&nbsp;to&nbsp;life<span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_char">\</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">/</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">BOOL&nbsp;FASTCALL&nbsp;UserScreenAccessCheck<span class="hl_char">(</span><span class="hl_function">VOID</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;UserAssert<span class="hl_char">(</span>PtiCurrentShared<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_char">(</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PtiCurrentShared<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;PtiCurrentShared<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>rpdesk&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;grpdeskRitInput&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>W32GetCurrentProcess<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>W32PF_Flags&nbsp;<span class="hl_char">&amp;</span>&nbsp;<span class="hl_char">(</span>W32PF_READSCREENACCESSGRANTED&nbsp;<span class="hl_char">|</span>&nbsp;W32PF_IOWINSTA<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>W32PF_READSCREENACCESSGRANTED&nbsp;<span class="hl_char">|</span>&nbsp;W32PF_IOWINSTA<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=290315&amp;user=15381&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=5" class="addthx" data-post="290315"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 августа 2011 21:44 &middot; Поправил: bowrouco <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Бесполезно. На сколько помню это ядро регает хоткей в контексте винлогона. Конечно это можно просто обойти, но это не будет проблемой, как обычно если механизм защиты известен. Пока есть десктоп, всегда его битмапу можно получить.<br><br>&gt; есть законный способ запретить скриншот окна/экрана, безо всяких инжектов и перехватов.<br>А есчо есть песочница, которая никогда никем не юзалась, даже мс, но встроена в ядро. Достаточно её запустить, как все левые(абсолютно все, хуки, нотифи етц) манипуляции с шадовом отваляться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290316&amp;user=29629&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=6" class="addthx" data-post="290316"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 августа 2011 22:20 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>bowrouco пишет:</b><br><i class=x>А есчо есть песочница, которая никогда никем не юзалась, даже мс, но встроена в ядро. Достаточно её запустить, как все левые(абсолютно все, хуки, нотифи етц) манипуляции с шадовом отваляться.</i><br><br>Да только вы, вроде бы как, писали, что механизм её работы до конца неизвестен. Уже выяснили? + немного оффтопа: <b>Indy</b>, это вы??
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=290319&amp;user=6336&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=7" class="addthx" data-post="290319"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 августа 2011 22:38 &middot; Поправил: bowrouco <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Ктож вам признается <img src="img/smilies/s2.gif" alt=""><br>У вас есть ядро, есть дизасм - вперёд. Это не сложно, про не известно - это нет констант просто.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290322&amp;user=29629&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=8" class="addthx" data-post="290322"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 августа 2011 04:20 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>reversecode</b><br>Это есть в исходниках W2K. <img src="img/smilies/s1.gif" alt=""> <br><br>И даже больше<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;#define&nbsp;PtiCurrent<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;&nbsp;<span class="hl_char">(</span>gptiCurrent<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;#define&nbsp;PtiCurrentShared<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span>PTHREADINFO<span class="hl_char">)</span><span class="hl_char">(</span>W32GetCurrentThread<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">#define&nbsp;PpiCurrent<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span>PPROCESSINFO<span class="hl_char">)</span><span class="hl_char">(</span>W32GetCurrentProcess<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">#define&nbsp;PtiFromThread<span class="hl_char">(</span>Thread<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span>PTHREADINFO<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_char">(</span>Thread<span class="hl_char">)</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>Tcb<span class="hl_char">.</span>Win32Thread<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">#define&nbsp;PpiFromProcess<span class="hl_char">(</span>Process<span class="hl_char">)</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span>PPROCESSINFO<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_char">(</span>PW32PROCESS<span class="hl_char">)</span><span class="hl_char">(</span>Process<span class="hl_char">)</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>Win32Process<span class="hl_char">)</span><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br><br>Касательно самой PROCESSINFO <b>vptrlx</b> прав, поэтому ближе всех с реактоса<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#define&nbsp;CLIBS&nbsp;<span class="hl_number">32</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">typedef&nbsp;struct&nbsp;_PROCESSINFO</li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x000&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;W32PROCESS<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span>&nbsp;begin<span class="hl_char">:</span>&nbsp;USER&nbsp;specific&nbsp;fields</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x078&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PTHREADINFO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptiList<span class="hl_comment">;               // threads in this process</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x07C&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PTHREADINFO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptiMainThread<span class="hl_comment">;         // pti of &quot;main thread&quot;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x080&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PDESKTOP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rpdeskStartup<span class="hl_comment">;         // initial desktop</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x084&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PCLS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pclsPrivateList<span class="hl_comment">;       // this processes' private classes</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x088&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PCLS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pclsPublicList<span class="hl_comment">;        // this processes' public classes</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x08C&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PWOWPROCESSINFO&nbsp;pwpi<span class="hl_comment">;                  // Wow PerProcess Info</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x090&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PPROCESSINFO&nbsp;&nbsp;&nbsp;&nbsp;ppiNext<span class="hl_comment">;               // next ppi structure in start list</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x094&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PPROCESSINFO&nbsp;&nbsp;&nbsp;&nbsp;ppiNextRunning<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x098&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cThreads<span class="hl_comment">;              // count of threads using this process info</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x09C&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;HDESK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdeskStartup<span class="hl_comment">;          // initial desktop handle</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x0A0&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;UINT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cSysExpunge<span class="hl_comment">;           // sys expunge counter</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x0A4&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwhmodLibLoadedMask<span class="hl_comment">;   // bits describing loaded hook dlls</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x0A8&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;HANDLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ahmodLibLoaded<span class="hl_char">[</span>CLIBS<span class="hl_char">]</span><span class="hl_comment">; // process unique hmod array for hook dlls</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x128&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PWINDOWSTATION&nbsp;&nbsp;prpwinsta<span class="hl_comment">;             // process windowstation</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x12C&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;HWINSTA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hwinsta<span class="hl_comment">;               // windowstation handle</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x130&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;ACCESS_MASK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;amwinsta<span class="hl_comment">;              // windowstation accesses</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x134&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwHotkey<span class="hl_comment">;              // hot key from progman</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x138&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;HMONITOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hMonitor<span class="hl_comment">;              // monitor handle from CreateProcess</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x13C&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PDESKTOPVIEW&nbsp;&nbsp;&nbsp;&nbsp;pdvList<span class="hl_comment">;               // list of desktop views</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x140&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;UINT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iClipSerialNumber<span class="hl_comment">;     // clipboard serial number</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x144&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;RTL_BITMAP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmHandleFlags<span class="hl_comment">;         // per handle flags</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x14C&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PCURSOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pCursorCache<span class="hl_comment">;          // process cursor/icon cache</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x150&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PVOID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pClientBase<span class="hl_comment">;           // LEAVE THIS FOR HYDRA; offset to the shared section</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x154&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwLpkEntryPoints<span class="hl_comment">;      // user mode language pack installed</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x158&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PW32JOB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pW32Job<span class="hl_comment">;               // pointer to the W32JOB structure</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x15C&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwImeCompatFlags<span class="hl_comment">;      // per-process Ime Compatibility flags</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;from&nbsp;ImmCreateContext<span class="hl_char">-</span><span class="hl_char">&gt;</span>NtUserGetThreadState&nbsp;#13</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x160&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;LUID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;luidSession<span class="hl_comment">;           // logon session id</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x168&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;USERSTARTUPINFO&nbsp;usi<span class="hl_comment">;                   // process startup info</span></li><li class="hl_l1">&nbsp;&nbsp;#ifdef&nbsp;VALIDATEHANDLEQUOTA</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;LONG&nbsp;lHandles<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;#endif</li><li class="hl_l0">&nbsp;&nbsp;#ifdef&nbsp;USE_MIRRORING</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwLayout<span class="hl_comment">;                   // the default Window orientation for this process</span></li><li class="hl_l0">&nbsp;&nbsp;#endif</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x18C&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PPROCESS_HID_TABLE&nbsp;pHidTable<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x190&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;BOOL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WindowsGhosting<span class="hl_comment">;       // _DisableProcessWindowsGhosting</span></li><li class="hl_l1">}&nbsp;PROCESSINFO<span class="hl_char">,</span>&nbsp;<span class="hl_char">*</span>PPROCESSINFO<span class="hl_comment">; // W32ProcessSize == 0x198 Xp size.</span></li>        </ol>
    </div>
</div></div>
<br><br>Смущает только строчка <b>W32ProcessSize == 0x198 Xp size</b>, хотя видно, что 0x194.<br><br>А W32PROCESS в W2K вообще нет. Взята с реактоса - на первый взгляд всё сходится: найденные указатели, проверка длины структуры по следующим за ней спискам тредов<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">typedef&nbsp;struct&nbsp;_W32PROCESS</li><li class="hl_l1">&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x000&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PEPROCESS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peProcess<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x004&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RefCount<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x008&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;FLONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W32PF_flags<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x00C&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PKEVENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputIdleEvent<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x010&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StartCursorHideTime<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x014&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PW32PROCESS&nbsp;&nbsp;&nbsp;NextStart<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x018&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PVOID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pDCAttrList<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x01c&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PVOID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pBrushAttrList<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x020&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W32Pid<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x024&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GDIHandleCount<span class="hl_comment">;  // Gdi handle count per process. Ref in NtUserGetGuiResources.</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x028&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UserHandleCount<span class="hl_comment">; // User handle count per process.  &quot;  &quot;  &quot;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x02C&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;PEX_PUSH_LOCK&nbsp;GDIPushLock<span class="hl_comment">;     // Locking Process during access to structure.</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x030&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;RTL_AVL_TABLE&nbsp;GDIEngUserMemAllocTable<span class="hl_comment">; // Process AVL Table.</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x068&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;LIST_ENTRY&nbsp;&nbsp;&nbsp;&nbsp;GDIDcAttrFreeList<span class="hl_comment">;       // Tag 'Gdcf' size 44 bytes. HmgAllocateDcAttr</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;0x070&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;LIST_ENTRY&nbsp;&nbsp;&nbsp;&nbsp;GDIBrushAttrFreeList<span class="hl_comment">;    // Tag 'Gbaf' size 0x2B4 bytes. HmgAllocateObjectAttr</span></li><li class="hl_l1">&nbsp;}&nbsp;W32PROCESS<span class="hl_char">,</span>&nbsp;<span class="hl_char">*</span>PW32PROCESS<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br><I>bowrouco пишет:<br>Бесполезно. На сколько помню это ядро регает хоткей в контексте винлогона </I><br>ммм... насколько я помню, конкретно ReigisterHotKey в контексте винлогона вызывается только для Ctrl-Alt-Del и ещё кучки комбинаций... так и не понял тогда, для чего они... Посему удачен любой вызов для любой комбинации с Print Screen. Но это не вызвало труда... Цель: запретить копирование битмапа окна одного процесса или всего экрана в окно другого. Перехватив кучку функций, на 100% цели не добиваемся - есть ещё десяток, а там может и ещё... непосредственно с видеокарты можно снять...<br><br>Просто ради интереса копнул поглубже и показалось, что что-то нашёл... Ну если <b>bowrouco </b>, считает, что по другому нельзя - нет сейчас времени тратить впустую... Кстати, попробовал запустить песочницу - видимо одного EnforceUISandbox мало...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=290330&amp;user=24257&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=9" class="addthx" data-post="290330"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 августа 2011 07:40 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>DenCoder</b><br>Почему же мало ?<br><br>Вполне достаточно:<br>xxxSnapWindow() -&gt; xxxOpenClipboard() -&gt; CheckClipboardAccess() -&gt; AllowAccessUISandbox()
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290333&amp;user=29629&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=10" class="addthx" data-post="290333"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Enigma[/b]','')">Enigma</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 88.3 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.58'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8396">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 августа 2011 11:44 <br><script type="text/javascript">QU('Enigma','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Enigma" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Что если дровинку какую нибудь небольшую написать, которая просто будет скрывать процесс (скрин которого делать нельзя) полностью из ring3?<br><br>nProtect так делает для игр, только для других целей.<br><br>А при первой установки программы пользователям, спрашивать права администратора для установки дровины.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290340&amp;user=8396&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=11" class="addthx" data-post="290340"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 августа 2011 12:10 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>Enigma пишет:<br>Что если дровинку какую нибудь небольшую написать, </I><br><br>и сделают с тобой тоже, что с автором SecureBook.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290342&amp;user=2585&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=12" class="addthx" data-post="290342"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 августа 2011 12:14 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Говорю банальности, но DRM зло, а DRM с дровиной следует приравнять к руткиту с занесением в антивирусные базы.<br><br><I>Gideon Vi пишет:<br>и сделают с тобой тоже, что с автором SecureBook. </I><br>А что с ним такое?
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=290344&amp;user=12867&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=13" class="addthx" data-post="290344"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Enigma[/b]','')">Enigma</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 88.3 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.58'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8396">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 августа 2011 12:41 <br><script type="text/javascript">QU('Enigma','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Enigma" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>Gideon Vi пишет:<br>и сделают с тобой тоже, что с автором SecureBook. </I><br><br>Со мной ничего делать не надо, я тоже дрова не люблю.<br><br>А вот судя по nProtect и кол-ву пользователей игр которые им защищаются - проблем никаких нет.<br><br><I>Gideon Vi пишет:<br>и сделают с тобой тоже, что с автором SecureBook. </I><br><br>И да, что там такое случилось? На сайте все вроде как даже наоборот, все отлично.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290348&amp;user=8396&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=14" class="addthx" data-post="290348"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 августа 2011 13:18 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>Enigma пишет:<br>И да, что там такое случилось? На сайте все вроде как даже наоборот, все отлично.<br> </I><br>http://securebook.ru/securebook/neskolko_slov_ob_antivirusah.html
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290353&amp;user=5291&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=15" class="addthx" data-post="290353"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Enigma[/b]','')">Enigma</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 88.3 (постоянный), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.58'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8396">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 августа 2011 13:22 &middot; Поправил: Enigma <br><script type="text/javascript">QU('Enigma','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Enigma" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>Vovan666 пишет:<br>http://securebook.ru/securebook/neskolko_slov_ob_antivirusah.html </I><br><br>Обычная реакция на протекторы, ничего нового...<br><br>Если смотреть с этой стороны, то тут шаг в лево шаг вправо - вот тебе и ложный детект от антивирусников. Функцию какую нибудь перехватил у себя же в процессе, и будет такой же эффект.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290354&amp;user=8396&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=16" class="addthx" data-post="290354"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 августа 2011 15:47 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>bowrouco пишет:<br>Вполне достаточно:xxxSnapWindow() -&gt; xxxOpenClipboard() -&gt; CheckClipboardAccess() -&gt; AllowAccessUISandbox() </I><br>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows]<br>EnforceUISandbox = 1: DWORD<br><br>Нужно ещё что-то дополнительно указать?
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=290375&amp;user=24257&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=17" class="addthx" data-post="290375"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2011 04:47 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>ntldr пишет:<br>А что с ним такое? </I><br><br>а то самое:<br><br><I>ntldr пишет:<br>DRM с дровиной следует приравнять к руткиту с занесением в антивирусные базы. </I><br><br>в первую очередь слили вебу. И автор сколько угодно может разоряться на своем сайте, но пока ебук будет требовать ставить левую дровину с функциями руткита, нормальные пользователи должны требовать манибек у продавца книжки.<br><br><I>Enigma пишет:<br>А вот судя по nProtect и кол-ву пользователей игр которые им защищаются - проблем никаких нет. </I><br><br>и есть хоть одна европейская mmorg под этой поделкой?<br><br><I>Enigma пишет:<br>Обычная реакция на протекторы, ничего нового... </I><br><br>антивирусы орут не на исполняемый файл, а на дров.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290443&amp;user=2585&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=18" class="addthx" data-post="290443"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=2212" title="27-08-2011 03:44, ранг:103.0" target="_blank">NaumLeNet</a>, <a href="action=userinfo&user=12867" title="27-08-2011 05:09, ранг:247.4" target="_blank">ntldr</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2011 08:19 &middot; Поправил: bowrouco <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>Enigma</b><br>&gt; будет скрывать процесс (скрин которого делать нельзя) полностью из ring3?<br>А толку от этого ?<br>Итак шадов по большей части перенесён в ядро. Процесс это обьект, обьекты связанные с ним не связаны с его наличием. Тоесть удаляем запись из списков, из слепка етц, это никак не отразится на эвенте или окне..<br><br>&gt; Функцию какую нибудь перехватил у себя же в процессе, и будет такой же эффект.<br>Ну патч это вредоносная технология. Вообще следует запрещать запись в кодосекции, релокацию и настройку IAT выполнять в ядре. Кстате подумаю над этим, ведь если это сделать, то фактически всё негодное отвалится, зевсы всякие и прочая недомалварь, для которой патч лежит в основе жизнидеятельности.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290447&amp;user=29629&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=19" class="addthx" data-post="290447"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 августа 2011 05:36 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>bowrouco пишет:<br>Вообще следует запрещать запись в кодосекции, релокацию и настройку IAT выполнять в ядре. </I><br>Ну а как тогда прикручивать/менять сетевой функционал к несетевому софту, например? <img src="img/smilies/s1.gif" alt=""> Многая часть заработков лишится, Вы что? <img src="img/smilies/s1.gif" alt=""> А самое главное - как тогда костыли для m&#036;-продуктов писать? <img src="img/smilies/s5.gif" alt=""><br><br><I>bowrouco пишет:<br>Тоесть удаляем запись из списков, из слепка етц, это никак не отразится на эвенте или окне.. </I><br>С этим согласен. Кажется, на текущий момент на каждый метод скрытия есть метод обнаружения. Я прав? Если пофантазировать - можно было бы свои объекты &quot;процесс&quot; и &quot;поток&quot; создать, отличные от системных, что скрыло бы нас от огромного числа глаз, но не от всех... Но фактически это равносильно переписанию и внедрению нового ядра - переключение контекстов, синхронизация, графика... <img src="img/smilies/s1.gif" alt=""><br><br><b>bowrouco</b>, так как? - Есть всё же легальный способ запретить программное снятие скриншота экрана/окна? ) <I>bowrouco пишет:<br>Пока есть десктоп, всегда его битмапу можно получить. </I><br>нууу? В своём проекте я не запрещал получение hdc от окон других процессов (explorer в этом просто нуждается, а также без этого стили пропадут), но запрещал для полученных таким способом операции копирования. Минус только один - перехваты...<br><br>Нет времени пока посмотреть - проверка вызовом UserScreenAccessCheck внутри NtGdiBitBlt разве не посылает процесс при каких-то условиях? ) Обратил внимание на флаги - кто-то ведь их раздаёт процессам при обращении в гуи...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=290501&amp;user=24257&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=20" class="addthx" data-post="290501"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 августа 2011 07:16 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>bowrouco пишет:<br>Ну патч это вредоносная технология. Вообще следует запрещать запись в кодосекции, релокацию и настройку IAT выполнять в ядре. Кстате подумаю над этим, ведь если это сделать, то фактически всё негодное отвалится, зевсы всякие и прочая недомалварь, для которой патч лежит в основе жизнидеятельности. </I><br>Бггг профи пофиг где копать под ring0 или под rin3 , а вот кол-во бсодов увеличется в разы я вам это гарантирую,<br><I>Enigma пишет:<br>А вот судя по nProtect и кол-ву пользователей игр которые им защищаются - проблем никаких нет </I><br>Что nProtect что Gameshild ломается на раз,только страдают легальные пользователи у которых зависает игра и чтобы её отключить, приходится ребутить компьютер <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=290504&amp;user=17432&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=21" class="addthx" data-post="290504"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 августа 2011 12:24 &middot; Поправил: bowrouco <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>DenCoder</b><br>&gt; проверка вызовом UserScreenAccessCheck внутри NtGdiBitBlt разве не посылает процесс при каких-то условиях? ) Обратил внимание на флаги - кто-то ведь их раздаёт процессам при обращении в гуи... <br><br>Это опенсурсный код:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">xxxSetProcessWindowStation<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>RtlAreAllAccessesGranted<span class="hl_char">(</span>ohi<span class="hl_char">.</span>GrantedAccess<span class="hl_char">,</span>&nbsp;WINSTA_READSCREEN<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ppi<span class="hl_char">-</span><span class="hl_char">&gt;</span>W32PF_Flags&nbsp;<span class="hl_char">|</span><span class="hl_char">=</span>&nbsp;W32PF_READSCREENACCESSGRANTED<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ppi<span class="hl_char">-</span><span class="hl_char">&gt;</span>W32PF_Flags&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">=</span>&nbsp;~W32PF_READSCREENACCESSGRANTED<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li>        </ol>
    </div>
</div></div>
<br><br>Например для csrss этот бит устанавливается при создании RIT.<br><br>В xxxSnapWindow() тоже вначале проверяются права для WinSta. Установить нужный дескриптор безопасности и будет блочится доступ. Только это не надёжно, имея админские права можно забыть про эти ограничения.<br><br>Это именованный обьект(\Windows\WindowStations\WinSta0 etc), устанавливается в UserThreadCallout() наверно, есть сервисы для работы с ним:<br>NtUserOpenWindowStation<br>NtUserCloseWindowStation<br>NtUserCreateWindowStation<br>NtUserGetProcessWindowStation<br>NtUserSetProcessWindowStation<br>NtUserLockWindowStation<br>NtUserUnlockWindowStation<br>NtUserSetWindowStationUser<br>Есть виньапи обёртка:<br>http://msdn.microsoft.com/en-us/library/ms687107(v=VS.85).aspx<br><br>Это ваш легальный путь, для которого обходной путь также легален <img src="img/smilies/s3.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=290519&amp;user=29629&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=22" class="addthx" data-post="290519"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24257" title="28-08-2011 15:13, ранг:113.8" target="_blank">DenCoder</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]kmax[/b]','')">kmax</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.57'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=33527">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 декабря 2012 19:04 <br><script type="text/javascript">QU('kmax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kmax" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Очень извиняюсь за некропостинг. Интересует эта же тема, а конкретно предложение bowrouco. Кто-нибудь пытался реализовать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=315624&amp;user=33527&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=23" class="addthx" data-post="315624"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Alchemistry[/b]','')">Alchemistry</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 145.8 (ветеран), 190thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.05'>Активность: 0.14<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=21411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 декабря 2012 20:19 &middot; Поправил: Alchemistry <br><script type="text/javascript">QU('Alchemistry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alchemistry" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>kmax</b><br><br>Он предлагал изменение Security объекта WinSta0 -&gt; Read Screen, очевидно на запрет т.к. по умолчанию оно не проставлено вообще (для текущего пользователя). <br><br>WINSTA_READSCREEN который тут описан в общем предназначен для интерактивных подключений. Предоставлять интерактивному пользователю доступ к экрану или нет. ЕМНИП на мсдн даже пример есть, входа пользователя (LogonUser) и задания ему полных прав на доступ к интерактивной станции.<br><br>Простой эксперимент, ну например на XP. WinObjEx умеет редактировать Security WinSta0, разлистывая все доступные права. Ставишь там галочку &quot;Запретить&quot; для Read Screen для текущего пользователя, применяешь и пытаешься запустить что-нибудь с гуем. Наслаждаешься  инфарктом графической подсистемы. В общем он нес бред от незнания матчасти и последствий.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=315627&amp;user=21411&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=24" class="addthx" data-post="315627"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Exaktus_[/b]','')">Exaktus_</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.9 (новичок), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.5'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8987">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2012 06:46 <br><script type="text/javascript">QU('Exaktus_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Exaktus_" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>bowrouco пишет:<br>А есчо есть песочница, которая никогда никем не юзалась, даже мс, но встроена в ядро. </I><br>А где можно почитать об этом?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=315642&amp;user=8987&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=25" class="addthx" data-post="315642"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Alchemistry[/b]','')">Alchemistry</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 145.8 (ветеран), 190thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.05'>Активность: 0.14<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=21411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2012 11:12 &middot; Поправил: Alchemistry <br><script type="text/javascript">QU('Alchemistry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alchemistry" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<b>Exaktus_</b><br><br>Нигде. Это была заготовка для UIPI, реализованного в Vista. <br>http://blogs.msdn.com/b/vishalsi/archive/2006/11/30/what-is-user-interface-privilege-isolation-uipi-on-vista.aspx<br><br>+ http://msdn.microsoft.com/en-us/windows7trainingcourse_uipi_unit.aspx<br><br>Но поскольку товарищ bowrouco он же Инде Клерк на своем пентиуме 4 не может поставить ничего кроме Windows XP он решил, что это некий могучий сандбокс и нес бред про это на куче форумов, включая этот.<br><br>Почитать про некоторую реализацию UIPI можно в пдф в аттаче.<br><br><img src="img/attach.gif" alt=""> <a href="./files/e4f3_16.12.2012_EXELAB.rU.tgz">e4f3_16.12.2012_EXELAB.rU.tgz</a> - Vista_UIPI.ppt.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=315646&amp;user=21411&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=26" class="addthx" data-post="315646"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=8987" title="18-12-2012 17:20, ранг:19.5" target="_blank">Exaktus_</a>, <a href="action=userinfo&user=24257" title="07-02-2013 01:59, ранг:117.4" target="_blank">DenCoder</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2012 12:02 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=18945.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
/me усаживается поудобнее
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=315648&amp;user=2585&amp;forum_n=1&amp;topic=18945.html&amp;page=0&amp;anchor=27" class="addthx" data-post="315648"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Легальный способ запретить снятие скриншота</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#28" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="18945">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=18945" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
