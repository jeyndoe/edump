<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>UEFI руткиты - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Собираем в этой теме инфу по UEFI руткитам и трюкам. Начало серии постов ntldr о руткитах: --&gt; Link &lt;-- LoJax - руткит Статья на русском: - LoJax: первый известный UEFI руткит, используемый во вредоносной кампании Документ">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=247'>NIKOLA</a>, <a target='_blank' href='?action=userinfo&amp;user=42610'>r0lka</a>, <a target='_blank' href='?action=userinfo&amp;user=19256'>johnniewalker</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> UEFI руткиты</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=2&amp;topic=25409&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=2&amp;topic=25409&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=2&amp;topic=25409&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=2&amp;topic=25409&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2018 17:00 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Собираем в этой теме инфу по UEFI руткитам и трюкам.<br><br>Начало серии постов ntldr о руткитах:<br><noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#2" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br><b>LoJax</b> - руткит<br><br>Статья на русском:<br>- <noindex><a href="https://habr.com/company/eset/blog/425251/" rel="nofollow" target="_blank">LoJax: первый известный UEFI руткит, используемый во вредоносной кампании</a></noindex><br><br>Документ на английском:<br>- <noindex><a href="https://www.welivesecurity.com/wp-content/uploads/2018/09/ESET-LoJax.pdf" rel="nofollow" target="_blank">ESET-LoJax.pdf</a></noindex>
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388514&amp;user=1379&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=1" class="addthx" data-post="388514"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31053" title="23-10-2018 18:44, ранг:27.6" target="_blank">yashechka</a>, <a href="action=userinfo&user=3400" title="17-12-2018 19:59, ранг:1.5" target="_blank">WildGoblin</a>, <a href="action=userinfo&user=3520" title="27-03-2019 22:20, ранг:633.9" target="_blank">mak</a></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 декабря 2018 15:45 &middot; Поправил: ntldr <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
Основной источник информации о UEFI - исходники EDK и коммерческих биосов. Основной источник информации о компонентах винды - дизассемблер IDA.<br><br>Как будет время, я постараюсь изложить в этом топике свои представления о нескольких разных подходах к созданию UEFI руткитов. Достоинства, недостатки и некоторые проблемные места. В частности есть способы прыгнуть из EFI модуля сразу в ядро ОС уже после его загрузки. Без дрочива с патчем бутлоадеров. Есть и вообще тупой вариант как взять и запихнуть в биос любой первый попавшийся троян (привет разработчикам Computrace, чтоб им всем икалось!).<br><br><b>Добавлено спустя 5 часов 4 минуты</b><br>Сразу оговорюсь: нижеизложенное в этом и последующий постах не является руководством по написанию вредоносных программ. Это теоретические рассуждения на основе открытых данных. Описанные подходы также применимы в разработке инструментов для реверсинга и информационной безопасности.<br>Будет несколько постов, рассмотрим разработку кода под legacy BIOS, затем как устроены классические буткиты, потом отличия и особенности гипотетических зловредов под UEFI.<br><br>Начнём с вопроса написания программ под BIOS такого рода как загрузчики, резидентные коды (такие как обработчики дискового шифрования) ну и буткиты тоже. На чём и как писать?<br><br>Самое очевидное решение - писать на ассемблере под 16ти битный реалмод. Годится для Джедаев ассемблера, трудно совместимо со сколь-нибудь сложным функционалом. Пример такого кода - резидентный загрузчик от DiskCryptor 0.2.5b. Все нужные алгоритмы (в том числе криптография) пишутся базонезависимым ассемблерным кодом и компилятся сразу в бинарник для секторов MBR или в модуль legacy BIOS. Берёте каменный топор и вырубаете все вручную. Ещё можно откопать на кладбище древний MS Visual C++ 1.5 и писать на каком-никаком но всё-же си. Более современных инструментов разработки - нет и не будет.<br><br>Если всё-же хочется писать с комфортом на нормальном языке, использовать возможности современных компиляторов и иметь возможность применять готовые куски кода - нужно собирать под 32х битный x86 любым удобным компилятором а затем конвертировать PE модуль в бинарник простого формата, который в свою очередь загружается ассемблерным предзагрузчиком и работает в защищенном режиме. Ассемлерная часть небольшая, она обеспечивает простейший интерфейс модуля с внейшней средой. В случае DiskCryptor - это функции для вызова реалмодовых функций с передачей и возвратом контекста, а так-же интерфейс для обратного вызова. 32х битный код может вызывать 16ти битные прерывания BIOS и может обрабатывать хуки 16ти битных прерываний в 32х битном режиме. Поверх этого весь функционал пишется на современном си, без заморочек. Текущую версию загрузчика DiskCryptor, проект под VS2015 и инструменты для сборки (конвертор PEшников в бинарник и fasm для ассемблерной части) так-же выкладываю здесь.<br><br>Исходники к посту:<br><noindex><a href="https://diskcryptor.net/_temp/dcrypt_0.2.5b_boot-src.zip" rel="nofollow" target="_blank">dcrypt_0.2.5b_boot-src.zip</a></noindex><br><noindex><a href="https://diskcryptor.net/_temp/dcrypt_new_boot.zip" rel="nofollow" target="_blank">dcrypt_new_boot.zip</a></noindex>
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=389870&amp;user=12867&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=2" class="addthx" data-post="389870"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39556" title="15-12-2018 16:24, ранг:74.2" target="_blank">sefkrd</a>, <a href="action=userinfo&user=1379" title="16-12-2018 12:07, ранг:574.3" target="_blank">Jupiter</a>, <a href="action=userinfo&user=4773" title="16-12-2018 22:06, ранг:381.0" target="_blank">plutos</a>, <a href="action=userinfo&user=3400" title="17-12-2018 20:03, ранг:1.5" target="_blank">WildGoblin</a>, <a href="action=userinfo&user=41324" title="21-12-2018 11:52, ранг:5.3" target="_blank">superakira</a>, <a href="action=userinfo&user=35473" title="24-12-2018 04:05, ранг:383.0" target="_blank">dosprog</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2018 09:58 <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<I>superakira пишет:<br>там на немецком </I><br><br>Там много и на английском (диаграммы, listings, etc.).<br>А остальной текст легко переводится google translate. Фразы короткие и ясные. <br>главное - терпение...
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=389888&amp;user=4773&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=3" class="addthx" data-post="389888"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 декабря 2018 08:02 &middot; Поправил: plutos <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
<I>ntldr пишет:<br> Текущую версию загрузчика DiskCryptor, проект под VS2015 и инструменты для сборки (конвертор PEшников в бинарник и fasm для ассемблерной части) так-же выкладываю здесь. </I><br><br>Пожалуйста, опишите подробно, (если можно, то пошагово) процесс сборки. А то открываю solution (dcrypt.sln), а там половины проэктов не хватает. Что-то я явно делаю не так... <img src="img/smilies/s14.gif" alt="">
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=389945&amp;user=4773&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=4" class="addthx" data-post="389945"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]superakira[/b]','')">superakira</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.82'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41324">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2018 14:56 <br><script type="text/javascript">QU('superakira','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=superakira" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<b>ntldr</b> не забывай про тред плиз. запили пост про рк в таком ключе.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=389966&amp;user=41324&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=5" class="addthx" data-post="389966"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]SegFault[/b]','')">SegFault</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 44.8 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.95'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29820">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2018 16:04 <br><script type="text/javascript">QU('SegFault','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SegFault" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
Microsoft обещает в ближайшем будущем выпустить open source код стандартизироваванного UEFI загрузчика, чтобы не было такого, что один вендор в лес, а другой по дрова
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=389967&amp;user=29820&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=6" class="addthx" data-post="389967"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]reverser[/b]','')">reverser</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 58.0 (постоянный), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.82'>Активность: 0.02<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2615">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2018 23:11 <br><script type="text/javascript">QU('reverser','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reverser" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
Не загрузчика, а самой фирмвари. Основана на стандартном edk2 но с удалением разных устарелых и небезопасных фич. А выпустили уже давно, это просто некоторые только сейчас заметили.<br><br>https://microsoft.github.io/mu/<br>https://github.com/Microsoft/mu
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=389980&amp;user=2615&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=7" class="addthx" data-post="389980"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29820" title="22-12-2018 06:39, ранг:33.6" target="_blank">SegFault</a>, <a href="action=userinfo&user=12867" title="22-12-2018 17:42, ранг:346.5" target="_blank">ntldr</a>, <a href="action=userinfo&user=4773" title="22-12-2018 21:49, ранг:382.4" target="_blank">plutos</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 декабря 2018 20:09 &middot; Поправил: ntldr <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<b>Теперь рассмотрим &quot;классический&quot; буткит.</b><br><br>Этим термином называют разновидность загрузочной малвари, которая не изменяет файловую систему на диске, а проникает внутрь ОС манипуляциями в памяти. Буткит для BIOS должен перехватывать реалмодовые прерывания INT13 и INT15.<br><br>Через INT15 ОС получает карту памяти, буткит должен разместить свою резидентную часть в верхних килобайтах базовой памяти (это та которая 0-640кб). По адресу 0x0413 лежит WORD с числом свободных килобайт. Правим его и правим карту памяти возвращаемую INT15, так чтобы в карте памяти наш диапазон адресов был E820_RESERVED. На первый взгляд ничего не мешает включить A20 рейт и разместить резидент в верхней памяти, но я не советую (будет геморрой с настройкой MTRR регистров проца, чтобы включить кеш. И ещё есть всякие проблемные биосы...).<br><br>Через INT13 ОС читает сектора диска на стадиях загрузки до монтирования системного тома. А это немалый такой набор файлов: все загрузчики, ядро, все boot start драйвера, файлы реестра BCD и SYSTEM. Всё это пролетает сквозь обработчик INT13, который ищет в потоке данных знакомые бинарные сигнатуры и патчит их на ходу. В минимальном варианте (теоретический буткит для Windows XP) ищем устойчивый участок кода ядра который вызывается после всей инициализации, вставляем туда маленький шелкод код и физический адрес блока памяти где сохранёны оригинальные байты ядра и лежит контент следующей стадии. Задача шеллкода - сделать MmMapIoSpace этого блока памяти и прыгнуть в него, в нём лежит большой шеллкод который первым делом восстанавливает байтики ядра из сохранёнки, затем разворачивает в памяти несуществующий на диске драйвер и вызывает его DriverEntry по завершению которой передается управление на начало восстановленной функции. Итог алгоритма - в ядре появился новый модуль могущий делать почти всё то-же самое что обычные драйвера. На этом заканчивается загрузочная часть, дальше идёт обычный драйверный руткит.<br><br>Более сложной будет логика буткита с поддержкой Windows 7+. Там чтобы изменить ядро, нужно сначала пропатчить bootmgr и winload.exe убрав проверку цифровой подписи файлов. bootmgr к тому-же упакован алгоритмом LZNT1 в старых версиях и MPRESS в новых. Искать сигнатуры первого нужно уже в памяти. Удобный момент для этого - первый вызов INT15 который означает что bootmgr распаковался и пытается получить карту памяти. Сканируем нижние 500кб физических адресов, он где-то там. winload и всё что после него - можно патчить в обработчике INT13 во время чтения с диска. Дополнительный бонус: на ранней стадии загрузки легко отключается защита patch guard. Патчгуард сложно вырвать с корнями когда он уже работает, но можно не допустить его инициализации имитировав загрузку под отладчиком (символы KdDebuggerNotPresent и KdPitchDebugger в секции .data ядра). Дальше пей-гуляй как в старые времена, делай хоть SSDT хуки хоть сплайсинг хоть перехват sysenter, винда всё стерпит. Помимо этого в x86 можно убрать проверку адресов обработчиков исключений на присутствие внутри модуля. Чтобы работали исключения на x64 - нужно добавить ExceptionTable виртуального модуля в PsInvertedFunctionTable ядра.<br><br>Исходники к посту: <noindex><a href="https://diskcryptor.net/_temp/signoff.7z" rel="nofollow" target="_blank">signoff.7z</a></noindex> (Патчер для отключения проверки подписи драйверов. Умеет перепаковывать bootmgr всех версий.)<br><br><b>Добавлено спустя 7 минут</b><br><b>Наконец: UEFI руткиты и буткиты.</b><br><br>UEFI буткит представляет собой EFI модуль, т.е. почти обычный PE файл. Он может быть как встроен в BIOS (предпочтительно на стадию DXE), так и загружаться с загрузочного раздела, из сети (по протоколу PXE), c CD диска, флешки, итд. Задача EFI буткита аналогичная предыдущей - внедрить свой модуль в ядро, манипулируя только памятью.<br><br>Чисто теоретически могу предложить три разных способа как пробраться из EFI модуля в ОС.<br><br><b>Первый способ:</b> перехватываем протокол EFI_BLOCK_IO_PROTOCOL_GUID для загрузочного раздела. Правим читаемые с диска байтики аналогично классическому буткиту. Подробно расписывать не буду, приложу код UEFI загрузчика DiskCryptor, там всё есть. ИМХО: тупо и нудно.<br><br><b>Второй способ:</b> последовательно патчить файлы bootmgfw.efi, winload.efi, ntoskrnl.exe. Переименовываем bootmgfw.efi и подменяем его своим файлом (либо изменяем порядок загрузки в переменных NVRAM). Наш загрузчик загружает оригинальный bootmgfw через BootServices-&gt;LoadImage и получает полный PE файл в памяти. Полный образ можно обрабатывать не только банальными сигнатурами байтиков, но и продвинутыми алгоритмами (поиск внутренних символов опираясь на релоки, на ссылки код-данные и частичное дизасcемблирование). Нас интересуют функции ImgpValidateImageHash и ImgpLoadPEImage. Достаточно найти ImgpValidateImageHash и поставить хук (который всегда возвращает rax = 0), в нём смотрим адрес возврата и находим участок ImgpLoadPEImage где вызывается функция BlEnNotifyEvent. Подменяем адрес call&#039;а BlEnNotifyEvent на свой обработчик, парсим стек на предмет указателя на PE образ (в этот момент файл полностью загружен, релоки обработаны, можно патчить). Получаем полный PE образ следующего загрузчика (которым должен быть winload.efi). Повторяем трюк с ImgpValidateImageHash / ImgpLoadPEImage, иерархия функций у winload полностью аналогичная. Похукав winload мы будем получать PE образы ядра и всех boot start драйверов по мере их загрузки. Можно менять всё что угодно. Код, данные, точки входа. Патчить ядро в этом варианте не обязательно.<br><br><b>Модификация второго способа для EFI модуля встраиваемого в BIOS:</b> на DXE стадии загрузки подписываемся на событие EFI_EVENT_SIGNAL_READY_TO_BOOT. В обработчике события перехватываем BootServices-&gt;LoadImage. В обработчике LoadImage детектим загрузку bootmgfw и производим вышеназванные манипуляции. Всё.<br><br>Ключевое преимущество этого способа - доступ к полным PE модулям целиком, а не по частям. Это простор для эвристических алгоритмов поиска нужных частей кода. К примеру в теле функции ImgpValidateImageHash есть ссылки вида <b>mov edx, offset a1_3_6_1_4_1__0 ; &quot;1.3.6.1.4.1.311.61.4.1</b>, <b>mov edx, offset a1_3_6_1_4_1__2 ; &quot;1.3.6.1.4.1.311.61.5.1&quot;</b>, сама собой напрашивается эвристика &quot;ищем mov r32, offset, на offset&#039;е мова стоит релок, offset указывает в секцию .rdata, по адресу offset читается строка 1.3.6.1.4.1.311.61.4.1&quot;. Нашли инструкции по эвристике, сканируем вниз до retn 14h (удостовериться что совпадает число параметров), сканируем вверх до пролога функции. Такие эвристики покрывают сразу много версий системных файлов и с большой вероятностью будут работать со следующими версиями.<br><br><b>Третий способ:</b> спецификация UEFI поддерживает runtime сервисы, это функции EFI модулей которые может вызывать ОС уже после загрузки. Рантайм сервисы, их EFI модули и связанная с ними память остаются жить после ExitBootServices. Windows 8+ поддерживает эти фичи и вызывает EFI_RUNTIME_SERVICES-&gt;GetVariable, EFI_RUNTIME_SERVICES-&gt;SetVariable. Поймав такой вызов и пройдя по адресу возврата мы попадём в кодовую секцию hal. От этой отправной точки - дело техники распарсить структуры и добраться до API ядра. Применяем набор стандартных приёмов написания шелкода, как для local root эксплоитов.<br><br>Преимущество этого способа - можно прыгнуть из BIOS сразу в ядро, не нужно дрочиться с сигнатурами. Недостаток - не работает в Windows 7, нельзя пропатчить инициализацию ядра (PatchGuard и иже с ним).<br><br>Исходники к посту: <noindex><a href="https://diskcryptor.net/_temp/DC_UEFI_CURRENT.7z" rel="nofollow" target="_blank">DC_UEFI_CURRENT.7z</a></noindex>. Исходники, бинарники, отладочные символы.<br><br><b>Добавлено спустя 9 минут</b><br>PS: извиняюсь за путанное описание. Задавайте уточняющие вопросы.<br><br><b>Добавлено спустя 54 минуты</b><br><b>Универсальный способ запихнуть произвольное говно в BIOS или загрузчик:</b><br><br><b>Дано:</b> примитив для HDD block IO позволяющий читать/писать на блочные устройства. К примеру в legacy BIOS загрузчике DiskCryprtor есть такой набор функций:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">uint32_t&nbsp;dc_find_hdds<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">bool&nbsp;hdd_io<span class="hl_char">(</span>uint8_t&nbsp;hdd_n<span class="hl_char">,</span>&nbsp;<span class="hl_function">void</span><span class="hl_char">*</span>&nbsp;buff<span class="hl_char">,</span>&nbsp;uint16_t&nbsp;sectors<span class="hl_char">,</span>&nbsp;uint64_t&nbsp;start<span class="hl_char">,</span>&nbsp;bool&nbsp;read<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>Работает с жесткими дисками и USB накопителями. Доступ идёт на уровне диска.<br><br>В UEFI есть EFI_BLOCK_IO_PROTOCOL со сладкими функами:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">typedef</li><li class="hl_l1">EFI_STATUS</li><li class="hl_l0"><span class="hl_char">(</span>EFIAPI&nbsp;<span class="hl_char">*</span>EFI_BLOCK_READ<span class="hl_char">)</span><span class="hl_char">(</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;EFI_BLOCK_IO_PROTOCOL&nbsp;<span class="hl_char">*</span><span class="hl_function">This</span><span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;UINT32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MediaId<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;EFI_LBA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lba<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;UINTN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufferSize<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>OUT</b></span>&nbsp;<span class="hl_function"><b>VOID</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>Buffer</li><li class="hl_l0"><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">typedef</li><li class="hl_l1">EFI_STATUS</li><li class="hl_l0"><span class="hl_char">(</span>EFIAPI&nbsp;<span class="hl_char">*</span>EFI_BLOCK_WRITE<span class="hl_char">)</span><span class="hl_char">(</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;EFI_BLOCK_IO_PROTOCOL&nbsp;<span class="hl_char">*</span><span class="hl_function">This</span><span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;UINT32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MediaId<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;EFI_LBA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lba<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;UINTN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufferSize<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;<span class="hl_function"><b>VOID</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>Buffer</li><li class="hl_l0"><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>UEFI в добавок ещё и парсит таблицы разделов. Доступ возможен как на уровне диска, так и на уровне раздела.<br><br><b>Прикручиваем сверху скотчем:</b> парсер таблиц разделов (для BIOS), драйвер файловой системы NTFS (спиздить из ntfs-3g) и код для чтения/записи виндовых файлов реестра (где-то валялся. должен быть в паблике).<br><br>Ну а теперь ищем разделы с виндой и вкрячиваем туда какого угодно говнеца. Мешает антивирус - удаляем антивирус. Просто-напросто модифицируем файлы на системном разделе до загрузки винды.<br>Этот способ заражения BIOS давно и успешно используется трояном <b>Computrace</b>. Именно про него идёт речь в первом посте топика <i class=x>LoJax: первый известный UEFI руткит, используемый во вредоносной кампании</i>. LoJax - это он и есть.<br><br>По моему мнению, такого рода поделие не может считаться буткитом или руткитом. Аналогично можно вбросить вредоносные файлы в Linux / MacOS и куда угодно ещё.<br><br><b>Защита по уму:</b> SecureBoot работающий с самого бутблока биос, на основе TPM чипа. Выставление безопасного порядка загрузки в BIOS. Удаление лишней херни из прошивки биос чипа. Впрочем, зловред загружаемый с внешнего носителя может быть подписан ключом вендора. Прописывайте в BIOS свои ключи и переподписывайте загрузчики вручную.<br><br><b>Защита из говна и палок:</b> зашифровать диски. Хотя-бы с паролем qwerty. Троян отрабатывает до старта бутлоадера и не может влезть на зашифрованный раздел.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=390012&amp;user=12867&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=8" class="addthx" data-post="390012"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=4773" title="22-12-2018 21:50, ранг:382.4" target="_blank">plutos</a>, <a href="action=userinfo&user=3520" title="23-12-2018 12:01, ранг:630.4" target="_blank">mak</a>, <a href="action=userinfo&user=41324" title="24-12-2018 10:11, ранг:5.5" target="_blank">superakira</a>, <a href="action=userinfo&user=47881" title="19-01-2019 22:14, ранг:0.0" target="_blank">FlatL1neAPT</a>, <a href="action=userinfo&user=33192" title="01-02-2019 12:45, ранг:6.3" target="_blank">morgot</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 декабря 2018 15:03 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<b>ntldr</b><br><br>Уже тянет на статейку в пдф <img src="img/smilies/s5.gif" alt="">
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=390045&amp;user=3520&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=9" class="addthx" data-post="390045"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=4773" title="24-12-2018 01:57, ранг:382.5" target="_blank">plutos</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 декабря 2018 04:56 <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
<I>mak пишет:<br>Уже тянет на статейку в пдф  </I><br><br>а то и на книгу постепенно наберется! <img src="img/smilies/s3.gif" alt="">
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=390070&amp;user=4773&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=10" class="addthx" data-post="390070"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 декабря 2018 06:48 &middot; Поправил: ntldr <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
Лучшая документация по таким вещам - это код. Не представляю о чём тут можно книги писать.<br><br>Реверсить EFI загрузчики от винды - как нефиг делать, для них есть отладочные символы. Это не только имена функций в диасме, но ещё и прототипы всех структур данных. Также символы есть для всех ядер.<br><br>Можно не изобретать уникальный велосипед для поиска внутренних функций, а тупо выкачать PDB&#039;шники для всех существующих в природе файлов, распарсить их и составить таблицу с оффсетами всего нужного, либо сгенерировать базу бинарных сигнатур. Эта задача автоматизируется, нужна лишь полная коллекция файлов. Некрасивое, но простое и стабильное решение. Помнится, такой приём применялся в отладчике SoftIce.<br><br>С legacy bios загрузчиком чуть сложнее. К внутреннему PE файлу из bootmgr есть символы для старых версий, нет для новых. Но структура кода сохраняется, подсматривая дизасм старого загрузчика ищется аналогичный код в новом.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=390072&amp;user=12867&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=11" class="addthx" data-post="390072"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]superakira[/b]','')">superakira</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.82'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41324">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 декабря 2018 13:10 <br><script type="text/javascript">QU('superakira','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=superakira" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
<b>ntldr</b> как это все отлаживать? если биос, то вроде на борще это отлаживали. сейчас с едк2 идет от интела на базе qemu отладочный стенд - ты на нем отлаживал, если говорить про рк? те я к чему - я не такой клевый, чтоб с 1 раза что-то закодить норм)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=390086&amp;user=41324&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=12" class="addthx" data-post="390086"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 декабря 2018 14:58 &middot; Поправил: ntldr <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
Именно отладчиком я пользовался всего пару раз, для отладки кода под legacy BIOS через BOCHS. К QEMU можно прикрутить биос OVMF.fd, оно запускается и на первый взгляд работает, но винда у меня на нём не загружалась.<br><br>VMWare последних версий поддеживает UEFI, причём как 32 так и 64 битные версии. Винда загружается, всё в целом работает. VMWare умеет писать лог-файл для виртуального COM порта.<br><br>Главный инструмент отладки - вывод отладочной информации в COM порт. На реальном железе - отлаживаем через RS232 кросс-кабель к другому компу. Хочешь посмотреть какие-нибудь внутренние структуры - пишешь код снимающий дамп. Свой код в части алгоритмов - можно отлаживать на винде, а затем переносить в EFI.<br><br>Если же хочешь ковырнуть что-то что происходит на реальном железе в ранних стадиях загрузки - модифицируешь UEFI капсулу (добавляешь новый модуль или заменяешь чужие модули пропатченными)  и шьешь флеш чип SPI программатором. Советую покупать материнку с флешкой в DIP корпусе на панельке. Иначе придётся выпаивать SMD чип и приделывать болтающийся на проводах переходник для быстрой замены микросхем. Менять прошивки придётся часто. Будет не лишним купить несколько запасных микросхем SPI Flash.<br><br>Для отладки чужих модулей PEI стадии — отладочный код внедряется в нужный модуль. Инструмент для этого у меня написан на скорую руку, пока не выкладываю.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=390093&amp;user=12867&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=13" class="addthx" data-post="390093"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2018 02:00 &middot; Поправил: plutos <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
<I>ntldr пишет:<br>Не представляю о чём тут можно книги писать </I><br><br>Тебе с твоим уровнем, многое кажется само собой разумеющимся и понятным, а мне например, порой непонятно с какой стороны подойти, так что писать есть о чем: о деталях, о мелких подробностях, причем желательно с наглядными примерами.<br>Ведь недаром говорят англичане: <b>Devil is in the details.</b> <img src="img/smilies/s10.gif" alt=""> <br><br>и вот еще &quot;до кучи&quot;, может кому будет интересно:<br><noindex><a href="https://www.veracrypt.fr/en/Home.html" rel="nofollow" target="_blank">--&gt; VeraCrypt &lt;--</a></noindex>is a free open source disk encryption software for Windows, Mac OSX and Linux.  <br>С полным source code, среди которого EFI Bootloader for EFI Windows system encryption (LGPL).
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=390110&amp;user=4773&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=14" class="addthx" data-post="390110"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 декабря 2018 08:05 &middot; Поправил: plutos <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
для тех, кто страдает бессоницей и хочет основательно разобраться с данной темой:<br><br>LATEST VERSIONS OF THE UEFI SPECIFICATIONS<br><br><noindex><a href="http://www.uefi.org/sites/default/files/resources/UEFI%20Spec%202_7_A%20Sept%206.pdf" rel="nofollow" target="_blank">--&gt; UEFI specification&lt;--</a></noindex><br><br><noindex><a href="http://www.uefi.org/sites/default/files/resources/ACPI%206_2_A_Sept29.pdf" rel="nofollow" target="_blank">--&gt; ACPI Specification&lt;--</a></noindex>
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=390166&amp;user=4773&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=15" class="addthx" data-post="390166"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]DrVB_5_6[/b]','')">DrVB_5_6</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 58.3 (постоянный), 50thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.46'>Активность: 0.04<span style='color:green'>&nearr;</span>0.08</span><br>Статус: <a href="action=userinfo&amp;user=19629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 декабря 2018 09:35 <br><script type="text/javascript">QU('DrVB_5_6','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DrVB_5_6" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
<I>plutos пишет:<br>--&gt; UEFI specification&lt;-- </I><br>Вообще-то уже 2.7 версия, а ссылка на 2.4 (2013)<br>и там достаточно много изменений!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=390167&amp;user=19629&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=16" class="addthx" data-post="390167"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 декабря 2018 11:12 &middot; Поправил: plutos <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
<I>DrVB_5_6 пишет:<br>а ссылка на 2.4 (2013) </I><br><br>прошу прощения, не ту ссылку вставил. Поправил. (Version 2.7 Errata A August 2017)
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=390168&amp;user=4773&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=17" class="addthx" data-post="390168"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 декабря 2018 12:10 <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
<I>ntldr пишет:<br>ничего не мешает включить A20 рейт </I><br>A20 устарело и не поддерживается<br><br><b>Добавлено спустя 2 минуты</b><br><I>ntldr пишет:<br>есть устройства достпные только на PEI стадии загрузки (после чего они выключаются установкой бита в регистре и пропадают из PCI Config space, обратно включить нельзя) </I><br>Это вполне стандартная фича PCH, хотя не полностью описанная в манах
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=390201&amp;user=22831&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=18" class="addthx" data-post="390201"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]specz[/b]','')">specz</a></b><br></div>
<img src="img/s3.gif" alt=""><br><img style="padding-top:3px;" src="av/276.jpg" alt=""><br><span class=txtSm>Ранг: 44.2 (посетитель), 69thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.14<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=276">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 января 2019 08:12 <br><script type="text/javascript">QU('specz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=specz" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
https://media.ccc.de/v/35c3-9561-first_sednit_uefi_rootkit_unveiled
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=390281&amp;user=276&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=19" class="addthx" data-post="390281"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2019 23:04 <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
<I>ntldr пишет:<br>Как будет время, я постараюсь изложить в этом топике свои представления о нескольких разных подходах к созданию UEFI руткитов </I><br><br>очень хотелось бы, чтобы тема не умирала, чтобы все-таки продолжалась. <br>думаю, что я не одинок в своих мечтах!<br>Уважаемый ntldr, если будет возможность, все же продолжайте! Ведь интерес к теме есть!
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=391804&amp;user=4773&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=20" class="addthx" data-post="391804"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]superakira[/b]','')">superakira</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.82'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41324">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 февраля 2019 15:52 <br><script type="text/javascript">QU('superakira','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=superakira" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
<b>plutos</b> по факту он уже все сказал чтобы начать кодить и пробовать всякое, а с некоторого этапа никто ничего говорить уже не будет)<br><br><b>Добавлено спустя 3 минуты</b><br>да! чтобы добавил я к этому. на определенном этапе я плавал в терминологии и в общих вещах. очень помогла такая штука.<br>https://github.com/tianocore/tianocore.github.io/wiki/UEFI%20EDKII%20Learning%20Dev
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=391959&amp;user=41324&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=21" class="addthx" data-post="391959"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 февраля 2019 18:59 &middot; Поправил: ntldr <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
Общую теорию я уже кратко изложил. На данный момент больше сказать нечего.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=391965&amp;user=12867&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=22" class="addthx" data-post="391965"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2019 22:04 <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
Чтозахуйня? <br>В прошлой редакции нтлдр объяснял, что руткиты - это и р3, и js, разве что про 1с вроде не было
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=392211&amp;user=22831&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=23" class="addthx" data-post="392211"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2019 03:48 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#24');return false;">#24</a> </span><div align=left><br>
Удалил свой оффтоп. Это не относится к теме, здесь обсуждаем UEFI.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=392240&amp;user=12867&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=24" class="addthx" data-post="392240"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2019 08:26 <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#25');return false;">#25</a> </span><div align=left><br>
Почему вы так форсите понятие UEFI? Принципиально  уефи и биос - одно и то же.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=392252&amp;user=22831&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=25" class="addthx" data-post="392252"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2019 11:38 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#26');return false;">#26</a> </span><div align=left><br>
Ну если <b>очень</b> принципиально - то всё оно одно и тоже, машинный код в контейнерах <img src="img/smilies/s6.gif" alt=""><br>На UEFI стандарты есть, что многое упрощает.<br>А BIOS каждый пилил как хотел.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=392264&amp;user=6859&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=26" class="addthx" data-post="392264"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]DrVB_5_6[/b]','')">DrVB_5_6</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 58.3 (постоянный), 50thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.46'>Активность: 0.04<span style='color:green'>&nearr;</span>0.08</span><br>Статус: <a href="action=userinfo&amp;user=19629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2019 12:13 &middot; Поправил: DrVB_5_6 <br><script type="text/javascript">QU('DrVB_5_6','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DrVB_5_6" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#27');return false;">#27</a> </span><div align=left><br>
<I>cppasm пишет:<br>На UEFI стандарты есть, что многое упрощает. </I><br>Ну не стандарты, а спецификации. И это не одно и то же!...<br>И в рамках этих спецификаций пилят, как хотят, но иногда &quot;проскальзывает&quot; некоторая совместимость!...<br>И даже не всегда в этих рамках... Хотя и в структуре UEFI (ну там файловая структура и т.д.)<br><I>spinz пишет:<br>Принципиально  уефи и биос - одно и то же. </I><br>Да запили ты игрушку какую-нибудь на UEFI и даже не инициализируй ничего и не загружай ОС.<br>И будет у тебя хрен знает что, это может быть и не БИОС!<br>Так что UEFI != BIOS    !!!!<br>Но бывает UEFI/BIOS !... ну или BIOS/UEFI !...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=392267&amp;user=19629&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=27" class="addthx" data-post="392267"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2019 12:34 <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#28');return false;">#28</a> </span><div align=left><br>
<I>DrVB_5_6 пишет:<br>Так что UEFI != BIOS </I><br>С точки зрения железа и то, и другое - софт, запускаемый при старте системы, все остальное лирика.<br>Функционал, спеки и стандарты - от лукавого
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=392271&amp;user=22831&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=28" class="addthx" data-post="392271"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2019 12:40 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#29');return false;">#29</a> </span><div align=left><br>
<I>DrVB_5_6 пишет:<br>Ну не стандарты, а спецификации. И это не одно и то же!... </I><br>С фига ли это не одно и тоже?<br>Спецификация это описание требований к реализации - это способ стандартизации.<br><br><I>DrVB_5_6 пишет:<br>И в рамках этих спецификаций пилят, как хотят, но иногда &quot;проскальзывает&quot; некоторая совместимость!... </I><br>В рамках спецификации ты и можешь пилить как хочешь.<br>Но если действительно &quot;в рамках&quot; - то реализации будут совместимыми.<br><br>Если у тебя что-то совместимо, что-то нет - значит ты не по спецификации запилил, очевидно же.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=392272&amp;user=6859&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=29" class="addthx" data-post="392272"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2019 13:02 &middot; Поправил: ntldr <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#30');return false;">#30</a> </span><div align=left><br>
Пилить можно и не в рамках спецификаций, более того - иногда приходится нарушать спецификации.<br>Например делать вот так не есть хорошо:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EFI_BLOCK_IO_PROTOCOL<span class="hl_char">*</span>&nbsp;BlockIo&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>EFI_ERROR<span class="hl_char">(</span>gBS<span class="hl_char">-</span><span class="hl_char">&gt;</span>HandleProtocol<span class="hl_char">(</span>ControllerHandle<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>gEfiBlockIoProtocolGuid<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">VOID</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">&amp;</span>BlockIo<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">|</span>&nbsp;BlockIo&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span>&nbsp;return&nbsp;EFI_UNSUPPORTED<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;save&nbsp;BlockIoProtocol&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;hook&nbsp;ReadBlocks&nbsp;<span class="hl_char">&amp;</span>&nbsp;WriteBlocks&nbsp;handlers</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;partition<span class="hl_char">-</span><span class="hl_char">&gt;</span>BlockIo&nbsp;<span class="hl_char">=</span>&nbsp;BlockIo<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;partition<span class="hl_char">-</span><span class="hl_char">&gt;</span>ReadBlocks&nbsp;<span class="hl_char">=</span>&nbsp;BlockIo<span class="hl_char">-</span><span class="hl_char">&gt;</span>ReadBlocks<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;partition<span class="hl_char">-</span><span class="hl_char">&gt;</span>WriteBlocks&nbsp;<span class="hl_char">=</span>&nbsp;BlockIo<span class="hl_char">-</span><span class="hl_char">&gt;</span>WriteBlocks<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BlockIo<span class="hl_char">-</span><span class="hl_char">&gt;</span>ReadBlocks&nbsp;<span class="hl_char">=</span>&nbsp;DcPartitionReadBlocks<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BlockIo<span class="hl_char">-</span><span class="hl_char">&gt;</span>WriteBlocks&nbsp;<span class="hl_char">=</span>&nbsp;DcPartitionWriteBlocks<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gBS<span class="hl_char">-</span><span class="hl_char">&gt;</span>ReinstallProtocolInterface<span class="hl_char">(</span>ControllerHandle<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>gEfiBlockIoProtocolGuid<span class="hl_char">,</span>&nbsp;BlockIo<span class="hl_char">,</span>&nbsp;BlockIo<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dbg_print<span class="hl_char">(</span><span class="hl_quote">&quot;DcDriverBindingStart: hooked OK\n&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;EFI_SUCCESS<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>Зато просто и работает. По-правильному нужно добавлять свой block device поверх шифруемого и менять пути к запускаемым файлам чтобы они ссылались на твой block device.<br><br>В новых спеках появился ещё интерфейс BlockIo2, с поддержкой асинхронного ввода-вывода. Вроде бы пока никакой ОС не используется...<br><br>PS: и HandleProtocol - уже deprecated, по-правильному нужно использовать громоздкие конструкции OpenProtocol / CloseProtocol.<br>PPS: я ещё и собираю без EDK, а прямо в VS, грепнув в проект только нужные хедеры.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=392276&amp;user=12867&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=30" class="addthx" data-post="392276"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]ValdikSS[/b]','')">ValdikSS</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.4 (постоянный), 33thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.15'>Активность: 0.05<span style='color:red'>&searr;</span>0.03</span><br>Статус: <a href="action=userinfo&amp;user=4827">Участник</a><br><font color=blue></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 марта 2019 12:51 &middot; Поправил: ValdikSS <br><script type="text/javascript">QU('ValdikSS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ValdikSS" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=25409&amp;page=1#31');return false;">#31</a> </span><div align=left><br>
Если кому интересно посмотреть исходники некоторых возможностей UEFI:<br><noindex><a href="https://github.com/rhboot/shim" rel="nofollow" target="_blank">https://github.com/rhboot/shim</a></noindex> — Red Hat shim, маленький (уже не очень) пред-загрузчик, создан для запуска .efi-файлов, не подписанных ключом Microsoft (или другим сертификатом в UEFI db) при включенном Secure Boot, без дополнительных запросов. Из интересного:<br><noindex><a href="https://github.com/rhboot/shim/blob/master/replacements.c" rel="nofollow" target="_blank">Хуки некоторых функций</a></noindex> (LoadImage, StartImage, ExitBootServices)<br><noindex><a href="https://github.com/rhboot/shim/blob/master/lib/security_policy.c" rel="nofollow" target="_blank">Установка Security Policy</a></noindex><br><noindex><a href="https://github.com/rhboot/shim/blob/master/shim.c" rel="nofollow" target="_blank">Собственный загрузчик PE</a></noindex> (функции handle_image, load_image, start_image, read_header, relocate_coff)<br><noindex><a href="https://github.com/rhboot/shim/blob/master/shim.c" rel="nofollow" target="_blank">Установка собственного протокола shim_lock</a></noindex>, который может использоваться из запускаемых программ (функция install_shim_protocols).<br>И ещё есть код для загрузки через HTTP.<br><br>Много комментариев и интересных заметок в коммитах, описывающих проблемы на материнских платах разных производителей, неправильные размеры секций в загрузчиках Microsoft, неработающую функциональность.<br><br>Сделал диск-основу для загрузочных USB-флешек, которая может работать при включенном Secure Boot. Может, кому пригодится: <noindex><a href="https://github.com/ValdikSS/Super-UEFIinSecureBoot-Disk" rel="nofollow" target="_blank">https://github.com/ValdikSS/Super-UEFIinSecureBoot-Disk</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=392465&amp;user=4827&amp;forum_n=2&amp;topic=25409&amp;page=1&amp;anchor=31" class="addthx" data-post="392465"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3520" title="09-03-2019 11:01, ранг:633.6" target="_blank">mak</a>, <a href="action=userinfo&user=39556" title="09-03-2019 11:15, ранг:71.3" target="_blank">sefkrd</a>, <a href="action=userinfo&user=4773" title="09-03-2019 20:19, ранг:411.4" target="_blank">plutos</a>, <a href="action=userinfo&user=12867" title="15-03-2019 15:55, ранг:368.9" target="_blank">ntldr</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=2&amp;topic=25409&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=2&amp;topic=25409&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=2&amp;topic=25409&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=2&amp;topic=25409&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> UEFI руткиты</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="2">
<input type="hidden" name="topic" value="25409">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=25409" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
