<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите разобраться с глюком в лоадере. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Пишу лоадер на Delphi 7, использую advApiHook by Ms-Rem. Столкнулся с непонятным для меня глюком. Процесс создается через CreateProcess с параметром CREATE_SUSPENDED. Насколько я понимаю, он создается но не запускается до вызова">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите разобраться с глюком в лоадере.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2007 17:47 &middot; Поправил: SergX <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Пишу лоадер на Delphi 7, использую advApiHook by Ms-Rem.<br>Столкнулся с непонятным для меня глюком.<br>Процесс создается через CreateProcess с параметром CREATE_SUSPENDED.<br>Насколько я понимаю, он создается но не запускается до вызова ResumeThread.<br>Скорее всего здесь как раз моя ошибка…<br><br>В память загружаемого процесса внедряется образ лоадера через InjectThisExe.<br>И опять же если я правильно понял то сразу после внедрения исполняется Main.<br><br>Тогда всё должно выглядеть так:<br>1. CreateProcess(…,CREATE_SUSPENDED,..) // Загружаем  замороженный процесс.<br>2. InjectThisExe(..) // Внедряем образ своего EXE, и запускаем в нём процедуру Main.<br>3. ResumeThread(..) // Запускаем замороженный процесс.<br><br>Подобный глюк встречал несколько раз. Приведу в пример прогу CCALC.<br>Если между InjectThisExe и ResumeThread поставить Sleep(1000), то прога запуститься, но на окнах все кнопи, едиты и т.д. не перерисовываются, хотя вроде работают. Глюк иногда бывает и без Sleep, заметил что зависит от компа но не ясно от чего именно. А если поставить Sleep(100) в начале Main то работает нормально.<br><br>Подскажите почему так ?<br>В чём я туплю ?<br><br>ПРИМЕР: Loader_BUG.zip http://rapidshare.com/files/63452072/Loader_BUG.zip.html  1.2 Mb
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=163728&amp;user=11974&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=1" class="addthx" data-post="163728"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]UsAr[/b]','')">UsAr</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 66.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.14'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1854">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2007 18:44 <br><script type="text/javascript">QU('UsAr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=UsAr" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Потому что процесс на стадии CREATE_SUSPENDED еще не до конца проинициализирован, и если сменить regEIP, а потом сделать ResumeThread, могут возникнуть разные нехорошие глюки.<br>Под XP SP2 можно сменить regEAX, он в это время содержит entry point проги. Тогда должно нормально работать, но на других системах врядли =\
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=163742&amp;user=1854&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=2" class="addthx" data-post="163742"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]__[/b]','')">__</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.1 (ветеран), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.73'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7172">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2007 18:52 <br><script type="text/javascript">QU('__','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=__" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
посмотрите как запускает второй процесс армадилла, она пишет в точку входа EBFE(jmp &#036;)<br>и потом делает resume процессу, в этот момент можно инжектить код, чтобы его запустить<br>используйте SetThreadContext, не забудьте учесть ньюансы ;)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=163744&amp;user=7172&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=3" class="addthx" data-post="163744"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2007 19:01 &middot; Поправил: SergX <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Глюк бывает и без CREATE_SUSPENDED с ResumeThread.<br>Просто если запускать через CREATE_SUSPENDED и между InjectThisExe и ResumeThread поставить Sleep(1000), он будет гарантированно. Если без Sleep(1000) то бывает иногда.<br><br>В примере наглядно показано.<br><br>Я не могу понять причём тут паузы...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=163746&amp;user=11974&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=4" class="addthx" data-post="163746"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Xserg[/b]','')">Xserg</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.9 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.7'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7451">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2007 19:44 &middot; Поправил: Xserg <br><script type="text/javascript">QU('Xserg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Xserg" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Function Main(dwEntryPoint: Pointer): dword; stdcall;<br>Begin<br>HookProc(&#039;kernel32.dll&#039;,&#039;GetVolumeInformationA&#039;, @NewGetVolumeInformationA, @TrueGetVolumeInformationA);<br>//Как только скончается код, скончается и хук.<br>loadlibrary(&#039;user32.dll&#039;); //  На всякий случай.<br>Sleep(&#036;ffffffff); // - если поставить этот слип, то вроде работает.<br>End;<br><br>З.ы. Ники у нас прикольные <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=163754&amp;user=7451&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=5" class="addthx" data-post="163754"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2007 21:38 <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>Xserg пишет:<br>//Как только скончается код, скончается и хук. </I><br>Моя твоя не понимает.<br><br><I>Xserg пишет:<br>З.ы. Ники у нас прикольные  </I><br>Ага, обхохочешься...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=163790&amp;user=11974&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=6" class="addthx" data-post="163790"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Xserg[/b]','')">Xserg</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.9 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.7'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7451">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 октября 2007 07:59 <br><script type="text/javascript">QU('Xserg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Xserg" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>SergX пишет:<br>Моя твоя не понимает. </I><br>Скончаться – синоним слова умереть.<br>Код (англ. Code -  кодировать, программировать) – программа.<br>Хук –(англ. Hook) – перехватывать. <br>Применительно к программированию переводится, приблизительно так:<br><br>//Как только скончается код, скончается и хук.<br>Как только, завершится программа (в данном случае Thread), освободится память которую она занимала. В следствии чего, установленный Hook, обратится к несуществующему участку памяти.<br><br>Почему умрет  Thread?<br>Адрес возврата для функции созданной CreateRemoteThread, будет ExitTread.<br>Т.е. команда end; в функции Main , равносильна команде  ExitTread.<br><br><I>SergX пишет:<br>Я не могу понять причём тут паузы... </I><br>Если запущенная тобой программа, успеет обратится, к похуканой(сленг) АPI, до того, как умрет твой  Hook, все сработает без глюков.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=163851&amp;user=7451&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=7" class="addthx" data-post="163851"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 октября 2007 08:13 <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Глюк есть даже если из Main вообще ничё не делать…<br>Так что трабл не в установке хука, и не в CREATE_SUSPENDED.<br>Но если в Main поставить Sleep(100) то глюка нет…<br><br>Function Main(dwEntryPoint: Pointer): dword; stdcall;<br>Begin<br>Sleep(100);<br>End;<br><br>Если в Main нет паузы, и запустить зразу штук 5-7 лоадеров, то на большинстве копий будет глюк. Если поставить в Main паузу все копии запускаются нормально…<br>А если поставить паузу между InjectThisExe и ResumeThread, глюк будет 100%<br><br>В чём проблема ? Причём тут паузы ?<br>Кто куда не успевает ???<br><br><img src="http://i.smiles2k.net/computer_smiles/throw.gif" border="0" align="" alt=""> Бред какой-то !
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=163853&amp;user=11974&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=8" class="addthx" data-post="163853"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 октября 2007 08:20 &middot; Поправил: SergX <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Xserg ты ошибаешься. Задача Main, только в том чтоб установить хук. <br><br><i class=x>Xserg пишет: <br>освободится память которую она занимала</i><br>Вряд ли. Щаз олей гляну. <br><br><i class=x>Xserg пишет: <br>установленный Hook, обратится к несуществующему участку памяти.</i><br>Это уж точно нет. Хук как раз работает нормально.<br><br><br>З.Ы.<br>Хотя хз. Может ты и прав. Поставил в конце Main:<br><code>repeat sleep(1000); until false;</code><br>и вроде работает. Но почему всё равно не догоняю...<br>По памяти смотрел, вроде после выполнения Main ниче не меняется.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=163854&amp;user=11974&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=9" class="addthx" data-post="163854"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 октября 2007 10:36 <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Неужели никто не может сказать почему так происходит ?<br><br><code>Program Loader;<br>{&#036;IMAGEBASE &#036;15000000}<br><br>Uses Windows, AdvApiHook;<br>Var StartInf: TStartupInfo; ProcInf: TProcessInformation;<br><br>Function Main(dwEntryPoint: Pointer): dword; stdcall;<br>Begin<br>Sleep(100); // - если поставить этот слип, то вроде работает OK.<br>ExitThread(0);<br>End;<br><br>Begin<br>ZeroMemory(@StartInf, SizeOf(TStartupInfo));<br>StartInf.cb:=SizeOf(TStartupInfo);<br>CreateProcess(nil, &#039;ccalc.exe&#039;, nil, nil, false, CREATE_SUSPENDED, nil, nil, StartInf, ProcInf);<br>InjectThisExe(ProcInf.hProcess, @Main);<br>Sleep(1000);  // - а если поставить этот, то глюк будет 100%.<br>ResumeThread(ProcInf.hThread);<br>End.</code>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=163988&amp;user=11974&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=10" class="addthx" data-post="163988"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 октября 2007 12:22 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
выложи все исходники, где то у тя косяк в реализации... <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=163996&amp;user=72&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=11" class="addthx" data-post="163996"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]S_T_A_S_[/b]','')">S_T_A_S_</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 163.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.87'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=251">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 октября 2007 14:45 <br><script type="text/javascript">QU('S_T_A_S_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=S_T_A_S_" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>UsAr пишет:<br>на других системах врядли</I><br>По-моему, это в сорцах 2К есть.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164005&amp;user=251&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=12" class="addthx" data-post="164005"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 октября 2007 15:46 &middot; Поправил: SergX <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>Hellspawn пишет:<br>выложи все исходники, где то у тя косяк в реализации...  </I><br>Тебе смешно, а мне не очень.<br>Оно мне в принципе и не нужно, но не даёт спокойно спать...<br>Потратил уже кучу времени, но пока без результатов. <br>Не хватает знаний и практики.<br><br>З.Ы. Если ты серьёзно, то все файлы в первом посте.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164010&amp;user=11974&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=13" class="addthx" data-post="164010"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 октября 2007 15:50 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>SergX</b><br>Возможно проблема действительно в том,что создаваемый процесс ещё не успел инициализироваться,а ты уже пихаешь в него всякие процедуры.<br>Попробуй после создания процесса зациклить точку входа(вписать туда слово 0FEEBh) и запустить следующую функцию:<br><code><br><br> WAIT_PAUSE  equ   02<br><br>; ########################################## SleepRoutine ########################################<br>SleepRoutine proc USES esi hThread:HANDLE, HookedAddr:DWORD<br><br> local pContext:CONTEXT<br><br>      mov    pContext.ContextFlags, CONTEXT_FULL<br><br>      mov    esi, HookedAddr<br><br>@@sleeping_loop:<br>      lea    eax, pContext<br>      push   eax<br>      push   hThread<br>      call   GetThreadContext<br><br>      cmp    dword ptr pContext.regEip, esi<br>      jz     @F<br><br>      push   hThread<br>      call   ResumeThread<br><br>      push   WAIT_PAUSE<br>      call   Sleep<br><br>      push   hThread<br>      call   SuspendThread<br><br>      jmp    @@sleeping_loop<br><br>@@:<br>      ret<br><br>SleepRoutine endp</code><br><br>...параметры: описатель потока созданного процесса и адрес,который зациклен(в нашем случае это будет EP).<br>После того,как функция вернёт управление,пробуй внедрять код.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164011&amp;user=1613&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=14" class="addthx" data-post="164011"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 октября 2007 16:23 &middot; Поправил: SergX <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
[del]
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164014&amp;user=11974&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=15" class="addthx" data-post="164014"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 октября 2007 16:23 &middot; Поправил: SergX <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
[del]
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164015&amp;user=11974&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=16" class="addthx" data-post="164015"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 октября 2007 16:24 &middot; Поправил: SergX <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
[del]
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164016&amp;user=11974&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=17" class="addthx" data-post="164016"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 октября 2007 17:31 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>SergX</b><br>Дык,ты сначала проверь,а потом мы уже будем гипотезы строить,почему же он выдаёт глюк.Кстати,что именно делает эта функция InjectThisExe??
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164025&amp;user=1613&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=18" class="addthx" data-post="164025"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]UsAr[/b]','')">UsAr</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 66.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.14'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1854">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 октября 2007 18:35 &middot; Поправил: UsAr <br><script type="text/javascript">QU('UsAr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=UsAr" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>S_T_A_S_ пишет:<br>По-моему, это в сорцах 2К есть. </I><br>сорцы 2k к сожалению сейчас не могу посмотреть, но судя по исходникам функции BaseProcessStart( PVOID lpfnEntryPoint )<br>именно в её начале прерывается програмка с флагом CREATE_SUSPENDED. Как я понял это fastcall, хотя в сорцах реактоса она объявлена как stdcall.<br><br><b>SergX</b><br>Похоже глюк идет из-за того что второй тред стартует раньше главного и kernel32 еще не доступен (во всяком случае из другого процесса)<br>Вообще там практически никакой инициализации не происходит, можно попробовать заменить CreateRemoteThread из InjectThisEx на<br>NtSetInformationThread(ProcInf.hThread,ThreadQuerySetWin32StartAddress   ,@Main,4);<br>а в конец Main вставить прыжок на старый EntryPoint.<br>а можно вместо NtSetInformationThread сменить regEax в контексте главного треда.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164030&amp;user=1854&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=19" class="addthx" data-post="164030"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]S_T_A_S_[/b]','')">S_T_A_S_</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 163.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.87'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=251">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 октября 2007 07:49 &middot; Поправил: S_T_A_S_ <br><script type="text/javascript">QU('S_T_A_S_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=S_T_A_S_" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<code>VOID<br>BaseInitializeContext(<br>    OUT PCONTEXT Context,<br>    IN PVOID Parameter OPTIONAL,<br>    IN PVOID InitialPc OPTIONAL,<br>    IN PVOID InitialSp OPTIONAL,<br>    IN BASE_CONTEXT_TYPE ContextType<br>    )<br><br>/*++<br><br>Routine Description:<br><br>    This function initializes a context structure so that it can<br>    be used in a subsequent call to NtCreateThread.<br><br>Arguments:<br><br>    Context - Supplies a context buffer to be initialized by this routine.<br><br>    Parameter - Supplies the thread&#039;s parameter.<br><br>    InitialPc - Supplies an initial program counter value.<br><br>    InitialSp - Supplies an initial stack pointer value.<br><br>    NewThread - Supplies a flag that specifies that this is a new<br>        thread, or a new process.<br><br>Return Value:<br><br>    Raises STATUS_BAD_INITIAL_STACK if the value of InitialSp is not properly<br>           aligned.<br><br>    Raises STATUS_BAD_INITIAL_PC if the value of InitialPc is not properly<br>           aligned.<br><br>--*/<br><br>{<br><br>    Context-&gt;Eax = (ULONG)InitialPc;<br>    Context-&gt;Ebx = (ULONG)Parameter;<br><br>//...<br></code>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164075&amp;user=251&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=20" class="addthx" data-post="164075"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 октября 2007 13:14 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>SergX</b><br><br>я с рапиды не могу качать) вообще я аналогичным образом внедряю длл и всё ок,<br>никаких косяков нету... <img src="img/smilies/s1.gif" alt=""> Поэтому я и предположил... =)<br><br>з.ы. так ли нужно те внедрять ехе? <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164091&amp;user=72&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=21" class="addthx" data-post="164091"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 13:37 &middot; Поправил: SergX <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>DillerInc</b><br>Спасибо, попробую это себе на голову натянуть.<br>Пока не могу, углы мешают...<br>Мне на днях стукнуло 18h, до сих пор хожу как после CreateProcess(..,CREATE_SUSPENDED,…) без ResumeThread.<br><br><I>Hellspawn пишет:<br>я с рапиды не могу качать </I><br>Loader_BUG.ZIP http://ifolder.ru/3832219   Размер: 1.24 Мб<br><br><I>Hellspawn пишет:<br>вообще я аналогичным образом внедряю длл и всё ок, никаких косяков нету... </I><br>Я и DLL пробовал разными способами внедрять, та же хрень. Этот глюк не всюду, а только с этой прогой, и ещё на нескольких было нечто подобное.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164257&amp;user=11974&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=22" class="addthx" data-post="164257"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]S_T_A_S_[/b]','')">S_T_A_S_</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 163.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.87'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=251">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 15:29 <br><script type="text/javascript">QU('S_T_A_S_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=S_T_A_S_" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10200.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Eax пробовал?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164275&amp;user=251&amp;forum_n=1&amp;topic=10200.html&amp;page=0&amp;anchor=23" class="addthx" data-post="164275"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите разобраться с глюком в лоадере.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#24" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="10200">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=10200" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
