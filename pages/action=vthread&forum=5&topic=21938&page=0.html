<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Где почитать про обход проверки целостности программы - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Сабж. Киньте ссылок, пожалуйста! Прога на борланд с++, скорее всего ехе использует собственную проверку md5 хеша...">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Где почитать про обход проверки целостности программы</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Sn[/b]','')">Sn</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.85'>Активность: 0.01<span style='color:green'>&nearr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=13037">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 15:52 &middot; Поправил: Sn <br><script type="text/javascript">QU('Sn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sn" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Сабж. Киньте ссылок, пожалуйста!<br>Прога на борланд с++, скорее всего ехе использует собственную проверку md5 хеша...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327626&amp;user=13037&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=1" class="addthx" data-post="327626"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 15:59 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
учебник по ассемблеру почитайте <img src="img/smilies/s5.gif" alt=""><br>ссылок в гугле полно
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327628&amp;user=15381&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=2" class="addthx" data-post="327628"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 16:01 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
На вскидку<br>1) VirtualProtect на патченном участке, запрещаем чтение этого участка + свой обработчик exception, который подсовывает старые данные/код<br>2) На случай проверки через ReadProcessMemory(GetCurrentProcess(), ....) перехватываем ReadProcessMemory и подсовываем старые данные/код
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327629&amp;user=24257&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=3" class="addthx" data-post="327629"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Sn[/b]','')">Sn</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.85'>Активность: 0.01<span style='color:green'>&nearr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=13037">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 16:34 &middot; Поправил: Sn <br><script type="text/javascript">QU('Sn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sn" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>reversecode</b>, ога, смешно! спасибо <img src="img/smilies/s6.gif" alt=""><br><br><b>DenCoder</b>, первый вариант не используется точно. <br>Если патчить в olly и f9 - работает. А вот если изменить незначительно в любом месте строчку когда и Copy to executable и попробовать запустить ехе - уже отказывается работать (запускается, но не коннектится к серверу, выплевывает в общее окно текста: что версия устарела, текст весь этот в открытом виде не хранится)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327633&amp;user=13037&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=4" class="addthx" data-post="327633"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 16:37 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Sn пишет:<br>первый вариант не используется точно. </I><br>это варианты обхода
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327636&amp;user=24257&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=5" class="addthx" data-post="327636"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=13037" title="15-07-2013 12:43, ранг:8.5" target="_blank">Sn</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Sn[/b]','')">Sn</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.85'>Активность: 0.01<span style='color:green'>&nearr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=13037">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 16:42 &middot; Поправил: Sn <br><script type="text/javascript">QU('Sn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sn" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>DenCoder пишет:<br>это варианты обхода </I><br>Меня интересует как найти то место, где проверяется целостность ехе файла, и попробовать отключить ее. Патчить отдельно ехе в памяти уже - не интересно <img src="img/smilies/s9.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327638&amp;user=13037&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=6" class="addthx" data-post="327638"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 16:43 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>Sn</b> а по русски писать не хотите?<br>потому что если где то то как то понятно почему оно да и раз и не работает если после запуска
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327639&amp;user=15381&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=7" class="addthx" data-post="327639"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 16:48 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Sn пишет:<br>Меня интересует как найти то место </I><br>Нууу, VirtualProtect тебя и выведет на место, когда сработает exception. Если проверка идёт через ReadProcessMemory с хендлом текущего процесса (-1)(проверить легко бряком на функу), то также если бряк сработает, стек вызовов выведет на место проверки
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327641&amp;user=24257&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=8" class="addthx" data-post="327641"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Sn[/b]','')">Sn</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.85'>Активность: 0.01<span style='color:green'>&nearr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=13037">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 16:52 &middot; Поправил: Sn <br><script type="text/javascript">QU('Sn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sn" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
reversecode, хочу! Если, что-то некорректно обьяснил - извиняюсь.<br>В общем, если, программу загрузить в олли и, например, занопить незначительную строчку кода, нажать f9 - то программа запустится и полностью будет функционировать.<br><br>Но если сохранить данные изменения в файл и пробовать ехешник запустить - работать отказывается должным образом.<br><br><b>DenCoder</b>, благодарю за совет! Теперь понял. Буду пробовать предложенные Вами способы...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327642&amp;user=13037&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=9" class="addthx" data-post="327642"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 16:59 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>Sn пишет:<br>Но если сохранить данные изменения в файл и пробовать ехешник запустить - работать отказывается должным образом </I><br>А что именно патчили? Адреса патчились? Если да, то на запуске возможно по релокам будет нестыковка, если они есть. И, к примеру, была команда mov eax, [SomeAddr] или push SomeAddr, вы её занопили, лоадер добавил базу образа к 0x90909090 по тому месту и могло получиться так, что появился jmp в непредсказуемое место
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327644&amp;user=24257&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=10" class="addthx" data-post="327644"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 17:01 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
открыть программу в дизассемблере, и посмотреть для начала какие функции импортируются<br>и уже от них отталкиватся<br>при отсутствии подозрительных функций,<br>стопать программу в дебагере при старте<br>искать место где вы меняете байты, и ставить на них аксесс брекпоинт,<br>и когда вывалится дебаггер, смотреть место откуда идет обращение к проверке целосности
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327645&amp;user=15381&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=11" class="addthx" data-post="327645"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=13037" title="15-07-2013 13:42, ранг:8.5" target="_blank">Sn</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Sn[/b]','')">Sn</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.85'>Активность: 0.01<span style='color:green'>&nearr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=13037">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 17:35 &middot; Поправил: Sn <br><script type="text/javascript">QU('Sn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sn" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
DenCoder, адреса не патчились! Незначительные инструкции, к примеру, занопил инструкцию bound сразу после оеп. скрин: http://rghost.ru/47438249 (или такой пример, взял редактор ресурсов и внес изменения - всё, программа будет выплевывать при старте, что версия устарела)<br><br>Попробовал поставить BP на VirtualProtect и ReadProcessMemory, запустил - программа не остановилась...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327651&amp;user=13037&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=12" class="addthx" data-post="327651"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Sn[/b]','')">Sn</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.85'>Активность: 0.01<span style='color:green'>&nearr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=13037">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 17:55 <br><script type="text/javascript">QU('Sn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sn" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Хорошо, попробую по другому.<br>Какие API могут использоваться компонентом TJvRichEdit для вставки текста?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327654&amp;user=13037&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=13" class="addthx" data-post="327654"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 17:57 &middot; Поправил: ELF_7719116 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Один я не увидел ссылку на target-софт?? Сколько телепатов на форуме водится<img src="img/smilies/s1.gif" alt=""> Может проблема вовсе не в мифической проверке.<br>Если речь зашла об <b>MD5</b>, то не лишним упомянуть:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;HMODULE&nbsp;hLib&nbsp;<span class="hl_char">=</span>&nbsp;LoadLibrary<span class="hl_char">(</span>TEXT<span class="hl_char">(</span><span class="hl_quote">&quot;Cryptdll.dll&quot;</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;MD5Init&nbsp;<span class="hl_char">=</span>&nbsp;PMD5Init&nbsp;<span class="hl_char">(</span>&nbsp;GetProcAddress<span class="hl_char">(</span>hLib<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;MD5Init&quot;</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;MD5Update&nbsp;<span class="hl_char">=</span>&nbsp;PMD5Update<span class="hl_char">(</span>&nbsp;GetProcAddress<span class="hl_char">(</span>hLib<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;MD5Update&quot;</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;MD5Final&nbsp;<span class="hl_char">=</span>&nbsp;PMD5Final&nbsp;<span class="hl_char">(</span>&nbsp;GetProcAddress<span class="hl_char">(</span>hLib<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;MD5Final&quot;</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>и соответственно WinAPI <b>MapViewOfFile/UnmapViewOfFile</b><br><I>Sn пишет:<br>Какие API могут использоваться компонентом TJvRichEdit для вставки текста?  </I><br>Если действительно <b>RichEdit</b>, то <b>SendMessage</b>. Вообще такие вещи в MSDN смотрят.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327655&amp;user=26651&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=14" class="addthx" data-post="327655"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=13037" title="15-07-2013 14:46, ранг:8.5" target="_blank">Sn</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 18:04 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>Sn пишет:<br>Попробовал поставить BP на VirtualProtect </I><br>Да на VirtualProtect ставить bp не надо, вам надо выполнить на точке старта программы VirtualProtect, чтобы запретить чтение участков, которые патчились. Вот так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>sub</b></span>&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">4</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;0x10<span class="hl_comment">; запрещаем чтение, оставляем только выполнение.</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;size<span class="hl_comment">; размер патча</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;Address<span class="hl_comment">; начало патча</span></li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;VirtualProtect</li><li class="hl_l0"><span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">4</span></li>        </ol>
    </div>
</div></div>
<br>Это для случая, если патчился код. После вызова функции VirtualProtect, если происходит проверка этого участка в составе подсчёта какой-то контрольной суммы, то сработает exception ACCESS_VIOLATION и в стеке будет инфа об адресе инструкции, которая пыталась обратиться по адресу патча.<br><br>Вопрос только в том, как без отладчика заставить прогу вызвать эту функцию - я уже устал это писать, в одном из ответов я уже писал. Например <noindex><a href="https://ssl.exelab.ru/f/action=vthread&amp;forum=6&amp;topic=8678&amp;page=1#10" rel="nofollow" target="_blank">--&gt; здесь &lt;--</a></noindex><br>Но есть ещё способы, например изменить адрес OEP в PE-хедере, по изменённому адресу прописать код выше и не забыть jmp на OEP.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327657&amp;user=24257&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=15" class="addthx" data-post="327657"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Sn[/b]','')">Sn</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.85'>Активность: 0.01<span style='color:green'>&nearr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=13037">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 18:38 &middot; Поправил: Sn <br><script type="text/javascript">QU('Sn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sn" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>Один я не увидел ссылку на target-софт?? </I><br>http://rghost.ru/47349716 2mb<br><br><b>DenCoder</b>, да целостность проверяется всего файла, а не отдельных кусков в памяти.<br>Или я, скорее всего, не могу, просто, до конца понять Ваш способ, в силу своей неопытности...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327662&amp;user=13037&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=16" class="addthx" data-post="327662"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 19:03 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>Sn пишет:<br>запускается, но не коннектится к серверу, выплевывает в общее окно текста: что версия устарела, текст весь этот в открытом виде не хранится </I><br>не вижу вообще такого сообщения<br><br>ищите где вываливается это сообщение, и по цепочке вверх идете и высматриваете свою проверку<br><br>а вообще у меня дежавю на эту тему, вчера вроде такое же спрашивали о проверке сервером ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327667&amp;user=15381&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=17" class="addthx" data-post="327667"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Sn[/b]','')">Sn</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.85'>Активность: 0.01<span style='color:green'>&nearr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=13037">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 19:50 &middot; Поправил: Sn <br><script type="text/javascript">QU('Sn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sn" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>reversecode пишет:<br>не вижу вообще такого сообщения </I><br>Потому что, выше приведен оригинальный ехе шник, не патченный!<br><br>А вот патченный http://rghost.ru/47441319 (изменена одна неиспользуемая! программой инструкция по адресу 004022BE,  после чего начинаются требования обновить версию программы)<br><br><I>reversecode пишет:<br>ищите где вываливается это сообщение </I><br>Я понимаю, что нужно это искать, но в открытом виде данный текст не хранится и сообщения отдельного не вылазиет, а скидывается в общее окно программы (окно имеет класс TJvRichEdit). Поэтому - для меня это уже проблема... <img src="img/smilies/s5.gif" alt=""><br><br>Есть еще один вариант, когда тело не правлено - вылазиет окно с вводом логин пароль, а когда правлено - данное окно уже не появляется! Думаю попытаться оттолкнуться от этого места.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327668&amp;user=13037&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=18" class="addthx" data-post="327668"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 20:09 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
в олли дебагере аттачитесь к программе и по списку окон ищете кто там и где берет это сообщение для вывода<br>предлагаю продолжить тему после того как вы найдете где находится это сообщение в екзешнике
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327671&amp;user=15381&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=19" class="addthx" data-post="327671"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Sn[/b]','')">Sn</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.85'>Активность: 0.01<span style='color:green'>&nearr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=13037">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 20:15 &middot; Поправил: Sn <br><script type="text/javascript">QU('Sn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sn" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>reversecode пишет:<br>в олли дебагере аттачитесь к программе и по списку окон ищете кто там и где берет это сообщение для выводапредлагаю продолжить тему после того как вы найдете где находится это сообщение в екзешнике </I><br>Принял, ушел искать. <img src="img/smilies/s1.gif" alt=""> Благодарю.<br>Это ничего не дало, разве что узнал, что этих TJvRichEdit там штуки 3 еще есть невидимых на основной форме, виден в реале только один. Возможно, если хеш не совпадает - вместо одного показывается другой?<br>http://rghost.ru/47443255<br>http://rghost.ru/47443262
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327673&amp;user=13037&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=20" class="addthx" data-post="327673"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 20:50 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>Sn пишет:<br>Принял, ушел искать. </I><br>Обратите внимание на CreateFileMapping, MapViewofFile и CreateFile(возможно даже DeviceIoControl). Можно попробовать потянуть за эту веревочку.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327674&amp;user=26651&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=21" class="addthx" data-post="327674"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]AliS S0fT[/b]','')">AliS S0fT</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.8 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.23'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4470">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 21:32 <br><script type="text/javascript">QU('AliS S0fT','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AliS S0fT" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>Sn</b><br>Сама программа себя в памяти не проверяет, а проверяет сам файл.....
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327675&amp;user=4470&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=22" class="addthx" data-post="327675"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]DimitarSerg[/b]','')">DimitarSerg</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/24946.png" alt=""><br><span class=txtSm>Ранг: 253.5 (наставник), 684thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.26'>Активность: 0.26<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=24946">Участник</a><br><font color=blue>radical</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 22:48 &middot; Поправил: DimitarSerg <br><script type="text/javascript">QU('DimitarSerg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DimitarSerg" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Не, ну что за &quot;угадалки&quot; от спецов <img src="img/smilies/s1.gif" alt=""><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00496F99</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;B8&nbsp;EEFE8000&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0080FEEE</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;  ASCII &quot;/auth code &quot;</span></li>        </ol>
    </div>
</div></div>
<br><br>Дальше формируется отсылаемая строка, если не поленится и сравнить, можно заметить одно отличие - хеш, да это мд5 исполняемого файла, мд5 оригинального файла 7BB9C957CB5B292E477F715E24317D4D,  патченого A3B1F030B6C75C6314BEFB38EEE3B0D5.<br><br>Как подменять - решайте сами.<br><br>p.s. Я подменил - нормально запустилось (как оригинал, запросило авторизацию). Дерзайте.
<br><br><font size="1"><i>-----<br>ds</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327677&amp;user=24946&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=23" class="addthx" data-post="327677"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=13037" title="16-07-2013 13:03, ранг:7.7" target="_blank">Sn</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 22:54 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
раздел для новичков) зачем вы ламаете им весь кайф в учебе?<br>а если нужно что то за когото сделать то есть раздел в запросы или поиск спеца
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327679&amp;user=15381&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=24" class="addthx" data-post="327679"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=33657" title="15-07-2013 19:38, ранг:12.3" target="_blank">Jaa</a>, <a href="action=userinfo&user=12078" title="15-07-2013 20:39, ранг:55.4" target="_blank">Evol</a>, <a href="action=userinfo&user=18316" title="15-07-2013 20:51, ранг:141.7" target="_blank">SReg</a>, <a href="action=userinfo&user=14629" title="15-07-2013 22:08, ранг:311.0" target="_blank">sendersu</a>, <a href="action=userinfo&user=1931" title="15-07-2013 22:46, ранг:504.1" target="_blank">4kusNick</a>, <a href="action=userinfo&user=24257" title="16-07-2013 08:18, ранг:130.5" target="_blank">DenCoder</a>, <a href="action=userinfo&user=26651" title="16-07-2013 13:18, ранг:112.1" target="_blank">ELF_7719116</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июля 2013 08:04 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21938.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
А еще под кайфом были разработчики сего творения, например все тот же <b>CreateFile</b><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00459E0C</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;E8&nbsp;<span class="hl_number">2BDD3900</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_function">JMP</span><span class="hl_char">.</span><span class="hl_char">&amp;</span>KERNEL32<span class="hl_char">.</span>CreateFileA<span class="hl_char">&gt;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; \KERNEL32.CreateFileA</span></li>        </ol>
    </div>
</div></div>
<br>вот тут <i class=x>FileName</i> всегда пустой и все эт дело в цикле.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327684&amp;user=26651&amp;forum_n=5&amp;topic=21938.html&amp;page=0&amp;anchor=25" class="addthx" data-post="327684"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=13037" title="31-10-2014 16:40, ранг:7.8" target="_blank">Sn</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Где почитать про обход проверки целостности программы</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=21938" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
