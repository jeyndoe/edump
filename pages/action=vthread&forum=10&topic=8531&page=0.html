<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Help moving a function in ASM - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="I guys ,i wanted to learn asm and samedays ago i tryed to move this piece of code :  004075AD \&gt; C3       RETN 004075AE /&#036; 8B4424 04   MOV EAX,DWORD PTR SS:[ESP+4] 004075B2 |. 0FAF4424 08  IMUL EAX,DWORD PTR SS:[ESP+8]">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a> (+1 невидимый пользователь)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/e.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=10&sortBy=0&page=0.html"><b>WorldWide</b></a> <b class=bulletHead>&#8212;&#8250;</b> Help moving a function in ASM</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]iNNos[/b]','')">iNNos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.1 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.24'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11083">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 апреля 2007 02:24 &middot; Поправил: iNNos <br><script type="text/javascript">QU('iNNos','Цитата','writes');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=iNNos" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=10&amp;topic=8531.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
I guys ,i wanted to learn asm and samedays ago i tryed to move this piece of code : <br><br>004075AD  \&gt; C3             RETN<br>004075AE  /&#036; 8B4424 04      MOV EAX,DWORD PTR SS:[ESP+4]<br>004075B2  |. 0FAF4424 08    IMUL EAX,DWORD PTR SS:[ESP+8]<br>004075B7  |. 50             PUSH EAX                                                 ; /HeapSize<br>004075B8  |. 6A 08          PUSH 8                                                   ; |Flags = HEAP_ZERO_MEMORY<br>004075BA  |. FF15 18104000  CALL DWORD PTR DS:[&lt;&amp;KERNEL32.GetProcessHeap&gt;]           ; |[GetProcessHeap<br>004075C0  |. 50             PUSH EAX                                                 ; |hHeap<br>004075C1  |. FF15 14104000  CALL DWORD PTR DS:[&lt;&amp;KERNEL32.HeapAlloc&gt;]                ; \HeapAlloc<br>004075C7  \. C3             RETN<br><br>into this piece of NOP :<br><br>00407650   90       NOP<br>00407660   90       NOP<br>00407661   90       NOP<br>00407662   90       NOP<br>0040766F   90       NOP<br>00407670   90       NOP<br>00407672   90       NOP<br>0040767E   90       NOP<br>00407680   90       NOP<br>00407690   90       NOP<br>00407692   90       NOP<br>004076A2   90       NOP<br><br>I used first time the &quot;JMP&quot; jumping from here 004075AD to first NOP 00407650 adding under the same function but every time the exe crash ,if you can and have free time try to help me so i can undertand how to move function and structures ,thanks so much in advance
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=133106&amp;user=11083&amp;forum_n=10&amp;topic=8531.html&amp;page=0&amp;anchor=1" class="addthx" data-post="133106"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Halt[/b]','')">Halt</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 65.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.88'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=240">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 апреля 2007 03:04 &middot; Поправил: Halt <br><script type="text/javascript">QU('Halt','Цитата','writes');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Halt" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=10&amp;topic=8531.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
1. 004075AD ?! maybe from 004075AE  ?!<br>2. It more safety use piece with 00 for youre code, because this piece (with NOP) program can use for self.<br>3. what do you change in this code when moving it on new place, maybe the mistake is in it?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=133109&amp;user=240&amp;forum_n=10&amp;topic=8531.html&amp;page=0&amp;anchor=2" class="addthx" data-post="133109"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Icelot[/b]','')">Icelot</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/10492.jpg" alt=""><br><span class=txtSm>Ранг: 85.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10492">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 апреля 2007 07:00 <br><script type="text/javascript">QU('Icelot','Цитата','writes');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Icelot" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=10&amp;topic=8531.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Add to the end of your code RETN and look to the addres of return in the stack. Save them!
<br><br><font size="1"><i>-----<br> radio uno in ibisa ...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=133115&amp;user=10492&amp;forum_n=10&amp;topic=8531.html&amp;page=0&amp;anchor=3" class="addthx" data-post="133115"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]iNNos[/b]','')">iNNos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.1 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.24'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11083">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 апреля 2007 12:12 &middot; Поправил: iNNos <br><script type="text/javascript">QU('iNNos','Цитата','writes');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=iNNos" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=10&amp;topic=8531.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Yes sorry Halt i wanted to tell to JMP from 004075AE ,the RETN before i pasted for error , srry,then i tryed this:<br>If i make a JMP on the MOV it became like :<br>from:<br><br>004075AE  /&#036; 8B4424 04      MOV EAX,DWORD PTR SS:[ESP+4]<br>004075B2  |. 0FAF4424 08    IMUL EAX,DWORD PTR SS:[ESP+8]<br>004075B7  |. 50             PUSH EAX                                 ; /HeapSize<br>004075B8  |. 6A 08          PUSH 8                                   ; |Flags = HEAP_ZERO_MEMORY<br>004075BA  |. FF15 18104000  CALL DWORD PTR DS:[&lt;&amp;KERNEL32.GetProcess&gt;; |[GetProcessHeap<br>004075C0  |. 50             PUSH EAX                                 ; |hHeap<br>004075C1  |. FF15 14104000  CALL DWORD PTR DS:[&lt;&amp;KERNEL32.HeapAlloc&gt;&gt;; \HeapAlloc<br>004075C7  \. C3             RETN<br><br>became:<br><br>004075AE     E9 F8000000    JMP testing.00407650<br>004075B3     AF             SCAS DWORD PTR ES:[EDI]<br>004075B4     44             INC ESP<br>004075B5     24 08          AND AL,8<br>004075B7  |. 50             PUSH EAX                                           ; /HeapSize<br>004075B8  |. 6A 08          PUSH 8                                             ; |Flags = HEAP_ZERO_MEMORY<br>004075BA  |. FF15 18104000  CALL DWORD PTR DS:[&lt;&amp;KERNEL32.GetProcessHeap&gt;]     ; |[GetProcessHeap<br>004075C0  |. 50             PUSH EAX                                           ; |hHeap<br>004075C1  |. FF15 14104000  CALL DWORD PTR DS:[&lt;&amp;KERNEL32.HeapAlloc&gt;]          ; \HeapAlloc<br>004075C7  \. C3             RETN<br><br>and so i don&#039;t know well what can i change now because is changed the code down:<br>this the original :<br><br>004075AE  /&#036; 8B4424 04      MOV EAX,DWORD PTR SS:[ESP+4]<br>004075B2  |. 0FAF4424 08    IMUL EAX,DWORD PTR SS:[ESP+8]<br><br>after added the JMP on the MOV:<br><br>004075AE     E9 F8000000    JMP testing.00407650<br>004075B3     AF             SCAS DWORD PTR ES:[EDI]<br>004075B4     44             INC ESP<br>004075B5     24 08          AND AL,8<br><br>there is too new code under the JMP ,is it normal ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=133141&amp;user=11083&amp;forum_n=10&amp;topic=8531.html&amp;page=0&amp;anchor=4" class="addthx" data-post="133141"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Icelot[/b]','')">Icelot</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/10492.jpg" alt=""><br><span class=txtSm>Ранг: 85.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10492">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 апреля 2007 12:51 &middot; Поправил: Icelot <br><script type="text/javascript">QU('Icelot','Цитата','writes');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Icelot" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=10&amp;topic=8531.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Because you don&#039;t consider the size of original command and your&#039;s. It&#039;s should be equal. (sorry, i&#039;am bad english men <img src="img/smilies/s1.gif" alt=""> ). Look:<br>original -    004075B2 |. <b>0FAF4424</b> 08 IMUL EAX,DWORD PTR SS:[ESP+8]<br>after you - 004075B3 AF SCAS DWORD PTR ES:[EDI] <br>You clear one byte of original code! This is a error.<br><br><b>Note:</b><br>004075AE E9 F8000000 JMP testing.00407650 <br>004075B3 90 NOP<br>004075B4 90 NOP<br>004075B5 90 NOP <br>004075B7 |. 50 PUSH EAX ; /HeapSize<br>and add to end of you code before RETN this command:<br>4 04 MOV EAX,DWORD PTR SS:[ESP+4] <br>4424 08 IMUL EAX,DWORD PTR SS:[ESP+8] <br>Now, after the return to original code function with parametr /HeapSize will working normally.<br><br>PS Sorry about my english <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br> radio uno in ibisa ...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=133148&amp;user=10492&amp;forum_n=10&amp;topic=8531.html&amp;page=0&amp;anchor=5" class="addthx" data-post="133148"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Icelot[/b]','')">Icelot</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/10492.jpg" alt=""><br><span class=txtSm>Ранг: 85.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10492">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 апреля 2007 16:10 <br><script type="text/javascript">QU('Icelot','Цитата','writes');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Icelot" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=10&amp;topic=8531.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
And more.. If you use jmp, then use jmp for return. Else use <b>CALL testing.00407650</b> and RET, but watch to the stack.
<br><br><font size="1"><i>-----<br> radio uno in ibisa ...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=133191&amp;user=10492&amp;forum_n=10&amp;topic=8531.html&amp;page=0&amp;anchor=6" class="addthx" data-post="133191"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]iNNos[/b]','')">iNNos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.1 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.24'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11083">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2007 01:40 <br><script type="text/javascript">QU('iNNos','Цитата','writes');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=iNNos" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=10&amp;topic=8531.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Icelot thank you so so so so so much <img src="img/smilies/s1.gif" alt=""> ,don&#039;t worry about your english ,also my english isn&#039;t too good ;) ,so i understand perfect the JMP function and the return with the same JMP ,now i have to understand the CALL procedure and the RETN to came back on the stack <br>[quote]Else use CALL testing.00407650 and RET, but watch to the stack.[/quote]<br><br>can you explain me a little to use the CALL to move a piece of code ? <br>thanks in advance ;)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=133263&amp;user=11083&amp;forum_n=10&amp;topic=8531.html&amp;page=0&amp;anchor=7" class="addthx" data-post="133263"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Icelot[/b]','')">Icelot</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/10492.jpg" alt=""><br><span class=txtSm>Ранг: 85.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10492">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 апреля 2007 07:28 <br><script type="text/javascript">QU('Icelot','Цитата','writes');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Icelot" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=10&amp;topic=8531.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Example. Original:<br>004075AE /&#036; 8B4424 04 MOV EAX,DWORD PTR SS:[ESP+4] <br>004075B2 |. 0FAF4424 08 IMUL EAX,DWORD PTR SS:[ESP+8] <br>004075B7 |. 50 PUSH EAX ; /HeapSize <br>004075B8 |. 6A 08 PUSH 8 ; |Flags = HEAP_ZERO_MEMORY <br>004075BA |. FF15 18104000 CALL DWORD PTR DS:[&lt;&amp;KERNEL32.GetProcess&gt;; |[GetProcessHeap <br>004075C0 |. 50 PUSH EAX ; |hHeap <br>004075C1 |. FF15 14104000 CALL DWORD PTR DS:[&lt;&amp;KERNEL32.HeapAlloc&gt;&gt;; \HeapAlloc <br>004075C7 \. C3 RETN<br><br>If you want to use the CALL &amp; RET:<br>004075AE /&#036; XXXXXXXXXX CALL 00407650<br>004075B4 |. 90 NOP<br>004075B5 |. 90 NOP<br>004075B6 |. 90 NOP<br>004075B7 |. 50 PUSH EAX ; /HeapSize <br>004075B8 |. 6A 08 PUSH 8 ; |Flags = HEAP_ZERO_MEMORY <br>004075BA |. FF15 18104000 CALL DWORD PTR DS:[&lt;&amp;KERNEL32.GetProcess&gt;; |[GetProcessHeap <br>004075C0 |. 50 PUSH EAX ; |hHeap <br>004075C1 |. FF15 14104000 CALL DWORD PTR DS:[&lt;&amp;KERNEL32.HeapAlloc&gt;&gt;; \HeapAlloc <br>004075C7 \. C3 RETN<br><br>and here:<br>00407650 90 NOP      &lt;&lt;you wrote your code here <br>00407660 90 NOP      &lt;&lt;you wrote your code here <br>00407661 90 NOP      &lt;&lt;...<br>00407662 90 NOP <br>0040766F 90 NOP <br>00407670 90 NOP <br>00407672 90 NOP <br>0040767E 90 NOP <br>00407680 90 NOP <br>00407690 90 NOP <br>00407692 90 NOP <br>004076A2 90 NOP<br>004076A3 /&#036; 8B4424 04 MOV EAX,DWORD PTR SS:[ESP+4] <br>004076A7 |. 0FAF4424 08 IMUL EAX,DWORD PTR SS:[ESP+8]<br>004076AC C3 RET<br><br>May be i confuse with addresses. But it&#039;s not your problem. Just edit original and write your code.
<br><br><font size="1"><i>-----<br> radio uno in ibisa ...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=133269&amp;user=10492&amp;forum_n=10&amp;topic=8531.html&amp;page=0&amp;anchor=8" class="addthx" data-post="133269"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]iNNos[/b]','')">iNNos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.1 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.24'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11083">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 апреля 2007 19:38 <br><script type="text/javascript">QU('iNNos','Цитата','writes');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=iNNos" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=10&amp;topic=8531.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Thanks you soo much Icelot ;)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=133538&amp;user=11083&amp;forum_n=10&amp;topic=8531.html&amp;page=0&amp;anchor=9" class="addthx" data-post="133538"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/e.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=10&sortBy=0&page=0.html"><b>WorldWide</b></a> <b class=bulletHead>&#8212;&#8250;</b> Help moving a function in ASM</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#10" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="10">
<input type="hidden" name="topic" value="8531">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=8531" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
