<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>API - функция для VB - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Никак не могу найти описание __vbaNew2. Может кто подскажет?">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40382'>jinoweb</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> API - функция для VB</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2016 17:06 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Никак не могу найти описание __vbaNew2.<br>Может кто подскажет?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368776&amp;user=29754&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=1" class="addthx" data-post="368776"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]mysterio[/b]','')">mysterio</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1803.gif" alt=""><br><span class=txtSm>Ранг: 307.9 (мудрец), 196thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.17'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1803">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2016 17:17 &middot; Поправил: mysterio <br><script type="text/javascript">QU('mysterio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mysterio" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<noindex><a href="http://www.dotfix.net/doc/vb60_reversing.htm" rel="nofollow" target="_blank">Руководство по исследованию программ, написанных на Visual Basic 6.0</a></noindex> .... в гугле сейчас не занято ;)<br>не понравится на русском <noindex><a href="https://hvoidcode.wordpress.com/2016/02/06/vb-function-description-for-reversing/" rel="nofollow" target="_blank">пожалуйста - на китайском/английском</a></noindex>.<br><br>upd: у __vbaNew2 5 параметров.
<br><br><font size="1"><i>-----<br>Don_t hate the cracker - hate the code.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368777&amp;user=1803&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=2" class="addthx" data-post="368777"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2016 17:58 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>mysterio</b> - К сожалению там фактически ничего нет.<br>Написана только строчка: __vbaNew2 - аналог API - функции Dialogboxparam/a.<br>По смыслу - да аналоги, а по форме использования - нет: у них разное число параметров!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368781&amp;user=29754&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=3" class="addthx" data-post="368781"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]GPcH[/b]','')">GPcH</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3.gif" alt=""><br><span class=txtSm>Ранг: 631.1 (<b>!</b>), 62thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.37<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3">Участник</a><br><font color=blue>Автор VB Decompiler</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2016 21:09 <br><script type="text/javascript">QU('GPcH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GPcH" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
__vbaNew2 можно условно назвать CreateObject. Создает новый инстанс объекта.<br>Первый параметр адрес описания объекта, второй - адрес куда размещать созданный объект.
<br><br><font size="1"><i>-----<br>Никогда не делай то, что возможно. Стремись сделать то что невозможно впринципе!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368814&amp;user=3&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=4" class="addthx" data-post="368814"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 октября 2016 10:40 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>GPcH</b> у тебя на сайте раньше вроде где-то дока была по этой теме, потом потерялась из виду<br>убрал ссылку или переместилось куда?
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368846&amp;user=6946&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=5" class="addthx" data-post="368846"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 октября 2016 17:25 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>mysterio пишет:<br>upd: у __vbaNew2 5 параметров.<br> </I><br>Если бы так - то по числу параметров она совпадала бы с DialogBoxParamA.<br>У меня она запускает наг окно, и вроде бы ей передаются только два параметра.<br>Да и <b>GPcH</b> говорит только о двух параметрах.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368869&amp;user=29754&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=6" class="addthx" data-post="368869"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]GPcH[/b]','')">GPcH</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3.gif" alt=""><br><span class=txtSm>Ранг: 631.1 (<b>!</b>), 62thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.37<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3">Участник</a><br><font color=blue>Автор VB Decompiler</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 октября 2016 17:48 &middot; Поправил: GPcH <br><script type="text/javascript">QU('GPcH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GPcH" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>Isaev пишет:<br>GPcH у тебя на сайте раньше вроде где-то дока была по этой теме, потом потерялась из виду<br>убрал ссылку или переместилось куда?  </I><br><br>Ничего никуда не удалялось. Только у сайта редизайн был. Все тут: <noindex><a href="http://www.dotfix.net/doc.htm&amp;theme=/DotFix%20Software" rel="nofollow" target="_blank">Статьи по программированию и реверсу</a></noindex><br><br>К слову в плане VB6 я писал только по декомпиляции форм и декомпиляции P-Code в уме.
<br><br><font size="1"><i>-----<br>Никогда не делай то, что возможно. Стремись сделать то что невозможно впринципе!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368870&amp;user=3&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=7" class="addthx" data-post="368870"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29754" title="26-10-2016 15:24, ранг:56.7" target="_blank">ksol</a>, <a href="action=userinfo&user=6946" title="27-10-2016 07:59, ранг:726.4" target="_blank">Isaev</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]mysterio[/b]','')">mysterio</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1803.gif" alt=""><br><span class=txtSm>Ранг: 307.9 (мудрец), 196thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.17'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1803">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 октября 2016 18:01 <br><script type="text/javascript">QU('mysterio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mysterio" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>ksol</b><br>Ответ давал исходя из того что видел в дебагере - использовалось 5 параметров 2 адреса (push) и 3 регистра.
<br><br><font size="1"><i>-----<br>Don_t hate the cracker - hate the code.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368871&amp;user=1803&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=8" class="addthx" data-post="368871"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 октября 2016 18:37 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>mysterio</I><br>Может вы знаете какой из этих параметров содержит адрес обработчика<br>диалогового окна?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368872&amp;user=29754&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=9" class="addthx" data-post="368872"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]mysterio[/b]','')">mysterio</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1803.gif" alt=""><br><span class=txtSm>Ранг: 307.9 (мудрец), 196thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.17'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1803">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 октября 2016 20:50 <br><script type="text/javascript">QU('mysterio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mysterio" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
С &quot;барсиком&quot; не дружу, но логично предположить, если параметра 2 то первый это &quot;адрес обработчика&quot;, а второй кто/откуда его вызвал. Это сугубо догадки - дождись ответа того кто реально знает.
<br><br><font size="1"><i>-----<br>Don_t hate the cracker - hate the code.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368880&amp;user=1803&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=10" class="addthx" data-post="368880"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]GPcH[/b]','')">GPcH</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3.gif" alt=""><br><span class=txtSm>Ранг: 631.1 (<b>!</b>), 62thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.37<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3">Участник</a><br><font color=blue>Автор VB Decompiler</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 11:05 <br><script type="text/javascript">QU('GPcH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GPcH" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Показ формы в VB6 обычно производится так:<br><br>Создается копия объекта 00401364<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;loc_00401BC8<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">00402024h</span></li><li class="hl_l1">&nbsp;&nbsp;loc_00401BCD<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">00401364h</span></li><li class="hl_l0">&nbsp;&nbsp;loc_00401BD2<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_number">00401050h</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; __vbaNew2</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br><br>Получаем адрес виртуальной таблицы адресов пропертей и методов<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;loc_00401BF4<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_number">00402024h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0">&nbsp;&nbsp;loc_00401BFF<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br><br>Вызываем Property/Method формы. В данном случае 2B0 - это Show<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;loc_00401C1F<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_number">000002B0h</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br>Весь натив код VB6 - это сплошное COM/OLE. Логика анализа нужна немного другая.
<br><br><font size="1"><i>-----<br>Никогда не делай то, что возможно. Стремись сделать то что невозможно впринципе!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368895&amp;user=3&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=11" class="addthx" data-post="368895"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24257" title="27-10-2016 15:32, ранг:245.8" target="_blank">DenCoder</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 17:56 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>GPcH</b> - Спасибо за обстоятельное разъяснение! Собственно вопрос о __vbaNew2 стал ясен.<br>Но возникли другие:<br>Show - это открыть форму, а можно ли как-то задать в коде закрыть уже открытую форму,<br>или задать в её свойствах значение что-то типа Visible=false, чтобы она не открывалась совсем;<br>и другой вопрос - на другой форме стоит скрытый таймер, который через 10с её закрывает.<br>Похоже эти 10с заданы в свойствах формы. Не подскажете как их найти, чтобы заменить на 0.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368907&amp;user=29754&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=12" class="addthx" data-post="368907"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 18:46 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>ksol</b><br>Поделюсь своими соображениями<br><br><I>ksol пишет:<br>Show - это открыть форму, а можно ли как-то задать в коде закрыть уже открытую форм </I><br>По идее, когда получена инфа где находится и как устроена таблица, либо реверсом найти, либо как-то отловить SendMessage(hWnd, WM_CLOSE, NULL, NULL) и дальше по кросс-рефам выйти на искомый адрес в этой таблице.<br><br><I>ksol пишет:<br>или задать в её свойствах значение что-то типа Visible=false </I><br>Если метод Show показывает форму, то он должен вызывать api ShowWindow(hWnd, SW_SHOW) // SW_SHOW = 5<br>Чтобы найти метод Hide должно быть достаточно найти аналогичный код с вызовом ShowWindow(hWnd, SW_HIDE) // SW_HIDE = 0<br>Получение/Установка что дельфишных, что барсиковых свойств вызывает соответствующие методы get или set, насколько помню, в которых и будут вызовы соответствующих апи-функций.<br>....<br><br><I>ksol пишет:<br>Похоже эти 10с заданы в свойствах формы. </I><br>Скорее в коде при инициализации формы или после вызова Show инициализируется таймер с периодом в 10с. Это делается функцией SetTimer(), но необязательно, может быть и по-другому реализовано.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368909&amp;user=24257&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=13" class="addthx" data-post="368909"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29754" title="28-10-2016 14:15, ранг:57.7" target="_blank">ksol</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2016 17:35 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>DenCoder</b> - Спасибо, много всякого сказали! - есть что посмотреть!<br>Скорее всего устанавливать в отладчике ВР прямо на API SendMessage(), ShowWindow() <br>не возможно будет, если они вызываются из бейсиковских типа get(), set().<br>Это вы хорошо, предусмотрительно показали значения SW_SHOW и SW_HIDE - если<br>найду апи, вставлю!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368946&amp;user=29754&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=14" class="addthx" data-post="368946"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2016 17:49 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>ksol</b><br><br>В гуе фактически можно выделить три типа функционала, это если обобщить фундаментально разные механизмы. Их необходимо понимать, если вы начали дебажить шадов(гуй).<br><br>1. Есть непосредственно вызов ядерного сервиса, который выполняет задачу.<br>2. Есть теневой вызов из ядра при исполнении сервиса для юзер нотифи(apfn-dispatch). Так доставляются любые сообщения и выполняется механизм хуков.<br>3. Существует gdi batching&quot;, пакетная обработка запроса в ядро при выполнении любого сервиса. Так например можно отрисовать текст через сервис, который генерит звук <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368948&amp;user=40990&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=15" class="addthx" data-post="368948"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 октября 2016 12:13 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>ksol пишет:<br>Скорее всего устанавливать в отладчике ВР прямо на API SendMessage(), ShowWindow() <br>не возможно будет, если они вызываются из бейсиковских типа get(), set(). </I><br>Почему невозможно? user32.dll никто не отменял! И SendMessage и ShowWindow там. Упомянутые <b>difexacaw</b> сервисы вызываются оттуда для этих апи. Только бряк SendMessage() если только условный ставить, а то их много вызовов...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368978&amp;user=24257&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=16" class="addthx" data-post="368978"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 октября 2016 17:59 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Вот не подумал, что и бейсик пользуется user32.dll. BP ShowWindow срабатывает! Больше ничего<br>с ней пока не проверял, а обращение к SendMessage не находит совсем.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368984&amp;user=29754&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=17" class="addthx" data-post="368984"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 октября 2016 21:14 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>ksol пишет:<br>а обращение к SendMessage не находит совсем.  </I><br>Я предположил, что для закрытия формы посылается WM_CLOSE. Вероятно, форма не разрушается, а просто прячется. Так что та же ShowWindow() должна срабатывать.<br><br><I>ksol пишет:<br>BP ShowWindow срабатывает! Больше ничего<br>с ней пока не проверял </I><br>Дальше по стеку смотрите, кто её вызывает, и выйдете на метод из таблицы формы.<br><br><b>Добавлено спустя 2 минуты</b><br>Может быть несколько &quot;прокладок&quot; между ShowWindow() и методом формы.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368985&amp;user=24257&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=18" class="addthx" data-post="368985"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29754" title="30-10-2016 14:30, ранг:59.7" target="_blank">ksol</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ksol[/b]','')">ksol</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 102.0 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.98'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=29754">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 октября 2016 17:45 <br><script type="text/javascript">QU('ksol','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ksol" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24392.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>DenCoder пишет:<br>Дальше по стеку смотрите </I><br>Это я знаю. Нашел я SendMessage: надо было ловить как BP SendMessageA и тогда всё окей!<br>При трассировке видна последовательность вызовов этих двух функций: установка таймера<br>и окон. Нейтрализовать - это только дело времени.<br>Большое спасибо!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=369004&amp;user=29754&amp;forum_n=6&amp;topic=24392.html&amp;page=0&amp;anchor=19" class="addthx" data-post="369004"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> API - функция для VB</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24392" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
