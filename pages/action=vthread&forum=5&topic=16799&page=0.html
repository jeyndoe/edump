<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Джамп на сам-себя. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброго времени суток форумчане. Загрузил в Олю файл, и стал &quot;позновать мир&quot;. Наткнулся на следующий код: Code:       003700B1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Джамп на сам-себя.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]cosinus[/b]','')">cosinus</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 13.8 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.18'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=20919">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2010 15:09 <br><script type="text/javascript">QU('cosinus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cosinus" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16799.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброго времени суток форумчане.<br>Загрузил в Олю файл, и стал &quot;позновать мир&quot;. Наткнулся на следующий код:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">003700B1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_number">003700B3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_number">003700B4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_number">003700B5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l0"><span class="hl_number">003700B6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_number">003703DA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; по вызываемому адресу находятся инструкции 'pop eax, call eax'  </span></li><li class="hl_l1"><span class="hl_number">003700BB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_number">003700BC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_number">003700BD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span><span class="hl_number">44h</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; kernel32.CreateThread</span></li><li class="hl_l0"><span class="hl_number">003700C0</span>&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;EB&nbsp;FE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;<span class="hl_number">003700C0</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_number">003700C2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span><span class="hl_number">3Ch</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br>Вот дошёл я до адреса 003700С0 и понял что пишу эти строки в правильном подфоруме.<br>Нажимаю на F8 и регистр EIP показывает что без подсказки Реверсеров с <b>crackl@b</b>&#039;a мне не выйти из этого лабиринта.<br>Любопытства ради поставил бряк на 003700C2 и нажал F9, чисто позырить что будя дальше. И бряк сработал! Также смотрю в Оле окно &#039;Threads&#039; и вижу что поток создался.<br>Вот собственно просьба: У кого есть время и желание, пожалуйста поясните истину этого кода и как это вапще сработало ?<br>Заранее благодарю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=266474&amp;user=20919&amp;forum_n=5&amp;topic=16799.html&amp;page=0&amp;anchor=1" class="addthx" data-post="266474"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2010 15:49 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16799.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>cosinus</b><br>Хм. Хороший код. Выполнено сцепление калбэка и вызывающего кода в графе, это мутирующий код. Использован следующий способ. Перед калбэком определяется макро, связующее посредством процедурного ветвления вызывающий код:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">%</span>GET_CURRENT_GRAPH_ENTRY&nbsp;<span class="hl_function">macro</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>Call</b></span>&nbsp;<span class="hl_registr">Eax</span></li><li class="hl_l1"><span class="hl_function">endm</span></li>        </ol>
    </div>
</div></div>
<br>Например в данном случае:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">rThreadStartupRoutine<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">%</span>GET_CURRENT_GRAPH_ENTRY</li><li class="hl_l0">ThreadStartupRoutine&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;StartupContext<span class="hl_char">:</span>PVOID</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br>Тогда загрузка ссылки на калбэк происходит следующим образом:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">%</span>GET_GRAPH_ENTRY&nbsp;<span class="hl_function"><b>macro</b></span>&nbsp;PGET_CURRENT_GRAPH_ENTRY</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>Call</b></span>&nbsp;PGET_CURRENT_GRAPH_ENTRY</li><li class="hl_l0"><span class="hl_function">endm</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">%</span>GET_GRAPH_ENTRY&nbsp;rThreadStartupRoutine</li>        </ol>
    </div>
</div></div>
<br>Я использую аналогичный способ, только делаю блок выполняющий возврат глобальным для сокращения размера:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">%</span>GET_CURRENT_GRAPH_ENTRY&nbsp;<span class="hl_function">macro</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>Call</b></span>&nbsp;GetGraphReference</li><li class="hl_l0"><span class="hl_function">endm</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">%</span>GET_GRAPH_ENTRY&nbsp;<span class="hl_function"><b>macro</b></span>&nbsp;PGET_CURRENT_GRAPH_ENTRY</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>Call</b></span>&nbsp;PGET_CURRENT_GRAPH_ENTRY</li><li class="hl_l0"><span class="hl_function">endm</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">%</span>GET_GRAPH_REFERENCE&nbsp;<span class="hl_function">macro</span></li><li class="hl_l1">GetGraphReference<span class="hl_char">:</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">ret</span></li><li class="hl_l0"><span class="hl_function">endm</span></li>        </ol>
    </div>
</div></div>
<br><br>Модель основана на том факте, что инструкция <b>Call</b> загружает в стек адрес следующей за ней инструкции.<br><br>Если не секрет откуда взят этот код ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=266476&amp;user=17964&amp;forum_n=5&amp;topic=16799.html&amp;page=0&amp;anchor=2" class="addthx" data-post="266476"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]cosinus[/b]','')">cosinus</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 13.8 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.18'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=20919">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2010 16:43 &middot; Поправил: cosinus <br><script type="text/javascript">QU('cosinus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cosinus" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16799.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>Clerk</b> откровенно говоря нифига не понял <img src="img/smilies/s14.gif" alt=""><br>Если вас не затруднит, &quot;на пальцах&quot; поясните. После нажатия F9 какой именно код выполнялся?<br>Джамп на сам-себя ?, то как я из него вышел... Ведь по сути это тупик.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">003703DA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_number">003703DB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_number">003703DD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">pushad</span></li><li class="hl_l1"><span class="hl_number">003703DE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">24h</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br>P.S. Так же в этом файле присутствует следущий приём:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00401386</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_registr">esp</span></li><li class="hl_l1"><span class="hl_number">00401388</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span><span class="hl_registr">al</span></li><li class="hl_l0"><span class="hl_number">0040138A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_number">00401FED</span></li><li class="hl_l1"><span class="hl_number">0040138F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">ret</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_comment">;==================================</span></li><li class="hl_l0"><span class="hl_number">00401FED</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">al</span></li><li class="hl_l1"><span class="hl_number">00401FEF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">al</span></li><li class="hl_l0"><span class="hl_number">00401FF1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">al</span></li><li class="hl_l1"><span class="hl_number">00401FF3</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">al</span></li><li class="hl_l0"><span class="hl_number">00401FF5</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">al</span></li><li class="hl_l1"><span class="hl_number">00401FF7</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">al</span></li><li class="hl_l0"><span class="hl_number">00401FF9</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">al</span></li><li class="hl_l1"><span class="hl_number">00401FFB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">al</span></li><li class="hl_l0"><span class="hl_number">00401FFD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">al</span></li><li class="hl_l1"><span class="hl_number">00401FFF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Command crosses end of memory block</span></li><li class="hl_l0"><span class="hl_comment">;==================================</span></li>        </ol>
    </div>
</div></div>
<br>Дойдя до адреса 00401FFF и нажатия F8 я переместился на вполне нормальный код, но позвольте приберечь это для следующего вопроса.<br><br>Этот файл распознаётся антивирусом как Worm, и распространяется он через флешки. <br>Уж простите новичка, но не что так не даёт азарта как реверс вируса. Нежели просматривать в отладчике &quot;код по отправке SMS через интернет&quot;.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=266479&amp;user=20919&amp;forum_n=5&amp;topic=16799.html&amp;page=0&amp;anchor=3" class="addthx" data-post="266479"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2010 17:09 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16799.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>cosinus</b><br>После исполнения инструкции по адресу 0x3700B6 в стеке будет адрес возврата 0x3700BB, а Ip = 0x3703DA. Там инструкция <b>Pop Eax</b> извлечёт из стека адрес возврата, а следующее ветвление загрузит в стек адрес 0x3703DD и вернёт управление на следующую за вызывающим ветвлением инструкцию. Что тут может быть не понятно ?<br>Это такой способ загрузки ссылки, блок эквивалентен <b>Push 0x3703DD</b>. Только при перестройке графа смещение не может быть задано в виде константы или дельтасмещения.<br><br>На счёт 0x401386 - там вобще ничего не обычного нет. Просто холостые инструкции, так как !al.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=266480&amp;user=17964&amp;forum_n=5&amp;topic=16799.html&amp;page=0&amp;anchor=4" class="addthx" data-post="266480"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]cosinus[/b]','')">cosinus</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 13.8 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.18'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=20919">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2010 17:39 &middot; Поправил: cosinus <br><script type="text/javascript">QU('cosinus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cosinus" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16799.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Тут всё понятно, что парочка &#039;pop eax, call eax&#039; эквивалентна команде push 003703DDh.<br>И что создаётся поток, &quot;код&quot; которого начинается этого адреса.<br><br>Непонятно как выбрался из этого кода ?<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">003700C0</span>&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;EB&nbsp;FE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;<span class="hl_number">003700C0</span></li>        </ol>
    </div>
</div></div>
<br><br>А что касается 00401386, то тут тоже ясно что инструкция <b>add byte ptr ds:[eax],al</b> при al равно 0 является эквивалентом инструкции <b>nop</b>. Но дойдя до адреса 00401FFF нажал F8 и переместился на вполне нормальный код, просто не понятно как это произошло, если на вершине стека (да и под ней) находились адреса &quot;недров&quot; kernel32.dll  да и в регистрах тоже ничего интересного не было... а управление перешло на адрес 00402001. <br><b>До:</b><br><img src="http://s49.radikal.ru/i124/1010/a7/50892dd0cb2c.png" border="0" align="" alt=""><br><br><b>После:</b><br><img src="http://s59.radikal.ru/i163/1010/d0/78d87361571a.png" border="0" align="" alt=""><br><br>Но давайте сначала о &quot;Джампе на сам-себя&quot; поговорим.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=266481&amp;user=20919&amp;forum_n=5&amp;topic=16799.html&amp;page=0&amp;anchor=5" class="addthx" data-post="266481"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2010 17:57 &middot; Поправил: Clerk <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16799.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>cosinus</b><br>Поток зацикливается. Что с ним происходит далее - откуда же мне знать, может он так и висит за ненадобностью, может иной поток завершает его или изменяет его контекст, или инициирует исключение в нём, может есчо что, этого никто не знает.<br><br>&gt; управление перешло на адрес 00402001.<br>Ну это ведь следующая страница, кудаже есчо процессор перейдёт. Он выполнит <b>add byte ptr ds:[eax],al</b>(часть инструкции в конце первой страницы, часть в начале следующей <img src="img/smilies/s3.gif" alt=""> ), затем <b>Pushad</b>.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=266482&amp;user=17964&amp;forum_n=5&amp;topic=16799.html&amp;page=0&amp;anchor=6" class="addthx" data-post="266482"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]cosinus[/b]','')">cosinus</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 13.8 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.18'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=20919">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2010 18:38 &middot; Поправил: cosinus <br><script type="text/javascript">QU('cosinus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cosinus" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16799.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
&gt;&gt;Любопытства ради поставил бряк на 003700C2 и нажал F9, чисто позырить что будя дальше. И бряк сработал! <br>Это гвоорит о том что главный поток не остаётся в подвешенном состоянии<br>Видимо в создаваемом потоке кроется ответ, на то как выйти из джампа-на-сам-себя. Потому что создаётся поток с флагом dwCreationFlags.<br>цитата:<br>&quot;Флажки, которые управляют созданием потока. Если установлен флажок CREATE_SUSPENDED, создается поток в состоянии ожидания и не запускается до тех пор, пока не будет вызвана функция ResumeThread. <b>Если это значение нулевое, поток запускается немедленно после создания.</b> В это время, никакие другие значения не поддерживаются.&quot;<br><br>Я просто прозивал этот момент...<br><br><br>&gt;&gt;Ну это ведь следующая страница, кудаже есчо процессор перейдёт. <br>Ну тут уж даже не знал об этом. Спасибо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=266484&amp;user=20919&amp;forum_n=5&amp;topic=16799.html&amp;page=0&amp;anchor=7" class="addthx" data-post="266484"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2010 21:05 &middot; Поправил: Clerk <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16799.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>cosinus</b><br>&gt; Ну тут уж даже не знал об этом. Спасибо.<br>Виртуальная память линейная. Про сегментация памяти вы можите не подозревать, так что это только отладчика проблема, связанная с хидером модуля.<br><br>&gt; Это гвоорит о том что главный поток не остаётся в подвешенном состоянии<br>Это говорит о том, что код вызвал другой поток и что вы не умеете обращаться с отладчиком.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=266489&amp;user=17964&amp;forum_n=5&amp;topic=16799.html&amp;page=0&amp;anchor=8" class="addthx" data-post="266489"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]cosinus[/b]','')">cosinus</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 13.8 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.18'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=20919">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2010 21:13 &middot; Поправил: cosinus <br><script type="text/javascript">QU('cosinus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cosinus" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16799.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
&quot;Расцикливание&quot; главного потока осуществляется через SetThreadContext.<br><br>&gt;&gt;вы не умеете обращаться с отладчиком. <br>Ну дык стараюсь учиться уметь обращаться <img src="img/smilies/s1.gif" alt=""><br><br><b>Clerk</b> спасибо за потраченное на меня время.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=266492&amp;user=20919&amp;forum_n=5&amp;topic=16799.html&amp;page=0&amp;anchor=9" class="addthx" data-post="266492"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Джамп на сам-себя.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=16799" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
