<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Проблема с ASProtect 1.23 RC4 - 1.3.08.24 [1] - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Такой протектор показывает VerA 0.15. Нашел OEP(сразу вручную, через &quot;подсчет исключений&quot;, потом попробовал скрипт asprsoep.txt - результаты совпали).  Програмный пакет состоит из нескольких екзешников, и не все они">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Проблема с ASProtect 1.23 RC4 - 1.3.08.24 [1]</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2007 19:55 &middot; Поправил: tempread <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Такой протектор показывает VerA 0.15.<br>Нашел OEP(сразу вручную, через &quot;подсчет исключений&quot;, потом попробовал скрипт asprsoep.txt - результаты совпали).<br><br> Програмный пакет состоит из нескольких екзешников, и не все они запакованы.Посмотрел как выглядит OEP в запакованных екзешниках и EP в незапакованных.<br>Видно, что украденных байт нет(что не может не радовать <img src="img/smilies/s1.gif" alt="">).<br><br>Сделал дамп.<br><br>ImpRec автоматом не нашел импорт. Поэтому я в запустил запакованную прогу, дошел до OEP, дошел до импортируемой функции. Посмотрел где таблица импорта. Потом нашел, где она пишется. Перед созданием таблицы, обнулил. Создался импорт. Пустил прогу. Запустил ImpRec, импорт замечательно восстановился. Пофикил дамп. Дамп не запускается<img src="img/smilies/s9.gif" alt=""> Ошибку выдает какаято борландовская библиотека.<br><br>Запустил пофиксеный дамп в OllyDbg. Долго копался,пытаясь понять в чем дело. <br><br>В общем внутри одной борландовской библиотеки перебираются адреса функций(и имена) другой библиотеки.<br>И в сдапленной программе адреса определенной функции нет. Посмотрел что в запакованной програме в этом месте - там есть определенная функция. Ок,проблема вроде нашлась - плохой импорт.<br>В запакованной программе посмотрел, откуда она берет адрес той злощастной функции. Нашел. Хотел найти место, где же в запакованной программе этот адрес записывается. И с удивлением обнаружил, что этот адрес УЖЕ записан лоадером при старте ЗАПАКОВАНОЙ программы с EP. Получается, что распакованная протектором программа использует импорт(или функционально нечто подобное), созданный для запакованной программы!<br><br>Подскажите, что в каком направлении дальше идти? Необходимо как-то импорты созданный для запакованной и незапакованной программы обьединять?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147582&amp;user=7008&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=1" class="addthx" data-post="147582"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]El_Diablo[/b]','')">El_Diablo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 59.9 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.17'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11468">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2007 23:12 <br><script type="text/javascript">QU('El_Diablo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=El_Diablo" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Трассировку в ImpRec юзай для восстановления импорта,в некоторых случаях помогает.<br>Тутор от ARTeam  по распаковке данного прота в атаче<br><br><img src="img/attach.gif" alt=""> <a href="./files/7b49_20.07.2007_CRACKLAB.rU.tgz">7b49_20.07.2007_CRACKLAB.rU.tgz</a> - Unpacking_ASProtect_1.23_RC4-1.3.08.24_By_R@dier.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147608&amp;user=11468&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=2" class="addthx" data-post="147608"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июля 2007 03:09 <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Трассировку в ImpRec использовать не могу... Я еще нигде не встречал описание странной ситуации, которая у меня сложилась... Когда я запускаю в ImpRec&#039;а трассировку, распаковываемая програма ЗАКРЫВАЕТСЯ(причем так ведут себя все екзешники програмного пакета, которые запакованы)! Проверял на двух разных компьютерах... Это,наверное, защита какая-то отрабатывает? Как с таким бороться? <br>И вобще,все статьи,которые я прочитал про AsProtect 1.23, такие простые(перечитал уже много), там все просто и легко...А в моем случае,все почему то сложнее<img src="img/smilies/s9.gif" alt=""> Импорт исковеркан ужасно,адреса разманы среди большого количества мусора <img src="img/smilies/s9.gif" alt=""><br>И вопрос по поводу использования импорта запакованной программы программой распакованой остается в силе... Насколько я понимаю, у меня не сама программа распакованая использует импорт запакованной програмы, а dll&#039;ка распакованой программы использует этот импорт. И проблема в том, что в распакованой программе нет и упоминаний об импорте запакованной програмы.  Поэтому прога виснет. Жду подсказок...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147622&amp;user=7008&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=3" class="addthx" data-post="147622"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июля 2007 09:56 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>tempread пишет:<br>И с удивлением обнаружил, что этот адрес УЖЕ записан лоадером при старте ЗАПАКОВАНОЙ программы с EP </I><br>...так нельзя что-ли никак вписать этот адрес в распакованную программу??
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=147641&amp;user=1613&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=4" class="addthx" data-post="147641"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июля 2007 12:44 &middot; Поправил: tempread <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Есть такой код(mail thread,module vcl50):<br><code>400039F4                  PUSH ESI<br>400039F5                     PUSH EDI<br>400039F6                     MOV EDI,EDX<br>400039F8                     MOV ESI,DWORD PTR DS:[EAX-2C]<br>400039FB                     XOR ECX,ECX<br>400039FD                     MOV CL,BYTE PTR DS:[ESI]<br>400039FF                      INC ECX<br>40003A00                     REP MOVS BYTE PTR ES:[EDI],BYTE PTR DS:[ES]<br>40003A02                     POP EDI<br>40003A03                     POP ESI<br>40003A04                     RETN</code><br><br>Окно регистров выглядит(при EIP=400039FB) так:<br>EAX 4003F970 vcl50.@Stdctrls@TEdit@<br>ECX 00000006<br>EDX 0012F4A4 ASCII 06,&quot;TLabel&quot;<br>EBX 00000008<br>ESP 0012F480<br>EBP 0012F5B4<br>ESI 4003FA44 ASCII 05,&quot;TEdit&quot;<br>EDI 0012F4A4 ASCII 06,&quot;TLabel&quot;<br>EIP 400039FB vcl50.400039FB<br><br>Эта функция вызывается много раз(больше 100). Адреса функций в EAX меняются,  меняются ссылки на строки в других регистрах. И на n-ой итерации в EAX находится указатель на функцию, который находится в импорте запакованной программы(а в распакованной программе там нули...).... <br><I>DillerInc пишет:<br>..так нельзя что-ли никак вписать этот адрес в распакованную программу?? </I><br>Так как нету этого адреса, то и вписывать нечего....<br><br>Вот так выглядит окно регистров при ексепшене(ESI указывает на невыделенную область пямяти - происходит ексепшен,eax - указатель на функцию,который заполняется лоадером запакованной програмы, в даном случае это распакованная пррамма, поэтому тут неправильное значение...):<br><br>EAX 00684A48 indy50.00684A48<br>ECX 00000000<br>EDX 0012F4A4 ASCII 0E,&quot;TAdvStringGrid&quot;<br>EBX 00000004<br>ESP 0012F480 ASCII &quot;HJh&quot;<br>EBP 0012F5B4<br>ESI 8BFFFCC6<br>EDI 0012F4A4 ASCII 0E,&quot;TAdvStringGrid&quot;<br>EIP 400039FD vcl50.400039FD
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147656&amp;user=7008&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=5" class="addthx" data-post="147656"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июля 2007 13:27 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>tempread пишет:<br>Так как нету этого адреса, то и вписывать нечего.... </I><br>...обычно в таких случаях смотрят адрес в запакованной программе...<br>Но так я могу сколько угодно тыкать пальцем в небо -- проще будет дать ссылку на исследуемую программу,и кто-нибудь тебе,я думаю,поможет.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=147659&amp;user=1613&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=6" class="addthx" data-post="147659"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июля 2007 14:44 &middot; Поправил: tempread <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Ссылка на инсталляцию - тут http://www.semonitor.ru/semonitor-rus.exe <br>Из набора этих программ я пытаюсь распаковать dcmonitor.<br>Попытался его вырезать(для уменьшения размера), но там много dll, мог пропустить какую-нибудь...<br>Вырезанная версия http://upload.com.ua/get/899944624 <br><br>Вырезанная версия запускается с ошибкой о том,что не может найти какие-то свои данные, при закрытии, также ругается, что уже не может куда то сохранить данные,и не выходит. Но запускается...А большего, наверное ж для распаковки и не надо?<br><br>А это мой дамп dcmonitor.exe(с импортом): Дамп http://upload.com.ua/get/899944629 <br><br>В дампе, в место, перед самой ошибкой можно попась по bp 400039f4 eax==684a48
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147665&amp;user=7008&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=7" class="addthx" data-post="147665"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июля 2007 18:45 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>tempread</b><br>Скажи мне OEP,который ты нашёл...
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=147709&amp;user=1613&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=8" class="addthx" data-post="147709"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июля 2007 19:08 &middot; Поправил: tempread <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
OEP:<br>RVA=1000<br>VA=401000<br><br>IAT: <br>RVA:168b74<br>size:3a5d
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147711&amp;user=7008&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=9" class="addthx" data-post="147711"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2007 01:46 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>tempread</b><br>По-видимому,я разобрался.Но...<br>У меня распакованная программа падала явно в другом месте.А точнее в самой программе по ошибке доступа,что является более характерным вариантом остатков защиты.Дело в том,что падения в &quot;нейтральных&quot; библиотеках наводят на мысль,что что-то криво распаковалось.<br><br>По делу -- по адресу 004062C6 проиходит скорее всего вызов какой-то функции протектора:<br><br>004062C6 call dword ptr ds:[0055F474]<br><br>Так вот по адресу 0055F474 у нас нули,а должен быть адрес функции: 00405FCC<br><br>Вопрос на-вскидку: чем ты снимал дамп??<br><br>Прикрепляю ссылку на мой дамп,который у меня запускается:<br>ifolder.ru/2747159
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=147770&amp;user=1613&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=10" class="addthx" data-post="147770"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2007 02:51 &middot; Поправил: tempread <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Дамп снимал PE Tools v1.5.800.2006 RC7<br>Стоят галочки:<br>Full dump:paste header from disk<br>Full dump:fix header<br>Rebuild PE<br>Validate PE
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147776&amp;user=7008&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=11" class="addthx" data-post="147776"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2007 03:09 &middot; Поправил: tempread <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Сразу есть два вопроса:<br>1) Версия прота старая или нет? Я считал, что версия старая, и надеялся, что распакую &quot;влет&quot;(ведь столько статей про эту версию прота, где все делается чуть ли не автоматически).<br><br>2) Можете в двух словах написать, как  восстанавливали импорт?<br><br>P.S. Ваш дамп и у меня нормально запустился.<br>P.P.S. По поводу нулей по адресу 0055F474... В моем дампе там то, что нужно: <br>Address      Value           Comment<br>0055F474  00405FCC  Entry address
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147777&amp;user=7008&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=12" class="addthx" data-post="147777"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2007 12:10 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>tempread пишет:<br>Версия прота старая или нет? </I><br>...ну вроде да.<br><I>tempread пишет:<br>Можете в двух словах написать, как восстанавливали импорт? </I><br>...в принципе,как описано в статьях.Потом в ImpRec&#039;е правда пришлось долго руками мусор вычищать(cut thunks, delete thunks).Дампил с помощью <u>LordPE</u> в том месте,где мы заканчиваем разбираться с импортом:<br><br>call [eax]<br>popad      ; &lt;-- тут<br><br>В общем,всё стандартно.Приложу свою IAT.<br><br>Попробуй сделать дамп LordPE.У меня было пару случаев,когда PETools криво снимал дамп.<br><br>У меня есть вопрос.Когда-то давно кто-то на форуме объяснял,как можно зарегистрировать программу,защищённую ASProtect&#039;ом,найдя определённую сигнатуру в файле и изменив там один байт(00 на 01).<br>Может сейчас кто-нибудь это прокомментировать??<br><br><img src="img/attach.gif" alt=""> <a href="./files/91bc_22.07.2007_CRACKLAB.rU.tgz">91bc_22.07.2007_CRACKLAB.rU.tgz</a> - dcmonitor_IAT.rar
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=147801&amp;user=1613&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=13" class="addthx" data-post="147801"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2007 16:17 &middot; Поправил: tempread <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Замучался уже, все никак не получается самому распаковать<img src="img/smilies/s9.gif" alt=""><br><br>Сверил приложенную таблицу с IAT с той что у меня - у меня на одну функцию меньше... Ладно, беру Ваш IAT, накладываю на свой дамп - та же ошибка. Делаю дамп LordPE - ошибка все та же <img src="img/smilies/s9.gif" alt=""><br>Я делаю дамп находясь на OEP... <br><br>Не совсем понял где находится:<br>call [eax] <br>popad ; &lt;-- тут<br><br>Нашел функцию,где импорт заполняется, и после заполнения последней ячейки пробовал дампить - ошибка все та же<img src="img/smilies/s9.gif" alt=""><br><br>Пробовал дампить и OllyDump (находясь на OEP) - такая же ошибка, как и в других случаях<br><br>Еще раз статьи поперечитывал..Ничего нового вроде не вычитал... Может у меня опции програм не так стоят? Проверьте,пожалуйста, выше я приводил настройки PETools, вот настройки ImpRec:<br>Стоят галочки:<br>Create New IAT<br>Fix Ep to OEP<br>Enable Debug Provilege (NT,2K,XP)<br>Use PE header from disk<br><br>Настройки LordPE:<br>Стоят галочки:<br>Paste header from disk<br>Full Dump: Fix header<br>Realign file<br>WipeRelocation<br>Rebuild ImportTable<br>Validate PE
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147818&amp;user=7008&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=14" class="addthx" data-post="147818"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2007 17:15 &middot; Поправил: DillerInc <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Попробуй убрать галку &quot;Create new IAT&quot; из ImpRec&#039;а,т.к. во-первых это ни к чему в данном случае,а во-вторых кто-то однажды писал на форуме,что ImpRec неправильно обрабатывает эту опцию.<br><br>В LordPE вроде всё также.<br><I>tempread пишет:<br>Не совсем понял где находится:<br>call [eax]<br>popad ; &lt;-- тут  </I><br>...читай статью от <a href="http://exelab.ru/art/?action=view&amp;id=222" target="_blank">-= ALEX =-</a>, например.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=147826&amp;user=1613&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=15" class="addthx" data-post="147826"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2007 21:32 &middot; Поправил: tempread <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Ура! Получилось!<br>Вся проблема была в галочке &quot;Create new IAT&quot;. Как только снял - старая проблема пропала... Но появилось новая: об ошибке доступа от борландовской библиотеки, и когда я нажал ok,программа запустилась! Поизучав сдапленную програму в Оле, нашел откуда ошибка выскакивает: указатели на несуществующую память передается функции @System@@LStrFromPChar&#036;qqrr17System@AnsiStringpc&gt;,где и происходило исключение(два раза были исключения).<br><br><br>В запакованной программе один раз передается пустая строка, а второй раз -  &quot;l4QbcADQFoU=&quot;(без кавычек). Никто не подскажет, что закодировано(и каким алгоритмом) во второй строке? (возможно строка &quot;Unregistered&quot; ?)<br><br>Когда я подставил указатели на существующие строки в распакованой программе, она запустилась без ошибок, в About написано, что &quot;зарегистрировано на&quot;, и строку(которую я дважды подставлял). Никаких напоминаний и указаний о триале нигде нет.<br><br>Возник вопрос... В доке, которую я успел прочитать, пишется приблизительно такое &quot;Находим свободный кусок памяти, и пишем туда свою строку&quot;. А как собственно искать &quot;свободный кусок памяти&quot;?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147862&amp;user=7008&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=16" class="addthx" data-post="147862"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2007 21:52 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>tempread</b> на <b>А как собственно искать &quot;свободный кусок памяти&quot;?</b> промотай в конец секции кода там непременно будет участок с достаточным числом нулей(для записи строки).<br><br>Вот кратенький фрагмент участка скрипта, который я модефицирую:<br><br> FIND nastroika,#000000000000000000000000000000000000# //<b>ищем достаточно нулей с некоего адреса</b><br>  cmp &#036;RESULT,0<br>  je @sorry<br>  ...<br>  ... //<b>какие то действия</b><br>@sorry:  //  <b>а сюда на тот невероятный случай если нулей не найдено в достаточном количестве.</b><br>  eval &quot;Вижу ошибку адресации IAT по адресу {nastroika}, но не могу найти достаточно свободного места, чтобы исправить!&quot;<br>  msg &#036;RESULT
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147865&amp;user=9147&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=17" class="addthx" data-post="147865"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2007 22:04 &middot; Поправил: tempread <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
А разве не може быть ситуации, что код что-то будет писать в эти нули?(т.е. случай,когда это не просто результат выравнивания секции) Или этого почти никогда не бывает?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147867&amp;user=7008&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=18" class="addthx" data-post="147867"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2007 22:55 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>tempread</b><br>Скажи мне адрес,где вызывается эта функция,которой ты передаёшь свои указатели.Странно,что у меня никаких ошибок не выдаёт <img src="img/smilies/s11.gif" alt=""><br><I>tempread пишет:<br>А разве не може быть ситуации, что код что-то будет писать в эти нули? </I><br>...дело в том,что код в секции кода имеет строго определённый размер, т.е. сколько его написал программист.Это логично.<br>Остальное пространство в конце секции,занимаемое нулями,это есть выравнивание секции.Туда по идее ничего не может быть записано.<br><br>К тому же можно учесть тот факт,что секция кода при нормальных условиях имеет права доступа только для чтения и исполнения.Это явно предотвращает попытку записи в неё.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=147877&amp;user=1613&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=19" class="addthx" data-post="147877"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2007 00:26 <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
Я указатель передаю не сразу функции LStrFromPChar, а чуточку раньше, в функции самой програмы(а она уже запустит LStrFromPChar):<br>Я использовал свой дамп,и Ваш IAT. Мой дамп чуточку по другому работает чем Ваш... Ваш показывает -1 день осталось до окончания триала, а мой молчит.<br>Итак, адреса функций:<br>VA: 40d226<br>и<br>VA: 40d8e4<br><br>В регистре DX - указатели на строки, полученные из ds:[542ef4] и ds:[542f08] соответственно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147888&amp;user=7008&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=20" class="addthx" data-post="147888"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2007 11:49 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>tempread</b><br>Спасибо.Подставил свой указатель в первом случае и увидел своё имя в About, плюс программа перестала показывать окошко &quot;Reminder&quot;.<br>Немного не понял насчёт второго варианта.Там чуть выше по коду передаётся указатель на строку &quot;Ranking monitor&quot;.Может тогда где-то должна показыватся строка &quot;Standart, ... Edition&quot; ...?<br>Я подставил указатель на строку &quot;Expert Edition&quot;, но нигде подобной строки не показалось...
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=147920&amp;user=1613&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=21" class="addthx" data-post="147920"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2007 15:47 <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Шифрованная строка присутствует и в других екзешниках,например в loganalyzer.exe она равна &quot;jiZ1+ABwM9Q=&quot;. Может,насчет типа версии догадка и верна,но наверное, надо не просто подставлять строку, а как-то шифровать ее...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=147957&amp;user=7008&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=22" class="addthx" data-post="147957"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2007 21:03 <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Появился вопрос... Вначале,когда я все никак не мог распаковать, у меня по чуть-чуть уже крыша начала ехать<img src="img/smilies/s1.gif" alt="">,и от безисходности  я написал скриптик на перле,для помощи с импортом.<br><br>Входные данные: файлик с джампами(переходники на функции,просто копирую с окна OllyDbg), и файл ImpRecovera(сразу после GetImport,без скана).<br>Скриптик смотрит,какие есть переходники, и оставляет в файле Imprecover&#039;a только те записи,на которые были переходники.<br><br>Потом я полученный файлик загружаю в ImpRec, и уже мучаю до конца,точно зная, что все что там есть нужно обработать.<br><br>Тогда мне скриптик не помог, и я о нем подзабыл. А вот сейчас, когда помогли разобраться с проблемой, я вспомнил о скриптике. Только что проверил - работает... Так вот, вопрос вот в чем, можно ли применять данную методику очистки импорта или нет?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=148001&amp;user=7008&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=23" class="addthx" data-post="148001"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2007 22:23 <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9418.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
В общем, дальше все екзешники из этого програмного пакета поломались без проблем, тему закрываю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=149687&amp;user=7008&amp;forum_n=5&amp;topic=9418.html&amp;page=0&amp;anchor=24" class="addthx" data-post="149687"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Проблема с ASProtect 1.23 RC4 - 1.3.08.24 [1]</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=9418" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
