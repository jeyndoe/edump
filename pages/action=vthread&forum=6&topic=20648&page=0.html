<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Перехват DeviceIoControl с подменой значения дескриптора - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Подскажите,будет ли работать метод сплайсинга по исходникам MS-REM для этой функции? Или реально получить синий экран? В Гугле ещё прочитал про т.н. фаззинг (атаку) драйвера - может есть какая статья на эту тему,как лучше">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=1288'>UniSoft</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Перехват DeviceIoControl с подменой значения дескриптора</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ECROFONIVS_REBMEM[/b]','')">ECROFONIVS_REBMEM</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=33586">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2012 22:35 <br><script type="text/javascript">QU('ECROFONIVS_REBMEM','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ECROFONIVS_REBMEM" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20648.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Подскажите,будет ли работать метод сплайсинга по исходникам MS-REM для этой функции? Или реально получить синий экран? В Гугле ещё прочитал про т.н. фаззинг (атаку) драйвера - может есть какая статья на эту тему,как лучше осуществить сабж
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=316221&amp;user=33586&amp;forum_n=6&amp;topic=20648.html&amp;page=0&amp;anchor=1" class="addthx" data-post="316221"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2012 22:49 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20648.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Тьфу, закрой этот позорный топик. Ведь всё равно его закроют. Все ж догадались, кто это пишет <b>по исходникам MS-REM</b>.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=316222&amp;user=6336&amp;forum_n=6&amp;topic=20648.html&amp;page=0&amp;anchor=2" class="addthx" data-post="316222"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ECROFONIVS_REBMEM[/b]','')">ECROFONIVS_REBMEM</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=33586">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2012 23:03 <br><script type="text/javascript">QU('ECROFONIVS_REBMEM','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ECROFONIVS_REBMEM" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20648.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
А MS-REM бывает на этом форуме? Как можно с ним связаться? Хорошие статьи пишет,но очень всё древнее
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=316224&amp;user=33586&amp;forum_n=6&amp;topic=20648.html&amp;page=0&amp;anchor=3" class="addthx" data-post="316224"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2012 23:08 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20648.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
армия слонопотамов атакует екзе лаб,<br>клерка еле изгнали, другие *** появились
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=316227&amp;user=15381&amp;forum_n=6&amp;topic=20648.html&amp;page=0&amp;anchor=4" class="addthx" data-post="316227"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]OnLyOnE[/b]','')">OnLyOnE</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1989.png" alt=""><br><span class=txtSm>Ранг: 462.8 (мудрец), 468thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1989">Участник</a><br><font color=blue>Only One!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2012 23:09 <br><script type="text/javascript">QU('OnLyOnE','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OnLyOnE" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20648.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>ECROFONIVS_REBMEM пишет:<br>А MS-REM бывает на этом форуме? Как можно с ним связаться? Хорошие статьи пишет,но очень всё древнее  </I><br>Хороший вопрос... Нам бы с ним связаться тоже было б полезно <img src="img/smilies/s11.gif" alt="">
<br><br><font size="1"><i>-----<br>aLL rIGHTS rEVERSED!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=316228&amp;user=1989&amp;forum_n=6&amp;topic=20648.html&amp;page=0&amp;anchor=5" class="addthx" data-post="316228"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]OnLyOnE[/b]','')">OnLyOnE</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1989.png" alt=""><br><span class=txtSm>Ранг: 462.8 (мудрец), 468thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1989">Участник</a><br><font color=blue>Only One!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2012 23:11 &middot; Поправил: OnLyOnE <br><script type="text/javascript">QU('OnLyOnE','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OnLyOnE" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20648.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>reversecode пишет:<br>армия слонопотамов атакует екзе лаб,<br>клерка еле изгнали, другие *** появились<br> </I><br>клерк был самодур... НО умный самодур... эт факт <img src="img/smilies/s11.gif" alt=""><br>Опыта у него.. дай Бог каждому...
<br><br><font size="1"><i>-----<br>aLL rIGHTS rEVERSED!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=316229&amp;user=1989&amp;forum_n=6&amp;topic=20648.html&amp;page=0&amp;anchor=6" class="addthx" data-post="316229"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2012 23:20 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20648.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
человек ограничей GPE, который непротив убивать кошек и собак, считающий людей которые хотят завести семью и детей - маглами, - самодур? вы видимо его поклонник и тоже йогой занимаетесь?))<br><br>у кого опыта? у этого идиота?))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=316230&amp;user=15381&amp;forum_n=6&amp;topic=20648.html&amp;page=0&amp;anchor=7" class="addthx" data-post="316230"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ECROFONIVS_REBMEM[/b]','')">ECROFONIVS_REBMEM</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=33586">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2012 23:23 &middot; Поправил: ECROFONIVS_REBMEM <br><script type="text/javascript">QU('ECROFONIVS_REBMEM','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ECROFONIVS_REBMEM" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20648.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Что за Клерк,админ nodvd.net? Знаем такого,говорят он голову сильно ударил в школе и поэтому стал чокнутый. У меня вопрос,при чем здесь DeviceIoControl?<br>Суть вопроса то в чем: я пишу перехватчик этой функции и не знаю с чего мне начать. С CreateFile вроде всё просто,на каждом форуме по Делфи полно кодов,а тут весь гугл перерыл и никак не соображу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=316231&amp;user=33586&amp;forum_n=6&amp;topic=20648.html&amp;page=0&amp;anchor=8" class="addthx" data-post="316231"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2012 23:28 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20648.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>OnLyOnE</b><br>Клерк идиот не знающий элементарных вещей, даже о своих любимых графах, только о Гари Поттере и можно что то узнать от него.<br><br><b>ECROFONIVS_REBMEM</b><br>У нормальных людей работает.<br>Фаззинг дров.. у Краша была статья и исходники фазера, гугл ждет тебя свинофорце мембер, поржал.<img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=316232&amp;user=6&amp;forum_n=6&amp;topic=20648.html&amp;page=0&amp;anchor=9" class="addthx" data-post="316232"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ECROFONIVS_REBMEM[/b]','')">ECROFONIVS_REBMEM</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=33586">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2012 23:40 <br><script type="text/javascript">QU('ECROFONIVS_REBMEM','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ECROFONIVS_REBMEM" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20648.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
А я не знаю,мне фаззинг наверно и не нужен. Я буду открывать драйвер через CreateFile,считывать его дескриптор и потом подсовывать его в распакованной проге там где будет вызов DeviceIoControl.<br><noindex><a href="http://vsokovikov.narod.ru/New_MSDN_API/Device_io/fn_deviceiocontrol.htm" rel="nofollow" target="_blank">http://vsokovikov.narod.ru/New_MSDN_API/Device_io/fn_deviceiocontrol.htm</a></noindex><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Замечания</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Чтобы&nbsp;извлечь&nbsp;данные&nbsp;о&nbsp;дескрипторе&nbsp;устройства<span class="hl_char">,</span><span style="word-break: break-all">&nbsp;Вы&nbsp;должны&nbsp;вызвать&nbsp;функцию&nbsp;CreateFile&nbsp;или&nbsp;с&nbsp;именем&nbsp;устройства&nbsp;или&nbsp;с&nbsp;именем&nbsp;драйвера</span><span class="hl_char">,</span>&nbsp;связанного&nbsp;с&nbsp;устройством<span class="hl_char">.</span>&nbsp;Чтобы&nbsp;определить&nbsp;имя&nbsp;устройства<span class="hl_char">,</span>&nbsp;используйте&nbsp;ниже&nbsp;перечисленный&nbsp;формат<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">\</span><span class="hl_char">.</span><span class="hl_char">\</span>DeviceName</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Функция&nbsp;DeviceIoControl&nbsp;может&nbsp;принять&nbsp;дескриптор&nbsp;конкретного&nbsp;устройства<span class="hl_char">.</span>&nbsp;Например<span class="hl_char">,</span>&nbsp;чтобы&nbsp;открыть&nbsp;дескриптор&nbsp;логического&nbsp;диска&nbsp;A<span class="hl_char">:</span>&nbsp;при&nbsp;помощи&nbsp;функции&nbsp;CreateFile<span class="hl_char">,</span>&nbsp;задайте&nbsp;<span class="hl_char">\</span><span class="hl_char">.</span><span class="hl_char">\</span>a<span class="hl_char">:</span><span class="hl_char">.</span>&nbsp;Альтернативно<span class="hl_char">,</span>&nbsp;Вы&nbsp;можете&nbsp;использовать&nbsp;имена&nbsp;<span class="hl_char">\</span><span class="hl_char">.</span><span class="hl_char">\</span>PhysicalDrive0<span class="hl_char">,</span>&nbsp;<span class="hl_char">\</span><span class="hl_char">.</span><span class="hl_char">\</span>PhysicalDrive1&nbsp;и&nbsp;так&nbsp;далее<span class="hl_char">,</span>&nbsp;чтобы&nbsp;открывать&nbsp;дескрипторы&nbsp;на&nbsp;физические&nbsp;диски&nbsp;в&nbsp;системе<span class="hl_char">.</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=316233&amp;user=33586&amp;forum_n=6&amp;topic=20648.html&amp;page=0&amp;anchor=10" class="addthx" data-post="316233"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2012 23:43 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20648.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Ну раз пошла такая пьянка, то задам внятный вопрос по старфорсу. Установил я на варю Daemon Tools, потом установил Syser, вручную включил службу sptd (в реестре параметр запуска на 0 поменял), потом через RKU снимаю ядерные колбэк-обработчики этой прекрасной sptd, и дебаггер у меня запускается, работает. Даемон тулз тож диски эмулит, и всё в шоколаде, но Syser работает только с установленными на виртуалке VMware tools, а для этого строку <b>isolation.tools.getVersion.disable = &quot;TRUE&quot;</b> из конфига виртуалки мне приходится стирать, что приводит к тому, что хитрожопый старфорс детектит виртуалку через i/o backdoor механизм, т.е как-то так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;0x564D5868&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">10</span></li><li class="hl_l0"><span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">dx</span><span class="hl_char">,</span>&nbsp;0x5658&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>in</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">dx</span></li>        </ol>
    </div>
</div></div>
<br><br>bpio в Syser ничего не дают, т.е. где-то эта грёбаная инструкция есть, а где - непонятно. Трассировал с условием ехе, защищённый старфорсом, трассировал в лог и делал поиск по логу - болт. В Syser вписал tss, и в ответ увидел, что I/O Map size = 0, а по инфе <noindex><a href="http://dims.karelia.ru/x86/env_6.shtml" rel="nofollow" target="_blank">--&gt; Отсюда &lt;--</a></noindex> я понял, что если размер нулевой, то все биты битовой карты считаются взведенными, а значит вызов иснтрукции типа in xxx,xx будет делать исключение. Внимание, вопрос - как бы так оставить VMware tools, но убрать этот грёбаный бэкдор?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=316234&amp;user=6336&amp;forum_n=6&amp;topic=20648.html&amp;page=0&amp;anchor=11" class="addthx" data-post="316234"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]OnLyOnE[/b]','')">OnLyOnE</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1989.png" alt=""><br><span class=txtSm>Ранг: 462.8 (мудрец), 468thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1989">Участник</a><br><font color=blue>Only One!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2012 23:49 <br><script type="text/javascript">QU('OnLyOnE','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OnLyOnE" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20648.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>F_a_u_s_t пишет:<br>Клерк идиот не знающий элементарных вещей, даже о своих любимых графах, только о Гари Поттере и можно что то узнать от него.<br> </I><br><I>reversecode пишет:<br>человек ограничей GPE, который непротив убивать кошек и собак, считающий людей которые хотят завести семью и детей - маглами, - самодур? вы видимо его поклонник и тоже йогой занимаетесь?))<br><br>у кого опыта? у этого идиота?))  </I><br><br>Пусть так.. НО у меня о нем не было негативного восприятия.. да самодур, да экстравагантен ... но мозг есть.. кстати MS-REM тоже не был &quot;пенькой&quot; НО был умницей... Это факт! <img src="img/smilies/s11.gif" alt="">
<br><br><font size="1"><i>-----<br>aLL rIGHTS rEVERSED!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=316235&amp;user=1989&amp;forum_n=6&amp;topic=20648.html&amp;page=0&amp;anchor=12" class="addthx" data-post="316235"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ECROFONIVS_REBMEM[/b]','')">ECROFONIVS_REBMEM</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=33586">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2012 23:56 <br><script type="text/javascript">QU('ECROFONIVS_REBMEM','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ECROFONIVS_REBMEM" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20648.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Так что,MS-REM не заходит сюда? Мы хотели ему предложить писать статьи в нашем журнале.<br>Если кто 31 декабря будет свободен,то вот тут мероприятие намечается:<br><noindex><a href="http://svinovod2012.livejournal.com/5816.html" rel="nofollow" target="_blank">Обращение отца нации к реверсерам</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=316236&amp;user=33586&amp;forum_n=6&amp;topic=20648.html&amp;page=0&amp;anchor=13" class="addthx" data-post="316236"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 декабря 2012 23:58 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20648.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>ECROFONIVS_REBMEM</b><br>Чувак, он, типа, умер.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=316237&amp;user=6336&amp;forum_n=6&amp;topic=20648.html&amp;page=0&amp;anchor=14" class="addthx" data-post="316237"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ECROFONIVS_REBMEM[/b]','')">ECROFONIVS_REBMEM</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=33586">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 декабря 2012 00:02 <br><script type="text/javascript">QU('ECROFONIVS_REBMEM','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ECROFONIVS_REBMEM" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20648.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Ну ладно,не смешная шутка получилась.Сегодня я буду Архаром:<br>Умрите,Свиноводы! Тема закрыта
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=316238&amp;user=33586&amp;forum_n=6&amp;topic=20648.html&amp;page=0&amp;anchor=15" class="addthx" data-post="316238"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Перехват DeviceIoControl с подменой значения дескриптора</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=20648" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
