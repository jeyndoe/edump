<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Denuvo - мнение\опыт\обсуждение - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Мы тут обещали: Готовый пример на 50 мин. видео по распаковке Denuvo и обходу CPUID [RUS] Зеркала: https://mega.nz/#!XdtDGbCS!qdAemhodvvVq5_2gVhpaN4RMFB0sK0xCq42OCezKnDM Уже найдено в сети: https://youtu.be/M4-8VLGQWnY">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Denuvo - мнение\опыт\обсуждение</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=24286&amp;page=2.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=24286&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=13&amp;topic=24286&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=24286&amp;page=2.html">3</a> . <b>4</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]v00doo[/b]','')">v00doo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 80.6 (постоянный), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.07'>Активность: 0.1<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=35168">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 августа 2016 18:24 &middot; Поправил: v00doo <br><script type="text/javascript">QU('v00doo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=v00doo" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#1');return false;">#1</a> </span><div align=left><br>
Мы тут обещали:<br><br><b>Готовый пример на 50 мин. видео по распаковке Denuvo и обходу CPUID [RUS]</b><br><b>Зеркала:</b><br>https://mega.nz/#!XdtDGbCS!qdAemhodvvVq5_2gVhpaN4RMFB0sK0xCq42OCezKnDM<br>Уже найдено в сети:<br>https://youtu.be/M4-8VLGQWnY<br>https://www.youtube.com/watch?v=4LlVenBI1WE<br><br><u>Английский вариант будет позже ближе к ночи, еще не рендерили.</u><br><br>Мы так же знаем, о наличии <b>x86</b> билда Denuvo, который уже повесили на игры, интрига остается...<br><br><b>Принимаем критику\идеи\опыт.</b><br><br><b>Два основных условия топика:<br>1. Не просить кряки! Топик создан для исследования принципов и механизмов работы защиты.<br>2. Флуд в теме не приветствуется, но допускается в разумных количествах, всех нарушителей, кто перейдет черту - будут удалять.</b><br><br><u>По активности темы можно будет понять насколько это интересует людей.</u>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367061&amp;user=35168&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=1" class="addthx" data-post="367061"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3230" title="31-08-2016 15:38, ранг:113.9" target="_blank">Bronco</a>, <a href="action=userinfo&user=4554" title="31-08-2016 15:54, ранг:212.5" target="_blank">HandMill</a>, <a href="action=userinfo&user=18316" title="31-08-2016 16:05, ранг:209.3" target="_blank">SReg</a>, <a href="action=userinfo&user=41242" title="31-08-2016 17:30, ранг:0.0" target="_blank">sem0374</a>, <a href="action=userinfo&user=3400" title="31-08-2016 18:13, ранг:1.5" target="_blank">WildGoblin</a>, <a href="action=userinfo&user=11127" title="31-08-2016 18:14, ранг:144.5" target="_blank">SER[G]ANT</a>, <a href="action=userinfo&user=41243" title="31-08-2016 18:20, ранг:0.0" target="_blank">Johnatalbi</a>, <a href="action=userinfo&user=40841" title="31-08-2016 18:45, ранг:1.0" target="_blank">mkdev</a>, <a href="action=userinfo&user=34764" title="31-08-2016 19:03, ранг:0.9" target="_blank">red0x</a>, <a href="action=userinfo&user=4093" title="31-08-2016 19:42, ранг:129.0" target="_blank">verdizela</a>, <a href="action=userinfo&user=29223" title="31-08-2016 19:50, ранг:17.9" target="_blank">Haoose-GP</a>, <a href="action=userinfo&user=16199" title="31-08-2016 20:09, ранг:8.6" target="_blank">Qbik</a>, <a href="action=userinfo&user=31325" title="31-08-2016 22:06, ранг:6.2" target="_blank">zNob</a>, <a href="action=userinfo&user=40300" title="31-08-2016 23:26, ранг:2.0" target="_blank">exit_2</a>, <a href="action=userinfo&user=41162" title="01-09-2016 05:02, ранг:2.0" target="_blank">Groul</a>, <a href="action=userinfo&user=34842" title="01-09-2016 05:59, ранг:0.0" target="_blank">kurorolucifer</a>, <a href="action=userinfo&user=4618" title="01-09-2016 06:38, ранг:233.2" target="_blank">Nightshade</a>, <a href="action=userinfo&user=11" title="01-09-2016 06:49, ранг:190.9" target="_blank">gloom</a>, <a href="action=userinfo&user=41181" title="01-09-2016 07:47, ранг:-4.0" target="_blank">apan</a>, <a href="action=userinfo&user=12" title="01-09-2016 08:37, ранг:92.4" target="_blank">Styx</a>, <a href="action=userinfo&user=1931" title="01-09-2016 10:28, ранг:690.7" target="_blank">4kusNick</a>, <a href="action=userinfo&user=3136" title="01-09-2016 12:54, ранг:292.9" target="_blank">Veliant</a>, <a href="action=userinfo&user=40172" title="01-09-2016 16:12, ранг:2.5" target="_blank">6oTBa</a>, <a href="action=userinfo&user=40928" title="02-09-2016 10:00, ранг:0.0" target="_blank">nv</a>, <a href="action=userinfo&user=40243" title="03-09-2016 22:13, ранг:4.0" target="_blank">rus935</a>, <a href="action=userinfo&user=41088" title="04-09-2016 07:51, ранг:2.5" target="_blank">oldman</a>, <a href="action=userinfo&user=40983" title="05-09-2016 14:39, ранг:0.0" target="_blank">Mast3r</a>, <a href="action=userinfo&user=41177" title="11-09-2016 05:55, ранг:-9.0" target="_blank">Sexist</a>, <a href="action=userinfo&user=39173" title="20-09-2016 14:59, ранг:0.0" target="_blank">kassane</a>, <a href="action=userinfo&user=41013" title="13-10-2016 18:03, ранг:0.1" target="_blank">kouljaboy</a>, <a href="action=userinfo&user=41663" title="20-11-2016 10:53, ранг:0.0" target="_blank">JabukeGrada</a>, <a href="action=userinfo&user=2694" title="31-01-2017 09:28, ранг:12.1" target="_blank">ZLOFENIX</a>, <a href="action=userinfo&user=50677" title="19-02-2020 12:57, ранг:0.0" target="_blank">Voices_of_the_BULG</a></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 октября 2016 16:48 &middot; Поправил: Bronco <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#2');return false;">#2</a> </span><div align=left><br>
<I>oldman пишет:<br>&quot;Мы не молчим, мы работаем&quot; </I><br>Респект, хучить црц и ловить инструкции на передаче управления из вм - рациональное решение. <img src="img/smilies/s3.gif" alt=""><br>Оффтоп: &quot;Нас мало, но мы в тельняшках&quot;<img src="img/smilies/s16.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368521&amp;user=3230&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=2" class="addthx" data-post="368521"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 октября 2016 12:00 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#3');return false;">#3</a> </span><div align=left><br>
Я не вникал в суть вопроса, но если цель - отследить cpuid, то можно исходить из следующих соображений. Хардверно мы отключить эту инструкцию не можем(установить ловушку). Поэтому есть два варианта - либо найти код с этой инструкцией, что фактически невозможно, так как код может формироваться в динамике, по этой же причине и как второй вариант - отследить инструкцию из их потока, запустив эмуляцию(динамическую - частичную). Для этого не нужно разворачивать какие то вм, достаточно локальной для потока, стековой вм, тоесть надстройки над кодом. Это в данный момент годная технология. Из плюсов - высокое быстродействие и невозможность детекта обычного типа(гипервизора, так как его нет). Детект фактически может быть по NPX-раскрытию указателя, что фиксится на уровне этой вм, в остальном очевидных проблем не возникает.<br><br>Забыл привести пример, такого типа вм применялась для отладки тяжёлых приложений(DBI - автоматика), к примеру гугл хроме.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368656&amp;user=40990&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=3" class="addthx" data-post="368656"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 октября 2016 12:15 <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#4');return false;">#4</a> </span><div align=left><br>
<I>difexacaw пишет:<br>но если цель - отследить cpuid </I><br><br>Эта задача решена полностью, проблема в другой области, а она требует всё таки вникать в работу вм. Хотя есть<br>и другие варианты.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368657&amp;user=41088&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=4" class="addthx" data-post="368657"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 октября 2016 12:20 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#5');return false;">#5</a> </span><div align=left><br>
<b>oldman</b><br><br>Ну я тока про одну целевую инструкцию написал, про то как устроена вм я не говорил и хз. Но в любом случае способа есть два - трассировать весь код или найти сигнатурно в памяти инструкцию. Аналогичные методы могут применяться и для анализа вм - имея трассу можно выделить автоматикой из неё макросы, фактически выполнить деморф.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368659&amp;user=40990&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=5" class="addthx" data-post="368659"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 октября 2016 12:28 <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#6');return false;">#6</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Но в любом случае способа есть два - трассировать весь код </I><br><br>Беда в том, что с существующими в паблике инструментами (трасер в x64dbg) скорость трассинга низкая,<br>порядка 10-15 тысяч инструкций в секунду. А чтобы был какой то результат за разумное время , эту<br>скорость надо бы раз в 5-10 увеличить <img src="img/smilies/s1.gif" alt=""><br><br><I>difexacaw пишет:<br>про то как устроена вм я не говорил и хз </I><br><br>Подключайся, кино посмотри и вперёд <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368660&amp;user=41088&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=6" class="addthx" data-post="368660"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 октября 2016 12:37 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#7');return false;">#7</a> </span><div align=left><br>
<b>oldman</b><br><br>&gt; скорость трассинга низкая, порядка 10-15 тысяч инструкций в секунду<br><br>Так я говорил не про железячную, а про стековую вм. На x86 профайлинг даёт в 10 раз ниже скорость, по сравнению с прямым исполнением(причем с плохой оптимизацией кода, повторная раскодировка инструкций етц), что можно считать очень хорошим показателем. Под отладочным портом скорость падает до не приемлемой. TF уже не пригоден для отладки.<br><br>Подробно что бы было понятна суть - инструкция выбирается из потока, копируется в буфер и там исполняется, затем прямым ветвлением получает управление вм, которая выбирает следующую инструкцию и так на каждой итерации; ветвления эмулируются. Стековая вм - потому что не происходит изоляция стека, он общий для вм и для трассируемого кода.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368661&amp;user=40990&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=7" class="addthx" data-post="368661"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 октября 2016 13:39 <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#8');return false;">#8</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Подробно что бы было понятна суть </I><br><br>Идея понятна. Реализация какая-нибудь существует?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368663&amp;user=41088&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=8" class="addthx" data-post="368663"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 октября 2016 14:08 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#9');return false;">#9</a> </span><div align=left><br>
<b>oldman</b><br><br>Используется уже давно для множества задач - защиты, обхода CFG/CFI, VM, будет использоваться для поиска целевых ссылок в приложении.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368664&amp;user=40990&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=9" class="addthx" data-post="368664"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 октября 2016 14:26 <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#10');return false;">#10</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Используется уже давно для множества задач </I><br><br>ну и где она? опять по приватам? <img src="img/smilies/s6.gif" alt=""> Теоретические изыски это всё конечно очень интересно, но этих теорий<br>уже и так слишком много.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368665&amp;user=41088&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=10" class="addthx" data-post="368665"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]apan[/b]','')">apan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.8 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.91'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41181">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 октября 2016 23:23 <br><script type="text/javascript">QU('apan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=apan" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#11');return false;">#11</a> </span><div align=left><br>
<I>“The procedure [after a crack] is the same every time. We analyze how the crack was done and then we update our protection. It’s a game of cat and mouse that we play,” Blaukovitsch says.</I><br><br>Какие аналогии блаукович делает. Сейчас бы хороший анализ защиты, расписать о вреде для легальных пользователей с последующим её распространением, нужна хорошая драма ради веселья.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368681&amp;user=41181&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=11" class="addthx" data-post="368681"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2016 01:43 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#12');return false;">#12</a> </span><div align=left><br>
<b>oldman</b><br><br>Это всё очень давно есть в паблике, даже и публикации за последнее время. Не хочу приводить ссыли или аттачить тонны архивов по своим причинам, там всюду копирайты, ну а я пока хотел бы не отсылаться на это. Более того, идея ясна ну а реализация элементарна, там никаких алгосов нет.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368684&amp;user=40990&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=12" class="addthx" data-post="368684"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 октября 2016 02:20 &middot; Поправил: oldman <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#13');return false;">#13</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Не хочу приводить ссыли </I><br><br>Линк не надо, слова для гугля напиши, можешь в личку <img src="img/smilies/s2.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368685&amp;user=41088&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=13" class="addthx" data-post="368685"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 октября 2016 15:24 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#14');return false;">#14</a> </span><div align=left><br>
<b>oldman</b><br><br>Смотрите, опишу фундаментальный механизм трассировки подробно. Это робит очень шустро, никакой другой способ не может дать такой профайл.<br><br>Если заполнить буфер последовательностью EB90EB90.., то в зависимости от смещения в буфере будет инструкция jmp near rel или nop/jmp. -110 байт смещение на блок, заполненный короткими релатив jmp на near jmp, который вызывает трассировщик.<br><br>Тогда мы можем взять просто скопировать инструкцию в такой буфер и передать на него управление. Используем следующую особенность. Вероятность страничной ошибки при копировании инструкции мала, так код в модулях никогда не занимает секцию целиком, имеется место из за выравнивания страницы. Поэтому можно не юзать дизасм длин для копирования инструкции. Можно её копировать через mosd etc как 16 байт и при событии #AV(для модулей не будет) прекращать копирование. Это даст профайл больший, чем копирование длины через rep movsb.<br><br>Для обработки понадобятся две структуры(масм дефейны), это машинный фрейм с состоянием задачи, имеющий одну особенность.<br><br>Структура, описывает сохраняемые регистры(pushad):<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">RGP&nbsp;struct</li><li class="hl_l1">rEdi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">rEsi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">rEbp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">rEsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">rEbx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">rEdx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">rEcx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">rEax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">RGP&nbsp;<span class="hl_function">ends</span></li>        </ol>
    </div>
</div></div>
<br><br>Структуры необходимые для возврата через iret/retf:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">IFRAME&nbsp;struct</li><li class="hl_l1">rEip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PVOID&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">rCs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ULONG&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">rEFlags&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">IFRAME&nbsp;<span class="hl_function">ends</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">RFRAME&nbsp;struct</li><li class="hl_l1">rEip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PVOID&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">rCs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ULONG&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">RFRAME&nbsp;<span class="hl_function">ends</span></li>        </ol>
    </div>
</div></div>
<br><br>Профайл между iret и retf - последняя выполняется в два раза быстрее(если юзать в виде IFRAME -&gt; pushfd/popfd/retf 8).<br><br>Наконец две основные рабочие структуры:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">TSTATE&nbsp;struct</li><li class="hl_l1">Rgp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RGP&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span></li><li class="hl_l0">Stack&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PIFRAME&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">Control&nbsp;&nbsp;&nbsp;IFRAME&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span></li><li class="hl_l0">TSTATE&nbsp;<span class="hl_function">ends</span></li>        </ol>
    </div>
</div></div>
<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">ESTATE&nbsp;struct</li><li class="hl_l1">Rgp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RGP&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span></li><li class="hl_l0">Stack&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PIFRAME&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">Space&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RGP&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span></li><li class="hl_l0">Control&nbsp;&nbsp;&nbsp;IFRAME&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span></li><li class="hl_l1">ESTATE&nbsp;<span class="hl_function">ends</span></li>        </ol>
    </div>
</div></div>
<br><br>Как это работает. Все инструкции, которые не передают управление выполняются непосредственно в буфере. Инструкции передачи управления эмулируются, возможно и некоторые другие. При эмуляции может ложится в стек значение, для этого необходимо некоторое пространство(Space) максимальный размер которого для произвольной инструкции - размер RGP. К примеру Call занимает 4 байта.<br>При входе в трассировщик формируется структура ESTATE. Далее IFRAME переносится в Space и ESTATE уже не существует, используется рабочая TSTATE. При возрате используется поле Stack. Это указатель на IFRAME, который перемещается на низ стека(после эмуляции TSTATE.Rgp.rEsp это новый стек) и выполняется popad/pop esp/iret. Адрес возврата изменён на трассировочный стаб, тоесть это рекурсивный вызов, нужно использовать маркер рекурсии.<br>При входе в трассировщик формируется ESTATE и приводится к TSTATE. Затем эмулируются ветвления или выбирается новая инструкция и исполняется в буфере, для этого нужен дизасм длин.<br><br>Две фичи - не копирование через movs и отсутствие необходимости смещать стек(из за ESTATE.Stack) даёт профайл(первое только в теории, у меня юзается rep movs). Но именно на дизасме длин образуется затыка по скорости, нужен быстрый.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368865&amp;user=40990&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=14" class="addthx" data-post="368865"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=41088" title="27-10-2016 05:15, ранг:12.1" target="_blank">oldman</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 09:12 <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#15');return false;">#15</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Смотрите, опишу фундаментальный механизм трассировки подробно. </I><br><br>Спасибо за развернутый ответ, но к сожалению практической пользы для меня никакой, я сам все равно <br>такое не напишу, жалко времени, я уже достаточно потратил на денуву &quot;for fun&quot;. Поэтому хотелось бы <br>ограничиться скриптами для x64dbg или готовыми решениями в виде плагинов к тому же x64dbg или <br>какими-то прогами сторонними.<br><br>Во-вторых, игра под денувой совершенно не рада, что ее трассируют. Ты мне выше про dbi рассказал,<br>ну я нагуглил готовые решения, типа rio, pin, еще там что-то было. Под всеми ними тот же томб райдер<br>просто закрывается через некоторое время, думаю где-то в стартовом коде стима, даже не отрисовав<br>начальное меню с настройками. Дампы, со своим стартовым кодом, стартуем уже с винмайна фактически, <br>пусть и обмазанного вм - то же самое, под dbi-трассером падают с ошибкой.<br><br>Разбираться изза чего это так  - тоже уже совершенно лень, проще дальше без разбора вм ковырять <br>защиту, цель там вообщем  поставлена, просто утомляет массовость всего - в томб райдере проверки <br>привязки к  версии ОС происходят порядка 8000 раз с более чем 140 уникальных мест, от момента <br>запуска до  игрового  процесса.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368890&amp;user=41088&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=15" class="addthx" data-post="368890"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 09:25 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#16');return false;">#16</a> </span><div align=left><br>
<b>oldman</b><br><br>Тут не в методе проблема, а в софте. Тот же drio переписывает весь нэйтив на свои костыли, удивительно как оно вообще в принципе такое может функционировать. Пин так же требует масштабного развёртывания, это фактически подсистема. Не удивительно что такой жир не робит с защитой.<br>Свой тулз я есчо не доделал, возникает масса задач, на решение которых нужно время.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368891&amp;user=40990&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=16" class="addthx" data-post="368891"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 09:35 <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#17');return false;">#17</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Тут не в методе проблема, а в софте. </I><br><br>Ну это классическое.. в теории всё хорошо, а в реале выходит вот так как выходит <img src="img/smilies/s1.gif" alt=""><br><br>На тот же рио есть в гитхабе эксплоит как выйти из под контроля трассера, выполнить код, и вернутся под<br>контроль трассера - ну чисто цирк <img src="img/smilies/s5.gif" alt=""> Если поставят цель, думаю твой тулз пострадает тоже <img src="img/smilies/s1.gif" alt=""><br><br><I>difexacaw пишет:<br>Свой тулз я есчо не доделал, возникает масса задач, на решение которых нужно время. </I><br><br>Удачи, затея конечно хорошая. Пишешь как отдельную прогу, или плагин к дебагерам?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368892&amp;user=41088&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=17" class="addthx" data-post="368892"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2016 09:42 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24286&amp;page=3#18');return false;">#18</a> </span><div align=left><br>
<b>oldman</b><br><br>Мотор давно использовался, но оно под частные задачи(обход CFI etc). И есчо кривое всё сырое, поэтому было решено перепилить с нуля, проработав подробно все механизмы. Но это весьма маштабный прожект, где нужно учесть огромное число возможных механизмов, каждый из которых в свою очередь порождает есчо кучу. Вот например если не использовать полну трассировку приложения - пометить нужную страницу как NX, то придётся использовать механизм типо &quot;trace over&quot;, что бы не генерить паразитные фолты. Это в свою очередь требует введение стека вызовов, это работало, но механизм передачи управления между частями кода может быть произвольным, что в свою очередь становится сложной задачей(и не совместим с тем же CFI). И так на каждом этапе. В принципе если получится это всё реализовать, то тулз будет мощным, можно будет в реалтайме анализить всё.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368893&amp;user=40990&amp;forum_n=13&amp;topic=24286&amp;page=3&amp;anchor=18" class="addthx" data-post="368893"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=24286&amp;page=2.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=24286&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=13&amp;topic=24286&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=24286&amp;page=2.html">3</a> . <b>4</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Denuvo - мнение\опыт\обсуждение</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#19" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="24286">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24286" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
