<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Проблема с PE-loader-ом - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Добрый день !!!!!!! Ребята, начал заниматься изучением PE-loader-а и даже нашел кусок рабочего лоадера на одном из сайтов: // peloader.cpp : Defines the entry point for the application. // // Modify the following defines if you">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40382'>jinoweb</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Проблема с PE-loader-ом</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]redradist[/b]','')">redradist</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.52'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=40042">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 января 2016 20:41 <br><script type="text/javascript">QU('redradist','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=redradist" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23928.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Добрый день !!!!!!!<br><br>Ребята, начал заниматься изучением PE-loader-а и даже нашел кусок рабочего лоадера на одном из сайтов:<br><br>// peloader.cpp : Defines the entry point for the application.<br>//<br><br>// Modify the following defines if you have to target a platform prior to the ones specified below.<br>// Refer to MSDN for the latest info on corresponding values for different platforms.<br>#ifndef WINVER                          // Specifies that the minimum required platform is Windows Vista.<br>#define WINVER 0x0600           // Change this to the appropriate value to target other versions of Windows.<br>#endif<br><br>#ifndef _WIN32_WINNT            // Specifies that the minimum required platform is Windows Vista.<br>#define _WIN32_WINNT 0x0600     // Change this to the appropriate value to target other versions of Windows.<br>#endif<br><br>#ifndef _WIN32_WINDOWS          // Specifies that the minimum required platform is Windows 98.<br>#define _WIN32_WINDOWS 0x0410 // Change this to the appropriate value to target Windows Me or later.<br>#endif<br><br>#ifndef _WIN32_IE                       // Specifies that the minimum required platform is Internet Explorer 7.0.<br>#define _WIN32_IE 0x0700        // Change this to the appropriate value to target other versions of IE.<br>#endif<br><br>//#include &quot;resources.h&quot;<br>#include &lt;windows.h&gt;<br>#include &lt;cstdio&gt;<br>#include &lt;tchar.h&gt;<br>#include &lt;iostream&gt;<br><br>#pragma code_seg(push,r1,&quot;.eccode&quot;)<br><br>#ifndef IMAGE_SIZEOF_BASE_RELOCATION<br>// Vista SDKs no longer define IMAGE_SIZEOF_BASE_RELOCATION!?<br>#define IMAGE_SIZEOF_BASE_RELOCATION (sizeof(IMAGE_BASE_RELOCATION))<br>#endif<br><br>#define SEH<br>#define spy_ExitProcess<br><br>#define ERR_IMAGE_IS_NOT_PE              1<br>#define ERR_IMAGE_NOT_VALLOC             2<br>#define ERR_IMAGE_NOT_HVALLOC            3<br>#define ERR_IMAGE_NOT_SVALLOC            4<br>#define ERR_IMAGE_NO_FIXUP               5<br>#define ERR_IMAGE_FIXUP_INVALID          6<br>#define ERR_IMAGE_SEC_PROTECTION_FAILED  7<br>#define ERR_IMAGE_NO_IMPORT              8<br>#define ERR_IMAGE_IMPLIB_NOT_LOADED      9<br><br>#define LDRP_RELOCATION_INCREMENT        0x1<br>#define LDRP_RELOCATION_FINAL            0x2<br><br>#define IMAGE_GET_DOSHEADER( lpbImage ) ((PIMAGE_DOS_HEADER)lpbImage)<br>#define IMAGE_GET_NTHEADER( lpbImage ) ((PIMAGE_NT_HEADERS32)((DWORD)lpbImage + IMAGE_GET_DOSHEADER(lpbImage)-&gt;e_lfanew))<br>#define IMAGE_IS_PE( lpbImage ) (IMAGE_GET_DOSHEADER(lpbImage)-&gt;e_magic == IMAGE_DOS_SIGNATURE ? \<br>    (IMAGE_GET_NTHEADER(lpbImage)-&gt;Signature == IMAGE_NT_SIGNATURE ? TRUE : FALSE) : FALSE)<br>#define IMAGE_GET_DIRECTORY( lpbImage, DIRECTORY_ID ) \<br>    (&amp;IMAGE_GET_NTHEADER(lpbImage)-&gt;OptionalHeader.DataDirectory[DIRECTORY_ID])<br><br>// Global variable<br>HMODULE g_hLoadedModule = NULL;<br>#ifdef spy_ExitProcess<br>typedef VOID (WINAPI *_ExitProcess)(__in UINT uExitCode);<br>_ExitProcess g_ExitProcess = NULL;<br>LPDWORD g_ImpExitProcess = NULL;<br>#endif<br><br>typedef struct <br>{<br>    WORD    wOffset:12;<br>    WORD    wType:4;<br>} IMAGE_FIXUP_ENTRY, *PIMAGE_FIXUP_ENTRY;<br><br>// Process Envorinment Block<br>typedef struct _PEB {<br>    DWORD smth[2]; // doesn&#039;t matter<br>    PVOID SectionBaseAddress;<br>} PEB, *PPEB;<br><br>// Thread Environment Block<br>typedef struct _TEB {<br>    DWORD smth[12]; // doesn&#039;t matter<br>    PPEB Peb;<br>} TEB, *PTEB;<br><br>//typedef int(__cdecl *_mainCRTStartup)(int argc, char *argv[]);<br>typedef void (__cdecl *_mainCRTStartup)(void);<br><br>char *asd[] = { &quot;&quot;,&quot;&quot; };<br><br>#ifdef _MSC_VER<br>#pragma function(memset)<br>#pragma function(memcpy)<br>#endif <br><br>void * __cdecl memset (<br>        void *dst,<br>        int val,<br>        size_t count<br>        )<br>{<br>        void *start = dst;<br><br>        while (count--) {<br>                *(char *)dst = (char)val;<br>                dst = (char *)dst + 1;<br>        }<br><br>        return(start);<br>}<br><br>void * __cdecl memcpy (<br>        void * dst,<br>        const void * src,<br>        size_t count<br>        )<br>{<br>        void * ret = dst;<br><br>        while (count--) {<br>                *(char *)dst = *(char *)src;<br>                dst = (char *)dst + 1;<br>                src = (char *)src + 1;<br>        }<br><br>        return(ret);<br>}<br><br><br>VOID MessageGetLastError( HWND hWndParent, LPCTSTR szTitle )<br>{<br>  LPTSTR lpMsgBuf;<br>  if ( FormatMessage( FORMAT_MESSAGE_ALLOCATE_BUFFER | <br>                      FORMAT_MESSAGE_FROM_SYSTEM | <br>                      FORMAT_MESSAGE_IGNORE_INSERTS,<br>                      NULL,<br>                      GetLastError(),<br>                      MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),<br>                      (LPTSTR) &amp;lpMsgBuf,<br>                      0,<br>                      NULL ) )<br>  {<br>    // Display the string.<br>    MessageBox( hWndParent, (LPCTSTR)lpMsgBuf, szTitle, MB_OK + MB_ICONERROR );<br>    // Free the buffer.<br>    LocalFree( lpMsgBuf );<br>  }<br>};<br><br>HMODULE PeLoadModule(LPBYTE lpbImage, LPDWORD lpdwError)<br>{<br>    if (lpdwError) *lpdwError = 0;<br>    if (IMAGE_IS_PE(lpbImage))<br>    {<br>        HMODULE lpbBase = (HMODULE) VirtualAlloc( NULL,<br>            //(LPVOID)IMAGE_GET_NTHEADER(lpbImage)-&gt;OptionalHeader.ImageBase,<br>            IMAGE_GET_NTHEADER(lpbImage)-&gt;OptionalHeader.SizeOfImage, <br>            MEM_RESERVE, PAGE_EXECUTE_READWRITE );<br>        if (lpbBase)<br>        {<br>            // headers copy<br>            LPBYTE lpbHeaders = (LPBYTE) VirtualAlloc( lpbBase, <br>                IMAGE_GET_NTHEADER(lpbImage)-&gt;OptionalHeader.SizeOfHeaders, <br>                MEM_COMMIT, PAGE_EXECUTE_READWRITE );<br>            if(lpbHeaders)    <br>            {<br>                CopyMemory( lpbHeaders, lpbImage, IMAGE_GET_NTHEADER(lpbImage)-&gt;OptionalHeader.SizeOfHeaders );<br>                // section loading<br>                // macro IMAGE_FIRST_SECTION defined in WinNT.h<br>                PIMAGE_SECTION_HEADER pish = IMAGE_FIRST_SECTION(IMAGE_GET_NTHEADER(lpbImage)); <br>                for (DWORD i=0;i&lt;IMAGE_GET_NTHEADER(lpbImage)-&gt;FileHeader.NumberOfSections;i++,pish++)<br>                {<br>                    if (pish-&gt;VirtualAddress)<br>                    {<br>                        LPBYTE lpbSectionBase = (LPBYTE) VirtualAlloc(<br>                            (LPVOID)((DWORD)lpbBase+pish-&gt;VirtualAddress),<br>                            pish-&gt;Misc.VirtualSize,MEM_COMMIT,PAGE_EXECUTE_READWRITE);<br>                        if (lpbSectionBase)<br>                        {<br>                            ZeroMemory(lpbSectionBase,pish-&gt;Misc.VirtualSize);<br>                            // macro min defined in WinDef.h<br>                            CopyMemory(lpbSectionBase, lpbImage + pish-&gt;PointerToRawData, <br>                                min(pish-&gt;Misc.VirtualSize,pish-&gt;SizeOfRawData));<br>                        }<br>                        else if (lpdwError) *lpdwError = ERR_IMAGE_NOT_SVALLOC;<br>                    }<br>                }<br>				DWORD dwOldProtect = 0;<br>                VirtualProtect(lpbBase, <br>                    IMAGE_GET_NTHEADER(lpbImage)-&gt;OptionalHeader.SizeOfHeaders, <br>                    PAGE_EXECUTE_READWRITE, &amp;dwOldProtect);<br><br>                return lpbBase;<br>            }<br>            else if (lpdwError) *lpdwError = ERR_IMAGE_NOT_HVALLOC;<br>        }<br>        else if (lpdwError) *lpdwError = ERR_IMAGE_NOT_VALLOC;<br>    }<br>    else if (lpdwError) *lpdwError = ERR_IMAGE_IS_NOT_PE;<br>    return 0;<br>}<br><br>DWORD PeUnloadModule()<br>{<br>    PIMAGE_OPTIONAL_HEADER32 pOptionalHeader = <br>        &amp;IMAGE_GET_NTHEADER(g_hLoadedModule)-&gt;OptionalHeader;<br>    PIMAGE_DATA_DIRECTORY pDirectoryImport = <br>        IMAGE_GET_DIRECTORY(g_hLoadedModule,IMAGE_DIRECTORY_ENTRY_IMPORT);<br>    if (pDirectoryImport-&gt;VirtualAddress)<br>    {<br>        PIMAGE_IMPORT_DESCRIPTOR pImportDescriptor = (PIMAGE_IMPORT_DESCRIPTOR)((DWORD)g_hLoadedModule + pDirectoryImport-&gt;VirtualAddress);<br>        // loop for IMAGE_IMPORT_DESCRIPTOR[]<br>        while (pImportDescriptor-&gt;Name)<br>        {<br>            TCHAR szModuleName[MINCHAR] = _TEXT(&quot;&quot;);<br>            #ifdef UNICODE<br>            MultiByteToWideChar( CP_ACP, MB_PRECOMPOSED, <br>                (LPCSTR)((DWORD)g_hLoadedModule + pImportDescriptor-&gt;Name), -1, <br>                szModuleName, MINCHAR );<br>            #else<br>            lstrcpy(szModuleName,(LPCSTR)((DWORD)hModule + pImportDescriptor-&gt;Name));<br>            #endif<br>            HMODULE hImpModule = ::GetModuleHandle(szModuleName);<br>//            if (hImpModule) ::FreeLibrary(hImpModule);<br>            // Next<br>            pImportDescriptor++;<br>        }<br>    }<br>    PIMAGE_SECTION_HEADER pish = IMAGE_FIRST_SECTION(IMAGE_GET_NTHEADER(g_hLoadedModule)); <br>    for (DWORD i=0;i&lt;IMAGE_GET_NTHEADER(g_hLoadedModule)-&gt;FileHeader.NumberOfSections;i++,pish++)<br>    {<br>        if (pish-&gt;VirtualAddress)<br>        {<br>            VirtualFree((LPVOID)((DWORD)g_hLoadedModule+pish-&gt;VirtualAddress),<br>                0,MEM_DECOMMIT);<br>        }<br>    }<br>    VirtualFree( g_hLoadedModule, <br>        IMAGE_GET_NTHEADER(g_hLoadedModule)-&gt;OptionalHeader.SizeOfHeaders, <br>        MEM_DECOMMIT);<br>    VirtualFree( g_hLoadedModule, 0, MEM_RELEASE );<br>    return 0;<br>}<br><br>#ifdef spy_ExitProcess<br>// spy<br>VOID WINAPI spyExitProcess(__in UINT uExitCode)<br>{<br>    DWORD dwOldProtection = 0;<br>    if (VirtualProtect((LPVOID)g_ImpExitProcess,sizeof(DWORD),<br>       PAGE_READONLY,&amp;dwOldProtection))<br>    {<br>        *g_ImpExitProcess = (DWORD)g_ExitProcess;<br>        VirtualProtect((LPVOID)g_ImpExitProcess,sizeof(DWORD),<br>                dwOldProtection,&amp;dwOldProtection);<br>    }<br>    PeUnloadModule();<br>    g_ExitProcess(uExitCode); // ПАДАЕТ ТУТ!!!<br>}<br>#endif<br><br>DWORD PeProcessRelocations(HMODULE hModule,LONG lImageBaseDelta)<br>{<br>    PIMAGE_FIXUP_ENTRY pFixup;<br>    PIMAGE_DATA_DIRECTORY pDirectoryBaseReloc = <br>        IMAGE_GET_DIRECTORY(hModule,IMAGE_DIRECTORY_ENTRY_BASERELOC);<br>    if (pDirectoryBaseReloc-&gt;VirtualAddress)<br>    {<br>        PIMAGE_BASE_RELOCATION pRelocation = <br>            (PIMAGE_BASE_RELOCATION)((DWORD)hModule + pDirectoryBaseReloc-&gt;VirtualAddress);<br><br>        DWORD dwRelocsSize = pDirectoryBaseReloc-&gt;Size;<br><br>        while (dwRelocsSize &gt; 0)<br>        {<br>            dwRelocsSize -= pRelocation-&gt;SizeOfBlock;<br>            // Process current relocation block<br>            for (pFixup = (PIMAGE_FIXUP_ENTRY) <br>                    (((LPBYTE) pRelocation) + IMAGE_SIZEOF_BASE_RELOCATION);<br>                (DWORD)pFixup &lt; (DWORD)pRelocation + pRelocation-&gt;SizeOfBlock;<br>                pFixup++)<br>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361584&amp;user=40042&amp;forum_n=6&amp;topic=23928.html&amp;page=0&amp;anchor=1" class="addthx" data-post="361584"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]redradist[/b]','')">redradist</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.52'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=40042">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 января 2016 20:46 <br><script type="text/javascript">QU('redradist','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=redradist" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23928.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
DWORD PeProcessRelocations(HMODULE hModule,LONG lImageBaseDelta)<br>{<br>    PIMAGE_FIXUP_ENTRY pFixup;<br>    PIMAGE_DATA_DIRECTORY pDirectoryBaseReloc = <br>        IMAGE_GET_DIRECTORY(hModule,IMAGE_DIRECTORY_ENTRY_BASERELOC);<br>    if (pDirectoryBaseReloc-&gt;VirtualAddress)<br>    {<br>        PIMAGE_BASE_RELOCATION pRelocation = <br>            (PIMAGE_BASE_RELOCATION)((DWORD)hModule + pDirectoryBaseReloc-&gt;VirtualAddress);<br><br>        DWORD dwRelocsSize = pDirectoryBaseReloc-&gt;Size;<br><br>        while (dwRelocsSize &gt; 0)<br>        {<br>            dwRelocsSize -= pRelocation-&gt;SizeOfBlock;<br>            // Process current relocation block<br>            for (pFixup = (PIMAGE_FIXUP_ENTRY) <br>                    (((LPBYTE) pRelocation) + IMAGE_SIZEOF_BASE_RELOCATION);<br>                (DWORD)pFixup &lt; (DWORD)pRelocation + pRelocation-&gt;SizeOfBlock;<br>                pFixup++)<br>            {<br>                LPDWORD pFixupVA = NULL;<br>                DWORD t = 0;<br>                switch (pFixup-&gt;wType)<br>                {<br>                case IMAGE_REL_BASED_ABSOLUTE:<br>                    // no fixup required<br>                    break;<br>                case IMAGE_REL_BASED_HIGHLOW:<br>                    // HighLow - (32-bits) relocate the high and low half<br>                    // of an address.<br>                    pFixupVA = (LPDWORD) ((DWORD)hModule + pRelocation-&gt;VirtualAddress + <br>                        pFixup-&gt;wOffset);<br>    <br>                    t = (DWORD)lImageBaseDelta;<br>                    *pFixupVA += t;<br><br>                    break;<br>                default:<br>                    return ERR_IMAGE_FIXUP_INVALID;<br>                }<br>            }<br>            pRelocation = (PIMAGE_BASE_RELOCATION)pFixup;<br>        }<br>    }<br>    else<br>        // Decided to load at different base, but no relocs present<br>        return ERR_IMAGE_NO_FIXUP;<br><br>    return 0;<br>}<br><br>DWORD PeProcessResoures(HMODULE hModule)<br>{<br>   PIMAGE_OPTIONAL_HEADER32 pOptionalHeader =<br>      &amp;IMAGE_GET_NTHEADER(hModule)-&gt;OptionalHeader;<br>   PIMAGE_DATA_DIRECTORY pDirectoryResoures =<br>      IMAGE_GET_DIRECTORY(hModule, IMAGE_DIRECTORY_ENTRY_RESOURCE);<br>   if (pDirectoryResoures-&gt;VirtualAddress)<br>   {<br>      PIMAGE_RESOURCE_DIRECTORY_ENTRY listItem = NULL;<br>      <br>      PIMAGE_RESOURCE_DIRECTORY pResouresDescriptor = (PIMAGE_RESOURCE_DIRECTORY)((DWORD)hModule + pDirectoryResoures-&gt;VirtualAddress);<br>      // loop for IMAGE_IMPORT_DESCRIPTOR[]<br>      for (int i = 0; i &lt; (pResouresDescriptor-&gt;NumberOfNamedEntries + pResouresDescriptor-&gt;NumberOfIdEntries); i++)<br>      {<br>         // Locate the dialog box resource in the .EXE file.<br>         listItem = (PIMAGE_RESOURCE_DIRECTORY_ENTRY)(pResouresDescriptor + 1);<br>         HRSRC hResInfo = FindResource(hModule, MAKEINTRESOURCE(listItem-&gt;Id), RT_DIALOG);<br>         HGLOBAL hImpModule = ::LoadResource(hModule, hResInfo);<br>         if (!hImpModule)<br>         {<br>            // + message for name of dll<br>            return ERR_IMAGE_IMPLIB_NOT_LOADED;<br>         }<br>      }<br>   }<br>   else return ERR_IMAGE_NO_IMPORT;<br>   return 0;<br>}<br><br>DWORD PeProcessImports(HMODULE hModule)<br>{<br>#ifdef spy_ExitProcess<br>    WORD wEP = 0;<br>#endif<br>    PIMAGE_OPTIONAL_HEADER32 pOptionalHeader = <br>        &amp;IMAGE_GET_NTHEADER(hModule)-&gt;OptionalHeader;<br>    PIMAGE_DATA_DIRECTORY pDirectoryImport = <br>        IMAGE_GET_DIRECTORY(hModule,IMAGE_DIRECTORY_ENTRY_IMPORT);<br>    if (pDirectoryImport-&gt;VirtualAddress)<br>    {<br>        PIMAGE_IMPORT_DESCRIPTOR pImportDescriptor = (PIMAGE_IMPORT_DESCRIPTOR)((DWORD)hModule + pDirectoryImport-&gt;VirtualAddress);<br>        // loop for IMAGE_IMPORT_DESCRIPTOR[]<br>        while (pImportDescriptor-&gt;Name)<br>        {<br>            TCHAR szModuleName[MINCHAR] = _TEXT(&quot;&quot;);<br>            #ifdef UNICODE<br>            MultiByteToWideChar( CP_ACP, MB_PRECOMPOSED, <br>                (LPCSTR)((DWORD)hModule+pImportDescriptor-&gt;Name), -1, <br>                szModuleName, MINCHAR );<br>            #else<br>            lstrcpy(szModuleName,(LPCSTR)((DWORD)hModule+pImportDescriptor-&gt;Name));<br>            #endif<br>            HMODULE hImpModule = ::LoadLibrary(szModuleName);<br>            if (!hImpModule) <br>            {<br>                // + message for name of dll<br>                return ERR_IMAGE_IMPLIB_NOT_LOADED;<br>            }<br>#ifdef spy_ExitProcess<br>            if (lstrcmpi(szModuleName,_TEXT(&quot;KERNEL32.DLL&quot;))==0) wEP = 1;<br>            else wEP = 0;<br>#endif<br>            // Thunk[]<br>            PIMAGE_THUNK_DATA pitd = (PIMAGE_THUNK_DATA)<br>            ((DWORD)hModule + (pImportDescriptor-&gt;OriginalFirstThunk ? <br>                pImportDescriptor-&gt;OriginalFirstThunk : <br>                pImportDescriptor-&gt;FirstThunk));<br>            PIMAGE_THUNK_DATA pFirstThunk = (PIMAGE_THUNK_DATA)<br>                ((DWORD)hModule + pImportDescriptor-&gt;FirstThunk);<br><br>            // loop for IMAGE_THUNK_DATA<br>            while(pitd-&gt;u1.AddressOfData)<br>            {<br>                LPCSTR lpProcName = ((pitd-&gt;u1.Ordinal &amp; IMAGE_ORDINAL_FLAG32) ? <br>                    (LPCSTR)(IMAGE_ORDINAL32(pitd-&gt;u1.Ordinal)) :<br>                    (LPCSTR)((PIMAGE_IMPORT_BY_NAME)((DWORD)hModule + pitd-&gt;u1.AddressOfData))-&gt;Name);<br>                DWORD dwFunc = (DWORD)GetProcAddress(hImpModule,lpProcName);<br>#ifdef spy_ExitProcess<br>                if (wEP)<br>                {<br>                    if (pitd-&gt;u1.Ordinal &amp; IMAGE_ORDINAL_FLAG32)<br>                    {<br>                        if (IMAGE_ORDINAL32(pitd-&gt;u1.Ordinal)==183) wEP |= 0x0100;<br>                    }<br>                    else<br>                    {<br>                        TCHAR szProcName[MINCHAR] = _TEXT(&quot;&quot;);<br>                        #ifdef UNICODE<br>                        MultiByteToWideChar( CP_ACP, MB_PRECOMPOSED, <br>                            (LPCSTR)((PIMAGE_IMPORT_BY_NAME)((DWORD)hModule + pitd-&gt;u1.AddressOfData))-&gt;Name, -1, <br>                            szProcName, MINCHAR );<br>                        #else<br>                        lstrcpy(szProcName,(LPCSTR)((PIMAGE_IMPORT_BY_NAME)((DWORD)hModule + pitd-&gt;u1.AddressOfData))-&gt;Name);<br>                        #endif<br>                        if (lstrcmpi(szProcName,_TEXT(&quot;ExitProcess&quot;))==0)  wEP |= 0x0100;<br>                    }<br>                    if (wEP&amp;0x0100) <br>                    {<br>                        g_ExitProcess = (_ExitProcess)dwFunc;<br>                        dwFunc = (DWORD)spyExitProcess;<br>                        g_ImpExitProcess = &amp;(pFirstThunk-&gt;u1.Function);<br>                        wEP = 0;<br>                    }<br>                }<br>#endif<br>                pFirstThunk-&gt;u1.Function = dwFunc;<br>                pFirstThunk++;<br>                pitd++;<br>            }<br>            // Next<br>            pImportDescriptor++;<br>        }<br>    }<br>    else return ERR_IMAGE_NO_IMPORT;<br>    return 0;<br>}<br><br>bool IsForwarderString(PCHAR pChar, LPVOID hExports, DWORD blockSize)<br>{<br>   bool result = pChar &gt; hExports;<br>   if (result)<br>   {<br>      result = (DWORD) (pChar - hExports) &lt; blockSize;<br>   }<br>   return result;<br>}<br><br>DWORD PeProcessExports(HMODULE hModule)<br>{<br>#ifdef spy_ExitProcess<br>   WORD wEP = 0;<br>#endif<br>   PIMAGE_OPTIONAL_HEADER32 pOptionalHeader =<br>      &amp;IMAGE_GET_NTHEADER(hModule)-&gt;OptionalHeader;<br>   PIMAGE_DATA_DIRECTORY pDirectoryExport =<br>      IMAGE_GET_DIRECTORY(hModule, IMAGE_DIRECTORY_ENTRY_EXPORT);<br>   if (pDirectoryExport-&gt;VirtualAddress)<br>   {<br>      PIMAGE_EXPORT_DIRECTORY pExportDescriptor = (PIMAGE_EXPORT_DIRECTORY)((DWORD)hModule + pDirectoryExport-&gt;VirtualAddress);<br>      // loop for IMAGE_IMPORT_DESCRIPTOR[]<br>      for (int i = 0; i &lt; pExportDescriptor-&gt;NumberOfNames; i++)<br>      {<br>         PCHAR PFnName = (PCHAR)(((LPDWORD)((DWORD)(pExportDescriptor-&gt;AddressOfNames) + (DWORD)(hModule)))[i]<br>            + (DWORD)(hModule));<br>         DWORD FnIndex = ((LPDWORD)((DWORD)(pExportDescriptor-&gt;AddressOfNameOrdinals) + (DWORD)(hModule)))[i];<br>         HMODULE PProcVar = (HMODULE)(((LPDWORD)((DWORD)(pExportDescriptor-&gt;AddressOfFunctions)<br>               + (DWORD)(hModule)))[FnIndex] + (DWORD)(hModule));<br><br><br>         TCHAR szModuleName[MINCHAR] = _TEXT(&quot;&quot;);<br>         #ifdef UNICODE<br>         MultiByteToWideChar(CP_ACP, MB_PRECOMPOSED,<br>            PFnName, -1,<br>            szModuleName, MINCHAR);<br>         #else<br>         lstrcpy(szModuleName, PFnName);<br>         #endif<br>         HMODULE hImpModule = ::LoadLibrary(szModuleName);<br>         if (!hImpModule)<br>         {<br>            // + message for name of dll<br>            return ERR_IMAGE_IMPLIB_NOT_LOADED;<br>         }<br>      }<br>   }<br>}<br><br>DWORD PeGetSectionProtection(DWORD dwCharacteristics)<br>{<br>    DWORD dwProtection = 0;<br><br>    if (dwCharacteristics &amp; IMAGE_SCN_MEM_NOT_CACHED)<br>        dwProtection |= PAGE_NOCACHE;<br><br>    if ((dwCharacteristics &amp; IMAGE_SCN_MEM_EXECUTE) &amp;&amp;<br>        (dwCharacteristics &amp; IMAGE_SCN_MEM_READ) &amp;&amp;<br>        (dwCharacteristics &amp; IMAGE_SCN_MEM_WRITE))<br>        dwProtection |= PAGE_EXECUTE_READWRITE;<br>    else if ((dwCharacteristics &amp; IMAGE_SCN_MEM_EXECUTE) &amp;&amp;<br>        (dwCharacteristics &amp; IMAGE_SCN_MEM_READ))<br>        dwProtection |= PAGE_EXECUTE_READ;<br>    else if ((dwCharacteristics &amp; IMAGE_SCN_MEM_READ) &amp;&amp; <br>        (dwCharacteristics &amp; IMAGE_SCN_MEM_WRITE))<br>        dwProtection |= PAGE_READWRITE;<br>    else if (dwCharacteristics &amp; IMAGE_SCN_MEM_WRITE)<br>        dwProtection |= PAGE_WRITECOPY;<br>    else if (dwCharacteristics &amp; IMAGE_SCN_MEM_READ)<br>        dwProtection |= PAGE_READONLY;<br>    else<br>        dwProtection |= PAGE_EXECUTE_READWRITE;<br><br>    return dwProtection;<br>}<br><br>DWORD PeSetSectionProtection(HMODULE hModule)<br>{<br>    DWORD dwReturn = 0;<br>    PIMAGE_SECTION_HEADER pish = IMAGE_FIRST_SECTION(IMAGE_GET_NTHEADER(hModule)); <br>    for (DWORD i=0;i&lt;IMAGE_GET_NTHEADER(hModule)-&gt;FileHeader.NumberOfSections;i++,pish++)<br>    {<br>        if (pish-&gt;VirtualAddress)<br>        {<br>            DWORD dwOldProtection = 0;<br>            if (!VirtualProtect((LPVOID)((DWORD)hModule + pish-&gt;VirtualAddress),pish-&gt;Misc.VirtualSize,<br>                PeGetSectionProtection(pish-&gt;Characteristics),&amp;dwOldProtection))<br>                dwReturn = ERR_IMAGE_SEC_PROTECTION_FAILED;<br>        }<br>    }<br>    return dwReturn;<br>}<br><br>void peExecute(HMODULE hModule)<br>{<br>    // P
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361585&amp;user=40042&amp;forum_n=6&amp;topic=23928.html&amp;page=0&amp;anchor=2" class="addthx" data-post="361585"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]redradist[/b]','')">redradist</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.52'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=40042">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 января 2016 20:46 <br><script type="text/javascript">QU('redradist','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=redradist" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23928.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
void peExecute(HMODULE hModule)<br>{<br>    // PEB.ImageBaseAddress correction for resource functions<br>	 //((TEB*)__readfsdword(PcTeb))-&gt;Peb-&gt;SectionBaseAddress = (PVOID)hModule;<br>    _mainCRTStartup newmain = (_mainCRTStartup)((DWORD)hModule + IMAGE_GET_NTHEADER(hModule)-&gt;OptionalHeader.AddressOfEntryPoint);<br>    newmain();<br>}<br><br>VOID LoadExe(LPCTSTR szFileName)<br>{<br>    if (::GetFileAttributes(szFileName)!=INVALID_FILE_ATTRIBUTES)<br>    {<br>        HANDLE hFile = ::CreateFile( szFileName, GENERIC_READ, 0, NULL, OPEN_EXISTING, <br>            FILE_ATTRIBUTE_NORMAL, NULL );<br>        if(hFile!=INVALID_HANDLE_VALUE) {<br>            DWORD dwFileSizeHigh = 0;<br>            DWORD dwImageSize = ::GetFileSize(hFile,&amp;dwFileSizeHigh);<br>            if (dwFileSizeHigh==0)<br>            {<br>                HANDLE hMappedFile = ::CreateFileMapping(hFile,NULL,PAGE_READONLY,0,0,NULL);<br>                ::CloseHandle(hFile);<br>                if(hMappedFile) {<br>                    LPVOID lpMappedFile = ::MapViewOfFile(hMappedFile,FILE_MAP_READ,0,0,0);<br>                    ::CloseHandle(hMappedFile);<br>                    if(lpMappedFile) {<br>                        DWORD dwError = 0;<br>                        g_hLoadedModule = PeLoadModule((LPBYTE)lpMappedFile,&amp;dwError);<br>                        ::UnmapViewOfFile(lpMappedFile); <br>                        if (g_hLoadedModule)<br>                        {<br>                            if (dwError) <br>                                ::MessageBox(::GetDesktopWindow(),_TEXT(&quot;File loaded unsuccessful&quot;),_TEXT(&quot;Peloader&quot;),MB_OK+MB_ICONERROR),<br>                                std::wcout &lt;&lt; _TEXT(&quot;file loaded unsuccessful: &quot;)  &lt;&lt; dwError &lt;&lt; std::endl;<br>                            else<br>                            {<br>                                LONG lImageBaseDelta = (LONG)((DWORD)g_hLoadedModule - IMAGE_GET_NTHEADER(g_hLoadedModule)-&gt;OptionalHeader.ImageBase);<br>                                if (lImageBaseDelta)<br>                                {<br>                                    // Processing relocs<br>                                    dwError = PeProcessRelocations(g_hLoadedModule,lImageBaseDelta);<br>                                    if (dwError) std::wcout &lt;&lt; _TEXT(&quot;can&#039;t processed relocations: &quot;) &lt;&lt; dwError &lt;&lt; std::endl;<br>                                }<br>                                else std::wcout &lt;&lt; _TEXT(&quot;relocations not processed&quot;) &lt;&lt; std::endl;<br>                                // Processing import<br>                                dwError = PeProcessImports(g_hLoadedModule);<br>                                //dwError = PeProcessResoures(g_hLoadedModule);<br>                                //dwError = PeProcessExports(g_hLoadedModule);<br>                                if (dwError) std::wcout &lt;&lt; _TEXT(&quot;can&#039;t process import : &quot;) &lt;&lt; dwError &lt;&lt; std::endl;<br>                                // Set protection<br>                                dwError = PeSetSectionProtection(g_hLoadedModule);<br>                                if (dwError) std::wcout &lt;&lt; _TEXT(&quot;can&#039;t section protect : &quot;) &lt;&lt; dwError &lt;&lt; std::endl;<br>                                peExecute(g_hLoadedModule);<br><br>                                dwError = PeUnloadModule();<br>                                //if (dwError) print_f(_TEXT(&quot;can&#039;t unload pe image: %u\n&quot;),dwError);<br><br>                            }<br>                        }<br>                        else std::wcout &lt;&lt; _TEXT(&quot;can&#039;t load pe image: &quot;) &lt;&lt; dwError &lt;&lt; std::endl;<br>                    }<br>                    else MessageGetLastError(::GetDesktopWindow(),_TEXT(&quot;Can&#039;t mapview file&quot;));<br>                }<br>                else MessageGetLastError(::GetDesktopWindow(),_TEXT(&quot;Can&#039;t mapping file&quot;));<br>            }<br>            else<br>            {<br>                ::MessageBox(::GetDesktopWindow(),_TEXT(&quot;File is very large&quot;),_TEXT(&quot;Peloader&quot;),MB_OK+MB_ICONERROR);<br>                ::CloseHandle(hFile);<br>            }<br>        }<br>        else MessageGetLastError(::GetDesktopWindow(),_TEXT(&quot;Can&#039;t open file&quot;));<br>    }<br>    else MessageGetLastError(::GetDesktopWindow(),_TEXT(&quot;Can&#039;t find file&quot;));<br>}<br><br>#ifdef SEH<br>LONG CALLBACK TopLevelExceptionFilter( EXCEPTION_POINTERS *ExceptionInfo )<br>{<br>  if (<br>      ::MessageBox(<br>      ::GetDesktopWindow(),<br>      _TEXT(&quot;Unhandled exception was detected.\nClose application?&quot;),<br>      _TEXT(&quot;Peloader: error&quot;),<br>      MB_OKCANCEL+MB_ICONERROR<br>    ) == IDOK<br>    ) ::ExitProcess(0);<br>  return EXCEPTION_EXECUTE_HANDLER;<br>}<br>#endif<br><br>int main(void)<br>{<br>#ifdef SEH<br>    // enables an application to supersede the top-level exception handler <br>    // of each thread and process<br>    SetUnhandledExceptionFilter( TopLevelExceptionFilter );<br>#endif<br>    //LoadExe(_TEXT(&quot;C:&#92;Windows&#92;system32&#92;calc.exe&quot;));<br>    //LoadExe(_TEXT(&quot;D:&#92;Projects_Programing&#92;IBM_PC&#92;BaJi&#92;BaJi&#92;obj&#92;Debug&#92;BaJi.exe&quot;));<br>    LoadExe(_TEXT(&quot;D:&#92;Projects_Programing&#92;IBM_PC&#92;__cpp&#92;Mario&#92;exe_Mario&#92;Mario.exe&quot;));<br>    //LoadExe(_TEXT(&quot;C:&#92;Windows&#92;system32&#92;calc.exe&quot;));<br>    <span style="word-break: break-all">//LoadExe(_TEXT(&quot;D:&#92;Projects_Programing&#92;IBM_PC&#92;AttackPanel&#92;KeyLogger&#92;keylogger&#92;Debug&#92;keylogger.exe&quot;));</span><br>    //LoadExe(_TEXT(&quot;D:&#92;Projects_Programing&#92;IBM_PC&#92;ServiceManager&#92;ServiceManager&#92;ServiceManager.exe&quot;));<br>    ::ExitProcess(0);<br>    return 0;<br>}<br>#pragma code_seg(pop, r1)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361586&amp;user=40042&amp;forum_n=6&amp;topic=23928.html&amp;page=0&amp;anchor=3" class="addthx" data-post="361586"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 января 2016 20:48 <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23928.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
нам нужно больше <strike>золота</strike> кода !!!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361587&amp;user=10534&amp;forum_n=6&amp;topic=23928.html&amp;page=0&amp;anchor=4" class="addthx" data-post="361587"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]OKOB[/b]','')">OKOB</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6801.png" alt=""><br><span class=txtSm>Ранг: 527.7 (<b>!</b>), 381thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.78'>Активность: 0.16<span style='color:red'>&searr;</span>0.09</span><br>Статус: <a href="action=userinfo&amp;user=6801">Участник</a><br><font color=blue><font color=red>Победитель турнира 2010</font></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 января 2016 21:08 <br><script type="text/javascript">QU('OKOB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OKOB" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23928.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Запрос типа сделайте за меня <img src="img/smilies/s16.gif" alt="">.<br>Код скопипастил с http://rsdn.ru/forum/asm/3519270.1<br>Неделю назад http://www.mpgh.net/forum/showthread.php?t=1064046<br>Теперь пришел с этим сюда.
<br><br><font size="1"><i>-----<br>127.0.0.1, sweet 127.0.0.1</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=361588&amp;user=6801&amp;forum_n=6&amp;topic=23928.html&amp;page=0&amp;anchor=5" class="addthx" data-post="361588"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 января 2016 23:22 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23928.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
В следующий раз вообще бан будет за такую портянку.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361593&amp;user=1556&amp;forum_n=6&amp;topic=23928.html&amp;page=0&amp;anchor=6" class="addthx" data-post="361593"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Проблема с PE-loader-ом</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23928" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
