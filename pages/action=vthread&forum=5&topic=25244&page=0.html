<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Stack BT - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Для удобства захотел добавть в свой обработчик исключений (хотя пригодится и в других кейсах) бэктрейс стека, ну думаю вызову CaptureStackBackTrace и дело сделано, но не тут-то было. Оказывается эта &quot;замечательная&quot;">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55477'>Lohmaty</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Stack BT</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=25244&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=25244&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Ate[/b]','')">Ate</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.9 (новичок), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.6'>Активность: 0.03<span style='color:green'>&nearr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=39934">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июля 2018 22:23 &middot; Поправил: Ate <br><script type="text/javascript">QU('Ate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ate" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Для удобства захотел добавть в свой обработчик исключений (хотя пригодится и в других кейсах) бэктрейс стека, ну думаю вызову CaptureStackBackTrace и дело сделано, но не тут-то было. Оказывается эта &quot;замечательная&quot; функция просто не видит фреймы, если функция не имеет канонических прологов, эпилогов, итп, возвращая бесполезные крохи инфы.<br>Уточню - никаких заигрываний с исходниками нет, нужен просто сырой бэктрейс из любого приложения.<br>Отсюда вопрос номер 1,- есть ли готовые &quot;правильные&quot; решения, в идеале статические lib, на случай, если никто ничего интересного не предложит, фоллбэк такой:<br><br>буду делать снапшот всего стэка и постфактум разбираться.<br>Например читаем из тиба<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">FS</span><span class="hl_char">:</span><span class="hl_char">[</span>0x04<span class="hl_char">]</span>&nbsp;<span class="hl_comment">; Stack Base </span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">FS</span><span class="hl_char">:</span><span class="hl_char">[</span>0x08<span class="hl_char">]</span>&nbsp;<span class="hl_comment">; Stack Limit (на случай если будет нужно)</span></li>        </ol>
    </div>
</div></div>
<br><br>В цикле по 4 байта (для х86) копируем в буфер (StackBase-ESP) байт начиная с ESP, потом по желанию можно пройтись по адресам и откоментить для вывода (далее чисто мои размышления и велосипеды),- нули игнорируем, помечаем EBP как текущий фрейм, все что в границах (Stack Limit&lt;--&gt;Stack Base) - адреса стека или параметры, остальные адреса проверяем с помощью GetModuleHandleEx &gt; GetModuleFileName на возможную принадлежности к текущим модулям и добавляем коментарий, была даже идея подтянуть капстоун и проверять предыдущую инструкцию на call чтобы отмаркировать &quot;вручную&quot; фреймы.<br><br>В итоге, стоит ли делать так? <br>Или есть ли готовые lib (на худой конец dll), или грамотные исходники?<br>Что из моих &quot;фантазий&quot; годно?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=385705&amp;user=39934&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=1" class="addthx" data-post="385705"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июля 2018 23:14 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Какая архитектура интересует, х86 или х64? А х64 есть инфа по фреймам стека и местами даже обязательная. В х86 только тыкать пальцем в небо. Есть апи для этого, как вариант-их посмотреть. Но по сути они тоже пальцем в небо тычут, если инфу не найдут.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=385708&amp;user=1556&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=2" class="addthx" data-post="385708"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Ate[/b]','')">Ate</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.9 (новичок), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.6'>Активность: 0.03<span style='color:green'>&nearr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=39934">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июля 2018 23:37 <br><script type="text/javascript">QU('Ate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ate" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>Archer пишет:<br>Какая архитектура интересует </I><br>Интересуют обе, просто в данный момент актуально именно х86.<br><I>Archer пишет:<br>Есть апи для этого </I><br>CaptureStackBackTrace и есть, но она, как оказалось, не торт...<br>Для DbgHelp StackWalk вообще символы нужны похоже. <br><I>Archer пишет:<br>В х86 только тыкать пальцем в небо </I><br>ну я в правильном направлении мыслю? Можно &quot;вручную&quot; фреймы вычислить, или постфактум в отладчике разбираться по снимку стэка?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=385710&amp;user=39934&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=3" class="addthx" data-post="385710"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июля 2018 01:49 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>Ate</b><br><br>Бэктрейс - выделение последовательности процедурных ветвлений. Через стековые фреймы связывается стековое пространство процедур. Что бы определить следующий адрес возврата в стеке на основе текущего нужно знать размер стекового пространства процедуры. Для этого придётся брать исходный известный адрес в код и парсить его, строить граф и определять баланс стека(суммарный размер на который смещается стек каждой инструкцией) для всех ветвей в процедуре, приводящих к call. Это алгоритмически запутанная задача.<br><br>Если просто все указатели в стеке перебирать, то придётся как то узнать что это указатель в код на адрес возврата. Это двумя способами можно сделать:<br><br>A. Проверить что P[-N] это инструкция Call.<br>B. Парсить процедуру полностью и получить все её call&#039;s. Затем искать их в стеке, поиск оканчивать по последним call&#039;s. В данном случае достаточно A.<br><br><img src="img/attach.gif" alt=""> <a href="./files/028a_13.07.2018_EXELAB.rU.tgz">028a_13.07.2018_EXELAB.rU.tgz</a> - btr.7z
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=385714&amp;user=40990&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=4" class="addthx" data-post="385714"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39934" title="16-07-2018 12:59, ранг:6.4" target="_blank">Ate</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июля 2018 04:37 &middot; Поправил: f13nd <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Ate пишет:<br>Оказывается эта &quot;замечательная&quot; функция просто не видит фреймы, если функция не имеет канонических прологов, </I><br>Наверное потому что в каноническом прологе этот самый размер фрейма и задается через sub esp,xxx. Самым тупым (а потому универсальным) решением было бы забирать адрес разврата по ebp (ассемблерной вставкой)(либо не связываться с этим, а брать адрес самой функции, еще проще) в начале каждой функции, помещать в своё собственное подобие стека с блекджеком и всей атрибутикой, а при выходе из функции снимать оттуда (либо построить такую же цепочку наподобие SEH на локальных переменных, а адрес крайней хранить в глобальной, как и там). Проблема только в том, как такой неканонический пролог и эпилог закрутить в функции сторонних библиотек, если их тоже надо.
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=385717&amp;user=8075&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=5" class="addthx" data-post="385717"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июля 2018 09:01 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Самый нормальный вариант-это разбирать руками. 100% точно автоматикой не запилишь. АПИ если поглядеть, в принципе там есть некоторая угадайка, что сначала пытается по фреймам через ebp идти, а потом начинает тупо брутфорсить. Можно попробовать сделать угадайку, но если поглядывать стек в ольке или виндбг, то косячит угадайка не так и редко.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=385720&amp;user=1556&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=6" class="addthx" data-post="385720"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июля 2018 09:21 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>Archer</b><br><br>Почему же не запилишь. Задача сводится к классической code vs data. Если ввести дополнительные проверки и построения, можно полностью исключить вероятность ошибки <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=24488&amp;page=0#17" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=385752&amp;user=40990&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=7" class="addthx" data-post="385752"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Ate[/b]','')">Ate</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.9 (новичок), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.6'>Активность: 0.03<span style='color:green'>&nearr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=39934">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июля 2018 16:02 <br><script type="text/javascript">QU('Ate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ate" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Добрался до рабочего ПК, буду смотреть что можно сделать. Спасибо!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=385898&amp;user=39934&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=8" class="addthx" data-post="385898"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июля 2018 02:08 &middot; Поправил: VOLKOFF <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Just for fun запилил на коленке <noindex><a href="http://rgho.st/6crpcvr4Y" rel="nofollow" target="_blank">концепт</a></noindex> (он даже должен работать <img src="img/smilies/s6.gif" alt=""> ) по обсуждаемой &quot;методике&quot;, можешь потыкать.<br>Окошки делать было лень, в консоль не у всех большой вывод влезет, поэтому весь выхлоп в дебаг (Dbgview в комплекте).<br>Для удобства код вынесен в dll с одной экспортируемой функцией, которая все и делает. Приложение test для быстрой наглядности, вызывает цепочку &quot;неправильных&quot; процедур и прыгает на адрес этой функции.<br>После отработки dll киляет приложение. Первой строчкой выводится сколько реальных &quot;фреймов&quot; поймала RtlCaptureStackBackTrace (эти RETURN в списке будут без &#039;*&#039; впереди).<br><br>Особо не тестил, но все что по руку попало восстановилось полностью, естественно эта поделка демонстрирует лишь базовый принцип, что да - в обычных кейсах на &quot;чистых&quot; приложениях можно так делать.<br>Погоняй на своих пациентах, сразу будет понятно, нужно тебе вообще это, или выбрать другой подход. Так-то в особо тяжких случаях такие задачи решаются с DBI.<br>Вот сравнение выхлопа:<br><br><noindex><a href="https:/./images2.imgbox.com/3a/e9/zFSOo7j1_o.jpg" rel="nofollow" target="_blank"> <img src="https://thumbs2.imgbox.com/3a/e9/zFSOo7j1_t.jpg" border="0" align="" alt=""></a></noindex><br><br>[  ss.dll  |  ollydbg  |  x64dbg  ]<br><br>Сюда еще прикрутить процедуру резолва имен функций, будет вообще по красоте (но это не было заявлено).<br>Баги есть, но пофег, как наглядный пример пойдет <img src="img/smilies/s1.gif" alt=""> Пасс: ss
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=385913&amp;user=5846&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=9" class="addthx" data-post="385913"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39934" title="17-07-2018 13:32, ранг:6.6" target="_blank">Ate</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июля 2018 20:03 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>VOLKOFF</b><br><br>Почему не выложить сурец, опять нужно копать отладчиком. Даже не охота это делать.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=385930&amp;user=40990&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=10" class="addthx" data-post="385930"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Ate[/b]','')">Ate</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.9 (новичок), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.6'>Активность: 0.03<span style='color:green'>&nearr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=39934">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июля 2018 22:13 <br><script type="text/javascript">QU('Ate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ate" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Еще раз спасибо, сделал свой вариант, но есть вопросы. Пробовал на разных программах и иногда бывают ложные срабатывания, а на некоторых наоборот не видно возвратов (использую код difexacaw), хотя ss.dll показывает правильно. Почему такое может быть?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=386012&amp;user=39934&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=11" class="addthx" data-post="386012"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июля 2018 22:37 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Если отталкиваться от вышенаписанного и предположить, что все сделано по твоему сценарию, могу пованговать <img src="img/smilies/s1.gif" alt=""><br>Задача сводится к максимальной фильтрации адресов стека и если выпилить весь &quot;мусор&quot; на допроверочной стадии, falsepositive быть не должно.<br><br><I>Ate пишет:<br>использую код difexacaw </I><br>Тут все просто, вызов может быть осуществлен любой бранч инструкцией (Call, Ret, Jmp, условки etc), это нужно учитывать. Инде показал лишь самый простой вариант определения.<br><br><I>Ate пишет:<br>ss.dll показывает правильно </I><br>Тебе просто повезло <img src="img/smilies/s1.gif" alt=""><br>Чтобы находить все и всегда, без какого-то аналога DBI тулзы будет трудновато обойтись. Например даже приаттаченный отладчик нифига не покажет в случае sm кода. Моя поделка тоже написана &quot;на отвали&quot;, для ускорения работы там нет детекта границ функций, поэтому хватит избыточного мусорного кода чтобы &quot;антиотладочные&quot; вызовы перестали детектится итд итп. Так что данный подход только для &quot;чистых&quot; файлов, это без вариантов.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=386015&amp;user=5846&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=12" class="addthx" data-post="386015"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39934" title="20-07-2018 04:15, ранг:6.8" target="_blank">Ate</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июля 2018 13:20 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>VOLKOFF</b><br><br>&gt; вызов может быть осуществлен любой бранч инструкцией <br><br>Обычный код загружает адрес возврата через call. Вендорами было создано несколько механизмов(cfg/rfg) защиты от передач управления иным путём, так как это используется при OP-атаках. На стеке нормально не может возникнуть адрес, на который будет передано управление через ret, кроме как прежде выполненная call. Указатели в стеке могут быть любые, на код/данные. Например колбек в локальной структуре. Тогда по простому никак не узнать что это адрес возврата - нужно получить все входа в код, для защиты такие маркеры были введены в пе формат, но если их нет, то придётся анализить весь модуль, а если релоков нет, то задача в общем случае стабильно не резолвится. Единственный путь - накопить все вызовы при трассировке, это тот самый dbi/визоры.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=386039&amp;user=40990&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=13" class="addthx" data-post="386039"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=5846" title="21-07-2018 14:59, ранг:85.5" target="_blank">VOLKOFF</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июля 2018 17:58 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Не перестаю удивляться как можно с таким глубокомысленным видом писать вещи противоречащие окружающей действительности. За это мы все тебя и любим  <img src="img/smilies/s1.gif" alt=""><br><br>Если бы в какой-то параллельной реальности ты обучал бы программированию, твои ученики имели бы достаточно теории чтобы часами рассуждать о структуре ядра, но не осилили бы написать даже &quot;Hello world!&quot; <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=386045&amp;user=5846&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=14" class="addthx" data-post="386045"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июля 2018 18:03 &middot; Поправил: f13nd <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>VOLKOFF пишет:<br>Не перестаю удивляться как можно с таким глубокомысленным видом писать вещи противоречащие окружающей действительности. </I><br>Скорей всего речь идет об DEP или чем-то подобном, очень даже вероятно, что это так и работает. Правда подтвердить не могу, ибо и push+ret и тупо подмену адреса разврата в перехватчиках использовал, но может деп тогда в биосе был отрублен.
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=386046&amp;user=8075&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=15" class="addthx" data-post="386046"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июля 2018 18:11 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>VOLKOFF</b><br><br>Не понимаю о чём вы. В нт было введено две ключевые защиты от Oriented-Programming атак, это два механизма, которые отслеживают входы(CFG) и выходы(RFG) из кода. Для первого типа используется индирект отслеживание ветвлений, это поддержал железячный вендор(Интел), для второго типа используется софтверный стек(стек ветвлений) и так же было имплементировано в железо. Эти маркеры введены в PE формат как CFG-table&#039;s. Имея таблицу cfg можно покрыть весь код конструктором, ссылка была выше.<br><br>Примеры можите и тут поиском найти.<br><br><b>Добавлено спустя 18 минут</b><br><b>VOLKOFF</b><br><br>Вот пример вам, покрытие всего кода через CFT <noindex><a href="https://yadi.sk/i/5kaYg6STw9drt" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>Брался каждый вход из pe-cfg, ребилдился в буфер, оригинальный код затирался. Конечно при этом в графе любой call имеется.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=386047&amp;user=40990&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=16" class="addthx" data-post="386047"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июля 2018 18:58 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Вы что оба наркоманы? <img src="img/smilies/s5.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=386049&amp;user=5846&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=17" class="addthx" data-post="386049"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июля 2018 18:59 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>VOLKOFF</b><br><br>А почему вы так решили ?<br><br>Так как механизм отключен/не_поддерживается и есть кодовая лапша протектора - так я это во втором абзаце написал.<br><br><b>Добавлено спустя 20 минут</b><br><b>VOLKOFF</b><br><br>Давайте я за вас поищу матчасть.<br><br>PE COFF <noindex><a href="https://docs.microsoft.com/en-us/windows/desktop/debug/pe-format" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex> IMAGE_DLLCHARACTERISTICS_GUARD_CF и далее по флагу директория и есчо несколько по теме.<br><br>FG <noindex><a href="https://docs.microsoft.com/en-us/windows/desktop/secbp/control-flow-guard" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=386050&amp;user=40990&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=18" class="addthx" data-post="386050"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Ate[/b]','')">Ate</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.9 (новичок), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.6'>Активность: 0.03<span style='color:green'>&nearr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=39934">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2018 20:37 <br><script type="text/javascript">QU('Ate','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ate" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Подскажите какой дизасм на сегодняшний день самый безошибочный? <br>Выбор есть, но не хочется все перебирать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=386092&amp;user=39934&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=19" class="addthx" data-post="386092"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2018 20:42 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>Ate пишет: Подскажите какой дизасм на сегодняшний день самый безошибочный?  </I><br><br>xed, ms, llvm, последний не заводится без написания приличного количества кода.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=386094&amp;user=41575&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=20" class="addthx" data-post="386094"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39934" title="27-07-2018 17:52, ранг:7.2" target="_blank">Ate</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2018 21:38 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Предложу варианты с более дружественным API, чтобы ранней седины не было от процесса написания кода <img src="img/smilies/s6.gif" alt=""><br><br>Дисторм с трешки хорош, декомпозиционный интерфейс радует, хотя как легаси оставлен и старый текстовый вывод, маленький и шустрый (юзается в титане).<br>Самые свежие - Зидис и Капс, хотя первый в альфе до сих пор, второй недавно обновился до релизки.<br><br>Есть вот <noindex><a href="https://github.com/moflow/disassembler-benchmarks" rel="nofollow" target="_blank">такой</a></noindex>  бенч 8-ми месячной давности, хз насколько капс стал за это время лучше.<br><br>Из прошлогоднего блога x64dbg про Зидис:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">*</span>Support&nbsp;for&nbsp;many&nbsp;lesser&nbsp;known&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;undocumented&nbsp;instructions</li><li class="hl_l1">&nbsp;We&nbsp;collected&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;diffed&nbsp;our&nbsp;<span class="hl_function">data</span><span class="hl_char">-</span>tables&nbsp;from&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;against&nbsp;various&nbsp;different&nbsp;sources<span class="hl_char">,</span>&nbsp;such&nbsp;as&nbsp;Intel&nbsp;XED<span class="hl_char">,</span>&nbsp;LLVM&nbsp;<span class="hl_function"><b>and</b></span><span style="word-break: break-all">&nbsp;even&nbsp;did&nbsp;a&nbsp;full&nbsp;sweep&nbsp;through&nbsp;the&nbsp;Intel&nbsp;SDM&nbsp;for&nbsp;the&nbsp;sake&nbsp;of&nbsp;checking&nbsp;side</span><span class="hl_char">-</span>effects&nbsp;of&nbsp;all&nbsp;instructions</li><li class="hl_l0"><span class="hl_char">*</span>A&nbsp;<span class="hl_char">(</span>minor<span class="hl_char">)</span>&nbsp;boost&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;performance</li><li class="hl_l1">&nbsp;Zydis&nbsp;is&nbsp;about&nbsp;<span class="hl_number">50</span><span class="hl_char">%</span>&nbsp;faster&nbsp;than&nbsp;Capstone</li><li class="hl_l0">&nbsp;<span class="hl_number">500</span><span class="hl_char">%</span>&nbsp;faster&nbsp;when&nbsp;decoding&nbsp;to&nbsp;binary&nbsp;structure&nbsp;only<span class="hl_char">,</span>&nbsp;without&nbsp;formatting&nbsp;to&nbsp;human&nbsp;<span class="hl_function"><b>readable</b></span>&nbsp;text&nbsp;assembly&nbsp;<span class="hl_char">(</span><span class="hl_registr"><b>CS</b></span>&nbsp;doesn’t&nbsp;<span class="hl_function"><b>leave</b></span>&nbsp;the&nbsp;user&nbsp;a&nbsp;choice&nbsp;right&nbsp;now<span class="hl_char">)</span></li><li class="hl_l1"><span class="hl_char">*</span>A&nbsp;decrease&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;binary&nbsp;size</li><li class="hl_l0">&nbsp;Zydis&nbsp;is&nbsp;about&nbsp;<span class="hl_number">1</span><span class="hl_char">/</span><span class="hl_number">3</span>&nbsp;the&nbsp;size&nbsp;of&nbsp;Capstone&nbsp;<span class="hl_char">(</span><span class="hl_registr"><b>CS</b></span>&nbsp;X86&nbsp;only<span class="hl_char">,</span>&nbsp;all&nbsp;features&nbsp;compiled&nbsp;<span class="hl_function">in</span><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=386097&amp;user=5846&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=21" class="addthx" data-post="386097"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39934" title="27-07-2018 17:52, ранг:7.2" target="_blank">Ate</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]RevCred[/b]','')">RevCred</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 19.9 (новичок), 16thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.08'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=42682">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2018 22:07 <br><script type="text/javascript">QU('RevCred','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=RevCred" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
не знаю по поводу альфы zydis...<br>буквально сегодня обновился до - v2.0.2 - https://github.com/zyantific/zydis/commits/master<br>есть биндинги для раста, пайтона и паскаля.<br><br>вот ещё один бенч от разрабов zydis - https://github.com/athre0z/disas-bench<br><br>zydis реально лучший - лёгкий, быстрый, точный и правильный, лично я советую его если нужно только x86 &amp;&amp; x86_x64
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=386104&amp;user=42682&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=22" class="addthx" data-post="386104"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=5846" title="22-07-2018 19:33, ранг:85.7" target="_blank">VOLKOFF</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]hypn0[/b]','')">hypn0</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.9 (посетитель), 94thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.02'>Активность: 0.05<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=21535">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2018 22:15 <br><script type="text/javascript">QU('hypn0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hypn0" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>RevCred пишет:<br>zydis реально лучший  </I><br>Вот не в обиду, а Вы вообще для чего его применяете и как?<br>Я реально не знаю. Простите меня.<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=386106&amp;user=21535&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=23" class="addthx" data-post="386106"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2018 22:33 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>RevCred пишет:<br>буквально сегодня обновился до - v2.0.2 </I><br>Ога, релиз был 5 часов назад <img src="img/smilies/s5.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=386111&amp;user=5846&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=24" class="addthx" data-post="386111"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2018 23:16 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>RevCred</b><br><br>Потестить бы на профайл и стабильность, может оно быстрее кседа, тогда и мне пригодится.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=386124&amp;user=40990&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=25" class="addthx" data-post="386124"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]RevCred[/b]','')">RevCred</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 19.9 (новичок), 16thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.08'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=42682">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2018 23:50 &middot; Поправил: RevCred <br><script type="text/javascript">QU('RevCred','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=RevCred" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Потестить бы на профайл</I><br>судя по тому бенчу что я дал(я запускал его у себя тоже), то zydis самый быстрый почти во всём.<br><br>у zydis три режима<br>1) zydis-min-no-fmt - это только length disasm<br>тут понятно что это будет быстрее чем любой разбор - самый быстрый<br><br>2) zydis-full-no-fmt - на выходе получаем такую структурку - https://github.com/zyantific/zydis/blob/master/include/Zydis/DecoderTypes.h#L817-L1349<br>раза в полтора медленне чем XED<br><br>3) zydis-full-fmt - на выходе получаем строку-мнемонику<br>раза в полтора быстрее чем XED<br><br>в итоге получаем что это очень хорошая замена capstone в x64dbg, но вам возможно и не подойдёт.<br><br><I>difexacaw пишет:<br>Потестить бы на стабильность</I><br>Absolutely no dependencies — not even libc<br>Should compile on any platform with a working C99 compiler<br>Tested on Windows, macOS, FreeBSD and Linux, both user and kernel mode<br><br>потом так<br>Credits<br>Intel (for open-sourcing XED, allowing for automatic comparision of our tables against theirs, improving both)<br><br>в итоге оно стабильное во всех понятиях - как в работе, так и в правильности разбора мнемоники.<br><br><I>hypn0 пишет:<br>Вот не в обиду, а Вы вообще для чего его применяете и как?<br>Я реально не знаю. Простите меня.  </I><br>кхе-кхе <img src="img/smilies/s1.gif" alt=""><br>я когда свой дизасм движок пилил сравнивал всё с zydis.<br>а так да, дизасм двиг очень специфичная штука, относительно мало кому и где она нужна.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=386130&amp;user=42682&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=26" class="addthx" data-post="386130"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39934" title="27-07-2018 17:53, ранг:7.2" target="_blank">Ate</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2018 23:57 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>RevCred</b><br><br>&gt; тут понятно что это будет быстрее чем любой разбор - самый быстрый<br><br>Хотелось бы реальные цифры увидеть, закрутить в цикл два дизасма и снять статистику.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=386131&amp;user=40990&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=27" class="addthx" data-post="386131"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]hypn0[/b]','')">hypn0</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.9 (посетитель), 94thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.02'>Активность: 0.05<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=21535">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2018 23:57 <br><script type="text/javascript">QU('hypn0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hypn0" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<I>RevCred пишет:<br>кхе-кхе </I><br>Я не тому написал, хотел у нашего Светоча спросить. Но он молчит, редиска.<br><br><b>Добавлено спустя 2 минуты</b><br><I>difexacaw пишет:<br>Хотелось бы реальные цифры увидеть, закрутить в цикл два дизасма </I><br>Неужели это большая проблема для такого Мэтра, как Вы?<br>Закрутите!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=386132&amp;user=21535&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=28" class="addthx" data-post="386132"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2018 00:04 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<b>hypn0</b><br><br>Нужно собирать это всё и разбираться в интерфейсах. На это нужно время, проще спросить у тех, кто это использовал.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=386133&amp;user=40990&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=29" class="addthx" data-post="386133"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]RevCred[/b]','')">RevCred</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 19.9 (новичок), 16thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.08'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=42682">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2018 00:08 &middot; Поправил: RevCred <br><script type="text/javascript">QU('RevCred','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=RevCred" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25244&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Хотелось бы реальные цифры увидеть, закрутить в цикл два дизасма и снять статистику.  </I><br>закрутите и поделитесь инфой со всеми, мне тоже было бы интересно посмотреть.<br>Я бы не отказался от более быстрого и точного length дизасма.<br><br><I>difexacaw пишет:<br>Нужно собирать это всё и разбираться в интерфейсах. </I><br>https://github.com/zyantific/zydis/blob/251a83e6f69d9bae3a8162db669ad43a82483b9e/examples/ZydisPerfTest.c#L176<br>вот пример использования только lde.<br>осталось найти время и сбилдить
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=386134&amp;user=42682&amp;forum_n=5&amp;topic=25244&amp;page=0&amp;anchor=30" class="addthx" data-post="386134"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=25244&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=25244&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Stack BT</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="25244">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=25244" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
