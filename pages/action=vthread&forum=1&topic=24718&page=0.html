<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Деобфускация асм кода - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Понадобилось набросать деобфускатор кода (самого стандартного), ранее не писал ничего подобного, а под x64 ничего нормального не нашлось. Если у кого есть какая информация, менее водянистая, чем большая часть статей с очевидными">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Деобфускация асм кода</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]v00doo[/b]','')">v00doo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 80.6 (постоянный), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.07'>Активность: 0.1<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=35168">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 апреля 2017 23:26 &middot; Поправил: v00doo <br><script type="text/javascript">QU('v00doo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=v00doo" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Понадобилось набросать деобфускатор кода (самого стандартного), ранее не писал ничего подобного, а под x64 ничего нормального не нашлось.<br>Если у кого есть какая информация, менее водянистая, чем большая часть статей с очевидными вещами про управление потоком или чисткой блоков.<br>Допустим паттерны можно набросать (да их будет много в итоге) против фейковых call&#039;ов и жампов, но возникает вопрос про организацию сворачивания кода с вычислениями значений тех же регистров, например:<br>SUB EAX,10345678<br>AND EAX,10345678<br>XOR EAX,DEADC0DE<br>могут же быть размыты по коду...<br>Может уже давно существуют алгоритмы на основе каких-нибудь графов, а может еще у кого-то есть сырцы codedoctor (хотя, конечно же нет) или может кто-то реверсил? (я в курсе про шаблоны, но о процессе обработки там не в курсе).<br><br>В общем любая информация приветствуется.<br><br>Ps Огромная просьба, НЕ ПИСАТЬ в тему про моторы и прочие вещи, недоступные для понимания простым и глупым смертным, ибо з**ло в каждой теме это говно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=375181&amp;user=35168&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=1" class="addthx" data-post="375181"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 апреля 2017 23:51 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>v00doo</b><br><br>&gt; Огромная просьба, НЕ ПИСАТЬ в тему про моторы и прочие вещи, недоступные для понимания простым и глупым смертным<br><br>Улыбнуло, спс <img src="img/smilies/s5.gif" alt=""><br><br>Это делается в несколько этапов. На первом этапе происходит абстрагирование от машкода и выделение его структуры - описание графом. Получаются многоуровневые списки, которые описывают ветви - связи между блоками кода.<br>На втором этапе выполняется выделение данных в граф - связываются источники и приёмники данных, выделяются операции. В отличии от первого этапа данная операция весьма сложна.<br>На третьем этапе используется семантический и прочий разбор - солверы. Это очень сложное всё.<br><br>В виксах не используется декомпиляция из за её сложности. Обычно достаточно первых двух этапов, далее с описателями можно выполнять любые действия и использовать шаблны.<br><br>Поэтому следует выбрать вариант решения наиболее простой, доступный.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=375182&amp;user=40990&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=2" class="addthx" data-post="375182"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]soft[/b]','')">soft</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 21.0 (новичок), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.95'>Активность: 0.01<span style='color:green'>&nearr;</span>0.03</span><br>Статус: <a href="action=userinfo&amp;user=12603">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2017 00:01 <br><script type="text/javascript">QU('soft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=soft" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>v00doo</b> <br>в этой теме <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22582" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex> есть исходники OllyDeobfuscator, может пригодятся.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=375183&amp;user=12603&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=3" class="addthx" data-post="375183"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=35168" title="30-04-2017 21:49, ранг:63.1" target="_blank">v00doo</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2017 00:06 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Тут можно накопать множество инфы по автоматике <noindex><a href="https://twitter.com/YHVHvx" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>Но там всякие LLVM, выносящая мозг матчасть, поэтому врядле вам это нужно. Я бы это не стал рассматривать.<br><br><b>Добавлено спустя 8 минут</b><br><b>v00doo</b><br><br>Могу привести вам пример свёртки кода, используя только конструктор(первый этап). Следует заметить что не используются абстрактые шаблона - хардкод, что не есть хорошо, хоть и работает.<br><br><br><br><br><img src="img/attach.gif" alt=""> <a href="./files/c34f_01.05.2017_EXELAB.rU.tgz">c34f_01.05.2017_EXELAB.rU.tgz</a> - Int29.rar
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=375184&amp;user=40990&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=4" class="addthx" data-post="375184"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 389thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2017 00:16 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>v00doo пишет:<br>Допустим паттерны можно набросать (да их будет много в итоге) против фейковых call&#039;ов и жампов <br></I><br><br>)) &quot;Набросать&quot; деобфускатор&quot; не получится.<br><br>[...]<br>Автоматически ничего работать не будет короче. <br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=375185&amp;user=35473&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=5" class="addthx" data-post="375185"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]VT-x[/b]','')">VT-x</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.3 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.38'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=40334">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2017 00:28 <br><script type="text/javascript">QU('VT-x','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VT-x" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Угу или таких:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">0x0F</li><li class="hl_l1">0x1F</li><li class="hl_l0">0x00</li>        </ol>
    </div>
</div></div>
<br>Интел маны не отменял никто<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=375187&amp;user=40334&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=6" class="addthx" data-post="375187"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2017 00:33 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Это проблемы не алгоритмов - разбором кода занимается дизасм, ксед к примеру. Проблема в том, что не удаётся после абстрагирования(декомпиляции) применить шаблоны. <b>dosprog</b> прав, на коленке это реализовать не получится. Тем более что тс это нужно с нуля сделать, без использования моторов <img src="img/smilies/s15.gif" alt=""><br>Задача оверхед.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=375188&amp;user=40990&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=7" class="addthx" data-post="375188"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]VT-x[/b]','')">VT-x</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.3 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.38'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=40334">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2017 00:53 <br><script type="text/javascript">QU('VT-x','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VT-x" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=15312" rel="nofollow" target="_blank">--&gt; Про кодетоктор &lt;--</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=375189&amp;user=40334&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=8" class="addthx" data-post="375189"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2017 00:53 &middot; Поправил: reversecode <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
было несколько деобфускаторов<br>один для ида, на питоне, автор помоему его давно забросил, если есть познания в питоне то<br><noindex><a href="https://hex-rays.com/contests/2011/index.shtml" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex> победил контестс<br>mirror <noindex><a href="https://github.com/nihilus/optimice" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br><br><b>ДО</b><br><br><img src="https://hex-rays.com/contests/2011/optimice1.gif" border="0" align="" alt=""><br><br><br><b>ПОСЛЕ</b><br><br><img src="https://hex-rays.com/contests/2011/optimice2.gif" border="0" align="" alt=""><br><br><br>основная идея деобфускатора(ов)<br>загнать асм код в асм компилер, а компилер его прооптимизирует, выбросит все  ненужное<br>и дальше показать дизасм из того что собрал компилер<br><br>был еще такой плаг как ariadne<br><noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=19314&amp;page=0" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><noindex><a href="https://github.com/JohnTroony/Plugme-OllyDBGv1.0/tree/master/Ariadne%20Optimizer%20v0.1/ida61_plugin" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><noindex><a href="https://tuts4you.com/download.php?view.3282" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br>но по моему он не взлетел<br>хотя авторы тогда на форуме показывали оптимистические результаты, даже чего то там на VMP намекали..<br><br>но если обфускация статическая, то  ее проще снять по шаблону, тех инструкций которыми замусорили
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=375190&amp;user=15381&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=9" class="addthx" data-post="375190"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=35168" title="30-04-2017 22:35, ранг:63.1" target="_blank">v00doo</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2017 00:56 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>reversecode</b><br><br>Деобфускация - это свёртка по потоку данных(графу данных). Но для этого нужны соответствующие моторы, которые так не нравятся тс. Иначе никак.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=375191&amp;user=40990&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=10" class="addthx" data-post="375191"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2017 01:08 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
эту свертку делает любой компилятор(оптимизатор его)<br>поэтому сейчас активно выбираются спецы со знанием llvm внутренностей<br>некоторые деобфускаторы построенны на llvm, на гитхабе можно найти<br>но все они теоретиеские, т.е. нужно подтачивать под свою задачу<br>помню llvm+qemu деобфускатор, ... тоже где то на гитхабе есть<br><br>но готовых утилит с одной готовой кнопочкой - &quot;сделать зашибись&quot;, конечно нет, может в приватах ... в секьюрити конторах выпилинных для себя
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=375192&amp;user=15381&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=11" class="addthx" data-post="375192"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2017 01:21 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>v00doo</b><br><noindex><a href="https://yurichev.com/blog/toy_decompiler/" rel="nofollow" target="_blank"><u>Toy Decompiler</u></a></noindex>, статья+сорцы, можно почерпнуть инфу о построении и оптимизации выражений на основе асм кода.<br><br><I>dosprog пишет:<br>стоит задуматься хотя бы о разборе такого типа конструкций </I><br>ну на любой анализатор можно придумать хитрую конструкцию, которая заставит его споткнуться.<br>даже мусорных ветвлений не надо, хватит и банальной самомодификации типа<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_char">[</span>@f<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;0xC340C033</li><li class="hl_l1">@@<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;0x12345678&nbsp;<span class="hl_comment">; пока что мусор</span></li>        </ol>
    </div>
</div></div>
<br><br>паттерны это не настолько плохая идея, чтобы сразу её отметать - хотя бы часть кода получится упростить для понимания, а потом уже можно думать дальше.<br><br>Со временем придёт понимание, что нужно хранить состояние регистров и эмулировать выполнение команд, чтобы определять возможную самомодификацию и предсказывать ветвления. Но до этого еще надо дорасти)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=375193&amp;user=26242&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=12" class="addthx" data-post="375193"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=35168" title="30-04-2017 22:37, ранг:63.1" target="_blank">v00doo</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 389thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2017 01:32 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>хватит и банальной самомодификации типа </I><br><br>Плохо с точки зрения состояния исходного текста. С ним неудобно работать.<br>Фишка обфускации в том, чтобы программа оставалась читаемой и модифицируемой, в исходном виде,<br>но дизассемблировать её было трудно.<br><br>Всё это очень индивидуально для каждой конкретной программы.<br>Поняв в чём подлость, можно с нею попытаться бороться.<br>Но иногда остаётся только ругаться. <br>И часто программы, хитромудро загаженные,  ничего особо эксклюзивного, кроме загаженности, из себя не представляют, можно пользоваться альтернативным софтом.<br><br><b>--Добавлено--</b><br><br>) Вот, для тестирования будущего деобфускатора, &quot;тряпка&quot; : <img src="img/attach.gif" alt=""> <a href="./files/6c0d_01.05.2017_EXELAB.rU.tgz">6c0d_01.05.2017_EXELAB.rU.tgz</a> - DUMMY.EXE<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=375194&amp;user=35473&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=13" class="addthx" data-post="375194"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]v00doo[/b]','')">v00doo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 80.6 (постоянный), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.07'>Активность: 0.1<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=35168">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2017 01:41 &middot; Поправил: v00doo <br><script type="text/javascript">QU('v00doo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=v00doo" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>VT-x пишет:<br>--&gt; Про кодетоктор &lt;--  </I><br>Я не настолько тупой, чтобы я не мог погуглить.<br><I>-=AkaBOSS=- пишет:<br>ну на любой анализатор можно придумать хитрую конструкцию, которая заставит его споткнуться.<br>даже мусорных ветвлений не надо, хватит и банальной самомодификации типа </I><br>Именно так, для того, что под исследованием пока с головой хватает паттернов.<br><br><b>dosprog</b>, приписка в шапке темы для кого? <b>VT-x</b> касается тоже самое.<br><br><I>reversecode пишет:<br>основная идея деобфускатора(ов)<br>загнать асм код в асм компилер, а компилер его прооптимизирует, выбросит все ненужное<br>и дальше показать дизасм из того что собрал компилер </I><br>Именно о подобном подумывал, спасибо за сырцы, я сгуглил поменьше так-то, в общем-то мне нужна как раз именно эта часть (идея).<br><I>dosprog пишет:<br>Вот, для тестирования будущего деобфускатора, &quot;тряпка&quot;  </I><br>У меня есть своя, я лишь хотел собрать материала чтобы автоматизировать это менее уродливо, чем я бы мог с наскоку это пытаться делать, я не собираюсь делать революций.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=375196&amp;user=35168&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=14" class="addthx" data-post="375196"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 389thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2017 01:46 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>v00doo пишет:<br>приписка в теме для кого?<br> </I><br>) Наверно, то ты для себя &quot;набросал&quot;, не знаю.<br>Вон, в прошлом посте возьми DUMMY.EXE и попытайся орудовать паттернами.<br>) О графах и моторах то уже будет после<br><br><I>v00doo пишет:<br>я лишь хотел собрать материала чтобы автоматизировать это менее уродливо <br></I><br>Задача не решается автоматически <b>в принципе</b>, что бы там кто ни говорил.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=375197&amp;user=35473&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=15" class="addthx" data-post="375197"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]v00doo[/b]','')">v00doo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 80.6 (постоянный), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.07'>Активность: 0.1<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=35168">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2017 01:49 &middot; Поправил: v00doo <br><script type="text/javascript">QU('v00doo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=v00doo" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>dosprog пишет:<br>О графах и моторах то уже будет после </I><br>Ну вот и до свидания, не засирайте тему.<br>Еще раз спасибо, а то в каждой теме воды налито больше чем самого вопроса и спасибо всем за инфу, пошел курить все это дело.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=375198&amp;user=35168&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=16" class="addthx" data-post="375198"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 389thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 мая 2017 01:51 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24718.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
) Ок, успехов.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=375199&amp;user=35473&amp;forum_n=1&amp;topic=24718.html&amp;page=0&amp;anchor=17" class="addthx" data-post="375199"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Деобфускация асм кода</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24718" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
