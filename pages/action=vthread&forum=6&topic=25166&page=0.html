<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Visor оптимизация. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здрасте. Вернулся к задаче защиты(OP). Поработав неделю, возник тупик. Тоесть нужен свежий взгляд. Задача сложная, не из прикладного прог-я. Даже я мозг хорошо на ней поломал, решения не видно, тёмный лес  Кратко что есть визор.">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40382'>jinoweb</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Visor оптимизация.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=25166&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=25166&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2018 19:19 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Здрасте.<br><br>Вернулся к задаче защиты(OP). Поработав неделю, возник тупик. Тоесть нужен свежий взгляд.<br><br>Задача сложная, не из прикладного прог-я. Даже я мозг хорошо на ней поломал, решения не видно, тёмный лес <img src="img/smilies/s1.gif" alt=""><br><br>Кратко что есть визор. Это надстройка над кодом, по факту трассировка инструкций путём выделения линейных блоков и их исполнение напрямую в буферах, после чего визор получает управление, раскодирует новый блок и цикл замыкается.<br><br>Это крайне годный способ решения многих задача, но он упирается в ключевую проблему - тайминг. Это решалось двумя путями - блочное исполнение и выделение итераций(эта задача поднималась и была решена). Третий и единственный путь оптимизации - выделение повторений по статистике вызовов в общем случае или каким то прочим путём в динамике.<br>Некоторый код, для которого соблюдаются опред. критерии отпускается напрямую на выполнение на cpu. Выход из кода может контролироваться прямым его патчем - ветвление на массив всех возможных ветвлений, что приведёт к получению управления надстройкой при любом ветвлении(ret/jmp etc).<br><br>В моём случае работа визора сводится к выделению потоков данных(DFG), а точнее это связывание событий по времени(src-dst для указателей в виде маркеров в памяти), без промежуточных деталей(DFG). Те исполнение кода приводит к динамик выделению dfg и урезанию её, что сводится лишь к причинно-следственным связям(PFG), через пересылки данных маркируется указатель.<br><br>Задача следующая.<br><br>Каким то образом модифицировать уже исполненный код, путём патча; при этом должна как то быть выделена dfg и быстро обработана(работа механизма конечно же должна быть быстрее гораздо чем прямое выполнение кода).<br><br>Все логические цепочки вроде как приводят к невозможности решения(главное в нём - профайл - определение FG должно быть быстрее прямого исполнения).<br><br>У меня походу полная засада с данной задачей. Тем более что её даже нельзя чётко сформулировать.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384171&amp;user=40990&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=1" class="addthx" data-post="384171"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2018 19:32 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>difexacaw пишет:<br>определение FG должно быть быстрее прямого исполнения</I><br><br>При этом решение этой задачи исключительно программное?
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384173&amp;user=1379&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=2" class="addthx" data-post="384173"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2018 19:46 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>Jupiter</b><br><br>Да. А как главный нюанс - обработка кода происходит после его исполнения(прохода визора), возможно многократного(те статистическая функция).<br><br>В железо этот механизм можно будет заложить когда будут решены все нюансы/задачи. Это и должно исполнять железо, но пока это софт.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384177&amp;user=40990&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=3" class="addthx" data-post="384177"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2018 19:58 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
прочитал, но к концу забыл, что там было в начале. <img src="img/smilies/s1.gif" alt=""><br>на холодном старте устанешь оптимизировать, а горячий запуск уже реально ускорить без переписывания половины системы. знаю ответ, но всё равно напишу, смотри в сторону работы jit компиляторов, нужно писать свой оптимизатор и систему кешерования. начинать нужно с разработки паттернов оптимизации, что ты можешь задетектить и какие паттерны можешь упростить, разметить код на блоки с линейным кодом, морфом, etc, под каждый блок свои паттерны оптимизации, допустим на блок морфа поступают одинаковые данные на вход, значит этот блок можно свернуть до нормального кода и нет необходимости выполнять деморф каждый запуск.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=384179&amp;user=41575&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=4" class="addthx" data-post="384179"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2018 20:02 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Это и должно исполнять железо, но пока это софт </I><br><br>Без вентилей/плисок, только на уровне софта ставить задачу по производительности в формулировке &quot;определение FG должно быть быстрее прямого исполнения &quot; нецелесообразно, имхо.<br>Если уж ты планируешь это всё на железе, то под это и надо затачивать сразу.
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384180&amp;user=1379&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=5" class="addthx" data-post="384180"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2018 20:09 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Jupiter</b><br><br>Я поясню любые нюансы не понятные. Когда код пройден первый раз(визором) то он определён, формирована cfg/dfg/pfg. Железо тут совсем непричём, оно к теме относиться как лучший способ имплементации. А алгоритмы не зависимо от импл одинаковы, так что следует пока забыть про железки.<br><br><b>Добавлено спустя 12 минут</b><br><b>Jupiter</b><br><br>Я наверно плохо описал, тема слишком обширна.<br><br>При работе обычного потока его время уходит на две вещи - это сервисная обработка(вход в км) и юзер итерации. Оптимизировать можно лишь второй вариант, так как в механизмы ядра вмешаться нельзя.<br><br>Тут совсем иное. Каждая часть кода при каждой визор итерации копируется и исполняется, для этого нужны аппаратные перезагрузки контекста. Что есть тормоза. Что бы их исключить можно не трогать вообще какой то известный код, а изменить все его точки выхода и отдать управление напрямую. Изоляция точек выхода изолирует код, те он вернёт управление после отработки. Для этого не нужны никакие сложности типо отображений и прочих механизмов, которым памяти нужно слишком много.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384181&amp;user=40990&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=6" class="addthx" data-post="384181"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2018 22:40 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>difexacaw</b><br><br>В дополнение к ответу <b>shellstorm</b>:<br><br>Если допускать, что блоки кода могут повторяться хотя бы на уровне структуры, то глобально я бы использовал графы и подобие радужных таблиц для уже известного кода, но это потребует множественных проходов, что уже заведомо медленнее прямого исполнения. По сути это очень быстрый сканер с простым (!) разборщиком, который при нескольких проходах условно идентифицирует блоки и либо заносит их в граф/lookup таблицу, либо использует их предварительно сохранённый обработчик из кэша.
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384185&amp;user=1379&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=7" class="addthx" data-post="384185"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 мая 2018 00:55 &middot; Поправил: mak <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<img src="img/smilies/s5.gif" alt=""> не знаю как вам, но мне первый пост напоминает - <noindex><a href="https://ru.wikipedia.org/wiki/%D0%94%D0%B2%D0%BE%D0%B8%D1%87%D0%BD%D0%B0%D1%8F_%D1%82%D1%80%D0%B0%D0%BD%D1%81%D0%BB%D1%8F%D1%86%D0%B8%D1%8F" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>Есть две книги по теме - <br>Embedded Computing: A VLIW Approach to Architecture, Compilers and Tools и VLIW Microprocessor Hardware Design (2007) в том числе описание Transmeta Crusoe может быть интересным, но <b>difexacaw</b> хочет, чтобы инструкция была в чистом виде или как минимум блоком, при этом игнорирует другие формы типа JIT. Сомневаюсь, что хоть что-то выйдет, ибо это как держаться за два разных полюса .. Уровень кода и уровень интерпретатора должен быть одинаковый по условию, при этом есть ещё и другое условие, что будет прибавление или как минимум равномерное распределение таймингов на наборе инструкций, это невозможно. Запускай два потока визора и один конвейер <img src="img/smilies/s5.gif" alt="">, на распараллеливании задачи может выйграешь)
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384187&amp;user=3520&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=8" class="addthx" data-post="384187"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 мая 2018 18:20 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Невозможно - пока недоказано обратное, предполагается что решение может быть найдено.<br><br>Да, его сложно найти, так как слишком уж много нюансов, но это не означает что задача не решаема.<br><br><b>Jupiter</b><br><br>&gt; я бы использовал графы <br><br>Сформировать dfg для приложения невозможно, тому есть три препятствия: связывание(формат графа) занимает память, равною или большую размеру апп; формирование dfg невозможно для сервисных вызовов без описания их прототипов, а эта хардкодом являлось бы и гиблая затея; но так как сервисы нарушают вероятный dfg, то попытка его строить бессмысленна - можно найти только концы его цепи(in-out/data), таким образом граф данных в реальном случае не может быть построен, он сводится к графу событий(PFG), те наследованию некоторой инфы(в моём случае - это указатели).<br><br><b>mak</b><br><br>&gt; чтобы инструкция была в чистом виде или как минимум блоком<br><br>Не блоком, выделение блоков это штатный метод - любая часть кода между ветвлениями это напрямую исполняемый блок. Нужно пойти дальше и организовать пакеты инструкций на прямое исполнение. При этом должен сохранятся pfg, но так как по одной и той же процедуре происходит множество вызовов, то очевидно что нет смысла крутить это непрерывно выполняя блоки, нужно найти способ отпустить управление в процедуру(конечно же вложенность подразумевается).<br><br>Какие то описания и прочие бинарные трансляции не могут использоваться - опять же профайл получится ниже штатного, а значит и нет смысла это делать.<br><br>&gt;  чтобы инструкция была в чистом виде <br><br>Кстате в чистом&quot; виде - это значит следующее. Инструкция может быть либо запущена к выполнению, либо транслирована/эмулирована. Прямое выполнение конечно же имеет больший тайминг. Но это не главное, главное вот в чём - блок инструкций может быть напрямую выполнен, а для трансляции необходимо транслировать каждую его инструкцию, что делает эмуляцию или какую либо трансляцию не сопоставимой с блочным исполнением, бесполезной из за тормозов.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384203&amp;user=40990&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=9" class="addthx" data-post="384203"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 мая 2018 23:35 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>difexacaw пишет: Нужно пойти дальше и организовать пакеты инструкций на прямое исполнение. При этом должен сохранятся pfg, но так как по одной и той же процедуре происходит множество вызовов, то очевидно что нет смысла крутить это непрерывно выполняя блоки, нужно найти способ отпустить управление в процедуру(конечно же вложенность подразумевается). </I><br><br>Начинать нужно с доказательств константности выражения, матчасти в гугле полно, сводится к матану и доказательству лемм, можно ещё посмотреть в сторону арифметического сжатия, но хз, как зайдёт по скорости, особо не пользовался этими алгоритмами, они практически все огорожены патентами.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=384205&amp;user=41575&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=10" class="addthx" data-post="384205"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 мая 2018 19:56 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>shellstorm</b><br><br>Задача весьма сложная, она не решаема на досуге&quot;, видимо в анализ нужно глубоко погрузится. Иначе найти решение невозможно походу.<br><br>Матчасть по леммам, свёрткам, нейросетевая/символическое_исполнение и прочее совершенно в данном случае бесполезно, так как задача практическая и основа её - профайл, что ставит жирный крест на всех возможных существующих решениях. Оно(трансляция и далее) слишком толстое и как следствие тормозное, до такой степени, что даже не идёт речь про использование этого в реалтайме.<br><br>Необходимо алгоритмическое решение, самодостаточное, не включающее в себя сомнительные компоненты, которые существуют лишь на бумаге&quot; <img src="img/smilies/s1.gif" alt=""><br><br><b>Добавлено спустя 24 минуты</b><br><b>shellstorm</b><br><br>&gt; нужно писать свой оптимизатор и систему кешерования<br><br>Я как то пропустил это, точнее не обратил внимание. Давно был реализован синхронный кэш, очень быстрый. Это дало прирост по профайлу лишь гдето 10%, что очень мало, но памяти оно требует слишком много. Изначально кэш инструкций был использован для свёртки vmp, оно не эффективно в качестве оптимизации.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384378&amp;user=40990&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=11" class="addthx" data-post="384378"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]SegFault[/b]','')">SegFault</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 44.8 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.95'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29820">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 мая 2018 20:59 <br><script type="text/javascript">QU('SegFault','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SegFault" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
хлам, опять выдуманное слово визор какоето, купи нормальный камень и открой для себя аппаратную виртуализацию, а не лепи горбатого из костылей
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=384379&amp;user=29820&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=12" class="addthx" data-post="384379"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 мая 2018 21:32 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>SegFault</b><br><br>У меня хорошая машинка, камень поддерживает все эти технологии гпв. Но дело не в этом.<br><br>Гипервизор это мод(режим), его нельзя интегрировать в приложение. Визоры для этих целей и предназначены.<br><br>Они работают в текущем моде. Это отлично работает в юм, на счёт км - я не уверен, это не рассматривалось.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384381&amp;user=40990&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=13" class="addthx" data-post="384381"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 мая 2018 19:44 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>difexacaw пишет: Задача весьма сложная, она не решаема на досуге </I><br><br>Это как бы очевидно, качественный, оптимизирующий компилятор по уровню сложности стоит в одном ряду с топовыми, современными браузерами и операционными системами, если откинуть свистелки. <img src="img/smilies/s1.gif" alt=""><br><br><I>difexacaw пишет: Матчасть по леммам, свёрткам, нейросетевая/символическое_исполнение и прочее совершенно в данном случае бесполезно </I><br><br>Прежде чем говорить о пользе или отсутствии таковой, матчасть прежде всего следует знать. Лемма это ряд предположение или допущений которые в сумме дают решение отдельной задачи, в данном случае определение константности функции или бэйзик блока. Алгоритмы арифметического сжатия нужны для экономного хранения связей между блоками. Касательно низкого прироста скорости и потери, предполагаю, что ты всю работу делаешь в одном потоке, но с одного потока не выдавить существенного прироста скорости.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=384415&amp;user=41575&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=14" class="addthx" data-post="384415"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 мая 2018 20:57 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>shellstorm</b><br><br>Что бы какую то высокоуровневую обработку выполнить, нужно как минимум раскодировать машинный блок и его описать языком. А эти операции имеют огромный тайминг и как следствие даже высокоуровневые оптимизации отображённого блока никак не покроют издержки на его трансляцию, а во втором варианте мы приходим к повторным вызовам, те к исходной задаче, порочный круг.<br><br>&gt; ты всю работу делаешь в одном потоке<br><br>Распараллеливание невозможно, это не вычисления, а исполнение кода.<br><br><b>Добавлено спустя 5 минут</b><br>Даже если теоретически создать два треда, и распределять между ними блоки на выполнение - ничего не выйдет, по простой причинно следственной связи - второй тред будет синхронно ждать выполнение блока в первом треде и наоборот. Получится перекрёстная работа потоков, когда один исполняет, а второй ждёт ничего не делая. Тайминг на синхронизацию будет большим, такая схема бессмысленна.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384418&amp;user=40990&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=15" class="addthx" data-post="384418"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 мая 2018 21:16 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>difexacaw пишет: Даже если теоретически создать два треда, и распределять между ними блоки на выполнение </I><br><br>Я разве писал об исполнении? В потоке крутить оптимизатор и постобработку исполнения блоков, с построением связей между блоками. исполнения блоков гипотетически можно распараллеливать, но на практике это закончится разрывом пятой точки. Другая проблема, это управление исполнением, сам &quot;мотор&quot; ради &quot;мотора&quot; не имеет практического смысла, даже велосипеду нужен руль и правила опять же лучше исполнять в другом потоке.<br>Например в python добавление декоратора numba в некоторых случаях может ускорить выполнение в 20 раз, несмотря на то, что функция сначала загоняется в дизасм, по ней проходит транслятор, настраивается контекст и только после это всё исполняется.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=384419&amp;user=41575&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=16" class="addthx" data-post="384419"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 мая 2018 21:55 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>shellstorm</b><br><br>С потоками возможность решения не то что не видно даже в принципе, но это полный тупик имхо. Не нужны нам пока потоки, хоть бы с одним разобраться <img src="img/smilies/s1.gif" alt=""><br><br>&gt; Например в python добавление декоратора numba в некоторых случаях может ускорить выполнение в 20 раз<br><br>Это немного иное - оптимизация на уровне компилера/интерпретатора/вм. Тут вся суть в том, как ускорить повторные прямые выполнения блоков. Чем тяжелее по времени какая то высокоуровневая обработка, тем проще её оптимизировать. На уровне прямого исполнения оптимизация становится проблемой, тоесть не эффективной или трудно решаемой.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384420&amp;user=40990&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=17" class="addthx" data-post="384420"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 мая 2018 22:09 &middot; Поправил: shellstorm <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>difexacaw пишет: Не нужны нам пока потоки, хоть бы с одним разобраться </I><br><br>В таком случае остаются только константные блоки.<br>Допустим есть такая функция:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function">std</span><span class="hl_char">:</span><span class="hl_char">:</span>vector<span class="hl_char">&lt;</span><span class="hl_function">int</span><span class="hl_char">&gt;</span>&nbsp;foo<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">std</span><span class="hl_char">:</span><span class="hl_char">:</span>vector<span class="hl_char">&lt;</span><span class="hl_function">int</span><span class="hl_char">&gt;</span>&nbsp;r<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;for<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; i &lt; 10; i++)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r<span class="hl_char">.</span>push_back<span class="hl_char">(</span>i<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;r<span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br><br>Очевидно, что эта функция и связанные с ней блоки (std::vector) константны, соответственно можно выполнять напрямую. Нужно выделить признаки которые указывают на константность и проанализировать связанные блоки, в некоторых случаях это существенная часть кодовой базы, iostream это в некоторых случаях мегабайт кода, существенная часть которого const. Других вариантов для одного потока не вижу, остальное будет давать огромное проседания по скорости из за сложного анализа.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=384422&amp;user=41575&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=18" class="addthx" data-post="384422"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 мая 2018 18:24 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>shellstorm</b><br><br>Это очевидно что из за просадок профайла анализ невозможен(даже если это элементарное накопление каких то данных - из за выборок памяти в базу данных профайл сядет). В этом и вопрос, патч своего рода может стать кротовой норой(как в физ). Повторно использованный блок как то модифицирован, что бы дальнейшие проходы прошли быстрее(вероятно возможно аналогичное решение как с кэшами инструкций - накапление в них данных сильно садит профайл, последующие проходы по ним ускоряет выборка из кэша, что в целом повышает профайл, аналогично работает и системный шедулер). Пока не видно принципа как это сделать, но как выше говорил, пока не доказано что это нельзя сделать, то можно искать решение.<br><br><b>Добавлено спустя 43 минуты</b><br><b>shellstorm</b><br><br>Из общих соображений получается такое. Блок должен быть отображён на dfg или быстрый pfg при первом проходе(исполнении). Так как блок(процедура) не линейна, те содержит условные конструкции, то и её описание(cfg/dfg/etc) будет содержать условную конструкцию, которую так же нужно обработать на cpu, а учитывая более высокий уровень обработки, тайминг будет куда ниже, чем обработка аналогичного условия напрямую. Таким образом видимо невозможно как то скипнуть целиком нелинейный блок(тк FG нелинеен, зависит от аргументов).<br><br>Получается как минимум можно выделить линейные подблоки и связать их адреса в FG. В таком виде получается что задачи нет - тоесть блочное выполнение под визором, а адрес каждого блока можно брать из бд без модификации блоков. Такая логика похожа на доказательство невозможности решения, но это не точно, лишь не продуманная логическая цепочка.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384441&amp;user=40990&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=19" class="addthx" data-post="384441"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 мая 2018 04:44 &middot; Поправил: shellstorm <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>difexacaw пишет: Получается как минимум можно выделить линейные подблоки  </I><br><br>На маленьких блоках если и будет какое то ускорение (не считал, но сомневаюсь) но столь незаметное, что на него можно просто забить. В одном потоке можно разве что статистический учет вызовов, взять хром, в нем очень сложный рендер который рисует постоянно, одиночный вызов даст проседание по скорости, а если таргет будет работать хотя бы минуту, оптимизация уже может дать существенный прирост по скорости, нужно только счетчик вызовов завести, если вызовы переваливают за какой то счетчик, значит код горячий и следующим этапом проверять на константность, если прошел проверку, третьим этапом включить связывание блоков. Если делать все проверки за один проход, это будет дорого, а флаг частоты вызовов много времени не сожрет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=384444&amp;user=41575&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=20" class="addthx" data-post="384444"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 мая 2018 21:21 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>shellstorm</b><br><br>Многопоточность пока не нужно рассматривать. Кэш инструкций был выполнен на таблицах трансляции с синхронным доступом(спин блокировки), он получился треугольным&quot;, в том смысле, что каждый доступ к частям кэша из за многопоточности требует атомарный доступ, мне это изначально не нравилось. Такое вращается в низу ядра, но никак не вписывается в юм, тем более что толку мало. Говорить про какие то более сложные реализации, очереди на исполнение етц - не имеет смысла, ну или пока не имеет.<br><br>Я поразмыслил над задачей, вроде бы как решение найдено.<br><br>Тупиком был сам тип выполнения(dye) - копирование блоков в память и выполнение там, это нужно что бы выделить граф и получить управление после окончания линейного блока(ветвление). Возможен иной тип выполнения под визором - не использовать копирование, а патчить ветвления в самом коде. В таком случае профайл существенно возрастает:<br> - не нужно копировать код, это существенные тормоза.<br> - не нужен кэш инструкций, так как блок заканчивается ветвлением в общий стаб.<br> - не нужно повторно собирать CF, можно его привязать к адресу блока(это не значит что поиск элемента по адресу, типо avl - можно реализовать индексацию).<br><br>В таком виде блок раскодируется, формируется CF, ветвление за ним модифицируется, фактически это патч всех исполняемых ветвлений. В таком виде теоретически работа под визором должна быть не отличима от реалтайма.<br><br>Реализация это уже классическая задача по работе с кодом. В данном случае видны два пути:<br><br>A. Мод всех ветвлений.<br>B. Перенос кода в буфера. Этот вариант откланяется из за дублирования памяти.<br><br>Остаётся решить простую алго задачу - корреляцию блоков при патче(когда размер ветвления больше размера блока).
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384499&amp;user=40990&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=21" class="addthx" data-post="384499"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]SegFault[/b]','')">SegFault</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 44.8 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.95'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29820">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 мая 2018 11:32 <br><script type="text/javascript">QU('SegFault','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SegFault" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>difexacaw</b><br>А если там short jxx то как патчить?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=384515&amp;user=29820&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=22" class="addthx" data-post="384515"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 мая 2018 14:04 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<b>SegFault</b><br><br>А есчо однобайтный рет может быть, в чём проблема ?<br><br>Переносим пролог в индексируемый буфер, пишем call для дальнейшего определения адреса возврата. Для блоков, патч которых невозможен, это например малого размера - переносим их целиком в буфер, либо выполняем под визором штатным путём(мне больше первый вариант нравится, памяти займёт больше, но не нужно копировать каждый раз). Можно использовать метод callmap, это когда происходит вызов из произвольного адреса в линейный массив call-ов, на основе адреса возврата вычисляется индекс. Для данной задачи вариантов решения овер дофига, какие из них выбрать - хз, нужно продумать всё, но всё равно лучший способ покажут только тесты на профайл.<br><br>Возможно например перемещение конца блока, после которого короткое ветвление. Так как блоки линейные, то никакой конструктор не нужен, они копируются как строка. В добавок исполнение под визором отличается от прямого - при прямом исполнении короткий блок полюбому нужно патчить. Под визором известен предыдущий блок(тк как это своего рода трассировка ветвлений) и нет никакой проблемы соеденить два блока - текущий и предыдущий в буфере, либо выбрать соответствующий адрес.. в данном случае всё зависит от конкретной реализации.<br><br>Если код расположен в RX памяти, которую открыть на запись невозможно(проекции секций) - вот это нужно продумать. Варианта два - и ли исполнять штатным визор способом, либо собирать выполненный код в буфера после первого прохода по нему визором. Это немного сложнее патча.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384518&amp;user=40990&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=23" class="addthx" data-post="384518"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2018 05:15 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>difexacaw пишет: Возможен иной тип выполнения под визором - не использовать копирование, а патчить ветвления в самом коде. В таком случае профайл существенно возрастает </I><br><br>Как будет решаться обработка ошибок? Копирование делается не просто так, а для изоляции памяти и обработки ошибок (memory isolation, доков полно). Допустим нужен мне тул для фаззинга, взял твой вариант и во время работы что-то пошло не так, что делать, падать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=384606&amp;user=41575&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=24" class="addthx" data-post="384606"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2018 06:58 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>shellstorm</b><br><br>Ошибки могут быть двух видов в данном случае. Это обычные системные или ошибки в работе надстройки. Системные обрабатываются штатным путём - все км-юм интерфейсы(шлюзы) захватываются и начинают обрабатываться под надстройкой(визором), это Ki* интерфейсы. Обрабатывает ошибку апп, так как она его, мы лишь наблюдаем за этим. В случае если косяк в реализации надстройки, то что тут сделать.. нужно ровно реализовать, да и вообще такого типа реализации ничем не отличается от коденга в км - всё отвалится из за ошибок или не продуманной архитектуры.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384608&amp;user=40990&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=25" class="addthx" data-post="384608"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июня 2018 18:01 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
Прошло некоторое время, я в сети небыл, но думал что зайду и почитаю ответы, таки почитал <img src="img/smilies/s9.gif" alt="">
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384712&amp;user=40990&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=26" class="addthx" data-post="384712"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июня 2018 23:37 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<I>difexacaw пишет: Прошло некоторое время, я в сети небыл, но думал что зайду и почитаю ответы, таки почитал </I><br><br>Видимо ни у кого не возникло желание натягивать сову на глобус, сделай хотя бы набросок архитектуры, тогда будет предметный разговор. Захватывать, вызывать и в таком вот духе, это всё пространные измышления из которых не выявить узкие места в реализации. Возможно в одном месте экономишь на спичках, но в другом из-за этого возникает тотальное проседание скорости. Без базиса, пусть даже абстрактного диалог беспредметный.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=384718&amp;user=41575&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=27" class="addthx" data-post="384718"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40990" title="01-06-2018 21:48, ранг:213.4" target="_blank">difexacaw</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 июня 2018 01:08 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>shellstorm</b><br><br>Набросок сложно сделать, задача не решена, части её не понятны. Изначально я сказал что задача сложная, это не из типа задач, взял и закодил&quot;. Нюансов столь много, что нужна куча времени, пока это всё соберётся в единое целое, тогда можно говорить про конкретные алгоритмы.<br><br>Не получается даже сделать примерную оценку на профайл/ресурсы. Любое усложнение приводит к необходимости использования битовых отображений на AS. Для этого нужна куча памяти. К примеру не понятно как быть с читаемым-исполняемым кодом, запись которого невозможна. Тут два варианта - либо собирать код в буферах, либо его выполнять визором. Во втором случае копирование, повторные проходы и те тормоза; в первом случае засада с чтением - нужны таблицы для отображения исходных адресов на буфера с собираемым кодом, нельзя просто всё адресное пространство копировать, получается есчо одна сложная довольно задача, как вариант использовать механизмы трансляции. Это динамическое выделение буферов по ходу использования памяти, для этого используются синхронные буфера, адреса вычисляются(транслируются), это тоже не фонтан&quot;, но чтение кода(R-df) операция весьма редкая.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384720&amp;user=40990&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=28" class="addthx" data-post="384720"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июня 2018 18:53 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
Появилась новая идея <img src="img/smilies/s8.gif" alt=""><br><br>Учитывая множество проблемных нюансов, это например перемещения кода и как минимум необходимость хранения таблиц отображений ветвлений на исходные адреса, можно использовать более простой и видимо лучший способ.<br><br>- каждое ветвление изменяется не на ветвление в визор, а на 1B-RET. Тогда перед выполнением блока визор загрузит адрес возврата в себя. В таком случае адрес следующего блока не хранится в коде(в отличие от call_visor). Что бы получить адрес ветвления(RET), те размер блока нужно использовать тяжёлые во всех смыслах глобальные таблицы трансляции. Вместо этого сохраняем трассу и при последующих проходах линкуем трассу в граф(односвязанный список). В этом виде переход к следующему блоку происходит через выбор следующей ссылки из списка(графа).<br><br>В общем случае это можно представить так. Граф собирается последовательно в буфер, по мере исполнения блоков. Текущий блок декодируется, в буфер сохраняется размер блока, тип ветвления и ветвь или следующий за ветвлением(Jcc) блок. При следующем проходе по данному коду и соответственно ему данной части графа выбирается ветвь/блок, если же условная конструкция отлична от предыдущего прохода, те ветвь не описана - текущий описатель её линкуется к концом буфера и далее в него продолжает строится. При следующем проходе будет извлечена ссылка без построений.<br><br>Проблемой может стать быстрый поиск описателя для произвольного адреса. Это видимо не решить быстрее, чем AVL.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=384834&amp;user=40990&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=29" class="addthx" data-post="384834"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2018 03:05 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25166&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
судя по описанию ты изобретаешь своеобразный GC. сборка ссылок на блоки и разрешение коллизий с поиском это именно часть GC, часть с RET это исполнитель, который относится к трасировке\исполнителю, совсем другой компонент. AVL вполне подходит под задачу, только и здесь есть разные варианты которые быстрее-медленнее.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=385034&amp;user=41575&amp;forum_n=6&amp;topic=25166&amp;page=0&amp;anchor=30" class="addthx" data-post="385034"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=25166&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=25166&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Visor оптимизация.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=25166" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
