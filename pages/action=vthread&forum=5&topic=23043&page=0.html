<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Перехват функций(пользовательских, не WinAPI) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Ситуация такая, при определенном нажатии на кнопку в процессе срабатывает функция и возвращает результат вычисления, она не WinAPI, а пользовательская, находится в главном модуле &quot;exe&quot;. Задача: перехватить эту функцию,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Перехват функций(пользовательских, не WinAPI)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]SkyDancer[/b]','')">SkyDancer</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.71'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=36054">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 августа 2014 23:37 <br><script type="text/javascript">QU('SkyDancer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SkyDancer" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Ситуация такая, при определенном нажатии на кнопку в процессе срабатывает функция и возвращает результат вычисления, она не WinAPI, а пользовательская, находится в главном модуле &quot;exe&quot;.<br>Задача: перехватить эту функцию, узнать ее сигнатуру и адрес.<br><br>Интересует каким софтом это лучше всего сделать? Спасибо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345962&amp;user=36054&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=1" class="addthx" data-post="345962"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2014 00:02 &middot; Поправил: plutos <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
OllyDbg ?<br><br>Но прежде хоть немного теории изучить. Event Handlers, Message loop, etc...
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=345963&amp;user=4773&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=2" class="addthx" data-post="345963"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Admintools[/b]','')">Admintools</a></b><br></div>
<img src="img/s0.gif" alt=""><br><span class=txtSm>Ранг: -5.3 (нарушитель), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.92'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32659">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2014 00:02 <br><script type="text/javascript">QU('Admintools','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Admintools" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Обработчик события OnСlick чтоли<img src="img/smilies/s11.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345964&amp;user=32659&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=3" class="addthx" data-post="345964"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]SkyDancer[/b]','')">SkyDancer</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.71'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=36054">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2014 00:54 <br><script type="text/javascript">QU('SkyDancer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SkyDancer" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Не, ну я для примера взял что б была понятна задача. А так то мне нужно перехватить функцию, которая шифрует файл своим алгоритмом...<br><br>А в ольке сигнатуру тоже узнать можно, или только адрес?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345965&amp;user=36054&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=4" class="addthx" data-post="345965"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]microxa[/b]','')">microxa</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 27.8 (посетитель), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.79'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30317">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2014 00:55 <br><script type="text/javascript">QU('microxa','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=microxa" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Ну как.. в любом случае связаная с винапи.  В любом случае оцениваецо архитектура аппликухи.<br>Так например если прога не на очень крутом таком дельфе/буыдлере -  то с относительно наметаным глазом на текстовые формы, просмотреть которые можно к примеру  в ReshackFX, относительно просто потом будет вычислить события в IDA, на копировать -&gt; вставить (в текстовый поиск). <br><br>Если же перехват не проблема , тогда тотально перехвачиваецо WndProc а то и вообще весь импорт с user32.dll, и фильтровано ловим сообщения о мыши,  насчет софта тут вопрос уже будет касацо языков программирования, (хотя не исключены кулхацкерские  софтинки делающие всё одним жмаком мыши).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345966&amp;user=30317&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=5" class="addthx" data-post="345966"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2014 01:03 <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>SkyDancer пишет:<br>Не, ну я для примера взял что б была понятна задача </I><br><br>Что за детский сад? Какие-то вопросы наводящие, осторожные...<br>Задача-то нам понятна, а вот вам?<br>Если понятна, то debugger в руки и вперед!
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=345967&amp;user=4773&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=6" class="addthx" data-post="345967"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]SkyDancer[/b]','')">SkyDancer</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.71'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=36054">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2014 01:10 &middot; Поправил: SkyDancer <br><script type="text/javascript">QU('SkyDancer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SkyDancer" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Да никакой осторожности вообще, реально взял просто для примера...!<br>А так - функция шифрует текст и возвращает его уже зашифрованным. Вот и все что мне о ней известно...<br><br>Ну а по теме я пока что ноль в реверсинге дебагинге итд... Так что очень прошу не кидатся какашками, а постаратся понять, простить, дать ссылку или подробно сказать с чего начать и о чем нужно читать, и прсто умоляю, говорите простым языком и максимально на пальцах...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345969&amp;user=36054&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=7" class="addthx" data-post="345969"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Admintools[/b]','')">Admintools</a></b><br></div>
<img src="img/s0.gif" alt=""><br><span class=txtSm>Ранг: -5.3 (нарушитель), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.92'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32659">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2014 02:11 &middot; Поправил: Admintools <br><script type="text/javascript">QU('Admintools','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Admintools" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>SkyDancer пишет:<br>Да никакой осторожности вообще, реально взял просто для примера...! </I><br>Ну так для начала определи в чем скомпилирована твоя прога, если программировал на Delphi хотя бы, то поймешь, что есть событие OnClick, обычно в нем прописывают код, который исполняется при нажатии кнопки.От этого и пляшешь.Если после нажатия выводится информативное сообщение или добавляется какая-то строка в эдитбокс или мемо или на какой-то другой компонент, то ищещь ее содержание в строках в отладчике как вариант.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345971&amp;user=32659&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=8" class="addthx" data-post="345971"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2014 02:12 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>SkyDancer</b><br>в этой теме http://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14847&amp;page=11<br>качаешь уроки по ссылкам в первом посте, и изучаешь. там достаточно подробно описаны и показаны функции отладчика, в том числе и поиск функций, выполняющихся по нажатию кнопок.<br><br>хотя я совнемаюсь, что с реальной программой будет так же просто.<br>нужно выяснить хотя бы, какой компилятор её собрал, и какие технологии были использованы при её создании.<br>к примеру, если программа скомпилена в дельфи или борланд билдере, для поиска гуёвых процедур можно применить IDR и Dede, но бывает так, что программа писалась на основе каких-либо готовых библиотек или компонентов, типа MFC, Qt и прочей долботни, через которую бывает нелегко добраться до пользовательского кода.<br><br>я уж не говорю о случаях, когда программа, по сути, является интерпретатором промежуточного кода, в который закодированы все обработчики событий и алгоритмы (AutoIt, например). в этом случае тот же ollydbg на 99.9% бесполезен
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345972&amp;user=26242&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=9" class="addthx" data-post="345972"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2014 02:15 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Вспомнился анекдот..<br><br><I>Нью-Йорк, Манхетен. Молодой турист останавливает чопорную старушку и спрашивает: <br>-- &quot;Мэм, как мне попасть в Карнеги-Холл?&quot;<br>Та сухо отвечает ему: <br>-- &quot;Трудиться, молодой человек, трудиться и ещё раз трудиться..&quot;<br></I><br><br>Если задача разовая - попросите, чтобы кто-то помог, раз какие-то проблемы.<br>Если просто интересует реверсинг - напишите и отладьте собственную программу, выполняющую манипуляции с текстом, - после этого вопросов быть уже не должно и в программах сторонних производителей.<br>Иначе и не знаю, что тут сказать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345974&amp;user=35473&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=10" class="addthx" data-post="345974"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=32659" title="28-08-2014 22:16, ранг:1.3" target="_blank">Admintools</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]microxa[/b]','')">microxa</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 27.8 (посетитель), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.79'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30317">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2014 03:15 &middot; Поправил: microxa <br><script type="text/javascript">QU('microxa','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=microxa" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Действительно, перехват функций тема очень непростая,  чреватая подводными камнями и чередой обломов (а то и вообще обломом на обломе), посему требующая значительной даже сказать проффесиональной интуиции, в деле байтокопания (с которым начинать - наверное врядли кто посоветует).. <br><br>Конечно, могут быть какието общие советы и рекомендации, но в целом, подход и выбор стратегии - уже дело вкуса, привычек и сложившегося опыта с наработками, да, и каждого конкретного случая.<br><br>гм.. как к примеру аццкий и сравнительно недавно допиленый распаковщик, toontrak-ских WAV -вок.. <br>http://pastebin.com/2FNZMaWx
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345975&amp;user=30317&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=11" class="addthx" data-post="345975"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Admintools[/b]','')">Admintools</a></b><br></div>
<img src="img/s0.gif" alt=""><br><span class=txtSm>Ранг: -5.3 (нарушитель), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.92'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=32659">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2014 04:02 <br><script type="text/javascript">QU('Admintools','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Admintools" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>microxa пишет:<br>гм.. как к примеру аццкий и сравнительно недавно допиленый распаковщик, toontrak-ских WAV -вок.. <br>http://pastebin.com/2FNZMaWx  </I><br>И как ему поможет распаковщик вавок, генерируемых встшкой для секвенсоров ?<img src="img/smilies/s11.gif" alt=""> Что за бред.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345976&amp;user=32659&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=12" class="addthx" data-post="345976"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2014 04:22 &middot; Поправил: plutos <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>SkyDancer пишет:<br>Ну а по теме я пока что ноль в реверсинге дебагинге итд... Так что очень прошу не кидатся какашками, а постаратся понять, простить, дать ссылку или подробно сказать с чего начать и о чем нужно читать, и прсто умоляю, говорите простым языком и максимально на пальцах...  </I><br><br>Ну, коли так, то начинай с самых азов:<br> туториалы Нарвахи (здесь есть на форуме отдельная тема),<br>уроки Iczelion&#039;a (http://win32assembly.programminghorizon.com/tutorials.html), <br>да и здесь на форуме в разделе для начинающих полно материалов.<br>А кроме того, естественно, ассемблер нужно знать хотя бы самые основы.<br>Это если хочешь в чем-то серьезно разобраться.<br><br>А если задача и правда разовая - попроси помощи в запросах или в поисках специалистов здесь на форуме.<br>Удачи!
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=345977&amp;user=4773&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=13" class="addthx" data-post="345977"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]microxa[/b]','')">microxa</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 27.8 (посетитель), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.79'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30317">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2014 04:48 &middot; Поправил: microxa <br><script type="text/javascript">QU('microxa','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=microxa" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>Admintools</b> ну это чисто так, штрих,  к повествованию за тематику, перехвата пользовательских функций и того что с ними дальше делать. <br>Добавлю еще что, установка перехватов (более-менее интеллектуальных) особенно рулит при отладке, хотя зачастую отправной точкой к выходу на нужный участок кода - это захват WinApi (ну или удачное стечение обстоятелств)<br><br>вобщем рекомендация юному паддавану - начать с приемлимого для его уровня сознания, варианта патчинга/сплайсинга/джампирования функций, и проход по ним в отладчиках c правильной расцветкой (это очень важно).<br><br><b>Добавлено спустя 59 минут</b><br><b>-=AkaBOSS=-</b>, ндээ.. кьють это аццкая долботня. небольшой мастер класс в тему зашифрованого текста.. <br>собственно перехватчик узер32, (на который прога запатчиваеться , возможно не самое изящное из возможных, но я както попривык уже, и даже не считаю за проги,  если они без кастомных хузеров32 и прочих прочих в точечных бомбардировках (с грабежом караванов))<br>http://pastebin.com/yq3cPUBy<br>и пока результат.. <br>http://savepic.org/6000037.png<br>/me не знает насколько затянецо это &quot;пока&quot; ибо в растеряности.. сделан даже перехват qtgui4.dll, хузером33 скомпиленым вообще без рунтайма (иначе какоето глючное зло в причинах которого хрен разобрацо... эмм... CreateWindowExW в модуле Windows определена была как пользовательская -_- , имеетья небольшой глюк - прога стартует если её закрыть, сие некритично, главное хоть логгер в консоль кой как пашет.. нда.. только вот  к подозреваемой CreateFontIndirectW - никакого обращения.. нормально, чо... )<br><br><b>SkyDancer</b> ну это так, типичный пример схватки c байтами.. (прошу извинить за некоторый перевод стрелок)<br>совсем забыл - наиболее конкретное посвящение в ассемблер начинаецо в хьюшечке... ведь хью.. этоже... молот Тора..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=345978&amp;user=30317&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=14" class="addthx" data-post="345978"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2014 10:23 &middot; Поправил: ajax <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>SkyDancer</b><br>обычно находится в ida статикой, т.е. анализом. брякать user32 - ад, имхо<br>да, при условии, что прога пользует нажатие, а не таймер и т.п.
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=345981&amp;user=8830&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=15" class="addthx" data-post="345981"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]SkyDancer[/b]','')">SkyDancer</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.71'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=36054">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 августа 2014 18:11 &middot; Поправил: SkyDancer <br><script type="text/javascript">QU('SkyDancer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SkyDancer" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23043.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Ну короче я понял что это ацки сложная тема, попробую почитать уроки которые тут посоветовали.<br>Ну а по вопросу что за программа, то это короче компьютерная игра, и вот я нагуглил инфу об этой функции в ней, которая шифрует текст(ключ).<br><br>Ну в принципе задача как бы разовая, но вот захотелось хотя бы в общем знать как это все работает...<br>Кстати пробовал перехватывать функции через CE-&gt;Ultimap. Нашло мне 500 функций, ну в принципе как для игры довольно таки не плохой результат...<br>Ну я это о чем.. Найти нажную функцию это фигня, а вот найти типы передаваемых параметров в нее для дальнейшего ее хука это я даже не представляю как это делается...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=346007&amp;user=36054&amp;forum_n=5&amp;topic=23043.html&amp;page=0&amp;anchor=16" class="addthx" data-post="346007"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Перехват функций(пользовательских, не WinAPI)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#17" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="23043">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23043" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
