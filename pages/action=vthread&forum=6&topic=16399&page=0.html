<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как поставить железный бряк? (НЕ в Ольге, естесвенно :] - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Речь о лодыре или инлайне: брякнуть пакованую прогу в нужном месте и пропатчить. Вопросы: 1) как вообще ставятся железные бряки (on execution)? 2) как получить управление по бряку?">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как поставить железный бряк? (НЕ в Ольге, естесвенно :]</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=16399&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=16399&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=6&amp;topic=16399&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2010 02:56 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Речь о лодыре или инлайне: брякнуть пакованую прогу в нужном месте и пропатчить.<br>Вопросы: <br>1) как вообще ставятся железные бряки (on execution)?<br>2) как получить управление по бряку?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260566&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=1" class="addthx" data-post="260566"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Coderess[/b]','')">Coderess</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/16383.jpg" alt=""><br><span class=txtSm>Ранг: 355.4 (мудрец), 55thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.21'>Активность: 0.32<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=16383">Uploader</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2010 03:39 <br><script type="text/javascript">QU('Coderess','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Coderess" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
железные бряки ставятся через регистр Drx
<br><br><font size="1"><i>-----<br>Gutta cavat lapidem. Feci, quod potui. Faciant meliora potentes</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=260568&amp;user=16383&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=2" class="addthx" data-post="260568"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2010 06:18 &middot; Поправил: 0xy <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
А какой будет код исключения у железного бряка?<br>И можно ли его как-то поймать ВНУТРИ ПРОЦЕССА (если прот поставил свой SEH)?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260570&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=3" class="addthx" data-post="260570"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2010 06:53 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
&gt; А какой будет код исключения у железного бряка?<br>STATUS_SINGLE_STEP(#DB) и STATUS_BREAKPOINT(#BP).<br>&gt; можно ли его как-то поймать ВНУТРИ ПРОЦЕССА (если прот поставил свой SEH)?<br>SEH локальный для потока, при срабатывании останова в каждом потоке вызывается свой SEH. VEH глобальный, вызывается из всех потоков, но его удалённо нельзя зарегать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260572&amp;user=17964&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=4" class="addthx" data-post="260572"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2010 08:21 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
На васме статья была www.wasm.ru/article.php?article=debugreg
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260574&amp;user=1556&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=5" class="addthx" data-post="260574"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2010 09:09 &middot; Поправил: 0xy <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Если я правильно понял, VEH ВСЕГДА получает управление раньше, чем цепь SEH (даже если звенья SEH добавлялись после установки VEH)?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260612&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=6" class="addthx" data-post="260612"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2010 09:22 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Всегда. Там механизм другой. Сначала парсится весь вех, а уже потом сех.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260613&amp;user=1556&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=7" class="addthx" data-post="260613"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2010 20:11 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>Clerk пишет:<br>VEH глобальный, вызывается из всех потоков, но его удалённо нельзя зарегать.</b><br><br>Почему нельзя? Можно!!! Для этого есть CreateRemoteThread или просто VirtualAllocEx/WriteProcessMemory с хуком или бряком на EP, если регать со старта, или на что-то другое, если потом...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=260642&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=8" class="addthx" data-post="260642"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2010 20:55 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>DenCoder</b><br>ну-ну
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260644&amp;user=2449&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=9" class="addthx" data-post="260644"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2010 02:44 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Да, с VEH вроде все просто (по крайней мере, если прот его не юзает).<br>Только в 98-й Винде VEH нету <img src="img/smilies/s4.gif" alt=""><br>Так что придется мне париться с SEH...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260663&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=10" class="addthx" data-post="260663"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]HiEndsoft[/b]','')">HiEndsoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 237.0 (наставник), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.74'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13651">Участник</a><br><font color=blue>sysenter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2010 02:50 &middot; Поправил: HiEndsoft <br><script type="text/javascript">QU('HiEndsoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HiEndsoft" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>0xy пишет:<br>Только в 98-й Винде VEH нету </I><br>в 98 винде насколько помниться можно практически все с учетом выполнения привелигированных для NT-линеек команд /интеловские маны нужно смотреть/. (Мы юзали in/out и т.п. для прямого управления оборудованием когда-то.)
<br><br><font size="1"><i>-----<br>продавец резиновых утёнков</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=260664&amp;user=13651&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=11" class="addthx" data-post="260664"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2010 11:46 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>DenCoder</b><br>Сказал <u>удалённо</u>. Вы не можите получить куки из контекста другого процесса. Сосредоточтесь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260677&amp;user=17964&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=12" class="addthx" data-post="260677"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2010 15:55 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>Clerk</b><br>Если под &quot;удаленно&quot; Вы имели в виду с другой машины, то речь вообще об этом не шла.<br>&gt; Вы не можите получить куки из контекста другого процесса<br>Все-таки из контекста другого процесса? Так вот об этом я и писал... Только при чем здесь куки? <img src="img/smilies/s2.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=260687&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=13" class="addthx" data-post="260687"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2010 13:10 &middot; Поправил: 0xy <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Да, похоже, через SEH свой бряк не перехватить <img src="img/smilies/s4.gif" alt=""> (идея была отслеживать установку SEH-обработчиков и каждый раз впихивать свой, но ни чего хорошего из этого не вышло).<br><br>Так что для 98-й я вижу единственный вариант: дебуг-лодырь.<br>Или все же есть другие варианты (перехвата бряка внутри процесса под 98-й?)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260799&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=14" class="addthx" data-post="260799"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Coderess[/b]','')">Coderess</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/16383.jpg" alt=""><br><span class=txtSm>Ранг: 355.4 (мудрец), 55thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.21'>Активность: 0.32<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=16383">Uploader</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2010 14:54 <br><script type="text/javascript">QU('Coderess','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Coderess" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Для чего нужна поддержка 98винды?
<br><br><font size="1"><i>-----<br>Gutta cavat lapidem. Feci, quod potui. Faciant meliora potentes</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=260809&amp;user=16383&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=15" class="addthx" data-post="260809"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2010 15:57 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>0xy</b><br>&gt; Да, похоже, через SEH свой бряк не перехватить <br>Я бы с этим поспорил. Под 98-ой виндой можно сделать так:<br><br>1) CreateProcess с флагом CREATE_SUSPENDED.<br>2) GetThreadContext, eax будет указывать на Entry Point программы (под XP точно, на 98 можно проверить, если нет, то можно вычислить из PE).<br>3) VirtualAllocEx, выделяющий память в контексте другого процесса, работает, начиная с 2К, под 98 должен быть другой способ. Про секции под 98 ничего почти не знаю... Можно на крайний случай использовать конец страницы для записи своего кода. Делал так, когда 98 юзал - работает.<br>4) WriteProcessMemory, пишем код установки своего SEH в выбранную память<br>5) WriteProcessMemory по адресу EP джамп на код<br>6) Цикл FlushInstructionCache на EP, пока байт не совпадет с E9. Заметил эту особенность поведения спящих процессов на XP - кеш у спящих процессов не всегда сразу сбрасывается, даже если функция возвращает TRUE.<br>7) ResumeThread<br><br>В коде установки SEH должно быть понятно, что нужно делать. Проблема только, что обработчик нужного Вам исключения может поставиться другой, но это, думаю, можно решить установкой хард бряка на доступ к fs:[0], обработать и записать туда своего обработчика.<br><br>Может фантастично звучит. <img src="img/smilies/s1.gif" alt=""> Установку совего SEH еще не пробовал, только собираюсь...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=260812&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=16" class="addthx" data-post="260812"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2010 16:55 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>DenCoder</b><br><I>Проблема только, что обработчик нужного Вам исключения может поставиться другой, но это, думаю, можно решить установкой хард бряка на доступ к fs:[0]</I><br>Вот именно из этого ни чего хорошего не получилось.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260839&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=17" class="addthx" data-post="260839"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2010 17:24 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Онанизмом попахивает каким-то, с этими 9х виндами... Насколько я помню, в 9х виндах изменение системной либы в 1 процессе приводило к изменению во всех процессах. Погляди, куда приходят исключения (в NT-KiUserExceptionDispatcher в ntdll.dll) да и перезапиши хуком хыть прям у себя, код хука в конец секции впиши, проверяй там пид да делай, чо надо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260841&amp;user=1556&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=18" class="addthx" data-post="260841"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2010 17:51 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>Archer</b><br>О, точно, это мысль...
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=260844&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=19" class="addthx" data-post="260844"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2010 18:25 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>Archer</b><br><I>NT-KiUserExceptionDispatcher в ntdll.dll</I><br>Ты всерьез думаешь, что в 98-й токое есть? <img src="img/smilies/s5.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260849&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=20" class="addthx" data-post="260849"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2010 19:48 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
А ресёч провести никак? Только не говори, что в IDT прописаны адреса из ринг3.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260855&amp;user=1556&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=21" class="addthx" data-post="260855"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июня 2010 14:37 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Я не на столько хорошо знаю матчасть <img src="img/smilies/s9.gif" alt=""><br>Что есть IDT в Protect Mode? Всё тот же 1-й К физ. памяти, или??<br>В любом случае, я х.з. как заглянуть туда из Ring3.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260918&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=22" class="addthx" data-post="260918"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июня 2010 17:35 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Ну хотя бы из сеха по стеку подняться выше и поглядеть, из какой библиотеки он вызывается, можешь?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260927&amp;user=1556&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=23" class="addthx" data-post="260927"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2010 00:25 &middot; Поправил: 0xy <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
Вызов идет из kernel32 (секция FREQASM). Но перехватывать его там опасно, ибо в 98-й это ГЛОБАЛЬНЫЙ регион, т.е. его модификация повлияет на все процессы!..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260942&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=24" class="addthx" data-post="260942"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2010 03:39 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
Раз такие дела, то где-то даже немного проще... где-то немного сложнее (из-за Win98)...<br><br>В программе<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;HMODULE&nbsp;hMod&nbsp;<span class="hl_char">=</span>&nbsp;GetModuleHandle<span class="hl_char">(</span><span class="hl_quote">&quot;kernel32.dll&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;IMAGE_NT_HEADERS<span class="hl_char">*</span>&nbsp;nth&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>IMAGE_NT_HEADERS<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>hMod&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span>IMAGE_DOS_HEADER<span class="hl_char">*</span><span class="hl_char">)</span>hMod<span class="hl_char">)</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>e_lfanew<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;IMAGE_SECTION_HEADER<span class="hl_char">*</span>&nbsp;ish&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>IMAGE_SECTION_HEADER<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">BYTE</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">&amp;</span>nth<span class="hl_char">-</span><span class="hl_char">&gt;</span>OptionalHeader&nbsp;<span class="hl_char">+</span>&nbsp;nth<span class="hl_char">-</span><span class="hl_char">&gt;</span>FileHeader<span class="hl_char">.</span>SizeOfOptionalHeader<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;do</li><li class="hl_l1">&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span><span class="hl_char">!</span>strncmp<span class="hl_char">(</span>ish<span class="hl_char">-</span><span class="hl_char">&gt;</span>Name<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;FREQASM&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>break</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;i<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;ish&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>IMAGE_SECTION_HEADER<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;}while<span class="hl_char">(</span>i&nbsp;<span class="hl_char">&lt;</span>&nbsp;nth<span class="hl_char">-</span><span class="hl_char">&gt;</span>FileHeader<span class="hl_char">.</span>NumberOfSections<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>Addr</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>hMod&nbsp;<span class="hl_char">+</span>&nbsp;ish<span class="hl_char">-</span><span class="hl_char">&gt;</span>VirtualAddress&nbsp;<span class="hl_char">+</span>&nbsp;ish<span class="hl_char">-</span><span class="hl_char">&gt;</span>Misc<span class="hl_char">.</span>VirtualSize<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;fOldProtect<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;VirtualProtect<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_function">Addr</span><span class="hl_char">,</span>&nbsp;dwSize<span class="hl_char">,</span>&nbsp;PAGE_EXECUTE_READWRITE<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>fOldProtect<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_function"><b>Addr</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;ProcessId<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;memcpy<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">BYTE</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_function"><b>Addr</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">BYTE</span><span class="hl_char">*</span><span class="hl_char">)</span>pAsmCode<span class="hl_char">,</span>&nbsp;SizeOfAsmCode<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>корректируем&nbsp;смещение&nbsp;для&nbsp;вызова&nbsp;GetCurrentProcessId</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;pGetCurrentProcessId&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>GetProcAddress<span class="hl_char">(</span>hMod<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;GetCurrentProcessId&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">BYTE</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_function"><b>Entry</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;pGetCurrentProcessId&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span><span class="hl_function"><b>Entry</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">5</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>копируем&nbsp;одну&nbsp;или&nbsp;более&nbsp;инструкций&nbsp;<span class="hl_char">(</span>если&nbsp;число&nbsp;байт&nbsp;одной&nbsp;инструкции&nbsp;меньше&nbsp;<span class="hl_number">5</span><span class="hl_char">)</span>&nbsp;для&nbsp;исполнения&nbsp;в&nbsp;обработчике&nbsp;хука</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>замещаемая&nbsp;инструкция&nbsp;не&nbsp;должна&nbsp;быть&nbsp;не&nbsp;<span class="hl_function">jmp</span><span class="hl_char">,</span>&nbsp;jcxx<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;с&nbsp;относительными&nbsp;операндами</li><li class="hl_l0">&nbsp;&nbsp;memcpy<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">*</span><span class="hl_char">)</span>ExecuteReplacedInstruction<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">*</span><span class="hl_char">)</span>KernelHookAddr<span class="hl_char">,</span>&nbsp;SizeOfInstructions<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>пишем&nbsp;в&nbsp;конец&nbsp;обработчика&nbsp;смещение&nbsp;для&nbsp;возврата&nbsp;обратно</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>JmpBack&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>KernelHookAddr&nbsp;<span class="hl_char">+</span>&nbsp;SizeOfInstructions&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>JmpBack&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">5</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;VirtualProtect<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">*</span><span class="hl_char">)</span>KernelHookAddr<span class="hl_char">,</span>&nbsp;<span class="hl_number">5</span><span class="hl_char">,</span>&nbsp;PAGE_EXECUTE_READWRITE<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>fOldProtect<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_function">BYTE</span><span class="hl_char">*</span><span class="hl_char">)</span>KernelHookAddr&nbsp;<span class="hl_char">=</span>&nbsp;0xE9<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>по&nbsp;нулевому&nbsp;смещению&nbsp;хранится&nbsp;ProcessId</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>KernelHookAddr&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>Addr</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>KernelHookAddr&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">5</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>Нужно определить 5 переменных<br>ProcessId - PID процесса, у котором нужно перехватить управление в kernel32<br>SizeOfInstructions - размер замещенных инструкций<br>SizeOfAsmCode - размер кода обработчика хука<br>KernelHookAddr - адрес замещаемых инструкций<br>pAsmCode - указатель на код обработчика в контексте нашей программы для копирования в нужное место<br><br>Шаблон кода обработчика примерно такой:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;SavedProcessId&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1"><span class="hl_function">Entry</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;GetCurrentProcessId</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span>SavedProcessId<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>jnz</b></span>&nbsp;DontHandle</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_comment">;здесь пишем инструкции, которые нужно выполнить</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_comment">;например OutputDebugString, чтобы сообщить отладчику</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_comment">;если содержатся вызовы функций API, то прежде необходимо скорректировать смещение</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_comment">;...</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_comment">;...</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">ExecuteReplacedInstruction<span class="hl_char">:</span></li><li class="hl_l0">DontHandle<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_comment">;здесь замещенная инструкция</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_comment">;...</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">JmpBack<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_char">$</span></li>        </ol>
    </div>
</div></div>
<br><br>В установке хука адреса Entry, ExecuteReplacedInstruction, JmpBack должны быть пересчитаны. Имена их совпадают с именами в коде обработчика для большей наглядности.<br>Адрес JmpBack зависит от размера замещенных инструкций, здесь приведен код для 5 байт. Для большего размера потребуется дополнительно что-то вроде<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;JmpBack&nbsp;<span class="hl_char">=</span>&nbsp;ExecuteReplacedInstruction&nbsp;<span class="hl_char">+</span>&nbsp;SizeOfInstructions</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_function">BYTE</span><span class="hl_char">*</span><span class="hl_char">)</span>JmpBack&nbsp;<span class="hl_char">=</span>&nbsp;0xE9<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>а также коррекция смещения в условном переходе. (Это уж чего-то лень стало дописать <img src="img/smilies/s1.gif" alt="">)<br><br>Написал на коленке, но должно работать. Был рад помочь.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=260943&amp;user=24257&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=25" class="addthx" data-post="260943"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2010 16:59 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
Я и писал, что перехватывать надо в глобальной памяти и проверять ПИД. Предыдущие то посты читаешь, не? И лучше не непосредственно место вызова сеха, а по возможности подняться повыше до места вызова коллбека в ринг3 из ринг0. Хотя если для себя и для одной ОС, то 1 хрен.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260969&amp;user=1556&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=26" class="addthx" data-post="260969"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2010 19:25 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>Archer</b><br><I>И лучше не непосредственно место вызова сеха, а по возможности подняться повыше до места вызова коллбека в ринг3 из ринг0</I><br>Чет я не уловил, для чего это нужно??? Хочешь сказать, что эта точка будет одинакова для всей линейки Win 9x? <br>А подняться тяжело, ибо бряки там не работают <img src="img/smilies/s10.gif" alt=""> <br><br>PS<br>Посты я читаю. Но пока все больше склоняюсь к тому, что вариант с дебаг-лодырем для 9x и с VEH для NT намного проще...<br><br>PPS<br>А в Win2k есть VEH?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260978&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=27" class="addthx" data-post="260978"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2010 19:44 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<I>0xy пишет:<br>А в Win2k есть VEH? </I><br>нет, мсдн для этого можно было почитать, особенно статью Мэтта Питрека
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260980&amp;user=2449&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=28" class="addthx" data-post="260980"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2010 20:39 &middot; Поправил: 0xy <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<b>Archer</b><br>Очень похоже, что из ядра прыгаем сюда:<br><code><br>BFF78344  /&#036;  55            PUSH EBP<br>BFF78345  |.  A1 F0BCFBBF   MOV EAX,DWORD PTR DS:[BFFBBCF0]<br>BFF7834A  |.  8BEC          MOV EBP,ESP<br>BFF7834C  |.  83EC 6C       SUB ESP,6C<br>BFF7834F  |.  53            PUSH EBX<br>BFF78350  |.  56            PUSH ESI<br>BFF78351  |.  57            PUSH EDI<br>BFF78352  |.  8B30          MOV ESI,DWORD PTR DS:[EAX]<br>BFF78354  |.  837D 10 01    CMP DWORD PTR SS:[EBP+10],1<br>BFF78358  |.  8B4E 38       MOV ECX,DWORD PTR DS:[ESI+38]<br>BFF7835B  |.  894D F8       MOV DWORD PTR SS:[EBP-8],ECX<br>BFF7835E  |.  75 0A         JNZ SHORT BFF7836A<br>BFF78360  |.  8B45 08       MOV EAX,DWORD PTR SS:[EBP+8]<br>BFF78363  |.  80A0 C1000000&gt;AND BYTE PTR DS:[EAX+C1],0FE<br>BFF7836A  |&gt;  FF75 08       PUSH DWORD PTR SS:[EBP+8]                ; /Arg4<br>BFF7836D  |.  8B7D 0C       MOV EDI,DWORD PTR SS:[EBP+C]             ; |<br>BFF78370  |.  57            PUSH EDI                                 ; |Arg3<br>BFF78371  |.  FF75 10       PUSH DWORD PTR SS:[EBP+10]               ; |Arg2<br>BFF78374  |.  6A 01         PUSH 1                                   ; |Arg1 = 00000001<br>BFF78376  |.  E8 CA070000   CALL BFF78B45                            ; \KERNEL32.BFF78B45<br>BFF7837B  |.  85C0          TEST EAX,EAX<br>BFF7837D  |.  74 08         JE SHORT BFF78387<br>BFF7837F  |.  FF75 08       PUSH DWORD PTR SS:[EBP+8]<br>BFF78382  |.  E8 53E3FEFF   CALL BFF666DA<br>BFF78387  |&gt;  803D 24BDFBBF&gt;CMP BYTE PTR DS:[BFFBBD24],0<br>BFF7838E  |.  74 2A         JE SHORT BFF783BA<br>BFF78390  |.  837D 10 FF    CMP DWORD PTR SS:[EBP+10],-1<br>BFF78394  |.  74 24         JE SHORT BFF783BA<br>BFF78396  |.  FF75 10       PUSH DWORD PTR SS:[EBP+10]<br>BFF78399  |.  E8 809DFEFF   CALL BFF6211E<br>BFF7839E  |.  85C0          TEST EAX,EAX<br>BFF783A0  |.  74 18         JE SHORT BFF783BA<br>BFF783A2  |.  837D 10 01    CMP DWORD PTR SS:[EBP+10],1<br>BFF783A6  |.  0F84 B5010000 JE BFF78561<br>BFF783AC  |.  837D 10 03    CMP DWORD PTR SS:[EBP+10],3<br>BFF783B0  |.  0F84 AB010000 JE BFF78561<br>BFF783B6  |.  804E 4C 02    OR BYTE PTR DS:[ESI+4C],2<br>BFF783BA  |&gt;  A1 F8BCFBBF   MOV EAX,DWORD PTR DS:[BFFBBCF8]<br>BFF783BF  |.  8B08          MOV ECX,DWORD PTR DS:[EAX]<br>BFF783C1  |.  8379 1C 01    CMP DWORD PTR DS:[ECX+1C],1<br>BFF783C5  |.  1BC0          SBB EAX,EAX<br>BFF783C7  |.  40            INC EAX<br>BFF783C8  |.  8945 EC       MOV DWORD PTR SS:[EBP-14],EAX<br>BFF783CB  |.  E8 94E2FEFF   CALL BFF66664<br>BFF783D0  |.  83F8 FF       CMP EAX,-1<br>BFF783D3  |.  8BD8          MOV EBX,EAX<br>BFF783D5  |.  C745 FC 00000&gt;MOV DWORD PTR SS:[EBP-4],0<br>BFF783DC  |.  0F84 3B010000 JE BFF7851D<br>BFF783E2  |&gt;  C745 F4 00000&gt;/MOV DWORD PTR SS:[EBP-C],0<br>BFF783E9  |.  813F 270000C0 |CMP DWORD PTR DS:[EDI],C0000027<br>BFF783EF  |.  74 39         |JE SHORT BFF7842A<br>BFF783F1  |.  395E 0C       |CMP DWORD PTR DS:[ESI+C],EBX<br>BFF783F4  |.  72 05         |JB SHORT BFF783FB<br>BFF783F6  |.  395E 10       |CMP DWORD PTR DS:[ESI+10],EBX<br>BFF783F9  |.  76 2F         |JBE SHORT BFF7842A<br>BFF783FB  |&gt;  8B45 F8       |MOV EAX,DWORD PTR SS:[EBP-8]<br>BFF783FE  |.  8B40 54       |MOV EAX,DWORD PTR DS:[EAX+54]<br>BFF78401  |.  85C0          |TEST EAX,EAX<br>BFF78403  |.  0F84 F3000000 |JE BFF784FC<br>BFF78409  |.  8B40 14       |MOV EAX,DWORD PTR DS:[EAX+14]<br>BFF7840C  |.  85C0          |TEST EAX,EAX<br>BFF7840E  |.  0F84 E8000000 |JE BFF784FC<br>BFF78414  |.  53            |PUSH EBX<br>BFF78415  |.  50            |PUSH EAX<br>BFF78416  |.  E8 7368FFFF   |CALL BFF6EC8E<br>BFF7841B  |.  85C0          |TEST EAX,EAX<br>BFF7841D  |.  0F84 D9000000 |JE BFF784FC<br>BFF78423  |.  C745 F4 01000&gt;|MOV DWORD PTR SS:[EBP-C],1<br>BFF7842A  |&gt;  837D EC 00    |CMP DWORD PTR SS:[EBP-14],0<br>BFF7842E  |.  74 19         |JE SHORT BFF78449<br>BFF78430  |.  8B43 04       |MOV EAX,DWORD PTR DS:[EBX+4]<br>BFF78433  |.  3D 00000080   |CMP EAX,80000000<br>BFF78438  |.  0F82 A5000000 |JB BFF784E3<br>BFF7843E  |.  3D FFFFFFBF   |CMP EAX,BFFFFFFF<br>BFF78443  |.  0F87 9A000000 |JA BFF784E3<br>BFF78449  |&gt;  FF73 04       |PUSH DWORD PTR DS:[EBX+4]<br>BFF7844C  |.  8D4D F0       |LEA ECX,DWORD PTR SS:[EBP-10]<br>BFF7844F  |.  51            |PUSH ECX<br>BFF78450  |.  FF75 08       |PUSH DWORD PTR SS:[EBP+8]<br>BFF78453  |.  53            |PUSH EBX<br>BFF78454  |.  57            |PUSH EDI<br><I>BFF78455  |.  E8 97E3FEFF   |CALL BFF667F1     Call (Call SEH) </I>     <br>BFF7845A  |.  83C4 14       |ADD ESP,14<br>BFF7845D  |.  395D FC       |CMP DWORD PTR SS:[EBP-4],EBX<br>BFF78460  |.  75 0B         |JNZ SHORT BFF7846D<br>BFF78462  |.  8067 04 EF    |AND BYTE PTR DS:[EDI+4],0EF<br>BFF78466  |.  C745 FC 00000&gt;|MOV DWORD PTR SS:[EBP-4],0<br>BFF7846D  |&gt;  85C0          |TEST EAX,EAX                            ;  Switch (cases 0..2)<br>BFF7846F  |.  74 2D         |JE SHORT BFF7849E<br>BFF78471  |.  83F8 01       |CMP EAX,1<br>BFF78474  |.  74 6D         |JE SHORT BFF784E3<br>BFF78476  |.  83F8 02       |CMP EAX,2<br>BFF78479  |.  74 56         |JE SHORT BFF784D1<br>BFF7847B  |.  8D45 94       |LEA EAX,DWORD PTR SS:[EBP-6C]           ;  Default case of switch BFF7846D<br>BFF7847E  |.  897D 9C       |MOV DWORD PTR SS:[EBP-64],EDI<br>BFF78481  |.  C745 94 26000&gt;|MOV DWORD PTR SS:[EBP-6C],C0000026<br>BFF78488  |.  C745 98 01000&gt;|MOV DWORD PTR SS:[EBP-68],1<br>BFF7848F  |.  C745 A4 00000&gt;|MOV DWORD PTR SS:[EBP-5C],0<br>BFF78496  |.  50            |PUSH EAX<br>BFF78497  |.  E8 51E2FEFF   |CALL BFF666ED<br>BFF7849C  |.  EB 45         |JMP SHORT BFF784E3<br>BFF7849E  |&gt;  F647 04 01    |TEST BYTE PTR DS:[EDI+4],1              ;  Case 0 of switch BFF7846D<br>BFF784A2  |.  74 23         |JE SHORT BFF784C7<br>BFF784A4  |.  8D45 94       |LEA EAX,DWORD PTR SS:[EBP-6C]<br>BFF784A7  |.  897D 9C       |MOV DWORD PTR SS:[EBP-64],EDI<br>BFF784AA  |.  C745 94 25000&gt;|MOV DWORD PTR SS:[EBP-6C],C0000025<br>BFF784B1  |.  C745 98 01000&gt;|MOV DWORD PTR SS:[EBP-68],1<br>BFF784B8  |.  C745 A4 00000&gt;|MOV DWORD PTR SS:[EBP-5C],0<br>BFF784BF  |.  50            |PUSH EAX<br>BFF784C0  |.  E8 28E2FEFF   |CALL BFF666ED<br>BFF784C5  |.  EB 1C         |JMP SHORT BFF784E3<br>BFF784C7  |&gt;  FF75 08       |PUSH DWORD PTR SS:[EBP+8]<br>BFF784CA  |.  E8 0BE2FEFF   |CALL BFF666DA<br>BFF784CF  |.  EB 12         |JMP SHORT BFF784E3<br>BFF784D1  |&gt;  804F 04 10    |OR BYTE PTR DS:[EDI+4],10               ;  Case 2 of switch BFF7846D<br>BFF784D5  |.  8B45 FC       |MOV EAX,DWORD PTR SS:[EBP-4]<br>BFF784D8  |.  3B45 F0       |CMP EAX,DWORD PTR SS:[EBP-10]<br>BFF784DB  |.  73 06         |JNB SHORT BFF784E3<br>BFF784DD  |.  8B45 F0       |MOV EAX,DWORD PTR SS:[EBP-10]<br>BFF784E0  |.  8945 FC       |MOV DWORD PTR SS:[EBP-4],EAX<br>BFF784E3  |&gt;  8B03          |MOV EAX,DWORD PTR DS:[EBX]              ;  Case 1 of switch BFF7846D<br>BFF784E5  |.  3BD8          |CMP EBX,EAX<br>BFF784E7  |.  72 06         |JB SHORT BFF784EF<br>BFF784E9  |.  837D F4 00    |CMP DWORD PTR SS:[EBP-C],0<br>BFF784ED  |.  74 0D         |JE SHORT BFF784FC<br>BFF784EF  |&gt;  83F8 FF       |CMP EAX,-1<br>BFF784F2  |.  8BD8          |MOV EBX,EAX<br>BFF784F4  |.^ 0F85 E8FEFFFF \JNZ BFF783E2<br>BFF784FA  |.  EB 21         JMP SHORT BFF7851D<br>BFF784FC  |&gt;  8D4D 94       LEA ECX,DWORD PTR SS:[EBP-6C]<br>BFF784FF  |.  897D 9C       MOV DWORD PTR SS:[EBP-64],EDI<br>BFF78502  |.  C745 94 27000&gt;MOV DWORD PTR SS:[EBP-6C],C0000027<br>BFF78509  |.  C745 98 01000&gt;MOV DWORD PTR SS:[EBP-68],1<br>BFF78510  |.  C745 A4 00000&gt;MOV DWORD PTR SS:[EBP-5C],0<br>BFF78517  |.  51            PUSH ECX<br>BFF78518  |.  E8 D0E1FEFF   CALL BFF666ED<br>BFF7851D  |&gt;  8B45 08       MOV EAX,DWORD PTR SS:[EBP+8]<br>BFF78520  |.  8D4D E4       LEA ECX,DWORD PTR SS:[EBP-1C]<br>BFF78523  |.  51            PUSH ECX                                 ; /pExceptionInfo<br>BFF78524  |.  897D E4       MOV DWORD PTR SS:[EBP-1C],EDI            ; |<br>BFF78527  |.  8945 E8       MOV DWORD PTR SS:[EBP-18],EAX            ; |<br>BFF7852A  |.  E8 515C0100   CALL UnhandledExceptionFilter            ; \UnhandledExceptionFilter<br>BFF7852F  |.  FF75 08       PUSH DWORD PTR SS:[EBP+8]                ; /Arg4<br>BFF78532  |.  57            PUSH EDI                                 ; |Arg3<br>BFF78533  |.  FF75 10       PUSH DWORD PTR SS:[EBP+10]               ; |Arg2<br>BFF78536  |.  6A 00         PUSH 0                                   ; |Arg1 = 00000000<br>BFF78538  |.  E8 08060000   CALL BFF78B45                            ; \KERNEL32.BFF78B45<br>BFF7853D  |.  85C0          TEST EAX,EAX<br>BFF7853F  |.  74 08         JE SHORT BFF78549<br>BFF78541  |.  FF75 08       PUSH DWORD PTR SS:[EBP+8]<br>BFF78544  |.  E8 91E1FEFF   CALL BFF666DA<br>BFF78549  |&gt;  F646 4C 02    TEST BYTE PTR DS:[ESI+4C],2<br>BFF7854D  |.  75 0E         JNZ SHORT BFF7855D<br>BFF7854F  |.  8B45 F8       MOV EAX,DWORD PTR SS:[EBP-8]<br>BFF78552  |.  6A FF         PUSH -1<br>BFF78554  |.  8048 23 08    OR BYTE PTR DS:[EAX+23],8<br>BFF78558  |.  E8 F7500000   CALL BFF7D654<br>BFF7855D  |&gt;  8066 4C FD    AND BYTE PTR DS:[ESI+4C],0FD<br>BFF78561  |&gt;  FF75 08       PUSH DWORD PTR SS:[EBP+8]<br>BFF78564  |.  FF75 14       PUSH DWORD PTR SS:[EBP+14]<br>BFF78567  |.  FF75 10       PUSH DWORD PTR SS:[EBP+10]<br>BFF7856A  |.  68 00000200   PUSH 20000<br>BFF7856F  |.  E8 608EFEFF   CALL #8<br>BFF78574  |.  FF75 08       PUSH DWORD PTR SS:[EBP+8]<br>BFF78577  |.  E8 5EE1FEFF   CALL BFF666DA<br>BFF7857C  |.  5F            POP EDI<br>BFF7857D  |.  5E            POP ESI<br>BFF7857E  |.  5B            POP EBX<br>BFF7857F  |.  8BE5          MOV ESP,EBP<br>BFF78581  |.  5D            POP EBP<br>BFF78582  \.  C3            RET<br><br><br>BFF667F1   &#036;  BA 2D68F6BF   MOV EDX,BFF6682D<br>BFF667F6   .  EB 05         JMP SHORT BFF667FD<br>BFF667F8  /&#036;  BA 5268F6BF   MOV EDX,BFF66852<br>BFF667FD  |&gt;  55            PUSH EBP<br>BFF667FE  |.  8BEC          MOV EBP,ESP<br>BFF66800  |.  FF75 0C       PUSH DWORD PTR SS:[EBP+C]<br>BFF66803  |.  52            PUSH EDX<br>BFF66804  |.  64:FF35 00000&gt;PUSH DWORD PTR FS:[0]<br>BFF6680B  |.  64:8925 00000&gt;MOV DWORD PTR FS:[0],ESP<br>BFF66812  |.  FF75 14       PUSH DWORD PTR SS:[EBP+14]<br>BFF66815  |.  FF75 10       PUSH DWORD PTR SS:[EBP+10]<br>BFF66818  |.  FF75 0C       PUSH DWORD PTR SS:[EBP+C]<br>BFF6681B  |.  FF75 08       PUSH DWORD PTR SS:[EBP+8]<br><I>BFF6681E  |.  FF55 18       CALL DWORD PTR SS:[EBP+18]               ;  Call SEH</I><br>BFF66821  |.  83C4 10       ADD ESP,10<br>BFF66824  |.  64:8F05 00000&gt;POP DWORD PTR FS:[0]<br>BFF6682B  |.  C9            LEAVE<br>BFF6682C  \.  C3            RET<br></code><br>Но, повторюсь: не пойму, зачем это нам?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260984&amp;user=3910&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=29" class="addthx" data-post="260984"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 июня 2010 20:40 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16399&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
Ну если в НТ эта точка одинакова, возможно, в 9х тоже. Но гарантировать не могу, когда я начал ревёрсить, у меня уже не стояла 9х. И сейчас не стоит, иначе бы уже 33 раза проверил. Подняться можно, глядя в стек, бряки не нужны. Ну делай через дебаг, не буду больше донимать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=260985&amp;user=1556&amp;forum_n=6&amp;topic=16399&amp;page=0&amp;anchor=30" class="addthx" data-post="260985"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=16399&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=16399&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=6&amp;topic=16399&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как поставить железный бряк? (НЕ в Ольге, естесвенно :]</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="16399">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=16399" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
