<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>SSE эмулятор - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Привет. Никто не видел в природе SSE эмулятора? А то тут Adobe устроил засаду, Adobe Bridge хочет SSE для работы. Притом не то что хочет, а даже не проверяет ничего, а так как у меня CPU SSE не поддерживает - он просто валится. В">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> SSE эмулятор</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 марта 2008 11:42 &middot; Поправил: cppasm <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Привет.<br>Никто не видел в природе SSE эмулятора?<br>А то тут Adobe устроил засаду, Adobe Bridge хочет SSE для работы.<br>Притом не то что хочет, а даже не проверяет ничего, а так как у меня CPU SSE не поддерживает - он просто валится.<br>В отладчике я посмотрел - конечно оптимизация супер, без SSE ну просто никак.<br>95% SSE кода это:<br><code>movss xmm0,[mem1]<br>movss [mem2],xmm0</code><br>Ну вот собственно я и подумал, что если сэмулировать SSE, производительность будет приемлемая, тем более что Photoshop работает без проблем.<br>Собственно почему тема в программировании?<br>Ну я больше чем уверен что нет такого эмулятора, прийдётся писать :/<br><br>И есть пару вопросов:<br><br>1. Есть ли в адресном пространстве процесса ниже 2Gb адреса куда он не лезет?<br>Т.е. ImageBase обычно 400000h, а что находится ниже?<br>Просто надо где-то хранить для каждого процесса XMM регистры, и адресное пространство - самое подходящее место.<br>Тогда не надо отслеживать переключение задач и отлавливать завершение процесса для освобождения памяти занимаемой виртуальными XMM регистрами.<br>Вопрос есть ли какая-нибудь функция MemoryManager чтобы замапить страницу в адресное пространство процесса ниже 2Гб желательно с доступом только из Ring0, и по каким адресам лучше мапить?<br>Руками не охота что-то таблицу страниц править...<br><br>2. Как из Ring0 проверить доступна ли память?<br>Т.е. допустим в коде написана команда movss xmm0,[mem_addr]<br>Я её буду эмулировать, и если прога бажная, mem_addr вообще говоря может быть недоступен.<br>А BSOD ловить не охота...<br><br>3. Как перехватить CPUID чтобы прикинуться что есть поддержка SSE?<br>Что-то кроме трассировки ничего в голову не приходит, но это убьёт производительность в разы.<br>Ну это не обязательно, эмуляция преимущественно делается для наглых программ которые не проверяют наличие SSE.<br>Хотя было бы полезно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183333&amp;user=6859&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=1" class="addthx" data-post="183333"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Rustem[/b]','')">Rustem</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 74.1 (постоянный), 34thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.41'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1301">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 марта 2008 12:29 <br><script type="text/javascript">QU('Rustem','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rustem" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Ловить исключение при каждой команде ссе будет очень долго. Даже если напишешь, вряд ли устроит скорость<br>А для эмулятора самое удобное было бы загрузить свою длл и можешь хранить в ней любые значения любых регистров
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183339&amp;user=1301&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=2" class="addthx" data-post="183339"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]nobodyzzz[/b]','')">nobodyzzz</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.9 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.49'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=15040">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 марта 2008 12:31 <br><script type="text/javascript">QU('nobodyzzz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nobodyzzz" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
&gt;3. Как перехватить CPUID чтобы прикинуться что есть поддержка SSE? <br>Скорее всего CPUID не юзаеться на прямую, а через IsProcessorFeaturePresent так что можно попробовать перехватывать её
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183340&amp;user=15040&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=3" class="addthx" data-post="183340"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 марта 2008 13:14 &middot; Поправил: cppasm <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>Rustem пишет:<br>Ловить исключение при каждой команде ссе будет очень долго. </I><br>Не так и долго, там не так много SSE кода.<br>Я пробовал пропатчить прогу, заменив<br><code>movss xmm0,[mem1]<br>movss [mem2],xmm0</code><br>на<br><code>push [mem1]<br>pop   [mem2]</code>, а остальные SSE команды просто занопить (их там не так много).<br>В принципе работает нормально, только из-за того что я заменил не все команды некоторые табы плохо отображаются.<br>В общем со скоростью будет нормально.<br><I>Rustem пишет:<br>А для эмулятора самое удобное было бы загрузить свою длл и можешь хранить в ней любые значения любых регистров </I><br>А как я в ней из Ring3 UD# буду перехватывать? Или при помощи SEH исключения ловить?<br>И как подгрузить свою dll при старте процесса, в импорт добавить?<br><I>nobodyzzz пишет:<br>Скорее всего CPUID не юзаеться на прямую, а через IsProcessorFeaturePresent так что можно попробовать перехватывать её </I><br>Наличие расширений та программа ради которой всё затеваю вообще не проверяет.<br>Но хотелось бы сделать универсально...<br>А IsProcessorFeaturePresent в любом случае в CPUID упрётся, только перехватить его не получается.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183344&amp;user=6859&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=4" class="addthx" data-post="183344"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ssx[/b]','')">ssx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 352.4 (мудрец), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33">Участник</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 марта 2008 15:12 <br><script type="text/javascript">QU('ssx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ssx" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
на этом форуме уже была тема cpuid hook, правда чем все завершилось не помню
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183368&amp;user=33&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=5" class="addthx" data-post="183368"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Rustem[/b]','')">Rustem</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 74.1 (постоянный), 34thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.41'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1301">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 марта 2008 15:16 <br><script type="text/javascript">QU('Rustem','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rustem" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Про перехват CPUID уже написано как Ms-Rem&#039;ом: сделать ее привелегерованой инструкцией и ловить исключения. Для этого дрова нужны<br><br>Длл можно подгрузить многими способами: например копай функции SetWindowsHook, CreateRemoteProcess, ключ реестра App_InitDlls.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183369&amp;user=1301&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=6" class="addthx" data-post="183369"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]seeq[/b]','')">seeq</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3067.jpg" alt=""><br><span class=txtSm>Ранг: 105.9 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.64'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3067">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 марта 2008 15:16 &middot; Поправил: seeq <br><script type="text/javascript">QU('seeq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=seeq" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
CPUID - ты просто так не перехватишь. Намного легче пропатчить IsProcessorFeaturePresent  и не париться.<br><br>add<br>MS-REM ошибся, так сделать не получиться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183370&amp;user=3067&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=7" class="addthx" data-post="183370"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 марта 2008 15:31 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Для перехвата cpuid есть два способа: виртуализация и динамическая рекомпиляция кода. Могу выложить сорцы своей недописаной либы реализующей второй способ. Только разбираться с ними будете сами.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=183373&amp;user=12867&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=8" class="addthx" data-post="183373"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 марта 2008 15:32 &middot; Поправил: cppasm <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Та фиг с ним с CPUID, хотя судя по мануалам её привелегированной сделать нельзя.<br>Она вообще кроме UD# исключений не генерирует, а UD# только на 486 и нижу.<br><I>seeq пишет:<br>Намного легче пропатчить IsProcessorFeaturePresent и не париться.  </I><br>Ну не париться оно вообще легче <img src="img/smilies/s1.gif" alt=""><br>А многие проги CPUID напрямую используют...<br>Ну это ладно.<br>Отговорили меня писать эмулятор, наверное буду просто прогу патчить и убирать неугодные команды...<br>Хотя эмулятор было бы по-прикольней сделать.<br>// ПС: отговорили в смысле оно нафиг никому не надо...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183374&amp;user=6859&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=9" class="addthx" data-post="183374"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 марта 2008 15:36 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>ntldr пишет:<br>Для перехвата cpuid есть два способа: виртуализация и динамическая рекомпиляция кода.  </I><br>А можно идею динамическая рекомпиляции кода по-подробней?<br>Просто я всё что придумал - это включить трассировку и ловить исключения с проверкой опкодов.<br>Но это уронит производительность сильно.<br>А виртуализация не годится, если на CPU SSE нет - то какая тут виртуализация...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183375&amp;user=6859&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=10" class="addthx" data-post="183375"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 марта 2008 15:44 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>cppasm пишет:<br>А можно идею динамическая рекомпиляции кода по-подробней? </I><br>Смысл идеи состоит в дизассемблировании и пересборке кода перед испольнением. Рекомпилированые учатски кода кешируются в памяти и используются повторно. Для трансляции адресов переходов используется хеш таблица рекомпилированых участком и jump cache хранящий адреса трансляции последних 256 джампов. Там еще много тонкостей, и немало проблем с самодифицирующимся кодом, динамически выделяемой памятью, и.т.д. Моя недоделаная реализация успешно работает с обычными прогами, и даже с некоторыми протекторами. Перехватывается любая произвольная команда, падение производительности 1.5-3 раза. <br><br>По вышеописаному имхо будет трудно вьехать в особенности метода, ибо про это надо писать большую и подробную статью, на что у меня сейчас нет времени. Поэтому попробуйте разобраться с сорцами этой херни.<br><br><img src="img/attach.gif" alt=""> <a href="./files/7a7e_17.03.2008_CRACKLAB.rU.tgz">7a7e_17.03.2008_CRACKLAB.rU.tgz</a> - virt_x.rar
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=183378&amp;user=12867&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=11" class="addthx" data-post="183378"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 марта 2008 16:25 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Сорцы пошёл читать...<br>Так ты основного не написал - в какой момент происходит дизассемблирование и пересборка команды/команд?<br>Ты трассировку используеш, или по-другому как-то?<br>Хотя думаю в исходниках сейчас найду.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183385&amp;user=6859&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=12" class="addthx" data-post="183385"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 марта 2008 17:09 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>cppasm пишет:<br>Так ты основного не написал - в какой момент происходит дизассемблирование и пересборка команды/команд? </I><br>Базовый блок кода пересобирается перед его исполнением. Все выходы из блока при рекомпиляции заменяются на процедуры компилятора, и при их вызове происходит определение и рекомпиляция следующего блока. Никакая трассировка тут не нужна.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=183390&amp;user=12867&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=13" class="addthx" data-post="183390"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 марта 2008 18:41 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Понял. Это что-то типа эмулятора процессора на нём же самом получается.<br>Чем-то на VM похоже...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183402&amp;user=6859&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=14" class="addthx" data-post="183402"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Unmoored[/b]','')">Unmoored</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.2 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.48'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=9253">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2008 13:41 <br><script type="text/javascript">QU('Unmoored','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Unmoored" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Извиняюсь за оффтопик, но что это у Вас за процессор такой без SSE? Это что ли ниже P3? Вобще не представляю с какой скоростью может работать мультимедиа приложение от Adobe на такой системе...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183507&amp;user=9253&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=15" class="addthx" data-post="183507"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2008 15:35 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>Unmoored пишет:<br>Извиняюсь за оффтопик, но что это у Вас за процессор такой без SSE? Это что ли ниже P3? </I><br>Нет, не ниже Р3 - это просто процессор от AMD. А у AMD до AthlonXP SSE не было, у них своё расширение 3DNow!<br>А в Adobe как я выяснил на это всё подзабили, и даже Photoshop который работает - 3DNow! не видит и не использует, использует только ММХ.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183517&amp;user=6859&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=16" class="addthx" data-post="183517"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]-= ALEX =-[/b]','')">-= ALEX =-</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/220.jpg" alt=""><br><span class=txtSm>Ранг: 260.3 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.89'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=220">Участник</a><br><font color=blue>PPC-PROTECT author</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2008 16:34 <br><script type="text/javascript">QU('-= ALEX =-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-= ALEX =-" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
offtop: да за пару рублей можно системник купить готовый  с монитором athlon xp ... неужели в 21 веке такая проблема с этим )))
<br><br><font size="1"><i>-----<br>Пиво, сиськи, транс</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=183519&amp;user=220&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=17" class="addthx" data-post="183519"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2008 18:24 &middot; Поправил: cppasm <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
за пару рублей это врядли <img src="img/smilies/s1.gif" alt=""><br>ну и наф он мне нужен? покупать так уже двухъядерник какой-нить.<br>кароче, всем кто собирается писать подобные советы - меня моя система вполне устраивает, и из-за одной проги я ничего покупать не буду. проще её просто снести и забыть.<br>интересно эмулятор сделать.<br><br>лучше скажите мне на каком IRQL выполняется обработчик исключения UD#, и на каком IRQL можно вызывать ZwGetContextThread/NtGetContextThread. Чего-то они сильно не документированы...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183522&amp;user=6859&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=18" class="addthx" data-post="183522"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]seeq[/b]','')">seeq</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3067.jpg" alt=""><br><span class=txtSm>Ранг: 105.9 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.64'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3067">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2008 20:25 <br><script type="text/javascript">QU('seeq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=seeq" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
зачем тебе так глубоко лезть. Ставь VectoredHandler перехватывай исключения и эмуль
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183530&amp;user=3067&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=19" class="addthx" data-post="183530"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 марта 2008 11:15 &middot; Поправил: cppasm <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11513.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
Посмотрел VectoredHandler.<br>А в чём его отличие от SEH? Я что-то не врубился.<br>Насколько я понял в любом случае как с SEH так и с VectoredHandler надо модифицировать исполняемый файл.<br>dll туда свою подгрузить или секцию приаттачить и EP сменить.<br>А если сделать драйвер эмуляция будет работать для всех приложений.<br>// Добавлено<br>В принципе если делать через dll, то вроди нормально.<br>Есть ли где-нибудь статья как подгрузить свою dll при запуске процесса?<br>Т.е. чтобы моя dll сразу системным загрузчиком загружалась, желательно до остальных dll этого процесса.<br>Её в импорт добавить надо или как?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183595&amp;user=6859&amp;forum_n=6&amp;topic=11513.html&amp;page=0&amp;anchor=20" class="addthx" data-post="183595"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> SSE эмулятор</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#21" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="11513">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=11513" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
