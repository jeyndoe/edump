<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Ресурсы типа String. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Ребята, никто не пробовал выводить строчки из ресурсов PE(RT_STRING - 6) в лист бокс.Почему WideCharToMultiByte корректно определяет только русские и английские строчки. Все остальные языки заменяет английскими буквами, а">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=55997'>bezumchik</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Ресурсы типа String.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]zombi-vadim[/b]','')">zombi-vadim</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.3 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.41'>Активность: 0.15<span style='color:green'>&nearr;</span>0.22</span><br>Статус: <a href="action=userinfo&amp;user=42072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2019 21:14 <br><script type="text/javascript">QU('zombi-vadim','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zombi-vadim" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Ребята, никто не пробовал выводить строчки из ресурсов PE(RT_STRING - 6) в лист бокс.Почему WideCharToMultiByte корректно определяет только русские и английские строчки. Все остальные языки заменяет английскими буквами, а корейские - китайские, вообще не видит, выдает знаки вопросов?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399692&amp;user=42072&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=1" class="addthx" data-post="399692"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2019 21:32 <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>int</b></span>&nbsp;WideCharToMultiByte<span class="hl_char">(</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;UINT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CodePage</span><span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwFlags</span><span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;_In_NLS_string_<span class="hl_char">(</span>cchWideChar<span class="hl_char">)</span>LPCWCH&nbsp;lpWideCharStr<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cchWideChar</span><span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;LPSTR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lpMultiByteStr</span><span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cbMultiByte</span><span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;LPCCH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lpDefaultChar</span><span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;LPBOOL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lpUsedDefaultChar</span></li><li class="hl_l1"><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>Про параметр CodePage <noindex><a href="https://docs.microsoft.com/en-us/windows/win32/api/stringapiset/nf-stringapiset-widechartomultibyte" rel="nofollow" target="_blank">читай</a></noindex>
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=399693&amp;user=8075&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=2" class="addthx" data-post="399693"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]zombi-vadim[/b]','')">zombi-vadim</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.3 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.41'>Активность: 0.15<span style='color:green'>&nearr;</span>0.22</span><br>Статус: <a href="action=userinfo&amp;user=42072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2019 21:58 <br><script type="text/javascript">QU('zombi-vadim','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zombi-vadim" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>f13nd</b>Я так понимаю если выставить параметр CP_ACP, то функция пытается подобрать аналог символа Юникода к текущей кодовой странице. Из ресурсов можно извлечь только LangID. Пробовал подставлять в ручную значения. Ничего не помогает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399694&amp;user=42072&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=3" class="addthx" data-post="399694"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2019 22:08 &middot; Поправил: f13nd <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>zombi-vadim пишет:<br>Я так понимаю если выставить параметр CP_ACP, то функция пытается подобрать аналог символа Юникода к текущей кодовой странице. </I><br>Для этого W-функции в винде и есть, чтобы не преобразовывать в ANSI, а выводить юникоде. Тебе нужен юникодовый листбокс и юникод ему передавать.
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=399695&amp;user=8075&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=4" class="addthx" data-post="399695"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]zombi-vadim[/b]','')">zombi-vadim</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.3 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.41'>Активность: 0.15<span style='color:green'>&nearr;</span>0.22</span><br>Статус: <a href="action=userinfo&amp;user=42072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2019 22:20 <br><script type="text/javascript">QU('zombi-vadim','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zombi-vadim" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>f13nd</b>Я как то не горел желанием преобразовывать проект к юникоду. <I>f13nd пишет:<br>W-функции </I>То есть вообщем единственный вариант насколько я вас понял это работать напрямую с юникодом? WideCharToMultiByte тут не поможет?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399696&amp;user=42072&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=5" class="addthx" data-post="399696"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2019 22:24 <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>zombi-vadim пишет:<br>WideCharToMultiByte тут не поможет? </I><br>Ну если найдешь способ другой чарсет установить окну, то может и поможет. Я такого способа не знаю. LVM_SETUNICODEFORMAT можешь посмотреть, чтоб не жестить сильно над программой.
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=399697&amp;user=8075&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=6" class="addthx" data-post="399697"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=42072" title="07-11-2019 19:27, ранг:11.7" target="_blank">zombi-vadim</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]zombi-vadim[/b]','')">zombi-vadim</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.3 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.41'>Активность: 0.15<span style='color:green'>&nearr;</span>0.22</span><br>Статус: <a href="action=userinfo&amp;user=42072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2019 22:25 <br><script type="text/javascript">QU('zombi-vadim','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zombi-vadim" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>f13nd</b>Спасибо за обьяснения.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399698&amp;user=42072&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=7" class="addthx" data-post="399698"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]dezmand07[/b]','')">dezmand07</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 19.5 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 2.98'>Активность: 0.05<span style='color:green'>&nearr;</span>0.08</span><br>Статус: <a href="action=userinfo&amp;user=42822">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2019 23:46 <br><script type="text/javascript">QU('dezmand07','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dezmand07" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>zombi-vadim пишет:<br>Я как то не горел желанием преобразовывать проект к юникоду. </I><br>так и не нужно.<br>ничего не мешает использовать в проекте с много байтовой кодировкой юникодные W-функции.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399700&amp;user=42822&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=8" class="addthx" data-post="399700"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]zombi-vadim[/b]','')">zombi-vadim</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.3 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.41'>Активность: 0.15<span style='color:green'>&nearr;</span>0.22</span><br>Статус: <a href="action=userinfo&amp;user=42072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2019 19:09 &middot; Поправил: zombi-vadim <br><script type="text/javascript">QU('zombi-vadim','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zombi-vadim" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>dezmand07</b><I>dezmand07 пишет:<br>ничего не мешает использовать в проекте с много байтовой кодировкой юникодные W-функции. </I><br>Да ничего не мешает. Но насколько я разобрался в ситуации, корень зла в том что все окна  в многобайтовом проекте ожидают ANSI строки, и им плевать что получают они юникод строку.Один фиг она будет преобразована в ANSI  и выведена на экран в виде крокозяблов. А вот обходной путь требует копания на форумах, как поставить юникод чарсет окну в ручную. У меня пока не получается.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399719&amp;user=42072&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=9" class="addthx" data-post="399719"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2019 19:39 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Если проект на Visual Studio, то<br>1) В свойствах проекта поменять General -&gt; Character Set: Use Unicode Character Set<br>2) В файлах проекта перед символами &quot; и &#039; поставить символ L<br>3) Все типы char заменить на wchar_t
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=399721&amp;user=24257&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=10" class="addthx" data-post="399721"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]rmn[/b]','')">rmn</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 158.4 (ветеран), 123thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.28'>Активность: 0.14<span style='color:green'>&nearr;</span>0.49</span><br>Статус: <a href="action=userinfo&amp;user=1533">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2019 19:44 <br><script type="text/javascript">QU('rmn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rmn" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>zombi-vadim</b><br>Винда понятия не имеет ни о каких ansi-проектах. Все стандартные контролы реализованы чисто юникодовыми, A-функции просто конвертируют переданную мультибайтную строку в юникод и вызывают парную W-функцию. Всякие CCM_SETUNICODEFORMAT нужны только тем контролам, у которых нет раздельных A- и W-сообщений, чтобы они понимали, указатель на что ты им передаешь.<br><br><b>Добавлено спустя 4 минуты</b><br><I>DenCoder пишет:<br>2) В файлах проекта перед символами &quot; и &#039; поставить символ L </I><br>Лучше использовать макрос TEXT(). Это сконпелируется в строку, соответствующую выбранной кодировке.<br><br><I>DenCoder пишет:<br>3) Все типы char заменить на wchar_t </I><br>Лучше на TCHAR, по той же причине. И не забывать при том  <b>/ sizeof(TCHAR)</b>, когда в компайлтайме длину буфера вычисляешь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399722&amp;user=1533&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=11" class="addthx" data-post="399722"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]zombi-vadim[/b]','')">zombi-vadim</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.3 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.41'>Активность: 0.15<span style='color:green'>&nearr;</span>0.22</span><br>Статус: <a href="action=userinfo&amp;user=42072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2019 20:45 &middot; Поправил: zombi-vadim <br><script type="text/javascript">QU('zombi-vadim','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zombi-vadim" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>DenCoder пишет:<br>В свойствах проекта поменять General -&gt; Character Set: Use Unicode Character Set </I><br><I>zombi-vadim пишет:<br>Я как то не горел желанием преобразовывать проект к юникоду </I><br>CString в юникодовом проекте выдает мне правильные символы в лист бокс, но в многобайтовом - ерунду.<br>У меня много самописных функций для поиска и форматирования строки, даже трудно себе представить сколько времени займет их модификация. И все ради вывода строчек из ресурса в юникоде.<br><br><b>Добавлено спустя 12 минут</b><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CString&nbsp;strOutput<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPCWSTR&nbsp;temp&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>LPCWSTR<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>WinINIR&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_function">Offset</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; i &lt; 256; i++)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>temp<span class="hl_char">[</span>i<span class="hl_char">]</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;0x00&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strOutput&nbsp;</span><span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;temp<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_box<span class="hl_char">.</span>AddString<span class="hl_char">(</span>strOutput<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>Вот простейший пример, что тут можно сделать.Контрол не хочет видеть юникод строку.Можно только преобразовать проект к юникоду. иначе мусор на экране.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399726&amp;user=42072&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=12" class="addthx" data-post="399726"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2019 22:14 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Преобразуй!
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=399736&amp;user=24257&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=13" class="addthx" data-post="399736"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=42072" title="08-11-2019 19:37, ранг:12.1" target="_blank">zombi-vadim</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]zombi-vadim[/b]','')">zombi-vadim</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.3 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.41'>Активность: 0.15<span style='color:green'>&nearr;</span>0.22</span><br>Статус: <a href="action=userinfo&amp;user=42072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2019 22:36 <br><script type="text/javascript">QU('zombi-vadim','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zombi-vadim" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>DenCoder</b>Ок) Я уже понял. Либо так либо никак.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399745&amp;user=42072&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=14" class="addthx" data-post="399745"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2019 06:00 &middot; Поправил: f13nd <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>zombi-vadim пишет:<br>А вот обходной путь требует копания на форумах, как поставить юникод чарсет окну в ручную. </I><br>Цэшнику наверное все равно будет понятна идея:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">pushdatanp&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_quote">'SysListView32'</span><span class="hl_char">\</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_char">[</span>binMainWindowRect<span class="hl_char">.</span>bottom<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>sub</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_char">[</span>binMainWindowRect<span class="hl_char">.</span>top<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_char">[</span>binMainWindowRect<span class="hl_char">.</span>right<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>sub</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_char">[</span>binMainWindowRect<span class="hl_char">.</span>left<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;CreateWindowExA<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;<span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">10</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span>WS_CHILD<span class="hl_char">+</span>WS_VISIBLE<span class="hl_char">+</span>WS_TABSTOP<span class="hl_char">+</span>WS_BORDER<span class="hl_char">+</span>LVS_AUTOARRANGE<span class="hl_char">+</span>LVS_TYPEMASK<span class="hl_char">+</span>LVS_LIST<span class="hl_char">+</span>LVS_SINGLESEL<span class="hl_char">+</span>LVS_SHOWSELALWAYS<span class="hl_char">,</span><span class="hl_char">[</span>binMainWindowRect<span class="hl_char">.</span>left<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_char">[</span>binMainWindowRect<span class="hl_char">.</span>top<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_char">[</span>hwnd<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_char">.</span>MainWindowInfo<span class="hl_char">.</span>hInstance<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_char">.</span>MainWindowInfo<span class="hl_char">.</span>hLvTest<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l1">popdata</li><li class="hl_l0"><span class="hl_function"><b>invoke</b></span>&nbsp;SendMessageA<span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_char">.</span>MainWindowInfo<span class="hl_char">.</span>hLvTest<span class="hl_char">]</span><span class="hl_char">,</span>LVM_SETCOLUMNWIDTH<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_number">200</span></li><li class="hl_l1">pushdata&nbsp;pszLvItemText1<span class="hl_char">,</span><span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_quote">'Произвольный текст 1'</span><span class="hl_char">\</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pushdatanp&nbsp;LVITEM&nbsp;LVIF_TEXT</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;SendMessageA<span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_char">.</span>MainWindowInfo<span class="hl_char">.</span>hLvTest<span class="hl_char">]</span><span class="hl_char">,</span>LVM_GETITEMCOUNT<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;LVITEM<span class="hl_char">.</span>iItem<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_char">[</span>pszLvItemText1<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;LVITEM<span class="hl_char">.</span>pszText<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ecx</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;SendMessageA<span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_char">.</span>MainWindowInfo<span class="hl_char">.</span>hLvTest<span class="hl_char">]</span><span class="hl_char">,</span>LVM_INSERTITEMA<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_registr">esp</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;popdata</li><li class="hl_l1">popdata</li><li class="hl_l0">pushdata&nbsp;pszLvItemText2<span class="hl_char">,</span><span class="hl_function"><b>db</b></span>&nbsp;0x45<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x69<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x6E<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x6D<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x61<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x6C<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x20<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x4B<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span><span class="hl_char">\</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xF6</span><span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x6C<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x6E<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x20<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x62<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x69<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x74<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x74<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span><span class="hl_char">\</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x65</span><span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x00<span class="hl_char">\</span><span class="hl_char">,</span>0x00</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pushdatanp&nbsp;LVITEM&nbsp;LVIF_TEXT</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;SendMessageW<span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_char">.</span>MainWindowInfo<span class="hl_char">.</span>hLvTest<span class="hl_char">]</span><span class="hl_char">,</span>LVM_GETITEMCOUNT<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;LVITEM<span class="hl_char">.</span>iItem<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_char">[</span>pszLvItemText2<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>esp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;LVITEM<span class="hl_char">.</span>pszText<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ecx</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;SendMessageW<span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_char">.</span>MainWindowInfo<span class="hl_char">.</span>hLvTest<span class="hl_char">]</span><span class="hl_char">,</span>LVM_INSERTITEMW<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_registr">esp</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;popdata</li><li class="hl_l0">popdata</li>        </ol>
    </div>
</div></div>
<br><noindex><a href="https://imgbb.com/" rel="nofollow" target="_blank"> <img src="https://i.ibb.co/ZW2NFcL/image.png" border="0" align="" alt=""></a></noindex><br>На всякий случай исходник <noindex><a href="http://sendfile.su/1527269" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=399768&amp;user=8075&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=15" class="addthx" data-post="399768"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]RamMerlabs[/b]','')">RamMerlabs</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 73.1 (постоянный), 130thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.41'>Активность: 0.04<span style='color:green'>&nearr;</span>0.23</span><br>Статус: <a href="action=userinfo&amp;user=9891">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2019 14:41 &middot; Поправил: RamMerlabs <br><script type="text/javascript">QU('RamMerlabs','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=RamMerlabs" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>f13nd</b><br>[зануда-mode]<br><I>invoke SendMessageW,[.MainWindowInfo.hLvTest],LVM_GETITEMCOUNT,0,0<br>mov [esp + LVITEM.iItem],eax</I><br>LVM_GETITEMCOUNT здесь вобщем-то лишний, можно сэкономить на SendMessage, указав в LVITEM.iItem просто что-то вроде 07FFFFFFFh, Item будет добавлен в конец списка.<br>[/зануда-mode]
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399786&amp;user=9891&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=16" class="addthx" data-post="399786"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]zombi-vadim[/b]','')">zombi-vadim</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.3 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.41'>Активность: 0.15<span style='color:green'>&nearr;</span>0.22</span><br>Статус: <a href="action=userinfo&amp;user=42072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 ноября 2019 21:15 <br><script type="text/javascript">QU('zombi-vadim','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zombi-vadim" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26162.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Вообщем переделал все под юникод, все работает, спасибо за помощь. Могу дать совет всем кто зайдет по ссылке на эту страницу, ребята пишите сразу на юникоде иначе рано или поздно вам все равно придется все переписывать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399843&amp;user=42072&amp;forum_n=5&amp;topic=26162.html&amp;page=0&amp;anchor=17" class="addthx" data-post="399843"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Ресурсы типа String.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=26162" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
