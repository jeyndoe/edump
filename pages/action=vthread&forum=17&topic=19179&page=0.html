<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>PIC 16F877 настройка USART - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброго времени суток форумчане. Имею код на Cи Code:       #include&nbsp;&lt;pic.h&gt;#include&nbsp;&quot;conio.h&quot;#include&nbsp;&quot;string.h&quot;#include&nbsp;&quot;stdio.h&quot;#include&nbsp;&quot;delay.h&quot;#include&n">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=21426'>Dart Raiden</a>, <a target='_blank' href='?action=userinfo&amp;user=55930'>bedop66938</a>, <a target='_blank' href='?action=userinfo&amp;user=33192'>morgot</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/rt.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=17&sortBy=0&page=0.html"><b>Электроника</b></a> <b class=bulletHead>&#8212;&#8250;</b> PIC 16F877 настройка USART</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]cosinus[/b]','')">cosinus</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 13.8 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.18'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=20919">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 октября 2011 19:34 &middot; Поправил: cosinus <br><script type="text/javascript">QU('cosinus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cosinus" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=19179.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброго времени суток форумчане.<br>Имею  код на Cи<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#include&nbsp;<span class="hl_char">&lt;</span>pic<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l1">#include&nbsp;<span class="hl_quote">&quot;conio.h&quot;</span></li><li class="hl_l0">#include&nbsp;<span class="hl_quote">&quot;string.h&quot;</span></li><li class="hl_l1">#include&nbsp;<span class="hl_quote">&quot;stdio.h&quot;</span></li><li class="hl_l0">#include&nbsp;<span class="hl_quote">&quot;delay.h&quot;</span></li><li class="hl_l1">#include&nbsp;<span class="hl_quote">&quot;rs232.h&quot;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;main<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;инициализация&nbsp;порта</li><li class="hl_l1">ADCON0<span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_comment">;ADCON1=6;  // оключает аналоговые входы</span></li><li class="hl_l0">TRISA<span class="hl_char">=</span><span class="hl_number">0b00000000</span><span class="hl_comment">;   // всеножки порта на &quot;выход&quot;</span></li><li class="hl_l1">TRISE<span class="hl_char">=</span><span class="hl_number">0b00000100</span><span class="hl_comment">;   // порт RE2 используется как вход</span></li><li class="hl_l0">RA0<span class="hl_char">=</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">RA1<span class="hl_char">=</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">RA2<span class="hl_char">=</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">RA3<span class="hl_char">=</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">Rs232_Init<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;главный&nbsp;цикл</li><li class="hl_l1"><span class="hl_function">while</span><span class="hl_char">(</span><span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>RE2<span class="hl_char">)</span>&nbsp;{RA1<span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_comment">; RA2=0; RA3=0; printf(&quot;Hello World\r\n&quot;);}</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">}<span class="hl_char">/</span><span class="hl_char">/</span>main</li>        </ol>
    </div>
</div></div>
<br><br>Микроконтроллер подлючен к компьютеру через ST232. Так же на порте PORTE на ножке RE2 &quot;висит&quot; кнопка. При нажатии на которую получаю на ножке RE2 ноль, после чего выводится на терминалку &quot;Hello World&quot;<br><b> файл rs232.h</b><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;Rs232_Init&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;Rs232_Put&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_function"><b>char</b></span>&nbsp;Rs232_Get&nbsp;&nbsp;<span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>char</b></span>&nbsp;Rs232_Get&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">#define&nbsp;BSIZE&nbsp;<span class="hl_number">78</span></li><li class="hl_l0">bank1&nbsp;unsigned&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;buf<span class="hl_char">[</span>BSIZE<span class="hl_char">]</span><span class="hl_comment">;    /* Кольцевой буфер 		     */</span></li><li class="hl_l1">unsigned&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span>inptr&nbsp;<span class="hl_char">=</span>&nbsp;buf<span class="hl_comment">;  /* Указатель на первое свободное место  */</span></li><li class="hl_l0">unsigned&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span>outptr&nbsp;<span class="hl_char">=</span>&nbsp;buf<span class="hl_comment">; /* Указатель на первый считываемый байт */</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;interrupt&nbsp;rs232<span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1"><span class="hl_char">*</span>inptr&nbsp;<span class="hl_char">=</span>&nbsp;RCREG<span class="hl_comment">;  				/* Считаем байт */</span></li><li class="hl_l0"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">+</span><span class="hl_char">+</span>inptr&nbsp;<span class="hl_char">&gt;</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">&amp;</span>buf<span class="hl_char">[</span>BSIZE<span class="hl_char">]</span><span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;Проверка&nbsp;выхода&nbsp;за&nbsp;границу&nbsp;буфера&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inptr&nbsp;</span><span class="hl_char">=</span>&nbsp;buf<span class="hl_comment">;		/* Если да, то начнем сначала		*/</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;Rs232_Init<span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRISC7<span class="hl_char">=</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRISC6<span class="hl_char">=</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BRGH&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;		/* high baud rate */</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPBRG&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">25</span><span class="hl_comment">;		/* set the baud rate */ //9600</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPBRG&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">129</span><span class="hl_comment">;		/* set the baud rate */ //9600</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPBRG&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">12</span><span class="hl_comment">;		/* set the baud rate */ //19200</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SYNC&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;		/* asynchronous */</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPEN&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;		/* enable serial port pins */</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CREN&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;		/* enable reception */</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SREN&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;		/* no effect */</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TXIE&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;		/* disable tx interrupts */</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RCIE&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;		/* enable rx interrupts*/</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RCIE&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;		/* disable rx interrupts */</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TX9&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;		/* 8- or 9-bit transmission */</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RX9&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;		/* 8- or 9-bit reception */</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TXEN&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;		/* enable the transmitter */</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PIE1<span class="hl_char">=</span>0x020<span class="hl_comment">;		/* enable rx interrupts*/</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTCON<span class="hl_char">=</span>0x080<span class="hl_comment">;	/* прерывания разрешены*/</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PEIE<span class="hl_char">=</span><span class="hl_number">1</span><span class="hl_comment">; 		/* разрешаем прерывания от переферийных модулей */</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GIE<span class="hl_char">=</span><span class="hl_number">1</span><span class="hl_comment">;			/* глобальное разрешение прерываний*/</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>OERR<span class="hl_char">)</span>&nbsp;{CREN<span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_comment">; CREN=1;}	// проверка на переполнение буфера и восстановление приёма </span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span></li><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;Rs232_Put<span class="hl_char">(</span><span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_function">byte</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">while</span><span class="hl_char">(</span><span class="hl_char">!</span>TXIF<span class="hl_char">)</span>&nbsp;continue<span class="hl_comment">;	// дожидаемся освобождения буфера передатчика</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TXREG&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>byte</b></span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1"><span class="hl_char">*</span><span class="hl_char">/</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;putch<span class="hl_char">(</span><span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_function">byte</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">while</span><span class="hl_char">(</span><span class="hl_char">!</span>TXIF<span class="hl_char">)</span>&nbsp;continue<span class="hl_comment">;	// дожидаемся освобождения буфера передатчика</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TXREG&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>byte</b></span><span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>char</b></span>&nbsp;Rs232_Get<span class="hl_char">(</span><span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_registr">ch</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>inptr&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;outptr<span class="hl_char">)</span>&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_registr"><b>ch</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span>outptr<span class="hl_comment">;	</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">+</span><span class="hl_char">+</span>outptr&nbsp;<span class="hl_char">&gt;</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">&amp;</span>buf<span class="hl_char">[</span>BSIZE<span class="hl_char">]</span><span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outptr&nbsp;<span class="hl_char">=</span>&nbsp;buf<span class="hl_comment">;		    </span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<span class="hl_char">(</span><span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0"><span class="hl_function"><b>else</b></span>&nbsp;return<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;Rs232_PutStr<span class="hl_char">(</span><span class="hl_function"><b>const</b></span>&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span><span class="hl_function">byte</span><span class="hl_char">)</span></li><li class="hl_l0">{while<span class="hl_char">(</span><span class="hl_char">*</span><span class="hl_function">byte</span><span class="hl_char">)</span>{while<span class="hl_char">(</span><span class="hl_char">!</span>TXIF<span class="hl_char">)</span>&nbsp;continue<span class="hl_comment">;TXREG = *byte; *byte++;};}</span></li>        </ol>
    </div>
</div></div>
<br><br>Всё прекрасно работает.<br>Решил переписать этот код на ассемблере, так как код не мой и в синтаксисе Си я не разбираюсь.<br>(Этот код мне написали, чтобы заинтересовать в программировании &quot;железных рук&quot; и продемонстрировать работу МК)<br>Вообщем загружаю hex-файл прошивки в эмулятор ( PIC Simulator IDE ) и обложившись мануалами начал трассировать.<br>В итоге вот что у меня получилось:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>bsf</b></span>&nbsp;STATUS<span class="hl_char">,</span>&nbsp;RP0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;\_Переходим в банк 1</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bcf&nbsp;STATUS<span class="hl_char">,</span>&nbsp;RP1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;/</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clrf&nbsp;ADCON1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movlw&nbsp;<span class="hl_number">6h</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; Отключение АЦП</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movwf&nbsp;ADCON1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;/</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movlw&nbsp;<span class="hl_quote">b'00000100'</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;\_Настраиваем порт RE2 на вход</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movwf&nbsp;TRISE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;/</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movlw&nbsp;<span class="hl_quote">b'11000000'</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;\__Устанавливаем биты 6 и 7 чтобы работал Rx Tx</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movwf&nbsp;TRISC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;/</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movlw&nbsp;<span class="hl_quote">b'00100110'</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;TXEN=1h, SYNC=0h, BRGH=1h, TSR=1h</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movwf&nbsp;TXSTA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;Настраиваем передатчик</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movlw&nbsp;<span class="hl_number">81h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;Помещаем в аккумулятор число 31 (BRGH=0) (129 [81h] при BRGH=1, погрешность 0.16)</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movwf&nbsp;SPBRG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;Настраиваем USART МК для работы с кварцем на 20 МГц и скорости обмена в 9600 бит/сек. </span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movlw&nbsp;<span class="hl_quote">b'00100000'</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;Настраиваем регистр с масками прерываний переферийных устройств</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movwf&nbsp;PIE1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;( RCIE=1h ) Разрешаем прерывание от приёмника USART</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movlw&nbsp;<span class="hl_quote">b'11000000'</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;Настраиваем регистр флагов и масок прерываний</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movwf&nbsp;INTCON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;GIE=1h, PEIE=1h</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bcf&nbsp;STATUS<span class="hl_char">,</span>&nbsp;RP0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;\_Переходим в банк 0</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bcf&nbsp;STATUS<span class="hl_char">,</span>&nbsp;RP1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;/</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clrf&nbsp;ADCON0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;Отключение АЦП</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movlw&nbsp;<span class="hl_quote">b'11000000'</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;Настраиваем регистр флагов и масок прерываний</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movwf&nbsp;INTCON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;GIE=1h, PEIE=1h</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movlw&nbsp;<span class="hl_quote">b'10010000'</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;Настраивем регистр управления и статуса приёмника RCSTA</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movwf&nbsp;RCSTA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;SPEN=1h, CREN=1h</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">loc_1<span class="hl_char">:</span></li><li class="hl_l1">btfss&nbsp;PORTE<span class="hl_char">,</span>&nbsp;RE2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;Пропустить следующую команду, если на ножке RE2 порта Е &quot;единица&quot;</span></li><li class="hl_l0">goto&nbsp;loc_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; При нажатии на &quot;кнопку&quot; получаем &quot;лог.ноль&quot; и выводим на терминал строчку</span></li><li class="hl_l1">goto&nbsp;loc_1</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">loc_2<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;Send_Hello</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;loc_1</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_comment">;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></li><li class="hl_l0"><span class="hl_comment">;					Вывести &quot;Hello World&quot;</span></li><li class="hl_l1"><span class="hl_comment">;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></li><li class="hl_l0">Send_Hello</li><li class="hl_l1">movlw&nbsp;<span class="hl_quote">'H'</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;TX</li><li class="hl_l1">movlw&nbsp;<span class="hl_quote">'e'</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;TX</li><li class="hl_l1">movlw&nbsp;<span class="hl_quote">'l'</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;TX</li><li class="hl_l1">movlw&nbsp;<span class="hl_quote">'l'</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;TX</li><li class="hl_l1">movlw&nbsp;<span class="hl_quote">'o'</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;TX</li><li class="hl_l1">movlw&nbsp;<span class="hl_number">20h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; пробел</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;TX</li><li class="hl_l1">movlw&nbsp;<span class="hl_quote">'W'</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;TX</li><li class="hl_l1">movlw&nbsp;<span class="hl_quote">'o'</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;TX</li><li class="hl_l1">movlw&nbsp;<span class="hl_quote">'r'</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;TX</li><li class="hl_l1">movlw&nbsp;<span class="hl_quote">'l'</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;TX</li><li class="hl_l1">movlw&nbsp;<span class="hl_quote">'d'</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;TX</li><li class="hl_l1">movlw&nbsp;<span class="hl_number">0Dh</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;TX</li><li class="hl_l1">movlw&nbsp;<span class="hl_number">0Ah</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;TX</li><li class="hl_l1">return</li><li class="hl_l0"><span class="hl_comment">;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></li><li class="hl_l1"><span class="hl_comment">; 					Функция передачи</span></li><li class="hl_l0"><span class="hl_comment">;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></li><li class="hl_l1">TX</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movwf&nbsp;TXREG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; Помещаем в регистр TXREG то, что надо передать.</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>bsf</b></span>&nbsp;STATUS<span class="hl_char">,</span>&nbsp;RP0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;\_Переходим в банк 1</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bcf&nbsp;STATUS<span class="hl_char">,</span>&nbsp;RP1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;/</span></li><li class="hl_l1">loc_tx<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btfss&nbsp;TXSTA<span class="hl_char">,</span>&nbsp;TRMT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Ждём пока пик не освободит</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;loc_tx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; сдвиговый регистр передатчика</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bcf&nbsp;STATUS<span class="hl_char">,</span>&nbsp;RP0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;\_Переходим в банк 0</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bcf&nbsp;STATUS<span class="hl_char">,</span>&nbsp;RP1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;/</span></li><li class="hl_l0"><span style="word-break: break-all">return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; Выход из процедуры</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br>После компиляции и &quot;заливки&quot; прошивки, заветная строчка НЕ прилетает на терминалку.<br>Вот собственно просьба, подскажите где я допустил ошибку? И помогите перевести &quot;СИшный&quot; код в ASM.<br>Думаю что ошибка в инициализации USART, но тыщу раз просматривал в эмуляторе и никак не могу увидеть.<br><br>Конечно код...<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">movlw&nbsp;<span class="hl_quote">b'00100110'</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;TXEN=1h, SYNC=0h, BRGH=1h, TSR=1h</span></li><li class="hl_l0">movwf&nbsp;TXSTA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;Настраиваем передатчик</span></li>        </ol>
    </div>
</div></div>
<br><br>... можно представить в виде<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">clrf&nbsp;TXSTA</li><li class="hl_l1"><span class="hl_function"><b>bsf</b></span>&nbsp;TXSTA<span class="hl_char">,</span>&nbsp;TXEN</li><li class="hl_l0"><span class="hl_function"><b>bsf</b></span>&nbsp;TXSTA<span class="hl_char">,</span>&nbsp;BRGH</li><li class="hl_l1"><span class="hl_function"><b>bsf</b></span>&nbsp;TXSTA<span class="hl_char">,</span>&nbsp;TSR</li>        </ol>
    </div>
</div></div>
<br>Но при трассировке в MPLAB (и на живом железе тоже), команды типа <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">clrf&nbsp;PORTA</li><li class="hl_l1"><span class="hl_function"><b>bsf</b></span>&nbsp;PORTA<span class="hl_char">,</span>&nbsp;RA0</li><li class="hl_l0"><span class="hl_function"><b>bsf</b></span>&nbsp;PORTA<span class="hl_char">,</span>&nbsp;RA1</li><li class="hl_l1"><span class="hl_function"><b>bsf</b></span>&nbsp;PORTA<span class="hl_char">,</span>&nbsp;RA2</li>        </ol>
    </div>
</div></div>
<br>&quot;взводится&quot; только одна ножка порта (а точнее по очереди),  потому и выбран был вышеуказанный способ. Потому как думал это &quot;недочёт&quot; микроконтроллеров и трабла в инициализации USART могла в этих командах.<br>PS. на ножках RA0-RA2 у меня висят светодиодики, и их я  в коде не указал из-за экономии места. И именно для этих светодиодов включено прерывание от приёмника... дабы принять цифру &quot;1&quot; и зажечь светодиод RA0. И также в коде не указан обработчик прерываний (но он есть)<br><br>Или быть может у меня дизассемблер неправильно работает,  или одно из двух<br>т.к. строки исходника....<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">ADCON0<span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_comment">;ADCON1=6;  // оключает аналоговые входы</span></li><li class="hl_l1">TRISA<span class="hl_char">=</span><span class="hl_number">0b00000000</span><span class="hl_comment">;   // всеножки порта на &quot;выход&quot;</span></li><li class="hl_l0">TRISE<span class="hl_char">=</span><span class="hl_number">0b00000100</span><span class="hl_comment">;   // порт RE2 используется как вход</span></li>        </ol>
    </div>
</div></div>
<br><br>...превращаются в<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">L13<span class="hl_char">:</span></li><li class="hl_l1">clrf&nbsp;0x1F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Очистить ADCON0 (находится в 0-ом банке)</span></li><li class="hl_l0">movlw&nbsp;0x06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Поместить в аккамулятор 6h</span></li><li class="hl_l1"><span class="hl_function"><b>bsf</b></span>&nbsp;STATUS<span class="hl_char">,</span>RP0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Перейти в банк 1</span></li><li class="hl_l0">movwf&nbsp;0x1F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Переслать содержимое аккамулятора в регистр ADCON0</span></li><li class="hl_l1">clrf&nbsp;0x05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Очистить регистр PORTA</span></li><li class="hl_l0">movlw&nbsp;0x04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Поместить в аккамулятор 4h</span></li><li class="hl_l1">movwf&nbsp;0x09&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Присвоить значение регистру PORTE значение аккамулятора, что в двоичной системе есть &quot;00000100&quot; </span></li>        </ol>
    </div>
</div></div>
<br><br>То есть по сути всё ровно, только не понятно как находясь в банке 1, можно обращаться к данным в банке 0 ? Ведь регистр ADCON0 находится в 0-ом банке. А так же фигурируют адреса PORTA и PORTE, когда должны быть адреса TRISA (85h)и TRISE(89h).  И вообще 6h для ADCON1 предназначено.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=293942&amp;user=20919&amp;forum_n=17&amp;topic=19179.html&amp;page=0&amp;anchor=1" class="addthx" data-post="293942"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]cosinus[/b]','')">cosinus</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 13.8 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.18'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=20919">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 октября 2011 07:43 &middot; Поправил: cosinus <br><script type="text/javascript">QU('cosinus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cosinus" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=19179.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Разобрался с дизассемблером, оказывается он некорректно работает.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0011</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">019F</span>&nbsp;&nbsp;&nbsp;&nbsp;L13<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clrf&nbsp;ADCON0</li><li class="hl_l1"><span class="hl_number">0012</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">3006</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movlw&nbsp;0x06</li><li class="hl_l0"><span class="hl_number">0013</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">1683</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>bsf</b></span>&nbsp;STATUS<span class="hl_char">,</span>RP0</li><li class="hl_l1"><span class="hl_number">0014</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">009F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movwf&nbsp;0x1F</li><li class="hl_l0"><span class="hl_number">0015</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clrf&nbsp;PORTA</li><li class="hl_l1"><span class="hl_number">0016</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">3004</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movlw&nbsp;0x04</li><li class="hl_l0"><span class="hl_number">0017</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0089</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movwf&nbsp;0x09</li>        </ol>
    </div>
</div></div>
<br><br>Обратив внимание на опкоды, увидел следущее: 0011 <b>019F</b> обозначает стереть регистр, адрес которого <b>9F</b> чему соответствует ADCON1. Точно также и с командой по адресу 0015:<br><b>0185</b> - которая очищает регистр адрес которого 85h чему соответсвует TRISA, а вовсе не PORTA как показывает дизассемблер. Исшо адресс 0017 определён не верно - опкод <b>0089</b> обозначает, что надо переслать число из аккамулятора (WREG) в 89h. А по адресу 89h как раз находится TRISE.<br><br><img src="http://s017.radikal.ru/i418/1110/0b/0c7cf5b4826e.png" border="0" align="" alt=""><br><br>up:<br>Оказалось что дизассемблер НЕ отслеживает изменения банка памяти, вследствие чего выдаёт такие &quot;недоразумения&quot;.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=293990&amp;user=20919&amp;forum_n=17&amp;topic=19179.html&amp;page=0&amp;anchor=2" class="addthx" data-post="293990"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]cosinus[/b]','')">cosinus</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 13.8 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.18'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=20919">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 октября 2011 23:46 <br><script type="text/javascript">QU('cosinus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cosinus" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=19179.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Разобрался с проблемой.<img src="img/smilies/s1.gif" alt=""><br>Оказалось, что у меня (в asm-коде) не корректная обработка прерываний. А точнее выход из прерывания с восстановлением WREG и STATUS. Отключив все прерывания (INTCON, PIE\GIE), заветная строчка вывелась на терминал.<br>Прерывание от приёмника USART было включено. Так как у меня на ножках порта А &quot;висят&quot; светодиоды, и в зависимости от цифры посланной МК - зажигался светодиод. А при нажатии на кнопку (PORTE, RE2) выводилась строка.<br>Но то что дизассемблеры в MPLAB IDE и в PIC Simulator IDE не отслеживают изменения банка памяти - факт.<br>Будте осторожны <img src="img/smilies/s14.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294057&amp;user=20919&amp;forum_n=17&amp;topic=19179.html&amp;page=0&amp;anchor=3" class="addthx" data-post="294057"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=7" title="11-11-2011 15:13, ранг:521.1" target="_blank">Bad_guy</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/rt.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=17&sortBy=0&page=0.html"><b>Электроника</b></a> <b class=bulletHead>&#8212;&#8250;</b> PIC 16F877 настройка USART</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19179" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
