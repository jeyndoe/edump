<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите сломать cd-check - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Добрый день. Пытаюсь отучить игру RollerCoaster Tycoon от диска, но пока не выходит. Нашел где игра проверяет файлы в папке Data, вот в этом Code:       00418E41&nbsp;&nbsp;|&gt;&nbsp;&nbsp;E8&nbsp;08000000&nbsp;&nbsp;&nbsp;CALL&n">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=41144'>Adler</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите сломать cd-check</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]bytec0de[/b]','')">bytec0de</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.24'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34589">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2013 12:22 <br><script type="text/javascript">QU('bytec0de','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bytec0de" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21384.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Добрый день.<br>Пытаюсь отучить игру RollerCoaster Tycoon от диска, но пока не выходит.<br>Нашел где игра проверяет файлы в папке Data, вот в этом<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00418E41</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">&gt;</span>&nbsp;&nbsp;E8&nbsp;<span class="hl_number">08000000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;rct_rus<span class="hl_char">.</span><span class="hl_number">00418E4E</span></li>        </ol>
    </div>
</div></div>
  <br>вызове находится процедура проверки. Т.е. игра ищет файлы в этой папке, затем читает отсутствующие файлы с образа и если не находит (образ не смонтирован) выводит месседжбокс.<br>Пропатчил вот здесь (поставил retn в начало процедуры).<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00418E3E</span>&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">$</span>&nbsp;&nbsp;<span class="hl_number">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">PUSHAD</span></li><li class="hl_l1"><span class="hl_number">00418E3F</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">33DB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">EBX</span><span class="hl_char">,</span><span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">00418E41</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">&gt;</span>&nbsp;&nbsp;E8&nbsp;<span class="hl_number">08000000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;rct_rus<span class="hl_char">.</span><span class="hl_number">00418E4E</span></li><li class="hl_l1"><span class="hl_number">00418E46</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">&gt;</span>&nbsp;&nbsp;<span class="hl_number">43</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>INC</b></span>&nbsp;<span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">00418E47</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">83FB</span>&nbsp;<span class="hl_number">39</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">EBX</span><span class="hl_char">,</span><span class="hl_number">39</span></li><li class="hl_l1"><span class="hl_number">00418E4A</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>^&nbsp;<span class="hl_number">72</span>&nbsp;F5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JB</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;rct_rus<span class="hl_char">.</span><span class="hl_number">00418E41</span></li><li class="hl_l0"><span class="hl_number">00418E4C</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">61</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">POPAD</span></li><li class="hl_l1"><span class="hl_number">00418E4D</span>&nbsp;&nbsp;<span class="hl_char">\</span><span class="hl_char">.</span>&nbsp;&nbsp;C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">RETN</span></li>        </ol>
    </div>
</div></div>
<br>После этого игра запустилась, но при попытке начать новую игру, или пройти обучение нас просто выкидывает обратно в главное меню.<br>Так же можно занопать все это<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0058423D</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;C745&nbsp;FC&nbsp;<span class="hl_number">04010</span><span class="hl_char">&gt;</span><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">104</span></li><li class="hl_l1"><span class="hl_number">00584244</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8D45</span>&nbsp;FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00584247</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>EAX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; /pBufSize</span></li><li class="hl_l1"><span class="hl_number">00584248</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B45</span>&nbsp;<span class="hl_number">08</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |</span></li><li class="hl_l0"><span class="hl_number">0058424B</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">05</span>&nbsp;<span class="hl_number">0C020000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">20C</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |</span></li><li class="hl_l1"><span class="hl_number">00584250</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>EAX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |Buffer</span></li><li class="hl_l0"><span class="hl_number">00584251</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8D45</span>&nbsp;F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">8</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |</span></li><li class="hl_l1"><span class="hl_number">00584254</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>EAX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |pValueType</span></li><li class="hl_l0"><span class="hl_number">00584255</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |Reserved = NULL</span></li><li class="hl_l1"><span class="hl_number">00584257</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">54FA8B00</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;rct_rus<span class="hl_char">.</span><span class="hl_number">008BFA54</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |ValueName = &quot;SetupPath&quot;</span></li><li class="hl_l0"><span class="hl_number">0058425C</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B45</span>&nbsp;F4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span>C<span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |</span></li><li class="hl_l1"><span class="hl_number">0058425F</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>EAX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; |hKey</span></li><li class="hl_l0"><span class="hl_number">00584260</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;FF15&nbsp;<span class="hl_number">10B07800</span>&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_char">&lt;</span><span class="hl_char">&amp;</span>ADVAPI32<span class="hl_char">.</span>RegQueryVa<span class="hl_char">&gt;</span><span class="hl_comment">; \RegQueryValueExA</span></li>        </ol>
    </div>
</div></div>
<br>или изменить<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00584257</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">54FA8B00</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;rct_rus<span class="hl_char">.</span><span class="hl_number">008BFA54</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |ValueName = &quot;SetupPath&quot;</span></li>        </ol>
    </div>
</div></div>
<br>на push 008BFA4C<br>Но результат будет аналогичный предыдущему, стартует, но поиграть нельзя.<br>Так же заметил, что если распаковать установочные файлы с образа на диск и установить игру, она запуститься, но опять же, дальше меню не пустит. Т.е. игра проверяет откуда она была установлена, если с жесткого диска, то поиграть нельзя.<br>Пробовал ставить бряки на GetDriveType, GetLogicalDrives, GetLogicalDriveStrings но они не срабатывают.<br>Прошу помощи.<br>Собственно <noindex><a href="http://rghost.ru/private/45276150/f38c68d2e5312f3e0431193295c049f5" rel="nofollow" target="_blank">вот</a></noindex> ехе файлы, а <noindex><a href="http://rutracker.org/forum/viewtopic.php?t=1348183" rel="nofollow" target="_blank">тут</a></noindex> раздача самой игры.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=322831&amp;user=34589&amp;forum_n=5&amp;topic=21384.html&amp;page=0&amp;anchor=1" class="addthx" data-post="322831"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]mysterio[/b]','')">mysterio</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1803.gif" alt=""><br><span class=txtSm>Ранг: 307.9 (мудрец), 196thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.17'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1803">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 апреля 2013 18:42 <br><script type="text/javascript">QU('mysterio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mysterio" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21384.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Игру не качал - так как влом ее ставить (а ставить ее нужно).<br>GetLogicalDriveStringsA есть дальше, правда до него не доходит - ругается раньше что диска нет:<br>005870FA  |. FF15 D0B07800  CALL DWORD PTR DS:[&lt;&amp;KERNEL32.GetLogicalDriveStringsA&gt;]<br><br>00418E41 - не убивай, а обойди (там чекаются нужные для игры файлы - &quot;\Data\CSG1.DAT&quot;). Посмотри как запускается с диском как без него.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00418F32</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;E8&nbsp;BEDF1600&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;rct_rus<span class="hl_char">.</span><span class="hl_number">00586EF5</span></li><li class="hl_l1"><span class="hl_number">00418F37</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;<span class="hl_number">83C4</span>&nbsp;<span class="hl_number">04</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">4</span></li><li class="hl_l0"><span class="hl_number">00418F3A</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;C705&nbsp;<span class="hl_number">7CE8C300</span>&nbsp;<span class="hl_char">&gt;</span><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span>C3E87C<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_number">00418F44</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;<span class="hl_number">5B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr"><b>EBX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;  rct_rus.00418E46</span></li><li class="hl_l0"><span class="hl_number">00418F45</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>&nbsp;<span class="hl_number">83F8</span>&nbsp;FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_char">-</span><span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_number">00418F48</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0F85</span>&nbsp;<span class="hl_number">9E000000</span>&nbsp;&nbsp;<span class="hl_function"><b>JNZ</b></span>&nbsp;rct_rus<span class="hl_char">.</span><span class="hl_number">00418FEC</span>&nbsp;&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span>&nbsp;Если&nbsp;файл&nbsp;не&nbsp;нашли&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">=</span><span class="hl_char">-</span><span class="hl_number">1</span>&nbsp;<span class="hl_char">-</span>&nbsp;не&nbsp;прыгаем&nbsp;и&nbsp;далее&nbsp;говорим&nbsp;что&nbsp;диска&nbsp;нет<span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br><br>Игру все-равно прийдется ставить - так как она пишет в реестр нужную. инфу для запуска (вроде это CDKey и путь (от)куда она поставлена. Догадка: Скорее всего откуда так как возможно что указанный выше файл должен быть на диске - иначе зачем чекать файл и место откуда поставлена игра ;).
<br><br><font size="1"><i>-----<br>Don_t hate the cracker - hate the code.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=322999&amp;user=1803&amp;forum_n=5&amp;topic=21384.html&amp;page=0&amp;anchor=2" class="addthx" data-post="322999"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]bytec0de[/b]','')">bytec0de</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.24'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34589">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 апреля 2013 10:43 <br><script type="text/javascript">QU('bytec0de','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bytec0de" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21384.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>mysterio пишет:<br>00418E41 - не убивай, а обойди </I><br>Да без толку. Патчил я jnz на jmp по адресу 00418F48. Запустится то она запускается, но при попытке начать новую игру выкидывает обратно в главное меню.<br><I>mysterio пишет:<br>она пишет в реестр нужную. инфу для запуска </I><br>Угу. <br>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Fish Technology Group\RollerCoaster Tycoon Setup<br>Значение &quot;SetupPath&quot; там имя диска с которого она была установлена.<br>Только я об этом уже писал в первом сообщении.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=323031&amp;user=34589&amp;forum_n=5&amp;topic=21384.html&amp;page=0&amp;anchor=3" class="addthx" data-post="323031"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Cigan[/b]','')">Cigan</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.89'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=208">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 апреля 2013 13:27 <br><script type="text/javascript">QU('Cigan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Cigan" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21384.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Что проще, пропиши в SetupPath путь к установленной игре и скопируй туда в папки не достающие файлы. Ну а дальше если не пойдет проверяй АПИ которые отвечают за проверку диска. То есть, есть место на диске или нет и все в этом вроде дело 5-ти минут.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=323043&amp;user=208&amp;forum_n=5&amp;topic=21384.html&amp;page=0&amp;anchor=4" class="addthx" data-post="323043"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 апреля 2013 16:14 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21384.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>bytec0de пишет:<br>Т.е. игра ищет файлы в этой папке, затем читает отсутствующие файлы с образа и если не находит (образ не смонтирован) выводит месседжбокс. </I><br>В те далёкии времена жёсткий диск объёмом 4 Gb  были роскашью поэтому часть данных игры хранилось на компакт диске,скопируйте все данные с папки <b>Data\</b> на компакт диске в папку <b>\Program Files\Fish Technology Group\RollerCoaster Tycoon\Data\</b> и будем вам счасть и удовольствие <img src="img/smilies/s1.gif" alt="">)))
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=323047&amp;user=17432&amp;forum_n=5&amp;topic=21384.html&amp;page=0&amp;anchor=5" class="addthx" data-post="323047"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 апреля 2013 17:20 &middot; Поправил: ELF_7719116 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21384.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>ClockMan пишет:<br>данные с папки Data\ на компакт диске в папку \Program Files\Fish Technology Group\RollerCoaster Tycoon\Data\ и будем вам счасть и удовольствие ))) </I><br>Помню, такая хрень еще была в <b>Heroes</b>. Но там диск проверялся. Еще в <b>DarkColony</b> было! Помню, удивлялся тогда, почему все раздачи шли одним образом для эмулятора - пришлось самому исправлять баг <img src="img/smilies/s1.gif" alt=""> http://rutracker.org/forum/viewtopic.php?t=3683906
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=323050&amp;user=26651&amp;forum_n=5&amp;topic=21384.html&amp;page=0&amp;anchor=6" class="addthx" data-post="323050"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]KingSise[/b]','')">KingSise</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2470.gif" alt=""><br><span class=txtSm>Ранг: 469.0 (мудрец), 100thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.88'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2470">Участник</a><br><font color=blue>[www.AHTeam.org]</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 апреля 2013 17:48 &middot; Поправил: KingSise <br><script type="text/javascript">QU('KingSise','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=KingSise" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21384.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Я тоже со своей программулинкой вклинюсь, может защита похожа. <br><br>скачать тут: http://rghost.ru/45347869<br><br>до чего дошел:<br>с помощью CreateFileA открываем каждый диск (&quot;\.\D:&quot;)<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00502B1C</span>&nbsp;&nbsp;&nbsp;&nbsp;FF55&nbsp;<span class="hl_number">14</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>NEAR</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">+</span>0x14<span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; CreateFile</span></li>        </ol>
    </div>
</div></div>
<br><br>в EAX будет 64, как я понимаю это дескриптор, который  будет использован функцией  DeviceIOControl ниже, что бы получить доступ к таблице разделов диска.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00502B42</span>&nbsp;&nbsp;&nbsp;&nbsp;FF75&nbsp;F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span>0x8<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00502B45</span>&nbsp;&nbsp;&nbsp;&nbsp;FF55&nbsp;<span class="hl_number">18</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>NEAR</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">+</span>0x18<span class="hl_char">]</span>&nbsp;<span class="hl_comment">; call DeviceIOControl</span></li>        </ol>
    </div>
</div></div>
<br><br><br>если что, тут поправьте: Участок кода выше заполняет читает первые 0x800 байт диска.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00502B79</span>&nbsp;&nbsp;&nbsp;&nbsp;BE&nbsp;<span class="hl_number">00080000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ESI</span><span class="hl_char">,</span>0x800</li><li class="hl_l1"><span class="hl_number">00502B7E</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;0x1</li><li class="hl_l0"><span class="hl_number">00502B80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">10</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;0x10</li><li class="hl_l1"><span class="hl_number">00502B82</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l0"><span class="hl_number">00502B83</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>EBX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; lpInBuffer = 00BE0000</span></li><li class="hl_l1"><span class="hl_number">00502B84</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D45</span>&nbsp;C4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span>0x3C<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00502B87</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00502B88</span>&nbsp;&nbsp;&nbsp;&nbsp;FF75&nbsp;F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span>0x8<span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; hDevice</span></li><li class="hl_l0"><span class="hl_number">00502B8B</span>&nbsp;&nbsp;&nbsp;&nbsp;FF55&nbsp;<span class="hl_number">24</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>NEAR</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">+</span>0x24<span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br><br><br><br>тут мне немного непонятно, еще раз читаем 800h данных с диска в тот же буфер? Откуда именно?<b>?</b>:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00502BBD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8945</span>&nbsp;E0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span>0x20<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr"><b>EAX</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_number">00502BC0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">00502BC1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D45</span>&nbsp;C4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span>0x3C<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00502BC4</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>EAX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">;[EBX+0x590]</span></li><li class="hl_l0"><span class="hl_number">00502BC5</span>&nbsp;&nbsp;&nbsp;&nbsp;FF75&nbsp;F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span>0x8<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00502BC8</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">897D</span>&nbsp;D8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span>0x28<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EDI</span></li><li class="hl_l0"><span class="hl_number">00502BCB</span>&nbsp;&nbsp;&nbsp;&nbsp;FF55&nbsp;<span class="hl_number">24</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>NEAR</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">+</span>0x24<span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; discTest.00502D66</span></li><li class="hl_l1"><span class="hl_number">00502BCE</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">85C0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">00502BD0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0F84</span>&nbsp;<span class="hl_number">85000000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;discTest<span class="hl_char">.</span><span class="hl_number">00502C5B</span></li><li class="hl_l1">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br><br>дальше цикл сравнения двух строк: с диска и того что зашит в программу<br><b><i class=x>81 D9 3B 1D 68 42 0B 41 AE B4 DC D7 BB 21 6C FA</i></b><br><br><br>00502BE1    F3:A7           REPE CMPS DWORD PTR ES:[EDI],DWORD PTR DS:[ESI]<br><br>Ну а дальше мне уже не понятно, ибо оригинального диска у меня нет...
<br><br><font size="1"><i>-----<br>-=истина где-то рядом=-</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=323061&amp;user=2470&amp;forum_n=5&amp;topic=21384.html&amp;page=0&amp;anchor=7" class="addthx" data-post="323061"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 апреля 2013 17:57 &middot; Поправил: ELF_7719116 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21384.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>KingSise</b><br><strike>Нечто похожее на топик с TrusCont TSFD Protection Toolkit(Флешка с байтами-ключами): </strike>https://ssl.exelab.ru/f/action=vthread&amp;forum=13&amp;topic=21208<br>Да это и есть <b>TrusCont TSFD Protection Toolkit</b>!<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=323063&amp;user=26651&amp;forum_n=5&amp;topic=21384.html&amp;page=0&amp;anchor=8" class="addthx" data-post="323063"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]bytec0de[/b]','')">bytec0de</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.24'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34589">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 апреля 2013 21:18 &middot; Поправил: bytec0de <br><script type="text/javascript">QU('bytec0de','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bytec0de" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21384.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>Cigan пишет:<br>Что проще, пропиши в SetupPath путь к установленной игре и скопируй туда в папки не достающие файлы. </I><br><I>bytec0de пишет:<br>Так же заметил, что если распаковать установочные файлы с образа на диск и установить игру, она запуститься, но опять же, дальше меню не пустит. Т.е.<u>игра проверяет откуда она была установлена, если с жесткого диска, то поиграть нельзя.</u> </I><br><I>Cigan пишет:<br>Ну а дальше если не пойдет проверяй АПИ которые отвечают за проверку диска. </I><br><I>bytec0de пишет:<br>Пробовал ставить бряки на GetDriveType, GetLogicalDrives, GetLogicalDriveStrings но они не срабатывают.</I><br>Подскажи еще АПИ которые можно попробовать.<br><I>ClockMan пишет:<br>скопируйте все данные с папки Data\ на компакт диске в папку \Program Files\Fish Technology Group\RollerCoaster Tycoon\Data\ и будем вам счасть и удовольствие )))  </I><br>Спасибо, эту процедуру тоже проделывал, результат все тот же, игра запускается но поиграть нельзя.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=323084&amp;user=34589&amp;forum_n=5&amp;topic=21384.html&amp;page=0&amp;anchor=9" class="addthx" data-post="323084"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2013 11:14 &middot; Поправил: ClockMan <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21384.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>bytec0de пишет:<br>Спасибо, эту процедуру тоже проделывал, результат все тот же, игра запускается но поиграть нельзя. </I><br>Процедура проверки на наличее файлов<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">418E3E</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function">PUSHAD</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">418E3F</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">EBX</span><span class="hl_char">,</span><span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">418E41</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">00418E4E</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">418E46</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>INC</b></span>&nbsp;<span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">418E47</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">EBX</span><span class="hl_char">,</span><span class="hl_number">39</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>кол<span class="hl_char">-</span>во&nbsp;проверяемых&nbsp;файлов</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">418E4A</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>JB</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">00418E41</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">418E4C</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function">POPAD</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">418E4D</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function">RET</span></li>        </ol>
    </div>
</div></div>
<br>далее заходим в CALL 00418E4E<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">418EEC</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">EBX</span><span class="hl_char">,</span><span class="hl_number">29</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>когда&nbsp;кол<span class="hl_char">-</span>во&nbsp;файло&nbsp;привысет&nbsp;<span class="hl_number">41</span>&nbsp;то&nbsp;поиск&nbsp;будет&nbsp;идти&nbsp;с&nbsp;усаново<span class="hl_char">-</span>го&nbsp;места<span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">418EEF</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>JB</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">00418EF6</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">418EF1</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">EBX</span><span class="hl_char">,</span><span class="hl_number">2F</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">418EF4</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>JBE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">00418EFF</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>заменить&nbsp;на&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_number">00418EF6</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">418EF6</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_char">-</span><span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">418EF9</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>JNZ</b></span>&nbsp;<span class="hl_number">00418FEC</span></li>        </ol>
    </div>
</div></div>
<br>далее <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">4190D6</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">88E759</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">4190DB</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">8C2B64</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>путь&nbsp;к&nbsp;папке&nbsp;<span class="hl_quote">&quot;Saved Games&quot;</span>&nbsp;из&nbsp;места&nbsp;установки</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">4190E0</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">00586F8B</span><span class="hl_comment">; \FindFirstFileA</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">4190E5</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">8</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">4190E8</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_char">[</span>C3E87C<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">4190F2</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>нету&nbsp;такой&nbsp;папки<span class="hl_char">?</span>&nbsp;на&nbsp;выход</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">4190F5</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">0041912C</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>меняем&nbsp;на&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_number">00419121</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">4190F7</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">DL</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_number">88E88E</span><span class="hl_char">]</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>получение&nbsp;атрибута&nbsp;папки<span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">4190FD</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>записываем&nbsp;в&nbsp;стек<span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">4190FE</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_char">[</span>C3E87C<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">3</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">419108</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">419109</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">00586FD0</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">41910E</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">4</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">419111</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_char">[</span>C3E87C<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">41911B</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EDX</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">41911C</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_registr">DL</span><span class="hl_char">,</span><span class="hl_number">7E</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>сверка&nbsp;атрибута&nbsp;папки<span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">41911F</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>JNZ</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">0041912C</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>не&nbsp;прошли&nbsp;проверку&nbsp;на&nbsp;выход<span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">419121</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span><span class="hl_number">88D901</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">419126</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function"><b>DEC</b></span>&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">+</span><span class="hl_number">53D</span><span class="hl_char">]</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>интерестнейшая&nbsp;манипуляция</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">41912C</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function">POPAD</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">41912D</span><span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;&nbsp;<span class="hl_function">RETN</span></li><li class="hl_l1">&nbsp;</li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=323108&amp;user=17432&amp;forum_n=5&amp;topic=21384.html&amp;page=0&amp;anchor=10" class="addthx" data-post="323108"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=72" title="18-04-2013 07:17, ранг:839.1" target="_blank">Hellspawn</a>, <a href="action=userinfo&user=34589" title="18-04-2013 07:32, ранг:0.6" target="_blank">bytec0de</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]bytec0de[/b]','')">bytec0de</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.24'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34589">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2013 11:33 <br><script type="text/javascript">QU('bytec0de','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bytec0de" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21384.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Спасибо, все работает.<br>4190D6 вот сюда то я внимания и не обращал.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=323109&amp;user=34589&amp;forum_n=5&amp;topic=21384.html&amp;page=0&amp;anchor=11" class="addthx" data-post="323109"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите сломать cd-check</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=21384" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
