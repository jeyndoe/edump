<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Неизвестный переход - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем привет! Разъясните пожалуйста поведение приложения, не понимаю как это работает. Ситуация следующая: Перед отправкой пакета перенаправляется вызов WSASend на какую-то кастомную функцию, после этого пакет зашифровывается и">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55997'>bezumchik</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=55477'>Lohmaty</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Неизвестный переход</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Osoro[/b]','')">Osoro</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 1.07'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=50115">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2019 11:24 <br><script type="text/javascript">QU('Osoro','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Osoro" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Всем привет!<br><br>Разъясните пожалуйста поведение приложения, не понимаю как это работает.<br><br>Ситуация следующая: Перед отправкой пакета перенаправляется вызов WSASend на какую-то кастомную функцию, после этого пакет зашифровывается и вызывается оригинальный WSASend. (Моя теория).<br><br>Начал дебажить, расставил трассировку, пытаюсь понять порядок вызова функций. Вижу в IDA такой блок:<br>[Скриншот 1]<br><br>Судя по скриншоту мы находимся по адресу:<br>.text:00423A80 push    esi<br><br>Логично подумать что, так как операции выполняются друг за другом мы перейдем в адрес:<br>.text:00423A81 stosd<br>И далее<br>.text:00423A82 loopne  near ptr unk_423ADD<br>выходим из функции.<br><br>НО! Когда в дебаггере я выполняю переход к следующей операции, я оказываюсь вообще в другом блоке кода с другой адресацией:<br>debug078:029C1B30 push    ebp   &lt;---------- Тут<br>debug078:029C1B31 mov     ebp, esp<br>debug078:029C1B33 sub     esp, 20h<br>debug078:029C1B36 push    ebx<br>debug078:029C1B37 push    esi<br>debug078:029C1B38 push    edi<br>debug078:029C1B39 jmp     loc_2A1D88<br><br>Скорее всего это и есть перехват управления на кастомную функцию, но я в упор не понимаю где описано что нужно перейти в другое место, те вроде как ни в регистрах, нигде не описан этот адрес вообще, на момент ПЕРЕД переходом. <br><br>Можете пояснить пожалуйста каким образом происходит этот переход?<br><br>Спасибо!<br><br><img src="img/attach.gif" alt=""> <a href="./files/b26f_16.06.2019_EXELAB.rU.tgz">b26f_16.06.2019_EXELAB.rU.tgz</a> - jpg.png
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=395574&amp;user=50115&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=1" class="addthx" data-post="395574"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2019 11:35 <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
По твоей картинке не понятно вообще ничего и словесное описание не улучшает ситуации. Могу только предположить, что в совершенно в другом месте ты оказываешься из-за исключения, обработчик которого перенес тебя туда.
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395575&amp;user=8075&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=2" class="addthx" data-post="395575"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Osoro[/b]','')">Osoro</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 1.07'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=50115">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2019 11:37 &middot; Поправил: Osoro <br><script type="text/javascript">QU('Osoro','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Osoro" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Скажите какую информацию отправить, чтобы помочь разобраться?<br><br>@f13nd:<br>Можно ли посмотреть список исключений, которые могли бы сработать?<br><br>Просто получается что наверняка методов которые позволяют делать такие переходы ограниченное количество?<br>Процессор же должен понимать какие инструкции он &quot;должен&quot; выполнить далее?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=395576&amp;user=50115&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=3" class="addthx" data-post="395576"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2019 11:41 &middot; Поправил: f13nd <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Об исключениях отладчик всегда предупреждает, если ты не настроил его игнорировать определенные. В иде это выгдялит как мерзкое окошко, куда надо кликать. Список обработчиков находится в цепочке SEH (был еще VEH, но хоть раз бы его увидеть), такие трюки с прыжками делает обычно самый верхний, который устанавливается после пролога функции.
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395577&amp;user=8075&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=4" class="addthx" data-post="395577"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Osoro[/b]','')">Osoro</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 1.07'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=50115">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2019 11:43 &middot; Поправил: Osoro <br><script type="text/javascript">QU('Osoro','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Osoro" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
ОК спасибо, посмотрю отпишусь.<br><br>Никаких окошек не вылазит вроде.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=395578&amp;user=50115&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=5" class="addthx" data-post="395578"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2019 11:44 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Osoro</b><br><br>&gt; Процессор же должен понимать какие инструкции он &quot;должен&quot; выполнить далее? <br><br>Причём тут процессор, это отладчик глючит. Вообще нужно нормальный отладчик использовать, а не дизасм с простейшей функцией отладки.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395579&amp;user=40990&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=6" class="addthx" data-post="395579"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Osoro[/b]','')">Osoro</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 1.07'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=50115">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2019 11:50 <br><script type="text/javascript">QU('Osoro','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Osoro" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
А нормальный это какой; если не секрет)?<br>Я думал IDA
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=395580&amp;user=50115&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=7" class="addthx" data-post="395580"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2019 11:55 &middot; Поправил: plutos <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Osoro пишет:<br>если не секрет)? </I><br><br>да тот же <noindex><a href="https://x64dbg.com/#start" rel="nofollow" target="_blank">--&gt; x64 dbg&lt;--</a></noindex><br><br>An open-source x64/x32 debugger for windows.<br><br>IDA это прежде всего decompiler.
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395581&amp;user=4773&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=8" class="addthx" data-post="395581"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2019 11:55 <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>Osoro пишет:<br>Я думал IDA </I><br>Не, ида нишевое явление, у которого много лет не было стоящих аналогов среди дизасмов-декомпилей. Отладчиков как грязи, самый популярный для х64 это mr. exodia&#039;s debugger.
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395582&amp;user=8075&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=9" class="addthx" data-post="395582"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2019 11:57 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Не нужен 64, они не удобные. Судя по регистрам там режим совместимости(WOW), так что Olly пойдёт.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395583&amp;user=40990&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=10" class="addthx" data-post="395583"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2019 12:03 &middot; Поправил: plutos <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>difexacaw пишет:<br> так что Olly пойдёт </I><br><br>ОllyDbg конечно пойдет, но<br><b>You can now run <noindex><a href="https://github.com/x64dbg/x64dbg" rel="nofollow" target="_blank">--&gt; x32\x32dbg.exe &lt;--</a></noindex>if you want to debug a 32-bit executable</b>
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395584&amp;user=4773&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=11" class="addthx" data-post="395584"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2019 23:54 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>Osoro</b><br><br>Ну как, получилось ?
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395606&amp;user=40990&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=12" class="addthx" data-post="395606"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Osoro[/b]','')">Osoro</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 1.07'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=50115">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2019 17:28 &middot; Поправил: Osoro <br><script type="text/javascript">QU('Osoro','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Osoro" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Форум мне позволяет, к сожалению, только несколько сообщений в день писать.<br><br>Благодаря x64dbg и @f13nd (спасибо) удалось выяснить следующее:<br><br>Нормальный дебаггер преобразерует инструкцию (каким то магическим методом через пару минут после запуска приложения):<br>.text:00423A80 push esi<br>.text:00423A81 stosd<br>.text:00423A82 loopne near ptr unk_423ADD<br><br>В:<br>00423A80 jmp 39C1B30<br><br>В теории срабатывает какойто умный механизм который видит что тут срабатывает какое-то исключение и меняет код. Не совсем понимаю как это работает.<br><br>Вообщем я решил углубится в изучение этого jmp который дебаггер подставляет, там очень странная ситуация происходит. Приложение просто зацикливается на нескольких блоках инструкций, я врубал трассировку и анимацию, но в итоге из цикла выйти не могу. Самое интересное, что когда я просто делаю продолжение работы программы, то она каким то чудом из этого цикла выходит (хотя я не вижу куда там можно вообще брейкпоинт поставить на выход, там кольцо из jmp -&gt; jmp -&gt; jmp.).<br><br>Похоже на какую-то защиту от дебаггеров (возможно). По большому счету я пока в тупике. Пытался исследовать SEH цепочку, но там судя по адресам вообще к этому куску кода никакого отношения нет:<br>http://prntscr.com/o2y5kr<br><br>Прочитал несколько статей о том, каким образом от дебаггеров защищаются, про возню с PEB, флагами и тд. Пытаюсь найти намеки на эти методы в коде. <br><br>Вообщем если есть мысли куда меня направить, то было бы супер.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=395617&amp;user=50115&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=13" class="addthx" data-post="395617"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2019 23:41 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>Osoro</b><br><br>Для начала нужно сказать что ты зря решил использовать x64dbg. Разумно использовать Олли для отладки 86. Почему ты поймёшь сам со временем.<br><br>&gt; Нормальный дебаггер преобразерует инструкцию <br><br>Нет, если память изменяется, то отладчик тут не причём. Хотелось бы увидеть сам цикл полный, может там выходы есть - к примеру вызовы апи или возвраты. Тоесть инструкции передающие управление.<br><br>&gt; каким то чудом из этого цикла выходит<br><br>Выйти из цикла поток может двумя способами(за исключением ветвлений). Эти оба способа касаются манипуляций с контекстом, те управление задачами. Это либо второй поток изменил контекст первого, либо действительно произошло исключение. Может быть есчо вариант что есть ядерный вызов в цикле, но нужно видеть весь цикл что бы не гадать.<br><br>В случае если это исключение, то следует сделать следующее. Никакой сех/вех трогать не нужно. Поток меняет режим при выходе из ядра на фиксированные адреса. За исключением оконных вызовов, это вам пока не нужно(при этом нужен ядерный отладчик). Так вот это фиксированные адреса в системном модуле(ntdll), Kixx. На эти адреса ядро возвращает управление. При исключении это KiUserExceptDisp.., туда ставь точку останова, на стеке будет контекст(задача выгружена). Там в параметрах будет причина исключения. Далее  обработка исключения, та же структурная к примеру, изменяется контекст и управление возвращается в ядро для загрузки задачи(контекста), но это не обязательно.<br><br>Если в цикле нет инструкций передачи управления за пределы цикла, нет ядерных вызовов(или вложенных процедур к ним приводящим), то единственный способ выйти из цикла это исключение. Но почему то мне это кажется сомнительным, те это врядле так. Незачем покидать цикл через ловушки. Цикл это монотонные операции, к примеру заполнение памяти, исключение возникнет при её исчерпании, но это не имеет смысла, так как это тупо переполнение буфера.<br><br>Думаю вы просто пропустили инструкции выхода их цикла и всё проще.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395624&amp;user=40990&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=14" class="addthx" data-post="395624"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Osoro[/b]','')">Osoro</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 1.07'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=50115">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2019 23:58 <br><script type="text/javascript">QU('Osoro','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Osoro" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>difexacaw</b><br><br>Спасибо! Завтра более подробно углублюсь в эту часть, а пока пишу о небольшом шаге вперед:<br><br>УРА!<br><br>Есть небольшой успех, решил поискать больше информации в блоке перехвата функций и нашел кучу вот таких вот участков: <br>http://prntscr.com/o334li<br>http://prntscr.com/o334sz<br>http://prntscr.com/o33505<br><br>Все как и предполагалось похоже, действительно в цепочку загоняются дополнительные обработчики исключений, в связи с этим несколько вопросов:<br><br>1) Я точно знаю что выполняется перехват всего двух функций RECV и SEND из винсок, почему тогда в блоке где инжектятся исключения - их там около 8 - 9 в цепочку добавляется, почему так много?<br>2) Как определяется какое исключение должно обрабатывать какую функцию? Ведь даже на PHP у исключения есть тип и они каскадом идут получается, и первое которое сделало catch выполняется.<br>3) Сперва выполняется функция сохранения адресов send recv и хендлера коннекта в память:<br>http://prntscr.com/o339f3<br>Далее выполняются инжекты, то о чем я выше писал, и далее странная функция:<br>http://prntscr.com/o33a7a<br>Зачем еще раз загружать ту же самую либу, если она уже была загружена ранее? Причем до того как запушится ее имя, в стеке зачем то это выполняется:<br>0042354C | C74424 18 60717500       | mov dword ptr ss:[esp+18],talonexe.757160  | [esp+18]:&quot;PE&quot;, 757160:&quot;connect&quot;<br>00423554 | C74424 1C 54717500       | mov dword ptr ss:[esp+1C],talonexe.757154  | [esp+1C]:&quot;LdrUnregisterDllNotification&quot;, 757154:&quot;closesocket&quot;<br>0042355C | C74424 20 4C717500       | mov dword ptr ss:[esp+20],talonexe.75714C  | [esp+20]:&quot;LdrUnregisterDllNotification&quot;, 75714C:&quot;send&quot;<br>00423564 | C74424 24 44717500       | mov dword ptr ss:[esp+24],talonexe.757144  | 757144:&quot;select&quot;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=395625&amp;user=50115&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=15" class="addthx" data-post="395625"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2019 00:12 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>Osoro</b><br><br>&gt; почему тогда в блоке где инжектятся исключения - их там около 8 - 9 в цепочку добавляется<br><br>Что это значит ?<br>Предполагалось что цикл без вложенных функций, иначе исключения не причём.<br><br>&gt; 2) Как определяется какое исключение должно обрабатывать какую функцию?<br><br>Я выше описал. Механизм прост - возникает исключение, ядро выгружает задачу и причину на поточный стек и возвращает управление на обработчик исключения - Ki*. Если прицеплен отладчик, он до этого подхватит исключение и возможно его обработает, от настроек зависит. По этой причине вы можете запутаться или не верно понять события.<br><br>&gt; Зачем еще раз загружать ту же самую либу, если она уже была загружена ранее?<br><br>Хз причём тут загрузка и что за инжекты. Не понятно ничего.<br><br><b>Добавлено спустя 3 минуты</b><br>Покажите само апп.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395627&amp;user=40990&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=16" class="addthx" data-post="395627"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2019 00:21 &middot; Поправил: VOLKOFF <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>Osoro пишет:<br>Нормальный дебаггер преобразерует инструкцию (каким то магическим методом через пару минут после запуска приложения):<br>.text:00423A80 push esi<br>.text:00423A81 stosd<br>.text:00423A82 loopne near ptr unk_423ADD<br><br>В:<br>00423A80 jmp 39C1B30 </I><br><br>Если делать какие-то выводы (что делать не стоит), то исходя из опкодов, это не &quot;шифты&quot; инструкций и не &quot;прятки&quot;, что методом исключений дает прямую перезапись секции кода приложения (судя по адресам), что легко ловится и анализируется. Если приложенька уже скомпилена с перезаписываемой секцией .text|.code|%anyname%, то смотри непосредственно начиная с записи в участок.<br><br>Но как и говорил, это абстрактное вангование на основе ваших выводов (которые могут быть далеки от истины). Кидайте поциента, будет какой-то предметный разговор. Ну или курите дальше &quot;реверс-философию&quot; мультов Инде, скоро думаю их еще парочка в тему подтянется (если вы не один из них конечно, тогда все норм, продолжаем развеивать скуку) <img src="img/smilies/s6.gif" alt=""><br><br><I>Osoro пишет:<br>Как определяется какое исключение должно обрабатывать какую функцию </I><br>Вам бы почитать матчасть про принцип работы цепочек исключений, вопросы пропадут.<br><br><I>Osoro пишет:<br>Зачем еще раз загружать ту же самую либу </I><br>По скринам угадывать? <img src="img/smilies/s1.gif" alt=""><br>Вариантов много, если это про код для инжекта, то стандартная практика, если нет, может юзаться просто для получения базы, код вообще сильно контекстозависим, особенно при наличии антиотладки...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=395630&amp;user=5846&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=17" class="addthx" data-post="395630"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2019 00:32 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>VOLKOFF</b><br><br>Я один акк тут только использую, какие мульты. Зачем мне второй, думаешь я эти мелкие темы бы смотрел, если бы были норм ?<br><br>Я использовал кучу аккаунтов когда была облава&quot;, те цепь банов. А в норм обстановке мне это не нужно совершенно. Чушь какую то пишешь. Нет тут пока тех. тем или каких то интересных, тогда уделю внимание этой.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395631&amp;user=40990&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=18" class="addthx" data-post="395631"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=5846" title="17-06-2019 21:37, ранг:121.9" target="_blank">VOLKOFF</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Osoro[/b]','')">Osoro</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 1.07'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=50115">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2019 12:04 &middot; Поправил: Osoro <br><script type="text/javascript">QU('Osoro','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Osoro" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Вообщем ввел я всех в заблуждение. Оказалось все гораздо проще (это по поводу перехвата wsasend/recv).<br>Никакого перехвата нету, пакет шифруется ДО того как попасть в стандартный send. <br><br>Вообщем то оказалось следующее:<br>В статическом виде через IDA можно видеть такие инструкции:<br>.text:00423A80                 push    esi<br>.text:00423A81                 mov     esi, ecx<br>.text:00423A83                 cmp     byte ptr [esi+78h], 0<br>.text:00423A87                 jnz     short loc_423ACF<br><br>После того как приложение запускается, инструкции меняются на такие:<br>.text:00423A80 jmp     near ptr unk_3971B30<br>.text:00423A80 ; ---------------------------------------------------------------------------<br>.text:00423A85 db  78h ; x<br>.text:00423A86 db    0<br>.text:00423A87 ; ---------------------------------------------------------------------------<br>.text:00423A87 jnz     short loc_423ACF<br><br>Вообщем туда просто по этому адресу ставится джамп. Поэтому я сначала видел одно, потом другое и думал что это Exception или что-то еще. Оказалось все проще.<br><br>С этим разобрались. <br><br>Если перейти по этому джампу, то как раз я и попадаю в тот бесконечный цикл где jmp-&gt;jmp-&gt;jmp.<br>Сейчас я загружу картинку, там есть инструкция: js 3237274<br>В конце нее есть джамп: jmp dword ptr ds:[edi+eax*4], он перепрыгивает в 03235CB9, те опять в круг.<br><br>Вот собственно остался вопрос: каким образом из этого круга выходит, если сделать просто Resume дебага.<br><br>Цикл идет от адреса 323600D<br><br><img src="img/attach.gif" alt=""> <a href="./files/ea56_19.06.2019_EXELAB.rU.tgz">ea56_19.06.2019_EXELAB.rU.tgz</a> - graph.png
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=395665&amp;user=50115&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=19" class="addthx" data-post="395665"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2019 17:10 <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
маркер входи в вм, и вангую фимы.<br>зы. да и тема кандидат на закрытие, тут по скринами не гадают
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=395677&amp;user=18316&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=20" class="addthx" data-post="395677"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Osoro[/b]','')">Osoro</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 1.07'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=50115">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2019 17:18 <br><script type="text/javascript">QU('Osoro','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Osoro" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>SReg</b><br>Это клиент игрушки, вот ссылка: http://bit.do/eVtma<br><br>&gt;маркер входи в вм, и вангую фимы.<br>Это не понял.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=395678&amp;user=50115&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=21" class="addthx" data-post="395678"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2019 17:35 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>Osoro пишет:<br>вот ссылка: http://bit.do/eVtma </I><br><br>В чем сокральный смысл сокращения URL https://downloads.talonro.com/TalonRO_Full.exe ?<br>Пришлось getlinkinfo заюзать, ибо блокировщик заблочил линк...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=395680&amp;user=5846&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=22" class="addthx" data-post="395680"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Osoro[/b]','')">Osoro</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 1.07'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=50115">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2019 18:05 &middot; Поправил: Osoro <br><script type="text/javascript">QU('Osoro','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Osoro" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<b>VOLKOFF</b><br>Чтобы поисковик не проиндексировал пост и не обнаружил нас бандитов, которые в их клиенте шурудят.<br><br>Я вроде видел кнопку, чтобы сделать тему приватной, но я ее не нажал при создании вроде.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=395682&amp;user=50115&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=23" class="addthx" data-post="395682"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2019 18:14 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>Osoro</b><br><br><noindex><a href="https://xakep.ru/static/re-malware/2_antidebug_tricks.pdf" rel="nofollow" target="_blank">--&gt; Очередь предварительной выборки &lt;--</a></noindex><br><br>В разделе Железная антиотладка поясняется, почему вы не вышли с цикла руками, а без трейса всё чудесно.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395684&amp;user=6336&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=24" class="addthx" data-post="395684"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=50115" title="19-06-2019 21:50, ранг:1.2" target="_blank">Osoro</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2019 22:42 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>VOLKOFF</b><br><br>Ты разер видел, 2Гб. Это что же столько весит ?<br><br><b>Osoro</b><br><br>Ты не слушаешь что говорят, а просто тупишь. Так у тебя ничего не получится.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395690&amp;user=40990&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=25" class="addthx" data-post="395690"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Osoro[/b]','')">Osoro</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 1.07'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=50115">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2019 00:47 <br><script type="text/javascript">QU('Osoro','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Osoro" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<b>ARCHANGEL</b><br><br>Очень интересная статья, спасибо.<br><br>Единственное что меня смущает, если в статье рассматривают STOS и MOVS, которые фактически модифицируют инструкции, при этом из-за того что используется кеш при нормальном выполнении - команда выполняется без внезапного возврата, то в моем случае я могу предположить что lodsb берет также из памяти значения которые НЕ закешированы в дебаг режиме, изза этого рассчитывает &quot;неправильно&quot; (для меня) в блоке джампа  jmp dword ptr ds:[edi+eax*4] адрес и поэтому попадает опять сама на себя. Единственное что можно подозревать, другого ничего не вижу.<br><br>Тогда если в случае с примером и STOS я знаю в EDI адрес куда она пишет, и могу фактически реальную функцию найти, которая должна была бы вызваться, то в случае с lodsb каким образом можно получить значение в памяти, которое динамически там появляется, при этом не используя дебаггер.<br><br>Или я неправильно понял?<br><br><b>difexacaw</b><br>Форум для новичков же? Профи вопросы в основном форуме пишут.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=395693&amp;user=50115&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=26" class="addthx" data-post="395693"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2019 02:16 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>Osoro</b><br><br>&gt; Форум для новичков же?<br><br>Нет, для халявщиков в первую очередь.<br><br>&gt; В конце нее есть джамп: jmp dword ptr ds:[edi+eax*4], он перепрыгивает в 03235CB9, те опять в круг.<br><br>Круг да, бесконечный. Потому что это виртуальная машина.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395694&amp;user=40990&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=27" class="addthx" data-post="395694"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2019 14:18 <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
Во-первых у иды вообще проблемы с синхронизацией во время отладки. Во-вторых софтварный бряк это замена первого байта инструкции на 0xC3 (int3), этим свойством часто пользуются рассчитав например кс выбранного участка и используя ее для чего-нибудь. Приведенный фрагмент просто гоняет значения регистров меж собой и через стек. Возможно на входе при нормальном исполнении должны быть не эти значения, а может быть ты свернул в эту ветку из-за того, что до этого был обнаружен отладчик. А может быть и так, что другой поток должен остановить этот тред и накрутить в нем контекст. Скорей всего (случайно показалось) ты ищешь где клиент игры шифрует обмен, наверное от этого и надо плясать (от внешних или внутренних криптографических функций). Потому что либо надо детально разбираться как работает протектор, либо не лезть туда (особенно отладчиком, в котором не применяется никаких техник сокрытия), искать другие способы.
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395716&amp;user=8075&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=28" class="addthx" data-post="395716"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2019 14:51 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
0xC3 это RETN, INT3 это 0xCC.<br>Но вряд-ли это поможет автору темы...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=395717&amp;user=6859&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=29" class="addthx" data-post="395717"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=8075" title="20-06-2019 13:00, ранг:191.8" target="_blank">f13nd</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июня 2019 14:57 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=25873.html&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<b>ARCHANGEL</b><br><br>Я проверил интереса ради:<br><br><noindex><a href="https://imgbb.com/" rel="nofollow" target="_blank"> <img src="https://i.ibb.co/6PdVhy1/rep.png" border="0" align="" alt=""></a></noindex><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">4</span><span class="hl_char">.</span>&nbsp;Выполнение&nbsp;инструкции«REP&nbsp;STOS»&nbsp;до&nbsp;пол<span class="hl_char">-</span>ной&nbsp;отработки&nbsp;цикла<span class="hl_char">(</span>обнулениеECX<span class="hl_char">)</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br><br>Очевидно что перезапись строковой инструкции зависит от проца. Так на i5 что на варе, что напрямую одинаково. Заполняется 64 байта, а не вся строка. Не зависимо от выравнивания.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">4</span><span class="hl_char">.</span>&nbsp;Выполнение&nbsp;инструкции«REP&nbsp;STOS»&nbsp;до</li><li class="hl_l1">момента&nbsp;перезаписи&nbsp;кода—&nbsp;очередь&nbsp;предвари<span class="hl_char">-</span>тельной&nbsp;выборки&nbsp;будет&nbsp;очищена<span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br><br>Если через F8 в отладчике(step over) выполнить, то так же разницы никакой - Олли ставит точку останова за инструкцией (_Tempbreakpoint()). Наверно подразумевается пошаговая трассировка(TF).<br><br><img src="img/attach.gif" alt=""> <a href="./files/44f7_22.06.2019_EXELAB.rU.tgz">44f7_22.06.2019_EXELAB.rU.tgz</a> - rep.png
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=395796&amp;user=40990&amp;forum_n=5&amp;topic=25873.html&amp;page=0&amp;anchor=30" class="addthx" data-post="395796"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Неизвестный переход</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="25873">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=25873" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
