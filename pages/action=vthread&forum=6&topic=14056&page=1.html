<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>ring0 трассировщик и методы реализации - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Вопрос состогит в следующем: нужно выполнить отладку кода, которыйвыполняется в третьем кольце. Но делать это не стандартными Debug API-функциями, а реализовать драйвер, чтоб задействовать всякие левые, например,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=55802'>JustLife</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> ring0 трассировщик и методы реализации</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=14056&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=14056&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2009 15:07 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Вопрос состогит в следующем: нужно выполнить отладку кода, которыйвыполняется в третьем кольце. Но делать это не стандартными Debug API-функциями, а реализовать драйвер, чтоб задействовать всякие левые, например, зарезервированные, прерывания или редкоиспользуемые, например, всякие int 2Dh и другие (это упоминается как пример - не обязательно его). Так вот, чисто в теории, чтоб отлаживать приложение с помощью таких прерываний, нужно расположить в коде жертвы опкоды этих самых прерываний, далее изменить DPL этого прерывания на троечку, чтоб не генерировался эксепшн, далее выполнить перехват этого прерывания на свой обработчик в дровине, и, когда происходит это прерывание, выполнять нужные действия: дамп, правку жертвы в памяти, или же просто лог вести. Но вот в чём проблема - можно ли это делать с зарезервированными прерываниями? Если можно, то после перехвата и обработки данных моим фильтром куда передавать управление? И если мой олбработчик срабатывает, то в контексте какого процесса: процесса-жертвы или System?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=226195&amp;user=6336&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=1" class="addthx" data-post="226195"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2009 10:50 &middot; Поправил: Demon666 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
<I>Archer пишет:<br>Ну и стоить иметь в виду многоядерные/многопроцессорные тачки, тут код поменяется мало. И про х64-а тут вообще работать не будет. Просто лично я не вижу особого смысла писать софт под медленно, но верно подыхающую платформу. </I><br>Зачетная мессага +500<br>ЗЫ: сейчас натив на прямую(через &quot;int..&quot;) юзать(не зная для [..] кодов) вместо win32 – это вообще жесть, натив был актуален для злавредов в прошлом веке, а сейчас это вообще просто учебное пособие %))
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=226924&amp;user=4551&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=2" class="addthx" data-post="226924"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2009 11:16 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<b>Demon666</b><br>&gt; сейчас натив на прямую(через &quot;int..&quot;) юзать(не зная для [..] кодов) вместо win32 – это вообще жесть, натив был актуален для злавредов в прошлом веке, а сейчас это вообще просто учебное пособие %))<br>Жесть его не юзать, а зловреды винапи юзали в прошлом веке и те что щас его юзают гуано <img src="img/smilies/s16.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=226927&amp;user=17964&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=3" class="addthx" data-post="226927"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2009 12:41 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
<b>Clerk</b><br>Гы-гы, ты обиделся чтоле? Я ж подколол просто ;)<br>Я вот просто не пойму(думаю что и многие тоже - ИМХО) че ты с этим нативом возишься<br>Оно то бесспорно интересно, но нелогично пипец как.. <br>у тебя все как-то кусками сделано(теряеццо среди мяса), сделай чтоле библу типа как ntpatch – было же гуд(всем нравилось), че бросил идею непонятно..
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=226931&amp;user=4551&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=4" class="addthx" data-post="226931"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2009 13:17 &middot; Поправил: Clerk <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<b>Demon666</b><br>Чёго мне обижаццо то ?<br>Одного не пойму, зачем ты этот комент впёр, точно подкалоть наверно..<br>И про нэйтив вроде тут ничего не скозал. А насчёт нэйтив - это родной для системы интерфейс, тут недавно про псапи топик был, предложили грузить <b>psapi.dll</b> Но передать управление <b>LoadLibrary()</b> это значит передать управление вникуда. И только чтоб какойто сервис заюзоть, который напрямую вызвать можно. Винапи это высокоуровневая оболочка, крайне нестабильная разбухшая и не удобная.<br>&gt; у тебя все как-то кусками сделано(теряеццо среди мяса)<br>Ты это про что ?<br>Я уже не пишу ничего, что требует какието сторонние модуля, самодостаточный пикод, даже там где это не нужно. Выработался стиль, очень гибкий и удобный. К импортам какоето отвращение..<br>Но это не с пустого места возникло, выполняя различные хитрые манипуляции с системой, чтобы чтото обойти, направить обработку данных по пути отличному от нормального и пр. неизбежно подобный стиль будет выработан, иначе многие задачи не решить, либо они решаются черезжопными способами.<br>Как пример кряки мэмберов этого форума - какаято элементарно обходимая защита, антитрейс взятый из какогото мана, писанного человеком, который и сути антиотладки не понял, ибо не знает поведение системы глубже чем необходимо. А данный топик - мышление автора, тоесть его подход к задаче в корне не верный.<br>И вообще причём тут я не понятно, вроде дебаггер обсуждали.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=226934&amp;user=17964&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=5" class="addthx" data-post="226934"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2009 15:25 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
<b>Clerk пишет:</b><br><i class=x>мышление автора, тоесть его подход к задаче в корне не верный</i><br>Так, давайте сначала. Как трассировать с помощью int 3? Очень просто, дизасмим жертву, лепим опкод, он срабатывает, восстанавливаем старый опкод, дизасмим дальше, лепим опкод на следующую команду, продолжаем выполнение и т.д. Медленно, непроизводительно, но это НЕ ОСНОВНАЯ ЗАДАЧА<img src="img/smilies/s1.gif" alt=""> Контрольная сумма, да, это неприятно, поэтому будем ничего с ней не делать. Да, именно ничего, т.к. цель, которую мы будем этим способом трассировать, контрольные суммыне сверяет. Зачем тогда лезть в ядро? Это будет что-то типа учебного проекта<img src="img/smilies/s1.gif" alt=""> И в чём проблемма, если код на PASSIVE_LEVEL выполняется, вот если б DISPATCH, тогда нельзя файловые операции, например, юзать, а так чего нельзя?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=226951&amp;user=6336&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=6" class="addthx" data-post="226951"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2009 15:37 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>&gt; И в чём проблемма, если код на PASSIVE_LEVEL<br>Так я же говорю что нет проблемы.<br>&gt; Как трассировать с помощью int 3?<br>Ответ - никак. Ты можешь сделоть жалкое подобие виртуальной машины, но в реальной системе этим врятле что сможешь продебажить. Во первых потому что не удастся найти адрес следующей инструкции.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=226953&amp;user=17964&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=7" class="addthx" data-post="226953"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2009 15:40 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<b>Clerk</b><br>Скажем, не не удастся, а будет работать нестабильно, т.е. не будет работать с антидизассемблерными конструкциями. Да, это грустно, зато детектить наномиты эта красота будет на ура<img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=226954&amp;user=6336&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=8" class="addthx" data-post="226954"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2009 16:08 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Ну не обязательно, если код будет находится в разделяемой памяти, как ты такое будешь дебажить ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=226959&amp;user=17964&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=9" class="addthx" data-post="226959"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2009 19:00 &middot; Поправил: Demon666 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
<I>Clerk пишет:<br>Я уже не пишу ничего </I><br>Не заметил, как ты выкладывал кодес на паблик, так и продолжаешь его выкладывать..<br><I>Clerk пишет:<br>что требует какието сторонние модуля, самодостаточный пикод, даже там где это не нужно </I><br>я писал не про сторонние модули, а про ntpatch где все функции у тебя были в одной библе – было похоже что-то на psapi, imagehlp, etc.. только от тебя<br>кстати насчет того топика, <br><I>Clerk пишет:<br>топик был, предложили грузить psapi.dll </I><br>если ты про этот<br><a href="http://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14093" target="_new">http://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14093</a><br>есть же в паблике исходники от этой библы psapi<br>вот копипаст из нее<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"></li><li class="hl_l1">BOOL</li><li class="hl_l0">WINAPI</li><li class="hl_l1">GetProcessMemoryInfo&nbsp;<span class="hl_char">(</span></li><li class="hl_l0">&nbsp;&nbsp;HANDLE&nbsp;hProcess<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;PPROCESS_MEMORY_COUNTERS&nbsp;ppsmemCounters<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;cb</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">)</span></li><li class="hl_l0"></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_char">+</span><span class="hl_char">+</span></li><li class="hl_l0"></li><li class="hl_l1">Routine&nbsp;Description<span class="hl_char">:</span></li><li class="hl_l0"></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>This</b></span>&nbsp;function&nbsp;returns&nbsp;all&nbsp;the&nbsp;PSVM_COUNTERS&nbsp;for&nbsp;a&nbsp;process<span class="hl_char">.</span></li><li class="hl_l0"></li><li class="hl_l1">Arguments<span class="hl_char">:</span></li><li class="hl_l0"></li><li class="hl_l1">&nbsp;&nbsp;hProcess&nbsp;<span class="hl_char">-</span>&nbsp;Handle&nbsp;for&nbsp;the&nbsp;process&nbsp;being&nbsp;queried<span class="hl_char">.</span></li><li class="hl_l0"></li><li class="hl_l1">&nbsp;&nbsp;ppsmemCounters&nbsp;<span class="hl_char">-</span>&nbsp;Points&nbsp;to&nbsp;buffer&nbsp;that&nbsp;will&nbsp;receive&nbsp;the&nbsp;PROCESS_MEMORY_COUNTERS<span class="hl_char">.</span></li><li class="hl_l0"></li><li class="hl_l1">&nbsp;&nbsp;cb&nbsp;<span class="hl_char">-</span>&nbsp;size&nbsp;of&nbsp;ppsmemCounters</li><li class="hl_l0"></li><li class="hl_l1">Return&nbsp;Value<span class="hl_char">:</span></li><li class="hl_l0"></li><li class="hl_l1">&nbsp;&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;<span class="hl_function"><b>TRUE</b></span>&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;<span class="hl_function">FALSE</span><span class="hl_char">.</span></li><li class="hl_l0"></li><li class="hl_l1"><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">*</span><span class="hl_char">/</span></li><li class="hl_l0"></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;NTSTATUS&nbsp;Status<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;VM_COUNTERS&nbsp;VmCounters<span class="hl_comment">;</span></li><li class="hl_l0"></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>Try</b></span>&nbsp;to&nbsp;feel&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;the&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;passed&nbsp;is&nbsp;<span class="hl_function"><b>NULL</b></span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_function">not</span><span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;is&nbsp;it&nbsp;long&nbsp;enough&nbsp;for&nbsp;us<span class="hl_char">.</span></li><li class="hl_l1"></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>try</b></span>&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ppsmemCounters<span class="hl_char">-</span><span class="hl_char">&gt;</span>PeakPagefileUsage&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>except</b></span>&nbsp;<span class="hl_char">(</span>EXCEPTION_EXECUTE_HANDLER<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetLastError<span class="hl_char">(</span>&nbsp;RtlNtStatusToDosError<span class="hl_char">(</span>&nbsp;GetExceptionCode<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<span class="hl_char">(</span><span class="hl_function">FALSE</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1"></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>cb&nbsp;<span class="hl_char">&lt;</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>PROCESS_MEMORY_COUNTERS<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;SetLastError<span class="hl_char">(</span>&nbsp;ERROR_INSUFFICIENT_BUFFER&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;return<span class="hl_char">(</span><span class="hl_function">FALSE</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0"></li><li class="hl_l1">&nbsp;&nbsp;Status&nbsp;<span class="hl_char">=</span>&nbsp;NtQueryInformationProcess<span class="hl_char">(</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hProcess<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcessVmCounters<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">&amp;</span>VmCounters<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>VM_COUNTERS<span class="hl_char">)</span><span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NULL</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span>NT_SUCCESS<span class="hl_char">(</span>Status<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;SetLastError<span class="hl_char">(</span>&nbsp;RtlNtStatusToDosError<span class="hl_char">(</span>&nbsp;Status&nbsp;<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;return<span class="hl_char">(</span>&nbsp;<span class="hl_function"><b>FALSE</b></span>&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;}</li><li class="hl_l0"></li><li class="hl_l1">&nbsp;&nbsp;ppsmemCounters<span class="hl_char">-</span><span class="hl_char">&gt;</span><span style="word-break: break-all">cb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>PROCESS_MEMORY_COUNTERS<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ppsmemCounters<span class="hl_char">-</span><span class="hl_char">&gt;</span>PageFaultCount&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;VmCounters<span class="hl_char">.</span>PageFaultCount<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ppsmemCounters<span class="hl_char">-</span><span class="hl_char">&gt;</span>PeakWorkingSetSize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;VmCounters<span class="hl_char">.</span>PeakWorkingSetSize<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ppsmemCounters<span class="hl_char">-</span><span class="hl_char">&gt;</span>WorkingSetSize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;VmCounters<span class="hl_char">.</span>WorkingSetSize<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ppsmemCounters<span class="hl_char">-</span><span class="hl_char">&gt;</span>QuotaPeakPagedPoolUsage&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;VmCounters<span class="hl_char">.</span>QuotaPeakPagedPoolUsage<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ppsmemCounters<span class="hl_char">-</span><span class="hl_char">&gt;</span>QuotaPagedPoolUsage&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;VmCounters<span class="hl_char">.</span>QuotaPagedPoolUsage<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ppsmemCounters<span class="hl_char">-</span><span class="hl_char">&gt;</span>QuotaPeakNonPagedPoolUsage<span class="hl_char">=</span>&nbsp;VmCounters<span class="hl_char">.</span>QuotaPeakNonPagedPoolUsage<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ppsmemCounters<span class="hl_char">-</span><span class="hl_char">&gt;</span>QuotaNonPagedPoolUsage&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;VmCounters<span class="hl_char">.</span>QuotaNonPagedPoolUsage<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ppsmemCounters<span class="hl_char">-</span><span class="hl_char">&gt;</span>PagefileUsage&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;VmCounters<span class="hl_char">.</span>PagefileUsage<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ppsmemCounters<span class="hl_char">-</span><span class="hl_char">&gt;</span>PeakPagefileUsage&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;VmCounters<span class="hl_char">.</span>PeakPagefileUsage<span class="hl_comment">;</span></li><li class="hl_l1"></li><li class="hl_l0">&nbsp;&nbsp;return<span class="hl_char">(</span><span class="hl_function">TRUE</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div>
<br>Можно просто тупо пойти на <a href="http://www.google.com/codesearch" target="_new">http://www.google.com/codesearch</a><br>Там вбить в строку GetProcessMemoryInfo и из появившегося там вверху выбрать из <br><b>Попробуйте также:</b>  GetProcessMemoryInfo lang:<b>pascal</b>  <br>И там уже пошарить по этим исходникам.. если не совсем деревянный, то нагуглить можно значительно больше, сталобыть и кодить ничего не надо, просто тупо гуано-копипаст %)))<br><br><I>Clerk пишет:<br>Винапи это высокоуровневая оболочка, крайне нестабильная разбухшая и не удобная.</I><br>&quot;ахтунги из Microsoft к примеру считают&quot; ;) что винапи – это в первую очередь оболочка над совместимостью версий винды, если вызвал VirtualProtect, то это значит что он везде будет VirtualProtect, и не надо думать в какой ОС и под каким номером тот или иной &quot;syscall&quot;..<br>VirtualProtect-&gt;VirtualProtectEx-&gt;NtProtectVirtualMemory-&gt;&quot;XPSPn 89h&quot;, etc..<br><br><br><I>Clerk пишет:<br>Ты это про что ?  </I><br>Сделай сборничег всех своих исходников что <b>на паблик постил</b> и залей куда-нибудь на постоянку - будет гуд, нежадничай ;)<br><br><I>Clerk пишет:<br>вроде дебаггер обсуждали </I><br>это не дебагер, дебагер так не обсуждают ;)<br>где-то на васме хз. когда-то(что-то похожее) Дилеринк создавал топег, че-то там со стариком возня какая-то была и если память не изменяет он там даже кодес какой-то выкладывал – тоже че-то с рингом0 воевал..<br>сейчас точно уже и не помню.. короче захочет-поможет %;))<br>хотя тут теория чтоле, если так можно это назвать, а нужно практическое что-то показывать/обсуждать - ИМХО<br><br>ЗЫ: выделяешь текст, который хочешь процитировать в посте, и в этом же посте жмешь на кнопку &quot;цитата&quot; что находится возле даты..  (джаваскрипт должен быть включен..)<br>Создано: 28 марта 2009 15:40:33 <br><b>Цитата</b> Личное сообщение #8<br>;))
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=226974&amp;user=4551&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=10" class="addthx" data-post="226974"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2009 20:31 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
<img src="img/smilies/s1.gif" alt=""> а у когонить не завалялось случаем The Kernel PatchFinder  исходники + статья в пдфе и презинтация , последняя версия 2.11 была на руткит ком доступна. Но ее уже там тоже нет. Все пропало или зачищено ...
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=226980&amp;user=3520&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=11" class="addthx" data-post="226980"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 марта 2009 06:13 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
<b>Demon666</b><br>Я не про то вобщем. У меня тоже сурцы есть, на крайний случай можно в реактосе глянуть.<br><br>Касательно трассировщика я тоже начал его писать(на VT кстати проект), пару месяцев назад, кстати не первый раз уже. Но нормальный, посредстом TF. Оказалось столько подводных камней и нюансов, что я ушёл в размышления.., прекратив кодить его. Думаю продолжу через пару недель. Чтобы исполнить полноценную трассировку нужно полядра пропатчить, чтоб работало как нужно и кучу чего перехватить, причём не экспортируется. <br>Использовать жесткий останов перед исполнением каждой инструкции не имеет смысла, нужно использовать #DB исключение, тут два варианта - аппаратный останов, либо пошаговый. Первый вариант не получится использовать если код сам использует аппаратные точки останова. Нужно EFlags.TF заюзать.<br>Короче больше у меня по теме впечатлений нет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=227015&amp;user=17964&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=12" class="addthx" data-post="227015"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 марта 2009 11:09 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<I>Clerk пишет:<br>Оказалось столько подводных камней и нюансов, что я ушёл в размышления.. </I><br>Тоже когда-то было такое, но я почти сразу отказался от такого метода, вот сейчас получается становлюсь наблюдателем со стороны, ну или как-то так..<br>Трейсер имеет узкую направленность применения(там где действительно нужен), но значительно сокращает время реверса(я бы сказал в бОльшие разы) ну и показывает то, что обычный юзверь будет реверсить очень долго и нудно..(ну и плюсадинЪ, контроль конечно же) <br>Но тут самое важное надо заранее знать на чем его сразу тестить, чтобы потом код не переписывать или даже полностью всю технику не менять – ИМХО<br>Как делал писать не буду, потому что  хочется увидеть вот что у тебя в итоге получится<br>Я потратил чистого времени на написание кода где-то около месяца в течении года..
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=227021&amp;user=4551&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=13" class="addthx" data-post="227021"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2009 14:37 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
Вот созрел такой банальный вопрос. Я собрал драйвер, который на моей системе прекрасно работает и всё чудесно, но он для своей работы использует несколько функций из ntoskrnl.exe, адреса которых при загрузке драйвера записываются в его таблицу импорта. Но при переносе драйвера в другую ОС может оказаться так, что ntoskrnl.exe<br>будет иметь другое имя, например, из-за включенной РАЕ, а в таблице импорта моего драйвера имя жестко пропитано. Может ли это вызывать какие-то проблемы? Если да, то какие?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=228606&amp;user=6336&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=14" class="addthx" data-post="228606"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Psalmopoeus Pulcher[/b]','')">Psalmopoeus Pulcher</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.8 (посетитель), 23thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18297">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2009 15:02 <br><script type="text/javascript">QU('Psalmopoeus Pulcher','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Psalmopoeus Pulcher" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
С импортом проблем точно не будет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=228609&amp;user=18297&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=15" class="addthx" data-post="228609"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2009 17:21 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
Продолжая тему ядерного перехвата, созрел такой вопрос. Есть нехорошее по, которое посредством API перезагружает комп, либо делает завершение сеанса. Это - очень нехорошо, и хочется с помощью драйвера перехватит в ядре какой-нибудь сервис, и некоторым программкам разрешать эти действия, а некоторому грязнопузому<img src="img/smilies/s1.gif" alt=""> софту показать хер. Но вот в чем вопрос - какой именно сервис нужно перехватывать?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=228617&amp;user=6336&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=16" class="addthx" data-post="228617"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Psalmopoeus Pulcher[/b]','')">Psalmopoeus Pulcher</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.8 (посетитель), 23thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18297">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2009 18:12 <br><script type="text/javascript">QU('Psalmopoeus Pulcher','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Psalmopoeus Pulcher" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
NtShutdownSystem?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=228621&amp;user=18297&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=17" class="addthx" data-post="228621"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2009 18:14 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
Погляди хуки HideToolz через любой антируткит, он не даёт ребутать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=228622&amp;user=1556&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=18" class="addthx" data-post="228622"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2009 18:21 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
С перезагрузкой - ещё полбеды, а вот как противостоять завершению сеанса?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=228624&amp;user=6336&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=19" class="addthx" data-post="228624"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2009 18:21 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
Del
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=228625&amp;user=6336&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=20" class="addthx" data-post="228625"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2009 20:09 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
Тоесть можно ждать релизенг ?<br>Дайте потестить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=228633&amp;user=17964&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=21" class="addthx" data-post="228633"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2009 21:57 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
Я бы дал, но пока нечего, как только что-то стоящее у меня получится, то выложу, конечно, мне не жалко. Какой смысл это скрывать, всё равно ж ничего нового тут не изобреталось, так что че прятать-то? Но последние 2 вопроса касаются другого драйвера, я тут спросил, чтоб темы не плодить, тем более, что и для темы топика эти вопросы важны
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=228638&amp;user=6336&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=22" class="addthx" data-post="228638"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]AlexZ[/b]','')">AlexZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 203.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.22<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=175">Участник</a><br><font color=blue>UPX Killer -d</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 апреля 2009 00:41 <br><script type="text/javascript">QU('AlexZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexZ" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>С перезагрузкой - ещё полбеды, а вот как противостоять завершению сеанса?  </I><br><br>Запретить запускать logoff.exe (или logout или как-там-его) <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Я медленно снимаю с неё UPX... *FF_User*</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=228640&amp;user=175&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=23" class="addthx" data-post="228640"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]n00b4s[/b]','')">n00b4s</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=20760">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 апреля 2009 21:48 &middot; Поправил: n00b4s <br><script type="text/javascript">QU('n00b4s','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=n00b4s" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#24');return false;">#24</a> </span><div align=left><br>
<I>Clerk пишет:<br>Регистрация себя как отладчика, но лучше это не делай</I><br>А можно вопрос - что для этого нужно сделать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229072&amp;user=20760&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=24" class="addthx" data-post="229072"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 апреля 2009 23:45 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#25');return false;">#25</a> </span><div align=left><br>
<b>KeEnterKernelDebugger()</b>, <b>KdEnableDebugger()</b>, <b>KdInitSystem()</b> etc, копать в этом направлении, в реактос сурцы есть. Там траблы будут с портами я не лез в эти дебри. Это полностью изменит поведение системы. Например при переключении между кольцами защиты будут сохраняться отладочные регистры(-&gt; <b>KPCR.DebugActive</b>) и пр. Некоторые моменты оттуда я использовал вручную, полностью запускать это нет смысла. Это использует виндбг для удалённой отлаки.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229086&amp;user=17964&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=25" class="addthx" data-post="229086"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]n00b4s[/b]','')">n00b4s</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=20760">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 апреля 2009 00:13 <br><script type="text/javascript">QU('n00b4s','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=n00b4s" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#26');return false;">#26</a> </span><div align=left><br>
А чтобы это использовать нужно запуститься в /DEBUG предварительно?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229094&amp;user=20760&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=26" class="addthx" data-post="229094"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]n00b4s[/b]','')">n00b4s</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=20760">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 апреля 2009 00:16 <br><script type="text/javascript">QU('n00b4s','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=n00b4s" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#27');return false;">#27</a> </span><div align=left><br>
Не знаю кстати, может ты копал подробнее, но KPCR.DebugActive на скока я помню когда копался в дизасме ядра, это что-то вроде маски. это не BOOL, который говорит что KD is presented. Например когда работаешь с windbg as far as i remember DRы совсем необязательно сохраняются. Они начинают соxраняться например когда ты в обработчике исключения изменяешь DR регистры. В DebugActive устанавливается какое-то значение и он начинает сохраняться при составлении ktrap_frame. Давно копал может ошибаюсь в чем-то
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229096&amp;user=20760&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=27" class="addthx" data-post="229096"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 апреля 2009 01:06 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=14056&amp;page=1#28');return false;">#28</a> </span><div align=left><br>
wrk\base\ntos\ke\i386\trap.asm и kimacro.inc там всё есть.<br>В моём понимании отладчик это не инструмент в данном случае, а совокупность механизмов, переключение в контексте отладочных регистров один из таких механизмом.<br><br>По теме - вчера выложили док files.virustech.org/indy/Teory/SwapContext/vt_swapctx_model.pdf<br>Не представляю как это трассировщик может обойти..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=229103&amp;user=17964&amp;forum_n=6&amp;topic=14056&amp;page=1&amp;anchor=28" class="addthx" data-post="229103"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=14056&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=14056&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> ring0 трассировщик и методы реализации</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#29" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="14056">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=14056" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
