<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Расшировка CMS файла - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброго времени суток. Имеется такая проблема. Есть файлы формата .pdf и их же пошифрованный с помощью КриптоПро вариант (с форматом .pdf.sig). Гугл сказать, что пошифрованы CMS обычным base64, без какого-либо ключа.  Сначала я">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=55997'>bezumchik</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Расшировка CMS файла</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Slinger[/b]','')">Slinger</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 14.1 (новичок), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.25'>Активность: 0.03<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=20667">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2019 21:24 <br><script type="text/javascript">QU('Slinger','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Slinger" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26087.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброго времени суток. Имеется такая проблема.<br><br>Есть файлы формата .pdf и их же пошифрованный с помощью КриптоПро вариант (с форматом .pdf.sig). Гугл сказать, что пошифрованы CMS обычным base64, без какого-либо ключа. <br><br>Сначала я удалил из CMS файла заголовки -----BEGIN CMS----- и -----END CMS-----, затем на примитивном питоновском скрипте из двух строк сделал расшифровщик, который с этой задачей справился и я получил файл .pdf. Однако, там была помимо блока данных ещё и лишняя соль (то есть до начала заголовка &quot;%PDF&quot; и после &quot;%%EOF&quot;), которую пришлось отдельно удалять. Однако файл не открылся. При сравнении полученного и исходного файла выяснилось, что в полученном файле отдельно записались в определенных местах дополнительные ненужные байты, ломающие всю структуру. <br><br>https://dropmefiles.com/0EyJF<br><br>В архиве три файла. shema.pdf - рабочий исходник, затем пошифрованный файл, и файл shema_copy.pdf - полученный обработанный вариант.<br><br>Вопрос. Имел ли кто-то успешный опыт расшифровки подобных файлов и как с этим справиться, чтобы получить рабочий оригинал ? Дело в том, что не у всех файлов есть исходники. И кроме того, не все файлы формата .pdf (то есть найти заголовки и окончания файла тоже практически не представляется возможным), а другого формата.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398270&amp;user=20667&amp;forum_n=5&amp;topic=26087.html&amp;page=0&amp;anchor=1" class="addthx" data-post="398270"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Adler[/b]','')">Adler</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/41144.png" alt=""><br><span class=txtSm>Ранг: 55.9 (постоянный), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.93'>Активность: 0.12<span style='color:green'>&nearr;</span>0.22</span><br>Статус: <a href="action=userinfo&amp;user=41144">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2019 23:04 &middot; Поправил: Adler <br><script type="text/javascript">QU('Adler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Adler" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26087.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>Slinger</b>, ну так там все очевидно. <br>Они не &quot;пошифрованы&quot;, а подписаны, да и base64, это кодирование, а не шифрование. <br>Если убрать мусор до и после заголовка (перед %PDF и после %EOF), то в полученном на каждой 10000h позиции вставлены 5 байт (04 83 01 00 00), а начиная с 150000h - 4 байта (04 82 C0 AB). <br>В другом файле может будет иначе, но закономерность прослеживается легко.<br>Где-то я уже такое встречал, но что-то никак не могу вспомнить...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398271&amp;user=41144&amp;forum_n=5&amp;topic=26087.html&amp;page=0&amp;anchor=2" class="addthx" data-post="398271"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=20667" title="16-09-2019 07:32, ранг:14.1" target="_blank">Slinger</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 сентября 2019 01:33 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26087.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>Вариант 1</b><br><br>Если инструмент не важен, то можно воспользоваться оригинальным <b>cryptcp</b> от Крипто Про: <br><noindex><a href="https://www.cryptopro.ru/products/other/cryptcp" rel="nofollow" target="_blank">--&gt; cryptcp &lt;--</a></noindex><br><br>Пример использования:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">cryptcp&nbsp;<span class="hl_char">-</span>verify&nbsp;<span class="hl_char">-</span>dn&nbsp;chusadm@mail<span class="hl_char">.</span>ru&nbsp;scheme<span class="hl_char">.</span>msg&nbsp;scheme<span class="hl_char">.</span>pdf</li>        </ol>
    </div>
</div></div>
<br>Где <i class=x>scheme.msg</i> - это твой файл &quot;shema.sig&quot;, а &quot;scheme.pdf&quot; - имя файла, в который будет сохранено содержимое сообщения. Соответствующий сертификат должен быть установлен в системе. <br><br>Примерный выхлоп:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">scheme<span class="hl_char">.</span>msg<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;Signature&nbsp;verifying<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1">Signer<span class="hl_char">:</span>&nbsp;Корнилова<span class="hl_char">,</span>&nbsp;<span class="hl_number">59</span>&nbsp;Пермский&nbsp;край<span class="hl_char">,</span>&nbsp;г<span class="hl_char">.</span>&nbsp;Чусовой<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;Администрация&nbsp;Чусовского&nbsp;муниципального&nbsp;района<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;Заместитель&nbsp;главы&nbsp;муниципального&nbsp;района&nbsp;по&nbsp;развитию<span class="hl_char">,</span>&nbsp;<span class="hl_number">005921009285</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">04087713455</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1025902088398</span><span class="hl_char">,</span>&nbsp;chusadm@mail<span class="hl_char">.</span>ru<span class="hl_char">,</span>&nbsp;Администрация&nbsp;Чусовского&nbsp;муниципального&nbsp;района<span class="hl_char">,</span>&nbsp;Елена&nbsp;Викторовна<span class="hl_char">,</span>&nbsp;RU</li>        </ol>
    </div>
</div></div>
<br><br><br><b>Вариант 2</b><br><br>Если же очень хочется накатать свой собственный инструмент, то смотри в сторону реализации в <noindex><a href="https://www.bouncycastle.org/" rel="nofollow" target="_blank">Bouncy Castle</a></noindex>:<br><b>CMSSignedData</b><br><br><br><b>Вариант 3</b><br><br>Можно обработать оригинальный файл без каких-либо модификаций, в оригинальном виде, со строками &quot;<code>-----BEGIN CMS-----</code>&quot; и &quot;<code>-----END CMS-----</code>&quot;<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">openssl&nbsp;cms&nbsp;<span class="hl_char">-</span>verify&nbsp;<span class="hl_char">-</span>inform&nbsp;PEM&nbsp;<span class="hl_char">-</span><span class="hl_function"><b>in</b></span>&nbsp;scheme<span class="hl_char">.</span>pdf<span class="hl_char">.</span>sig&nbsp;<span class="hl_char">-</span>noverify&nbsp;<span class="hl_char">-</span><span class="hl_function"><b>out</b></span>&nbsp;scheme<span class="hl_char">.</span>pdf</li>        </ol>
    </div>
</div></div>
<br>См. ниже примечания в шаге 4, требуется установка GOST Engine для OpenSSL.<br><br>Если хочется разобраться в формате:<br>Декодировать ручками (почти) и с помощью OpenSSL:<br><br>1. Отрезать &quot;-----BEGIN CMS-----&quot; и &quot;-----END CMS-----&quot;, сохранить base64 текст в файл <i class=x>msg.b64</i>. Это не обязательный шаг, см. ниже пример с прямым декодированием с помощью OpenSSL.<br><br>2. Декодировать данные командой:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">base64&nbsp;<span class="hl_char">-</span>D&nbsp;<span class="hl_char">-</span>i&nbsp;msg<span class="hl_char">.</span>b64&nbsp;<span class="hl_char">-</span>o&nbsp;msg<span class="hl_char">.</span>der</li>        </ol>
    </div>
</div></div>
<br>На выходе получим файл в DER кодировке.<br><br>3. Распарсить ASN.1 данные с помощью OpenSSL:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">openssl&nbsp;asn1parse&nbsp;<span class="hl_char">-</span>inform&nbsp;DER&nbsp;<span class="hl_char">-</span><span class="hl_function"><b>in</b></span>&nbsp;msg<span class="hl_char">.</span>der&nbsp;<span class="hl_char">&gt;</span>msg<span class="hl_char">-</span>info<span class="hl_char">.</span>txt</li>        </ol>
    </div>
</div></div>
<br>Результат парсинга будет сохранён в текстовый файл &quot;msg-info.txt&quot;.<br><br>Выхлоп (HEX DUMP поскипан):<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">0</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>inf&nbsp;&nbsp;cons<span class="hl_char">:</span>&nbsp;SEQUENCE</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">2</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">1</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">9</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OBJECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">:</span>pkcs7<span class="hl_char">-</span>signedData</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">13</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">1</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>inf&nbsp;&nbsp;cons<span class="hl_char">:</span>&nbsp;cont&nbsp;<span class="hl_char">[</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">15</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>inf&nbsp;&nbsp;cons<span class="hl_char">:</span>&nbsp;SEQUENCE</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">17</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">3</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">1</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">:</span><span class="hl_number">01</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">20</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">3</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>&nbsp;&nbsp;<span class="hl_number">12</span>&nbsp;cons<span class="hl_char">:</span>&nbsp;SET</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">22</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">4</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>&nbsp;&nbsp;<span class="hl_number">10</span>&nbsp;cons<span class="hl_char">:</span>&nbsp;SEQUENCE</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">24</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">6</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OBJECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">:</span>GOST&nbsp;R&nbsp;<span class="hl_number">34</span><span class="hl_char">.</span><span class="hl_number">11</span><span class="hl_char">-</span><span class="hl_number">94</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">32</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;<span class="hl_function">NULL</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">34</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">3</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>inf&nbsp;&nbsp;cons<span class="hl_char">:</span>&nbsp;SEQUENCE</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">36</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">4</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">9</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OBJECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">:</span>pkcs7<span class="hl_char">-</span><span class="hl_function">data</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">47</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">4</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>inf&nbsp;&nbsp;cons<span class="hl_char">:</span>&nbsp;cont&nbsp;<span class="hl_char">[</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">49</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>inf&nbsp;&nbsp;cons<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">51</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_number">65592</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;<span class="hl_number">131133</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;<span class="hl_number">196674</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;<span class="hl_number">262215</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;<span class="hl_number">327756</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;<span class="hl_number">393297</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;<span class="hl_number">458838</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;<span class="hl_number">524379</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;<span class="hl_number">589920</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;<span class="hl_number">655461</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;<span class="hl_number">721002</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;<span class="hl_number">786543</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;<span class="hl_number">852084</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;<span class="hl_number">917625</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;<span class="hl_number">983166</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">1048707</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">1114248</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">1179789</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">1245330</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">1310871</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">1376412</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">4</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">49323</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">1425739</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;EOC</li><li class="hl_l0"><span class="hl_number">1425741</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;EOC</li><li class="hl_l1"><span class="hl_number">1425743</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">4</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;EOC</li>        </ol>
    </div>
</div></div>
<br>Где с <b>51</b> по <b>1425739</b> - данные документа (PDF) чанками максимальным размером 65536 байт.<br><br>4. Проверяем, что у нас как минимум OpenSSL 1.1, ставим GOST Engine для поддержки шифрования и подписей по ГОСТ:<br><noindex><a href="https://github.com/gost-engine/engine/blob/master/INSTALL.md" rel="nofollow" target="_blank">--&gt; GOST Engine &lt;--</a></noindex><br><br>Тестирование установленного движка ГОСТ:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">openssl&nbsp;engine&nbsp;gost&nbsp;<span class="hl_char">-</span>t</li>        </ol>
    </div>
</div></div>
<br>Выхлоп:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">(</span>gost<span class="hl_char">)</span>&nbsp;Reference&nbsp;implementation&nbsp;of&nbsp;GOST&nbsp;engine</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span>&nbsp;available&nbsp;<span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br>Если движок ГОСТ не будет корректно установлен, то на следующем шаге будет получено сообщение об ошибке, типа такого:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Verification&nbsp;failure</li><li class="hl_l1"><span class="hl_number">4533929408</span><span class="hl_char">:</span>error<span class="hl_char">:</span><span class="hl_number">0609E09C</span><span class="hl_char">:</span>digital&nbsp;envelope&nbsp;routines<span class="hl_char">:</span>pkey_set_type<span class="hl_char">:</span>unsupported&nbsp;algorithm<span class="hl_char">:</span>crypto<span class="hl_char">/</span>evp<span class="hl_char">/</span>p_lib<span class="hl_char">.</span>c<span class="hl_char">:</span><span class="hl_number">210</span><span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">4533929408</span><span class="hl_char">:</span>error<span class="hl_char">:</span><span class="hl_number">0B09406F</span><span class="hl_char">:</span>x509&nbsp;certificate&nbsp;routines<span class="hl_char">:</span>x509_pubkey_decode<span class="hl_char">:</span>unsupported&nbsp;algorithm<span class="hl_char">:</span>crypto<span class="hl_char">/</span>x509<span class="hl_char">/</span>x_pubkey<span class="hl_char">.</span>c<span class="hl_char">:</span><span class="hl_number">114</span></li>        </ol>
    </div>
</div></div>
<br><br>5. Извлекаем файл из сообщения:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">openssl&nbsp;cms&nbsp;<span class="hl_char">-</span>verify&nbsp;<span class="hl_char">-</span>inform&nbsp;DER&nbsp;<span class="hl_char">-</span><span class="hl_function"><b>in</b></span>&nbsp;msg<span class="hl_char">.</span>der&nbsp;<span class="hl_char">-</span>noverify&nbsp;<span class="hl_char">-</span><span class="hl_function"><b>out</b></span>&nbsp;scheme<span class="hl_char">.</span>pdf</li>        </ol>
    </div>
</div></div>
<br>Флаг &quot;<b>-noverify</b>&quot; позволяет проигнорировать подпись и извлечь файл без лишних проверок.<br><br>Разумеется, можно обработать оригинальный файл без каких-либо модификаций, в оригинальном виде, со строками &quot;<code>-----BEGIN CMS-----</code>&quot; и &quot;<code>-----END CMS-----</code>&quot;<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">openssl&nbsp;cms&nbsp;<span class="hl_char">-</span>verify&nbsp;<span class="hl_char">-</span>inform&nbsp;PEM&nbsp;<span class="hl_char">-</span><span class="hl_function"><b>in</b></span>&nbsp;scheme<span class="hl_char">.</span>pdf<span class="hl_char">.</span>sig&nbsp;<span class="hl_char">-</span>noverify&nbsp;<span class="hl_char">-</span><span class="hl_function"><b>out</b></span>&nbsp;scheme<span class="hl_char">.</span>pdf</li>        </ol>
    </div>
</div></div>
<br>Где <i class=x>scheme.pdf.sig</i> - оригинальный файл CMS.<br>Обрати внимание на параметр <i class=x>-inform PEM</i>, который позволяет напрямую обрабатывать исходный файл в формате PEM.<br><br>Выхлоп:<br><code>Verification successful</code><br><br>Файл &quot;scheme.pdf&quot; сохранён в папке.<br><br>6. Проверяем целостность:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">sha1sum&nbsp;<span class="hl_char">*</span><span class="hl_char">.</span>pdf</li>        </ol>
    </div>
</div></div>
<br><code>689fcd09000c17da5e8a1be5af9ac316bbffd5a7  scheme.pdf</code><br><br>Совпадает с исходным файлом. ОК.<br><br><br><br><b>Вариант 4</b><br><br>Расшифровка онлайн с помощью сервера проверки электронной подписи КриптоПро DSS:<br><noindex><a href="https://www.justsign.me/verifyqca/Verify/" rel="nofollow" target="_blank">--&gt; Сервер проверки электронной подписи КриптоПро DSS &lt;--</a></noindex><br><br>1. Выбрать файл <i class=x>&quot;scheme.sig&quot;</i><br>2. Загрузить файл на сервер.<br>3. Если параметры не были опеределены автоматически, то выбрать:<br>- Формат подписи: <b>Подпись в формате CMS</b><br>- Параметры: <b>Присоединённая подпись</b><br>4. Нажимаем <b>Снять и проверить</b>. Будет предложено сохранить файл <i class=x>&quot;scheme.pdf&quot;</i>.<br>5. На выходе получаем файл <i class=x>&quot;scheme.pdf&quot;</i>, содержимое которого полностью совпадает с исходным файлом:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">689fcd09000c17da5e8a1be5af9ac316bbffd5a7</span>&nbsp;&nbsp;scheme<span class="hl_char">.</span>pdf</li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=398272&amp;user=1379&amp;forum_n=5&amp;topic=26087.html&amp;page=0&amp;anchor=3" class="addthx" data-post="398272"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=4773" title="15-09-2019 23:23, ранг:504.6" target="_blank">plutos</a>, <a href="action=userinfo&user=7963" title="16-09-2019 05:22, ранг:125.2" target="_blank">Hugo Chaves</a>, <a href="action=userinfo&user=20667" title="16-09-2019 07:32, ранг:14.1" target="_blank">Slinger</a>, <a href="action=userinfo&user=6946" title="16-09-2019 11:16, ранг:755.0" target="_blank">Isaev</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 сентября 2019 03:03 <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26087.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
варик 5 <br><br><img src="img/attach.gif" alt=""> <a href="./files/c46e_16.09.2019_EXELAB.rU.tgz">c46e_16.09.2019_EXELAB.rU.tgz</a> - pdfcms.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398273&amp;user=18316&amp;forum_n=5&amp;topic=26087.html&amp;page=0&amp;anchor=4" class="addthx" data-post="398273"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=20667" title="16-09-2019 14:06, ранг:14.1" target="_blank">Slinger</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Slinger[/b]','')">Slinger</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 14.1 (новичок), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.25'>Активность: 0.03<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=20667">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 сентября 2019 10:28 <br><script type="text/javascript">QU('Slinger','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Slinger" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26087.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>Adler</b><br><br>Спасибо. Я тоже вечером дописал инструмент для декодирования и выпиливания того, что мне нужно.<br><br>1. Соль до заголовка почему-то разная у файлов, но благо сигнатура файла (спец символы) есть и в .pdf, и в других кодированных файлах, поэтому здесь просто повезло.<br>2. Соль после окончания файла разная, но начинается с одних и тех же символов, поэтому отследить её вполне можно.<br>3. Далее удаляю байты &quot;04 83 01 00 00&quot;, которые расположены на всё протяжении файла на смещениях, кратные 10000h<br>4. Последние 4 байта уникальны, но их тоже можно отследить.<br><br>Как итог - рабочий файл<br><br><b>Jupiter</b><br><br>Огромное спасибо за развёрнутый ответ и за описание работы и проверки!<br><br><b>SReg</b><br><br>На выходе получаю .pdf нулевого размера. Сначала выбирал обычный .sig, потом из .sig удалил заголовок и окончание (BEGIN CMS и END CMS), но результат тот же.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398274&amp;user=20667&amp;forum_n=5&amp;topic=26087.html&amp;page=0&amp;anchor=5" class="addthx" data-post="398274"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 сентября 2019 10:50 <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26087.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Slinger</b> я проверил, все работает, на 7 и 10. может файл открыт, либо путь кривой к сигу.. и удалять ничего не надо. <br>в любом случае можешь отладить, ну и сорец есть сконпиль если хочешь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398275&amp;user=18316&amp;forum_n=5&amp;topic=26087.html&amp;page=0&amp;anchor=6" class="addthx" data-post="398275"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 сентября 2019 12:01 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26087.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>Slinger пишет:<br>Соль до заголовка почему-то разная у файлов </I><br>Это не соль, а структура <code>OCTET STRING</code> формата ASN.1, которую я описал выше.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">49</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">2</span>&nbsp;l<span class="hl_char">=</span>inf&nbsp;&nbsp;cons<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">51</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_number">65592</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;<span class="hl_number">131133</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;<span class="hl_number">196674</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;<span class="hl_number">262215</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;<span class="hl_number">327756</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;<span class="hl_number">393297</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;<span class="hl_number">458838</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;<span class="hl_number">524379</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;<span class="hl_number">589920</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;<span class="hl_number">655461</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;<span class="hl_number">721002</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;<span class="hl_number">786543</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;<span class="hl_number">852084</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1">&nbsp;<span class="hl_number">917625</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;<span class="hl_number">983166</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">1048707</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">1114248</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">1179789</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">1245330</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">1310871</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">5</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">65536</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">1376412</span><span class="hl_char">:</span>d<span class="hl_char">=</span><span class="hl_number">6</span>&nbsp;&nbsp;hl<span class="hl_char">=</span><span class="hl_number">4</span>&nbsp;l<span class="hl_char">=</span><span class="hl_number">49323</span>&nbsp;prim<span class="hl_char">:</span>&nbsp;OCTET&nbsp;STRING&nbsp;<span class="hl_char">[</span>HEX&nbsp;DUMP<span class="hl_char">]</span><span class="hl_char">:</span></li>        </ol>
    </div>
</div></div>
<br>Это блоки, из которых состоит документ.<br>Блок <code>OCTET STRING</code> в ASN.1 ограничен размером в 65536 (10000h) байт, поэтому файл и собирается из кусочков.
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=398277&amp;user=1379&amp;forum_n=5&amp;topic=26087.html&amp;page=0&amp;anchor=7" class="addthx" data-post="398277"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=20667" title="17-09-2019 07:32, ранг:14.1" target="_blank">Slinger</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Adler[/b]','')">Adler</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/41144.png" alt=""><br><span class=txtSm>Ранг: 55.9 (постоянный), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.93'>Активность: 0.12<span style='color:green'>&nearr;</span>0.22</span><br>Статус: <a href="action=userinfo&amp;user=41144">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 сентября 2019 12:05 <br><script type="text/javascript">QU('Adler','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Adler" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26087.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Slinger пишет:<br>На выходе получаю .pdf нулевого размера. Сначала выбирал обычный .sig, потом из .sig удалил заголовок и окончание (BEGIN CMS и END CMS), но результат тот же.<br> </I><br>У меня работает. Сперва файл создается 0 размера и буквально через секунду заполняется.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398278&amp;user=41144&amp;forum_n=5&amp;topic=26087.html&amp;page=0&amp;anchor=8" class="addthx" data-post="398278"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Расшировка CMS файла</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#9" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="26087">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=26087" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
