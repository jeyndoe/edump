<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Дамп файла под NSIS с шеллкодом - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте. Прошу помощи в дампе (распаковки файла). Сразу предупреждаю, что файл является вирусов Razy (так что все мероприятия на виртуалке) Файл представляет из себя NSIS запакованный установщик, который ремапит сам себя.">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=247'>NIKOLA</a>, <a target='_blank' href='?action=userinfo&amp;user=42610'>r0lka</a>, <a target='_blank' href='?action=userinfo&amp;user=19256'>johnniewalker</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Дамп файла под NSIS с шеллкодом</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Makashka[/b]','')">Makashka</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.15'>Активность: 0.01=0.01</span><br>Статус: <a href="action=userinfo&amp;user=32082">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 декабря 2019 00:32 &middot; Поправил: Makashka <br><script type="text/javascript">QU('Makashka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Makashka" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=26230.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте.<br>Прошу помощи в дампе (распаковки файла). Сразу предупреждаю, что файл является вирусов Razy (так что все мероприятия на виртуалке)<br>Файл представляет из себя NSIS запакованный установщик, который ремапит сам себя.<br>Файл запускается, затем распаковывается шифрованный файл с именем 96788936 в Temp папку системы. (прикладываю в архиве)<br>Там хранится по моим предположениям шеллкод.<br>Далее, софт перезапускает сам себя и мапит туда шеллкод, который уже выполняет сам функционал.<br>Проблема в том, что не могу сдампить файл уже который несет в себе функционал. Дохожу до нужного модуля (после ремапом и подобного), дамплю файл и пытаюсь с помощью Scylla Importer восстановить IAT у файла.<br>Но Scylla пишет, что IAT не находится по OEP и следовательно восстанавливает импорты не все. Следовательно, после дампа и частичного восстановления файл не валидный (IDA не видит часть функционала, x64 не отлаживает потом этот файл)<br>Все действия проводятся на Windows 10 x64 + x64dbg (plugin Scylla и dbgchild, т.к создает и ремапит себя в новый созданный процес, нужно сразу начать загнать в отладчик новый файл)<br>Вроде как x64dbg находит EntryPoint (ищу ее через modularinstaller:EntryPoint). Но не уверен, что она верная, потому что поставил breakpoint и отрабатывает какой-то другой код до того, как перейдет к этой точке входа)<br>Задача: просто помочь сдампить правильный файл, чтобы потом его можно было загнать в IDA для анализа.<br><br>Что делаю:<br>Загрузил файл в x64dbg. Затем поставил breakpoints на список функций:<br>CreateProcessA<br>CreateProcessW<br>CreateProcessInternalA<br>CreateProcessInternalW<br>CreateProcessAsUserA<br>CreateProcessAsUserW<br>В один момент срабатывает CreateProcessW и создается новый процесс. В этот момент отрабатывает dbgchild. Но т.к процесс еще не проинициализирован, то новое окно отладчика не запустилось.<br>После подгрузки нескольких системных .dll создается новое окно x64dbg и останавливается все на шаге:<br>77C7867A | EB 07                    | jmp ntdll.77C78683<br><br>Далее пробую сделать дамп файла. Для этого ищу точку входа (modularinstaller:EntryPoint). Выдает результат:<br>0040320C | 31C5                     | xor ebp,eax<br><br>Далее иду в Scylla и делаю дамп, но выдает такое:<br>Imagebase: 77BD0000 Size: 00190000 EntryPoint: 00000000<br>IAT Search Adv: Found 239 (0xEF) possible IAT entries.<br>IAT Search Adv: Possible IAT first 0058A000 last 0058A3DC entry.<br>IAT Search Adv: IAT VA 0058A000 RVA 889BA000 Size 0x03E0 (992)<br>IAT Search Nor: IAT not found at OEP 0040320C!<br>IAT parsing finished, found 239 valid APIs, missed 1 APIs<br>DIRECT IMPORTS - Found 0 possible direct imports with 0 unique APIs!<br>WARNING! IAT is not inside the PE image, requires rebasing!<br>Скрин: https://prnt.sc/qe3jvi<br><br>Есть подозрения, что это не верная точка входа. Пробовал поискать сам, наткнулся по моим подозрениям на точку такую:<br>004CD0C0 | 55                       | push ebp<br>Но там подобная картина при попытке сделать фикс импортов и дамп.<br><br>В общем, не могу найти <img src="img/smilies/s9.gif" alt=""><br>Помогите пожалуйста.<br><br>Ссылка: http://wdfiles.ru/6j52<br>пароль: infected
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=400753&amp;user=32082&amp;forum_n=2&amp;topic=26230.html&amp;page=0&amp;anchor=1" class="addthx" data-post="400753"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 декабря 2019 05:08 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=26230.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Для подобных вопросов есть отдельная тема <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15227" rel="nofollow" target="_blank">--&gt; 	Запросы на исследование вирусов &lt;--</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=400756&amp;user=5846&amp;forum_n=2&amp;topic=26230.html&amp;page=0&amp;anchor=2" class="addthx" data-post="400756"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40990" title="22-12-2019 18:34, ранг:318.5" target="_blank">difexacaw</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 декабря 2019 05:27 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=26230.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>Makashka пишет:<br>вирусов Razy, шеллкод</I><br>Настоящий Razy с js/браузерами заморачивается. Не проще посмотреть сразу по путям к браузерам, куда он прописывает extensions.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=400757&amp;user=26651&amp;forum_n=2&amp;topic=26230.html&amp;page=0&amp;anchor=3" class="addthx" data-post="400757"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Makashka[/b]','')">Makashka</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.15'>Активность: 0.01=0.01</span><br>Статус: <a href="action=userinfo&amp;user=32082">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 декабря 2019 13:20 <br><script type="text/javascript">QU('Makashka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Makashka" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=26230.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>VOLKOFF пишет:<br>Для подобных вопросов есть отдельная тема --&gt; Запросы на исследование вирусов &lt;-- </I><br>Могу пересоздать там, но проблема в том, что вопрос слишком обширный получается для обычного поста, решил создать лучше тему.<br><br><I>ELF_7719116 пишет:<br>Настоящий Razy с js/браузерами заморачивается. Не проще посмотреть сразу по путям к браузерам, куда он прописывает extensions. </I><br>Да, тут дело не в том, куда он и что пишет. Нужен именно просто распакованный файл для последующего анализа, а не отлаживать все по шагам через x64dbg.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=400765&amp;user=32082&amp;forum_n=2&amp;topic=26230.html&amp;page=0&amp;anchor=4" class="addthx" data-post="400765"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 декабря 2019 17:27 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=26230.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Makashka пишет:<br>именно просто распакованный файл  </I><br>Обычно оно ещё несколько раз анпакает из себя через динамическое выделение памяти, payload где-то в конце цепочки будет валяться. Остальное - трешевые обвертки, разбирать которые смысла нет. Сэмпл не смотрел, но полагаю проще поиски с конца начать, когда он начнет выгружать extensions.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=400771&amp;user=26651&amp;forum_n=2&amp;topic=26230.html&amp;page=0&amp;anchor=5" class="addthx" data-post="400771"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40990" title="22-12-2019 18:36, ранг:318.5" target="_blank">difexacaw</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 декабря 2019 21:37 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=26230.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>ELF_7719116</b><br><br>Верно подмечено, только хотел написать что начинать нужно с конца и посмотреть сервисный лог. А потом бубен и отладчик если потребуется конечно.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=400780&amp;user=40990&amp;forum_n=2&amp;topic=26230.html&amp;page=0&amp;anchor=6" class="addthx" data-post="400780"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Makashka[/b]','')">Makashka</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.15'>Активность: 0.01=0.01</span><br>Статус: <a href="action=userinfo&amp;user=32082">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 декабря 2019 22:25 <br><script type="text/javascript">QU('Makashka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Makashka" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=26230.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>Обычно оно ещё несколько раз анпакает из себя через динамическое выделение памяти, payload где-то в конце цепочки будет валяться. Остальное - трешевые обвертки, разбирать которые смысла нет. Сэмпл не смотрел, но полагаю проще поиски с конца начать, когда он начнет выгружать extensions. </I><br>Но если хочется загнать потом файл в IDA и посмотреть более детально с декомпилятором конкретные функции, то делать это через отладчик будет не так удобно, проделывая все те шаги пока доберешься до нужного функционала.<br>Поэтому и думаю, что в идеале дампнуть уже готовый файл (файл, который после ремапов), пофиксить его и анализировать в комплексе все, а не бегать по отладчику и отлавливать все моменты.<br>Или я ошибаюсь и можно сделать проще?<br>Или может после того, как будет выполняться уже работа с extensions дампнуть его? Но опять таки, проблема поиска точки входа, дампа и фикса бинарника (восстановление импорта) остается открытый, ведь это и не получается сделать <img src="img/smilies/s9.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=400786&amp;user=32082&amp;forum_n=2&amp;topic=26230.html&amp;page=0&amp;anchor=7" class="addthx" data-post="400786"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 декабря 2019 23:32 &middot; Поправил: ELF_7719116 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=26230.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>difexacaw</b><br>Прост это правило, котрое выработано при анализе ежедневного потока сэмплов, которые приходят в Лабораторию<img src="img/smilies/s1.gif" alt=""> <br><I>Makashka пишет:<br>в идеале дампнуть уже готовый файл  </I><br>Если это действительно Razy, то, навскидку, только extensions с js-скриптами из полезной нагрузки будут. Сам. exe - дроппер обычный, ничего выдающегося для ресерча там нет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=400798&amp;user=26651&amp;forum_n=2&amp;topic=26230.html&amp;page=0&amp;anchor=8" class="addthx" data-post="400798"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Makashka[/b]','')">Makashka</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.15'>Активность: 0.01=0.01</span><br>Статус: <a href="action=userinfo&amp;user=32082">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 декабря 2019 23:49 <br><script type="text/javascript">QU('Makashka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Makashka" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=26230.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>Если это действительно Razy, то, навскидку, только extensions с js-скриптами из полезной нагрузки будут. Сам. exe - дроппер обычный, ничего выдающегося для ресерча там нет. </I><br>Это действительно он.<br>Там интересна не полезная нагрузка, а особенности патчинга браузеров. То, что он делает с extensions, можно посмотреть после запуска файла, а то, как он работает с браузерами - уже другое. Т.к требуется определить, как он работает с ними - тут и требуется распакованный файл.<br>Никто помочь с распаковкой не может? Сам я пробую это сделать, но застопорился на этом шаге и дальше не пойму, что не так <img src="img/smilies/s9.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=400802&amp;user=32082&amp;forum_n=2&amp;topic=26230.html&amp;page=0&amp;anchor=9" class="addthx" data-post="400802"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 декабря 2019 23:56 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=26230.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>ELF_7719116</b><br><br>&gt; Прост это правило, котрое выработано при анализе ежедневного потока сэмплов<br><br>Спасибо за очень новую и познавательную инфу <img src="img/smilies/s5.gif" alt=""> <img src="img/smilies/s6.gif" alt=""> <img src="img/smilies/s15.gif" alt="">
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=400803&amp;user=40990&amp;forum_n=2&amp;topic=26230.html&amp;page=0&amp;anchor=10" class="addthx" data-post="400803"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]DimitarSerg[/b]','')">DimitarSerg</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/24946.png" alt=""><br><span class=txtSm>Ранг: 253.5 (наставник), 684thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.26'>Активность: 0.26<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=24946">Участник</a><br><font color=blue>radical</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 декабря 2019 01:31 <br><script type="text/javascript">QU('DimitarSerg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DimitarSerg" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=26230.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
А подебажить никому что ль не судьба ?<br><br>Оверлей расшифровывается в память с помощью MSCryptoApi (CryptDecrypt),<br>AES (CBC) <br>ключ:30EB2E3C6A427758905FC5DE0C2AA3DE94FDA48C57E124E1EE98A3972C109E5D<br>вектор нулевой<br><br>https://dropmefiles.com/7LdOC<br>pass:infected<br><br><b>Makashka</b><br>Начало зашифрованного блока в оверлее сам найдешь )<br><br><b>Добавлено спустя 2 минуты</b><br>Залил на ВТ )<br>https://www.virustotal.com/gui/file/98a8733981dc5bc8dfc5b38c47201d44a04f59bb7a1a565d5c904fbf53c16ab6/detection
<br><br><font size="1"><i>-----<br>ds</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=400804&amp;user=24946&amp;forum_n=2&amp;topic=26230.html&amp;page=0&amp;anchor=11" class="addthx" data-post="400804"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=32082" title="23-12-2019 09:01, ранг:5.2" target="_blank">Makashka</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Makashka[/b]','')">Makashka</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.15'>Активность: 0.01=0.01</span><br>Статус: <a href="action=userinfo&amp;user=32082">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 декабря 2019 16:24 <br><script type="text/javascript">QU('Makashka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Makashka" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=26230.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>DimitarSerg пишет:<br>Начало зашифрованного блока в оверлее сам найдешь ) </I><br>Спасибо большое!<br>Все получилось и теперь в разы проще работать с файлом.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=400847&amp;user=32082&amp;forum_n=2&amp;topic=26230.html&amp;page=0&amp;anchor=12" class="addthx" data-post="400847"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Дамп файла под NSIS с шеллкодом</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#13" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="2">
<input type="hidden" name="topic" value="26230">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=26230" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
