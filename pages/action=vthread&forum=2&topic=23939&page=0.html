<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Излечение MSO.dll - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Дело в следующем. После долгих сомнений решил я попытаться портабелизировать мелкомягкй офис без Thinstall&#039;а, а заодно и урезать насколько возможно. Начал с Word&#039;а. Со срачей в реестр справился, но возникла (кто бы мог">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a>, <a target='_blank' href='?action=userinfo&amp;user=50833'>vasilevradislav</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Излечение MSO.dll</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]FalseMaster[/b]','')">FalseMaster</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 40.9 (посетитель), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.74'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26640">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 января 2016 06:12 &middot; Поправил: FalseMaster <br><script type="text/javascript">QU('FalseMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=FalseMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Дело в следующем. После долгих сомнений решил я попытаться портабелизировать мелкомягкй офис без Thinstall&#039;а, а заодно и урезать насколько возможно. Начал с Word&#039;а. Со срачей в реестр справился, но возникла (кто бы мог подумать) проблема. Word стартует, но появляется диалог с сообщением, что &quot;Microsoft Office Word has not been installed for the current user.  Please run setup to install the application.&quot;, после нажатия &quot;Ok&quot; на котором приложение закрывается. С помощью одной утилитки определил класс этого окошка, который оказался 0x8002 (стандартный диалог), но удивлению моему не было предела, когда я поставил в &quot;ольке&quot; бряки на &quot;CreateWindowExA/W&quot;, и выяснилось, что окно такого класса не создаётся… В общем, если кто помнит дела давно минувших дней (офис 2003), подскажите, куда копать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361710&amp;user=26640&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=1" class="addthx" data-post="361710"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 января 2016 10:49 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
поискать строку и посмотреть ссылки на неё?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361711&amp;user=2585&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=2" class="addthx" data-post="361711"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]FalseMaster[/b]','')">FalseMaster</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 40.9 (посетитель), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.74'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26640">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 января 2016 13:03 <br><script type="text/javascript">QU('FalseMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=FalseMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
&gt;&gt; поискать строку и посмотреть ссылки на неё?<br><br>Если вы про заголовок, то я его нашёл, как и текст сообщения, но соль в том, что строка присваивается посредством SetWindowTextW, окно же создаётся раньше где-то в другом месте. А когда я по &lt;Ctrl+F9&gt; пытаюсь выйти в предыдущую функцию, вываливаюсь в код системных библиотек и в конце концов дохожу до появления этого диалога без возврата в MSO.dll.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361714&amp;user=26640&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=3" class="addthx" data-post="361714"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Rainbow[/b]','')">Rainbow</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/13190.jpg" alt=""><br><span class=txtSm>Ранг: 110.8 (ветеран), 104thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.83'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=13190">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 января 2016 13:27 <br><script type="text/javascript">QU('Rainbow','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rainbow" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>FalseMaster пишет:<br>CreateWindowExA/W </I><br><br>А если начать с RegisterClass(Ex) ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361715&amp;user=13190&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=4" class="addthx" data-post="361715"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]FalseMaster[/b]','')">FalseMaster</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 40.9 (посетитель), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.74'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26640">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2016 02:50 <br><script type="text/javascript">QU('FalseMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=FalseMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
&gt;&gt; А если начать с RegisterClass(Ex) ?<br><br>И что это даст?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361756&amp;user=26640&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=5" class="addthx" data-post="361756"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2016 03:46 <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>Rainbow пишет:<br>А если начать с RegisterClass(Ex) ?  </I><br>afaik свои окна система сразу через syscall создаёт, не поймаешь<br><br>Предположение - сообщение это не мессаджбокс а диалог, а SetWindowText вызывается во время обработки WM_INITDIALOG, попробуй поймать user32.DialogBoxIndirectParamAorW или что-то подобное.<br><br>А вообще, подход считаю неверным. У офиса ведь куча разной фигни распихана по папкам. К примеру<br>%COMMONPROGRAMFILES%\Microsoft Shared  и %APPDATA%\Microsoft, и для каждого компонента в реестре прописаны пути. Лучше бы взять ProcMon да посмотреть на чём эта длл обламывается, а не просто патчить всё без оглядки.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361757&amp;user=26242&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=6" class="addthx" data-post="361757"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2016 04:12 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>А вообще, подход считаю неверным </I><br><br>да можно начать с самого начала: хардкод вместо промышленного решения (thinstall) имеет смысл для самообразования. В этом случае нужно рыть самостоятельно, а не искать солюшен.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361758&amp;user=2585&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=7" class="addthx" data-post="361758"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]FalseMaster[/b]','')">FalseMaster</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 40.9 (посетитель), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.74'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26640">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2016 07:28 &middot; Поправил: FalseMaster <br><script type="text/javascript">QU('FalseMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=FalseMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:</I><br><br>&gt;&gt; Предположение - сообщение это не мессаджбокс а диалог<br><br>Диалог и есть. Знаю точно, т.к. на нём контрол офисовый.<br><br>&gt;&gt; а SetWindowText вызывается во время обработки WM_INITDIALOG<br><br>У меня тоже такая мысля была (и есть), но что делать-то в таком случае? Ведь из колбека этого диалога мне никак не выйти на инструкцию, следующую за вызовом создающей его функции.<br><br>&gt;&gt; попробуй поймать user32.DialogBoxIndirectParamAorW<br><br>Так я это первым делом и пробовал вместе с MessageBox(ExA/W). DialogBoxIndirectParamAorW вызывается только один раз при создании главного окна Word&#039;a. Откуда берётся мессаговый диалог, ума не приложу, мистика какая-то.<br><br>&gt;&gt; У офиса ведь куча разной фигни распихана по папкам.<br><br>Перед тем как приступить к основному действу, я расковырял рабочую Thinstall-сборку и воссоздал всю файловую и реестровую структуру офиса – результат был в точности такой же как сейчас.<br><br>&gt;&gt; Лучше бы взять ProcMon да посмотреть на чём эта длл обламывается<br><br>Я привык по отдельности FileMon и RegMon юзать. Так вот, первый вообще не обламывается, второй конечно выдаёт множество NOT FOUND&#039;ов, но большей части ненайденных ключей нет и в виртуальном реестре Thinstall&#039;а, а те что есть, я загонял из reg-файла перед стартом офиса – никакого влияния их наличие не оказывало. Так что остаётся только патчить со всей жестокостью… знать бы только где.<br><br><I>Gideon Vi пишет:</I><br><br>&gt;&gt; …нужно рыть самостоятельно, а не искать солюшен.<br><br>Да мне и самому стрёмно &quot;клянчить&quot;, просто рою уже который день, а толку ноль.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361762&amp;user=26640&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=8" class="addthx" data-post="361762"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2016 07:44 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>FalseMaster пишет:<br>Перед тем как приступить к основному действу, я расковырял рабочую Thinstall-сборку и воссоздал всю файловую и реестровую структуру офиса – результат был в точности такой же как сейчас. </I><br>Файловая и реестровая структура, ладно. А переменные окружения процесса?<br><br><I>FalseMaster пишет:<br>из колбека этого диалога мне никак не выйти на инструкцию, следующую за вызовом создающей его функции. </I><br>Ну если возврат идёт в системные библиотеки - тогда поднимаемся докуда можно и делаем поиск референсов к начальному адресу колбэка.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361764&amp;user=26242&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=9" class="addthx" data-post="361764"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Rainbow[/b]','')">Rainbow</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/13190.jpg" alt=""><br><span class=txtSm>Ранг: 110.8 (ветеран), 104thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.83'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=13190">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2016 11:34 <br><script type="text/javascript">QU('Rainbow','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rainbow" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>FalseMaster пишет:<br>И что это даст? </I><br><br>Как известно любое окно имеет свой класс и регается он в системе, как правило, при помощи этой функи. У WNDCLASSEX есть замечательное поле - WNDPROC lpfnWndProc. Выдираем для конкретного окна в нужный момент и смотрим обработчики сообщений оконной процедуры, в т.ч. WM_INITDIALOG. Оно ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361767&amp;user=13190&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=10" class="addthx" data-post="361767"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2016 11:55 <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>Rainbow</b>, а попробуй сам вызвать тот же мессаджбокс и отследить регу его класса
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361768&amp;user=26242&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=11" class="addthx" data-post="361768"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Rainbow[/b]','')">Rainbow</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/13190.jpg" alt=""><br><span class=txtSm>Ранг: 110.8 (ветеран), 104thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.83'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=13190">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2016 12:59 &middot; Поправил: Rainbow <br><script type="text/javascript">QU('Rainbow','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rainbow" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>а попробуй сам вызвать тот же мессаджбокс и отследить регу его класса  </I><br>Он появляется изниоткуда? o.O ..Демоны !!!<img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361770&amp;user=13190&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=12" class="addthx" data-post="361770"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]FalseMaster[/b]','')">FalseMaster</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 40.9 (посетитель), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.74'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26640">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2016 13:55 &middot; Поправил: FalseMaster <br><script type="text/javascript">QU('FalseMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=FalseMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:</I><br><br>&gt;&gt; А переменные окружения процесса?<br><br>Об этом я как-то не подумал. Дебаггер показал, что читаются две (отсутствующие): &quot;_CLUSTER_NETWORK_NAME_&quot; и &quot;msooaopt&quot;. Первая, судя по названию, погоды не делает, а вот вторая – вполне возможно, только мне от этого не легче, значения-то я не знаю.<br><br>&gt;&gt; …и делаем поиск референсов к начальному адресу колбэка<br><br>Только его для начала надо каким-то образом определить.<br><br><I>Rainbow пишет:</I><br><br>&gt;&gt; Как известно любое окно имеет свой класс<br><br>А вот с названием класса я дал маху. С чего-то мне втемяшилось, что значение #32770, выданное утилитой, надо переводить в число, а ведь WNDCLASS(EX).lpszClassName можно присвоить его и в виде строки. Забрезжила надежда, но увы, хоть я и нашёл место, где идёт обращение к упомянутой строке, перехода на этот код не происходит… но, сцуко, как-то же оно работает, не верю я в чудеса (но такими темпами скоро поверю).<br><br>&gt;&gt; Он появляется изниоткуда? o.O ..Демоны !!!<br><br>Демоны живут в линуксах, а встроенные классы винды создаются ещё на этапе загрузки системы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361775&amp;user=26640&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=13" class="addthx" data-post="361775"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 января 2016 14:29 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>FalseMaster пишет:<br>бряки на &quot;CreateWindowExA/W&quot;, и выяснилось, что окно такого класса не создаётся </I><br>Попробуйте просто поставть на секцию кода <b>user32.dll</b> бряк. <br>Выложите собственно саму MSO.dll
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361778&amp;user=26651&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=14" class="addthx" data-post="361778"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]FalseMaster[/b]','')">FalseMaster</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 40.9 (посетитель), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.74'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26640">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 января 2016 03:54 <br><script type="text/javascript">QU('FalseMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=FalseMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
&gt;&gt; Попробуйте просто поставть на секцию кода user32.dll бряк.<br><br>И? К этой библе 100500 обращений в секунду.<br><br>&gt;&gt; Выложите собственно саму MSO.dll<br><br>Я <noindex><a href="https://raymond.cc/blog/fix-microsoft-office-word-has-not-been-installed-for-the-current-user-error/" rel="nofollow" target="_blank">отсюда</a></noindex> брал (та что для Office 2003).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361796&amp;user=26640&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=15" class="addthx" data-post="361796"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 января 2016 05:10 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Ну всё оказалось как и предполагалось ранее<br>30F45991 - обработка WM_INITDIALOG<br>30F46A54 - собственно сам DialogProc<br>Референсы ведут в офигенно большую процедуру 30F45DF8<br>Поднимаясь выше по вызовам, выходим на развилку - 30F4673E. Дальше надо отладчиком мониторить, откуда её зовут.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361797&amp;user=26242&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=16" class="addthx" data-post="361797"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=26640" title="12-01-2016 23:47, ранг:19.0" target="_blank">FalseMaster</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]FalseMaster[/b]','')">FalseMaster</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 40.9 (посетитель), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.74'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26640">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 января 2016 20:07 <br><script type="text/javascript">QU('FalseMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=FalseMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
От треклятого диалога я таки избавился (благодаря подсказке AkaBOSS&#039;а), и Word отрабатывает до конца. Я уж было обрадовался в предвкушении победы, но не тут-то было – практика показала, что номер проходит только под отладчиком, и не просто под отладчиком, а патчи (2 шт.) приходится вводить последовательно по HBP, если же вписать оба патча на первом бряке, в ходе дальнейшего выполнения происходит выброс на какой-нибудь левый адрес. Более того, установка INT3-бряка в любом месте кодовой секции MSO.dll приводит к тому же эффекту. Похоже, что в отдельном потоке периодически проверяется целостность кода. Обнаружилась очень подозрительная процедура по адресу 315FD360, в которую в качестве параметра передаются указатели на секцию кода. В свою очередь, адрес сей процедуры выступает аргументом 5-ти процедур по адресам: 30CA4C53,30CA6864,30CA7208,30CA557C,30CA5ED7, вызываемых из 35 мест. Скипанье любой из процедур ведёт к описанному выше плачевному финалу… В общем жопа полная, полнейшая. Теперь я понимаю, почему в своё время крякнут был инсталлятор офиса, а не он сам – мелкомягкие индусы вместо оптимизации своего блевотного кода и устранения багов, занимались и занимаются вставлянием палок в колёса приличным людям.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361926&amp;user=26640&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=17" class="addthx" data-post="361926"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 января 2016 20:30 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>FalseMaster</b><br>а проверить условие долбанного диалога не, никак?<br>изменив условие - избавляемся от необходимости патча.<br>в противном случае - придётся инлайнить. Перехватывать ближайшие к месту патча апи и  проверять рва возврата, после чего патчить<br><br><br>Хотя если во время работы ворда все эти мегапроверки не вызываются, можно попробовать запатчить и их (разумеется, проследив, куда и что онм сохраняют).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=361929&amp;user=26242&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=18" class="addthx" data-post="361929"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]FalseMaster[/b]','')">FalseMaster</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 40.9 (посетитель), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.74'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=26640">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 января 2016 05:26 <br><script type="text/javascript">QU('FalseMaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=FalseMaster" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=23939.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:</I><br><br>&gt;&gt; а проверить условие долбанного диалога не, никак?<br><br>Если б я был ядрёным кулхацкером, то может и как, но увы и ах… Для изменения условий требуется знание структуры файла &quot;%ALLUSERSPROFILE%\Application Data\Microsoft\Office\Data\opa11.dat&quot; и ветки реестра &quot;[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Common\BaseSuite]&quot;, по сути ты предлагаешь мастырить keygen.<br><br>&gt;&gt; в противном случае - придётся инлайнить.<br><br>Так я и поступил. Но пошёл напролом и засплайсил не ближайшие API&#039;шки, а саму проверочную процедуру, точнее 3 из 5 (как выяснилось по ходу колупания… даа, хитры мелкомягкие), и подсовываю им оригинальные байты. В общем с грехом пополам Word завёлся, но тестировать конечно надо тщательно – на 90% уверен, что в самый неожиданный момент вылезет какая-нибудь бяка, да и портабелизации ещё непочатый край – на данный момент я только предохранился от создания новых ключей реестра (файлы/папки вообще не трогал), но существующие подвержены изменениям, и, как я успел заметить, сие непотребство имеет место. Такие дела.<br><br>За помощь премного благодарен. Если б ты мне не подарил адрес диалоговой функции, ничего бы у меня не вышло. Кстати, не сочти за наглость, но очень хочется узнать, как ты его выудил (если конечно это не профессиональный секрет) – в будущем мне это знание может пригодиться, версий-то у этой DLL&#039;ки немало.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362039&amp;user=26640&amp;forum_n=2&amp;topic=23939.html&amp;page=0&amp;anchor=19" class="addthx" data-post="362039"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Излечение MSO.dll</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#20" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="2">
<input type="hidden" name="topic" value="23939">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23939" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
