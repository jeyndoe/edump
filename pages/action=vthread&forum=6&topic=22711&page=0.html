<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Сплайсинг.Вероятно плутаю с арифметикой адресов а может и нет.Подскажите. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Кидает походу в начало затычки,а не на оригинальный код за затычкой.Мозги уже кипят с этой адресной арифметикой. [С] typedef int (WINAPI *MessageBoxADYn)(_In_opt_ HWND hWnd,_In_opt_ LPCSTR lpText,_In_opt_ LPCSTR lpCaption,_In_">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Сплайсинг.Вероятно плутаю с арифметикой адресов а может и нет.Подскажите.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]kruasancheg[/b]','')">kruasancheg</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.25'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37183">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 апреля 2014 21:31 <br><script type="text/javascript">QU('kruasancheg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kruasancheg" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Кидает походу в начало затычки,а не на оригинальный код за затычкой.Мозги уже кипят с этой адресной арифметикой.<br>[С]<br>typedef int (WINAPI  *MessageBoxADYn)(_In_opt_ HWND hWnd,_In_opt_ LPCSTR lpText,_In_opt_ LPCSTR lpCaption,_In_ UINT uType);<br>typedef void (WINAPI *WINAPIBackRoutine)();<br><br>BYTE *orig;<br>BYTE jmp[5];<br><br>#pragma pack(push,1)<br>struct JmpShell<br>{<br>	unsigned char op;<br>	DWORD adr;<br>};<br>#pragma pack(pop)<br><br>void SetHOOK(DWORD adr,DWORD GateAdr)<br>{<br>	SetLastError(0);<br>	DWORD prev=0;<br>	VirtualProtect((void*)adr,5,PAGE_EXECUTE_READWRITE,&amp;prev);<br>	orig=(BYTE*)VirtualAlloc(0,10,MEM_COMMIT | MEM_RESERVE,PAGE_EXECUTE_READWRITE);<br>	memcpy(orig,(void*)adr,5);<br>	DWORD BackShell=((DWORD)orig)+5;<br>	JmpShell *jback=(JmpShell *)BackShell;<br>	jback-&gt;op=0xe9;<br>	jback-&gt;adr=(adr-5) - ((DWORD)orig+5);<br>	JmpShell *jsh=(JmpShell*)adr;<br>	jsh-&gt;op=0xe9;<br>	jsh-&gt;adr=GateAdr-adr-5;<br>	VirtualProtect((void*)adr,5,prev,&amp;prev);<br>}<br>void Back()<br>{<br>	WINAPIBackRoutine BB=(WINAPIBackRoutine)orig;<br>	BB();<br>}<br>void /*WINAPI*/ Gate(HWND hWnd,LPCSTR lpText,LPCSTR lpCaption,UINT uType)<br>{<br>	printf(&quot;!&quot;);<br>	Back();<br>}<br>int _tmain(int argc, _TCHAR* argv[])<br>{<br>	HMODULE u32=LoadLibrary(L&quot;user32.dll&quot;);<br>	MessageBoxADYn MB=(MessageBoxADYn)GetProcAddress(u32,&quot;MessageBoxA&quot;);<br>	SetHOOK((DWORD)MB,(DWORD)&amp;Gate);<br>	//MB(0,&quot;&quot;,&quot;&quot;,MB_OK);<br>	printf(&quot;func adr: %X\n&quot;,MB);<br>	MessageBoxA(0,&quot;&quot;,&quot;&quot;,MB_OK);<br>	//printf(&quot;%d&quot;,GetLen((BYTE*)MB));<br>	/*int sum=0,curlen=0;<br>	BYTE *seek=(BYTE*)MB;<br>	for(;;)<br>	{<br>		curlen=GetLen(seek);<br>		sum=sum+curlen;<br>		seek=(BYTE*)( ((DWORD)seek)+curlen );<br>		printf(&quot;%d SUMlen: %d \n&quot;,curlen,sum);<br>		_getch();<br>	}*/<br>	_getch();<br>	return 0;<br>}<br><br>[/С]
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340563&amp;user=37183&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=1" class="addthx" data-post="340563"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 апреля 2014 21:44 &middot; Поправил: Vovan666 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Давай уж скомпилированный вариант, глаза болят от кривоскопиррованного копи-паста.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340564&amp;user=5291&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=2" class="addthx" data-post="340564"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 апреля 2014 21:48 <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
если автор хотел победить в конкурсе на самый визуально нечитабельный кодес, то ему бы следовало приложить еще немного усилий, а так попытка зочотная
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340565&amp;user=22831&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=3" class="addthx" data-post="340565"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]unknownproject[/b]','')">unknownproject</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.1 (постоянный), 247thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.52'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=27422">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 апреля 2014 23:06 <br><script type="text/javascript">QU('unknownproject','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unknownproject" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>kruasancheg пишет:<br>начало затычки </I><br>Это новая функция такая ? Затычка.
<br><br><font size="1"><i>-----<br>TEST YOUR MIGHT</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=340566&amp;user=27422&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=4" class="addthx" data-post="340566"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]kruasancheg[/b]','')">kruasancheg</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.25'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37183">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 апреля 2014 23:23 &middot; Поправил: kruasancheg <br><script type="text/javascript">QU('kruasancheg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kruasancheg" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Vovan666 пишет:<br>Давай уж скомпилированный вариант, глаза болят от кривоскопиррованного копи-паста. </I><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">jback<span class="hl_char">-</span><span class="hl_char">&gt;</span>adr<span class="hl_char">=</span><span class="hl_char">(</span>АдресОригинальной&nbsp;функции<span class="hl_char">-</span><span class="hl_number">5</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>БлокПамяти&nbsp;с&nbsp;ОригинальнымКодом&nbsp;и&nbsp;Джампом&nbsp;на&nbsp;код&nbsp;За&nbsp;Трамплином<span class="hl_char">+</span><span class="hl_number">5</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
Как будет правильно ?<br><br><img src="img/attach.gif" alt=""> <a href="./files/81b5_12.04.2014_EXELAB.rU.tgz">81b5_12.04.2014_EXELAB.rU.tgz</a> - splaice.exe
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340567&amp;user=37183&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=5" class="addthx" data-post="340567"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]soft[/b]','')">soft</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 21.0 (новичок), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.95'>Активность: 0.01<span style='color:green'>&nearr;</span>0.03</span><br>Статус: <a href="action=userinfo&amp;user=12603">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 апреля 2014 12:58 <br><script type="text/javascript">QU('soft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=soft" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#include&nbsp;<span class="hl_char">&lt;</span>windows<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;SetHOOK<span class="hl_char">(</span><span class="hl_function"><b>DWORD</b></span>&nbsp;dwNewFunc<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwOrigFunc<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;OldProtect<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VirtualProtect<span class="hl_char">(</span>LPVOID<span class="hl_char">(</span>dwOrigFunc<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">5</span><span class="hl_char">,</span>&nbsp;PAGE_EXECUTE_READWRITE<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>OldProtect<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>dwOrigFunc<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;0xE9<span class="hl_comment">;//JMP</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>dwOrigFunc<span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;dwNewFunc&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_char">(</span>dwOrigFunc<span class="hl_char">+</span><span class="hl_number">5</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>int</b></span>&nbsp;__stdcall&nbsp;Gate<span class="hl_char">(</span>HWND&nbsp;hWnd<span class="hl_char">,</span>&nbsp;LPCSTR&nbsp;lpText<span class="hl_char">,</span>&nbsp;LPCSTR&nbsp;lpCaption<span class="hl_char">,</span>&nbsp;UINT&nbsp;uType<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;MessageBoxExA<span class="hl_char">(</span>hWnd<span class="hl_char">,</span><span class="hl_quote">&quot;NewMessageBoxA&quot;</span><span class="hl_char">,</span>&nbsp;lpCaption<span class="hl_char">,</span>&nbsp;uType<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>int</b></span>&nbsp;_tmain<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;argc<span class="hl_char">,</span>&nbsp;_TCHAR<span class="hl_char">*</span>&nbsp;argv<span class="hl_char">[</span><span class="hl_char">]</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBoxA<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_quote">&quot;test&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;test&quot;</span><span class="hl_char">,</span>MB_OK<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetHOOK<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span><span class="hl_char">&amp;</span>Gate<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>MessageBoxA<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBoxA<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_quote">&quot;test2&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;test2&quot;</span><span class="hl_char">,</span>MB_OK<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=340576&amp;user=12603&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=6" class="addthx" data-post="340576"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]kruasancheg[/b]','')">kruasancheg</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.25'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37183">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 апреля 2014 14:33 <br><script type="text/javascript">QU('kruasancheg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kruasancheg" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
в MessageBoxExA входит джамп на тело оригинальной ф-ции,или я чего то не допонимаю?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340580&amp;user=37183&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=7" class="addthx" data-post="340580"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 апреля 2014 16:15 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<noindex><a href="http://www.wasm.ru/forum/viewtopic.php?pid=226108#p226108" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><noindex><a href="http://wasm.ru/forum/viewtopic.php?id=24615" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br>еще примеры<br>для разнообразия
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340582&amp;user=15381&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=8" class="addthx" data-post="340582"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]soft[/b]','')">soft</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 21.0 (новичок), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.95'>Активность: 0.01<span style='color:green'>&nearr;</span>0.03</span><br>Статус: <a href="action=userinfo&amp;user=12603">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 апреля 2014 16:19 <br><script type="text/javascript">QU('soft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=soft" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
вместо MessageBoxA(0,&quot;test2&quot;,&quot;test2&quot;,MB_OK) вызывается  Gate-&gt;MessageBoxExA(hWnd,&quot;NewMessageBoxA&quot;, lpCaption, uType, 0) просто как пример работы хука. MessageBoxExA можно убрать. если нужно вызывать оригинальную функу MessageBoxA, то в SetHOOK нужно сохранять оригинальные байты перед их изменением, а перед вызовом MessageBoxA восстанавливать их, после вызова опять ставить хук.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340583&amp;user=12603&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=9" class="addthx" data-post="340583"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 апреля 2014 17:23 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>soft пишет:<br>сохранять оригинальные байты перед их изменением, а перед вызовом MessageBoxA восстанавливать их, после вызова опять ставить хук</I><br>Плохая практика, которая приведёт к тому, что на нескольких потоках рано или поздно этот комбайн навернётся.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340584&amp;user=1556&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=10" class="addthx" data-post="340584"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 апреля 2014 22:09 <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>Archer пишет:<br>на нескольких потоках </I><br>совсем не так часто такое бывает, зависит от цели. а ТС - чудик, лучше бы в детурс смотрел
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=340585&amp;user=8830&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=11" class="addthx" data-post="340585"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]kruasancheg[/b]','')">kruasancheg</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.25'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37183">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 апреля 2014 23:42 &middot; Поправил: kruasancheg <br><script type="text/javascript">QU('kruasancheg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kruasancheg" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">typedef&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;<span class="hl_char">(</span>WINAPI&nbsp;&nbsp;<span class="hl_char">*</span>MessageBoxADYn<span class="hl_char">)</span><span class="hl_char">(</span>_In_opt_&nbsp;HWND&nbsp;hWnd<span class="hl_char">,</span>_In_opt_&nbsp;LPCSTR&nbsp;lpText<span class="hl_char">,</span>_In_opt_&nbsp;LPCSTR&nbsp;lpCaption<span class="hl_char">,</span>_In_&nbsp;UINT&nbsp;uType<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_char">*</span>orig<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">#pragma&nbsp;pack<span class="hl_char">(</span><span class="hl_function">push</span><span class="hl_char">,</span><span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l1">struct&nbsp;JmpShell</li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;op<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;adr<span class="hl_comment">;</span></li><li class="hl_l1">}<span class="hl_comment">;</span></li><li class="hl_l0">#pragma&nbsp;pack<span class="hl_char">(</span><span class="hl_function">pop</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;SetHOOK<span class="hl_char">(</span><span class="hl_function"><b>DWORD</b></span>&nbsp;FuncAdr<span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;GateAdr<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;prev<span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VirtualProtect<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">*</span><span class="hl_char">)</span>FuncAdr<span class="hl_char">,</span><span class="hl_number">5</span><span class="hl_char">,</span>PAGE_EXECUTE_READWRITE<span class="hl_char">,</span><span class="hl_char">&amp;</span>prev<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orig<span class="hl_char">=</span><span class="hl_char">(</span><span class="hl_function">BYTE</span><span class="hl_char">*</span><span class="hl_char">)</span>VirtualAlloc<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_number">10</span><span class="hl_char">*</span><span class="hl_char">/</span><span class="hl_number">4096</span><span class="hl_char">,</span>MEM_COMMIT&nbsp;<span class="hl_char">|</span>&nbsp;MEM_RESERVE<span class="hl_char">,</span>PAGE_EXECUTE_READWRITE<span class="hl_char">)</span><span class="hl_comment">;//оригинальные 5 байт+джамп на оригинальное тело ф-ции</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy<span class="hl_char">(</span>orig<span class="hl_char">,</span><span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">*</span><span class="hl_char">)</span>FuncAdr<span class="hl_char">,</span><span class="hl_number">5</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;BackShell<span class="hl_char">=</span><span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>orig<span class="hl_char">)</span><span class="hl_char">+</span><span class="hl_number">5</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JmpShell&nbsp;<span class="hl_char">*</span>jback<span class="hl_char">=</span><span class="hl_char">(</span>JmpShell&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>BackShell<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jback<span class="hl_char">-</span><span class="hl_char">&gt;</span>op<span class="hl_char">=</span>0xe9<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jback<span class="hl_char">-</span><span class="hl_char">&gt;</span>adr<span class="hl_char">=</span><span class="hl_char">(</span>FuncAdr<span class="hl_char">+</span><span class="hl_number">5</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>orig<span class="hl_char">)</span>&nbsp;<span class="hl_char">+</span><span class="hl_number">5</span><span class="hl_char">)</span><span class="hl_comment">;//возврат на тело оригинальной ф-ции </span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">/</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JmpShell&nbsp;<span class="hl_char">*</span>jsh<span class="hl_char">=</span><span class="hl_char">(</span>JmpShell<span class="hl_char">*</span><span class="hl_char">)</span>FuncAdr<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jsh<span class="hl_char">-</span><span class="hl_char">&gt;</span>op<span class="hl_char">=</span>0xe9<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jsh<span class="hl_char">-</span><span class="hl_char">&gt;</span>adr<span class="hl_char">=</span>GateAdr<span class="hl_char">-</span>FuncAdr<span class="hl_char">-</span><span class="hl_number">5</span><span class="hl_comment">;//переход на заглушку</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VirtualProtect<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">*</span><span class="hl_char">)</span>FuncAdr<span class="hl_char">,</span><span class="hl_number">5</span><span class="hl_char">,</span>prev<span class="hl_char">,</span><span class="hl_char">&amp;</span>prev<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>int</b></span>&nbsp;WINAPI&nbsp;Gate<span class="hl_char">(</span>HWND&nbsp;hWnd<span class="hl_char">,</span>LPCSTR&nbsp;lpText<span class="hl_char">,</span>LPCSTR&nbsp;lpCaption<span class="hl_char">,</span>UINT&nbsp;uType<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;%s %s\n&quot;</span><span class="hl_char">,</span>lpText<span class="hl_char">,</span>lpCaption<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBoxADYn&nbsp;OrigBox<span class="hl_char">=</span><span class="hl_char">(</span>MessageBoxADYn<span class="hl_char">)</span>orig<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_asm</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;<span class="hl_number">3</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>почему&nbsp;то&nbsp;за&nbsp;бряком&nbsp;перед&nbsp;жампом<span class="hl_char">,</span>&nbsp;торчит&nbsp;это&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">*</span><span class="hl_char">/</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;<span class="hl_function">ret</span><span class="hl_char">=</span>OrigBox<span class="hl_char">(</span>hWnd<span class="hl_char">,</span>lpText<span class="hl_char">,</span>lpCaption<span class="hl_char">,</span>uType<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>ret</b></span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1"><span class="hl_function"><b>int</b></span>&nbsp;_tmain<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;argc<span class="hl_char">,</span>&nbsp;_TCHAR<span class="hl_char">*</span>&nbsp;argv<span class="hl_char">[</span><span class="hl_char">]</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HMODULE&nbsp;u32<span class="hl_char">=</span>LoadLibrary<span class="hl_char">(</span><span class="hl_quote">L&quot;user32.dll&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;funcAdr<span class="hl_char">=</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>GetProcAddress<span class="hl_char">(</span>u32<span class="hl_char">,</span><span class="hl_quote">&quot;MessageBoxA&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetHOOK<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span>funcAdr<span class="hl_char">,</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span><span class="hl_char">&amp;</span>Gate<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;func adr: %X\n&quot;</span><span class="hl_char">,</span>funcAdr<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBoxA<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_quote">&quot;hhtgmgh&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;km.hj.h&quot;</span><span class="hl_char">,</span>MB_OK<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_getch<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br>Поясните странность плз - в иде начало мессаджбокса начинаеться так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li>        </ol>
    </div>
</div></div>
<br>А в ольке за бряком вижу такое вот:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function">int3</span></li><li class="hl_l0"><span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr"><b>ebp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_registr">eax</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=340593&amp;user=37183&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=12" class="addthx" data-post="340593"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 465thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2014 02:50 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>soft пишет:<br>*(DWORD*)(dwOrigFunc+1) = dwNewFunc - (dwOrigFunc+5); </I><br>Неправильное выражение,так будет работать в случае если код подменной функции будет ниже хученого кода, если выше то вы обломитесь, в арифметеке<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>dwOrigFunc<span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">)</span> <span class="hl_char">=</span>0xFFFFFFFF&nbsp;<span class="hl_char">-</span>&nbsp;dwOrigFunc&nbsp;<span class="hl_char">+</span>&nbsp;dwNewFunc&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">4</span>&nbsp;<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=340596&amp;user=17432&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=13" class="addthx" data-post="340596"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2014 03:13 <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>kruasancheg пишет:<br>Поясните странность плз </I><br>Оба варианта выдернуты под режимом отладки? Очевидно что во втором варианте кто-то поставил int 3 прерывание в начале функции. Проще говоря - кто-то поставил софтварный бряк
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=340597&amp;user=2777&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=14" class="addthx" data-post="340597"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2014 08:31 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
MessageBoxExA - не используйте это.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340602&amp;user=33727&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=15" class="addthx" data-post="340602"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2014 09:17 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>ajax пишет:<br>совсем не так часто такое бывает</I><br>Ну да, периодические краши-это так мило. Особенно когда происходят не особо часто и непредсказуемо.<br><br><I>ClockMan пишет:<br>Неправильное выражение,так будет работать в случае если код подменной функции будет ниже хученого кода</I><br>А не смущает, что код идентичный? <img src="img/smilies/s1.gif" alt=""> Имеется в виду для х86, конечно. Для х64 дальше 2 гб в любом случае таким переходом не дотянется.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340604&amp;user=1556&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=16" class="addthx" data-post="340604"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]kruasancheg[/b]','')">kruasancheg</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.25'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37183">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2014 10:16 &middot; Поправил: kruasancheg <br><script type="text/javascript">QU('kruasancheg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kruasancheg" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>daFix пишет:<br> Оба варианта выдернуты под режимом отладки? Очевидно что во втором варианте кто-то поставил int 3 прерывание в начале функции. Проще говоря - кто-то поставил софтварный бряк </I><br>Я его поставил.Разве не видно???<br>Тут кто то что то читает до конца, перед тем как отвечать.Или только троллят???
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340606&amp;user=37183&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=17" class="addthx" data-post="340606"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2014 11:43 <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Мой велосипед на базе дизассемблера mediana<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#pragma&nbsp;pack<span class="hl_char">(</span><span class="hl_function">push</span><span class="hl_char">)</span></li><li class="hl_l1">#pragma&nbsp;pack<span class="hl_char">(</span><span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l0">typedef&nbsp;struct&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UCHAR&nbsp;opcode<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ULONG_PTR&nbsp;<span class="hl_function"><b>offset</b></span><span class="hl_comment">;</span></li><li class="hl_l1">}&nbsp;t_jmp<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">typedef&nbsp;struct&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPVOID&nbsp;address<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPVOID&nbsp;stub<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIZE_T&nbsp;stub_size<span class="hl_comment">;</span></li><li class="hl_l1">}&nbsp;t_splice<span class="hl_comment">;</span></li><li class="hl_l0">#pragma&nbsp;pack<span class="hl_char">(</span><span class="hl_function">pop</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">t_splice&nbsp;<span class="hl_char">*</span>SetHook<span class="hl_char">(</span>LPVOID&nbsp;lpApiFn<span class="hl_char">,</span>&nbsp;LPVOID&nbsp;lpHook<span class="hl_char">,</span>&nbsp;LPVOID&nbsp;<span class="hl_char">*</span>lpStub<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span>lpApiFn&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">|</span>&nbsp;<span class="hl_char">(</span>lpHook&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">|</span>&nbsp;<span class="hl_char">(</span>lpStub&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_splice&nbsp;<span class="hl_char">*</span>splice&nbsp;<span class="hl_char">=</span>&nbsp;malloc<span class="hl_char">(</span><span class="hl_function">sizeof</span><span class="hl_char">(</span>t_splice<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>splice<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_jmp&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;<span class="hl_number">0</span>&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">jmp</span><span class="hl_char">.</span>opcode&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>UCHAR<span class="hl_char">)</span>0xE9<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">jmp</span><span class="hl_char">.</span><span class="hl_function"><b>offset</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>ULONG_PTR<span class="hl_char">)</span>lpHook&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_char">(</span>ULONG_PTR<span class="hl_char">)</span>lpApiFn&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">5</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;INSTRUCTION&nbsp;instr<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;DISASM_INOUT_PARAMS&nbsp;params<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;sf_prefixes<span class="hl_char">[</span>MAX_INSTRUCTION_LEN<span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params<span class="hl_char">.</span>arch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;ARCH_ALL<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params<span class="hl_char">.</span>sf_prefixes&nbsp;<span class="hl_char">=</span>&nbsp;sf_prefixes<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params<span class="hl_char">.</span>mode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;DISASSEMBLE_MODE_32<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params<span class="hl_char">.</span>options&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;DISASM_OPTION_APPLY_REL&nbsp;<span class="hl_char">|</span>&nbsp;DISASM_OPTION_OPTIMIZE_DISP<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params<span class="hl_char">.</span>base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>uint64_t<span class="hl_char">)</span>lpApiFn<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;res<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIZE_T&nbsp;nStubLen&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;<span class="hl_char">*</span>lpCurPtr&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>uint8_t&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span>lpApiFn<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>nStubLen&nbsp;<span class="hl_char">&lt;</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>t_jmp<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">=</span>&nbsp;medi_disassemble<span class="hl_char">(</span>lpCurPtr<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>instr<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>params<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lpCurPtr&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;res<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params<span class="hl_char">.</span>base&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;res<span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nStubLen&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;res<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPVOID&nbsp;lpWrap&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>LPVOID<span class="hl_char">)</span>malloc<span class="hl_char">(</span>nStubLen&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>t_jmp<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>lpWrap&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span>&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;free<span class="hl_char">(</span>splice<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy<span class="hl_char">(</span>lpWrap<span class="hl_char">,</span>&nbsp;lpApiFn<span class="hl_char">,</span>&nbsp;nStubLen<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_jmp&nbsp;jmpret&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;{&nbsp;<span class="hl_number">0</span>&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmpret<span class="hl_char">.</span>opcode&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>UCHAR<span class="hl_char">)</span>0xE9<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmpret<span class="hl_char">.</span><span class="hl_function"><b>offset</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>ULONG_PTR<span class="hl_char">)</span>lpApiFn&nbsp;<span class="hl_char">+</span>&nbsp;nStubLen&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_char">(</span>ULONG_PTR<span class="hl_char">)</span>lpWrap&nbsp;<span class="hl_char">-</span>&nbsp;nStubLen&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">5</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy<span class="hl_char">(</span><span class="hl_char">(</span>LPVOID<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span>ULONG_PTR<span class="hl_char">)</span>lpWrap&nbsp;<span class="hl_char">+</span>&nbsp;nStubLen<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>jmpret<span class="hl_char">,</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>t_jmp<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwOldProt&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VirtualProtect<span class="hl_char">(</span>lpWrap<span class="hl_char">,</span>&nbsp;nStubLen&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>t_jmp<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;PAGE_EXECUTE_READWRITE<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>dwOldProt<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VirtualProtect<span class="hl_char">(</span>lpApiFn<span class="hl_char">,</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>t_jmp<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;PAGE_EXECUTE_READWRITE<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>dwOldProt<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy<span class="hl_char">(</span>lpApiFn<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_function">jmp</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span><span class="hl_function">jmp</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VirtualProtect<span class="hl_char">(</span>lpApiFn<span class="hl_char">,</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>t_jmp<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;dwOldProt<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>dwOldProt<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>lpStub&nbsp;<span class="hl_char">=</span>&nbsp;lpWrap<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FlushInstructionCache<span class="hl_char">(</span>GetCurrentProcess<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;lpApiFn<span class="hl_char">,</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span><span class="hl_function">jmp</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;splice<span class="hl_char">-</span><span class="hl_char">&gt;</span>address&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;lpApiFn<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;splice<span class="hl_char">-</span><span class="hl_char">&gt;</span>stub&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;lpWrap<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;splice<span class="hl_char">-</span><span class="hl_char">&gt;</span>stub_size&nbsp;<span class="hl_char">=</span>&nbsp;nStubLen<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;splice<span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=340608&amp;user=3136&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=18" class="addthx" data-post="340608"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2014 11:43 &middot; Поправил: ajax <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>kruasancheg</b><br>троллят. ибо кг/ам<br><b>Veliant</b><br>под PC-архитектуру флашить смысла нет. так же, как GCP вернет -1 для текущего всегда. но, с точки зрения хорошего кодерства - все верно<br><b>Archer</b><br>lock exchange или типа того - давно видел забавный вариантик для многопотока. обычно бывают конкретные случаи, в них делать крит секции и тп - смысла нет. с точки зрения не писателя аверов, или мудреного софта <img src="img/smilies/s1.gif" alt=""><br><br>пофлудю. ресурс превращается в &quot;дайте здесь и щаз же, гугль забанен&quot; <img src="img/smilies/s16.gif" alt="">
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=340609&amp;user=8830&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=19" class="addthx" data-post="340609"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2014 12:00 <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>kruasancheg пишет:<br>Я его поставил.Разве не видно??? </I><br>Раз 10 перечитал ваше сообщение и так не уловил сути вопроса. Так что каков вопрос - таков ответ.<br><br><I>soft пишет:<br>вместо MessageBoxA(0,&quot;test2&quot;,&quot;test2&quot;,MB_OK) вызывается Gate-&gt;MessageBoxExA(hWnd,&quot;NewMessageBoxA&quot;, lpCaption, uType, 0) просто как пример работы хука. MessageBoxExA можно убрать. если нужно вызывать оригинальную функу MessageBoxA, то в SetHOOK нужно сохранять оригинальные байты перед их изменением, а перед вызовом MessageBoxA восстанавливать их, после вызова опять ставить хук.  </I><br>Выделяем память, копируем в неё первые байты программы и после них лепим прыжок на оставшуюся часть функции. В начале похученной функции ставим переход на свой обработчик, а в его конце переход на выделенную память. Как-то красивее и надёжнее
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=340610&amp;user=2777&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=20" class="addthx" data-post="340610"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]kruasancheg[/b]','')">kruasancheg</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.25'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37183">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2014 13:19 &middot; Поправил: kruasancheg <br><script type="text/javascript">QU('kruasancheg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kruasancheg" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>daFix пишет:<br>Выделяем память, копируем в неё первые байты программы и после них лепим прыжок на оставшуюся часть функции. В начале похученной функции ставим переход на свой обработчик, а в его конце переход на выделенную память. Как-то красивее и надёжнее </I>А у меня как по вашему?Суть вопроса - ПОЧЕМУ ОНО ТАК НЕ РАБОТАЕТ.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340614&amp;user=37183&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=21" class="addthx" data-post="340614"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2014 13:33 <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>kruasancheg</b><br>Киньте скомпиленный файл
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=340615&amp;user=2777&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=22" class="addthx" data-post="340615"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]kruasancheg[/b]','')">kruasancheg</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.25'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37183">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2014 14:54 <br><script type="text/javascript">QU('kruasancheg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kruasancheg" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>daFix пишет:<br>kruasanchegКиньте скомпиленный файл </I><br><br><br><img src="img/attach.gif" alt=""> <a href="./files/2700_14.04.2014_EXELAB.rU.tgz">2700_14.04.2014_EXELAB.rU.tgz</a> - splaice.exe
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340617&amp;user=37183&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=23" class="addthx" data-post="340617"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2014 15:35 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
ну как минимум, обратный jmp внутрь MessageBoxExA промахивается на +5 байт<br>во-вторых копировать строго 5 байт - полнейший бред, потому что могут инструкции быть другие<br><br><I>kruasancheg пишет:<br>На +5 от чего?  </I><br>От того адреса, который должен быть
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340618&amp;user=3136&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=24" class="addthx" data-post="340618"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]kruasancheg[/b]','')">kruasancheg</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.25'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37183">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2014 15:42 <br><script type="text/javascript">QU('kruasancheg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kruasancheg" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>Veliant пишет:<br>ну как минимум, обратный jmp внутрь MessageBoxExA промахивается на +5 байт </I>На +5 от чего?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340619&amp;user=37183&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=25" class="addthx" data-post="340619"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2014 22:51 <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<b>kruasancheg</b><br>C:\Documents and Settings\1\Мои документы\Downloads\2700_14.04.2014_EXELAB.rU\splaice.exe не является приложением Win32.&quot;<br>Скомпильте без рантаймов, а то ни как не удаётся запустить
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=340653&amp;user=2777&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=26" class="addthx" data-post="340653"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 апреля 2014 00:35 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>daFix</b> см. DosHeader-&gt;OptionalHeader-&gt;MajorSubsystemVersin
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340655&amp;user=18316&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=27" class="addthx" data-post="340655"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=2777" title="14-04-2014 20:59, ранг:455.7" target="_blank">daFix</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 апреля 2014 01:34 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>kruasancheg</b><br>Чтобы не заморачиваться, можешь использовать конструкцию:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function">addr</span></li><li class="hl_l1"><span class="hl_function">ret</span></li>        </ol>
    </div>
</div></div>
<br>Тогда не будет проблем вычислением длины прыжка. <br><br>А вообще, сейчас у тебя тут ошибка<br><I>kruasancheg пишет:<br>jback-&gt;op=0xe9;<br>jback-&gt;adr=(FuncAdr+5) - ( ((DWORD)orig) +5);//возврат на тело оригинальной ф-ции<br> </I><br><br>Надо :<br>jback-&gt;op=0xe9;<br>jback-&gt;adr=FuncAdr - ( ((DWORD)orig) +5);
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=340658&amp;user=2777&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=28" class="addthx" data-post="340658"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 апреля 2014 02:28 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<b>kruasancheg</b><br><br>Сайда сурсы глянте, там патч реализован.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340663&amp;user=33727&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=29" class="addthx" data-post="340663"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]kruasancheg[/b]','')">kruasancheg</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.25'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37183">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 апреля 2014 09:16 <br><script type="text/javascript">QU('kruasancheg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kruasancheg" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22711.html&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
Спасибо всем кто про адрес написал.Сгуглил для себя алгоритм<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;_CalculateDispacement<span class="hl_char">(</span><span class="hl_function"><b>DWORD</b></span>&nbsp;lpFirst<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;lpSecond<span class="hl_char">,</span><span class="hl_function"><b>int</b></span>&nbsp;stubLen<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;lpSecond&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">(</span>lpFirst<span class="hl_char">)</span>&nbsp;<span class="hl_char">+</span>&nbsp;stubLen&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div>
<br>Теперь все как надо работает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=340745&amp;user=37183&amp;forum_n=6&amp;topic=22711.html&amp;page=0&amp;anchor=30" class="addthx" data-post="340745"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Сплайсинг.Вероятно плутаю с арифметикой адресов а может и нет.Подскажите.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="22711">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22711" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
