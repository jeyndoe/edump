<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Хочу перевести функцию работы со строками на асм вставки под delphi и максимально оптимизировать. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Хочу написать на асме вставки в процедуру для Дельфи которая приведённа ниже. Желательно конечно переписать полностью на асме. Работать должна с длинными строками более 255 символов. Смысл думаю понятен, выделяет строку по номеру">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Хочу перевести функцию работы со строками на асм вставки под delphi и максимально оптимизировать.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 октября 2009 15:44 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15137.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Хочу написать на асме вставки в процедуру для Дельфи которая приведённа ниже. Желательно конечно переписать полностью на асме. Работать должна с длинными строками более 255 символов. Смысл думаю понятен, выделяет строку по номеру через разделитель. Например GetSubStr(&#039;aaa:bb:c:ddd:e&#039;,&#039;:&#039;,2) вернёт строку bb, если разделителя не найдено возвращаем передаваемую строку в случае индекса 1, или пустую строку в случае другого. Если в строке нет элемента с таким номером, то пустую возвращаем. Так же хотелось бы сделать что бы разделитель был не обязательно однобайтовый...<br>В общем спрашиваю по тому, что возможно кто посоветует готовое решение или может даже подобная функция есть в дельфи, либо кто-то за пять минут черкнёт. Я в свою очередь тоже попытаюсь изобразить на асме это, но хотелось бы максимально оптимизировано, а я в этом не силён...<br>Приведённая функция работает сейчас хуже, чем описано как должна работать, но и этого в принципе достаточно, лишь бы шустро было...<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">function&nbsp;GetSubStr<span class="hl_char">(</span>st<span class="hl_char">:</span>string<span class="hl_comment">; expl:string; n:integer):string;</span></li><li class="hl_l1">Var&nbsp;p<span class="hl_char">,</span>i<span class="hl_char">:</span>integer<span class="hl_comment">;</span></li><li class="hl_l0">Begin</li><li class="hl_l1">for&nbsp;i<span class="hl_char">:</span><span class="hl_char">=</span><span class="hl_number">1</span>&nbsp;to&nbsp;n<span class="hl_char">-</span><span class="hl_number">1</span>&nbsp;do</li><li class="hl_l0">begin</li><li class="hl_l1">p<span class="hl_char">:</span><span class="hl_char">=</span>pos<span class="hl_char">(</span>expl<span class="hl_char">,</span>st<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">st<span class="hl_char">:</span><span class="hl_char">=</span>copy<span class="hl_char">(</span>st<span class="hl_char">,</span>p<span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">,</span>Length<span class="hl_char">(</span>st<span class="hl_char">)</span><span class="hl_char">-</span>p<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>pos<span class="hl_char">(</span>expl<span class="hl_char">,</span>st<span class="hl_char">)</span><span class="hl_char">=</span><span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_char">(</span>length<span class="hl_char">(</span>st<span class="hl_char">)</span><span class="hl_char">&gt;</span><span class="hl_number">0</span><span class="hl_char">)</span>&nbsp;do</li><li class="hl_l0">delete<span class="hl_char">(</span>st<span class="hl_char">,</span><span class="hl_number">1</span><span class="hl_char">,</span><span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">p<span class="hl_char">:</span><span class="hl_char">=</span>pos<span class="hl_char">(</span>expl<span class="hl_char">,</span>st<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>if</b></span>&nbsp;p<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span><span class="hl_number">0</span>&nbsp;then&nbsp;result<span class="hl_char">:</span><span class="hl_char">=</span>copy<span class="hl_char">(</span>st<span class="hl_char">,</span><span class="hl_number">1</span><span class="hl_char">,</span>p<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_function"><b>else</b></span>&nbsp;result<span class="hl_char">:</span><span class="hl_char">=</span>st<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>End</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=241669&amp;user=702&amp;forum_n=6&amp;topic=15137.html&amp;page=0&amp;anchor=1" class="addthx" data-post="241669"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 октября 2009 16:15 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15137.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Вроде эта функция , но на асм полностью ...<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">InString&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;startpos<span class="hl_char">:</span><span class="hl_function">DWORD</span><span class="hl_char">,</span>lpSource<span class="hl_char">:</span><span class="hl_function">DWORD</span><span class="hl_char">,</span>lpPattern<span class="hl_char">:</span><span class="hl_function">DWORD</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_comment">; ------------------------------------------------------------------</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_comment">; InString searches for a substring in a larger string and if it is</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_comment">; found, it returns its position in eax. </span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_comment">; It uses a one (1) based character index (1st character is 1,</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_comment">; 2nd is 2 etc...) for both the &quot;StartPos&quot; parameter and the returned</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_comment">; character position.</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_comment">; Return Values.</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_comment">; If the function succeeds, it returns the 1 based index of the start</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_comment">; of the substring.</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_comment">;  0 = no match found</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_comment">; -1 = substring same length or longer than main string</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_comment">; -2 = &quot;StartPos&quot; parameter out of range (less than 1 or longer than</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_comment">; main string)</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_comment">; ------------------------------------------------------------------</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LOCAL</b></span>&nbsp;sLen<span class="hl_char">:</span><span class="hl_function">DWORD</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LOCAL</b></span>&nbsp;pLen<span class="hl_char">:</span><span class="hl_function">DWORD</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;StrLen<span class="hl_char">,</span>lpSource</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;sLen<span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; source length</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;StrLen<span class="hl_char">,</span>lpPattern</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;pLen<span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; pattern length</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;startpos<span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jge</b></span>&nbsp;@F</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">2</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;isOut&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; exit if startpos not 1 or greater</span></li><li class="hl_l1">&nbsp;&nbsp;@@<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dec</b></span>&nbsp;startpos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; correct from 1 to 0 based index</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;sLen</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jl</b></span>&nbsp;@F</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;isOut&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; exit if pattern longer than source</span></li><li class="hl_l1">&nbsp;&nbsp;@@<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>sub</b></span>&nbsp;sLen<span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; don't read past string end</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;sLen</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;sLen</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;startpos</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jg</b></span>&nbsp;@F</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">2</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;isOut&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; exit if startpos is past end</span></li><li class="hl_l1">&nbsp;&nbsp;@@<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_comment">; ----------------</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_comment">; setup loop code</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_comment">; ----------------</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;lpSource</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;lpPattern</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; get 1st char in pattern</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>ecx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; add source length</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>neg</b></span>&nbsp;<span class="hl_registr"><b>ecx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; invert sign</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;startpos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; add starting offset</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;Scan_Loop</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>align</b></span>&nbsp;<span class="hl_number">16</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_comment">; @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;Pre_Scan<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;<span class="hl_registr"><b>ecx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; start on next byte</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;Scan_Loop<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span><span class="hl_registr">ecx</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; scan for 1st byte of pattern</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>je</b></span>&nbsp;Pre_Match&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; test if it matches</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>js</b></span>&nbsp;Scan_Loop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; exit on sign inversion</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;No_Match</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;Pre_Match<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span><span class="hl_registr">ecx</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; put current scan address in EBX</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;pLen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; put pattern length into EDX</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;Test_Match<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ah</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">+</span><span class="hl_registr">edx</span><span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; load last byte of pattern length in main string</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_registr">ah</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_registr">edx</span><span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; compare it with last byte in pattern</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jne</b></span>&nbsp;Pre_Scan&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; jump back on mismatch</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dec</b></span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jnz</b></span>&nbsp;Test_Match&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; 0 = match, fall through on match</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_comment">; @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;Match<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;sLen</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;isOut</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;No_Match<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;isOut<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">ret</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">InString&nbsp;<span class="hl_function">endp</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=241671&amp;user=3520&amp;forum_n=6&amp;topic=15137.html&amp;page=0&amp;anchor=2" class="addthx" data-post="241671"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]fakit[/b]','')">fakit</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 78.3 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1986">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 октября 2009 18:12 <br><script type="text/javascript">QU('fakit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=fakit" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15137.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
есть готовые модули, faststring, qstring И т.д.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=241675&amp;user=1986&amp;forum_n=6&amp;topic=15137.html&amp;page=0&amp;anchor=3" class="addthx" data-post="241675"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 октября 2009 18:42 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15137.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I><b>mak пишет</b>:<br>Вроде эта функция , но на асм полностью ... </I><br><br>Насколько я понял функция ищет позицию подстроки в основной строке с позиции указанной в startpos.<br>Это лишь часть алгоритма, но и его можно использовать дописав остальное. Мне одно не ясно, похоже этот код древний очень, почему не используются инструкции типа SCAS? Не похож он на вершину оптимизации...<br><br><I><b>fakit</b> пишет:<br>есть готовые модули, faststring, qstring И т.д. </I><br><br>Ищу сейчас. Если под рукой есть ссылки - буду признателен.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=241678&amp;user=702&amp;forum_n=6&amp;topic=15137.html&amp;page=0&amp;anchor=4" class="addthx" data-post="241678"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 октября 2009 19:48 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15137.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Вот нашёл интересный код на базе которого можно всё сделать:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>proc</b></span>&nbsp;search<span class="hl_char">,</span>_baseadr<span class="hl_char">,</span>_stradr<span class="hl_char">,</span>_basel<span class="hl_char">,</span>_strl</li><li class="hl_l1"><span class="hl_function">pushad</span></li><li class="hl_l0"><span class="hl_function">cld</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_char">[</span>_strl<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_char">[</span>_stradr<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;UpCases</li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span><span class="hl_char">[</span>_baseadr<span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; адрес базовой строки</span></li><li class="hl_l1"><span class="hl_char">.</span>NXTSE<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span><span class="hl_char">[</span>_stradr<span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; адрес искомой строки</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_char">[</span>_basel<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span><span class="hl_function">byte</span><span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">]</span><span class="hl_comment">; элемент</span></li><li class="hl_l1"><span class="hl_function"><b>repnz</b></span>&nbsp;<span class="hl_function">scasb</span></li><li class="hl_l0"><span class="hl_function"><b>jnz</b></span>&nbsp;<span class="hl_char">.</span>SEARTH_ERROR</li><li class="hl_l1"><span class="hl_function"><b>dec</b></span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span><span class="hl_char">[</span>_stradr<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_char">[</span>_strl<span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; длина строки</span></li><li class="hl_l0"><span class="hl_function"><b>repe</b></span>&nbsp;<span class="hl_function">cmpsb</span></li><li class="hl_l1"><span class="hl_function"><b>jnz</b></span>&nbsp;<span class="hl_char">.</span>NXTSE</li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_registr">edi</span></li><li class="hl_l1"><span class="hl_function"><b>sub</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_char">[</span>_strl<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_char">[</span>resylt<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_char">.</span>EXT</li><li class="hl_l0"><span class="hl_comment">;Строка найденна</span></li><li class="hl_l1"><span class="hl_char">.</span>SEARTH_ERROR<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_char">[</span>resylt<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_char">.</span>EXT<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_function">popad</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_char">[</span>resylt<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function">ret</span></li><li class="hl_l1">resylt&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_function">endp</span></li>        </ol>
    </div>
</div></div>
<br><br>Отсюда выкинуть UpCases, добавить смещение с которого начинать поиск, добавить индекс нужного элемента, если результат найден, инкрементировать счётчик найденных вхождений и сравнивать с индексом, как только равны - отрезаем от позиции подстроки+длина подстроки до следующей если есть или до конца. Так примерно?<br><br>p.s. Нашёл AcedStrings, как я понял дальнейшее развитие QStrings. Интересно, но нужно функции нет, есть из чего слепить, но хотелось бы всё в одной asm вставке...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=241688&amp;user=702&amp;forum_n=6&amp;topic=15137.html&amp;page=0&amp;anchor=5" class="addthx" data-post="241688"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ProTeuS[/b]','')">ProTeuS</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 172.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.96'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2281">Участник</a><br><font color=blue></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 октября 2009 19:55 <br><script type="text/javascript">QU('ProTeuS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ProTeuS" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15137.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
если не ошибаюсь<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;STROKA</li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;SubStr&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;strstr</li><li class="hl_l0"><span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">8</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>HOW MUCH BLOOD WOULD YOU SHED TO STAY ALIVE</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=241691&amp;user=2281&amp;forum_n=6&amp;topic=15137.html&amp;page=0&amp;anchor=6" class="addthx" data-post="241691"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 октября 2009 21:36 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15137.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Ну да , там можно задавать разные патерны , как ты и хотел , длинее , на выходе в есх длина слова , на еах расположение патерна. Пару строчек и код копируется откуда надо , длина кода известна , размер известен , начало тоже задается в начале кода. Копию делаешь как те угодно.<br><br>Код не старый , команды типа  lods, scas, movs медленее обычно , этот код был проверен и оттестирован тамерными макросами , и расчитан на скоростную оптимизацию но не размерную. Хочешь чтобы было быстрее задействуй сопроцессор. <br><br>Результаты старых тестов данной процедуры<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Intel<span class="hl_char">(</span>R<span class="hl_char">)</span>&nbsp;Core<span class="hl_char">(</span>TM<span class="hl_char">)</span><span class="hl_number">2</span>&nbsp;Duo&nbsp;CPU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E8500&nbsp;&nbsp;@&nbsp;<span class="hl_number">3</span><span class="hl_char">.</span>16GHz&nbsp;<span class="hl_char">(</span>SSE4<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Search&nbsp;<span class="hl_function"><b>Test</b></span>&nbsp;<span class="hl_number">1</span>&nbsp;<span class="hl_char">-</span>&nbsp;value&nbsp;expected&nbsp;<span class="hl_number">37</span><span class="hl_comment">; lenSrchPattern -&gt;22</span></li><li class="hl_l1">InString&nbsp;<span class="hl_char">-</span>&nbsp;JJ<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">38</span>&nbsp;<span class="hl_comment">; clocks: 99</span></li><li class="hl_l0">InString&nbsp;<span class="hl_char">-</span>&nbsp;Lingo<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">37</span>&nbsp;<span class="hl_comment">; clocks: 39</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Search&nbsp;<span class="hl_function"><b>Test</b></span>&nbsp;<span class="hl_number">2</span>&nbsp;<span class="hl_char">-</span>&nbsp;value&nbsp;expected&nbsp;<span class="hl_number">1007</span><span class="hl_comment">; lenSrchPattern -&gt;17</span></li><li class="hl_l1">InString&nbsp;<span class="hl_char">-</span>&nbsp;JJ<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1008</span>&nbsp;<span class="hl_comment">; clocks: 22567</span></li><li class="hl_l0">InString&nbsp;<span class="hl_char">-</span>&nbsp;Lingo<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1007</span>&nbsp;<span class="hl_comment">; clocks: 6294</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Search&nbsp;<span class="hl_function"><b>Test</b></span>&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_char">-</span>&nbsp;value&nbsp;expected&nbsp;<span class="hl_number">1008</span>&nbsp;<span class="hl_comment">;lenSrchPattern -&gt;16</span></li><li class="hl_l1">InString&nbsp;<span class="hl_char">-</span>&nbsp;JJ<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1009</span>&nbsp;<span class="hl_comment">; clocks: 712</span></li><li class="hl_l0">InString&nbsp;<span class="hl_char">-</span>&nbsp;Lingo<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1008</span>&nbsp;<span class="hl_comment">; clocks: 502</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Search&nbsp;<span class="hl_function"><b>Test</b></span>&nbsp;<span class="hl_number">4</span>&nbsp;<span class="hl_char">-</span>&nbsp;value&nbsp;expected&nbsp;<span class="hl_number">1008</span>&nbsp;<span class="hl_comment">;lenSrchPattern -&gt;16</span></li><li class="hl_l1">InString&nbsp;<span class="hl_char">-</span>&nbsp;JJ<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1009</span>&nbsp;<span class="hl_comment">; clocks: 6600</span></li><li class="hl_l0">InString&nbsp;<span class="hl_char">-</span>&nbsp;Lingo<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1008</span>&nbsp;<span class="hl_comment">; clocks: 1418</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Search&nbsp;<span class="hl_function"><b>Test</b></span>&nbsp;<span class="hl_number">5</span>&nbsp;<span class="hl_char">-</span>&nbsp;value&nbsp;expected&nbsp;<span class="hl_number">1008</span>&nbsp;<span class="hl_comment">;lenSrchPattern -&gt;16</span></li><li class="hl_l1">InString&nbsp;<span class="hl_char">-</span>&nbsp;JJ<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1009</span>&nbsp;<span class="hl_comment">; clocks: 5426</span></li><li class="hl_l0">InString&nbsp;<span class="hl_char">-</span>&nbsp;Lingo<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1008</span>&nbsp;<span class="hl_comment">; clocks: 1308</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Search&nbsp;<span class="hl_function"><b>Test</b></span>&nbsp;<span class="hl_number">6</span>&nbsp;<span class="hl_char">-</span>&nbsp;value&nbsp;expected&nbsp;<span class="hl_number">1008</span>&nbsp;<span class="hl_comment">;lenSrchPattern -&gt;16</span></li><li class="hl_l1">InString&nbsp;<span class="hl_char">-</span>&nbsp;JJ<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1009</span>&nbsp;<span class="hl_comment">; clocks: 629</span></li><li class="hl_l0">InString&nbsp;<span class="hl_char">-</span>&nbsp;Lingo<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1008</span>&nbsp;<span class="hl_comment">; clocks: 498</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Search&nbsp;<span class="hl_function"><b>Test</b></span>&nbsp;<span class="hl_number">7</span>&nbsp;<span class="hl_char">-</span>&nbsp;value&nbsp;expected&nbsp;<span class="hl_number">1009</span>&nbsp;<span class="hl_comment">;lenSrchPattern -&gt;14</span></li><li class="hl_l1">InString&nbsp;<span class="hl_char">-</span>&nbsp;JJ<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1010</span>&nbsp;<span class="hl_comment">; clocks: 625</span></li><li class="hl_l0">InString&nbsp;<span class="hl_char">-</span>&nbsp;Lingo<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1009</span>&nbsp;<span class="hl_comment">; clocks: 502</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Search&nbsp;<span class="hl_function"><b>Test</b></span>&nbsp;<span class="hl_number">8</span>&nbsp;<span class="hl_char">-</span>&nbsp;value&nbsp;expected&nbsp;<span class="hl_number">1001</span>&nbsp;<span class="hl_comment">;lenSrchPattern -&gt;1</span></li><li class="hl_l1">InString&nbsp;<span class="hl_char">-</span>&nbsp;JJ<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">0</span>&nbsp;<span class="hl_comment">; clocks: 781</span></li><li class="hl_l0">InString&nbsp;<span class="hl_char">-</span>&nbsp;Lingo<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1001</span>&nbsp;<span class="hl_comment">; clocks: 102</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Search&nbsp;<span class="hl_function"><b>Test</b></span>&nbsp;<span class="hl_number">9</span>&nbsp;<span class="hl_char">-</span>&nbsp;value&nbsp;expected&nbsp;<span class="hl_number">1001</span>&nbsp;<span class="hl_comment">;lenSrchPattern -&gt;2</span></li><li class="hl_l1">InString&nbsp;<span class="hl_char">-</span>&nbsp;JJ<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1002</span>&nbsp;<span class="hl_comment">; clocks: 611</span></li><li class="hl_l0">InString&nbsp;<span class="hl_char">-</span>&nbsp;Lingo<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1001</span>&nbsp;<span class="hl_comment">; clocks: 512</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Search&nbsp;<span class="hl_function"><b>Test</b></span>&nbsp;<span class="hl_number">10</span>&nbsp;<span class="hl_char">-</span>&nbsp;value&nbsp;expected&nbsp;<span class="hl_number">1001</span>&nbsp;<span class="hl_comment">;lenSrchPattern -&gt;3</span></li><li class="hl_l1">InString&nbsp;<span class="hl_char">-</span>&nbsp;JJ<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1002</span>&nbsp;<span class="hl_comment">; clocks: 625</span></li><li class="hl_l0">InString&nbsp;<span class="hl_char">-</span>&nbsp;Lingo<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1001</span>&nbsp;<span class="hl_comment">; clocks: 435</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Search&nbsp;<span class="hl_function"><b>Test</b></span>&nbsp;<span class="hl_number">11</span>&nbsp;<span class="hl_char">-</span>&nbsp;value&nbsp;expected&nbsp;<span class="hl_number">1001</span>&nbsp;<span class="hl_comment">;lenSrchPattern -&gt;4</span></li><li class="hl_l1">InString&nbsp;<span class="hl_char">-</span>&nbsp;JJ<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1002</span>&nbsp;<span class="hl_comment">; clocks: 635</span></li><li class="hl_l0">InString&nbsp;<span class="hl_char">-</span>&nbsp;Lingo<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1001</span>&nbsp;<span class="hl_comment">; clocks: 496</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Search&nbsp;<span class="hl_function"><b>Test</b></span>&nbsp;<span class="hl_number">12</span>&nbsp;<span class="hl_char">-</span>&nbsp;value&nbsp;expected&nbsp;<span class="hl_number">1001</span>&nbsp;<span class="hl_comment">;lenSrchPattern -&gt;5</span></li><li class="hl_l1">InString&nbsp;<span class="hl_char">-</span>&nbsp;JJ<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1002</span>&nbsp;<span class="hl_comment">; clocks: 795</span></li><li class="hl_l0">InString&nbsp;<span class="hl_char">-</span>&nbsp;Lingo<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1001</span>&nbsp;<span class="hl_comment">; clocks: 638</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Search&nbsp;<span class="hl_function"><b>Test</b></span>&nbsp;<span class="hl_number">13</span>&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span>Find&nbsp;<span class="hl_quote">'Duplicate inc'</span>&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;<span class="hl_quote">'windows.inc'</span>&nbsp;<span class="hl_comment">;lenSrchPattern -&gt;13</span></li><li class="hl_l1">InString&nbsp;<span class="hl_char">-</span>&nbsp;JJ<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1127625</span>&nbsp;<span class="hl_comment">; clocks: 679836</span></li><li class="hl_l0">InString&nbsp;<span class="hl_char">-</span>&nbsp;Lingo<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1127624</span>&nbsp;<span class="hl_comment">; clocks: 543385</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Press&nbsp;<span class="hl_function"><b>ENTER</b></span>&nbsp;to&nbsp;exit<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=241696&amp;user=3520&amp;forum_n=6&amp;topic=15137.html&amp;page=0&amp;anchor=7" class="addthx" data-post="241696"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]RUNaum[/b]','')">RUNaum</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 25.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.56'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8541">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 октября 2009 21:51 <br><script type="text/javascript">QU('RUNaum','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=RUNaum" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15137.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
FastProject ;)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=241697&amp;user=8541&amp;forum_n=6&amp;topic=15137.html&amp;page=0&amp;anchor=8" class="addthx" data-post="241697"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]SLV[/b]','')">SLV</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 309.8 (мудрец), 21thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.69'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=663">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 октября 2009 22:18 <br><script type="text/javascript">QU('SLV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SLV" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15137.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
ntdll!strstr<br>shlwapi!StrStrIA<br>shlwapi!StrStrIW
<br><br><font size="1"><i>-----<br>Shalom ebanats!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=241699&amp;user=663&amp;forum_n=6&amp;topic=15137.html&amp;page=0&amp;anchor=9" class="addthx" data-post="241699"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Хочу перевести функцию работы со строками на асм вставки под delphi и максимально оптимизировать.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#10" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="15137">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15137" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
