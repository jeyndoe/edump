<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>ASPack+PECompact - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем привет. Только начинаю сейчас изучать реверсинг и пока только на распаковке простых пакеров. У меня есть файл, который запакован PECompact 1.68 - 1.84 -&gt; Jeremy Collake и еще сверху ASPack 2.12 -&gt; Alexey Solodovnikov.">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> ASPack+PECompact</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]deepred[/b]','')">deepred</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 81.5 (постоянный), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.25'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4389">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2006 17:56 <br><script type="text/javascript">QU('deepred','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=deepred" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Всем привет.<img src="img/smilies/s1.gif" alt=""> Только начинаю сейчас изучать реверсинг и пока только на распаковке простых пакеров. У меня есть файл, который запакован PECompact 1.68 - 1.84 -&gt; Jeremy Collake и еще сверху ASPack 2.12 -&gt; Alexey Solodovnikov. Распаковать вроде ерунда, но я завис уже на восстановлении импорта в ASPack. OEP нашел точно (это 100%), и когда ввожу его (с учетом Image Base) и нажимаю на IAT, то результата нет<img src="img/smilies/s4.gif" alt=""> - импорт не дает. Вот я и хотел спросить у вас, как можно получить этот импорт? Может нужен какой-нибудь плагин для ImpREC?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=78205&amp;user=4389&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=1" class="addthx" data-post="78205"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]deepred[/b]','')">deepred</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 81.5 (постоянный), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.25'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4389">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2006 17:59 <br><script type="text/javascript">QU('deepred','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=deepred" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Забыл. <img src="img/smilies/s15.gif" alt=""> Вот собственно сам файл:
<br>ФАЙЛ http://rapidshare.de/files/23403963/DebugApiSpy.rar.html
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=78206&amp;user=4389&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=2" class="addthx" data-post="78206"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Mifodix[/b]','')">Mifodix</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/2892.gif" alt=""><br><span class=txtSm>Ранг: 116.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.71'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2892">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2006 18:11 <br><script type="text/javascript">QU('Mifodix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mifodix" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>deepred пишет:
<br>и нажимаю на IAT, то результата нет - импорт не дает </I>
<br>А &quot;Get Imports&quot; нажать?<img src="img/smilies/s1.gif" alt="">))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=78208&amp;user=2892&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=3" class="addthx" data-post="78208"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2006 18:19 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
а зачем у аспака импорт восстанавливать? распакуй сразу всё и восстанови уже в конце <img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=78212&amp;user=72&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=4" class="addthx" data-post="78212"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]deepred[/b]','')">deepred</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 81.5 (постоянный), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.25'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4389">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2006 18:44 <br><script type="text/javascript">QU('deepred','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=deepred" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Mifodix пишет:
<br>А &quot;Get Imports&quot; нажать?)) </I>
<br>Ну, естественно нажимаю, но выдает только не валидные значения.
<br><I>Hellspawn пишет:
<br>а зачем у аспака импорт восстанавливать? распаку сразу всё и восстанови уже в конце </I>
<br>Не. Мне надо именно с восстановлением импорта, как говорится на будущее, чтобы знать как решается данная проблема.)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=78215&amp;user=4389&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=5" class="addthx" data-post="78215"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]deepred[/b]','')">deepred</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 81.5 (постоянный), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.25'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4389">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2006 00:24 &middot; Поправил: deepred <br><script type="text/javascript">QU('deepred','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=deepred" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Уважаемые! Ну так мне кто-нибудь может объяснить как это сделать?<img src="img/smilies/s4.gif" alt=""> Файл весит всего 183 КБ.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=78255&amp;user=4389&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=6" class="addthx" data-post="78255"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Bat[/b]','')">Bat</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/1474.gif" alt=""><br><span class=txtSm>Ранг: 71.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.32'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1474">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2006 02:41 &middot; Поправил: Bat <br><script type="text/javascript">QU('Bat','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bat" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>deepred</b>
<br>Кроме ASPack сверху ничё не увидел <img src="img/smilies/s4.gif" alt="">
<br>OEP: 0043DDE3
<br>Импорт обычно восстанавливается, правда после этого прога запускается выдает заставку и закрывается.
<br>Может проверяет на распакованость или еще что. Не смотрел. Спать охота.
<br>После распаковки PЕId говорит Microsoft Visual C++ 6.0.
<br>Распакованый файл в аттаче.
<br>[edited]
<br>Нет там 2 упаковщика, это я ошибся. Про востановление импорта в PECompact почитай <a href="http://exelab.ru/art/?action=view&amp;id=206" target="_blank">тут</a>
<br>
<br><img src="img/attach.gif" alt=""> <a href="./files/643a_19.06.2006_CRACKLAB.rU.tgz">643a_19.06.2006_CRACKLAB.rU.tgz</a> - dump.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=78262&amp;user=1474&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=7" class="addthx" data-post="78262"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2006 07:25 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Да нифига. Ни в ASpack ни в PECompact  ImpREC не нужен. Про PECompact я писал, про ASPack тоже есть.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=78277&amp;user=3232&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=8" class="addthx" data-post="78277"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]deepred[/b]','')">deepred</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 81.5 (постоянный), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.25'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4389">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2006 13:58 <br><script type="text/javascript">QU('deepred','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=deepred" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Спасибо, ребята. Но мне нужна именно методика, как получить правильный импорт.
<br>Что я делаю:
<br>Нахожу OEP. <b>Bat</b>, он кстати у меня равен не 0043DDE3, а 004680F0. Дальше делаю дамп, открываю ImpREC забиваю в OEP 000680F0 (Image Base = 00400000), нажимаю IAT и он пишет: &quot;Could not find anything good at this OEP!<img src="img/smilies/s9.gif" alt="">&quot;
<br>Вот на этом я и застопорился, ведь должен был сказать, что все нормально и типа парень теперь можешь нажать &quot;Get Imports&quot;. OEP правильный - делал несколькими способами и через скрипты.
<br><b>PE_Kill</b>
<br>Спасибо за статьи, но как я уже говорил мне нужно именно понять, поэтому нужна методика именно с импортом.<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=78332&amp;user=4389&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=9" class="addthx" data-post="78332"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Mifodix[/b]','')">Mifodix</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/2892.gif" alt=""><br><span class=txtSm>Ранг: 116.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.71'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2892">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июня 2006 15:06 &middot; Поправил: Mifodix <br><script type="text/javascript">QU('Mifodix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mifodix" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>deepred пишет:
<br>Нахожу OEP. Bat, он кстати у меня равен не 0043DDE3, а 004680F0. </I>
<br>Вот отсюда у тебя проблемы и пошли: 004680F0 - это неверный ОЕП. Верный же 0043DDE3.
<br>Как я доходил до ОЕП:
<br>1) ставил железный бряк hr esp-4
<br>2) жал ф9 пока не оказался на стандартном начале для прог на Microsoft Visual C++ 6.0
<br>Ну а дальше дамп, импрек...
<br>У меня всё получилось, можешь посмотреть вложение<img src="img/smilies/s1.gif" alt="">
<br>++++++++++
<br>атач не прекрепился, но выше уже выгладывали распакованный фаил.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=78336&amp;user=2892&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=10" class="addthx" data-post="78336"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2006 14:31 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>deepred пишет:
<br>кстати у меня равен не 0043DDE3, а 004680F0 </I>
<br>004680F0 - это ты нашел так сказать промежуточный OEP
<br>Ведь ты сам определил, что прога упакована двумя пакерами, и 004680F0 это &quot;OEP&quot; после ASPack&#039;а.(и восстановление импорта в этом месте ничего не даст)
<br>Дальше начинается PECompact. Протрассируй до этого места
<br>0046E550  50                        PUSH EAX
<br>0046E551  68 E3DD4300       PUSH 0043DDE3
<br>0046E556  C2 0400               RETN 4                     ; переход на OEP
<br>сымай дамп и восстанавливай импорт. Он там как на ладони RVA  47000;  Size  610h
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=78525&amp;user=423&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=11" class="addthx" data-post="78525"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]deepred[/b]','')">deepred</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 81.5 (постоянный), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.25'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4389">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2006 16:26 <br><script type="text/javascript">QU('deepred','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=deepred" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Ребята, всем спасибо.<img src="img/smilies/s1.gif" alt="">
<br><b>crc1</b>
<br>А вот если я не знаю, где мне надо остановиться, то как узнать, что я дойду до правильного места, если буду трассировать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=78539&amp;user=4389&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=12" class="addthx" data-post="78539"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Mifodix[/b]','')">Mifodix</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/2892.gif" alt=""><br><span class=txtSm>Ранг: 116.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.71'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2892">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июня 2006 17:13 <br><script type="text/javascript">QU('Mifodix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mifodix" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>deepred пишет:
<br>то как узнать, что я дойду до правильного места, если буду трассировать? </I>
<br>Со временем ты научишься определять оеп визуально. Загрузи проги написанные на делфи(или каком-то другом языке) в отладчик и ты заметишь, что у всех у них есть сходные последовательности команд рядом с точкой входа. Потом попробуй проги на другом языке. У них тоже будут похожие начала. А затем, снимая пакер, ты будешь не только определять оеп это ли нет, но и на каком языке написано.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=78544&amp;user=2892&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=13" class="addthx" data-post="78544"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июня 2006 15:59 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>deepred пишет:
<br>А вот если я не знаю, где мне надо остановиться </I>
<br>Ну во первых <b>Mifodix</b> дал тебе хороший совет (можешь даже создать колекцию стартового кода с различных компиляторов). Во вторых, смотри в каком адресном пространстве ты находишся во время трассировки. И если видишь переход в секцию где содержится код программы (code), то с большой долей вероятности можешь предположить, что ты на OEP. И эта прога как нельзя лучше демонстрирует сие.
<br>Memory map
<br>Address         Size           Owner      Section       Contains                   
<br>00400000   00001000   DebugApi                     PE header            
<br>00401000   00063000   DebugApi   pec1           code                      
<br>00464000   0000D000   DebugApi   .rsrc           data,resources         
<br>00471000   00001000   DebugApi   .rsrc                                    
<br>00472000   00003000   DebugApi   .aspack       SFX,imports,relocations   
<br>00475000   00001000   DebugApi   .adata                                  
<br>Сначала выполнение программы идет в секции .aspack 
<br><code>004723B7  C2 0C00          RETN 0C
<br>004723BA  68 F0804600       PUSH 004680F0
<br>004723BF  C3                        RETN</code>              &gt; тут переход в секцию .rsrc и это явно не OEP, а переход в др. пакер
<br><code>0046E550  50                     PUSH EAX
<br>0046E551  68 E3DD4300        PUSH 0043DDE3
<br>0046E556  C2 0400                RETN 4</code>          &gt; а вот тут переход в секцию pec1, где содержится код программы -  это OEP. Есть случаи, когда часть кода от OEP воруется и выполняется в другой секции, но это уже другая сказка<img src="img/smilies/s5.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=78796&amp;user=423&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=14" class="addthx" data-post="78796"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 июня 2006 14:09 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>deepred</b> Как успехи-то. Ты, наверное, застрял на pecompact ?!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=79970&amp;user=4072&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=15" class="addthx" data-post="79970"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]deepred[/b]','')">deepred</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 81.5 (постоянный), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.25'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4389">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 июня 2006 21:32 <br><script type="text/javascript">QU('deepred','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=deepred" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=5340.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>tundra37</b>
<br>Нет, все в порядке, все понял. Всем спасиб.<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=80226&amp;user=4389&amp;forum_n=5&amp;topic=5340.html&amp;page=0&amp;anchor=16" class="addthx" data-post="80226"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> ASPack+PECompact</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#17" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="5340">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=5340" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
