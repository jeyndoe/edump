<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите пожалуйста выдрать криптоалгоритм для The Bat! из UnPass(The Bat!) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте. Проблема заключается в том что программа, написана на делфи, запакована юпиксом + изменена точка входа(насколько я понял). Помучившись, я её все таки распаковал, путём выдирания распакованного кода из памяти и">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите пожалуйста выдрать криптоалгоритм для The Bat! из UnPass(The Bat!)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=1&amp;topic=14768&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=1&amp;topic=14768&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Youlupukki[/b]','')">Youlupukki</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.97'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=21765">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2009 23:34 <br><script type="text/javascript">QU('Youlupukki','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Youlupukki" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=14768&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте. Проблема заключается в том что программа, написана на делфи, запакована юпиксом + изменена точка входа(насколько я понял). Помучившись, я её все таки распаковал, путём выдирания распакованного кода из памяти и добавлением кривой таблицы импорта(Программа QuickUnpack v2.1).<br>Далее возникли проблемы в отладчике(OllyDBG).  Оригинальная точка входа у меня не определяется и программа при первой загрузке в отладчика останавливается на первом встречном int 3 в ntdll. Ну, поклацав F9 я попадаю в оригинальный процесс, останавливаясь тоже непонятно где(ну якобы на оригинальной точке входа, определённой QUnpack)<br>Ещё проблема в том, что у меня кривая таблица импорта, т.е. я не могу посмотреть полный список импортируемых ф-ций(ну чтобы забрейкпоинтить в нужном месте разумеется)<br>Аттачь распакованной программы прилагается, + Ссылка на оригинальную запакованную<br>[url= <a href="http://www.exelab.ru/download.php?action=get&amp;n=NDkw" target="_new">http://www.exelab.ru/download.php?action=get&amp;n=NDkw</a> <a href="http://www.exelab.ru/download.php?action=get&amp;n=NDkw" target="_new">http://www.exelab.ru/download.php?action=get&amp;n=NDkw</a> [/url] <br>Теперь вопросы по выдиранию алгоритма:<br>В  программе я нахожу такую строку (кстати таких несколько)&quot;+-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstu vwxyz&quot; ставлю на неё бряк, выполняю программу, ввожу пароль, нажимаю «Зашифровать», бряк не срабатывает, нажимаю «Расшифровать» - бряк сработал – Нахожусь в середине цикла с кучей call’ов, имею зашифрованную строку с паролем в стеке, расшифрованного пароля ещё нет)) Хотя я не уверен что<br>И с этого места  я пытался анализировать что происходит, но так и не допёр. Бегло транслируя через большое количество команд, можно увидеть как по кускам расшифровывается мой пароль но из-за большого количество отвлекающих джампов и каллов я теряюсь. Причём через стек в функции ничего не передаётся! Там всё через регистры и адреса стека. Каким то образом получилось забрекпоинтить прогу при запросе на расшифровку пароля – адрес «004616B1» в стеке имею пароль, и над ним загадочную строчку…<br>0012F1C0   009A64FC  ASCII &quot;#.(?-+&quot;<br>0012F1C4   009A02B4  ASCII &quot;qwerty&quot;<br>Откуда появляется это строка разобраться не смог, но по видимому это ключ. При различных паролях он разный.<br>По шифру:<br>1.	Длинна шифра меняется при различной длине пароля, но при одинаковой длине, имеется статическая часть и динамическая например: <br>yTzzzmAi81wh8k++         «qwerty»<br> yTzzzn6xD1sdCk++         «asdfgh»<br>yTzzznEs91YW6+++         «zxcvbn»<br>Если, кому не трудно, помогите распаковать программу по-человечески, или укажите адрес команды с которого начинается непосредственное шифрование/дешифрование, я уж постараюсь разобраться! В общем, за любую помощь, советы - буду благодарен.<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/b0a7_22.07.2009_CRACKLAB.rU.tgz">b0a7_22.07.2009_CRACKLAB.rU.tgz</a> - tbup__.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=236355&amp;user=21765&amp;forum_n=1&amp;topic=14768&amp;page=1&amp;anchor=1" class="addthx" data-post="236355"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Youlupukki[/b]','')">Youlupukki</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.97'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=21765">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 июля 2009 22:43 <br><script type="text/javascript">QU('Youlupukki','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Youlupukki" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=14768&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
Вот алгоритм декода. <br>Писал на JS(!!!) так как ща не со своего компьютера и нет компилятора.. кароче мне так удобней было))<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">pass&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">'yTzzzmAi81wh8k++'</span><span class="hl_comment">;</span></li><li class="hl_l1">function&nbsp;base64_decode<span class="hl_char">(</span>&nbsp;<span class="hl_function">data</span><span class="hl_char">,</span>a1<span class="hl_char">,</span>a2<span class="hl_char">,</span>a3&nbsp;<span class="hl_char">)</span>&nbsp;{&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>ф<span class="hl_char">-</span>ция&nbsp;декода&nbsp;base&nbsp;<span class="hl_number">64</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;b64&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;+-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;o1<span class="hl_char">,</span>&nbsp;o2<span class="hl_char">,</span>&nbsp;o3<span class="hl_char">,</span>&nbsp;h1<span class="hl_char">,</span>&nbsp;h2<span class="hl_char">,</span>&nbsp;h3<span class="hl_char">,</span>&nbsp;h4<span class="hl_char">,</span>&nbsp;bits<span class="hl_char">,</span>&nbsp;i<span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;enc<span class="hl_char">=</span><span class="hl_quote">''</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;do&nbsp;{&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>начало<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h1&nbsp;<span class="hl_char">=</span>&nbsp;b64<span class="hl_char">.</span>indexOf<span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">.</span>charAt<span class="hl_char">(</span>i<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h2&nbsp;<span class="hl_char">=</span>&nbsp;b64<span class="hl_char">.</span>indexOf<span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">.</span>charAt<span class="hl_char">(</span>i<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h3&nbsp;<span class="hl_char">=</span>&nbsp;b64<span class="hl_char">.</span>indexOf<span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">.</span>charAt<span class="hl_char">(</span>i<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h4&nbsp;<span class="hl_char">=</span>&nbsp;b64<span class="hl_char">.</span>indexOf<span class="hl_char">(</span><span class="hl_function">data</span><span class="hl_char">.</span>charAt<span class="hl_char">(</span>i<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bits&nbsp;<span class="hl_char">=</span>&nbsp;h1<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span><span class="hl_number">18</span>&nbsp;<span class="hl_char">|</span>&nbsp;h2<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span><span class="hl_number">12</span>&nbsp;<span class="hl_char">|</span>&nbsp;h3<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span><span class="hl_number">6</span>&nbsp;<span class="hl_char">|</span>&nbsp;h4<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o1&nbsp;<span class="hl_char">=</span>&nbsp;bits<span class="hl_char">&gt;</span><span class="hl_char">&gt;</span><span class="hl_number">16</span>&nbsp;<span class="hl_char">&amp;</span>&nbsp;0xff<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o2&nbsp;<span class="hl_char">=</span>&nbsp;bits<span class="hl_char">&gt;</span><span class="hl_char">&gt;</span><span class="hl_number">8</span>&nbsp;<span class="hl_char">&amp;</span>&nbsp;0xff<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o3&nbsp;<span class="hl_char">=</span>&nbsp;bits&nbsp;<span class="hl_char">&amp;</span>&nbsp;0xff<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>h3&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">64</span><span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enc&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;String<span class="hl_char">.</span>fromCharCode<span class="hl_char">(</span>o1<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>h4&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">64</span><span class="hl_char">)</span>&nbsp;enc&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;String<span class="hl_char">.</span>fromCharCode<span class="hl_char">(</span>o1<span class="hl_char">,</span>&nbsp;o2<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enc&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;String<span class="hl_char">.</span>fromCharCode<span class="hl_char">(</span>o1<span class="hl_char">,</span>&nbsp;o2<span class="hl_char">,</span>&nbsp;o3<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>i&nbsp;<span class="hl_char">&lt;</span>&nbsp;<span class="hl_function">data</span><span class="hl_char">.</span>length<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;enc<span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l0">function&nbsp;endDECOD&nbsp;<span class="hl_char">(</span>b6d<span class="hl_char">)</span>{<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Ф<span class="hl_char">-</span>ция&nbsp;окончательного&nbsp;декода</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;декодированный&nbsp;base64&nbsp;пароль&nbsp;представляет&nbsp;собой&nbsp;строку<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;f9&nbsp;ff&nbsp;ff&nbsp;ff&nbsp;<span class="hl_number">23</span>&nbsp;<span class="hl_number">2e</span>&nbsp;<span class="hl_number">28</span>&nbsp;<span class="hl_number">3f</span>&nbsp;<span class="hl_number">2d</span>&nbsp;<span class="hl_number">2b</span>&nbsp;<span class="hl_char">(</span>hex<span class="hl_char">)</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>где<span class="hl_char">,</span>&nbsp;первые&nbsp;<span class="hl_number">4</span><span class="hl_char">-</span>е&nbsp;байта&nbsp;это&nbsp;<span class="hl_function"><b>neg</b></span>&nbsp;<span class="hl_char">-</span>&nbsp;от&nbsp;длинны&nbsp;пароля</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;а&nbsp;остальные&nbsp;байты&nbsp;это&nbsp;перевёрнутый&nbsp;пароль&nbsp;ксореный&nbsp;с&nbsp;<span class="hl_number">5A</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l0">len&nbsp;<span class="hl_char">=</span>&nbsp;0xFF<span class="hl_char">-</span>b6d<span class="hl_char">.</span>charCodeAt<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;//Определяем длинну пароля( вычитаем из FF первый код символа)</span></li><li class="hl_l1">pass&nbsp;<span class="hl_char">=</span>&nbsp;b6d<span class="hl_char">.</span>substr<span class="hl_char">(</span><span class="hl_number">4</span><span class="hl_char">,</span>b6d<span class="hl_char">.</span>length<span class="hl_char">)</span><span class="hl_comment">;// Считываем ксореный пароль(первые 4-е байта не учитываю)</span></li><li class="hl_l0">b&nbsp;<span class="hl_char">=</span>&nbsp;0x5A<span class="hl_comment">;</span></li><li class="hl_l1">res<span class="hl_char">=</span><span class="hl_char">[</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">enc<span class="hl_char">=</span><span class="hl_quote">''</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;поскольку&nbsp;пароль&nbsp;перевёрнутый<span class="hl_char">,</span>&nbsp;то&nbsp;начинаем&nbsp;с&nbsp;конца</li><li class="hl_l0">for&nbsp;<span class="hl_char">(</span>i<span class="hl_char">=</span>len<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;i!=-1; i--){</span></li><li class="hl_l1">res<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">=</span>pass<span class="hl_char">.</span>charCodeAt<span class="hl_char">(</span>i<span class="hl_char">)</span>^b<span class="hl_comment">;//Ксорим</span></li><li class="hl_l0">enc<span class="hl_char">+</span><span class="hl_char">=</span>String<span class="hl_char">.</span>fromCharCode<span class="hl_char">(</span>res<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;// переводим в символьный вид</span></li><li class="hl_l1">}</li><li class="hl_l0">return&nbsp;enc<span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">WScript<span class="hl_char">.</span>Echo<span class="hl_char">(</span>endDECOD<span class="hl_char">(</span>base64_decode<span class="hl_char">(</span>pass<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>Можете проверить через стандартный виндовс скрипт хост, просто сохраните в .js и запустите.(для тех кто не вкурсе)<br>Писал по быстрому, небрежно, к томуже на js, но посторался закоментировать.<br><br><br>p/s <br>А чем тут кого троянщики не  устраивают? Крекинг это тоже не совсем законное и порядочное дело.<br>Траянописатели - это двигатель прогресса!))))))))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=236594&amp;user=21765&amp;forum_n=1&amp;topic=14768&amp;page=1&amp;anchor=2" class="addthx" data-post="236594"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=1&amp;topic=14768&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=1&amp;topic=14768&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите пожалуйста выдрать криптоалгоритм для The Bat! из UnPass(The Bat!)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#3" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="14768">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=14768" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
