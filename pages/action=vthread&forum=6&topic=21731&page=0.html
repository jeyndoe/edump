<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>RtlCreateUserThread - приложение падает с ошибкой 0xC0000005 - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Собственно, у меня проблема подобная на рассматриваемую в этой теме. Только я пишу на C# и система Windows 8 x64. Хочу в каком-то другом процессе вывести сообщение &quot;Hello world&quot;. Вот код: Code:      ">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a>, <a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> RtlCreateUserThread - приложение падает с ошибкой 0xC0000005</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]AlexSun[/b]','')">AlexSun</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34785">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 13:38 &middot; Поправил: AlexSun <br><script type="text/javascript">QU('AlexSun','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexSun" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Собственно, у меня проблема подобная на рассматриваемую в <noindex><a href="http://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20597" rel="nofollow" target="_blank">этой</a></noindex> теме.<br>Только я пишу на C# и система Windows 8 x64.<br>Хочу в каком-то другом процессе вывести сообщение &quot;Hello world&quot;. Вот код:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>public</b></span>&nbsp;partial&nbsp;class&nbsp;Form1&nbsp;<span class="hl_char">:</span>&nbsp;Form</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span>DllImport<span class="hl_char">(</span><span class="hl_quote">&quot;kernel32.dll&quot;</span><span class="hl_char">)</span><span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;extern&nbsp;IntPtr&nbsp;OpenProcess<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;dwDesiredAccess<span class="hl_char">,</span>&nbsp;bool&nbsp;bInheritHandle<span class="hl_char">,</span>&nbsp;uint&nbsp;dwProcessId<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">[</span>DllImport<span class="hl_char">(</span><span class="hl_quote">&quot;user32.dll&quot;</span><span class="hl_char">)</span><span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>static&nbsp;extern&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;MessageBox<span class="hl_char">(</span>IntPtr&nbsp;hWnd<span class="hl_char">,</span>&nbsp;String&nbsp;text<span class="hl_char">,</span>&nbsp;String&nbsp;caption<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;options<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span>DllImport<span class="hl_char">(</span><span class="hl_quote">&quot;ntdll.dll&quot;</span><span class="hl_char">)</span><span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>public</b></span>&nbsp;static&nbsp;extern&nbsp;uint&nbsp;RtlCreateUserThread<span class="hl_char">(</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_function">In</span><span class="hl_char">]</span>&nbsp;IntPtr&nbsp;Process<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_function">In</span><span class="hl_char">]</span>&nbsp;IntPtr&nbsp;ThreadSecurityDescriptor<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_function">In</span><span class="hl_char">]</span>&nbsp;bool&nbsp;CreateSuspended<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_function">In</span><span class="hl_char">]</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;StackZeroBits<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">[</span><span class="hl_function">In</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">[</span>Optional<span class="hl_char">]</span>&nbsp;IntPtr&nbsp;MaximumStackSize<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint&nbsp;MaximumStackSize<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_function">In</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">[</span>Optional<span class="hl_char">]</span>&nbsp;IntPtr&nbsp;InitialStackSize<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_function">In</span><span class="hl_char">]</span>&nbsp;IntPtr&nbsp;StartAddress<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_function">In</span><span class="hl_char">]</span>&nbsp;IntPtr&nbsp;Parameter<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_function">Out</span><span class="hl_char">]</span>&nbsp;<span class="hl_function"><b>out</b></span>&nbsp;IntPtr&nbsp;Thread<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_function">Out</span><span class="hl_char">]</span>&nbsp;<span class="hl_function"><b>out</b></span>&nbsp;ClientId&nbsp;ClientId</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span>StructLayout<span class="hl_char">(</span>LayoutKind<span class="hl_char">.</span>Sequential<span class="hl_char">)</span><span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>public</b></span>&nbsp;struct&nbsp;ClientId</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>public</b></span>&nbsp;ClientId<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;processId<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;threadId<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">this</span><span class="hl_char">.</span>UniqueProcess&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;IntPtr<span class="hl_char">(</span>processId<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">this</span><span class="hl_char">.</span>UniqueThread&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;IntPtr<span class="hl_char">(</span>threadId<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>public</b></span>&nbsp;IntPtr&nbsp;UniqueProcess<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>public</b></span>&nbsp;IntPtr&nbsp;UniqueThread<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>public</b></span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;ProcessId&nbsp;{&nbsp;get&nbsp;{&nbsp;return&nbsp;<span class="hl_function">this</span><span class="hl_char">.</span>UniqueProcess<span class="hl_char">.</span>ToInt32<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">; } }</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>public</b></span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;ThreadId&nbsp;{&nbsp;get&nbsp;{&nbsp;return&nbsp;<span class="hl_function">this</span><span class="hl_char">.</span>UniqueThread<span class="hl_char">.</span>ToInt32<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">; } }</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>public</b></span>&nbsp;Form1<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitializeComponent<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>public</b></span>&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;HelloWorld<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox<span class="hl_char">.</span>Show<span class="hl_char">(</span><span class="hl_quote">&quot;Hello world&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>MessageBox<span class="hl_char">(</span>IntPtr<span class="hl_char">.</span>Zero<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;test&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;test&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>public</b></span>&nbsp;delegate&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;HelloProcess<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;button1_Click<span class="hl_char">(</span>object&nbsp;sender<span class="hl_char">,</span>&nbsp;EventArgs&nbsp;e<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;инъекция</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntPtr&nbsp;hProc&nbsp;<span class="hl_char">=</span>&nbsp;OpenProcess<span class="hl_char">(</span>0x001F0FFF<span class="hl_char">,</span>&nbsp;<span class="hl_function">false</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">3740</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HelloProcess&nbsp;managedMethod&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;HelloProcess<span class="hl_char">(</span>HelloWorld<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Delegate&nbsp;untypedManagedMethod&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>Delegate<span class="hl_char">)</span>managedMethod<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntPtr&nbsp;nativeThunk&nbsp;<span class="hl_char">=</span>&nbsp;Marshal<span class="hl_char">.</span>GetFunctionPointerForDelegate<span class="hl_char">(</span>untypedManagedMethod<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntPtr&nbsp;thread&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;IntPtr<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientId&nbsp;clientid&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;ClientId<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint&nbsp;res&nbsp;<span class="hl_char">=</span>&nbsp;RtlCreateUserThread<span class="hl_char">(</span>hProc<span class="hl_char">,</span>&nbsp;IntPtr<span class="hl_char">.</span>Zero<span class="hl_char">,</span>&nbsp;<span class="hl_function">false</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">4096</span><span class="hl_char">,</span>&nbsp;IntPtr<span class="hl_char">.</span>Zero<span class="hl_char">,</span>&nbsp;nativeThunk<span class="hl_char">,</span>&nbsp;IntPtr<span class="hl_char">.</span>Zero<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>out</b></span>&nbsp;thread<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>out</b></span>&nbsp;clientid<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li>        </ol>
    </div>
</div></div>
<br>Другое приложение падает с ошибкой 0xC0000005. RtlCreateUserThread возвращает 0, thread и clientid инициализируются. Приложения x64.<br>Экспериментирую на notepad.exe, пока что руками пишу его pid в OpenProcess.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324352&amp;user=34785&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=1" class="addthx" data-post="324352"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]AlexSun[/b]','')">AlexSun</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34785">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 14:16 <br><script type="text/javascript">QU('AlexSun','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexSun" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
notepad.exe:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Сигнатура&nbsp;проблемы<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;Имя&nbsp;события&nbsp;проблемы<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;BEX64</li><li class="hl_l0">&nbsp;&nbsp;Имя&nbsp;приложения<span class="hl_char">:</span>&nbsp;notepad<span class="hl_char">.</span>exe</li><li class="hl_l1">&nbsp;&nbsp;Версия&nbsp;приложения<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6</span><span class="hl_char">.</span><span class="hl_number">2</span><span class="hl_char">.</span><span class="hl_number">9200</span><span class="hl_char">.</span><span class="hl_number">16384</span></li><li class="hl_l0">&nbsp;&nbsp;Отметка&nbsp;времени&nbsp;приложения<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">501099bc</span></li><li class="hl_l1">&nbsp;&nbsp;Имя&nbsp;модуля&nbsp;с&nbsp;ошибкой<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;StackHash_5177</li><li class="hl_l0">&nbsp;&nbsp;Версия&nbsp;модуля&nbsp;с&nbsp;ошибкой<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_number">0</span></li><li class="hl_l1">&nbsp;&nbsp;Отметка&nbsp;времени&nbsp;модуля&nbsp;с&nbsp;ошибкой<span class="hl_char">:</span>&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0">&nbsp;&nbsp;Смещение&nbsp;исключения<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCH_0B_FROM_ntdll<span class="hl_char">+</span>0x000000000000315B</li><li class="hl_l1">&nbsp;&nbsp;Код&nbsp;исключения<span class="hl_char">:</span>&nbsp;c0000005</li><li class="hl_l0">&nbsp;&nbsp;Данные&nbsp;исключения<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0000000000000008</span></li><li class="hl_l1">&nbsp;&nbsp;Версия&nbsp;ОС<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6</span><span class="hl_char">.</span><span class="hl_number">2</span><span class="hl_char">.</span><span class="hl_number">9200</span><span class="hl_char">.</span><span class="hl_number">2</span><span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_number">256</span><span class="hl_char">.</span><span class="hl_number">48</span></li><li class="hl_l0">&nbsp;&nbsp;Код&nbsp;языка<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">1049</span></li><li class="hl_l1">&nbsp;&nbsp;Дополнительные&nbsp;сведения&nbsp;<span class="hl_number">1</span><span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">5177</span></li><li class="hl_l0">&nbsp;&nbsp;Дополнительные&nbsp;сведения&nbsp;<span class="hl_number">2</span><span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">51772aac790a45f41f2d59c789eb0956</span></li><li class="hl_l1">&nbsp;&nbsp;Дополнительные&nbsp;сведения&nbsp;<span class="hl_number">3</span><span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6812</span></li><li class="hl_l0">&nbsp;&nbsp;Дополнительные&nbsp;сведения&nbsp;<span class="hl_number">4</span><span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">681265a696a429762844460fc751bcb1</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=324354&amp;user=34785&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=2" class="addthx" data-post="324354"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.6 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 14:19 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Ничего что nativeThunk находится в адресном пространстве совсем не того процесса, в котором вы создаете поток?
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=324355&amp;user=11966&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=3" class="addthx" data-post="324355"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]AlexSun[/b]','')">AlexSun</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34785">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 14:24 <br><script type="text/javascript">QU('AlexSun','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexSun" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Использовать VirtualAllocEx &amp; WriteProcessMemory? Как с помощью WriteProcessMemory записать один метод?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324356&amp;user=34785&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=4" class="addthx" data-post="324356"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.52'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 14:31 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>AlexSun пишет:<br>Использовать VirtualAllocEx &amp; WriteProcessMemory? Как с помощью WriteProcessMemory записать один метод?  </I><br>http://www.programmersforum.ru/showthread.php?t=93673
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=324358&amp;user=31056&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=5" class="addthx" data-post="324358"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]tomac[/b]','')">tomac</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 65.3 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.82'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6470">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 мая 2013 00:27 <br><script type="text/javascript">QU('tomac','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tomac" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
ДЛЛ пиши, подгружай в АП цели, и будет счастье. <br>Передача указателя на свою обертку вокруг managed-метода - жесть. Даже если скопировать этот метод в АП цели (хз как), всё равно там ведь не будет всей .NET FW подгруженной, не будет ВМ. В общем, запускать managed-код в АП нативного приложения - имхо, жуткий изврат.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324533&amp;user=6470&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=6" class="addthx" data-post="324533"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]AlexSun[/b]','')">AlexSun</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34785">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 мая 2013 23:23 &middot; Поправил: AlexSun <br><script type="text/javascript">QU('AlexSun','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexSun" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>r_e</b><br>Написал так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">IntPtr&nbsp;nativeThunk&nbsp;<span class="hl_char">=</span>&nbsp;GetProcAddress<span class="hl_char">(</span>GetModuleHandle<span class="hl_char">(</span><span class="hl_quote">&quot;ntdll.dll&quot;</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;RtlExitUserProcess&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>Работает. RtlExitUserProcess находится в том же адресном пространстве, что и notepad?<br><br>А так не работает:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">IntPtr&nbsp;nativeThunk&nbsp;<span class="hl_char">=</span>&nbsp;GetProcAddress<span class="hl_char">(</span>LoadLibrary<span class="hl_char">(</span><span class="hl_quote">&quot;D:\hello.dll&quot;</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;HelloAlexSun&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>Та же C0000005.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324961&amp;user=34785&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=7" class="addthx" data-post="324961"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]AlexSun[/b]','')">AlexSun</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34785">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 мая 2013 23:38 &middot; Поправил: AlexSun <br><script type="text/javascript">QU('AlexSun','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexSun" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Загружаю функцию из своей DLL на С++ в чужой процесс, все возвращаемые значения ок, RtlCreateUserThread возвращает 0, чужой процесс падает с ошибкой 0xC0000005...<br>Итого код:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;button1_Click<span class="hl_char">(</span>object&nbsp;sender<span class="hl_char">,</span>&nbsp;EventArgs&nbsp;e<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;инъекция</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntPtr&nbsp;hProc&nbsp;<span class="hl_char">=</span>&nbsp;OpenProcess<span class="hl_char">(</span>0x001F0FFF<span class="hl_char">,</span>&nbsp;<span class="hl_function">false</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1260</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntPtr&nbsp;thread&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;IntPtr<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientId&nbsp;clientid&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;ClientId<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>IntPtr&nbsp;nativeThunk&nbsp;<span class="hl_char">=</span>&nbsp;GetProcAddress<span class="hl_char">(</span>GetModuleHandle<span class="hl_char">(</span><span class="hl_quote">&quot;ntdll.dll&quot;</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;RtlExitUserProcess&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntPtr&nbsp;nativeThunk&nbsp;<span class="hl_char">=</span>&nbsp;GetProcAddress<span class="hl_char">(</span>LoadLibrary<span class="hl_char">(</span><span class="hl_quote">&quot;D:\hello.dll&quot;</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;HelloAlexSun&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">byte</span><span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;bytes&nbsp;<span class="hl_char">=</span>&nbsp;Encoding<span class="hl_char">.</span>ASCII<span class="hl_char">.</span>GetBytes<span class="hl_char">(</span><span class="hl_quote">&quot;D:\hello.dll&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntPtr&nbsp;alloc&nbsp;<span class="hl_char">=</span>&nbsp;VirtualAllocEx<span class="hl_char">(</span>hProc<span class="hl_char">,</span>&nbsp;IntPtr<span class="hl_char">.</span>Zero<span class="hl_char">,</span>&nbsp;bytes<span class="hl_char">.</span>Length<span class="hl_char">,</span>&nbsp;MemoryState<span class="hl_char">.</span>Commit&nbsp;<span class="hl_char">|</span>&nbsp;MemoryState<span class="hl_char">.</span>Reserve<span class="hl_char">,</span>&nbsp;MemoryProtection<span class="hl_char">.</span>ReadWrite<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;written<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;write&nbsp;<span class="hl_char">=</span>&nbsp;WriteProcessMemory<span class="hl_char">(</span>hProc<span class="hl_char">,</span>&nbsp;alloc<span class="hl_char">,</span>&nbsp;bytes<span class="hl_char">,</span>&nbsp;bytes<span class="hl_char">.</span>Length<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>out</b></span>&nbsp;written<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint&nbsp;res&nbsp;<span class="hl_char">=</span>&nbsp;RtlCreateUserThread<span class="hl_char">(</span>hProc<span class="hl_char">,</span>&nbsp;IntPtr<span class="hl_char">.</span>Zero<span class="hl_char">,</span>&nbsp;<span class="hl_function">false</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">4096</span><span class="hl_char">,</span>&nbsp;IntPtr<span class="hl_char">.</span>Zero<span class="hl_char">,</span>&nbsp;alloc<span class="hl_char">,</span>&nbsp;IntPtr<span class="hl_char">.</span>Zero<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>out</b></span>&nbsp;thread<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>out</b></span>&nbsp;clientid<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox<span class="hl_char">.</span>Show<span class="hl_char">(</span>res<span class="hl_char">.</span>ToString<span class="hl_char">(</span><span class="hl_quote">&quot;X&quot;</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>        </ol>
    </div>
</div></div>
<br>У кого какие мысли?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324962&amp;user=34785&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=8" class="addthx" data-post="324962"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]UnameR[/b]','')">UnameR</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.51'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=23805">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 мая 2013 23:53 &middot; Поправил: UnameR <br><script type="text/javascript">QU('UnameR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=UnameR" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
alloc это у тебя адрес строки, а ты на него поток создаешь...<br>Тебе поток надо создавать на адрес LoadLibrary и StartParameter как alloc<br>Так ты свою библиотеку загрузишь в чужой процесс. <br><br>Потом можно как-нибудь получить базу твоей загруженой либы.<br>Ну а там адрес нужной функции легко уже можно вычислить и создать поток.<br><br>&gt;&gt;Работает. RtlExitUserProcess находится в том же адресном пространстве, что и notepad?<br>kernel32 user32 ntdll и некоторые другие для всех процессов имеют одинаковую базу (с оптимизацией связанно, CopyOnWrite)<br><br>Твоя либа каждый раз при загрузке на новом месте. Да и плюс её может просто не быть в процессе нужном.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324964&amp;user=23805&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=9" class="addthx" data-post="324964"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]AlexSun[/b]','')">AlexSun</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34785">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 мая 2013 23:57 &middot; Поправил: AlexSun <br><script type="text/javascript">QU('AlexSun','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexSun" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>UnameR</b><br>Код можно? Или четкую последовательность действий... А то не очень понял.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324966&amp;user=34785&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=10" class="addthx" data-post="324966"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]AlexSun[/b]','')">AlexSun</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34785">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 мая 2013 00:07 <br><script type="text/javascript">QU('AlexSun','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexSun" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Кажется, понял о чем ты. Переписал:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;button1_Click<span class="hl_char">(</span>object&nbsp;sender<span class="hl_char">,</span>&nbsp;EventArgs&nbsp;e<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;инъекция</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntPtr&nbsp;hProc&nbsp;<span class="hl_char">=</span>&nbsp;OpenProcess<span class="hl_char">(</span>0x001F0FFF<span class="hl_char">,</span>&nbsp;<span class="hl_function">false</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">3560</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntPtr&nbsp;thread&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;IntPtr<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientId&nbsp;clientid&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;ClientId<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>IntPtr&nbsp;nativeThunk&nbsp;<span class="hl_char">=</span>&nbsp;GetProcAddress<span class="hl_char">(</span>GetModuleHandle<span class="hl_char">(</span><span class="hl_quote">&quot;ntdll.dll&quot;</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;RtlExitUserProcess&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntPtr&nbsp;nativeThunk&nbsp;<span class="hl_char">=</span>&nbsp;GetProcAddress<span class="hl_char">(</span>LoadLibrary<span class="hl_char">(</span><span class="hl_quote">&quot;D:\hello.dll&quot;</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;HelloAlexSun&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">byte</span><span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;bytes&nbsp;<span class="hl_char">=</span>&nbsp;Encoding<span class="hl_char">.</span>ASCII<span class="hl_char">.</span>GetBytes<span class="hl_char">(</span><span class="hl_quote">&quot;D:\hello.dll&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntPtr&nbsp;alloc&nbsp;<span class="hl_char">=</span>&nbsp;VirtualAllocEx<span class="hl_char">(</span>hProc<span class="hl_char">,</span>&nbsp;IntPtr<span class="hl_char">.</span>Zero<span class="hl_char">,</span>&nbsp;bytes<span class="hl_char">.</span>Length<span class="hl_char">,</span>&nbsp;MemoryState<span class="hl_char">.</span>Commit&nbsp;<span class="hl_char">|</span>&nbsp;MemoryState<span class="hl_char">.</span>Reserve<span class="hl_char">,</span>&nbsp;MemoryProtection<span class="hl_char">.</span>ReadWrite<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;written<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;write&nbsp;<span class="hl_char">=</span>&nbsp;WriteProcessMemory<span class="hl_char">(</span>hProc<span class="hl_char">,</span>&nbsp;alloc<span class="hl_char">,</span>&nbsp;bytes<span class="hl_char">,</span>&nbsp;bytes<span class="hl_char">.</span>Length<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>out</b></span>&nbsp;written<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntPtr&nbsp;lr&nbsp;<span class="hl_char">=</span>&nbsp;LoadLibrary<span class="hl_char">(</span><span class="hl_quote">&quot;kernel32.dll&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntPtr&nbsp;load&nbsp;<span class="hl_char">=</span>&nbsp;GetProcAddress<span class="hl_char">(</span>lr<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;LoadLibraryA&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint&nbsp;res&nbsp;<span class="hl_char">=</span>&nbsp;RtlCreateUserThread<span class="hl_char">(</span>hProc<span class="hl_char">,</span>&nbsp;IntPtr<span class="hl_char">.</span>Zero<span class="hl_char">,</span>&nbsp;<span class="hl_function">false</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">4096</span><span class="hl_char">,</span>&nbsp;load<span class="hl_char">,</span>&nbsp;alloc<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>out</b></span>&nbsp;thread<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>out</b></span>&nbsp;clientid<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>MessageBox<span class="hl_char">.</span>Show<span class="hl_char">(</span>res<span class="hl_char">.</span>ToString<span class="hl_char">(</span><span class="hl_quote">&quot;X&quot;</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>        </ol>
    </div>
</div></div>
<br>Теперь чужой процесс не падает, но моя функция из dll не выполняется. Код dll:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#include&nbsp;<span class="hl_char">&lt;</span>Windows<span class="hl_char">.</span>h<span class="hl_char">&gt;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">BOOL&nbsp;APIENTRY&nbsp;DllMain<span class="hl_char">(</span>&nbsp;HMODULE&nbsp;hModule<span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>DWORD</b></span>&nbsp;&nbsp;ul_reason_for_call<span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPVOID&nbsp;lpReserved</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;<span class="hl_char">(</span>ul_reason_for_call<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;DLL_PROCESS_ATTACH<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;DLL_THREAD_ATTACH<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;DLL_THREAD_DETACH<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;DLL_PROCESS_DETACH<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>break</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>TRUE</b></span><span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;extern&nbsp;<span class="hl_quote">&quot;C&quot;</span>&nbsp;__declspec<span class="hl_char">(</span>dllexport<span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;_cdecl&nbsp;HelloAlexSun<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBoxA<span class="hl_char">(</span><span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;Hello, AlexSun!&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;Test&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=324968&amp;user=34785&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=11" class="addthx" data-post="324968"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]UnameR[/b]','')">UnameR</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.51'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=23805">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 мая 2013 00:32 &middot; Поправил: UnameR <br><script type="text/javascript">QU('UnameR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=UnameR" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Расшифровка шел кода:<br>01405301 E8 00000000    CALL 01405306<br>01405306     58                   POP EAX<br>01405307     83C0 16              ADD EAX,0x16<br>0140530A     50                   PUSH EAX<br>0140530B     50                   PUSH EAX<br>0140530C     FF50 FC              CALL DWORD PTR DS:[EAX-0x4]<br>0140530F     59                   POP ECX<br>01405310     8941 F8              MOV DWORD PTR DS:[ECX-0x8],EAX<br>01405313     C3                   RETN<br>DD сюда запишется база твоей либы<br>DD сюда надо записать адрес LoadLibrary<br>Дальше null-terminated путь до либы (D:\hello.dll например)<br><br><br>Псевдокод:<br>	unsigned char ddd[] = <span style="word-break: break-all">&quot;\xE8\x00\x00\x00\x00\x58\x83\xC0\x16\x50\x50\xFF\x50\xFC\x59\x89\x41\xF8\xC3\x00\x00\x00\x00\x00\x00\x00\x00C:&#92;Hello.dll\x00&quot;;</span><br>	unsigned char *dd = ddd;<br>	*((unsigned int*)(dd+23)) = (unsigned int)GetProcAddress(GetModuleHandleA(&quot;kernel32.dll&quot;), &quot;LoadLibraryA&quot;);<br>	unsigned char *alloc = VirtualAllocEx(hProc, 0, sizeof(ddd), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTEREADWRITE);<br>	WriteProcessMemory(hProc, alloc, ddd, sizeof(ddd), written);<br>	RtlCreateUserThread(на alloc без параметра);<br>	int fff = 0;<br>	ReadProcessMemory(hProc, alloc+19, &amp;fff, 4, readen);<br>	fff будет содержать базу твоей либы в новом процессе<br>	myBASE = LoadLibrary(&quot;D:\hello.dll&quot;);<br>	XAddr = GetProcAddress(myBASE, &quot;HelloAlexSun&quot;)-myBASE ;<br>	RtlCreateUserThread(создать поток на fff+XAddr);<br><br>Не проверял, но идея должна быть понятна
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324969&amp;user=23805&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=12" class="addthx" data-post="324969"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 мая 2013 05:19 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
&gt; Теперь чужой процесс не падает<br><br>Должен падать, так как тред нэйтивный(зачем хз) и возвращается на 0:0.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=325151&amp;user=33727&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=13" class="addthx" data-post="325151"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Alchemistry[/b]','')">Alchemistry</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 145.8 (ветеран), 191thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.05'>Активность: 0.14<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=21411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 мая 2013 14:09 <br><script type="text/javascript">QU('Alchemistry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alchemistry" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>Dr0p</b><br>Пора уже слезть с виндоус хп и открыть для себя NT6X и x64. Функционал этой рутины существенно отличается в современных версиях венды от того как он выглядел в гавне мамонта, см. матчасть NtCreateThreadEx. Твой пост не имеет смысла.<br><br><b>AlexSun</b><br>Инжекты длл через RtlCreateUserThread осилили даже на autoit-e, что говорит о том что у вас кривой код.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=325168&amp;user=21411&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=14" class="addthx" data-post="325168"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.52'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 мая 2013 15:59 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>AlexSun пишет:<br>У кого какие мысли?  </I><br><br>http://www.delphisources.ru/pages/sources/system/2010-year/dll-injector.html<br><br><I>Alchemistry пишет:<br>Пора уже слезть с виндоус хп </I><br><br>Не нужно.
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=325180&amp;user=31056&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=15" class="addthx" data-post="325180"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=33253" title="23-05-2013 18:20, ранг:11.2" target="_blank">Abraham</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Alchemistry[/b]','')">Alchemistry</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 145.8 (ветеран), 191thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.05'>Активность: 0.14<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=21411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 мая 2013 05:26 <br><script type="text/javascript">QU('Alchemistry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alchemistry" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>hors</b><br>NtCreateThreadEx нет в Windows XP. И тема про инжект в Windows 8, CreateRemoteThread там работать не будет. И смысл твоего поста? Еще раз показать какой ты дурак?<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=325250&amp;user=21411&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=16" class="addthx" data-post="325250"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.52'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 мая 2013 11:08 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>Alchemistry пишет:<br>И тема про инжект в Windows 8, CreateRemoteThread там работать не будет </I><br><br>Всё там работает. <noindex><a href="http://nagareshwar.securityxploded.com/2012/09/07/dll-injection-and-windows-8/" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br><I>Alchemistry пишет:<br>И смысл твоего поста? Еще раз показать какой ты дурак?  </I><br><br>Почти в каждом своём сообщении Вы жалуетесь на то, что плохо понимаете смысл, который окружающие Вас люди пытаются до Вас донести.<br>Не переживайте, на начальном этапе легкие расстройства прекрасно лечатся. Главное вовремя принять меры, чтобы не мучать себя и близких родственников.
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=325266&amp;user=31056&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=17" class="addthx" data-post="325266"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=33727" title="22-05-2013 13:48, ранг:0.3" target="_blank">Dr0p</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 мая 2013 17:49 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>hors</b><br>Мну ему ответил, но аверы/модеры покиляли мой пост. Тут киляется всё негодное. Вы должны петь дифирамбы им, иначе вас забанят :D
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=325289&amp;user=33727&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=18" class="addthx" data-post="325289"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 мая 2013 18:39 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
клерк вали к себе
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=325290&amp;user=15381&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=19" class="addthx" data-post="325290"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 мая 2013 19:51 &middot; Поправил: Dr0p <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=21731.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
reversecode<br><br>Там тролить некого, все банятся <img src="img/smilies/s9.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=325354&amp;user=33727&amp;forum_n=6&amp;topic=21731.html&amp;page=0&amp;anchor=20" class="addthx" data-post="325354"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> RtlCreateUserThread - приложение падает с ошибкой 0xC0000005</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#21" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="21731">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=21731" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
