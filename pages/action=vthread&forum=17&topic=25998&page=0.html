<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Создание защищенного канала в GlobalPlatfom на sim карте от Gemalto - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброго времени суток, столкнулся с весьма специфической проблемой. Даже не знаю к кому обратиться за помощью. Надеюсь, не сильно промахнулся с форумом =). Имеется sim карта производства Gemalto. На борту JavaCard 3,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=242'>Alf</a>, <a target='_blank' href='?action=userinfo&amp;user=21426'>Dart Raiden</a>, <a target='_blank' href='?action=userinfo&amp;user=55930'>bedop66938</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/rt.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=17&sortBy=0&page=0.html"><b>Электроника</b></a> <b class=bulletHead>&#8212;&#8250;</b> Создание защищенного канала в GlobalPlatfom на sim карте от Gemalto</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]OneUser[/b]','')">OneUser</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 0.92'>Активность: 0.01=0.01</span><br>Статус: <a href="action=userinfo&amp;user=50733">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 августа 2019 21:23 <br><script type="text/javascript">QU('OneUser','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OneUser" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=25998.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброго времени суток, столкнулся с весьма специфической проблемой. Даже не знаю к кому обратиться за помощью. Надеюсь, не сильно промахнулся с форумом =). Имеется sim карта  производства Gemalto. На борту JavaCard 3, GlobalPlatform 2.2.1. , ATR=3B9F96C00A1FC68031E073FE211F65D00233131B810FFA. При попытке создать защищенное соединение выдает ошибку 0x6985 (Conditions of use not satisfied). Пример выполнение скрипта с GPShell:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">select&nbsp;<span class="hl_char">-</span>AID&nbsp;A000000151000000</li><li class="hl_l1">Command&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">00A4040008A000000151000000</span></li><li class="hl_l0">Wrapped&nbsp;command&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">00A4040008A000000151000000</span></li><li class="hl_l1">Response&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;<span class="hl_number"><span style="word-break: break-all">6F7E8408A000000151000000A572736306072A864886FC6B01600B06092A864886FC6B020202630906072A864886FC6B03640B06092A864886FC6B048000640B06092A864886FC6B040255650E060C2A864886FC6B0506010000016616060A2B060104012A026E0103060847544F303034011C9F6E0600773136011C9F6501FF9000</span></span></li><li class="hl_l0">command&nbsp;time<span class="hl_char">:</span>&nbsp;<span class="hl_number">31</span>&nbsp;ms</li><li class="hl_l1">open_sc&nbsp;<span class="hl_char">-</span>scp&nbsp;<span class="hl_number">1</span>&nbsp;<span class="hl_char">-</span>scpimpl&nbsp;0x55&nbsp;<span class="hl_char">-</span>security&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_char">-</span>keyind&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_char">-</span>keyver&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_char">-</span>key&nbsp;<span class="hl_number">404142434445464748494a4b4c4d4e4f</span></li><li class="hl_l0">Command&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">8050000008DD7D31C4F9E9D20D00</span></li><li class="hl_l1">Wrapped&nbsp;command&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">8050000008DD7D31C4F9E9D20D00</span></li><li class="hl_l0">Response&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;<span class="hl_number">6985</span></li><li class="hl_l1">mutual_authentication<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;returns&nbsp;0x80206985&nbsp;<span class="hl_char">(</span><span class="hl_number">6985</span><span class="hl_char">:</span>&nbsp;Command&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;allowed&nbsp;<span class="hl_char">-</span>&nbsp;Conditions&nbsp;of&nbsp;use&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;satisfied<span class="hl_char">.</span><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br>При использовании GlobalPlatformPro получаю такие же результаты. Ругается именно на команду INITIALIZE UPDATE. Облазил всю доступную документацию и интернет ресурсы и нашел зацепку:<br><br>If a secure channel is currently active on a logical channel other than the logical channel on which this command (Initialize Update command) was issued, a response of &#039;6985&#039; is returned.<br><br>Попробовал посылать ее в каналы 81 82 83 84, но толку ноль. Дальше я зашел в тупик. Может тут кто может подсказать? Во всяком случае, спасибо за внимание.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=397182&amp;user=50733&amp;forum_n=17&amp;topic=25998.html&amp;page=0&amp;anchor=1" class="addthx" data-post="397182"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]sfinks_2002[/b]','')">sfinks_2002</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.44'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=9632">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 августа 2019 18:32 <br><script type="text/javascript">QU('sfinks_2002','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sfinks_2002" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=25998.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Я обычно вот так создаю защищенный канал<br><br>open_sc -security 1 -keyind 0 -keyver 0 -mac_key 404142434445464748494a4b4c4d4e4f -enc_key 404142434445464748494a4b4c4d4e4f -kek_key 404142434445464748494A4B4C4D4E4F -scp 02 -scpimpl 0x15 // Open secure channel
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=397191&amp;user=9632&amp;forum_n=17&amp;topic=25998.html&amp;page=0&amp;anchor=2" class="addthx" data-post="397191"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]OneUser[/b]','')">OneUser</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 0.92'>Активность: 0.01=0.01</span><br>Статус: <a href="action=userinfo&amp;user=50733">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 августа 2019 01:15 <br><script type="text/javascript">QU('OneUser','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OneUser" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=25998.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
разобрался =) надо было указать -keyver=32 и  -scp 2.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=397248&amp;user=50733&amp;forum_n=17&amp;topic=25998.html&amp;page=0&amp;anchor=3" class="addthx" data-post="397248"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/rt.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=17&sortBy=0&page=0.html"><b>Электроника</b></a> <b class=bulletHead>&#8212;&#8250;</b> Создание защищенного канала в GlobalPlatfom на sim карте от Gemalto</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=25998" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
