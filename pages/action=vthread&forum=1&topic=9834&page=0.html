<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Лоадер не тормозит прогу. Почему? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Есть прога накрытая StarForce v.3.4.49.1 Сделал лоадер, тормознул на OEP, дамп, импорт и все ОК, старфос отломан. Вышла новая версия проги. Версия стара 3.4.76.0 Опять делаю лоадер, но прога на OEP не тормозитцо, а запускается.">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55853'>rtsgreg1989</a>, <a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Лоадер не тормозит прогу. Почему?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=1&amp;topic=9834&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=1&amp;topic=9834&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 11:53 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Есть прога накрытая StarForce v.3.4.49.1  Сделал лоадер, тормознул на OEP, дамп, импорт и все ОК, старфос отломан. Вышла новая версия проги. Версия стара  3.4.76.0  Опять делаю лоадер, но прога на OEP не тормозитцо, а запускается. Аттачусь к проге, смотрю на OEP байты EBFEh, т.е. прога в памяти пропатчена, а не тормозится<img src="img/smilies/s14.gif" alt=""> Впечатление такое, что прога проскакивает OEP до пропатчивания.<br>Может кто-нить че посоветует<br>OEP нашел 100%  Прога на делфях. Вот исходник лодера<br>.486 <br>.model flat, stdcall<br>option casemap :none <br><br>include \masm32\include\windows.inc<br>include \masm32\include\masm32.inc<br>include \masm32\include\user32.inc<br>include \masm32\include\kernel32.inc<br><br>includelib \masm32\lib\masm32.lib<br>includelib \masm32\lib\user32.lib<br>includelib \masm32\lib\kernel32.lib<br>        <br>    .data<br>        hWnd        dd 0<br>               <br>App db &quot;Error&quot;,0 <br>Err1 db &quot;Program not found &quot;,0 <br>prog db &quot;C:\Program Files\AD\AD.exe&quot;,0 <br><br>bufwr DWORD 0EBh <br>bufwr1 DWORD 0FEh<br><br>va DWORD 0074E03Ch <br>va1 DWORD 0074E03Dh <br><br><br>.data?<br>bufr dw ? <br>pinfo PROCESS_INFORMATION &lt;&gt; <br>sinfo STARTUPINFO &lt;&gt; <br>n DWORD ? <br><br>    .code<br><br>start:<br><br>invoke CreateProcess,addr prog,NULL,NULL,NULL,FALSE,NULL,NULL,NULL,addr sinfo,addr pinfo <br><br>.IF eax == 0 <br>    invoke MessageBox,NULL,addr Err1,addr App,MB_OK <br>    invoke ExitProcess,0 <br>.ENDIF<br>.WHILE TRUE <br>invoke ReadProcessMemory,pinfo.hProcess,va,addr bufr,1,n <br>.IF eax != 0 <br>.IF bufr == 055h <br>    invoke SuspendThread,addr pinfo.hThread <br>    invoke WriteProcessMemory,pinfo.hProcess,va,addr bufwr,1,n <br>    invoke WriteProcessMemory,pinfo.hProcess,va1,addr bufwr1,1,n <br>    invoke ResumeThread,addr pinfo.hThread <br>    invoke CloseHandle,pinfo.hThread <br>    invoke ExitProcess,0 <br>.ENDIF<br>.ENDIF<br>.ENDW<br><br>end start
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155835&amp;user=423&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=1" class="addthx" data-post="155835"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 12:09 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Конечно, метод не фонтан просто брать и читать. Вполне может и проскочить, ибо синхронизация вообще отсутствует как таковая. Как вариант-подними приоритет лоадера, будет чаще читать, меньше вероятность, что проскочит. А в идеале-надо ставить бряки на функи какие-нить и синхронизировать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155837&amp;user=1556&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=2" class="addthx" data-post="155837"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 12:19 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>Archer пишет:<br>Как вариант-подними приоритет лоадера </I><br>Как это можно реализовать. Подскажи
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155840&amp;user=423&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=3" class="addthx" data-post="155840"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]seeq[/b]','')">seeq</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3067.jpg" alt=""><br><span class=txtSm>Ранг: 105.9 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.64'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3067">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 12:22 <br><script type="text/javascript">QU('seeq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=seeq" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
нда, удивительно, что первый раз такое сработало. Я бы на твоем месте сделал бы перехват какой-нибудь  функи (VirtualAlloc, LoadLibraryA и т.д.) а в перехвате уже проверял значение и патчил. Это конечно намного сложнее способ чем у тебя, но зато более стабильный. Я все проты таким способом и патчу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155841&amp;user=3067&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=4" class="addthx" data-post="155841"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 12:50 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>seeq пишет:<br>сделал бы перехват какой-нибудь функи </I><br>Если я в лоадере перехвачу API функцию, то в запускаемой проге эта ф-ия тоже будет перехвачена?<br>По моему нет.<br>С протами я тоже так поступаю т.к. там один процесс.  А тут два лодырь и  сама прога
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155847&amp;user=423&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=5" class="addthx" data-post="155847"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 12:56 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>crc1</b> можетбыть глупость говорю, не знаю как на это среагирует StarForce, может стоить попробовать просто поставить бряк под отладчиком на ОЕП?
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=155850&amp;user=2775&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=6" class="addthx" data-post="155850"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 13:12 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>Maximus пишет:<br>как на это среагирует StarForce </I>   <br>Синим экраном<img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155852&amp;user=423&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=7" class="addthx" data-post="155852"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 13:12 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>crc1</b><br>Приоритет может поменять, например, виндовый taskmgr. З.Ы. Приоритет реального времени лучше не задавать.<br>Ясен пень, если ты лоадером похукаешь функу в СВОЁМ процессе, на процессе стара это не скажется. Хукать надо в его процессе.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155853&amp;user=1556&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=8" class="addthx" data-post="155853"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 13:30 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
taskmgr&#039;ом не получается. После следующей загрузки у лоадера снова приоритет средний. Возможно это программно реализовать?<br><br><I>Archer пишет:<br>Хукать надо в его процессе. </I><br>Научи как это сделать из лоадера. К примеру можно GetModuleHandleA
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155855&amp;user=423&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=9" class="addthx" data-post="155855"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Spirit[/b]','')">Spirit</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1419.gif" alt=""><br><span class=txtSm>Ранг: 271.6 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.35'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1419">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 13:50 <br><script type="text/javascript">QU('Spirit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Spirit" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>crc1</b><br>На дельфиворлд было, как приоритет в своей проге поднять.
<br><br><font size="1"><i>-----<br>iNTERNATiONAL CoDE CReW</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=155857&amp;user=1419&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=10" class="addthx" data-post="155857"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Krek[/b]','')">Krek</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.87'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=12975">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 14:08 <br><script type="text/javascript">QU('Krek','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Krek" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
@ crc1<br>Странно, что у тебя в первый раз получилось.<br>Попробуй так, может повезет опять.<br>Но лучше делать по науке.<br><br>invoke SetThreadPriority,addr pinfo.hThread,THREAD_PRIORITY_LOWEST<br>.WHILE TRUE<br>invoke SuspendThread,addr pinfo.hThread <br>invoke ReadProcessMemory,pinfo.hProcess,va,addr bufr,1,n <br>.IF eax != 0 <br>.IF bufr == 055h<br>invoke WriteProcessMemory,pinfo.hProcess,va,addr bufwr,1,n <br>invoke WriteProcessMemory,pinfo.hProcess,va1,addr bufwr1,1,n <br>invoke ResumeThread,addr pinfo.hThread <br>invoke CloseHandle,pinfo.hThread <br>invoke ExitProcess,0 <br>.ENDIF<br>.ENDIF<br>invoke ResumeThread,addr pinfo.hThread <br>.ENDW
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155858&amp;user=12975&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=11" class="addthx" data-post="155858"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]seeq[/b]','')">seeq</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3067.jpg" alt=""><br><span class=txtSm>Ранг: 105.9 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.64'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3067">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 14:09 <br><script type="text/javascript">QU('seeq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=seeq" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>crc1 пишет:<br>bufwr <b>DWORD</b> 0EBh<br>bufwr1 <b>DWORD</b> 0FEh  </I><br><br><I>crc1 пишет:<br>va DWORD 0074E03Ch<br>va1 DWORD 0074E03Dh  </I><br>+2 раза WriteProcessMemory<br><br>Че это вообще за изврат такой?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155859&amp;user=3067&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=12" class="addthx" data-post="155859"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ManHunter[/b]','')">ManHunter</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/7823.gif" alt=""><br><span class=txtSm>Ранг: 104.9 (ветеран), 46thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.66'>Активность: 0.04<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=7823">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 14:20 <br><script type="text/javascript">QU('ManHunter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ManHunter" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>crc1 пишет:<br>Archer пишет:<br>Хукать надо в его процессе.<br>Научи как это сделать из лоадера. К примеру можно GetModuleHandleA </I><br><br>присоединяюсь к вопросу
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155862&amp;user=7823&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=13" class="addthx" data-post="155862"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 15:34 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>Krek пишет:<br>Странно, что у тебя в первый раз получилось. </I><br>На версии StarForce v.3.4.49.1 получается постоянно<br><I>Krek пишет:<br>Попробуй так, может повезет опять. </I><br>Не тормозит<img src="img/smilies/s9.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155865&amp;user=423&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=14" class="addthx" data-post="155865"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 15:36 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Конечно, при следущей загрузке лоадера будет дефолтный приоритет. Как вариант-можешь его менять сразу из лоадера. Точного кода под рукой нет, но уверен, что гугл и дофига сайтов по программированию это знают.<br>Насчёт лоадеров-также кода под рукой нет, посмотри примеры других лоадеров, статейки почитай, типа статеек по трейсерам у ARTeam. Если кратко, то процесс дебажиццо фактически твоим лоадером и в нужный момент меняет память.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155866&amp;user=1556&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=15" class="addthx" data-post="155866"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]drunk_master[/b]','')">drunk_master</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.2 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.4'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9998">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 19:25 <br><script type="text/javascript">QU('drunk_master','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=drunk_master" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
~~ в лоадере для одной ботвы (написан на VS2005 C++) применил такой алгоритм :<br>читаем необходимые байты до тех пор, пока они не станут такие, какие должны быть, затем РайтПроцессМемори + плюс сразу читаем эту мемори - такая как нам надо ? ок, выход, нет - пишем опять +<br>после РайтПроцессМемори вызов ГетЛастЕррор для контроля + все это в консольной версии с выводом<br>ретурнВалуе от ГетЛастЕррора и выводом прочитанных и вписанных байтов - этакая отладка визуальная...<br>.... тк написана на С++ и успевает вписать - то Резум и Саспент убрал, а у тебя на дельфине, то код на<br>АССЕМБЛЕРЕ успее 100% !!! ... кстати,  может защита проверяет участок кода и есть резон писать теда до <br>тех пор, пока он не пройдет через EIP ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155895&amp;user=9998&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=16" class="addthx" data-post="155895"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]vins[/b]','')">vins</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 28.0 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.93'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=110">Участник</a><br><font color=blue>anarchist</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 20:35 <br><script type="text/javascript">QU('vins','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vins" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
а не пробывал запускать процес суспенденым, а не суспендить его потом?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155901&amp;user=110&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=17" class="addthx" data-post="155901"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2007 21:01 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>vins пишет:<br>а не пробывал запускать процес суспенденым, а не суспендить его потом? </I><br>...это,во-первых.<br><br>А во-вторых лучше действительно перехватывать функции в исследуемом процессе,например,ту же GetModuleHandleA.Перехватывать методом внедрения своей библиотеки,а потом из этой библиотеки сплайсить функции.Почитать можно например тут:<br>www.xakep.ru/post/28092/default.asp?print=true<br>...смотри тот раздел,что &quot;Внедрение DLL, находящейся на диске&quot;.<br><br>Приложу исходник с моей программкой для перехвата функции GetModuleHandleA, чтобы остановиться чуть ниже OEP.Не знаю правда как это будет работать со старом,но с седьмым Securom&#039;ом работает.В общем,смотри исходник(MASM32) и заодно потестишь <img src="img/smilies/s1.gif" alt=""><br> <br><br><img src="img/attach.gif" alt=""> <a href="./files/fabc_05.09.2007_CRACKLAB.rU.tgz">fabc_05.09.2007_CRACKLAB.rU.tgz</a> - GetApproxOEP.rar
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=155906&amp;user=1613&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=18" class="addthx" data-post="155906"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Faza[/b]','')">Faza</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 62.3 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.89'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2450">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 сентября 2007 05:58 <br><script type="text/javascript">QU('Faza','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Faza" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>vins пишет: <br>а не пробывал запускать процес суспенденым, а не суспендить его потом?</b><br><br>Иногда из за не понятных бубнов  writeprocessmemory веозвращает 229 ошибку по гетластэррор &quot;Функция выполнена не полностью&quot;  если суспенденым сразу запускать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155945&amp;user=2450&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=19" class="addthx" data-post="155945"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 сентября 2007 10:07 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>Faza</b> если перед этем VirtualProtectEx юзать то всё будет ОК
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=155967&amp;user=3232&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=20" class="addthx" data-post="155967"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 сентября 2007 11:29 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Суспендить процесс сразу, результата не дал. Прга запускается<br><I>DillerInc пишет:<br>Приложу исходник с моей программкой </I><br><b> Greatest thanks</b><br>Все работает<img src="img/smilies/s2.gif" alt=""> Прога тормозит сразу за вызовом GetModuleHandleA
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155981&amp;user=423&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=21" class="addthx" data-post="155981"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]yuzik[/b]','')">yuzik</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.05'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=5327">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 сентября 2007 11:41 <br><script type="text/javascript">QU('yuzik','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=yuzik" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Есть похожая проблема, только с dll. Есть упакованная дллка, знаю ОЕР, как тормознуть лоадером?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155983&amp;user=5327&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=22" class="addthx" data-post="155983"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]vins[/b]','')">vins</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 28.0 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.93'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=110">Участник</a><br><font color=blue>anarchist</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 сентября 2007 19:01 <br><script type="text/javascript">QU('vins','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vins" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>crc1 пишет:<br>Суспендить процесс сразу, результата не дал. Прга запускается </I><br>а ты тот процес запускаешь? =) <br><br>з.ы. фантастека....
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=156043&amp;user=110&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=23" class="addthx" data-post="156043"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 сентября 2007 20:02 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>vins пишет:<br>а ты тот процес запускаешь? =)  </I><br>Епт, конечно тот, но я в цикле делаю резюме, потом опять суспендю, читаю память и т.д. В памяти OEP патчится, но прога запускается.  <br>Перехват API по методе DillerInc принес результат
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=156048&amp;user=423&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=24" class="addthx" data-post="156048"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]vins[/b]','')">vins</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 28.0 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.93'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=110">Участник</a><br><font color=blue>anarchist</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 сентября 2007 21:05 &middot; Поправил: vins <br><script type="text/javascript">QU('vins','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vins" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
а зачем резюм делать до патча? думаешь твой кодес быстрее работает чем прога?<br>или я чтото не понимаю
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=156061&amp;user=110&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=25" class="addthx" data-post="156061"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 сентября 2007 07:03 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<b>crc1</b> у меня пол года назад такая же фича с гавнопротом была, я тогда тоже GetModuleHandleA перехватил и всё получилось. ХЗ почему в одном случае работает в другом нет <img src="img/smilies/s1.gif" alt=""> Кстати вспомнил один раз даже перехват этой АПИ не помог, по другому как то делал.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=156115&amp;user=3232&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=26" class="addthx" data-post="156115"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Cigan[/b]','')">Cigan</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.89'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=208">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 сентября 2007 17:03 <br><script type="text/javascript">QU('Cigan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Cigan" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>Кстати вспомнил один раз даже перехват этой АПИ не помог, по другому как то делал. </I><br><br>Так как код просто эмулился.<br><br><I>PE_Kill пишет:<br>ХЗ почему в одном случае работает в другом нет  </I><br><br>Такое в старе часто встречается.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=156193&amp;user=208&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=27" class="addthx" data-post="156193"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]__[/b]','')">__</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.1 (ветеран), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.73'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7172">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 сентября 2007 05:57 <br><script type="text/javascript">QU('__','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=__" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
можно юзать в EBFE где-нить по ходу распаковки в таком месте чтобы на этом EBFE код c OEP<br>был уже распакован, тогда можно циклически проверять код с OEP(или другого места проги) не боясь что прога запустится,<br>как только код распаковался можно сделать SuspendThread, убрать EBFE далее по смыслу в зависимости от сложности пакера
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=156245&amp;user=7172&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=28" class="addthx" data-post="156245"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 сентября 2007 11:38 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<I>__ пишет:<br>где-нить по ходу распаковки в таком месте чтобы на этом EBFE код c OEP был уже распакован </I><br>Ещебы знать <b>где</b>. StarForce v 3.xx.xx не дает себя трассировать
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=156264&amp;user=423&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=29" class="addthx" data-post="156264"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Faza[/b]','')">Faza</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 62.3 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.89'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2450">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 сентября 2007 23:00 &middot; Поправил: Faza <br><script type="text/javascript">QU('Faza','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Faza" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9834&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<b>crc1</b><br>то место это второй Jmp  eax в  VM <br><br>Циклишь прогу на  ОЕП стара,  аттачишся, из ОЕП  идешь в вызов ВМ   смотришь конец функции там есть jmp eax , ставишь на него бряк (один бряк 3 стар позволяет ольке поставить )  , правишь OEP отправляешь прогу на волю как следствие брякаешься  смотришь что там в eax   , в этом eax идешь в низ функции внимательно  высматриваешь первый jmp &quot;кудатотам&quot; ,  идешь в&quot;кудатотам&quot;  там будет начало, таково вида     MOV EDX,DWORD PTR DS:[EDI] ,  в конце этой штуки есть  jmp eax за ним куча нулей , там и патч. Адрес второго джампа один и тот же так, что делаешь лоадер, чтоб он туда сразу пачил как надо , через этот джам стар пробежит раз тыщу  и раз сто после того как распакует прогу и будет мудрить с импортом, так что там не промахнешся и передачей управления вагон.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=156344&amp;user=2450&amp;forum_n=1&amp;topic=9834&amp;page=0&amp;anchor=30" class="addthx" data-post="156344"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=1&amp;topic=9834&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=1&amp;topic=9834&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Лоадер не тормозит прогу. Почему?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="9834">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=9834" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
