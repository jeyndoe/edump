<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Owner SID &amp; Group SID - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Как получить SID создателя обьекта (процесса) без использования OpenProcessToken. А точнее имя пользователя под которым выполняеться процесс.">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Owner SID &amp; Group SID</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=11283&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=11283&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2008 16:12 &middot; Поправил: multiarc <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Как получить SID создателя обьекта (процесса) без использования OpenProcessToken.<br>А точнее имя пользователя под которым выполняеться процесс.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=180352&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=1" class="addthx" data-post="180352"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2008 16:15 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Owner SID и Group SID полученный через GetSecurityInfo это не то... там нету юзера и домена, под которым процесс выполняеться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=180355&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=2" class="addthx" data-post="180355"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2008 16:32 &middot; Поправил: multiarc <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Я так понял дочитав в МСДН про tokens короче выходит не открыв token не получить и имя пользователя, а как например открыть в ХР SP2 token для svchost.exe который выполняеться под аккаунтом LOCAL SERVICE или NETWORK SERVICE? говорит Access Denied. ведь taskmgr.exe нормально показывает для всех процессов инфу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=180356&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=3" class="addthx" data-post="180356"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2008 16:44 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>multiarc пишет:<br>taskmgr.exe</I><br><br>он получает через WinStationConnect + WinStationGetProcessSid + LookupAccountSid <img src="img/smilies/s1.gif" alt=""> для XP нада юзать GetKernelObjectSecurity + GetSecurityDescriptorOwner + LookupAccountSid, или также как taskmgr.exe, но там геморно с этими функциями.
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=180357&amp;user=72&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=4" class="addthx" data-post="180357"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2008 18:51 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Есть ли где-нить описание функи WinStationConnect, WinStationGetProcessSid? а то гугл ничего толкового не сказал... только синтаксис... а как пользоваться хз ))<br><code>BOOLEAN WINAPI WinStationGetProcessSid( <br>	HANDLE hServer, <br>	DWORD ProcessId , <br>	FILETIME ProcessStartTime , <br>	PBYTE pProcessUserSid , <br>	PDWORD dwSidSize <br>); <br><br>BOOLEAN<br>WINAPI<br>WinStationConnectA(<br>    IN HANDLE hServer,<br>    IN ULONG ConnectSessionId,<br>    IN ULONG ActiveSessionId,<br>    IN PCSTR Password,<br>    IN ULONG Unknown<br>    );</code><br>GetKernelObjectSecurity + GetSecurityDescriptorOwner + LookupAccountSid<br>спасибо... сейчас проверю...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=180364&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=5" class="addthx" data-post="180364"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2008 18:57 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
GetKernelObjectSecurity + GetSecurityDescriptorOwner + LookupAccountSid<br>не то...<br>тоже самое что и GetSecurityInfo, например для процессов текущего пользователя выводит имя пользователя Administrators, домен BUILTIN.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=180365&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=6" class="addthx" data-post="180365"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2008 19:22 &middot; Поправил: multiarc <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<code>BOOLEAN WINAPI WinStationGetProcessSid( <br>	HANDLE hServer, <br>	DWORD ProcessId , <br>	FILETIME ProcessStartTime , <br>	PBYTE pProcessUserSid , <br>	PDWORD dwSidSize <br>); <br>void WINAPI CachedGetUserFromSid( <br>	PSID pSid , <br>	PWCHAR pUserName , <br>	PULONG cbUserName <br>);<br></code><br>Код на асме<br><code>WinStationGetProcessSid	typedef	proto :dword,:dword,:dword,:dword,:dword,:dword <br>lpWinStationGetProcessSid	typedef	ptr _WinStationGetProcessSid <br>_CachedGetUserFromSid	typedef	proto :dword,:dword,:dword <br>lpCachedGetUserFromSid	typedef	ptr _CachedGetUserFromSid <br>.data? <br>ZwQuerySystemInformation	lpZwQuerySystemInformation ? <br>WinStationGetProcessSid	lpWinStationGetProcessSid	? <br>CachedGetUserFromSid	lpCachedGetUserFromSid	?        <br> <br>;_PID&#20026;&#36827;&#31243;&#30340;PID <br><span style="word-break: break-all">;_lpCreateTime&#20026;&#25351;&#21521;&#36827;&#31243;&#21019;&#24314;&#30340;&#26102;&#38388;&#32467;&#26500;&#30340;&#25351;&#38024;</span> <br>;_lpUser&#25351;&#21521;&#29992;&#20110;&#23384;&#20648;&#29992;&#25143;&#21517;&#30340;&#32531;&#20914;&#21306; <br>_GetProcUser proc USES ebx esi edi _PID,_lpCreateTime,_lpUser <br>	LOCAL	@dwSize <br>	LOCAL	@User[1024]:BYTE    <br> <br>	invoke	LoadLibrary,CTEXT(&quot;winsta.dll&quot;) <br>	invoke	GetProcAddress,eax,CTEXT(&quot;WinStationGetProcessSid&quot;) <br>	mov	WinStationGetProcessSid,eax <br> 	invoke	LoadLibrary,CTEXT(&quot;UTILDLL.dll&quot;) <br> 	invoke	GetProcAddress,eax,CTEXT(&quot;CachedGetUserFromSid&quot;) <br>	mov	CachedGetUserFromSid,eax           <br> <br>	mov	edi,_lpCreateTime <br>	mov	@dwSize,0 <br> 	invoke	WinStationGetProcessSid,0,_PID,[edi],[edi+4],\ <br>		0,addr @dwSize <br> 	invoke	GlobalAlloc,GMEM_FIXED or GMEM_ZEROINIT,@dwSize <br>	mov	esi,eax           <br> <br>	invoke	WinStationGetProcessSid,0,_PID,[edi],[edi+4],\ <br>		esi,addr @dwSize <br> 	invoke	IsValidSid,esi <br>	.if	eax <br> 		invoke	CachedGetUserFromSid,esi,addr @User,\ <br>			addr @dwSize <br>		invoke	wsprintf,_lpUser,CTEXT(&quot;%ws&quot;),\ <br>			addr @User <br>	.else <br>		mov	BYTE PTR [_lpUser],0 <br>	.endif <br>	invoke	GlobalFree,esi <br>	ret <br>_GetProcUser endp</code><br>CachedGetUserFromSid чё за? и можно ли LookUpAccountSid юзать?<br>взято отсюда www.cwo1f.cn/blog/?m=200802
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=180369&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=7" class="addthx" data-post="180369"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2008 20:17 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
дык CachedGetUserFromSid эта херь и достаёт бзера из сида <img src="img/smilies/s1.gif" alt=""> <br>LookUpAccountSid можно юзать, пихаешь в него сид и будит тебе счастье)
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=180371&amp;user=72&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=8" class="addthx" data-post="180371"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2008 21:04 &middot; Поправил: multiarc <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
WinStationGetProcessSid говорит invalid handle value <img src="img/smilies/s14.gif" alt=""><br>видимо hServer...<br>ессно дальше не работает
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=180380&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=9" class="addthx" data-post="180380"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2008 21:30 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
я же писал выше! <i class=x>WinStationConnect</i> нужен <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=180381&amp;user=72&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=10" class="addthx" data-post="180381"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2008 22:04 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
WinStationConnectW(0,1,0,&#039;&#039;,true);//Acess Denied<br>WinStationGetProcessSid(0,procid,ProcStartTime,nil,cb);//Invalid Handle Value<br>GetMem(OwnerSid,cb);<br>WinStationGetProcessSid(0,procid,ProcStartTime,OwnerSid,cb);//Invalid Handle Value
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=180383&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=11" class="addthx" data-post="180383"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2008 22:45 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
уу мля, думаешь так легко всё)) бери иду и дизасми taskmgr.exe!<br>ты зачем по сложному пути пошёл? я же показал альтернативу <img src="img/smilies/s1.gif" alt=""><br><br><code>      If (GetKernelObjectSecurity(h,OWNER_SECURITY_INFORMATION,@sd,Size,Length) )  then<br>      begin<br>        aDef:=false;<br>        GetSecurityDescriptorOwner(@sd,sid,aDef);<br>        result:=GetAccountBySID(sid);<br>      end;</code>
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=180385&amp;user=72&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=12" class="addthx" data-post="180385"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2008 20:25 &middot; Поправил: multiarc <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
В общем отладкой пришёл к выводу... (winsta.dll) (Windows Server 2008 RC1)<br><code>function WinStationGetProcessSid (int:integer;ProcessId:cardinal;hServer:cardinal;ProcessStartTime:PFIL ETIME;pProcessUserSid:PByte;var  dwSidSize:cardinal):boolean;stdcall;</code><br><br>вот так обьявляеться эта функа... первый int всегда равен 0 (push 0), ?hServer? для каждого процесса свой!!! :O и значение лежит по адресу, который находиться в регистре edi, ещё до вызова функции, в которой произойдёт вызов API!!!! :O :O если кто может чё-нить посоветуйте...<br>и это значение не меняеться до перезагрузки... у меня например для smss.exe = 0x4DB89144. Я думал может это я напутал... короче что это типа ProcessStartTime, но почему тогда GetProcessTimes выводит совсем другую инфу... и далеко не 0x4DB89144<br>И ещё нашёл 1 интересную функцию WTSEnumerateProcesses, но она не использует WinStationGetProcessSid в общем требуеться помощь в отладке...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181644&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=13" class="addthx" data-post="181644"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2008 20:31 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
И ещё...<br>WinStationConnect не нужен совсем!!! он не используеться taskmgr&#039;ом совсем.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181646&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=14" class="addthx" data-post="181646"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2008 22:56 &middot; Поправил: multiarc <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
NtQuerySystemInformation вроде если не ошибаюсь то откуда берёт нужное значение...<br>Осталось найти где и что это такое
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181656&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=15" class="addthx" data-post="181656"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2008 23:02 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
я же дал тебе способ рабочий, сам его юзаю, что не устраивает то? <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=181657&amp;user=72&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=16" class="addthx" data-post="181657"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2008 23:13 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>Hellspawn пишет:<br>я же дал тебе способ рабочий, сам его юзаю, что не устраивает то?  </I><br>то что надо процесс открывать... а например audiodg.exe в висте не откроешь с доступом PROCESS_QUERY_INFORMATION... а taskmgr.exe получает о нём почти всю инфу, которую даже не может получить process explorer
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181658&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=17" class="addthx" data-post="181658"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2008 23:31 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
включи отладочные привелегии <img src="img/smilies/s1.gif" alt=""> или в висте таких нету?
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=181660&amp;user=72&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=18" class="addthx" data-post="181660"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2008 23:39 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>Hellspawn пишет:<br>включи отладочные привелегии  или в висте таких нету? </I><br>если это SeDebugPrivilege, то и так включено всё... просто это защищённый процесс...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181663&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=19" class="addthx" data-post="181663"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]sss[/b]','')">sss</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 37.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.83'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6443">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2008 10:49 <br><script type="text/javascript">QU('sss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sss" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>multiarc пишет:<br>Owner SID и Group SID полученный через GetSecurityInfo это не то... там нету юзера и домена, под которым процесс выполняеться. </I><br><br>Брехня... <br>Можно получить с помощью GetSecurityInfo SID создателя? Можно. А SID откуда берется? Если домен, назначается RID хозяином домена.  Далее, как уже писал <b>Hellspawn</b> LookupAccountSid. Кстати, и привелегии надо включать явно. И делать всякие там ImpersonateSelf....
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181693&amp;user=6443&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=20" class="addthx" data-post="181693"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2008 17:31 &middot; Поправил: multiarc <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Со всеми процессами кроме audiodg.exe всё работает ну конечно со включеной привилегией...<br>WinStationGetProcessSid не требует открытия... процесса, она сама его открывает через NtOpenProcess...<br>Тогда вопрос как открыть процесс audiodg.exe? хоть бы и через NtOpenProcess...<br>Как получить не имя владельца, а имя пользователя... ImpersonateSelf? хм... а зачем?<br><br>&quot;The ImpersonateSelf function is used for tasks such as enabling a privilege for a single thread rather than for the entire process or for changing the default discretionary access control list (DACL) for a single thread.&quot;<br>Если я что-то не так понял, то обьясни...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181728&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=21" class="addthx" data-post="181728"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]S_T_A_S_[/b]','')">S_T_A_S_</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 163.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.87'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=251">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2008 21:11 &middot; Поправил: S_T_A_S_ <br><script type="text/javascript">QU('S_T_A_S_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=S_T_A_S_" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Для протектед процесса только PROCESS_QUERY_LIMITED_INFORMATION можно указать <img src="img/smilies/s9.gif" alt=""> D-Pin Purr для отключения фичи использует драйвер http://www.alex-ionescu.com/?p=36  (хз что именно делает)<br><br>Хм, а вот тут http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=1394821&amp;SiteID=1  пишут:<br><i class=x>As I have read in MSDN, you need to call OpenProcess with PROCESS_QUERY_INFORMATION access rights in order to get its token with OpenProcessToken. After trying several combinations, I&#039;ve found, that PROCESS_QUERY_LIMITED_INFORMATION whould be enough;</i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181752&amp;user=251&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=22" class="addthx" data-post="181752"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2008 22:02 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>S_T_A_S_ пишет:<br>Для протектед процесса только PROCESS_QUERY_LIMITED_INFORMATION можно указать  D-Pin Purr для отключения фичи использует драйвер (хз что именно делает) </I><br>Драйвер не пойдёт... надо изначально права админа для установки хотя бы...<br><I>S_T_A_S_ пишет:<br>Хм, а вот тут пишут: <br>As I have read in MSDN, you need to call OpenProcess with PROCESS_QUERY_INFORMATION access rights in order to get its token with OpenProcessToken. After trying several combinations, I&#039;ve found, that PROCESS_QUERY_LIMITED_INFORMATION whould be enough; </I><br>А в XP этого нету... есть только в висте, в ХР не открываеться токен для процесса svchost.exe который запущен от имени LOCAL SERVICE и NETWORK SERVICE...<br>Вопрос: как получить время создания процесса, нужно для WinStationGetProcessSid... без этого не работает! я короче докапался вроде...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181755&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=23" class="addthx" data-post="181755"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]sss[/b]','')">sss</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 37.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.83'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6443">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 10:46 <br><script type="text/javascript">QU('sss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sss" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>multiarc</b> кто является создателем процесса? Разве не пользователь, запустивший процесс? Вообще прослеживается закономерность: если запуск произведен от имени SYSTEM владельцем процесса является <b>группа </b> Администраторы. Если NETWORK SERVICE, то NETWORK_SERVICE, если LOCAL SERVICE то LOCAL SERVICE, если персонифицированный пользователь, то он.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181781&amp;user=6443&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=24" class="addthx" data-post="181781"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]sss[/b]','')">sss</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 37.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.83'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6443">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 11:06 <br><script type="text/javascript">QU('sss','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sss" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
Насчет ImpersonateSelf, как то бился над сменой владельца. Ничего не получалось ( хотя SeTakeOwnership присутствовала у запускающего процесс пользователя), пока не  вызвал ImpersonateSelf. Приложение было однопоточное.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181783&amp;user=6443&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=25" class="addthx" data-post="181783"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 14:25 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>sss пишет:<br>multiarc кто является создателем процесса? Разве не пользователь, запустивший процесс? Вообще прослеживается закономерность: если запуск произведен от имени SYSTEM владельцем процесса является группа Администраторы. Если NETWORK SERVICE, то NETWORK_SERVICE, если LOCAL SERVICE то LOCAL SERVICE, если персонифицированный пользователь, то он. </I><br>Да, но у меня вопрос был не в том: <br>1) нельзя открывать процесс, потому что в любом случае это можно запретить, например как это делает касперский... А в ХР нету флага PROCESS_QUERY_LIMITED_INFORMATION, да и вообще открытие процесса не проблема запретить, всего-лишь перехватив нужную функцию...<br>2) получить имя пользователя (локального аккаунта (например &quot;Вася&quot;)) который находиться в Token и называеться User SID.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181804&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=26" class="addthx" data-post="181804"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 16:18 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
Проблема решена...<br>NtQuerySystemInformation+WinStationGetProcessSid+LookUpAccountSid<br>Без включённой привелегии дебага в Windows Server 2008 RC1 не определяеться SID только для 1 процесса csrss.exe, со включённой всё определяет... (ну конечно кроме System Idle и System)<br>Если интересно могу сюда код положить...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181822&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=27" class="addthx" data-post="181822"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 16:29 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<code><br>function SetPrivilege(PrivilegeName:Pchar;Enabled:boolean):boolean;<br>var<br>  token,cb:Cardinal;<br>  tkp:TOKEN_PRIVILEGES;<br>begin<br>  result:=OpenProcessToken(GetCurrentProcess,TOKEN_ADJUST_PRIVILEGES,tok en);<br>  if not result then<br>    exit;<br>  result:=LookupPrivilegeValue(nil,PrivilegeName,tkp.Privileges[0].Luid) ;<br>  if not result then<br>    exit;<br>  tkp.PrivilegeCount:=1;<br>  case Enabled of<br>  True:<br>  tkp.Privileges[0].Attributes:=SE_PRIVILEGE_ENABLED;<br>  false:<br>  tkp.Privileges[0].Attributes:=0;<br>  end;<br>  cb:=0;<br>  result:=AdjustTokenPrivileges(token,false,tkp,SizeOf(tkp),nil,cb);<br>  CloseHandle(token);<br>end;<br><br>procedure TForm1.Button1Click(Sender: TObject);<br>type<br>  t=SYSTEM_PROCESS_INFORMATION;<br>var<br>  ppi,tppi,PSID,Owner,Group:pointer;<br>  cb,err,cb1,cb2:cardinal;<br>begin<br>SetPrivilege(&#039;SeDebugPrivilege&#039;,true);<br>NtQuerySystemInformation(5,nil,0,cb);<br>GetMem(ppi,cb);<br>err:=RtlNtStatusToDosError(NtQuerySystemInformation(5,ppi,cb,cb));<br>ViewSysError(err,&#039;NtQuerySystemInformation&#039;,&#039;&#039;);<br>tppi:=ppi;<br>while t(ppi^).dNext&lt;&gt;0 do<br>begin<br>cb:=0;<br>WinStationGetProcessSid(0,t(ppi^).dUniqueProcessId,t(ppi^).qCreateTime ,nil,cb);<br>GetMem(PSID,cb);<br>cb2:=cb;<br>if not WinStationGetProcessSid(0,t(ppi^).dUniqueProcessId,t(ppi^).qCreateTime ,PSID,cb2)  then<br>ViewSysError(GetLastError,&#039;WinStationGetProcessSid&#039;,&#039;&#039;);<br>LookupAccountSid(nil,PSID,nil,cb1,nil,cb2,cb);<br>GetMem(Owner,cb1);<br>GetMem(Group,cb2);<br>LookupAccountSid(nil,PSID,Owner,cb1,Group,cb2,cb);<br>Memo1.Lines.Add(&#039;[&#039;+<br>WideCharToString(t(ppi^).usName.str)+<br>&#039;]=&#039;+Pchar(Owner));<br>Memo1.Lines.Add(&#039;[&#039;+<br>WideCharToString(t(ppi^).usName.str)+<br>&#039;]=&#039;+Pchar(Group));<br>Cardinal(ppi):=Cardinal(ppi)+t(ppi^).dNext;<br>FreeMem(PSID);<br>FreeMem(Owner);<br>FreeMem(Group);<br>end;<br>FreeMem(tppi);<br>end;</code>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181823&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=28" class="addthx" data-post="181823"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]satoo[/b]','')">satoo</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.32'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=15941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 марта 2008 01:03 <br><script type="text/javascript">QU('satoo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=satoo" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
2multiarc: <br>1) у меня данный пример &quot;врет&quot; - показывает только &quot;nt auth...\local service&quot; и &quot;nt auth...\system&quot;. пользователь нигде не фигурирует.<br>2) этот пример, как и другие подобные косвено загружает систему (нагружается процесс lsass). как от этого избавиться?<br><br>зыж система winxp sp2
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183557&amp;user=15941&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=29" class="addthx" data-post="183557"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 марта 2008 16:38 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11283&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
Что значит врёт??<br>В аттаче полностью прога с исходниками...<br>Там почти идентичный код...<br><br><img src="img/attach.gif" alt=""> <a href="./files/6947_19.03.2008_CRACKLAB.rU.tgz">6947_19.03.2008_CRACKLAB.rU.tgz</a> - ProcessInformation.7z
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183626&amp;user=12469&amp;forum_n=6&amp;topic=11283&amp;page=0&amp;anchor=30" class="addthx" data-post="183626"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=11283&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=11283&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Owner SID &amp; Group SID</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="11283">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=11283" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
