<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>UpdateResource &amp; PE-пакеры - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброе время! Я тут столкнулся с проблемой. В общем, сначала я пакую exe&#039;шник с помощью какого-либо PE-пакера (UPX, WinUPack, PE* ...), затем пытаюсь изменить иконку с помощью функции ReplaceIcon() (см. аттач) Иногда иконку">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=50833'>vasilevradislav</a>, <a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a>, <a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> UpdateResource &amp; PE-пакеры</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]juicy_emad[/b]','')">juicy_emad</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.42'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3752">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июля 2008 17:45 &middot; Поправил: juicy_emad <br><script type="text/javascript">QU('juicy_emad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=juicy_emad" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12326.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброе время!<br><br>Я тут столкнулся с проблемой.<br>В общем, сначала я пакую exe&#039;шник с помощью какого-либо PE-пакера (UPX, WinUPack, PE* ...), затем пытаюсь изменить иконку с помощью функции ReplaceIcon() (см. аттач)<br>Иногда иконку после такого обновления вообще не видно. Иногда иконку видно, но &quot;приложение не запускается&quot; или приложение вылетает с ошибкой хрен знает на каком адресе (где-то далеко за адресным пространством приложения). Однако, если функцию ReplaceIcon() юзать не на запакованном exe&#039;шнике, то всё замечательно работает.<br>Т.е. мой вывод таков, что WIN API функция UpdateResource() портит exe&#039;шный файл, если он запакован.<br><br>Я пробовал менять настройки пакеров... чтобы они русурсы сжимали или не сжимали... менял степень компрессии - всё без толку.<br><br><b>Что же делать? Как заменить иконку у запакованного файла?</b><br>Ну и вообще - какой пакер для этих дел посоветуете?<br><br>P.S.: всё собиралось под MS VS 6.5 со след. настройками линкера:<br><code>#pragma comment(linker, &quot;/OPT:nowin98&quot;)<br>#pragma comment(linker, &quot;/MERGE:.data=.text&quot;)<br>#pragma comment(linker, &quot;/MERGE:.rdata=.text&quot;)<br>#pragma comment(linker, &quot;/FILEALIGN:512 /SECTION:.text,EWR /IGNORE:4078&quot;)<br>#pragma comment(linker, &quot;/ENTRY:main&quot;)</code><br><br><img src="img/attach.gif" alt=""> <a href="./files/3c77_14.07.2008_CRACKLAB.rU.tgz">3c77_14.07.2008_CRACKLAB.rU.tgz</a> - rep_icon.h
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195703&amp;user=3752&amp;forum_n=6&amp;topic=12326.html&amp;page=0&amp;anchor=1" class="addthx" data-post="195703"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]dermatolog[/b]','')">dermatolog</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/1404.png" alt=""><br><span class=txtSm>Ранг: 116.6 (ветеран), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.36'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1404">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июля 2008 17:55 &middot; Поправил: dermatolog <br><script type="text/javascript">QU('dermatolog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dermatolog" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12326.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
В нормальных пакерах должна быть возможность не только указания того, что секцию ресурсов не надо жать, но и то что эти ресурсы нужно перенести в конец файла (после всех остальных данных). Только в этом случае, винда при UpdateResource не затрет никаких данных.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195707&amp;user=1404&amp;forum_n=6&amp;topic=12326.html&amp;page=0&amp;anchor=2" class="addthx" data-post="195707"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Zloy[/b]','')">Zloy</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 46.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4581">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2008 01:44 <br><script type="text/javascript">QU('Zloy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Zloy" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12326.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
В файле как минимум,должна присуствовать секция .rsrc с размером &#036;200 и она должна быть последней,иначе файл просто испортиться т.к BeginUpdateResource создаст пустую сецию с virtuasize = 0 и rawsize = 0 файл просто не запуститься.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195732&amp;user=4581&amp;forum_n=6&amp;topic=12326.html&amp;page=0&amp;anchor=3" class="addthx" data-post="195732"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Talula[/b]','')">Talula</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8070.jpg" alt=""><br><span class=txtSm>Ранг: 213.0 (наставник), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.22<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8070">Участник</a><br><font color=blue>Тот ещё Lamer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2008 03:27 <br><script type="text/javascript">QU('Talula','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Talula" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12326.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
я вот только не понимаю одного: почему нельзя заменить иконку до упаковки пакером? 8-0
<br><br><font size="1"><i>-----<br>Do Not Get Mad Get Money! ;)</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=195735&amp;user=8070&amp;forum_n=6&amp;topic=12326.html&amp;page=0&amp;anchor=4" class="addthx" data-post="195735"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]juicy_emad[/b]','')">juicy_emad</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.42'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3752">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2008 06:38 <br><script type="text/javascript">QU('juicy_emad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=juicy_emad" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12326.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>dermatolog</b><br><b>Zloy</b><br>А какие пакеры позвояют переносить это дело вконец?<br><br><b>Talula</b><br>Ну, надо мне так. Я использую слияние с другим exe&#039;шником, помещая свой вначало файла. В этом случае нужно брать иконку другого exe&#039;шника.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195737&amp;user=3752&amp;forum_n=6&amp;topic=12326.html&amp;page=0&amp;anchor=5" class="addthx" data-post="195737"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Zloy[/b]','')">Zloy</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 46.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4581">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2008 06:47 <br><script type="text/javascript">QU('Zloy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Zloy" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12326.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Возми любой pe редактор добавь новую секцию с размером 200h и назови её .rsrc после чего попробуй сменить иконку через твою фунцию<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195738&amp;user=4581&amp;forum_n=6&amp;topic=12326.html&amp;page=0&amp;anchor=6" class="addthx" data-post="195738"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]dermatolog[/b]','')">dermatolog</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/1404.png" alt=""><br><span class=txtSm>Ранг: 116.6 (ветеран), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.36'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1404">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2008 06:58 <br><script type="text/javascript">QU('dermatolog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dermatolog" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12326.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>juicy_emad пишет:<br>А какие пакеры позвояют переносить это дело вконец?  </I><br>VMProtect
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195739&amp;user=1404&amp;forum_n=6&amp;topic=12326.html&amp;page=0&amp;anchor=7" class="addthx" data-post="195739"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]juicy_emad[/b]','')">juicy_emad</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.42'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3752">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2008 08:05 <br><script type="text/javascript">QU('juicy_emad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=juicy_emad" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12326.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>dermatolog</b><br>Довольно странно получилось.VMProtect раздул мой exe&#039;шник с 20 480 до 32 768 байт.<br>Так и должно быть? =)<br><br><b>Zloy</b><br>Ок. Попробую.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195741&amp;user=3752&amp;forum_n=6&amp;topic=12326.html&amp;page=0&amp;anchor=8" class="addthx" data-post="195741"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]dermatolog[/b]','')">dermatolog</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/1404.png" alt=""><br><span class=txtSm>Ранг: 116.6 (ветеран), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.36'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1404">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2008 08:16 <br><script type="text/javascript">QU('dermatolog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dermatolog" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12326.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>juicy_emad пишет:<br>Довольно странно получилось.VMProtect раздул мой exe&#039;шник с 20 480 до 32 768 байт.  </I><br>Вы бы сразу сказали для чего вам нужен пакер, а то теряете время своё и чужое <img src="img/smilies/s1.gif" alt="">) Вам сюда http://www.wasm.ru/forum/viewforum.php?id=6 .
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195742&amp;user=1404&amp;forum_n=6&amp;topic=12326.html&amp;page=0&amp;anchor=9" class="addthx" data-post="195742"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]juicy_emad[/b]','')">juicy_emad</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.42'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3752">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2008 08:21 <br><script type="text/javascript">QU('juicy_emad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=juicy_emad" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12326.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>Zloy</b><br>Хм... я тут посмотрел - секция ресурсов и так находится в самом конце после упаковки UPX&#039;ом (см. аттач).<br>В моей ситуации, нужно удалить текущую секцию и добавить пустую, размером 200h ? Я правильно понял?<br><br><img src="img/attach.gif" alt=""> <a href="./files/5c6a_14.07.2008_CRACKLAB.rU.tgz">5c6a_14.07.2008_CRACKLAB.rU.tgz</a> - upx.png
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195743&amp;user=3752&amp;forum_n=6&amp;topic=12326.html&amp;page=0&amp;anchor=10" class="addthx" data-post="195743"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Zloy[/b]','')">Zloy</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 46.9 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4581">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2008 13:42 &middot; Поправил: Zloy <br><script type="text/javascript">QU('Zloy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Zloy" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12326.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
function szUpdateResource(hModule: THandle; lpszType: PChar;lpszName: PChar;hUpdate: Cardinal): BOOL; stdcall;<br>var hRes,hResLoaded,nSizeOfRes : dword; pData : pointer;<br>begin<br>hRes:=FindResource(hModule,lpszName,lpszType);<br>hResLoaded:=LoadResource(hModule,hRes);<br>pData:=LockResource(hResLoaded);<br>nSizeOfRes:=SizeofResource(hModule,hRes);<br>UpdateResource(hUpdate,lpszType,lpszName,0,pData,nSizeOfRes);<br>FreeResource(hResLoaded);<br>result:=true;<br>end;<br><br>и.т.д,упаковал upx тот что в peid,сменил иконку на файле - работоспособность сохранилась,скажи вобщем зачем менять иконку на уже упакованном файле почему нельзя к примеру сменить а после этого упаковать?<br><br><br>Удалять ничего не нужно,просто может быть(что мало вероятно) секция ресурсов идет не последней в этоге m&#036; добавляет секцию с va=0 и прога падает (Приложение не может быть запущено или не являеться win32 программой..вобщем,что то в этом роде.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195782&amp;user=4581&amp;forum_n=6&amp;topic=12326.html&amp;page=0&amp;anchor=11" class="addthx" data-post="195782"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]DrGolova[/b]','')">DrGolova</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/301.jpg" alt=""><br><span class=txtSm>Ранг: 199.6 (ветеран), 12thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.84'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=301">Участник</a><br><font color=blue>www.uinc.ru</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2008 16:22 <br><script type="text/javascript">QU('DrGolova','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DrGolova" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12326.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
&gt; В нормальных пакерах должна быть возможность не только указания того,<br>&gt; что секцию ресурсов не надо жать, но и то что эти ресурсы нужно перенести в конец файла<br><br>Не для всех &quot;несжимаемых&quot; ресурсов прокатыват. Даже в висте бестолковые индусы ищут TYPELIB простым добавлением смещения к raw-offset&#039;у секции .rsrc, так что если данные оказываются в дургой секции, обычно они промахиваются, и как следствие контрол не регистрируется. Зачем читать данные из файла, когда библиотека уже замплена в память для меня тоже загадка. Видимо так повелели индусские боги <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195796&amp;user=301&amp;forum_n=6&amp;topic=12326.html&amp;page=0&amp;anchor=12" class="addthx" data-post="195796"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]dermatolog[/b]','')">dermatolog</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/1404.png" alt=""><br><span class=txtSm>Ранг: 116.6 (ветеран), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.36'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1404">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2008 17:07 <br><script type="text/javascript">QU('dermatolog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dermatolog" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12326.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>DrGolova пишет:<br>Не для всех &quot;несжимаемых&quot; ресурсов прокатыват. </I><br>Здесь топикстартер про проблемы апдейта упакованных ресурсов. Если ресурсы будут упакованы либо если после секции будут лежать какие-либо данные (либо другая секция), то винда при апдейте тупо затирает все что лежит в файле после секции ресурсов.<br><I>DrGolova пишет:<br>Даже в висте бестолковые индусы ищут TYPELIB простым добавлением смещения к raw-offset&#039;у секции .rsrc, так что если данные оказываются в дургой секции, обычно они промахиваются, и как следствие контрол не регистрируется. </I><br>С багами висты пока не знаком, а вот на 9х с ресурсами еще интересней - дерево ресурсов где-то кешируется  и винда работает исключительно с кешем, даже если реальная секция ресурсов (в том числе и дерево) в памяти уже давно поменялась.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195801&amp;user=1404&amp;forum_n=6&amp;topic=12326.html&amp;page=0&amp;anchor=13" class="addthx" data-post="195801"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]juicy_emad[/b]','')">juicy_emad</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.42'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3752">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2008 18:01 <br><script type="text/javascript">QU('juicy_emad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=juicy_emad" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12326.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>Zloy</b><br>В общем, =) если у exe&#039;шника есть секция ресурсов, то upx пихает таблицу в с ресурсами (.rsrc). Если у exe&#039;шника нет ресурсов, то upx создаёт секцию upx2 и походу пихает импорт туда.<br><br>Так что моя проблема решилась просто удалением ресурсов из exe&#039;шника.<br>Кстати, у тебя какая версия upx?<br><br>P.S. мне это всё нужно вот для чего... короче, сначала я сжимаю exe&#039;шник, чтоб мало весил и антивирями не палился. Потом, чтоб слить этот exe&#039;шник с другим, я добавляю его вначало файла, при этом беру иконку и другого файла. Т.е. и получается что мне нужно сменить иконку у запакованного файла. И не хочу я таскать с собой депаковщик и что-то там ещё делать и программировать это, чтобы автоматом это делалось.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195807&amp;user=3752&amp;forum_n=6&amp;topic=12326.html&amp;page=0&amp;anchor=14" class="addthx" data-post="195807"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2008 21:43 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12326.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Форум этот не одобряет распространение малвары и посему не очень здесь поощряется скрытие вредоносов, топик поэтому я прикрою, инфы тут уже достаточно есть.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195842&amp;user=1556&amp;forum_n=6&amp;topic=12326.html&amp;page=0&amp;anchor=15" class="addthx" data-post="195842"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> UpdateResource &amp; PE-пакеры</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=12326" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
