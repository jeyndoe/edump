<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Неизвестный алгоритм обмена. Помогите.. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Есть два девайса при коннекте между собой делают проверку свой-чужой по хитрому алгоритму. Ведуший девайс посылает 8 байт криптованный ключик ведомому..ведомый должен его декриптить и отправить правильный ответ.. сокращённо лог">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=242'>Alf</a>, <a target='_blank' href='?action=userinfo&amp;user=21426'>Dart Raiden</a>, <a target='_blank' href='?action=userinfo&amp;user=55930'>bedop66938</a>, <a target='_blank' href='?action=userinfo&amp;user=33192'>morgot</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/rt.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=17&sortBy=0&page=0.html"><b>Электроника</b></a> <b class=bulletHead>&#8212;&#8250;</b> Неизвестный алгоритм обмена. Помогите..</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=17&amp;topic=17776&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=17&amp;topic=17776&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Boryan[/b]','')">Boryan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.4'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28000">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2011 12:37 <br><script type="text/javascript">QU('Boryan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boryan" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Есть два девайса при коннекте между собой делают проверку свой-чужой по хитрому алгоритму. Ведуший девайс посылает 8 байт криптованный ключик ведомому..ведомый должен его декриптить и отправить правильный ответ..<br>сокращённо лог общения выглядит так<br>5A 0B 8004 B7A80076B00587EC 19 <br>A5 12 06 8E759E521D19EEB0 47B29FE2342209F9 A9<br>где : 8004 команда запроса и далее ключ 8 байт на конце КС<br>1206 успешный ответ и далее 8 байт ответа  плюс 8 байт криптованный ключ уже для проверки на свой-чужой ведущего девайса.<br>Ведомый девайс собран на МК NEC....удалось взломать этот контроллер и вытащить с него дамп прошивки весом 4 к.<br>Начал поторшить дамп  в IDA на предмет взлома алгоритма...и застрял в сложности его..алго нечто отдалённо напоминающее SAFER <br>Что на данный момент поятно..Принятый ключик разбивается побайтно и мешается попарно с ключом шифрования 8 байт ..на выходе 16 байт вперемешку. Далее эти 16 байт опускаются в кучу &quot;мусора&quot; представляющуюю тупо набор разных значений байт объёмом около 430 байт и там начинают перемешиваться с использованием различных логических операций посредством приблизительно около 247 проходов по этой куче...на выходе получаем ключ 16 байт из него выбрасываем 8 байт и оставшиеся 8 байт есть ответ. В чём стоит задача? Ведомый девайс старой ревизии и понимает только запросы в диапазоне от 8000 до 8005, а новые работают в диапазоне от 8008 до 800D...вот и нужно старый научить работать по новому диапазону.<br>Тепрь про саму команду запроса 80хх ..второй байт в этой команде указывает каким ключом дешифровать посланный ключ и помимо этого указывает на точку входа в &quot;мусор&quot; <img src="img/smilies/s1.gif" alt=""> Реально этот &quot;мусор&quot; весит около 2 кило! И соответсвенно имеет разные точки входа/выхода для 16 байт ключа...Вопрос реально ли в этой всей каше просчитать новые ключи шифрования и точки входа/выхода для нового диапазона команд.  Если кому интересно помочь мне то могу предоставить все доки и дамп по этой задаче..Так же возможна оплата труда в разумных пределах.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277167&amp;user=28000&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=1" class="addthx" data-post="277167"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Boryan[/b]','')">Boryan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.4'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28000">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2011 12:28 <br><script type="text/javascript">QU('Boryan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boryan" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
Мне не понятно другое ..уже сейчас видно что для каждой команды 8000-8006 используется и свой ключик 8 байт и своя таблица. Почему нельзя использовать одну таблицу для всех запросов и разные ключи? Нафига так усложнять алгорим пожиранием памяти для таблиц?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277780&amp;user=28000&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=2" class="addthx" data-post="277780"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Androand[/b]','')">Androand</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.79'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26496">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2011 14:49 <br><script type="text/javascript">QU('Androand','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Androand" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<I>r_e пишет:<br>Это ИДА косячит. </I><br><br>Будь добр подскажи - это ведь очередной косяк ?<br><br>ROM_:07AE sub_7AE:                                ; CODE XREF: sub_9FB:loc_AE7p<br>ROM_:07AE                 and     word_FE9A+1,#07h ; AND Logical Product of Byte Data<br>ROM_:07B1                 set1    byte_FEF5.0     ; Set Single Bit (Carry Flag) 1 Bit Data Set<br>ROM_:07B4                 ret                     ; Return from Subroutine<br><br><br>строчка &quot;and     word_FE9A+1,#07h&quot; в хексе выглядит так &quot;61 9B 07&quot;<br><br>61 - это оператор AND saddr,#byte, с байтом все ясно, но почему адрес 9B(FE9B) ида отдизасмила как FE9A+1 ? <br><br>правомерна ли такая замена<br>ROM_:07AE                 and     0FE9Bh,#07h ; AND Logical Product of Byte Data
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277790&amp;user=26496&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=3" class="addthx" data-post="277790"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Androand[/b]','')">Androand</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.79'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26496">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2011 15:21 <br><script type="text/javascript">QU('Androand','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Androand" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
и еще в догонку<br><br>ROM_:07F2                 set1    MK0.SRMK00      ; Interrupt mask flag register 0<br><br>в хексе 0A 46 E4<br><br>0a - set1<br>46  в бине 1000110 (100 - это 4, 0110 - говорит что это SFR)<br>E4 - это FFE4 - в нашем случае ядра 78k0S регистр SFR  - MK0<br><br>в итоге получаем &quot;set1 MK0.4&quot;<br><br>все правильно ???
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277796&amp;user=26496&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=4" class="addthx" data-post="277796"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Androand[/b]','')">Androand</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.79'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26496">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2011 18:36 <br><script type="text/javascript">QU('Androand','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Androand" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
И еще вопрос знатокам - вроде причесал весь код - при компиляции, а конкретно на этапе обработки main.rel идет ругань на процедуры которые вызываются оператором CALLT, попробовал заменить их на локальные с вызовом CALL - можно ли делать такую замену или это неправильно ? И что это за этап компиляции ?<br><br>и еще после подобной замены на CALL стала вылазить одна ошибка, ранее не вылазившая - вот в этой процедуре:<br><br>sub_FA4:<br>		movw	BC,#0008h	; Move Word Data Transfer / Word Data Transfer with Stack Pointer<br><br>loc_FA7:				; Push<br>		push	DE<br>		movw	HL,#0FEECh	; Move Word Data Transfer / Word Data Transfer with Stack Pointer<br>		mov	A,[HL]		; Move Byte Data Transfer<br>		xch	A,X		; Exchange Byte	Data Exchange<br>		mov	A,[HL+01h]	; Move Byte Data Transfer<br>		movw	DE,AX		; Move Word Data Transfer / Word Data Transfer with Stack Pointer<br>		movw	HL,#0FEDAh	; Move Word Data Transfer / Word Data Transfer with Stack Pointer<br><br>loc_FB3:				; Move Byte Data Transfer<br>		mov	A,C<br>		cmp	A,B		; Compare Byte Data Comparison<br>		mov	A,[DE]		; Move Byte Data Transfer<br>		xor	A,[HL]		; Exclusive Or Exclusive Logical Sum of	Byte Data<br>		xch	A,X		; Exchange Byte	Data Exchange<br>		incw	DE		; Increment Word Data Increment<br>		mov	A,[DE]		; Move Byte Data Transfer<br>		incw	DE		; Increment Word Data Increment<br>		xor	A,[HL+01h]	; Exclusive Or Exclusive Logical Sum of	Byte Data<br>		bc	&#036;loc_FC2	; Branch if Carry Conditional Branch with Carry	Flag (CY = 1)<br>		xch	A,X		; Exchange Byte	Data Exchange<br><br>loc_FC2:				<br>		mov	[HL],A<br>		xch	A,X		; Exchange Byte	Data Exchange<br>		mov	[HL+01h],A	; Move Byte Data Transfer<br>		incw	HL		; Increment Word Data Increment<br>		incw	HL		; Increment Word Data Increment<br>		dbnz	C,&#036;loc_FB3	; Decrement and	Branch if Not Zero Conditional Loop (R1	!= 0)<br>		movw	AX,DE		; Move Word Data Transfer / Word Data Transfer with Stack Pointer<br>		movw	HL,#0FEECh	; Move Word Data Transfer / Word Data Transfer with Stack Pointer<br>		mov	[HL+01h],A	; Move Byte Data Transfer<br>		xch	A,X		; Exchange Byte	Data Exchange<br>		mov	[HL],A		; Move Byte Data Transfer<br>		pop	DE		; Pop<br>		ret			; Return from Subroutine<br>; End of function sub_FA4<br><br>конкретная строчка - 		bc	&#036;loc_FC2	<br><br>я так понимаю компиляция идет последовательно и утыкаясь на метку ранее не встречавшуюся (переход вперед) начинает ругаться ? Как побороть эту ситуацию ? <br><br>И вообще возможно ли повторно откомпилить в рабочую прошивку исходник полученный после дизасма ИДА ? А то может это вообще нереально, очень непонятно начало исходника:<br><br>; Segment type:	Pure data<br>off_0:		dw RESET		; RESET<br>		db 0FFh<br>		db 0FFh<br>INTWDT_:	dw 0FFFFh		; INTWDT<br>INTP0_:		dw 0FFFFh		; INTP0<br>INTP1_:		dw 0FFFFh		; INTP1<br>		dw INTP2_		; INTP2<br>INTSR_INTCSI0:	dw 0FFFFh		; INTSR_INTCSI0<br>INTST_:		dw 0FFFFh		; INTST<br>		dw INTTM0_		; INTTM0<br>		db 0FFh<br>		db 0FFh<br>INTTM2_:	dw 0FFFFh		; INTTM2<br>		db 0FFh<br>		db 0FFh<br><br><br>что означает оператор &quot;dw&quot; - например в первой строчке &quot;dw RESET&quot; - пока ее не закомментил - шла ругань при компиляции...<br><br>Извиняюсь за большое количество вопросов, но решил уж тут спросить не создавая новую тему...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277808&amp;user=26496&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=5" class="addthx" data-post="277808"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2011 18:46 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
Начни уже пользоваться кнопкой Правка, хватит их лепить подряд.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277810&amp;user=1556&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=6" class="addthx" data-post="277810"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2011 19:14 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<b>Androand</b><br>Честно говоря, RTFM.<br>Как ты вообще пытаешься разобрать прошивку, если не читал документацию?<br><br>Про поводу косяков иды - я не специалист. Надо брать документацию и сравнивать байты.<br>Касательно смещений - они могут быть относительные и абсолютные. Возможно, ида и правильно дасмит этот блок.<br>Блок из dw вначале - это блок &quot;векторов прерываний&quot;. В оригинале SDK содержит описание как назначить ту либо иную функцию вектору.<br><br>А что касается ассемблирования дампа иды, да и вообще анализа асма - это адское занятие для извращенцев. Я бы перевел это все хотя бы в Си и затем уже оптимизировал и анализировал.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277816&amp;user=11966&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=7" class="addthx" data-post="277816"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Androand[/b]','')">Androand</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.79'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26496">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 февраля 2011 11:45 <br><script type="text/javascript">QU('Androand','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Androand" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<I>Archer пишет:<br>Начни уже пользоваться кнопкой Правка, хватит их лепить подряд.  </I><br><br>извиняюсь, просто думал что повторное сообщение добавится автоматически к предыдущему, если никто не ответил вперед - на многих форумах так и реализовано... впредь буду добавлять сообщения через правку.<br><br><I>r_e пишет:<br>Как ты вообще пытаешься разобрать прошивку, если не читал документацию?</I><br><br>Что значит не читал ? я каждую спорную команду вручную по байтам по мануалу разбирал... просто хотел удостоверится что правильно все понял.<br><br><I>r_e пишет:<br>А что касается ассемблирования дампа иды, да и вообще анализа асма - это адское занятие для извращенцев. Я бы перевел это все хотя бы в Си и затем уже оптимизировал и анализировал.  </I><br><br>Ну перевод в Си это второй шаг - вначале очень хочется хотя бы на асме получить рабочий вариант - когда заведомо известные байты запроса алгоритмом этой прошивки переведутся в известные байты ответа - вот тогда можно будет говорить что точно известен кусок отвечающий за шифрование и преобразование, просто нет спецов по асму серьезных в команде - вот и получается этот ликбез - я вообще первый раз и ИДА работаю, а азы ассемблера были в институте 15 лет назад <img src="img/smilies/s1.gif" alt=""> Думал что тут народ серьезный и натасканный на ИДА и асм и подскажет что к чему...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277843&amp;user=26496&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=8" class="addthx" data-post="277843"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 февраля 2011 13:09 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
Тут народ натасканый по <b>x86</b> асму, а у тебя несколько иной проц, поэтому так вяло помогают.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277855&amp;user=3232&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=9" class="addthx" data-post="277855"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Androand[/b]','')">Androand</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.79'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26496">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 февраля 2011 18:07 <br><script type="text/javascript">QU('Androand','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Androand" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
ВСЕ, полностью вылизал отдизасмленный исходник прошивки - теперь после повторной компиляции получается прошивка один-в-один с оригинальной.<br><br>Подскажите куда лучше запостить кусок кода в котором просчитываются пары запрос-ответ - в принципе теперь можно минимизировать куски кода и оставить только нужные, ну и таблицу байт конечно же...<br><br>Просто раз тут нет спецов по МК, то может имеет смысл создать отдельную тему в софте - поскольку теперь вопросов к железяке нет никаких - есть следующее:<br><br>1. код на асме<br>2. есть пары запросов-ответов, которые без проблем обрабатываются этим кодом и таблицей байт<br>3. есть  пары запросов-ответов, которые не получаются при использовании этого кода и таблицы байт<br><br>собственно нужно мнение специалистов - возможно ли получить правильную таблицу байт, чтобы просчитывались правильно запросы-ответы из пункта 3, сможет ли кто реально помочь на этом форуме или по подобным софтовым проблемам и задачам лучше обращаться на васм (просто там висит подобная тема уж полгода и без особых результатов, хотя исходников на тот момент не было) ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=278131&amp;user=26496&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=10" class="addthx" data-post="278131"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 февраля 2011 18:18 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
Пакуйте исходник и аттачьте здесь.<br>Не помогают не потому что спецов нет, а потому что вопросы из разряда RTFM.<br><br>В идеале исходник перевести в язык высокого уровня. Получится компактней, а значит и легче анализировать.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=278133&amp;user=11966&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=11" class="addthx" data-post="278133"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Tyra[/b]','')">Tyra</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 78.7 (постоянный), 43thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.45'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3632">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 февраля 2011 20:07 <br><script type="text/javascript">QU('Tyra','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tyra" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
<b>Androand</b><br>Попробуй написать прогу на С++, оптимизмровать КОД и проверить, возвожность развернуть АЛГО ! Там Видно буит возможно или нет Просчитать новую таблицу !
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=278137&amp;user=3632&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=12" class="addthx" data-post="278137"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Androand[/b]','')">Androand</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.79'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26496">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 марта 2011 19:28 &middot; Поправил: Androand <br><script type="text/javascript">QU('Androand','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Androand" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<I>r_e пишет:<br>Пакуйте исходник и аттачьте здесь. </I><br><br>Запаковал в принципе всю сборку - может у кого то есть PM+ и SM+ для ядра 78k0S, тогда можно в симуляторе пошагово наблюдать процесс преобразования, хотя достать эти инструмены не проблема...<br><br>если смотреть только исходник, то он внутри - main.asm, основную его часть занимает таблица, реализована имитация получения запроса от консоли и размещение байт запроса в RAM<br>Запрос 0B 8000 C1EF1FBD294886BA <br>После отработки теста получается правильный ответ 1206 ABD08FBE6858FCC6 <br><br>Теперь немного умозаключений, пока игрался в симуляторе и гонял тест понял следующее:<br><br>в процессе участвуют:<br><br>1. 8 байт ключа которые генерит консоль (в случае теста C1EF1FBD294886BA)<br>2. область 00EC-015B для хранения 14 ключей по 8 байт (в тесте используется первый - адрес 00EC)<br>3. область 015С-062D для хранения байтов участвующих в XOR с байтами ключа - 7 областей размером 176 байт каждая (11 шагов по 16 байт), каждая область соответствует строго одному ключу, который определяется вторым байтом 80XX - в нашем случае это 8000 и область 015С-020B<br>3. область 062С-072B - 256 байт, самая важная область - отсюда берутся байты для основного преобразования функцией sub_EE3 (сдвиги, XOR четырех байтов ключа)<br><br>Теперь по алгоритму:<br><br>call !sub_78D<br>addw AX,#00ECh ; &#039;&#252;&#039;<br><br>тут в зависимости от второго байта команда 80XX определяется адрес ключа, для 8000 это 00EC, для 8004 - это 010С ну и т.д.<br><br>call !sub_F81<br>mov B,#02h<br>movw AX,#0FEBCh<br>call !sub_F81<br><br>это формирование 16 байт из 8 байт сгенеренных консолью и 8 байт ключа вытащенных из таблицы, причем формируется попарно 1-5, X ,2-6, X ,3-7, X ,4-8, потом вместо X также попарно вставляется ключ от консоли - вот и получилась первая мешанина из двух ключей по 8 байт - итого 16 байт рабочего ключа расположенного в RAM FEDA-FEE9 - именно тут будут формироваться байты ответа<br><br>call !sub_C36<br>вот это основной вход в алгоритм преобразования, внутри модификация байтов рабочего ключа и байтов из таблицы посредством XOR, потом идет ротация байтов в полученном ключе по схеме 6-8, 9-12, 10-11, 13-15, дальше идет сложение каждого полученного байта со смещением 062Ch и получением адреса таблицы из которой выдергивается байт замены, потом все это в четыре прохода обрабатывается путем сдвига и XOR по 4 байта (в первый проход используются 1,5,9,13 байты) - ну и все это повторяется в общей сложности 11 раз<br><br>mov B,#00h<br>movw AX,#0FEBBh<br>call !sub_F90<br><br>ну эти последние три строчки можно и не рассматривать - тут просто байты ответа складываются в правильный вид и переносятся в RAM FEBB-FEC2 , т.е. из 16 байт рабочего ключа формируются 8 байт ответа по схеме:<br>1-5,9-13,2-6,10-14 <br>и на этом все...   <br><br><img src="img/attach.gif" alt=""> <a href="./files/43ca_01.03.2011_CRACKLAB.rU.tgz">43ca_01.03.2011_CRACKLAB.rU.tgz</a> - minitest.rar<br><br>З.Ы. Забыл добавить в этом примере ключ для команды 8004 заменен на FF, может кто то с ходу его воспроизведет из таблицы байт или проанализировав пары запросов-ответов - в исходнике есть парочка...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=278193&amp;user=26496&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=13" class="addthx" data-post="278193"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 марта 2011 21:25 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
Ну, осталось совсем немного и можешь статью писать <img src="img/smilies/s1.gif" alt=""><br>Переводи теперь это все в си или любой другой ЯВУ.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;sub_F4E<span class="hl_char">(</span>Buffer&nbsp;<span class="hl_char">=</span>&nbsp;0xFEDA<span class="hl_char">)</span></li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;SwapBytes<span class="hl_char">(</span>pu8_t&nbsp;Buffer<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Buffer<span class="hl_char">[</span>0x5<span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;Buffer<span class="hl_char">[</span>0x7<span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;Buffer<span class="hl_char">[</span>0x5<span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;Buffer<span class="hl_char">[</span>0x7<span class="hl_char">]</span><span class="hl_comment">; // swap(5, 7)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Buffer<span class="hl_char">[</span>0x8<span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;Buffer<span class="hl_char">[</span>0xB<span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;Buffer<span class="hl_char">[</span>0x8<span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;Buffer<span class="hl_char">[</span>0xB<span class="hl_char">]</span><span class="hl_comment">; // swap(8, B)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Buffer<span class="hl_char">[</span>0x9<span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;Buffer<span class="hl_char">[</span>0xA<span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;Buffer<span class="hl_char">[</span>0x9<span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;Buffer<span class="hl_char">[</span>0xA<span class="hl_char">]</span><span class="hl_comment">; // swap(9, A)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Buffer<span class="hl_char">[</span>0xC<span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;Buffer<span class="hl_char">[</span>0xE<span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;Buffer<span class="hl_char">[</span>0xC<span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;Buffer<span class="hl_char">[</span>0xE<span class="hl_char">]</span><span class="hl_comment">; // swap(C, E)</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div>
<br><br>Дальше будет еще легше.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=278198&amp;user=11966&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=14" class="addthx" data-post="278198"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]rr222[/b]','')">rr222</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.7 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.36'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28195">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2011 04:42 &middot; Поправил: rr222 <br><script type="text/javascript">QU('rr222','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rr222" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
товарищи <img src="img/smilies/s8.gif" alt=""> почему тут никто еще про слово из трех буквы &quot;DES&quot; не вспомнил? <br>очень похоже на него, на вид выглядит как <img src="img/smilies/s16.gif" alt=""> мусор,  легкий и удобный в использовании+ немного в памяти занимает, в 6х6мм точно влезает, да и китайцы его любят.<br><br><br>upd/ AES   ru.wikipedia.org/wiki/Rijndael <br><br><br><img src="img/attach.gif" alt=""> <a href="./files/e9c2_01.03.2011_CRACKLAB.rU.tgz">e9c2_01.03.2011_CRACKLAB.rU.tgz</a> - 78K0S.png
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=278213&amp;user=28195&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=15" class="addthx" data-post="278213"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2011 11:41 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
DES сделать можно.<br>Для AESа ключ маловат, да и таблиц тоже маловато.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=278232&amp;user=11966&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=16" class="addthx" data-post="278232"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Androand[/b]','')">Androand</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.79'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26496">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2011 13:03 &middot; Поправил: Androand <br><script type="text/javascript">QU('Androand','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Androand" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
<I>rr222 пишет:<br>товарищи почему тут никто еще про слово из трех буквы &quot;DES&quot; не вспомнил?  </I><br><br>Так вроде для DES размер ключа 56 бит и 16 циклов, а тут только размер входного блока совпадает - 64 бита, а размер ключа получается 128 бит, поскольку собирается из байт входного блока и ключа из таблицы, хотя может это уже элемент преобразования, но циклов точно не 16<br><br><I>r_e пишет:<br>Переводи теперь это все в си или любой другой ЯВУ </I><br><br>Ну да осталось теперь до кучи СИ и яву выучить <img src="img/smilies/s1.gif" alt=""> Ты явно для примера выбрал самую простую процедуру - обычный своп переменных - на VB я тоже так могу с полпинка написать, а вот как быть с кусками посложнее, да еще с таблицей этой и эмуляцией RAM - в массивы что ли все загонять ?<br><br>И по поводу таблицы, ведь должна какая то зависимость быть между 8 байтами ключа и 11 вариантами по 16 байт участвующими в XOR<br><br>ключ - D2072253A4F27468<br><br>варианты для цикла<br>01 - 5CF389EC5282D816D9AC81291CA4787B<br>02 - 1AE9608CF775ADBBF854D5FCD2760E75<br>03 - F21B7BF747329F246531E418B6C0CEBB<br>04 - C0DBA057EAD847638FBE5A42DE1ED06B<br>05 - 33E8481FC61E593AF04E1456859B4B20<br>06 - A34B031C7769300A47091D4B45DE95B5<br>07 - E4AFACB0C4AD9D97929B86CDD9079227<br>08 - 2C832F9F79D449DE5EC5438E3E39AB8C<br>09 - B1321D8260B4FD233AFFBC32E5DC77FB<br>10 - 8CBEA32143F70A2935CA7644F62A5DA6<br>11 - 1FA1022358AFA58C11DBADE90B217CDA<br><br>ведь если это будут любые произвольные байты то результата может не получится или я не прав ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=278240&amp;user=26496&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=17" class="addthx" data-post="278240"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]rr222[/b]','')">rr222</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.7 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.36'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28195">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2011 14:27 <br><script type="text/javascript">QU('rr222','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rr222" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
ключ там фиксированый , при TXEncrypt  получается строка D2072253A4F27468<br><br>каждый шаг зависит от предыдущего, так как внутри в des ключ ксорится, но вам об этом заморачиватся не нужно как оно там и что делает, вам нужно  скорее всего : <br><br>initkey (xxxx.. 8 байт)  не  B7A80076B00587EC  а какой-то другой стандартный, в начале всего процесса<br>вот после инита <br>zzz= Encript(yyyy)   должно дать B7A80076B00587EC <br><br>далее уже вы делаете Tx(5A 0B 8004 zzz crc)    <br><br>0B тут кстати длина пакета, как в ответе &quot;a5 12 06...&quot;   12 это длина <br><br>des разные бывают варианты по длине ключа/пакета и тп, скачайте тут и посмотрите хелпы <br><noindex><a href="--&gt; http://www.cityinthesky.co.uk/_media/opensource/dcpcrypt2.zip &lt;--" rel="nofollow" target="_blank">--&gt; http://www.cityinthesky.co.uk/_media/opensource/dcpcrypt2.zip &lt;--</a></noindex> мне оно очень в свое время помогло...  провозившись месяц подобно вашему, вышел всетаки на это..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=278251&amp;user=28195&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=18" class="addthx" data-post="278251"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=26496" title="02-03-2011 13:39, ранг:7.1" target="_blank">Androand</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Androand[/b]','')">Androand</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.79'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26496">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2011 15:26 &middot; Поправил: Androand <br><script type="text/javascript">QU('Androand','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Androand" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
<I>rr222 пишет:<br>ключ там фиксированый , при TXEncrypt получается строка D2072253A4F27468<br></I><br>Там - это где ? и строка D2072253A4F27468 никак не получается - она жестко прописана в таблице, как и 11 вариантов по 16 байт - вот я и спрашивал по какой зависимости они формируются из 8 байт или это с потолка набрали байты...<br><br><br><I>rr222 пишет:<br>каждый шаг зависит от предыдущего, так как внутри в des ключ ксорится, но вам об этом заморачиватся не нужно как оно там и что делает, вам нужно скорее всего :<br>initkey (xxxx.. 8 байт) не B7A80076B00587EC а какой-то другой стандартный, в начале всего процесса </I><br><br>initkey конечно не  B7A80076B00587EC а именно D2072253A4F27468, поскольку B7A80076B00587EC - это ключ который генерит консоль - это вторая составляющая рабочего ключа в 16 байт, она каждый раз разная а вот initkey стационарный и не меняемый....<br><br><I>rr222 пишет:<br>zzz= Encript(yyyy) должно дать B7A80076B00587EC<br><br>далее уже вы делаете Tx(5A 0B 8004 zzz crc)<br><br>0B тут кстати длина пакета, как в ответе &quot;a5 12 06...&quot; 12 это длина <br></I><br><br>Бред какой то, к чему этот ликбез про длину пакетов ? <br>И zzz= Encript(B7A80076B00587EC) должно дать 6C8487344210CF9A<br><br>Если не понятно то <br>;5A0B 8004 <b>B7A80076B00587EC</b> 19 - это ЗАПРОС<br>;A51206 <b>6C8487344210CF9A</b>	FAF4513AA460B39F 0D - это ОТВЕТ и нужны в нем первые 8 байт<br><br>но в приаттаченном выше примере работает только эта пара:<br>;5A0B 8000 C1EF1FBD294886BA DD<br>;A51206 ABD08FBE6858FCC6 2743DFD5C44A8BA3 9E ;<br><br>поскольку начальный ключ (initkey в вашей терминологии) для команды 8004 затерт на FF<br><br><I>rr222 пишет:<br>des разные бывают варианты по длине ключа/пакета и тп, скачайте тут и посмотрите хелпы<br>--&gt; http://www.cityinthesky.co.uk/_media/opensource/dcpcrypt2.zip &lt;-- мне оно очень в свое время помогло... провозившись месяц подобно вашему, вышел всетаки на это..  </I><br><br>А вот за это СПАСИБО!!!<br><br>нашел в файле DCPrijndael.inc  некую таблицу<br><br>  T4: array[0..255,0..3] of byte= (<br>    (&#036;63,&#036;63,&#036;a5,&#036;c6), (&#036;7c,&#036;7c,&#036;84,&#036;f8), (&#036;77,&#036;77,&#036;99,&#036;ee), (&#036;7b,&#036;7b,&#036;8d,&#036;f6),<br>    (&#036;f2,&#036;f2,&#036;0d,&#036;ff), (&#036;6b,&#036;6b,&#036;bd,&#036;d6), (&#036;6f,&#036;6f,&#036;b1,&#036;de), (&#036;c5,&#036;c5,&#036;54,&#036;91),<br>    (&#036;30,&#036;30,&#036;50,&#036;60), (&#036;01,&#036;01,&#036;03,&#036;02), (&#036;67,&#036;67,&#036;a9,&#036;ce), (&#036;2b,&#036;2b,&#036;7d,&#036;56),<br>    (&#036;fe,&#036;fe,&#036;19,&#036;e7), (&#036;d7,&#036;d7,&#036;62,&#036;b5), (&#036;ab,&#036;ab,&#036;e6,&#036;4d), (&#036;76,&#036;76,&#036;9a,&#036;ec), <br><br>так вот ее значения (первые элементы массивов) очень похожи на область 062С-072B <br>&quot;637C777BF26B6FC53001672BFED7AB76....&quot; - откуда берутся байты для подстановки и дальнейшей модификации - вряд ли это совпадение....<br><br>значит это AES-128 ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=278253&amp;user=26496&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=19" class="addthx" data-post="278253"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2011 17:21 &middot; Поправил: PE_Kill <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
<b>Androand</b> да, скорее всего это AES-128<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Substitution&nbsp;table<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_number">637C777B</span>&nbsp;F26B6FC5&nbsp;<span class="hl_number">3001672B</span>&nbsp;FED7AB76</li><li class="hl_l1">&nbsp;CA82C97D&nbsp;FA5947F0&nbsp;ADD4A2AF&nbsp;<span class="hl_number">9CA472C0</span></li><li class="hl_l0">&nbsp;B7FD9326&nbsp;<span class="hl_number">363FF7CC</span>&nbsp;<span class="hl_number">34A5E5F1</span>&nbsp;<span class="hl_number">71D83115</span></li><li class="hl_l1">&nbsp;<span class="hl_number">04C723C3</span>&nbsp;<span class="hl_number">1896059A</span>&nbsp;<span class="hl_number">071280E2</span>&nbsp;EB27B275</li><li class="hl_l0">&nbsp;<span class="hl_number">09832C1A</span>&nbsp;<span class="hl_number">1B6E5AA0</span>&nbsp;<span class="hl_number">523BD6B3</span>&nbsp;<span class="hl_number">29E32F84</span></li><li class="hl_l1">&nbsp;<span class="hl_number">53D100ED</span>&nbsp;<span class="hl_number">20FCB15B</span>&nbsp;<span class="hl_number">6ACBBE39</span>&nbsp;<span class="hl_number">4A4C58CF</span></li><li class="hl_l0">&nbsp;D0EFAAFB&nbsp;<span class="hl_number">434D3385</span>&nbsp;<span class="hl_number">45F9027F</span>&nbsp;<span class="hl_number">503C9FA8</span></li><li class="hl_l1">&nbsp;<span class="hl_number">51A3408F</span>&nbsp;<span class="hl_number">929D38F5</span>&nbsp;BCB6DA21&nbsp;<span class="hl_number">10FFF3D2</span></li><li class="hl_l0">&nbsp;CD0C13EC&nbsp;<span class="hl_number">5F974417</span>&nbsp;C4A77E3D&nbsp;<span class="hl_number">645D1973</span></li><li class="hl_l1">&nbsp;<span class="hl_number">60814FDC</span>&nbsp;<span class="hl_number">222A9088</span>&nbsp;<span class="hl_number">46EEB814</span>&nbsp;DE5E0BDB</li><li class="hl_l0">&nbsp;E0323A0A&nbsp;<span class="hl_number">4906245C</span>&nbsp;C2D3AC62&nbsp;<span class="hl_number">9195E479</span></li><li class="hl_l1">&nbsp;E7C8376D&nbsp;<span class="hl_number">8DD54EA9</span>&nbsp;<span class="hl_number">6C56F4EA</span>&nbsp;<span class="hl_number">657AAE08</span></li><li class="hl_l0">&nbsp;BA78252E&nbsp;<span class="hl_number">1CA6B4C6</span>&nbsp;E8DD741F&nbsp;<span class="hl_number">4BBD8B8A</span></li><li class="hl_l1">&nbsp;<span class="hl_number">703EB566</span>&nbsp;<span class="hl_number">4803F60E</span>&nbsp;<span class="hl_number">613557B9</span>&nbsp;<span class="hl_number">86C11D9E</span></li><li class="hl_l0">&nbsp;E1F89811&nbsp;<span class="hl_number">69D98E94</span>&nbsp;<span class="hl_number">9B1E87E9</span>&nbsp;CE5528DF</li><li class="hl_l1">&nbsp;<span class="hl_number">8CA1890D</span>&nbsp;BFE64268&nbsp;<span class="hl_number">41992D0F</span>&nbsp;B054BB16</li>        </ol>
    </div>
</div></div>
<br><br>PS Вот остальные таблицы AES&#039;а:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Inversion&nbsp;table<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_number">00018DF6</span>&nbsp;CB527BD1&nbsp;E84F29C0&nbsp;B0E1E5C7</li><li class="hl_l1">&nbsp;<span class="hl_number">74B4AA4B</span>&nbsp;<span class="hl_number">992B605F</span>&nbsp;<span class="hl_number">583FFDCC</span>&nbsp;FF40EEB2</li><li class="hl_l0">&nbsp;<span class="hl_number">3A6E5AF1</span>&nbsp;<span class="hl_number">554DA8C9</span>&nbsp;C10A9815&nbsp;<span class="hl_number">3044A2C2</span></li><li class="hl_l1">&nbsp;<span class="hl_number">2C45926C</span>&nbsp;F3396642&nbsp;F235206F&nbsp;<span class="hl_number">77BB5919</span></li><li class="hl_l0">&nbsp;<span class="hl_number">1DFE3767</span>&nbsp;<span class="hl_number">2D31F569</span>&nbsp;A764AB13&nbsp;<span class="hl_number">5425E909</span></li><li class="hl_l1">&nbsp;ED5C05CA&nbsp;<span class="hl_number">4C2487BF</span>&nbsp;<span class="hl_number">183E22F0</span>&nbsp;<span class="hl_number">51EC6117</span></li><li class="hl_l0">&nbsp;<span class="hl_number">165EAFD3</span>&nbsp;<span class="hl_number">49A63643</span>&nbsp;F44791DF&nbsp;<span class="hl_number">3393213B</span></li><li class="hl_l1">&nbsp;<span class="hl_number">79B79785</span>&nbsp;<span class="hl_number">10B5BA3C</span>&nbsp;B670D006&nbsp;A1FA8182</li><li class="hl_l0">&nbsp;<span class="hl_number">837E7F80</span>&nbsp;<span class="hl_number">9673BE56</span>&nbsp;<span class="hl_number">9B9E95D9</span>&nbsp;F702B9A4</li><li class="hl_l1">&nbsp;DE6A326D&nbsp;D88A8472&nbsp;<span class="hl_number">2A149F88</span>&nbsp;F9DC899A</li><li class="hl_l0">&nbsp;FB7C2EC3&nbsp;<span class="hl_number">8FB86548</span>&nbsp;<span class="hl_number">26C8124A</span>&nbsp;CEE7D262</li><li class="hl_l1">&nbsp;<span class="hl_number">0CE01FEF</span>&nbsp;<span class="hl_number">11757871</span>&nbsp;A58E763D&nbsp;BDBC8657</li><li class="hl_l0">&nbsp;<span class="hl_number">0B282FA3</span>&nbsp;DAD4E40F&nbsp;A9275304&nbsp;<span class="hl_number">1BFCACE6</span></li><li class="hl_l1">&nbsp;<span class="hl_number">7A07AE63</span>&nbsp;C5DBE2EA&nbsp;<span class="hl_number">948BC4D5</span>&nbsp;<span class="hl_number">9DF8906B</span></li><li class="hl_l0">&nbsp;B10DD6EB&nbsp;C60ECFAD&nbsp;<span class="hl_number">084ED7E3</span>&nbsp;<span class="hl_number">5D501EB3</span></li><li class="hl_l1">&nbsp;<span class="hl_number">5B233834</span>&nbsp;<span class="hl_number">6846038C</span>&nbsp;DD9C7DA0&nbsp;CD1A411C</li>        </ol>
    </div>
</div></div>
<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Inverse&nbsp;Substitution&nbsp;table<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_number">52096AD5</span>&nbsp;<span class="hl_number">3036A538</span>&nbsp;BF40A39E&nbsp;<span class="hl_number">81F3D7FB</span></li><li class="hl_l1">&nbsp;<span class="hl_number">7CE33982</span>&nbsp;<span class="hl_number">9B2FFF87</span>&nbsp;<span class="hl_number">348E4344</span>&nbsp;C4DEE9CB</li><li class="hl_l0">&nbsp;<span class="hl_number">547B9432</span>&nbsp;A6C2233D&nbsp;EE4C950B&nbsp;<span class="hl_number">42FAC34E</span></li><li class="hl_l1">&nbsp;<span class="hl_number">082EA166</span>&nbsp;<span class="hl_number">28D924B2</span>&nbsp;<span class="hl_number">765BA249</span>&nbsp;<span class="hl_number">6D8BD125</span></li><li class="hl_l0">&nbsp;<span class="hl_number">72F8F664</span>&nbsp;<span class="hl_number">86689816</span>&nbsp;D4A45CCC&nbsp;<span class="hl_number">5D65B692</span></li><li class="hl_l1">&nbsp;<span class="hl_number">6C704850</span>&nbsp;FDEDB9DA&nbsp;<span class="hl_number">5E154657</span>&nbsp;A78D9D84</li><li class="hl_l0">&nbsp;<span class="hl_number">90D8AB00</span>&nbsp;<span class="hl_number">8CBCD30A</span>&nbsp;F7E45805&nbsp;B8B34506</li><li class="hl_l1">&nbsp;D02C1E8F&nbsp;CA3F0F02&nbsp;C1AFBD03&nbsp;<span class="hl_number">01138A6B</span></li><li class="hl_l0">&nbsp;<span class="hl_number">3A911141</span>&nbsp;<span class="hl_number">4F67DCEA</span>&nbsp;<span class="hl_number">97F2CFCE</span>&nbsp;F0B4E673</li><li class="hl_l1">&nbsp;<span class="hl_number">96AC7422</span>&nbsp;E7AD3585&nbsp;E2F937E8&nbsp;<span class="hl_number">1C75DF6E</span></li><li class="hl_l0">&nbsp;<span class="hl_number">47F11A71</span>&nbsp;<span class="hl_number">1D29C589</span>&nbsp;<span class="hl_number">6FB7620E</span>&nbsp;AA18BE1B</li><li class="hl_l1">&nbsp;FC563E4B&nbsp;C6D27920&nbsp;<span class="hl_number">9ADBC0FE</span>&nbsp;<span class="hl_number">78CD5AF4</span></li><li class="hl_l0">&nbsp;<span class="hl_number">1FDDA833</span>&nbsp;<span class="hl_number">8807C731</span>&nbsp;B1121059&nbsp;<span class="hl_number">2780EC5F</span></li><li class="hl_l1">&nbsp;<span class="hl_number">60517FA9</span>&nbsp;<span class="hl_number">19B54A0D</span>&nbsp;<span class="hl_number">2DE57A9F</span>&nbsp;<span class="hl_number">93C99CEF</span></li><li class="hl_l0">&nbsp;A0E03B4D&nbsp;AE2AF5B0&nbsp;C8EBBB3C&nbsp;<span class="hl_number">83539961</span></li><li class="hl_l1">&nbsp;<span class="hl_number">172B047E</span>&nbsp;BA77D626&nbsp;E1691463&nbsp;<span class="hl_number">55210C7D</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=278260&amp;user=3232&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=20" class="addthx" data-post="278260"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=28195" title="03-03-2011 05:40, ранг:2.0" target="_blank">rr222</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Androand[/b]','')">Androand</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.79'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26496">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2011 17:43 <br><script type="text/javascript">QU('Androand','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Androand" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
Ну в общем перелопатил я алгоритм и сбацал программку которая просчитывает ответ для запроса, пытался идти от классического AES-128, но в отладке понял что принцип в батарейке немного другой, ощущение что от AES взяли только таблицу подстановок, 11 раундов и как то механизм изменения байт с  хитрым сдвигом и XOR, ну и еще размер - 16 байт входных данных и 16 байт раундового ключа...<br><br><br>в общем весь алг оказался не таким и сложным, но однозначно не понятным<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>Public</b></span>&nbsp;<span class="hl_function"><b>Sub</b></span>&nbsp;EncryptNec<span class="hl_char">(</span>buff<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;As&nbsp;<span class="hl_function">Byte</span><span class="hl_char">,</span>&nbsp;r_key<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;As&nbsp;Variant<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;<span class="hl_function">Byte</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;j&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;<span class="hl_function">Byte</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;r&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;<span class="hl_function">Byte</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;<span class="hl_function">Byte</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;a<span class="hl_char">(</span><span class="hl_number">15</span><span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;As&nbsp;<span class="hl_function">Byte</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;y<span class="hl_char">(</span><span class="hl_number">15</span><span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;As&nbsp;<span class="hl_function">Byte</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;Debug<span class="hl_char">.</span>Print&nbsp;<span class="hl_quote">&quot;вход: &quot;</span>&nbsp;<span class="hl_char">&amp;</span>&nbsp;Arr2Hex<span class="hl_char">(</span>buff<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;Debug<span class="hl_char">.</span>Print&nbsp;<span class="hl_quote">&quot;key0: &quot;</span>&nbsp;<span class="hl_char">&amp;</span>&nbsp;Arr2Hex<span class="hl_char">(</span>r_key<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;' 1 раунд - XOR с первым раундовым ключем</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">For&nbsp;r&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;To&nbsp;<span class="hl_number">9</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;'реализация процедуры sub_F9F и sub_F4E в одном флаконе</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">2</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">2</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">2</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">3</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">3</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">3</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">4</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">5</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">5</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">5</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">6</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">6</span><span class="hl_char">)</span>&nbsp;' rotate 5-7</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">6</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">7</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">7</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">7</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">4</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">4</span><span class="hl_char">)</span>&nbsp;' rotate 5-7</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">8</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">10</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">10</span><span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;' rotate 8-11</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">9</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">11</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">11</span><span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;' rotate 9-10</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">10</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">8</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">8</span><span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;&nbsp;' rotate 9-10</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">11</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">9</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">9</span><span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;&nbsp;' rotate 8-11</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">12</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">15</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">15</span><span class="hl_char">)</span>&nbsp;&nbsp;' rotate 12-14</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">13</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">12</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">12</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">14</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">13</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">13</span><span class="hl_char">)</span>&nbsp;&nbsp;' rotate 12-14</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span><span class="hl_number">15</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span><span class="hl_number">14</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span>r<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_number">14</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;'реализация процедуры sub_FD4 - подстановка байт</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;To&nbsp;<span class="hl_number">15</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a<span class="hl_char">(</span>i<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;m_fbsub<span class="hl_char">(</span>a<span class="hl_char">(</span>i<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;Next&nbsp;i</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">'    Debug.Print &quot;шаг1: &quot; &amp; Arr2Hex(a)</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>If</b></span>&nbsp;r&nbsp;<span class="hl_char">&lt;</span>&nbsp;<span class="hl_number">9</span>&nbsp;Then</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'реализация процедуры sub_EE3</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;j&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;To&nbsp;<span class="hl_number">3</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;<span class="hl_char">=</span>&nbsp;a<span class="hl_char">(</span>j<span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;a<span class="hl_char">(</span>j&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">12</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;a<span class="hl_char">(</span>j&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;a<span class="hl_char">(</span>j&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">)</span>&nbsp;' то что кладем в регистр X</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y<span class="hl_char">(</span>j<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;a<span class="hl_char">(</span>j<span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;x&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;LShiftByteNec<span class="hl_char">(</span>a<span class="hl_char">(</span>j<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;LShiftByteNec<span class="hl_char">(</span>a<span class="hl_char">(</span>j&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y<span class="hl_char">(</span>j&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;a<span class="hl_char">(</span>j&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;x&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;LShiftByteNec<span class="hl_char">(</span>a<span class="hl_char">(</span>j&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;LShiftByteNec<span class="hl_char">(</span>a<span class="hl_char">(</span>j&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y<span class="hl_char">(</span>j&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;a<span class="hl_char">(</span>j&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;x&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;LShiftByteNec<span class="hl_char">(</span>a<span class="hl_char">(</span>j&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;LShiftByteNec<span class="hl_char">(</span>a<span class="hl_char">(</span>j&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">12</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y<span class="hl_char">(</span>j&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">12</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;a<span class="hl_char">(</span>j&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">12</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;x&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;LShiftByteNec<span class="hl_char">(</span>a<span class="hl_char">(</span>j&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">12</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;LShiftByteNec<span class="hl_char">(</span>a<span class="hl_char">(</span>j<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Next</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Переносим результат после очередного шага</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;To&nbsp;<span class="hl_number">15</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buff<span class="hl_char">(</span>i<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;y<span class="hl_char">(</span>i<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Next&nbsp;i</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">Else</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Переносим результат после очередного шага</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;To&nbsp;<span class="hl_number">15</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buff<span class="hl_char">(</span>i<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;a<span class="hl_char">(</span>i<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Next&nbsp;i</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>End</b></span>&nbsp;<span class="hl_function">If</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;'Debug.Print &quot;_EE3-&quot; &amp; r &amp; &quot;: &quot; &amp; Arr2Hex(buff)</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">Next&nbsp;r</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;'последний раунд XOR</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;To&nbsp;<span class="hl_number">15</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buff<span class="hl_char">(</span>i<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;buff<span class="hl_char">(</span>i<span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;r_key<span class="hl_char">(</span><span class="hl_number">10</span><span class="hl_char">)</span><span class="hl_char">(</span>i<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;Next&nbsp;i</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">'    Debug.Print &quot;_EE3-&quot; &amp; r &amp; &quot;: &quot; &amp; Arr2Hex(a)</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>End</b></span>&nbsp;<span class="hl_function">Sub</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">'Процедура сдвига влево с учетов переполнения и коррекции</li><li class="hl_l0">Private&nbsp;Function&nbsp;LShiftByteNec<span class="hl_char">(</span>ByVal&nbsp;bytValue&nbsp;As&nbsp;Integer<span class="hl_char">,</span>&nbsp;_</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByVal&nbsp;bytShiftBits&nbsp;As&nbsp;</span><span class="hl_function">Byte</span><span class="hl_char">)</span>&nbsp;As&nbsp;<span class="hl_function">Byte</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">bytValue&nbsp;<span class="hl_char">=</span>&nbsp;LShift<span class="hl_char">(</span>bytValue<span class="hl_char">,</span>&nbsp;bytShiftBits<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>If</b></span>&nbsp;bytValue&nbsp;<span class="hl_char">&gt;</span>&nbsp;<span class="hl_char">&amp;</span>HFF&nbsp;Then</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;LShiftByteNec&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>bytValue&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_char">&amp;</span>HFF<span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>Xor</b></span>&nbsp;<span class="hl_char">&amp;</span>H1A</li><li class="hl_l1"><span class="hl_function">Else</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;LShiftByteNec&nbsp;<span class="hl_char">=</span>&nbsp;bytValue</li><li class="hl_l1"><span class="hl_function"><b>End</b></span>&nbsp;<span class="hl_function">If</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>End</b></span>&nbsp;Function</li><li class="hl_l0">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br>Теперь вопрос знатокам - что же это за AES такой и реально ли просчитать раундовые ключи ? Минус еще в том что оказался неизвестен еще один параметр - 8-ми байтный довесок - при помощи его формируются рабочие 16 байт входных данных -  получается что известны только 8 байт из 16 входных и на выходе точно есть правильных 8 байт. <br><br>Или это полный тупик с единственным выходом - пожизненным перебором байт ?<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/8d43_18.03.2011_CRACKLAB.rU.tgz">8d43_18.03.2011_CRACKLAB.rU.tgz</a> - pspkeygen.vbp
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=279358&amp;user=26496&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=21" class="addthx" data-post="279358"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Androand[/b]','')">Androand</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.79'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26496">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 марта 2011 17:48 <br><script type="text/javascript">QU('Androand','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Androand" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
Блин в предыдущем посте прикрепился не тот файл <img src="img/smilies/s9.gif" alt=""> не знаю как вложение отредактировать тут...<br><br><img src="img/attach.gif" alt=""> <a href="./files/251a_18.03.2011_CRACKLAB.rU.tgz">251a_18.03.2011_CRACKLAB.rU.tgz</a> - PSPKeyGen.exe
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=279359&amp;user=26496&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=22" class="addthx" data-post="279359"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Yokel[/b]','')">Yokel</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 92.4 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.35'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10326">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 сентября 2011 04:47 <br><script type="text/javascript">QU('Yokel','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Yokel" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
Не кто не знает удалось ли боряну сделать свою чудо батарейку?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=291090&amp;user=10326&amp;forum_n=17&amp;topic=17776&amp;page=1&amp;anchor=23" class="addthx" data-post="291090"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=17&amp;topic=17776&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=17&amp;topic=17776&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/rt.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=17&sortBy=0&page=0.html"><b>Электроника</b></a> <b class=bulletHead>&#8212;&#8250;</b> Неизвестный алгоритм обмена. Помогите..</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#24" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="17">
<input type="hidden" name="topic" value="17776">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=17776" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
