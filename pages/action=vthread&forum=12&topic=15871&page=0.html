<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>OOTT(Pashkin) blog: на пути истины - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Driver mod (on). Интересы меняются - всего хочется попробовать, завело меня в степи ring0, захотелось ченить покодить. Начитался литературы, накачал инструментов, решил повелосипедить))) Вобщем в этой теме хотелось бы задавать">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/blog.png" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=12&sortBy=0&page=0.html"><b>Дневники и блоги</b></a> <b class=bulletHead>&#8212;&#8250;</b> OOTT(Pashkin) blog: на пути истины</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Oott[/b]','')">Oott</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/14476.jpg" alt=""><br><span class=txtSm>Ранг: 106.9 (ветеран), 27thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.6'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=14476">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2010 14:52 <br><script type="text/javascript">QU('Oott','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Oott" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15871.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Driver mod (on).<br>Интересы меняются - всего хочется попробовать, завело меня в степи ring0, захотелось ченить покодить. Начитался литературы, накачал инструментов, решил повелосипедить)))<br>Вобщем в этой теме хотелось бы задавать различные вопросы в облости крека и програмирования по мере появления новых интересов.<br>Вобще цель написать дампер, отточить навыки, получит незаменимый опыт<img src="img/smilies/s2.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=252421&amp;user=14476&amp;forum_n=12&amp;topic=15871.html&amp;page=0&amp;anchor=1" class="addthx" data-post="252421"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Oott[/b]','')">Oott</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/14476.jpg" alt=""><br><span class=txtSm>Ранг: 106.9 (ветеран), 27thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.6'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=14476">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2010 15:30 &middot; Поправил: Oott <br><script type="text/javascript">QU('Oott','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Oott" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15871.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
1.<br>Что юзаю: DDK, notepad++, Dbgview, KmdManager.<br>Cи знаю таксе, вобщем фигово, но мне хватало)))<br>Для начала решил написать диспетчер процессов.<br> чёта всё как-то непривычно, вот велосипед:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;</li><li class="hl_l1">бля<span class="hl_char">,</span>&nbsp;пока&nbsp;копировал&nbsp;код&nbsp;<span class="hl_char">-</span>&nbsp;нашёл&nbsp;ошибку&nbsp;<span class="hl_char">-</span>&nbsp;сорри</li><li class="hl_l0">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><img src="img/smilies/s6.gif" alt=""> <img src="img/smilies/s6.gif" alt=""> <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=252426&amp;user=14476&amp;forum_n=12&amp;topic=15871.html&amp;page=0&amp;anchor=2" class="addthx" data-post="252426"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2010 22:07 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15871.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Дампер? Процессов, видимо. Сразу 2 пути тогда: обходить VAD или PDE/PTE, выбирай.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=252461&amp;user=1556&amp;forum_n=12&amp;topic=15871.html&amp;page=0&amp;anchor=3" class="addthx" data-post="252461"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Oott[/b]','')">Oott</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/14476.jpg" alt=""><br><span class=txtSm>Ранг: 106.9 (ветеран), 27thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.6'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=14476">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2010 23:03 <br><script type="text/javascript">QU('Oott','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Oott" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15871.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Да, процессов. А что насчёт +/-  у этих способов? Я так думаю, существующих решения больше через VAD.<br><br>Чтобы не быть голословным вот кодец, который хотел выложить, но когда смотрел нет ли ошибок в сообщении, нашёл таки ошибку в коде.<br>надо заполнить буфер информацией о процессах, через ZwQuerySystemInformation<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;</li><li class="hl_l1">PVOID&nbsp;GetSysInfo<span class="hl_char">(</span><span class="hl_function"><b>IN</b></span>&nbsp;<span class="hl_function"><b>INT</b></span>&nbsp;informationType<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;NTSTATUS&nbsp;status<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;PVOID&nbsp;buffer&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;ULONG&nbsp;size&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;DbgPrint<span class="hl_char">(</span><span class="hl_quote">&quot;MemTest Function Strat..\n&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;do</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer&nbsp;<span class="hl_char">=</span>&nbsp;SNU_ALLOC_MEM<span class="hl_char">(</span>NonPagedPool<span class="hl_char">,</span>&nbsp;size<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>buffer<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;<span class="hl_char">=</span>&nbsp;ZwQuerySystemInformation<span class="hl_char">(</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;informationType</span><span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer</span><span class="hl_char">,</span>&nbsp;size<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>NULL</b></span>&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>status&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;STATUS_INFO_LENGTH_MISMATCH<span class="hl_char">)</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNU_FREE_MEM</span><span class="hl_char">(</span>buffer<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>else</b></span>&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>NT_SUCCESS<span class="hl_char">(</span>status<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNU_FREE_MEM</span><span class="hl_char">(</span>buffer<span class="hl_char">)</span><span class="hl_comment">; </span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hl_function"><b>NULL</b></span><span class="hl_comment">; </span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;{&nbsp;<span class="hl_function"><b>break</b></span><span class="hl_comment">;}		</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>status&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;STATUS_INFO_LENGTH_MISMATCH<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DbgPrint<span class="hl_char">(</span><span class="hl_quote">&quot;Size %x\n&quot;</span><span class="hl_char">,</span>size<span class="hl_char">)</span><span class="hl_comment">;	</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DbgPrint<span class="hl_char">(</span><span class="hl_quote">&quot;Adr %x\n&quot;</span><span class="hl_char">,</span>buffer<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;buffer<span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br>найдите ошибку)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=252468&amp;user=14476&amp;forum_n=12&amp;topic=15871.html&amp;page=0&amp;anchor=4" class="addthx" data-post="252468"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]OKOB[/b]','')">OKOB</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6801.png" alt=""><br><span class=txtSm>Ранг: 527.7 (<b>!</b>), 381thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.78'>Активность: 0.16<span style='color:red'>&searr;</span>0.09</span><br>Статус: <a href="action=userinfo&amp;user=6801">Участник</a><br><font color=blue><font color=red>Победитель турнира 2010</font></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2010 16:10 <br><script type="text/javascript">QU('OKOB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OKOB" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15871.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
ERROR 1: __out_opt  PULONG ReturnLength = NULL<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">PVOID&nbsp;GetSysInfo<span class="hl_char">(</span><span class="hl_function"><b>IN</b></span>&nbsp;<span class="hl_function"><b>INT</b></span>&nbsp;informationType<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;NTSTATUS&nbsp;status<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;PVOID&nbsp;buffer&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;ULONG&nbsp;size&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;ULONG&nbsp;ReturnLength<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;DbgPrint<span class="hl_char">(</span><span class="hl_quote">&quot;MemTest Function Strat..\n&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;do</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer&nbsp;<span class="hl_char">=</span>&nbsp;SNU_ALLOC_MEM<span class="hl_char">(</span>NonPagedPool<span class="hl_char">,</span>&nbsp;size<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>buffer<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;<span class="hl_char">=</span>&nbsp;ZwQuerySystemInformation<span class="hl_char">(</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;informationType</span><span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer</span><span class="hl_char">,</span>&nbsp;size<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>ReturnLength&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>status&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;STATUS_INFO_LENGTH_MISMATCH<span class="hl_char">)</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNU_FREE_MEM</span><span class="hl_char">(</span>buffer<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size&nbsp;</span><span class="hl_char">=</span>&nbsp;ReturnLength<span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>else</b></span>&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>NT_SUCCESS<span class="hl_char">(</span>status<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNU_FREE_MEM</span><span class="hl_char">(</span>buffer<span class="hl_char">)</span><span class="hl_comment">; </span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hl_function"><b>NULL</b></span><span class="hl_comment">; </span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;{&nbsp;<span class="hl_function"><b>break</b></span><span class="hl_comment">;} </span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>status&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;STATUS_INFO_LENGTH_MISMATCH<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DbgPrint<span class="hl_char">(</span><span class="hl_quote">&quot;Size %x\n&quot;</span><span class="hl_char">,</span>size<span class="hl_char">)</span><span class="hl_comment">; </span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DbgPrint<span class="hl_char">(</span><span class="hl_quote">&quot;Adr %x\n&quot;</span><span class="hl_char">,</span>buffer<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;buffer<span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br><br>ERROR 2:? возможно при size = 0 buffer = SNU_ALLOC_MEM(NonPagedPool, size); вернет NULL<br>и улетит по if (buffer) { }  else { break;}
<br><br><font size="1"><i>-----<br>127.0.0.1, sweet 127.0.0.1</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=252515&amp;user=6801&amp;forum_n=12&amp;topic=15871.html&amp;page=0&amp;anchor=5" class="addthx" data-post="252515"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Oott[/b]','')">Oott</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/14476.jpg" alt=""><br><span class=txtSm>Ранг: 106.9 (ветеран), 27thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.6'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=14476">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2010 16:43 <br><script type="text/javascript">QU('Oott','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Oott" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15871.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>OKOB</b>, <br>1. Ну вобщем правильно!<br>Ток красивее было бы сделать так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">PVOID&nbsp;MemTest<span class="hl_char">(</span><span class="hl_function"><b>IN</b></span>&nbsp;<span class="hl_function"><b>INT</b></span>&nbsp;informationType<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;NTSTATUS&nbsp;status<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;PVOID&nbsp;buffer&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;ULONG&nbsp;size&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;DbgPrint<span class="hl_char">(</span><span class="hl_quote">&quot;MemTest Function Strat..\n&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;do</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer&nbsp;<span class="hl_char">=</span>&nbsp;SNU_ALLOC_MEM<span class="hl_char">(</span>NonPagedPool<span class="hl_char">,</span>&nbsp;size<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>buffer<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;<span class="hl_char">=</span>&nbsp;ZwQuerySystemInformation<span class="hl_char">(</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;informationType</span><span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer</span><span class="hl_char">,</span>&nbsp;size<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>size&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>status&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;STATUS_INFO_LENGTH_MISMATCH<span class="hl_char">)</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNU_FREE_MEM</span><span class="hl_char">(</span>buffer<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>else</b></span>&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>NT_SUCCESS<span class="hl_char">(</span>status<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNU_FREE_MEM</span><span class="hl_char">(</span>buffer<span class="hl_char">)</span><span class="hl_comment">; </span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hl_function"><b>NULL</b></span><span class="hl_comment">; </span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;{&nbsp;<span class="hl_function"><b>break</b></span><span class="hl_comment">;}		</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>status&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;STATUS_INFO_LENGTH_MISMATCH<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DbgPrint<span class="hl_char">(</span><span class="hl_quote">&quot;Size %x\n&quot;</span><span class="hl_char">,</span>size<span class="hl_char">)</span><span class="hl_comment">;	</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DbgPrint<span class="hl_char">(</span><span class="hl_quote">&quot;Adr %x\n&quot;</span><span class="hl_char">,</span>buffer<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;buffer<span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br>2. NULL он не вернёт, ну а вообще этичней было бы написать так:  ULONG size = PAGE_SIZE;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=252517&amp;user=14476&amp;forum_n=12&amp;topic=15871.html&amp;page=0&amp;anchor=6" class="addthx" data-post="252517"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2010 17:13 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15871.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
В ВАДах не помню, какой минус, очень давно их смотрел. Не на любой участок есть ВАД, что ли, не помню точно.<br>ПДЕ/ПТЕ более низкоуровневая хрень, можно написать, раскурив ман интела+нагуглив пару смещений. Сложность будет со всякими выгруженными страницами в своп, которые помечены как отсутствующие, надо их подгружать, но делать на низком иркл.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=252522&amp;user=1556&amp;forum_n=12&amp;topic=15871.html&amp;page=0&amp;anchor=7" class="addthx" data-post="252522"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Oott[/b]','')">Oott</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/14476.jpg" alt=""><br><span class=txtSm>Ранг: 106.9 (ветеран), 27thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.6'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=14476">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 марта 2010 16:26 <br><script type="text/javascript">QU('Oott','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Oott" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15871.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
нубовопрос:<br>Вобщем, если я приаттачился к процессу, как тепрь его память от своей отличить? Как обращаться к адресам, для дальнейшего чтения. Гуглил, восновном примеры с ReadProcessMemory, что мне не нужно. Может кто кодом поделиться?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=252911&amp;user=14476&amp;forum_n=12&amp;topic=15871.html&amp;page=0&amp;anchor=8" class="addthx" data-post="252911"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 марта 2010 18:04 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15871.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Что значит от своей? Нет больше твоей. Память ядра 1 общая для всех, юзермод меняется при смене контекста процесса. Бери и прямо читай типа mov eax,[ebx]. Имей в виду, что они просвоплены могут быть, иркл нужен пассив.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=252917&amp;user=1556&amp;forum_n=12&amp;topic=15871.html&amp;page=0&amp;anchor=9" class="addthx" data-post="252917"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Oott[/b]','')">Oott</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/14476.jpg" alt=""><br><span class=txtSm>Ранг: 106.9 (ветеран), 27thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.6'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=14476">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 марта 2010 18:58 <br><script type="text/javascript">QU('Oott','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Oott" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15871.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Не, я ктому, что как поиметь нужные адресса процесса, не зря ж я к нему для начала надо аттачиться, что через mov то понятно))) С иркл&#039;ом потом мудрить буду, это самая жоская часть<img src="img/smilies/s16.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=252922&amp;user=14476&amp;forum_n=12&amp;topic=15871.html&amp;page=0&amp;anchor=10" class="addthx" data-post="252922"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 марта 2010 22:11 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15871.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Да с ирклом как раз ничего особо сложного, отдельный тред спасёт отца демократии. Разве что синхронизация нужна. А про адреса всё равно не понял не фига, что ты хочешь. Обычно дамп-это тебе дана уже база и размер, только возьми да считай.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=252929&amp;user=1556&amp;forum_n=12&amp;topic=15871.html&amp;page=0&amp;anchor=11" class="addthx" data-post="252929"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Oott[/b]','')">Oott</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/14476.jpg" alt=""><br><span class=txtSm>Ранг: 106.9 (ветеран), 27thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.6'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=14476">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2010 21:57 &middot; Поправил: Oott <br><script type="text/javascript">QU('Oott','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Oott" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15871.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Ну может есть  какаянить структура с информацией о процессе, если например имеджбейс нестандартный попадётся, можно какнить это определить, не методом тыка. Или вот как в peetools, при дампе региона, есть что-то типа списка страничек их адресами и размером.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=253029&amp;user=14476&amp;forum_n=12&amp;topic=15871.html&amp;page=0&amp;anchor=12" class="addthx" data-post="253029"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 марта 2010 22:03 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15871.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
PETools получает наверняка через VirtualQueryEx. Если нужен весь список на более низком уровне, смотри мой первый пост. Но это тупо карта памяти и никаких записей, типа &quot;вот тут начало нужного тебе образа&quot; нет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=253030&amp;user=1556&amp;forum_n=12&amp;topic=15871.html&amp;page=0&amp;anchor=13" class="addthx" data-post="253030"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Oott[/b]','')">Oott</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/14476.jpg" alt=""><br><span class=txtSm>Ранг: 106.9 (ветеран), 27thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.6'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=14476">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июня 2010 02:08 &middot; Поправил: Oott <br><script type="text/javascript">QU('Oott','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Oott" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=15871.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Ну в общем то, по теме которая поднималась окончено, написано несколько набросков, думаю в дальнейшем пригадитсо.<br>//////////////////////////////////<br>И так, поднималась тут темка одна по говнообфускатору DYAMAR OBFUSCATOR. Тема заросла срачем и её закрыли, ну не важно. Бытовало мнение, что (Full) это очень адская штука и сможет не мало попарить мозг реверсеру, чтобы всех в этом убедить автор выложил calc_Obfuscated . Но как и предпологалось, всё оказалось совсем не так и тут я попробую это показать. Обфускация достаточно линейная, есть пару фишек о которых писал int, но и они релизованы бестолково, посему всё легко снимается. В аттаче скрипт, который собствено это делает. Ну конечно в полный оригинал не приводит, но по большей части код востановлен так, как он выглядел до обфускации. Не 100% потому, что будут проскакивать инструкции типа TEST, но погоду это не делает,  хоят убрать их тоже можно было проанализировав несколько инструкций идущих после.<br>Вот примеры кода в иде после деобфускации с ep:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010617EA</span>&nbsp;<span class="hl_comment">; start</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010617EF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">70h</span></li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010617F1</span>&nbsp;<span class="hl_comment">; .dtext:010617F1</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">01061811</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;dword_10015E0</li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">01061816</span>&nbsp;<span class="hl_comment">; .dtext:01061816</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">0106182D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_10127C8</li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">01061832</span>&nbsp;<span class="hl_comment">; .dtext:01061832</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">01061849</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">0106184B</span>&nbsp;<span class="hl_comment">; .dtext:0106184B</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">0106186B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>ebx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; lpModuleName</span></li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">0106186C</span>&nbsp;<span class="hl_comment">; .dtext:0106186C</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">0106187C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>GetModuleHandleA</li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">01061882</span>&nbsp;<span class="hl_comment">; .dtext:01061882</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">01061896</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>edi</b></span>&nbsp;<span class="hl_comment">; GetModuleHandleA</span></li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">01061898</span>&nbsp;<span class="hl_comment">; .dtext:01061898</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">0106189B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>word</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">5A4Dh</span></li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010618A0</span>&nbsp;<span class="hl_comment">; .dtext:010618A0</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010618A5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jnz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_102FB77</li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010618AB</span>&nbsp;<span class="hl_comment">; ololo</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010618D4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">3Ch</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010618D7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010618D9</span>&nbsp;<span class="hl_comment">; .dtext:010618D9</span></li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010618DE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010618E0</span>&nbsp;<span class="hl_comment">; .dtext:010618E0</span></li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">01061937</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ecx</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">4550h</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">0106193D</span>&nbsp;<span class="hl_comment">; .dtext:0106193D</span></li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">01061952</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jnz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_102FB77</li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">01061958</span>&nbsp;<span class="hl_comment">; .dtext:01061958</span></li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">01061978</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">0106197A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>movzx</b></span>&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>word</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ecx</span><span class="hl_char">+</span><span class="hl_number">18h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">0106197E</span>&nbsp;<span class="hl_comment">; .dtext:0106197E</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">0106199F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">10Bh</span></li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010619A4</span>&nbsp;<span class="hl_comment">; .dtext:010619A4</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010619AA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_1059D7F</li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010619B0</span>&nbsp;<span class="hl_comment">; .dtext:010619B0</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010619B7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">20Bh</span></li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010619BC</span>&nbsp;<span class="hl_comment">; .dtext:010619BC</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010619C4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_102CFDE</li><li class="hl_l1"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010619CA</span>&nbsp;<span class="hl_comment">; .dtext:010619CA</span></li><li class="hl_l0"><span class="hl_char">.</span>dtext<span class="hl_char">:</span><span class="hl_number">010619ED</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_102FB77</li>        </ol>
    </div>
</div></div>
<br><br>ну или вот например первая функа call    sub_10127C8 востановилась полностью(скрытые поля убрал для ясности):<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;loc_10128E2</li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;large&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;large&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">+</span>arg_4<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">+</span>arg_4<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0"><span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">+</span>arg_4<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>sub</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">-</span><span class="hl_number">8</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">-</span><span class="hl_number">18h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l1"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">-</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">-</span><span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FFFFFFFFh</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">-</span><span class="hl_number">8</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_function">retn</span></li>        </ol>
    </div>
</div></div>
<br>Всё что нам нужно это опредеоить сигнатуры, по которым будет затираться мусор и попытаться сделать их наименее опасными, ибо можно подловится и затереть совсем не мусор.<br>Что касается мусора, который простой заменой не уберёшь, тут тоже ни чего сложного, всегда найдутся пару констант, ниже, выше, по котрым можно всё расчистить.<br>Пример(в закрытой теме брался во внимание):<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">010618B1</span>&nbsp;&nbsp;&nbsp;&nbsp;B9&nbsp;<span class="hl_number">6F7C0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_number">7C6F</span></li><li class="hl_l1"><span class="hl_number">010618B6</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">81C1</span>&nbsp;<span class="hl_number">373E0000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_number">3E37</span></li><li class="hl_l0"><span class="hl_number">010618BC</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0F85</span>&nbsp;<span class="hl_number">12000000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JNZ</b></span>&nbsp;calc_Obf<span class="hl_char">.</span><span class="hl_number">010618D4</span></li><li class="hl_l1"><span class="hl_number">010618C2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">09D5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>OR</b></span>&nbsp;<span class="hl_registr">EBP</span><span class="hl_char">,</span><span class="hl_registr">EDX</span></li><li class="hl_l0"><span class="hl_number">010618C4</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">09C5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>OR</b></span>&nbsp;<span class="hl_registr">EBP</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">010618C6</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">33D3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">010618C8</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">2BF2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>SUB</b></span>&nbsp;<span class="hl_registr">ESI</span><span class="hl_char">,</span><span class="hl_registr">EDX</span></li><li class="hl_l1"><span class="hl_number">010618CA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8BC3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">010618CC</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">5A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EDX</span></li><li class="hl_l1"><span class="hl_number">010618CD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">03E1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_registr">ECX</span></li><li class="hl_l0"><span class="hl_number">010618CF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">57</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l1"><span class="hl_number">010618D0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">5F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l0"><span class="hl_number">010618D1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">5F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l1"><span class="hl_number">010618D2</span>&nbsp;&nbsp;&nbsp;&nbsp;C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">LEAVE</span></li><li class="hl_l0"><span class="hl_number">010618D3</span>&nbsp;&nbsp;&nbsp;&nbsp;C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">RETN</span></li><li class="hl_l1"><span class="hl_number">010618D4</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B48</span>&nbsp;<span class="hl_number">3C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_registr">EAX</span><span class="hl_char">+</span><span class="hl_number">3C</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span></li><li class="hl_l1"><span class="hl_number">0106634D</span>&nbsp;&nbsp;&nbsp;&nbsp;B8&nbsp;<span class="hl_number">45770000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">7745</span></li><li class="hl_l0"><span class="hl_number">01066352</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">81C0</span>&nbsp;A23B0000&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">3BA2</span></li><li class="hl_l1"><span class="hl_number">01066358</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0F85</span>&nbsp;<span class="hl_number">08000000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JNZ</b></span>&nbsp;calc_Obf<span class="hl_char">.</span><span class="hl_number">01066366</span></li><li class="hl_l0"><span class="hl_number">0106635E</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">21C5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>AND</b></span>&nbsp;<span class="hl_registr">EBP</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">01066360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8BEE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EBP</span><span class="hl_char">,</span><span class="hl_registr">ESI</span></li><li class="hl_l0"><span class="hl_number">01066362</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">5E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_number">01066363</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">5B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">01066364</span>&nbsp;&nbsp;&nbsp;&nbsp;C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">LEAVE</span></li><li class="hl_l1"><span class="hl_number">01066365</span>&nbsp;&nbsp;&nbsp;&nbsp;C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">RETN</span></li><li class="hl_l0"><span class="hl_number">01066366</span>&nbsp;&nbsp;&nbsp;&nbsp;B9&nbsp;DD350000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_number">35DD</span></li><li class="hl_l1"><span class="hl_number">0106636B</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">81C1</span>&nbsp;EE1A0000&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_number">1AEE</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span></li><li class="hl_l1"><span class="hl_number">010665F1</span>&nbsp;&nbsp;&nbsp;&nbsp;BA&nbsp;<span class="hl_number">825E0000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_number">5E82</span></li><li class="hl_l0"><span class="hl_number">010665F6</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">81C2</span>&nbsp;<span class="hl_number">412F0000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_number">2F41</span></li><li class="hl_l1"><span class="hl_number">010665FC</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0F85</span>&nbsp;<span class="hl_number">0A000000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JNZ</b></span>&nbsp;calc_Obf<span class="hl_char">.</span><span class="hl_number">0106660C</span></li><li class="hl_l0"><span class="hl_number">01066602</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">51</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ECX</span></li><li class="hl_l1"><span class="hl_number">01066603</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">09FC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>OR</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_registr">EDI</span></li><li class="hl_l0"><span class="hl_number">01066605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EBX</span></li><li class="hl_l1"><span class="hl_number">01066606</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">09D5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>OR</b></span>&nbsp;<span class="hl_registr">EBP</span><span class="hl_char">,</span><span class="hl_registr">EDX</span></li><li class="hl_l0"><span class="hl_number">01066608</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">5B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EBX</span></li><li class="hl_l1"><span class="hl_number">01066609</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">5B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>POP</b></span>&nbsp;<span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">0106660A</span>&nbsp;&nbsp;&nbsp;&nbsp;C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">LEAVE</span></li><li class="hl_l1"><span class="hl_number">0106660B</span>&nbsp;&nbsp;&nbsp;&nbsp;C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">RETN</span></li><li class="hl_l0"><span class="hl_number">0106660C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">2BC6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>SUB</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_number">0106660E</span>&nbsp;&nbsp;&nbsp;&nbsp;C1C1&nbsp;<span class="hl_number">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ROL</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_number">20</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">и&nbsp;т<span class="hl_char">.</span>п<span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br>Т.е. размер всегда не определён и инструкции после ret, могли быть не мусорными.<br>Ну и убираетсо как-то так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">lp<span class="hl_char">:</span></li><li class="hl_l1">find&nbsp;start<span class="hl_char">,</span>#B<span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_number">000081</span><span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_number">00000F85</span><span class="hl_char">?</span><span class="hl_char">?</span>000000#</li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;idc<span class="hl_char">,</span><span class="hl_char">$</span>RESULT</li><li class="hl_l1"><span class="hl_function"><b>cmp</b></span>&nbsp;idc<span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_function"><b>jz</b></span>&nbsp;<span class="hl_function">end</span></li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span><span class="hl_char">[</span>idc<span class="hl_char">+</span><span class="hl_number">0D</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span><span class="hl_number">11</span></li><li class="hl_l1">fill&nbsp;idc<span class="hl_char">,</span><span class="hl_registr">al</span><span class="hl_char">,</span><span class="hl_number">90</span></li><li class="hl_l0"><span class="hl_function"><b>jmp</b></span>&nbsp;lp</li><li class="hl_l1"><span class="hl_function">end</span><span class="hl_char">:</span></li>        </ol>
    </div>
</div></div>
<br><br>т.е. тут мы опирались на условный перход jnz, котрый по сути jmp.<br><br>Если не использовать опасные сигнатуры, к сожалению я их не выделял, но думаю там и так ясно, то скрипт можно юзать и на других программах.<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/784a_04.06.2010_CRACKLAB.rU.tgz">784a_04.06.2010_CRACKLAB.rU.tgz</a> - calc_De_Obfuscated.7z
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=259601&amp;user=14476&amp;forum_n=12&amp;topic=15871.html&amp;page=0&amp;anchor=14" class="addthx" data-post="259601"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/blog.png" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=12&sortBy=0&page=0.html"><b>Дневники и блоги</b></a> <b class=bulletHead>&#8212;&#8250;</b> OOTT(Pashkin) blog: на пути истины</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#15" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="12">
<input type="hidden" name="topic" value="15871">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15871" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
