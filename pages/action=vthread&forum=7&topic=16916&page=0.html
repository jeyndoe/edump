<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Под ThinApp не запускается lnk с ShellExecute под Windows 7... - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Собственно проблема существует только в готовой сборке и только на семёрке. В моей XP всё нормально. Делаю так: ShellExecute(0, &#039;open&#039;, &#039;c:\far\far.lnk&#039;, &#039;&#039;, &#039;&#039;, SW_SHOW); Всё тоже самое не">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+2 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/mod.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=7&sortBy=0&page=0.html"><b>Оффтоп</b></a> <b class=bulletHead>&#8212;&#8250;</b> Под ThinApp не запускается lnk с ShellExecute под Windows 7...</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 октября 2010 16:42 &middot; Поправил: ToBad <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=16916.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Собственно проблема существует только в готовой сборке и только на семёрке. В моей XP всё нормально.<br>Делаю так: ShellExecute(0, &#039;open&#039;, &#039;c:\far\far.lnk&#039;, &#039;&#039;, &#039;&#039;, SW_SHOW);<br>Всё тоже самое не в сборке работает.<br>Стоит заменить far.lnk на far.exe - в сборке работает.<br>Другими словами именно lnk и именно собранный файл. Окно начинает открываться, моргает и закрывается...<br>Как посоветуете решить проблему? Хочется запускать именно lnk так как там изменены цвета.<br>ThinApp 4.6.0-287958<br><br>p.s. Пока писал текст удалось проверить на ещё одной XP - не работает как на семёрке...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268697&amp;user=702&amp;forum_n=7&amp;topic=16916.html&amp;page=0&amp;anchor=1" class="addthx" data-post="268697"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]NikolayD[/b]','')">NikolayD</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 189.9 (ветеран), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.36'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24529">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 октября 2010 17:54 <br><script type="text/javascript">QU('NikolayD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NikolayD" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=16916.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Может с ассоциациями стоит что-то сделать? Хотя не уверен что понял.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268713&amp;user=24529&amp;forum_n=7&amp;topic=16916.html&amp;page=0&amp;anchor=2" class="addthx" data-post="268713"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 октября 2010 18:15 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=16916.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>NikolayD пишет:<br>Может с ассоциациями стоит что-то сделать? Хотя не уверен что понял. </I><br><br>Не, если без упаковки в портейбл версию, то запускает.<br>То есть ShellExecute не умеет запускать lnk из thinapp сборки. Попытка происходит ибо окно появляется на доли секунды...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268719&amp;user=702&amp;forum_n=7&amp;topic=16916.html&amp;page=0&amp;anchor=3" class="addthx" data-post="268719"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]NikolayD[/b]','')">NikolayD</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 189.9 (ветеран), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.36'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24529">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 октября 2010 18:26 <br><script type="text/javascript">QU('NikolayD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NikolayD" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=16916.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
А если lnk отдельно держать или извлекать и потом запускать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268721&amp;user=24529&amp;forum_n=7&amp;topic=16916.html&amp;page=0&amp;anchor=4" class="addthx" data-post="268721"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 октября 2010 22:03 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=16916.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
В саппорт ThinApp, не?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268751&amp;user=1556&amp;forum_n=7&amp;topic=16916.html&amp;page=0&amp;anchor=5" class="addthx" data-post="268751"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 октября 2010 07:52 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=16916.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Может потому что директория не указана?<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">HINSTANCE&nbsp;ShellExecute<span class="hl_char">(</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HWND&nbsp;hwnd<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;LPCTSTR&nbsp;lpOperation<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;LPCTSTR&nbsp;lpFile<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;LPCTSTR&nbsp;lpParameters<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;LPCTSTR&nbsp;lpDirectory<span class="hl_char">,</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;вот&nbsp;тут</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>INT</b></span>&nbsp;nShowCmd</li><li class="hl_l0"><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=268784&amp;user=3232&amp;forum_n=7&amp;topic=16916.html&amp;page=0&amp;anchor=6" class="addthx" data-post="268784"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Magister Yoda[/b]','')">Magister Yoda</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8344.gif" alt=""><br><span class=txtSm>Ранг: 107.3 (ветеран), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.59'>Активность: 0.2<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=8344">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 октября 2010 09:22 <br><script type="text/javascript">QU('Magister Yoda','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Magister Yoda" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=16916.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
возможно скажу глупость... lnk - насколько я понял это ярлык.<br>в ярлыке ведь указывается путь запуска на диске, а т.к. упаковано в thinapp, то там путь ведь другой будет...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268793&amp;user=8344&amp;forum_n=7&amp;topic=16916.html&amp;page=0&amp;anchor=7" class="addthx" data-post="268793"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 октября 2010 10:08 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=16916.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>Magister Yoda</b> thinapp эмулирует пути. И другой он там не будет, в этом и фишка виртуализации. Другое дело что он может не перехватить апи при использовании ярлыка.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=268797&amp;user=3232&amp;forum_n=7&amp;topic=16916.html&amp;page=0&amp;anchor=8" class="addthx" data-post="268797"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 октября 2010 12:16 &middot; Поправил: ToBad <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=16916.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>Archer пишет:<br>В саппорт ThinApp, не? </I><br><br>Ну это на инглише нужно, а я как видишь не совсем понятно объясняю даже на русском... <img src="img/smilies/s1.gif" alt=""><br><br><I>NikolayD пишет:<br>А если lnk отдельно держать или извлекать и потом запускать? </I><br><br>А что это даст?<br><br><br><I>PE_Kill пишет:<br>Может потому что директория не указана? </I><br><br>Пробовал по разному. Окошко запускаемого приложения начинает появляться и потом закрывается... <br><br><I>PE_Kill пишет:<br>Другое дело что он может не перехватить апи при использовании ярлыка.  </I><br><br>Под XP та же сборка перехватывает.<br><br><br><I>Magister Yoda пишет:<br>упаковано в thinapp, то там путь ведь другой будет... </I><br><br>Если командную строку запускать, то запускаемое приложение в системе как-бы присутствует на месте куда я указал.<br><br>p.s. Возможно я что-то упускаю в самом ThinApp. Сегодня попробую сделать сборку другой версией, на семёрке. Может что получится...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268816&amp;user=702&amp;forum_n=7&amp;topic=16916.html&amp;page=0&amp;anchor=9" class="addthx" data-post="268816"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 октября 2010 15:43 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=16916.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Жуткий геморрой получается. В общем пробовал разные варианты, включая копирование ярлыка. Работает только если сделать инсталлятор который распаковавшись запускает lnk. ShellExecute делаю для инсталлятора. Он гадит всё на диск C и сам запускает. Тогда проблем нет, но криво это как-то, плюс остаётся мусор.<br>Всё чего пытаюсь добиться - это запуска фара с определёнными цветами. В ярлыке как и в ветке HKEY_CURRENT_USER\Console\ColorTable... можно задавать цвета, но в семёрке это распространяется только на запущенные вне песочницы консольные приложения. Фар на семёрке в песочнице не использует успешно прописанные цвета в Console\ColorTable, а с ярлыка его запустить не получается. Отсюда другой вопрос, а как ещё можно запустить консольный Far.exe передав установки цвета? Как вообще запускать консольные приложения указав что-нибудь из множества параметров, шрифт, размер окна и т.д.?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=268843&amp;user=702&amp;forum_n=7&amp;topic=16916.html&amp;page=0&amp;anchor=10" class="addthx" data-post="268843"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 октября 2010 16:23 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=16916.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
bat файл, vb скрипт, накодить простенький exe который запустит другой exe с какими угодно параметрами.<br><br>Тот же самый:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_number">1</span><span class="hl_char">.</span>&nbsp;HINSTANCE&nbsp;ShellExecute<span class="hl_char">(</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HWND&nbsp;hwnd<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_number">2</span><span class="hl_char">.</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPCTSTR&nbsp;lpOperation<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_number">3</span><span class="hl_char">.</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPCTSTR&nbsp;lpFile<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_number">4</span><span class="hl_char">.</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPCTSTR&nbsp;lpParameters<span class="hl_char">,</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;поддерживает&nbsp;параметры</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_number">5</span><span class="hl_char">.</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPCTSTR&nbsp;lpDirectory<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_number">6</span><span class="hl_char">.</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>INT</b></span>&nbsp;nShowCmd</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_number">7</span><span class="hl_char">.</span>&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=268934&amp;user=3232&amp;forum_n=7&amp;topic=16916.html&amp;page=0&amp;anchor=11" class="addthx" data-post="268934"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2010 15:08 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=7&amp;topic=16916.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>bat файл, vb скрипт, накодить простенький exe который запустит другой exe с какими угодно параметрами. </I><br><br>Примерно так и сделал. Фар вместе с настройками цветов запихнул в инсталлятор с запуском ярлыка с уже реального диска С. Соответственно Console\ColorTable прописывается в реальный реестр. Из приложения в песочнице запускается этот инсталлятор и гадит в реальную систему, плюс запускает фар сам. Таким образом удалось победить большинство проблем, и с виду всё получилось, но в ходе работы обнаружилось, что этот фар хоть и запущен инсталлятром с реального диска, функционал его ограничен. Например запустив с этого фара инсталляцию любой программы которая пытается установить сервис или драйвер - получаю ошибки... Наверное проблема в методе изоляции...<br>Но теперь уже глядя на все вытекающие проблемы и сложности - задаю себе вопрос, а зачем я вообще решил использовать thinapp для этой конкретной задачи когда всё можно сделать проще в виде обычного  инсталлятора с автозапуском после распаковки.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=269010&amp;user=702&amp;forum_n=7&amp;topic=16916.html&amp;page=0&amp;anchor=12" class="addthx" data-post="269010"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/mod.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=7&sortBy=0&page=0.html"><b>Оффтоп</b></a> <b class=bulletHead>&#8212;&#8250;</b> Под ThinApp не запускается lnk с ShellExecute под Windows 7...</span></td>
</tr></table>
</div>
<a name=newreply></a>
<center><h3>У вас должно быть 20 пунктов ранга, чтобы оставлять сообщения в  этом подфоруме, но у вас только 0</h3></center><script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=16916" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
