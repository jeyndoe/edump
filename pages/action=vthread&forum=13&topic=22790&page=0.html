<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Распаковка DOS программы, нужна помощь. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте! Помогите пожалуйста с распаковкой DOS программы. Файл запакован, чем не знаю, разные анализаторы для DOS программ результата не дали. Подозреваю, что это hardlock, так как для работы файла нужен ключ (имеется в">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка DOS программы, нужна помощь.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 мая 2014 17:48 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22790.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте!<br><br>Помогите пожалуйста с распаковкой DOS программы.<br>Файл запакован, чем не знаю, разные анализаторы для DOS программ результата не дали. Подозреваю, что это hardlock, так как для работы файла нужен ключ (имеется в наличии).<br>Эксперименты провожу на DOSBox 0.74 SVN-Daum (Debugger)<br>Оригинальный файл boot.exe, запускаю на отладку, в dosbox отладчике делаю команду DOS MCBS и получаю следующую информацию касательно boot.exe<br>MCB Seg: 01E8, Size: 647520, PSP Seg: 01E9<br><br>Далее команда: MEMDUMPBIN 01E8:0000 9E160<br>Сохраняю в memdump1.bin<br><br>Когда программа запущена, она выдаёт ошибку:<br>HARD DISK ERROR: Disk not completely updated.<br><br>Перехожу в отладчик, команда DOS MCBS<br>MCB Seg: 017B, Size: 116800, PSP Seg: 017C<br>MCB Seg: 1E00, Size:   1024, PSP Seg: 017C<br><br>Делаю ещё 2 дампа:<br>MEMDUMPBIN 017B:0000 1C840<br>Сохраняю в memdump2.bin<br><br>MEMDUMPBIN 1E00:0000 400<br>Сохраняю в memdump3.bin<br><br>Если отлаживать пошагово, то видно что программа находится в бесконечном цикле по адресу 0431:0152<br>Делаю MEMDUMPBIN 0431:0000 100000<br>Сохраняю в memdump4.bin<br><br>Дамп memdump2.bin хоть и выглядит как распакованный EXE, при переименовании не работает. Наверное неправильная точка входа, а чем поправить или как проверить - не знаю.<br>Буду очень благодарен за помощь или совет, ибо опыта отладки и распаковки DOS программ у меня нет.<br><br>Так же прошу обратить внимание, что по не проверенным данным boot.exe может отформатировать диск следующий за C и D, так как в программе есть режим апдейта и подготовки к нему диска.<br><br><img src="img/attach.gif" alt=""> <a href="./files/8391_20.05.2014_EXELAB.rU.tgz">8391_20.05.2014_EXELAB.rU.tgz</a> - boot.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=341927&amp;user=702&amp;forum_n=13&amp;topic=22790.html&amp;page=0&amp;anchor=1" class="addthx" data-post="341927"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 389thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 мая 2014 04:15 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22790.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Не знаю, насколько поможет такая инфа:<br><br>1) <br>Запускался BOOT.EXE в чистой DOS 7.1 (real mode без himem.sys)<br>   Снял дампы модуля с разных адресов, недораспакованные.<br>   В конце дампа присутствуют строки:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Hardlock&nbsp;<span class="hl_char">%</span>s&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;found<span class="hl_char">.</span></li><li class="hl_l1">Expiration&nbsp;Date&nbsp;reached<span class="hl_char">.</span></li><li class="hl_l0">Licence&nbsp;expired<span class="hl_char">.</span></li><li class="hl_l1">Invalid&nbsp;Hardlock&nbsp;EEprom&nbsp;registers<span class="hl_char">.</span></li><li class="hl_l0">Error&nbsp;reading&nbsp;current&nbsp;Execution&nbsp;Limit&nbsp;value<span class="hl_char">.</span></li><li class="hl_l1">Error&nbsp;writing&nbsp;current&nbsp;Execution&nbsp;Limit&nbsp;value<span class="hl_char">.</span></li><li class="hl_l0">Execution&nbsp;Limit&nbsp;reached<span class="hl_char">.</span></li><li class="hl_l1">Licence&nbsp;expired<span class="hl_char">.</span></li><li class="hl_l0">Execution&nbsp;Limit&nbsp;value&nbsp;was&nbsp;faked<span class="hl_char">!</span></li><li class="hl_l1">Only&nbsp;<span class="hl_char">%</span>d&nbsp;counter&nbsp;unit<span class="hl_char">(</span>s<span class="hl_char">)</span>&nbsp;left<span class="hl_char">.</span></li><li class="hl_l0">Only&nbsp;<span class="hl_char">%</span>d&nbsp;days&nbsp;left&nbsp;before&nbsp;license&nbsp;expiration&nbsp;date<span class="hl_char">.</span></li><li class="hl_l1">Wrong&nbsp;CPU<span class="hl_char">!</span></li><li class="hl_l0">Multitasking&nbsp;system&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;supported<span class="hl_char">!</span></li><li class="hl_l1">Licence&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;enabled<span class="hl_char">.</span></li><li class="hl_l0">Invalid&nbsp;Licence&nbsp;information<span class="hl_char">.</span></li><li class="hl_l1">Checksum&nbsp;error<span class="hl_char">!</span></li><li class="hl_l0">Program&nbsp;modified<span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span></li>        </ol>
    </div>
</div></div>
(Сам дамп не прилагаю, смысла в нём мало).<br><br>2) <br>Дампы снимались после завершения работы программы с ошибкой<br>   (в центре экрана синее окошко с надписью &quot;Hardlock not found&quot;).<br>   То-есть программа недораспаковалась из-за отсутствия этого самого хардлока.<br><br>3) <br>Раз имеется хардлок, то проще установить этот хардлок,  запустить машину в чистой DOS<br>   и попытаться в чистой DOS распаковать   BOOT.EXE с помощью CUP386 или AUTOHACK&#039;а.<br><br>   Судя по вашим дампам, прога написана на MSC, то-есть популярные<br>   распаковщики, думаю, могут её развернуть автоматом.<br><br>   В случае без хардлока они не могут верно опознать точку входа екзека,<br>   дампят модуль только по int21h/4Ch (завершение программы),<br>   и недораспакованный екзек получается совершенно кривым.<br>   <br>4) <br>В вашем случае с DosBox&#039;ом - автораспаковщики работать не будут.<br>Хотя сама программа распаковывается успешно, как я понял, при вставленном хардлоке.<br>   Можно было бы развернуть её и вручную после дампирования в DosBox&#039;e, но без опыта это тяжко.<br><br><I>ToBad пишет:<br>хоть и выглядит как распакованный EXE, при переименовании не работает. Наверное неправильная точка входа, ... </I><br>- этого недостаточно, всё значительно сложнее.<br><br>   В любом случае, для работы этой проги BOOT.EXE понадобится доступ к фзическому диску, который вряд-ли возможно получить<br>   под DosBox&#039;ом    (судя по полученному вами сообщению &quot;HARD DISK ERROR: Disk not completely updated&quot;).<br><br>   <b>Поэтому советую сделать всё по пункту (3) и не заморачиваться.</b><br>   Во всяком случае, попробовать.<br><br>6) <br>Вкратце, так.<br><br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342015&amp;user=35473&amp;forum_n=13&amp;topic=22790.html&amp;page=0&amp;anchor=2" class="addthx" data-post="342015"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=702" title="23-05-2014 23:07, ранг:438.6" target="_blank">ToBad</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]saffers[/b]','')">saffers</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.7 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.17'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37350">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 мая 2014 14:52 &middot; Поправил: saffers <br><script type="text/javascript">QU('saffers','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=saffers" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22790.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
эххх, тряхнем стариной <img src="img/smilies/s1.gif" alt=""> и снова в 90-е<br><b>ToBad</b> а ключ кстати какой, LPT? <img src="img/smilies/s1.gif" alt=""><br><br>Я пробовал запустить под виртуалкой Vmware c Windows98 на борту.<br><br>резюмируя:<br>- До загрузки винды пробовал запустить softice 2.8 для дос. Но т.к. уже забыл, как там его правильно грузить в верхнюю память, или по другим причинам загрузить и отлаживать s-ice не получилось.  <img src="img/smilies/s9.gif" alt=""><br><br>- Сильно не влезал.<br> пробовал использовать Borland Turbo Debugger 3.2 для 286 для real time mode. На начальном этапе кодпротектора начинает самодифицироваться (ксорит по циклам). Также переустанавливает int21h (функции dos) на свой обработчик. Дальше кажется использует антиотладочные фокусы с вычислениями с запятой и отладчик вешается. Также вешались распаковщики работающие в режиме трейсера. Чувствую есть там трюки против трассировки.<br>Трудность на мой взгляд еще представляет еще то, что модель памяти программ тех лет не плоская, как сейчас, а сегмент:смещение. Отслеживать работу с которыми даже сложнее чем теперь.<br>По-моему еще протектор портит запись о Relocations table address в заголовке MZ файле... устанавливая там 0000.<br>- Таже перепробовал лежавшие давно в чулане автоматические распаковщики времен лихих 90х типа unp, uup, intruder, tron и стандарт де факто тех лет autohack, cup386<br>ничего не помогло распаковать полностью. Лучше всего получилось у автохака. После него хоть оставались какие-то дампы.<br>Скорее всего без ключа распаковать нормально вообще не получится.<br>cup386 может распаковывать из под реал тайма, реал тайма 386, защищенного. Так вполне можно попробовать распаковать с ключом. <br>Если защищенная программа слинкована компилятором, то распаковщики тех лет использовали сигнатуры начала oep для распаковки. Шансы увеличиваются.<br>Вообще никогда не пробовал распаковывать под дос боксом с помощью автоунпакеров. Вопрос открытый... возможно некоторые сработают<br>- еще программа имеет оверлей и зачем он нужен в данном случае не понятно. По идее нужен был, когда большая программа не могла загрузиться со стеком в одну 64к страницу.<br><br><b>ToBad</b><br>- присоединяюсь к совету <b>dosprog</b> по п.3. Лучше чистый дос. Я пробовал под виртуалкой, т.к. ключа не было. А с ключом, как его внутрь машины протолкнуть...<br>- заголовки MZ ехе файла можно читать и править с помощью Hiew<br>- выкладываю автоунпакеры какие сохранились, там же есть инфа по автохаку и кратко о методах распаковки времен доса.<br>- инфа про ms-dos [url=--&gt; http://msdosworld.ru &lt;--]--&gt; http://msdosworld.ru &lt;--[/url]<br><br><br><b>Добавлено спустя 4 часа 19 минут</b><br><b>ToBad</b><br>вот еще - незабвенная &lt;img src=&quot;http://exelab.ruimg/smilies/s3.gif[/img] Player&#039;s Tools - прородитель artmoney и procdumpa<br>резидентный дампер памяти, включая exstended и даже дос экстендеров.<br>Допустим автоунпакеры не помогут, и пройдешь до Entry Point отладчиком, и захочешь сдампить, то вот этот утиль это сделает<br><br><img src="img/attach.gif" alt=""> <a href="./files/cdb5_22.05.2014_EXELAB.rU.tgz">cdb5_22.05.2014_EXELAB.rU.tgz</a> - PlayersTool.ver.5.00b.English.rar<br><br><b>Добавлено спустя 7 часов 48 минут</b><br>перезалил<br><br><img src="img/attach.gif" alt=""> <a href="./files/5f2d_22.05.2014_EXELAB.rU.tgz">5f2d_22.05.2014_EXELAB.rU.tgz</a> - Unpacker_old.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342051&amp;user=37350&amp;forum_n=13&amp;topic=22790.html&amp;page=0&amp;anchor=3" class="addthx" data-post="342051"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=702" title="23-05-2014 23:07, ранг:438.6" target="_blank">ToBad</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]AliS S0fT[/b]','')">AliS S0fT</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.8 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.23'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4470">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 мая 2014 12:14 <br><script type="text/javascript">QU('AliS S0fT','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AliS S0fT" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22790.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Дискетка с досом и cup386 /7 boot.exe boot1.exe По идее расспакует. Если нет то cup386 /7 /d boot.exe boot1.exe До Entry Point и создаешь exe. cup386 его хорошо трейсит, на уловки его не попадается. А так как у меня нет ключа и api hardlock-а под дос то и ковырять долго.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342094&amp;user=4470&amp;forum_n=13&amp;topic=22790.html&amp;page=0&amp;anchor=4" class="addthx" data-post="342094"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=702" title="23-05-2014 23:06, ранг:438.6" target="_blank">ToBad</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]saffers[/b]','')">saffers</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.7 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.17'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37350">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 мая 2014 16:37 &middot; Поправил: saffers <br><script type="text/javascript">QU('saffers','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=saffers" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22790.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>ToBad</b><br>если открыть ваш дамп №2 из пост №13 <noindex><a href="http://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=7553&amp;page=1" rel="nofollow" target="_blank">--&gt; link &lt;--</a></noindex><br>то там код в один, один<br><br><b>Добавлено спустя 8 минут</b><br>посмотрите еще тут, траппер обмена <noindex><a href="http://exelab.ru/f/action=vthread&amp;forum=10&amp;topic=8076" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex> от <b>Chingachguk</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342100&amp;user=37350&amp;forum_n=13&amp;topic=22790.html&amp;page=0&amp;anchor=5" class="addthx" data-post="342100"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 мая 2014 03:06 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22790.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Огромное спасибо всем за помощь!<br>Cup386 я пробовал и раньше, но моей ошибкой было то, что делал это я на dosbox. На определении Entry Point всё зависало. Теперь почитав советы, я поставил дос на реальную машину и cup386 всё распаковал!<br>Файл получился 57711 байт и сохранился оверлей кажется, IDA по крайней мере ругается.<br>Кстати файлик работает теперь и без ключа (до первой ошибки с ним не связанной). Как будет далее, узнаю на днях, когда установлю реальный рабочий образ со всем необходимым включая системную карту на его родную машину...<br>Прошу тему пока не закрывать, возможно будут вопросы по дальнейшей отладке.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342116&amp;user=702&amp;forum_n=13&amp;topic=22790.html&amp;page=0&amp;anchor=6" class="addthx" data-post="342116"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]saffers[/b]','')">saffers</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.7 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.17'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=37350">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 мая 2014 11:21 &middot; Поправил: saffers <br><script type="text/javascript">QU('saffers','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=saffers" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22790.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>ToBad</b><br>Если прога обычная без антидебаг трюков, то можешь отлаживать с помощью afdpro, turbo debugger (286, 386), с трюкамми - cup386, deGlucker, s-ice 2.8.<br><br>s-ice и td386 требуют манипуляций с config.sys для загрузки отладочных драйверов<br>поэтому наверно проще юзать cup386 v3.4 в режиме VM86 - /3 /d, i386 - /7 /d, он и хардварные бряки поддерживает<br>еще можешь попробовать достаточно мощный deGlucker 0.05 отладчик тоже работающий в защищенном режиме, с поддержкой hw bp, bp int <br><br>если разрабы постарались и вызовы api хардлока имеются, то они будут напрямую работать через порты ввода-вывода, тут потребуются sice, cup386, dg<br>например, cup386 без проблем ставит hw bpio 378h<br><br>оверлей 210h байт, скорей всего это от защиты, не похоже что там код, в принципе можешь попробовать отрезать... <img src="img/smilies/s7.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342121&amp;user=37350&amp;forum_n=13&amp;topic=22790.html&amp;page=0&amp;anchor=7" class="addthx" data-post="342121"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 мая 2014 14:59 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=22790.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>saffers</b> у меня скорее всего всё ограничится правкой jz на jmp <img src="img/smilies/s1.gif" alt=""><br>В смысле  есть основания предполагать, что обойдя одно сообщение об ошибке далее всё будет работать как нужно. Точно проверю только на оригинальном железе, надеюсь на днях.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=342124&amp;user=702&amp;forum_n=13&amp;topic=22790.html&amp;page=0&amp;anchor=8" class="addthx" data-post="342124"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка DOS программы, нужна помощь.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#9" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="22790">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22790" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
